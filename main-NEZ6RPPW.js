import{a as k,b as q,h as Xy}from"./chunk-FU26YZD3.js";var Em;function zl(){return Em}function li(n){let e=Em;return Em=n,e}var ev=Symbol("NotFound");function ho(n){return n===ev||n?.name==="\u0275NotFound"}var Ht=null,Yl=!1,bm=1,Ub=null,Gt=Symbol("SIGNAL");function fe(n){let e=Ht;return Ht=n,e}function Zl(){return Ht}var _r={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function yo(n){if(Yl)throw new Error("");if(Ht===null)return;Ht.consumerOnSignalRead(n);let e=Ht.producersTail;if(e!==void 0&&e.producer===n)return;let t,i=Ht.recomputing;if(i&&(t=e!==void 0?e.nextProducer:Ht.producers,t!==void 0&&t.producer===n)){Ht.producersTail=t,t.lastReadVersion=n.version;return}let r=n.consumersTail;if(r!==void 0&&r.consumer===Ht&&(!i||Hb(r,Ht)))return;let o=Co(Ht),s={producer:n,consumer:Ht,nextProducer:t,prevConsumer:r,lastReadVersion:n.version,nextConsumer:void 0};Ht.producersTail=s,e!==void 0?e.nextProducer=s:Ht.producers=s,o&&rv(n,s)}function tv(){bm++}function Xl(n){if(!(Co(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===bm)){if(!n.producerMustRecompute(n)&&!_o(n)){Ql(n);return}n.producerRecomputeValue(n),Ql(n)}}function Sm(n){if(n.consumers===void 0)return;let e=Yl;Yl=!0;try{for(let t=n.consumers;t!==void 0;t=t.nextConsumer){let i=t.consumer;i.dirty||$b(i)}}finally{Yl=e}}function Dm(){return Ht?.consumerAllowSignalWrites!==!1}function $b(n){n.dirty=!0,Sm(n),n.consumerMarkedDirty?.(n)}function Ql(n){n.dirty=!1,n.lastCleanEpoch=bm}function Cr(n){return n&&nv(n),fe(n)}function nv(n){n.producersTail=void 0,n.recomputing=!0}function vo(n,e){fe(e),n&&iv(n)}function iv(n){n.recomputing=!1;let e=n.producersTail,t=e!==void 0?e.nextProducer:n.producers;if(t!==void 0){if(Co(n))do t=wm(t);while(t!==void 0);e!==void 0?e.nextProducer=void 0:n.producers=void 0}}function _o(n){for(let e=n.producers;e!==void 0;e=e.nextProducer){let t=e.producer,i=e.lastReadVersion;if(i!==t.version||(Xl(t),i!==t.version))return!0}return!1}function xr(n){if(Co(n)){let e=n.producers;for(;e!==void 0;)e=wm(e)}n.producers=void 0,n.producersTail=void 0,n.consumers=void 0,n.consumersTail=void 0}function rv(n,e){let t=n.consumersTail,i=Co(n);if(t!==void 0?(e.nextConsumer=t.nextConsumer,t.nextConsumer=e):(e.nextConsumer=void 0,n.consumers=e),e.prevConsumer=t,n.consumersTail=e,!i)for(let r=n.producers;r!==void 0;r=r.nextProducer)rv(r.producer,r)}function wm(n){let e=n.producer,t=n.nextProducer,i=n.nextConsumer,r=n.prevConsumer;if(n.nextConsumer=void 0,n.prevConsumer=void 0,i!==void 0?i.prevConsumer=r:e.consumersTail=r,r!==void 0)r.nextConsumer=i;else if(e.consumers=i,!Co(e)){let o=e.producers;for(;o!==void 0;)o=wm(o)}return t}function Co(n){return n.consumerIsAlwaysLive||n.consumers!==void 0}function eu(n){Ub?.(n)}function Hb(n,e){let t=e.producersTail;if(t!==void 0){let i=e.producers;do{if(i===n)return!0;if(i===t)break;i=i.nextProducer}while(i!==void 0)}return!1}function tu(n,e){return Object.is(n,e)}function nu(n,e){let t=Object.create(Gb);t.computation=n,e!==void 0&&(t.equal=e);let i=()=>{if(Xl(t),yo(t),t.value===na)throw t.error;return t.value};return i[Gt]=t,eu(t),i}var Jl=Symbol("UNSET"),Kl=Symbol("COMPUTING"),na=Symbol("ERRORED"),Gb=q(k({},_r),{value:Jl,dirty:!0,error:null,equal:tu,kind:"computed",producerMustRecompute(n){return n.value===Jl||n.value===Kl},producerRecomputeValue(n){if(n.value===Kl)throw new Error("");let e=n.value;n.value=Kl;let t=Cr(n),i,r=!1;try{i=n.computation(),fe(null),r=e!==Jl&&e!==na&&i!==na&&n.equal(e,i)}catch(o){i=na,n.error=o}finally{vo(n,t)}if(r){n.value=e;return}n.value=i,n.version++}});function qb(){throw new Error}var ov=qb;function sv(n){ov(n)}function Tm(n){ov=n}var Wb=null;function Im(n,e){let t=Object.create(iu);t.value=n,e!==void 0&&(t.equal=e);let i=()=>av(t);return i[Gt]=t,eu(t),[i,s=>xo(t,s),s=>Mm(t,s)]}function av(n){return yo(n),n.value}function xo(n,e){Dm()||sv(n),n.equal(n.value,e)||(n.value=e,jb(n))}function Mm(n,e){Dm()||sv(n),xo(n,e(n.value))}var iu=q(k({},_r),{equal:tu,value:void 0,kind:"signal"});function jb(n){n.version++,tv(),Sm(n),Wb?.(n)}function _e(n){return typeof n=="function"}function Eo(n){let t=n(i=>{Error.call(i),i.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var ru=Eo(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((i,r)=>`${r+1}) ${i.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function ia(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var _t=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:i}=this;if(_e(i))try{i()}catch(o){e=o instanceof ru?o.errors:[o]}let{_finalizers:r}=this;if(r){this._finalizers=null;for(let o of r)try{lv(o)}catch(s){e=e??[],s instanceof ru?e=[...e,...s.errors]:e.push(s)}}if(e)throw new ru(e)}}add(e){var t;if(e&&e!==this)if(this.closed)lv(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&ia(t,e)}remove(e){let{_finalizers:t}=this;t&&ia(t,e),e instanceof n&&e._removeParent(this)}};_t.EMPTY=(()=>{let n=new _t;return n.closed=!0,n})();var Am=_t.EMPTY;function ou(n){return n instanceof _t||n&&"closed"in n&&_e(n.remove)&&_e(n.add)&&_e(n.unsubscribe)}function lv(n){_e(n)?n():n.unsubscribe()}var Un={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var bo={setTimeout(n,e,...t){let{delegate:i}=bo;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=bo;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function su(n){bo.setTimeout(()=>{let{onUnhandledError:e}=Un;if(e)e(n);else throw n})}function ra(){}var uv=Nm("C",void 0,void 0);function cv(n){return Nm("E",void 0,n)}function dv(n){return Nm("N",n,void 0)}function Nm(n,e,t){return{kind:n,value:e,error:t}}var Er=null;function So(n){if(Un.useDeprecatedSynchronousErrorHandling){let e=!Er;if(e&&(Er={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:i}=Er;if(Er=null,t)throw i}}else n()}function fv(n){Un.useDeprecatedSynchronousErrorHandling&&Er&&(Er.errorThrown=!0,Er.error=n)}var br=class extends _t{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,ou(e)&&e.add(this)):this.destination=Jb}static create(e,t,i){return new ji(e,t,i)}next(e){this.isStopped?Pm(dv(e),this):this._next(e)}error(e){this.isStopped?Pm(cv(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Pm(uv,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},zb=Function.prototype.bind;function Rm(n,e){return zb.call(n,e)}var Fm=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){au(i)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){au(i)}else au(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){au(t)}}},ji=class extends br{constructor(e,t,i){super();let r;if(_e(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let o;this&&Un.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&Rm(e.next,o),error:e.error&&Rm(e.error,o),complete:e.complete&&Rm(e.complete,o)}):r=e}this.destination=new Fm(r)}};function au(n){Un.useDeprecatedSynchronousErrorHandling?fv(n):su(n)}function Yb(n){throw n}function Pm(n,e){let{onStoppedNotification:t}=Un;t&&bo.setTimeout(()=>t(n,e))}var Jb={closed:!0,next:ra,error:Yb,complete:ra};var Do=typeof Symbol=="function"&&Symbol.observable||"@@observable";function hn(n){return n}function km(...n){return Om(n)}function Om(n){return n.length===0?hn:n.length===1?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}var Se=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){let o=Qb(t)?t:new ji(t,i,r);return So(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return i=mv(i),new i((r,o)=>{let s=new ji({next:a=>{try{t(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(t){var i;return(i=this.source)===null||i===void 0?void 0:i.subscribe(t)}[Do](){return this}pipe(...t){return Om(t)(this)}toPromise(t){return t=mv(t),new t((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return n.create=e=>new n(e),n})();function mv(n){var e;return(e=n??Un.Promise)!==null&&e!==void 0?e:Promise}function Kb(n){return n&&_e(n.next)&&_e(n.error)&&_e(n.complete)}function Qb(n){return n&&n instanceof br||Kb(n)&&ou(n)}function Vm(n){return _e(n?.lift)}function Me(n){return e=>{if(Vm(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Te(n,e,t,i,r){return new Lm(n,e,t,i,r)}var Lm=class extends br{constructor(e,t,i,r,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=r?function(a){try{r(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function wo(){return Me((n,e)=>{let t=null;n._refCount++;let i=Te(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let r=n._connection,o=t;t=null,r&&(!o||r===o)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}var To=class extends Se{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Vm(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new _t;let t=this.getSubject();e.add(this.source.subscribe(Te(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=_t.EMPTY)}return e}refCount(){return wo()(this)}};var pv=Eo(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var pt=(()=>{class n extends Se{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let i=new lu(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new pv}next(t){So(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let i of this.currentObservers)i.next(t)}})}error(t){So(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){So(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:i,isStopped:r,observers:o}=this;return i||r?Am:(this.currentObservers=null,o.push(t),new _t(()=>{this.currentObservers=null,ia(o,t)}))}_checkFinalizedStatuses(t){let{hasError:i,thrownError:r,isStopped:o}=this;i?t.error(r):o&&t.complete()}asObservable(){let t=new Se;return t.source=this,t}}return n.create=(e,t)=>new lu(e,t),n})(),lu=class extends pt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.next)===null||i===void 0||i.call(t,e)}error(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.error)===null||i===void 0||i.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,i;return(i=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&i!==void 0?i:Am}};var Ot=class extends pt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}};var ln=new Se(n=>n.complete());function gv(n){return n&&_e(n.schedule)}function hv(n){return n[n.length-1]}function uu(n){return _e(hv(n))?n.pop():void 0}function zi(n){return gv(hv(n))?n.pop():void 0}function vv(n,e,t,i){function r(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(g){try{d(i.next(g))}catch(y){s(y)}}function c(g){try{d(i.throw(g))}catch(y){s(y)}}function d(g){g.done?o(g.value):r(g.value).then(a,c)}d((i=i.apply(n,e||[])).next())})}function yv(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Sr(n){return this instanceof Sr?(this.v=n,this):new Sr(n)}function _v(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,o=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),r[Symbol.asyncIterator]=function(){return this},r;function s(_){return function(b){return Promise.resolve(b).then(_,y)}}function a(_,b){i[_]&&(r[_]=function(I){return new Promise(function(M,A){o.push([_,I,M,A])>1||c(_,I)})},b&&(r[_]=b(r[_])))}function c(_,b){try{d(i[_](b))}catch(I){v(o[0][3],I)}}function d(_){_.value instanceof Sr?Promise.resolve(_.value.v).then(g,y):v(o[0][2],_)}function g(_){c("next",_)}function y(_){c("throw",_)}function v(_,b){_(b),o.shift(),o.length&&c(o[0][0],o[0][1])}}function Cv(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof yv=="function"?yv(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=n[o]&&function(s){return new Promise(function(a,c){s=n[o](s),r(a,c,s.done,s.value)})}}function r(o,s,a,c){Promise.resolve(c).then(function(d){o({value:d,done:a})},s)}}var cu=n=>n&&typeof n.length=="number"&&typeof n!="function";function du(n){return _e(n?.then)}function fu(n){return _e(n[Do])}function mu(n){return Symbol.asyncIterator&&_e(n?.[Symbol.asyncIterator])}function pu(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function Zb(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var gu=Zb();function hu(n){return _e(n?.[gu])}function yu(n){return _v(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:i,done:r}=yield Sr(t.read());if(r)return yield Sr(void 0);yield yield Sr(i)}}finally{t.releaseLock()}})}function vu(n){return _e(n?.getReader)}function Ct(n){if(n instanceof Se)return n;if(n!=null){if(fu(n))return Xb(n);if(cu(n))return eS(n);if(du(n))return tS(n);if(mu(n))return xv(n);if(hu(n))return nS(n);if(vu(n))return iS(n)}throw pu(n)}function Xb(n){return new Se(e=>{let t=n[Do]();if(_e(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function eS(n){return new Se(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function tS(n){return new Se(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,su)})}function nS(n){return new Se(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function xv(n){return new Se(e=>{rS(n,e).catch(t=>e.error(t))})}function iS(n){return xv(yu(n))}function rS(n,e){var t,i,r,o;return vv(this,void 0,void 0,function*(){try{for(t=Cv(n);i=yield t.next(),!i.done;){let s=i.value;if(e.next(s),e.closed)return}}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=t.return)&&(yield o.call(t))}finally{if(r)throw r.error}}e.complete()})}function un(n,e,t,i=0,r=!1){let o=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(o),!r)return o}function _u(n,e=0){return Me((t,i)=>{t.subscribe(Te(i,r=>un(i,n,()=>i.next(r),e),()=>un(i,n,()=>i.complete(),e),r=>un(i,n,()=>i.error(r),e)))})}function Cu(n,e=0){return Me((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function Ev(n,e){return Ct(n).pipe(Cu(e),_u(e))}function bv(n,e){return Ct(n).pipe(Cu(e),_u(e))}function Sv(n,e){return new Se(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}function Dv(n,e){return new Se(t=>{let i;return un(t,e,()=>{i=n[gu](),un(t,e,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){t.error(s);return}o?t.complete():t.next(r)},0,!0)}),()=>_e(i?.return)&&i.return()})}function xu(n,e){if(!n)throw new Error("Iterable cannot be null");return new Se(t=>{un(t,e,()=>{let i=n[Symbol.asyncIterator]();un(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function wv(n,e){return xu(yu(n),e)}function Tv(n,e){if(n!=null){if(fu(n))return Ev(n,e);if(cu(n))return Sv(n,e);if(du(n))return bv(n,e);if(mu(n))return xu(n,e);if(hu(n))return Dv(n,e);if(vu(n))return wv(n,e)}throw pu(n)}function it(n,e){return e?Tv(n,e):Ct(n)}function le(...n){let e=zi(n);return it(n,e)}function Di(n,e){let t=_e(n)?n:()=>n,i=r=>r.error(t());return new Se(e?r=>e.schedule(i,0,r):i)}function Bm(n){return!!n&&(n instanceof Se||_e(n.lift)&&_e(n.subscribe))}var $n=Eo(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Pe(n,e){let t=typeof e=="object";return new Promise((i,r)=>{let o=new ji({next:s=>{i(s),o.unsubscribe()},error:r,complete:()=>{t?i(e.defaultValue):r(new $n)}});n.subscribe(o)})}function pe(n,e){return Me((t,i)=>{let r=0;t.subscribe(Te(i,o=>{i.next(n.call(e,o,r++))}))})}var{isArray:oS}=Array;function sS(n,e){return oS(e)?n(...e):n(e)}function Eu(n){return pe(e=>sS(n,e))}var{isArray:aS}=Array,{getPrototypeOf:lS,prototype:uS,keys:cS}=Object;function bu(n){if(n.length===1){let e=n[0];if(aS(e))return{args:e,keys:null};if(dS(e)){let t=cS(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}function dS(n){return n&&typeof n=="object"&&lS(n)===uS}function Su(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function Du(...n){let e=zi(n),t=uu(n),{args:i,keys:r}=bu(n);if(i.length===0)return it([],e);let o=new Se(fS(i,e,r?s=>Su(r,s):hn));return t?o.pipe(Eu(t)):o}function fS(n,e,t=hn){return i=>{Iv(e,()=>{let{length:r}=n,o=new Array(r),s=r,a=r;for(let c=0;c<r;c++)Iv(e,()=>{let d=it(n[c],e),g=!1;d.subscribe(Te(i,y=>{o[c]=y,g||(g=!0,a--),a||i.next(t(o.slice()))},()=>{--s||i.complete()}))},i)},i)}}function Iv(n,e,t){n?un(t,n,e):e()}function Mv(n,e,t,i,r,o,s,a){let c=[],d=0,g=0,y=!1,v=()=>{y&&!c.length&&!d&&e.complete()},_=I=>d<i?b(I):c.push(I),b=I=>{o&&e.next(I),d++;let M=!1;Ct(t(I,g++)).subscribe(Te(e,A=>{r?.(A),o?_(A):e.next(A)},()=>{M=!0},void 0,()=>{if(M)try{for(d--;c.length&&d<i;){let A=c.shift();s?un(e,s,()=>b(A)):b(A)}v()}catch(A){e.error(A)}}))};return n.subscribe(Te(e,_,()=>{y=!0,v()})),()=>{a?.()}}function xt(n,e,t=1/0){return _e(e)?xt((i,r)=>pe((o,s)=>e(i,o,r,s))(Ct(n(i,r))),t):(typeof e=="number"&&(t=e),Me((i,r)=>Mv(i,r,n,t)))}function Io(n=1/0){return xt(hn,n)}function Av(){return Io(1)}function Mo(...n){return Av()(it(n,zi(n)))}function oa(n){return new Se(e=>{Ct(n()).subscribe(e)})}function Um(...n){let e=uu(n),{args:t,keys:i}=bu(n),r=new Se(o=>{let{length:s}=t;if(!s){o.complete();return}let a=new Array(s),c=s,d=s;for(let g=0;g<s;g++){let y=!1;Ct(t[g]).subscribe(Te(o,v=>{y||(y=!0,d--),a[g]=v},()=>c--,void 0,()=>{(!c||!y)&&(d||o.next(i?Su(i,a):a),o.complete())}))}});return e?r.pipe(Eu(e)):r}function It(n,e){return Me((t,i)=>{let r=0;t.subscribe(Te(i,o=>n.call(e,o,r++)&&i.next(o)))})}function Hn(n){return Me((e,t)=>{let i=null,r=!1,o;i=e.subscribe(Te(t,void 0,void 0,s=>{o=Ct(n(s,Hn(n)(e))),i?(i.unsubscribe(),i=null,o.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,o.subscribe(t))})}function Nv(n,e,t,i,r){return(o,s)=>{let a=t,c=e,d=0;o.subscribe(Te(s,g=>{let y=d++;c=a?n(c,g,y):(a=!0,g),i&&s.next(c)},r&&(()=>{a&&s.next(c),s.complete()})))}}function wi(n,e){return _e(e)?xt(n,e,1):xt(n,1)}function Yi(n){return Me((e,t)=>{let i=!1;e.subscribe(Te(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function Ti(n){return n<=0?()=>ln:Me((e,t)=>{let i=0;e.subscribe(Te(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function wu(n=mS){return Me((e,t)=>{let i=!1;e.subscribe(Te(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function mS(){return new $n}function Ji(n){return Me((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Ii(n,e){let t=arguments.length>=2;return i=>i.pipe(n?It((r,o)=>n(r,o,i)):hn,Ti(1),t?Yi(e):wu(()=>new $n))}function Ao(n){return n<=0?()=>ln:Me((e,t)=>{let i=[];e.subscribe(Te(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(let r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function $m(n,e){let t=arguments.length>=2;return i=>i.pipe(n?It((r,o)=>n(r,o,i)):hn,Ao(1),t?Yi(e):wu(()=>new $n))}function Hm(n,e){return Me(Nv(n,e,arguments.length>=2,!0))}function Gm(...n){let e=zi(n);return Me((t,i)=>{(e?Mo(n,t,e):Mo(n,t)).subscribe(i)})}function qt(n,e){return Me((t,i)=>{let r=null,o=0,s=!1,a=()=>s&&!r&&i.complete();t.subscribe(Te(i,c=>{r?.unsubscribe();let d=0,g=o++;Ct(n(c,g)).subscribe(r=Te(i,y=>i.next(e?e(c,y,g,d++):y),()=>{r=null,a()}))},()=>{s=!0,a()}))})}function Tu(n){return Me((e,t)=>{Ct(n).subscribe(Te(t,()=>t.complete(),ra)),!t.closed&&e.subscribe(t)})}function Ze(n,e,t){let i=_e(n)||e||t?{next:n,error:e,complete:t}:n;return i?Me((r,o)=>{var s;(s=i.subscribe)===null||s===void 0||s.call(i);let a=!0;r.subscribe(Te(o,c=>{var d;(d=i.next)===null||d===void 0||d.call(i,c),o.next(c)},()=>{var c;a=!1,(c=i.complete)===null||c===void 0||c.call(i),o.complete()},c=>{var d;a=!1,(d=i.error)===null||d===void 0||d.call(i,c),o.error(c)},()=>{var c,d;a&&((c=i.unsubscribe)===null||c===void 0||c.call(i)),(d=i.finalize)===null||d===void 0||d.call(i)}))}):hn}function Rv(n){let e=fe(null);try{return n()}finally{fe(e)}}var Pv=q(k({},_r),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!0,dirty:!0,kind:"effect"});function Fv(n){if(n.dirty=!1,n.version>0&&!_o(n))return;n.version++;let e=Cr(n);try{n.cleanup(),n.fn()}finally{vo(n,e)}}var Nu="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",j=class extends Error{code;constructor(e,t){super(Zi(e,t)),this.code=e}};function pS(n){return`NG0${Math.abs(n)}`}function Zi(n,e){return`${pS(n)}${e?": "+e:""}`}var Ni=globalThis;function Le(n){for(let e in n)if(n[e]===Le)return e;throw Error("")}function Vv(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Ai(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(Ai).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let i=t.indexOf(`
`);return i>=0?t.slice(0,i):t}function Ru(n,e){return n?e?`${n} ${e}`:n:e||""}var gS=Le({__forward_ref__:Le});function bt(n){return n.__forward_ref__=bt,n.toString=function(){return Ai(this())},n}function Vt(n){return ep(n)?n():n}function ep(n){return typeof n=="function"&&n.hasOwnProperty(gS)&&n.__forward_ref__===bt}function Y(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Tn(n){return{providers:n.providers||[],imports:n.imports||[]}}function ca(n){return hS(n,Pu)}function tp(n){return ca(n)!==null}function hS(n,e){return n.hasOwnProperty(e)&&n[e]||null}function yS(n){let e=n?.[Pu]??null;return e||null}function Wm(n){return n&&n.hasOwnProperty(Mu)?n[Mu]:null}var Pu=Le({\u0275prov:Le}),Mu=Le({\u0275inj:Le}),Z=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=Y({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function np(n){return n&&!!n.\u0275providers}var ip=Le({\u0275cmp:Le}),rp=Le({\u0275dir:Le}),op=Le({\u0275pipe:Le}),sp=Le({\u0275mod:Le}),aa=Le({\u0275fac:Le}),Mr=Le({__NG_ELEMENT_ID__:Le}),kv=Le({__NG_ENV_ID__:Le});function ui(n){return typeof n=="string"?n:n==null?"":String(n)}function Lv(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():ui(n)}var Bv=Le({ngErrorCode:Le}),vS=Le({ngErrorMessage:Le}),_S=Le({ngTokenPath:Le});function ap(n,e){return Uv("",-200,e)}function Fu(n,e){throw new j(-201,!1)}function Uv(n,e,t){let i=new j(e,n);return i[Bv]=e,i[vS]=n,t&&(i[_S]=t),i}function CS(n){return n[Bv]}var jm;function $v(){return jm}function Jt(n){let e=jm;return jm=n,e}function lp(n,e,t){let i=ca(n);if(i&&i.providedIn=="root")return i.value===void 0?i.value=i.factory():i.value;if(t&8)return null;if(e!==void 0)return e;Fu(n,"Injector")}var xS={},Dr=xS,ES="__NG_DI_FLAG__",zm=class{injector;constructor(e){this.injector=e}retrieve(e,t){let i=wr(t)||0;try{return this.injector.get(e,i&8?null:Dr,i)}catch(r){if(ho(r))return r;throw r}}};function bS(n,e=0){let t=zl();if(t===void 0)throw new j(-203,!1);if(t===null)return lp(n,void 0,e);{let i=SS(e),r=t.retrieve(n,i);if(ho(r)){if(i.optional)return null;throw r}return r}}function ie(n,e=0){return($v()||bS)(Vt(n),e)}function R(n,e){return ie(n,wr(e))}function wr(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function SS(n){return{optional:!!(n&8),host:!!(n&1),self:!!(n&2),skipSelf:!!(n&4)}}function Ym(n){let e=[];for(let t=0;t<n.length;t++){let i=Vt(n[t]);if(Array.isArray(i)){if(i.length===0)throw new j(900,!1);let r,o=0;for(let s=0;s<i.length;s++){let a=i[s],c=DS(a);typeof c=="number"?c===-1?r=a.token:o|=c:r=a}e.push(ie(r,o))}else e.push(ie(i))}return e}function DS(n){return n[ES]}function Ki(n,e){let t=n.hasOwnProperty(aa);return t?n[aa]:null}function Hv(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],o=e[i];if(t&&(r=t(r),o=t(o)),o!==r)return!1}return!0}function Gv(n){return n.flat(Number.POSITIVE_INFINITY)}function ku(n,e){n.forEach(t=>Array.isArray(t)?ku(t,e):e(t))}function up(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function da(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function qv(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(r===1)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;){let o=r-2;n[r]=n[o],r--}n[e]=t,n[e+1]=i}}function Ou(n,e,t){let i=Ro(n,e);return i>=0?n[i|1]=t:(i=~i,qv(n,i,e,t)),i}function Vu(n,e){let t=Ro(n,e);if(t>=0)return n[t|1]}function Ro(n,e){return wS(n,e,1)}function wS(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){let o=i+(r-i>>1),s=n[o<<t];if(e===s)return o<<t;s>e?r=o:i=o+1}return~(r<<t)}var Xi={},Kt=[],er=new Z(""),cp=new Z("",-1),dp=new Z(""),la=class{get(e,t=Dr){if(t===Dr){let r=Uv("",-201);throw r.name="\u0275NotFound",r}return t}};function fp(n){return n[sp]||null}function tr(n){return n[ip]||null}function mp(n){return n[rp]||null}function Wv(n){return n[op]||null}function Ar(n){return{\u0275providers:n}}function jv(...n){return{\u0275providers:pp(!0,n),\u0275fromNgModule:!0}}function pp(n,...e){let t=[],i=new Set,r,o=s=>{t.push(s)};return ku(e,s=>{let a=s;Au(a,o,[],i)&&(r||=[],r.push(a))}),r!==void 0&&zv(r,o),t}function zv(n,e){for(let t=0;t<n.length;t++){let{ngModule:i,providers:r}=n[t];gp(r,o=>{e(o,i)})}}function Au(n,e,t,i){if(n=Vt(n),!n)return!1;let r=null,o=Wm(n),s=!o&&tr(n);if(!o&&!s){let c=n.ngModule;if(o=Wm(c),o)r=c;else return!1}else{if(s&&!s.standalone)return!1;r=n}let a=i.has(r);if(s){if(a)return!1;if(i.add(r),s.dependencies){let c=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let d of c)Au(d,e,t,i)}}else if(o){if(o.imports!=null&&!a){i.add(r);let d;try{ku(o.imports,g=>{Au(g,e,t,i)&&(d||=[],d.push(g))})}finally{}d!==void 0&&zv(d,e)}if(!a){let d=Ki(r)||(()=>new r);e({provide:r,useFactory:d,deps:Kt},r),e({provide:dp,useValue:r,multi:!0},r),e({provide:er,useValue:()=>ie(r),multi:!0},r)}let c=o.providers;if(c!=null&&!a){let d=n;gp(c,g=>{e(g,d)})}}else return!1;return r!==n&&n.providers!==void 0}function gp(n,e){for(let t of n)np(t)&&(t=t.\u0275providers),Array.isArray(t)?gp(t,e):e(t)}var TS=Le({provide:String,useValue:Le});function Yv(n){return n!==null&&typeof n=="object"&&TS in n}function IS(n){return!!(n&&n.useExisting)}function MS(n){return!!(n&&n.useFactory)}function Tr(n){return typeof n=="function"}function Jv(n){return!!n.useClass}var fa=new Z(""),Iu={},Ov={},qm;function ma(){return qm===void 0&&(qm=new la),qm}var Et=class{},Ir=class extends Et{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,Km(e,s=>this.processProvider(s)),this.records.set(cp,No(void 0,this)),r.has("environment")&&this.records.set(Et,No(void 0,this));let o=this.records.get(fa);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(dp,Kt,{self:!0}))}retrieve(e,t){let i=wr(t)||0;try{return this.get(e,Dr,i)}catch(r){if(ho(r))return r;throw r}}destroy(){sa(this),this._destroyed=!0;let e=fe(null);try{for(let i of this._ngOnDestroyHooks)i.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let i of t)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),fe(e)}}onDestroy(e){return sa(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){sa(this);let t=li(this),i=Jt(void 0),r;try{return e()}finally{li(t),Jt(i)}}get(e,t=Dr,i){if(sa(this),e.hasOwnProperty(kv))return e[kv](this);let r=wr(i),o,s=li(this),a=Jt(void 0);try{if(!(r&4)){let d=this.records.get(e);if(d===void 0){let g=FS(e)&&ca(e);g&&this.injectableDefInScope(g)?d=No(Jm(e),Iu):d=null,this.records.set(e,d)}if(d!=null)return this.hydrate(e,d,r)}let c=r&2?ma():this.parent;return t=r&8&&t===Dr?null:t,c.get(e,t)}catch(c){let d=CS(c);throw d===-200||d===-201?new j(d,null):c}finally{Jt(a),li(s)}}resolveInjectorInitializers(){let e=fe(null),t=li(this),i=Jt(void 0),r;try{let o=this.get(er,Kt,{self:!0});for(let s of o)s()}finally{li(t),Jt(i),fe(e)}}toString(){let e=[],t=this.records;for(let i of t.keys())e.push(Ai(i));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=Vt(e);let t=Tr(e)?e:Vt(e&&e.provide),i=NS(e);if(!Tr(e)&&e.multi===!0){let r=this.records.get(t);r||(r=No(void 0,Iu,!0),r.factory=()=>Ym(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t,i){let r=fe(null);try{if(t.value===Ov)throw ap(Ai(e));return t.value===Iu&&(t.value=Ov,t.value=t.factory(void 0,i)),typeof t.value=="object"&&t.value&&PS(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{fe(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Vt(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Jm(n){let e=ca(n),t=e!==null?e.factory:Ki(n);if(t!==null)return t;if(n instanceof Z)throw new j(204,!1);if(n instanceof Function)return AS(n);throw new j(204,!1)}function AS(n){if(n.length>0)throw new j(204,!1);let t=yS(n);return t!==null?()=>t.factory(n):()=>new n}function NS(n){if(Yv(n))return No(void 0,n.useValue);{let e=hp(n);return No(e,Iu)}}function hp(n,e,t){let i;if(Tr(n)){let r=Vt(n);return Ki(r)||Jm(r)}else if(Yv(n))i=()=>Vt(n.useValue);else if(MS(n))i=()=>n.useFactory(...Ym(n.deps||[]));else if(IS(n))i=(r,o)=>ie(Vt(n.useExisting),o!==void 0&&o&8?8:void 0);else{let r=Vt(n&&(n.useClass||n.provide));if(RS(n))i=()=>new r(...Ym(n.deps));else return Ki(r)||Jm(r)}return i}function sa(n){if(n.destroyed)throw new j(205,!1)}function No(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function RS(n){return!!n.deps}function PS(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function FS(n){return typeof n=="function"||typeof n=="object"&&n.ngMetadataName==="InjectionToken"}function Km(n,e){for(let t of n)Array.isArray(t)?Km(t,e):t&&np(t)?Km(t.\u0275providers,e):e(t)}function At(n,e){let t;n instanceof Ir?(sa(n),t=n):t=new zm(n);let i,r=li(t),o=Jt(void 0);try{return e()}finally{li(r),Jt(o)}}function Kv(){return $v()!==void 0||zl()!=null}var Gn=0,se=1,me=2,Mt=3,In=4,Mn=5,Po=6,Fo=7,gt=8,Ri=9,ci=10,Ye=11,ko=12,yp=13,Nr=14,yn=15,nr=16,Rr=17,di=18,pa=19,vp=20,Mi=21,Lu=22,Pi=23,vn=24,Pr=25,Fr=26,rt=27,Qv=1,_p=6,ir=7,ga=8,kr=9,ct=10;function fi(n){return Array.isArray(n)&&typeof n[Qv]=="object"}function qn(n){return Array.isArray(n)&&n[Qv]===!0}function Cp(n){return(n.flags&4)!==0}function rr(n){return n.componentOffset>-1}function Oo(n){return(n.flags&1)===1}function mi(n){return!!n.template}function Vo(n){return(n[me]&512)!==0}function Or(n){return(n[me]&256)===256}var xp="svg",Zv="math";function An(n){for(;Array.isArray(n);)n=n[Gn];return n}function Ep(n,e){return An(e[n])}function Wn(n,e){return An(e[n.index])}function ha(n,e){return n.data[e]}function Bu(n,e){return n[e]}function bp(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}function Nn(n,e){let t=e[n];return fi(t)?t:t[Gn]}function Xv(n){return(n[me]&4)===4}function Uu(n){return(n[me]&128)===128}function e_(n){return qn(n[Mt])}function Rn(n,e){return e==null?null:n[e]}function Sp(n){n[Rr]=0}function Dp(n){n[me]&1024||(n[me]|=1024,Uu(n)&&or(n))}function t_(n,e){for(;n>0;)e=e[Nr],n--;return e}function ya(n){return!!(n[me]&9216||n[vn]?.dirty)}function $u(n){n[ci].changeDetectionScheduler?.notify(8),n[me]&64&&(n[me]|=1024),ya(n)&&or(n)}function or(n){n[ci].changeDetectionScheduler?.notify(0);let e=Qi(n);for(;e!==null&&!(e[me]&8192||(e[me]|=8192,!Uu(e)));)e=Qi(e)}function wp(n,e){if(Or(n))throw new j(911,!1);n[Mi]===null&&(n[Mi]=[]),n[Mi].push(e)}function n_(n,e){if(n[Mi]===null)return;let t=n[Mi].indexOf(e);t!==-1&&n[Mi].splice(t,1)}function Qi(n){let e=n[Mt];return qn(e)?e[Mt]:e}function Tp(n){return n[Fo]??=[]}function Ip(n){return n.cleanup??=[]}function i_(n,e,t,i){let r=Tp(e);r.push(t),n.firstCreatePass&&Ip(n).push(i,r.length-1)}var Ce={lFrame:h_(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var Qm=!1;function r_(){return Ce.lFrame.elementDepthCount}function o_(){Ce.lFrame.elementDepthCount++}function Mp(){Ce.lFrame.elementDepthCount--}function Hu(){return Ce.bindingsEnabled}function s_(){return Ce.skipHydrationRootTNode!==null}function Ap(n){return Ce.skipHydrationRootTNode===n}function Np(){Ce.skipHydrationRootTNode=null}function ce(){return Ce.lFrame.lView}function tt(){return Ce.lFrame.tView}function w(n){return Ce.lFrame.contextLView=n,n[gt]}function T(n){return Ce.lFrame.contextLView=null,n}function St(){let n=Rp();for(;n!==null&&n.type===64;)n=n.parent;return n}function Rp(){return Ce.lFrame.currentTNode}function a_(){let n=Ce.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function Lo(n,e){let t=Ce.lFrame;t.currentTNode=n,t.isParent=e}function Pp(){return Ce.lFrame.isParent}function l_(){Ce.lFrame.isParent=!1}function u_(){return Ce.lFrame.contextLView}function Fp(){return Qm}function Bo(n){let e=Qm;return Qm=n,e}function Gu(){let n=Ce.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function kp(){return Ce.lFrame.bindingIndex}function c_(n){return Ce.lFrame.bindingIndex=n}function sr(){return Ce.lFrame.bindingIndex++}function va(n){let e=Ce.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function d_(){return Ce.lFrame.inI18n}function f_(n,e){let t=Ce.lFrame;t.bindingIndex=t.bindingRootIndex=n,qu(e)}function m_(){return Ce.lFrame.currentDirectiveIndex}function qu(n){Ce.lFrame.currentDirectiveIndex=n}function p_(n){let e=Ce.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function Op(){return Ce.lFrame.currentQueryIndex}function Wu(n){Ce.lFrame.currentQueryIndex=n}function kS(n){let e=n[se];return e.type===2?e.declTNode:e.type===1?n[Mn]:null}function Vp(n,e,t){if(t&4){let r=e,o=n;for(;r=r.parent,r===null&&!(t&1);)if(r=kS(o),r===null||(o=o[Nr],r.type&10))break;if(r===null)return!1;e=r,n=o}let i=Ce.lFrame=g_();return i.currentTNode=e,i.lView=n,!0}function ju(n){let e=g_(),t=n[se];Ce.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function g_(){let n=Ce.lFrame,e=n===null?null:n.child;return e===null?h_(n):e}function h_(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function y_(){let n=Ce.lFrame;return Ce.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var Lp=y_;function zu(){let n=y_();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function v_(n){return(Ce.lFrame.contextLView=t_(n,Ce.lFrame.contextLView))[gt]}function jn(){return Ce.lFrame.selectedIndex}function ar(n){Ce.lFrame.selectedIndex=n}function _a(){let n=Ce.lFrame;return ha(n.tView,n.selectedIndex)}function Fi(){Ce.lFrame.currentNamespace=xp}function Vr(){OS()}function OS(){Ce.lFrame.currentNamespace=null}function __(){return Ce.lFrame.currentNamespace}var C_=!0;function Yu(){return C_}function Ca(n){C_=n}function Zm(n,e=null,t=null,i){let r=Bp(n,e,t,i);return r.resolveInjectorInitializers(),r}function Bp(n,e=null,t=null,i,r=new Set){let o=[t||Kt,jv(n)];return i=i||(typeof n=="object"?void 0:Ai(n)),new Ir(o,e||ma(),i||null,r)}var Wt=class n{static THROW_IF_NOT_FOUND=Dr;static NULL=new la;static create(e,t){if(Array.isArray(e))return Zm({name:""},t,e,"");{let i=e.name??"";return Zm({name:i},e.parent,e.providers,i)}}static \u0275prov=Y({token:n,providedIn:"any",factory:()=>ie(cp)});static __NG_ELEMENT_ID__=-1},Nt=new Z(""),Pn=(()=>{class n{static __NG_ELEMENT_ID__=VS;static __NG_ENV_ID__=t=>t}return n})(),ua=class extends Pn{_lView;constructor(e){super(),this._lView=e}get destroyed(){return Or(this._lView)}onDestroy(e){let t=this._lView;return wp(t,e),()=>n_(t,e)}};function VS(){return new ua(ce())}var Dn=class{_console=console;handleError(e){this._console.error("ERROR",e)}},cn=new Z("",{providedIn:"root",factory:()=>{let n=R(Et),e;return t=>{n.destroyed&&!e?setTimeout(()=>{throw t}):(e??=n.get(Dn),e.handleError(t))}}}),x_={provide:er,useValue:()=>void R(Dn),multi:!0};function Up(n){return typeof n=="function"&&n[Gt]!==void 0}function D(n,e){let[t,i,r]=Im(n,e?.equal),o=t,s=o[Gt];return o.set=i,o.update=r,o.asReadonly=$p.bind(o),o}function $p(){let n=this[Gt];if(n.readonlyFn===void 0){let e=()=>this();e[Gt]=n,n.readonlyFn=e}return n.readonlyFn}function Hp(n){return Up(n)&&typeof n.set=="function"}var Uo=(()=>{class n{view;node;constructor(t,i){this.view=t,this.node=i}static __NG_ELEMENT_ID__=LS}return n})();function LS(){return new Uo(ce(),St())}var wn=class{},xa=new Z("",{providedIn:"root",factory:()=>!1});var Gp=new Z(""),Ju=new Z(""),pi=(()=>{class n{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new Ot(!1);get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new Se(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=Y({token:n,providedIn:"root",factory:()=>new n})}return n})(),$o=(()=>{class n{internalPendingTasks=R(pi);scheduler=R(wn);errorHandler=R(cn);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(t))}}run(t){let i=this.add();t().catch(this.errorHandler).finally(i)}static \u0275prov=Y({token:n,providedIn:"root",factory:()=>new n})}return n})();function Lr(...n){}var Ea=(()=>{class n{static \u0275prov=Y({token:n,providedIn:"root",factory:()=>new Xm})}return n})(),Xm=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let t=e.zone,i=this.queues.get(t);i.has(e)&&(i.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let i=this.queues.get(t);i.has(e)||i.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[t,i]of this.queues)t===null?e||=this.flushQueue(i):e||=t.run(()=>this.flushQueue(i));e||(this.dirtyEffectCount=0)}}flushQueue(e){let t=!1;for(let i of e)i.dirty&&(this.dirtyEffectCount--,t=!0,i.run());return t}};function Pa(n){return{toString:n}.toString()}function qS(n){return typeof n=="function"}var rc=class{previousValue;currentValue;firstChange;constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}};function Z_(n,e,t,i){e!==null?e.applyValueToInputSignal(e,i):n[t]=i}var kn=(()=>{let n=()=>X_;return n.ngInherit=!0,n})();function X_(n){return n.type.prototype.ngOnChanges&&(n.setInput=jS),WS}function WS(){let n=t1(this),e=n?.current;if(e){let t=n.previous;if(t===Xi)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function jS(n,e,t,i,r){let o=this.declaredInputs[i],s=t1(n)||zS(n,{previous:Xi,current:null}),a=s.current||(s.current={}),c=s.previous,d=c[o];a[o]=new rc(d&&d.currentValue,t,c===Xi),Z_(n,e,r,t)}var e1="__ngSimpleChanges__";function t1(n){return n[e1]||null}function zS(n,e){return n[e1]=e}var E_=[];var He=function(n,e=null,t){for(let i=0;i<E_.length;i++){let r=E_[i];r(n,e,t)}};function YS(n,e,t){let{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=e.type.prototype;if(i){let s=X_(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}r&&(t.preOrderHooks??=[]).push(0-n,r),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function n1(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:d,ngOnDestroy:g}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),d&&((n.viewHooks??=[]).push(t,d),(n.viewCheckHooks??=[]).push(t,d)),g!=null&&(n.destroyHooks??=[]).push(t,g)}}function Xu(n,e,t){i1(n,e,3,t)}function ec(n,e,t,i){(n[me]&3)===t&&i1(n,e,t,i)}function qp(n,e){let t=n[me];(t&3)===e&&(t&=16383,t+=1,n[me]=t)}function i1(n,e,t,i){let r=i!==void 0?n[Rr]&65535:0,o=i??-1,s=e.length-1,a=0;for(let c=r;c<s;c++)if(typeof e[c+1]=="number"){if(a=e[c],i!=null&&a>=i)break}else e[c]<0&&(n[Rr]+=65536),(a<o||o==-1)&&(JS(n,t,e,c),n[Rr]=(n[Rr]&4294901760)+c+2),c++}function b_(n,e){He(4,n,e);let t=fe(null);try{e.call(n)}finally{fe(t),He(5,n,e)}}function JS(n,e,t,i){let r=t[i]<0,o=t[i+1],s=r?-t[i]:t[i],a=n[s];r?n[me]>>14<n[Rr]>>16&&(n[me]&3)===e&&(n[me]+=16384,b_(a,o)):b_(a,o)}var Go=-1,Ur=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,i,r){this.factory=e,this.name=r,this.canSeeViewProviders=t,this.injectImpl=i}};function KS(n){return(n.flags&8)!==0}function QS(n){return(n.flags&16)!==0}function ZS(n,e,t){let i=0;for(;i<t.length;){let r=t[i];if(typeof r=="number"){if(r!==0)break;i++;let o=t[i++],s=t[i++],a=t[i++];n.setAttribute(e,s,a,o)}else{let o=r,s=t[++i];XS(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),i++}}return i}function r1(n){return n===3||n===4||n===6}function XS(n){return n.charCodeAt(0)===64}function qo(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){let r=e[i];typeof r=="number"?t=r:t===0||(t===-1||t===2?S_(n,t,r,null,e[++i]):S_(n,t,r,null,null))}}return n}function S_(n,e,t,i,r){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){r!==null&&(n[o+1]=r);return}o++,r!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),r!==null&&n.splice(o++,0,r)}function o1(n){return n!==Go}function oc(n){return n&32767}function eD(n){return n>>16}function sc(n,e){let t=eD(n),i=e;for(;t>0;)i=i[Nr],t--;return i}var t0=!0;function ac(n){let e=t0;return t0=n,e}var tD=256,s1=tD-1,a1=5,nD=0,gi={};function iD(n,e,t){let i;typeof t=="string"?i=t.charCodeAt(0)||0:t.hasOwnProperty(Mr)&&(i=t[Mr]),i==null&&(i=t[Mr]=nD++);let r=i&s1,o=1<<r;e.data[n+(r>>a1)]|=o}function lc(n,e){let t=l1(n,e);if(t!==-1)return t;let i=e[se];i.firstCreatePass&&(n.injectorIndex=e.length,Wp(i.data,n),Wp(e,null),Wp(i.blueprint,null));let r=R0(n,e),o=n.injectorIndex;if(o1(r)){let s=oc(r),a=sc(r,e),c=a[se].data;for(let d=0;d<8;d++)e[o+d]=a[s+d]|c[s+d]}return e[o+8]=r,o}function Wp(n,e){n.push(0,0,0,0,0,0,0,0,e)}function l1(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function R0(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;r!==null;){if(i=m1(r),i===null)return Go;if(t++,r=r[Nr],i.injectorIndex!==-1)return i.injectorIndex|t<<16}return Go}function n0(n,e,t){iD(n,e,t)}function rD(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let i=t.length,r=0;for(;r<i;){let o=t[r];if(r1(o))break;if(o===0)r=r+2;else if(typeof o=="number")for(r++;r<i&&typeof t[r]=="string";)r++;else{if(o===e)return t[r+1];r=r+2}}}return null}function u1(n,e,t){if(t&8||n!==void 0)return n;Fu(e,"NodeInjector")}function c1(n,e,t,i){if(t&8&&i===void 0&&(i=null),(t&3)===0){let r=n[Ri],o=Jt(void 0);try{return r?r.get(e,i,t&8):lp(e,i,t&8)}finally{Jt(o)}}return u1(i,e,t)}function d1(n,e,t,i=0,r){if(n!==null){if(e[me]&2048&&!(i&2)){let s=lD(n,e,t,i,gi);if(s!==gi)return s}let o=f1(n,e,t,i,gi);if(o!==gi)return o}return c1(e,t,i,r)}function f1(n,e,t,i,r){let o=sD(t);if(typeof o=="function"){if(!Vp(e,n,i))return i&1?u1(r,t,i):c1(e,t,i,r);try{let s;if(s=o(i),s==null&&!(i&8))Fu(t);else return s}finally{Lp()}}else if(typeof o=="number"){let s=null,a=l1(n,e),c=Go,d=i&1?e[yn][Mn]:null;for((a===-1||i&4)&&(c=a===-1?R0(n,e):e[a+8],c===Go||!w_(i,!1)?a=-1:(s=e[se],a=oc(c),e=sc(c,e)));a!==-1;){let g=e[se];if(D_(o,a,g.data)){let y=oD(a,e,t,s,i,d);if(y!==gi)return y}c=e[a+8],c!==Go&&w_(i,e[se].data[a+8]===d)&&D_(o,a,e)?(s=g,a=oc(c),e=sc(c,e)):a=-1}}return r}function oD(n,e,t,i,r,o){let s=e[se],a=s.data[n+8],c=i==null?rr(a)&&t0:i!=s&&(a.type&3)!==0,d=r&1&&o===a,g=tc(a,s,t,c,d);return g!==null?Da(e,s,g,a,r):gi}function tc(n,e,t,i,r){let o=n.providerIndexes,s=e.data,a=o&1048575,c=n.directiveStart,d=n.directiveEnd,g=o>>20,y=i?a:a+g,v=r?a+g:d;for(let _=y;_<v;_++){let b=s[_];if(_<c&&t===b||_>=c&&b.type===t)return _}if(r){let _=s[c];if(_&&mi(_)&&_.type===t)return c}return null}function Da(n,e,t,i,r){let o=n[t],s=e.data;if(o instanceof Ur){let a=o;if(a.resolving){let _=Lv(s[t]);throw ap(_)}let c=ac(a.canSeeViewProviders);a.resolving=!0;let d=s[t].type||s[t],g,y=a.injectImpl?Jt(a.injectImpl):null,v=Vp(n,i,0);try{o=n[t]=a.factory(void 0,r,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&YS(t,s[t],e)}finally{y!==null&&Jt(y),ac(c),a.resolving=!1,Lp()}}return o}function sD(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(Mr)?n[Mr]:void 0;return typeof e=="number"?e>=0?e&s1:aD:e}function D_(n,e,t){let i=1<<n;return!!(t[e+(n>>a1)]&i)}function w_(n,e){return!(n&2)&&!(n&1&&e)}var Br=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return d1(this._tNode,this._lView,e,wr(i),t)}};function aD(){return new Br(St(),ce())}function Qt(n){return Pa(()=>{let e=n.prototype.constructor,t=e[aa]||i0(e),i=Object.prototype,r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){let o=r[aa]||i0(r);if(o&&o!==t)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function i0(n){return ep(n)?()=>{let e=i0(Vt(n));return e&&e()}:Ki(n)}function lD(n,e,t,i,r){let o=n,s=e;for(;o!==null&&s!==null&&s[me]&2048&&!Vo(s);){let a=f1(o,s,t,i|2,gi);if(a!==gi)return a;let c=o.parent;if(!c){let d=s[vp];if(d){let g=d.get(t,gi,i);if(g!==gi)return g}c=m1(s),s=s[Nr]}o=c}return r}function m1(n){let e=n[se],t=e.type;return t===2?e.declTNode:t===1?n[Mn]:null}function Fa(n){return rD(St(),n)}function uD(){return Yo(St(),ce())}function Yo(n,e){return new Zt(Wn(n,e))}var Zt=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=uD}return n})();function cD(n){return n instanceof Zt?n.nativeElement:n}function dD(){return this._results[Symbol.iterator]()}var uc=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new pt}constructor(e=!1){this._emitDistinctChangesOnly=e}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let i=Gv(e);(this._changesDetected=!Hv(this._results,i,t))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=dD};function p1(n){return(n.flags&128)===128}var P0=(function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n})(P0||{}),g1=new Map,fD=0;function mD(){return fD++}function pD(n){g1.set(n[pa],n)}function r0(n){g1.delete(n[pa])}var T_="__ngContext__";function Wo(n,e){fi(e)?(n[T_]=e[pa],pD(e)):n[T_]=e}function h1(n){return v1(n[ko])}function y1(n){return v1(n[In])}function v1(n){for(;n!==null&&!qn(n);)n=n[In];return n}var o0;function F0(n){o0=n}function _1(){if(o0!==void 0)return o0;if(typeof document<"u")return document;throw new j(210,!1)}var Dc=new Z("",{providedIn:"root",factory:()=>gD}),gD="ng",wc=new Z(""),ka=new Z("",{providedIn:"platform",factory:()=>"unknown"});var Tc=new Z("",{providedIn:"root",factory:()=>_1().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var hD="h",yD="b";var C1="r";var x1="di";var E1=!1,b1=new Z("",{providedIn:"root",factory:()=>E1});var vD=(n,e,t,i)=>{};function _D(n,e,t,i){vD(n,e,t,i)}function k0(n){return(n.flags&32)===32}var CD=()=>null;function S1(n,e,t=!1){return CD(n,e,t)}function D1(n,e){let t=n.contentQueries;if(t!==null){let i=fe(null);try{for(let r=0;r<t.length;r+=2){let o=t[r],s=t[r+1];if(s!==-1){let a=n.data[s];Wu(o),a.contentQueries(2,e[s],s)}}}finally{fe(i)}}}function s0(n,e,t){Wu(0);let i=fe(null);try{e(n,t)}finally{fe(i)}}function O0(n,e,t){if(Cp(e)){let i=fe(null);try{let r=e.directiveStart,o=e.directiveEnd;for(let s=r;s<o;s++){let a=n.data[s];if(a.contentQueries){let c=t[s];a.contentQueries(1,c,s)}}}finally{fe(i)}}}var ki=(function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n})(ki||{});var Ku;function xD(){if(Ku===void 0&&(Ku=null,Ni.trustedTypes))try{Ku=Ni.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Ku}function I_(n){return xD()?.createScriptURL(n)||n}var cc=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Nu})`}};function Oa(n){return n instanceof cc?n.changingThisBreaksApplicationSecurity:n}function V0(n,e){let t=w1(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${Nu})`)}return t===e}function w1(n){return n instanceof cc&&n.getTypeName()||null}var ED=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function T1(n){return n=String(n),n.match(ED)?n:"unsafe:"+n}var bD=/^>|^->|<!--|-->|--!>|<!-$/g,SD=/(<|>)/g,DD="\u200B$1\u200B";function wD(n){return n.replace(bD,e=>e.replace(SD,DD))}function TD(n,e){return n.createText(e)}function ID(n,e,t){n.setValue(e,t)}function MD(n,e){return n.createComment(wD(e))}function I1(n,e,t){return n.createElement(e,t)}function dc(n,e,t,i,r){n.insertBefore(e,t,i,r)}function M1(n,e,t){n.appendChild(e,t)}function M_(n,e,t,i,r){i!==null?dc(n,e,t,i,r):M1(n,e,t)}function A1(n,e,t,i){n.removeChild(null,e,t,i)}function AD(n,e,t){n.setAttribute(e,"style",t)}function ND(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function N1(n,e,t){let{mergedAttrs:i,classes:r,styles:o}=t;i!==null&&ZS(n,e,i),r!==null&&ND(n,e,r),o!==null&&AD(n,e,o)}var Ic=(function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n})(Ic||{});function On(n){let e=P1();return e?e.sanitize(Ic.URL,n)||"":V0(n,"URL")?Oa(n):T1(ui(n))}function R1(n){let e=P1();if(e)return I_(e.sanitize(Ic.RESOURCE_URL,n)||"");if(V0(n,"ResourceURL"))return I_(Oa(n));throw new j(904,!1)}var RD=new Set(["embed","frame","iframe","media","script"]),PD=new Set(["base","link","script"]);function FD(n,e){return e==="src"&&RD.has(n)||e==="href"&&PD.has(n)||e==="xlink:href"&&n==="script"?R1:On}function L0(n,e,t){return FD(e,t)(n)}function P1(){let n=ce();return n&&n[ci].sanitizer}function F1(n){return n instanceof Function?n():n}function kD(n,e,t){let i=n.length;for(;;){let r=n.indexOf(e,t);if(r===-1)return r;if(r===0||n.charCodeAt(r-1)<=32){let o=e.length;if(r+o===i||n.charCodeAt(r+o)<=32)return r}t=r+1}}var k1="ng-template";function OD(n,e,t,i){let r=0;if(i){for(;r<e.length&&typeof e[r]=="string";r+=2)if(e[r]==="class"&&kD(e[r+1].toLowerCase(),t,0)!==-1)return!0}else if(B0(n))return!1;if(r=e.indexOf(1,r),r>-1){let o;for(;++r<e.length&&typeof(o=e[r])=="string";)if(o.toLowerCase()===t)return!0}return!1}function B0(n){return n.type===4&&n.value!==k1}function VD(n,e,t){let i=n.type===4&&!t?k1:n.value;return e===i}function LD(n,e,t){let i=4,r=n.attrs,o=r!==null?$D(r):0,s=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!s&&!zn(i)&&!zn(c))return!1;if(s&&zn(c))continue;s=!1,i=c|i&1;continue}if(!s)if(i&4){if(i=2|i&1,c!==""&&!VD(n,c,t)||c===""&&e.length===1){if(zn(i))return!1;s=!0}}else if(i&8){if(r===null||!OD(n,r,c,t)){if(zn(i))return!1;s=!0}}else{let d=e[++a],g=BD(c,r,B0(n),t);if(g===-1){if(zn(i))return!1;s=!0;continue}if(d!==""){let y;if(g>o?y="":y=r[g+1].toLowerCase(),i&2&&d!==y){if(zn(i))return!1;s=!0}}}}return zn(i)||s}function zn(n){return(n&1)===0}function BD(n,e,t,i){if(e===null)return-1;let r=0;if(i||!t){let o=!1;for(;r<e.length;){let s=e[r];if(s===n)return r;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++r];for(;typeof a=="string";)a=e[++r];continue}else{if(s===4)break;if(s===0){r+=4;continue}}r+=o?1:2}return-1}else return HD(e,n)}function UD(n,e,t=!1){for(let i=0;i<e.length;i++)if(LD(n,e[i],t))return!0;return!1}function $D(n){for(let e=0;e<n.length;e++){let t=n[e];if(r1(t))return e}return n.length}function HD(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let i=n[t];if(typeof i=="number")return-1;if(i===e)return t;t++}return-1}function A_(n,e){return n?":not("+e.trim()+")":e}function GD(n){let e=n[0],t=1,i=2,r="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(i&2){let a=n[++t];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else i&8?r+="."+s:i&4&&(r+=" "+s);else r!==""&&!zn(s)&&(e+=A_(o,r),r=""),i=s,o=o||!zn(i);t++}return r!==""&&(e+=A_(o,r)),e}function qD(n){return n.map(GD).join(",")}function WD(n){let e=[],t=[],i=1,r=2;for(;i<n.length;){let o=n[i];if(typeof o=="string")r===2?o!==""&&e.push(o,n[++i]):r===8&&t.push(o);else{if(!zn(r))break;r=o}i++}return t.length&&e.push(1,...t),e}var Lt={};function U0(n,e,t,i,r,o,s,a,c,d,g){let y=rt+i,v=y+r,_=jD(y,v),b=typeof d=="function"?d():d;return _[se]={type:n,blueprint:_,template:t,queries:null,viewQuery:a,declTNode:e,data:_.slice().fill(null,y),bindingStartIndex:y,expandoStartIndex:v,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:c,consts:b,incompleteFirstPass:!1,ssrId:g}}function jD(n,e){let t=[];for(let i=0;i<e;i++)t.push(i<n?null:Lt);return t}function zD(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=U0(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function $0(n,e,t,i,r,o,s,a,c,d,g){let y=e.blueprint.slice();return y[Gn]=r,y[me]=i|4|128|8|64|1024,(d!==null||n&&n[me]&2048)&&(y[me]|=2048),Sp(y),y[Mt]=y[Nr]=n,y[gt]=t,y[ci]=s||n&&n[ci],y[Ye]=a||n&&n[Ye],y[Ri]=c||n&&n[Ri]||null,y[Mn]=o,y[pa]=mD(),y[Po]=g,y[vp]=d,y[yn]=e.type==2?n[yn]:y,y}function YD(n,e,t){let i=Wn(e,n),r=zD(t),o=n[ci].rendererFactory,s=H0(n,$0(n,r,null,O1(t),i,e,null,o.createRenderer(i,t),null,null,null));return n[e.index]=s}function O1(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function V1(n,e,t,i){if(t===0)return-1;let r=e.length;for(let o=0;o<t;o++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function H0(n,e){return n[ko]?n[yp][In]=e:n[ko]=e,n[yp]=e,e}function h(n=1){L1(tt(),ce(),jn()+n,!1)}function L1(n,e,t,i){if(!i)if((e[me]&3)===3){let o=n.preOrderCheckHooks;o!==null&&Xu(e,o,t)}else{let o=n.preOrderHooks;o!==null&&ec(e,o,0,t)}ar(t)}var Mc=(function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n})(Mc||{});function a0(n,e,t,i){let r=fe(null);try{let[o,s,a]=n.inputs[t],c=null;(s&Mc.SignalBased)!==0&&(c=e[o][Gt]),c!==null&&c.transformFn!==void 0?i=c.transformFn(i):a!==null&&(i=a.call(e,i)),n.setInput!==null?n.setInput(e,c,i,t,o):Z_(e,c,o,i)}finally{fe(r)}}var hi=(function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n})(hi||{}),JD;function G0(n,e){return JD(n,e)}var $r=new Set,Ac=(function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n})(Ac||{}),Wr=new Z(""),N_=new Set;function Oi(n){N_.has(n)||(N_.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var B1=!1,l0=class extends pt{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,Kv()&&(this.destroyRef=R(Pn,{optional:!0})??void 0,this.pendingTasks=R(pi,{optional:!0})??void 0)}emit(e){let t=fe(null);try{super.next(e)}finally{fe(t)}}subscribe(e,t,i){let r=e,o=t||(()=>null),s=i;if(e&&typeof e=="object"){let c=e;r=c.next?.bind(c),o=c.error?.bind(c),s=c.complete?.bind(c)}this.__isAsync&&(o=this.wrapInTimeout(o),r&&(r=this.wrapInTimeout(r)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:r,error:o,complete:s});return e instanceof _t&&e.add(a),a}wrapInTimeout(e){return t=>{let i=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{i!==void 0&&this.pendingTasks?.remove(i)}})}}},ot=l0;function U1(n){let e,t;function i(){n=Lr;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),i()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),i()})),()=>i()}function R_(n){return queueMicrotask(()=>n()),()=>{n=Lr}}var q0="isAngularZone",fc=q0+"_ID",KD=0,ht=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new ot(!1);onMicrotaskEmpty=new ot(!1);onStable=new ot(!1);onError=new ot(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:o=B1}=e;if(typeof Zone>"u")throw new j(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!r&&i,s.shouldCoalesceRunChangeDetection=r,s.callbackScheduled=!1,s.scheduleInRootZone=o,XD(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(q0)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new j(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new j(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,e,QD,Lr,Lr);try{return o.runTask(s,t,i)}finally{o.cancelTask(s)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}},QD={};function W0(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function ZD(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){U1(()=>{n.callbackScheduled=!1,u0(n),n.isCheckStableRunning=!0,W0(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),u0(n)}function XD(n){let e=()=>{ZD(n)},t=KD++;n._inner=n._inner.fork({name:"angular",properties:{[q0]:!0,[fc]:t,[fc+t]:!0},onInvokeTask:(i,r,o,s,a,c)=>{if(ew(c))return i.invokeTask(o,s,a,c);try{return P_(n),i.invokeTask(o,s,a,c)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),F_(n)}},onInvoke:(i,r,o,s,a,c,d)=>{try{return P_(n),i.invoke(o,s,a,c,d)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!tw(c)&&e(),F_(n)}},onHasTask:(i,r,o,s)=>{i.hasTask(o,s),r===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,u0(n),W0(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(i,r,o,s)=>(i.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function u0(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function P_(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function F_(n){n._nesting--,W0(n)}var wa=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new ot;onMicrotaskEmpty=new ot;onStable=new ot;onError=new ot;run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}};function ew(n){return $1(n,"__ignore_ng_zone__")}function tw(n){return $1(n,"__scheduler_tick__")}function $1(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var j0=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=Y({token:n,providedIn:"root",factory:()=>new n})}return n})(),H1=[0,1,2,3],G1=(()=>{class n{ngZone=R(ht);scheduler=R(wn);errorHandler=R(Dn,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){R(Wr,{optional:!0})}execute(){let t=this.sequences.size>0;t&&He(16),this.executing=!0;for(let i of H1)for(let r of this.sequences)if(!(r.erroredOrDestroyed||!r.hooks[i]))try{r.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let o=r.hooks[i];return o(r.pipelinedValue)},r.snapshot))}catch(o){r.erroredOrDestroyed=!0,this.errorHandler?.handleError(o)}this.executing=!1;for(let i of this.sequences)i.afterRun(),i.once&&(this.sequences.delete(i),i.destroy());for(let i of this.deferredRegistrations)this.sequences.add(i);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),t&&He(17)}register(t){let{view:i}=t;i!==void 0?((i[Pr]??=[]).push(t),or(i),i[me]|=8192):this.executing?this.deferredRegistrations.add(t):this.addSequence(t)}addSequence(t){this.sequences.add(t),this.scheduler.notify(7)}unregister(t){this.executing&&this.sequences.has(t)?(t.erroredOrDestroyed=!0,t.pipelinedValue=void 0,t.once=!0):(this.sequences.delete(t),this.deferredRegistrations.delete(t))}maybeTrace(t,i){return i?i.run(Ac.AFTER_NEXT_RENDER,t):t()}static \u0275prov=Y({token:n,providedIn:"root",factory:()=>new n})}return n})(),mc=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(e,t,i,r,o,s=null){this.impl=e,this.hooks=t,this.view=i,this.once=r,this.snapshot=s,this.unregisterOnDestroy=o?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let e=this.view?.[Pr];e&&(this.view[Pr]=e.filter(t=>t!==this))}};function Vi(n,e){let t=e?.injector??R(Wt);return Oi("NgAfterNextRender"),iw(n,t,e,!0)}function nw(n){return n instanceof Function?[void 0,void 0,n,void 0]:[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function iw(n,e,t,i){let r=e.get(j0);r.impl??=e.get(G1);let o=e.get(Wr,null,{optional:!0}),s=t?.manualCleanup!==!0?e.get(Pn):null,a=e.get(Uo,null,{optional:!0}),c=new mc(r.impl,nw(n),a?.view,i,s,o?.snapshot(null));return r.impl.register(c),c}var q1=new Z("",{providedIn:"root",factory:()=>({queue:new Set,isScheduled:!1,scheduler:null})});function W1(n,e,t){let i=n.get(q1);if(Array.isArray(e))for(let r of e)i.queue.add(r),t?.detachedLeaveAnimationFns?.push(r);else i.queue.add(e),t?.detachedLeaveAnimationFns?.push(e);i.scheduler&&i.scheduler(n)}function rw(n,e){let t=n.get(q1);if(e.detachedLeaveAnimationFns){for(let i of e.detachedLeaveAnimationFns)t.queue.delete(i);e.detachedLeaveAnimationFns=void 0}}function ow(n,e){for(let[t,i]of e)W1(n,i.animateFns)}function k_(n,e,t,i){let r=n?.[Fr]?.enter;e!==null&&r&&r.has(t.index)&&ow(i,r)}function Ho(n,e,t,i,r,o,s,a){if(r!=null){let c,d=!1;qn(r)?c=r:fi(r)&&(d=!0,r=r[Gn]);let g=An(r);n===0&&i!==null?(k_(a,i,o,t),s==null?M1(e,i,g):dc(e,i,g,s||null,!0)):n===1&&i!==null?(k_(a,i,o,t),dc(e,i,g,s||null,!0)):n===2?O_(a,o,t,y=>{A1(e,g,d,y)}):n===3&&O_(a,o,t,()=>{e.destroyNode(g)}),c!=null&&vw(e,n,t,c,o,i,s)}}function sw(n,e){j1(n,e),e[Gn]=null,e[Mn]=null}function aw(n,e,t,i,r,o){i[Gn]=r,i[Mn]=e,Rc(n,i,t,1,r,o)}function j1(n,e){e[ci].changeDetectionScheduler?.notify(9),Rc(n,e,e[Ye],2,null,null)}function lw(n){let e=n[ko];if(!e)return jp(n[se],n);for(;e;){let t=null;if(fi(e))t=e[ko];else{let i=e[ct];i&&(t=i)}if(!t){for(;e&&!e[In]&&e!==n;)fi(e)&&jp(e[se],e),e=e[Mt];e===null&&(e=n),fi(e)&&jp(e[se],e),t=e&&e[In]}e=t}}function z0(n,e){let t=n[kr],i=t.indexOf(e);t.splice(i,1)}function Nc(n,e){if(Or(e))return;let t=e[Ye];t.destroyNode&&Rc(n,e,t,3,null,null),lw(e)}function jp(n,e){if(Or(e))return;let t=fe(null);try{e[me]&=-129,e[me]|=256,e[vn]&&xr(e[vn]),dw(n,e),cw(n,e),e[se].type===1&&e[Ye].destroy();let i=e[nr];if(i!==null&&qn(e[Mt])){i!==e[Mt]&&z0(i,e);let r=e[di];r!==null&&r.detachView(n)}r0(e)}finally{fe(t)}}function O_(n,e,t,i){let r=n?.[Fr];if(r==null||r.leave==null||!r.leave.has(e.index))return i(!1);n&&$r.add(n),W1(t,()=>{if(r.leave&&r.leave.has(e.index)){let s=r.leave.get(e.index),a=[];if(s){for(let c=0;c<s.animateFns.length;c++){let d=s.animateFns[c],{promise:g}=d();a.push(g)}r.detachedLeaveAnimationFns=void 0}r.running=Promise.allSettled(a),uw(n,i)}else n&&$r.delete(n),i(!1)},r)}function uw(n,e){let t=n[Fr]?.running;if(t){t.then(()=>{n[Fr].running=void 0,$r.delete(n),e(!0)});return}e(!1)}function cw(n,e){let t=n.cleanup,i=e[Fo];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let a=t[s+3];a>=0?i[a]():i[-a].unsubscribe(),s+=2}else{let a=i[t[s+1]];t[s].call(a)}i!==null&&(e[Fo]=null);let r=e[Mi];if(r!==null){e[Mi]=null;for(let s=0;s<r.length;s++){let a=r[s];a()}}let o=e[Pi];if(o!==null){e[Pi]=null;for(let s of o)s.destroy()}}function dw(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let i=0;i<t.length;i+=2){let r=e[t[i]];if(!(r instanceof Ur)){let o=t[i+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=r[o[s]],c=o[s+1];He(4,a,c);try{c.call(a)}finally{He(5,a,c)}}else{He(4,r,o);try{o.call(r)}finally{He(5,r,o)}}}}}function fw(n,e,t){return mw(n,e.parent,t)}function mw(n,e,t){let i=e;for(;i!==null&&i.type&168;)e=i,i=e.parent;if(i===null)return t[Gn];if(rr(i)){let{encapsulation:r}=n.data[i.directiveStart+i.componentOffset];if(r===ki.None||r===ki.Emulated)return null}return Wn(i,t)}function pw(n,e,t){return hw(n,e,t)}function gw(n,e,t){return n.type&40?Wn(n,t):null}var hw=gw,V_;function Y0(n,e,t,i){let r=fw(n,i,e),o=e[Ye],s=i.parent||e[Mn],a=pw(s,i,e);if(r!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)M_(o,r,t[c],a,!1);else M_(o,r,t,a,!1);V_!==void 0&&V_(o,i,e,t,r)}function ba(n,e){if(e!==null){let t=e.type;if(t&3)return Wn(e,n);if(t&4)return c0(-1,n[e.index]);if(t&8){let i=e.child;if(i!==null)return ba(n,i);{let r=n[e.index];return qn(r)?c0(-1,r):An(r)}}else{if(t&128)return ba(n,e.next);if(t&32)return G0(e,n)()||An(n[e.index]);{let i=z1(n,e);if(i!==null){if(Array.isArray(i))return i[0];let r=Qi(n[yn]);return ba(r,i)}else return ba(n,e.next)}}}return null}function z1(n,e){if(e!==null){let i=n[yn][Mn],r=e.projection;return i.projection[r]}return null}function c0(n,e){let t=ct+n+1;if(t<e.length){let i=e[t],r=i[se].firstChild;if(r!==null)return ba(i,r)}return e[ir]}function J0(n,e,t,i,r,o,s){for(;t!=null;){let a=i[Ri];if(t.type===128){t=t.next;continue}let c=i[t.index],d=t.type;if(s&&e===0&&(c&&Wo(An(c),i),t.flags|=2),!k0(t))if(d&8)J0(n,e,t.child,i,r,o,!1),Ho(e,n,a,r,c,t,o,i);else if(d&32){let g=G0(t,i),y;for(;y=g();)Ho(e,n,a,r,y,t,o,i);Ho(e,n,a,r,c,t,o,i)}else d&16?yw(n,e,i,t,r,o):Ho(e,n,a,r,c,t,o,i);t=s?t.projectionNext:t.next}}function Rc(n,e,t,i,r,o){J0(t,i,n.firstChild,e,r,o,!1)}function yw(n,e,t,i,r,o){let s=t[yn],c=s[Mn].projection[i.projection];if(Array.isArray(c))for(let d=0;d<c.length;d++){let g=c[d];Ho(e,n,t[Ri],r,g,i,o,t)}else{let d=c,g=s[Mt];p1(i)&&(d.flags|=128),J0(n,e,d,g,r,o,!0)}}function vw(n,e,t,i,r,o,s){let a=i[ir],c=An(i);a!==c&&Ho(e,n,t,o,a,r,s);for(let d=ct;d<i.length;d++){let g=i[d];Rc(g[se],g,n,e,o,a)}}function _w(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let o=i.indexOf("-")===-1?void 0:hi.DashCase;r==null?n.removeStyle(t,i,o):(typeof r=="string"&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=hi.Important),n.setStyle(t,i,r,o))}}function Y1(n,e,t,i,r){let o=jn(),s=i&2;try{ar(-1),s&&e.length>rt&&L1(n,e,rt,!1),He(s?2:0,r,t),t(i,r)}finally{ar(o),He(s?3:1,r,t)}}function Pc(n,e,t){Dw(n,e,t),(t.flags&64)===64&&ww(n,e,t)}function Va(n,e,t=Wn){let i=e.localNames;if(i!==null){let r=e.index+1;for(let o=0;o<i.length;o+=2){let s=i[o+1],a=s===-1?t(e,n):n[s];n[r++]=a}}}function Cw(n,e,t,i){let o=i.get(b1,E1)||t===ki.ShadowDom,s=n.selectRootElement(e,o);return xw(s),s}function xw(n){Ew(n)}var Ew=()=>null;function bw(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function J1(n,e,t,i,r,o){let s=e[se];if(X0(n,s,e,t,i)){rr(n)&&Sw(e,n.index);return}n.type&3&&(t=bw(t)),K1(n,e,t,i,r,o)}function K1(n,e,t,i,r,o){if(n.type&3){let s=Wn(n,e);i=o!=null?o(i,n.value||"",t):i,r.setProperty(s,t,i)}else n.type&12}function Sw(n,e){let t=Nn(e,n);t[me]&16||(t[me]|=64)}function Dw(n,e,t){let i=t.directiveStart,r=t.directiveEnd;rr(t)&&YD(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||lc(t,e);let o=t.initialInputs;for(let s=i;s<r;s++){let a=n.data[s],c=Da(e,n,s,t);if(Wo(c,e),o!==null&&Aw(e,s-i,c,a,t,o),mi(a)){let d=Nn(t.index,e);d[gt]=Da(e,n,s,t)}}}function ww(n,e,t){let i=t.directiveStart,r=t.directiveEnd,o=t.index,s=m_();try{ar(o);for(let a=i;a<r;a++){let c=n.data[a],d=e[a];qu(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&Tw(c,d)}}finally{ar(-1),qu(s)}}function Tw(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function K0(n,e){let t=n.directiveRegistry,i=null;if(t)for(let r=0;r<t.length;r++){let o=t[r];UD(e,o.selectors,!1)&&(i??=[],mi(o)?i.unshift(o):i.push(o))}return i}function Iw(n,e,t,i,r,o){let s=Wn(n,e);Mw(e[Ye],s,o,n.value,t,i,r)}function Mw(n,e,t,i,r,o,s){if(o==null)n.removeAttribute(e,r,t);else{let a=s==null?ui(o):s(o,i||"",r);n.setAttribute(e,r,a,t)}}function Aw(n,e,t,i,r,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;a+=2){let c=s[a],d=s[a+1];a0(i,t,c,d)}}function Q0(n,e,t,i,r){let o=rt+t,s=e[se],a=r(s,e,n,i,t);e[o]=a,Lo(n,!0);let c=n.type===2;return c?(N1(e[Ye],a,n),(r_()===0||Oo(n))&&Wo(a,e),o_()):Wo(a,e),Yu()&&(!c||!k0(n))&&Y0(s,e,a,n),n}function Z0(n){let e=n;return Pp()?l_():(e=e.parent,Lo(e,!1)),e}function Nw(n,e){let t=n[Ri];if(!t)return;let i;try{i=t.get(cn,null)}catch{i=null}i?.(e)}function X0(n,e,t,i,r){let o=n.inputs?.[i],s=n.hostDirectiveInputs?.[i],a=!1;if(s)for(let c=0;c<s.length;c+=2){let d=s[c],g=s[c+1],y=e.data[d];a0(y,t[d],g,r),a=!0}if(o)for(let c of o){let d=t[c],g=e.data[c];a0(g,d,i,r),a=!0}return a}function Rw(n,e){let t=Nn(e,n),i=t[se];Pw(i,t);let r=t[Gn];r!==null&&t[Po]===null&&(t[Po]=S1(r,t[Ri])),He(18),eg(i,t,t[gt]),He(19,t[gt])}function Pw(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function eg(n,e,t){ju(e);try{let i=n.viewQuery;i!==null&&s0(1,i,t);let r=n.template;r!==null&&Y1(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[di]?.finishViewCreation(n),n.staticContentQueries&&D1(n,e),n.staticViewQueries&&s0(2,n.viewQuery,t);let o=n.components;o!==null&&Fw(e,o)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[me]&=-5,zu()}}function Fw(n,e){for(let t=0;t<e.length;t++)Rw(n,e[t])}function Fc(n,e,t,i){let r=fe(null);try{let o=e.tView,a=n[me]&4096?4096:16,c=$0(n,o,t,a,null,e,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null),d=n[e.index];c[nr]=d;let g=n[di];return g!==null&&(c[di]=g.createEmbeddedView(o)),eg(o,c,t),c}finally{fe(r)}}function Ta(n,e){return!e||e.firstChild===null||p1(n)}function Ia(n,e,t,i,r=!1){for(;t!==null;){if(t.type===128){t=r?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&i.push(An(o)),qn(o)&&Q1(o,i);let s=t.type;if(s&8)Ia(n,e,t.child,i);else if(s&32){let a=G0(t,e),c;for(;c=a();)i.push(c)}else if(s&16){let a=z1(e,t);if(Array.isArray(a))i.push(...a);else{let c=Qi(e[yn]);Ia(c[se],c,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function Q1(n,e){for(let t=ct;t<n.length;t++){let i=n[t],r=i[se].firstChild;r!==null&&Ia(i[se],i,r,e)}n[ir]!==n[Gn]&&e.push(n[ir])}function Z1(n){if(n[Pr]!==null){for(let e of n[Pr])e.impl.addSequence(e);n[Pr].length=0}}var X1=[];function kw(n){return n[vn]??Ow(n)}function Ow(n){let e=X1.pop()??Object.create(Lw);return e.lView=n,e}function Vw(n){n.lView[vn]!==n&&(n.lView=null,X1.push(n))}var Lw=q(k({},_r),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{or(n.lView)},consumerOnSignalRead(){this.lView[vn]=this}});function Bw(n){let e=n[vn]??Object.create(Uw);return e.lView=n,e}var Uw=q(k({},_r),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=Qi(n.lView);for(;e&&!eC(e[se]);)e=Qi(e);e&&Dp(e)},consumerOnSignalRead(){this.lView[vn]=this}});function eC(n){return n.type!==2}function tC(n){if(n[Pi]===null)return;let e=!0;for(;e;){let t=!1;for(let i of n[Pi])i.dirty&&(t=!0,i.zone===null||Zone.current===i.zone?i.run():i.zone.run(()=>i.run()));e=t&&!!(n[me]&8192)}}var $w=100;function nC(n,e=0){let i=n[ci].rendererFactory,r=!1;r||i.begin?.();try{Hw(n,e)}finally{r||i.end?.()}}function Hw(n,e){let t=Fp();try{Bo(!0),d0(n,e);let i=0;for(;ya(n);){if(i===$w)throw new j(103,!1);i++,d0(n,1)}}finally{Bo(t)}}function Gw(n,e,t,i){if(Or(e))return;let r=e[me],o=!1,s=!1;ju(e);let a=!0,c=null,d=null;o||(eC(n)?(d=kw(e),c=Cr(d)):Zl()===null?(a=!1,d=Bw(e),c=Cr(d)):e[vn]&&(xr(e[vn]),e[vn]=null));try{Sp(e),c_(n.bindingStartIndex),t!==null&&Y1(n,e,t,2,i);let g=(r&3)===3;if(!o)if(g){let _=n.preOrderCheckHooks;_!==null&&Xu(e,_,null)}else{let _=n.preOrderHooks;_!==null&&ec(e,_,0,null),qp(e,0)}if(s||qw(e),tC(e),iC(e,0),n.contentQueries!==null&&D1(n,e),!o)if(g){let _=n.contentCheckHooks;_!==null&&Xu(e,_)}else{let _=n.contentHooks;_!==null&&ec(e,_,1),qp(e,1)}jw(n,e);let y=n.components;y!==null&&oC(e,y,0);let v=n.viewQuery;if(v!==null&&s0(2,v,i),!o)if(g){let _=n.viewCheckHooks;_!==null&&Xu(e,_)}else{let _=n.viewHooks;_!==null&&ec(e,_,2),qp(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Lu]){for(let _ of e[Lu])_();e[Lu]=null}o||(Z1(e),e[me]&=-73)}catch(g){throw o||or(e),g}finally{d!==null&&(vo(d,c),a&&Vw(d)),zu()}}function iC(n,e){for(let t=h1(n);t!==null;t=y1(t))for(let i=ct;i<t.length;i++){let r=t[i];rC(r,e)}}function qw(n){for(let e=h1(n);e!==null;e=y1(e)){if(!(e[me]&2))continue;let t=e[kr];for(let i=0;i<t.length;i++){let r=t[i];Dp(r)}}}function Ww(n,e,t){He(18);let i=Nn(e,n);rC(i,t),He(19,i[gt])}function rC(n,e){Uu(n)&&d0(n,e)}function d0(n,e){let i=n[se],r=n[me],o=n[vn],s=!!(e===0&&r&16);if(s||=!!(r&64&&e===0),s||=!!(r&1024),s||=!!(o?.dirty&&_o(o)),s||=!1,o&&(o.dirty=!1),n[me]&=-9217,s)Gw(i,n,i.template,n[gt]);else if(r&8192){let a=fe(null);try{tC(n),iC(n,1);let c=i.components;c!==null&&oC(n,c,1),Z1(n)}finally{fe(a)}}}function oC(n,e,t){for(let i=0;i<e.length;i++)Ww(n,e[i],t)}function jw(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let i=0;i<t.length;i++){let r=t[i];if(r<0)ar(~r);else{let o=r,s=t[++i],a=t[++i];f_(s,o);let c=e[o];He(24,c),a(2,c),He(25,c)}}}finally{ar(-1)}}function tg(n,e){let t=Fp()?64:1088;for(n[ci].changeDetectionScheduler?.notify(e);n;){n[me]|=t;let i=Qi(n);if(Vo(n)&&!i)return n;n=i}return null}function sC(n,e,t,i){return[n,!0,0,e,null,i,null,t,null,null]}function aC(n,e){let t=ct+e;if(t<n.length)return n[t]}function kc(n,e,t,i=!0){let r=e[se];if(zw(r,e,n,t),i){let s=c0(t,n),a=e[Ye],c=a.parentNode(n[ir]);c!==null&&aw(r,n[Mn],a,e,c,s)}let o=e[Po];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function lC(n,e){let t=Ma(n,e);return t!==void 0&&Nc(t[se],t),t}function Ma(n,e){if(n.length<=ct)return;let t=ct+e,i=n[t];if(i){let r=i[nr];r!==null&&r!==n&&z0(r,i),e>0&&(n[t-1][In]=i[In]);let o=da(n,ct+e);sw(i[se],i);let s=o[di];s!==null&&s.detachView(o[se]),i[Mt]=null,i[In]=null,i[me]&=-129}return i}function zw(n,e,t,i){let r=ct+i,o=t.length;i>0&&(t[r-1][In]=e),i<o-ct?(e[In]=t[r],up(t,ct+i,e)):(t.push(e),e[In]=null),e[Mt]=t;let s=e[nr];s!==null&&t!==s&&uC(s,e);let a=e[di];a!==null&&a.insertView(n),$u(e),e[me]|=128}function uC(n,e){let t=n[kr],i=e[Mt];if(fi(i))n[me]|=2;else{let r=i[Mt][yn];e[yn]!==r&&(n[me]|=2)}t===null?n[kr]=[e]:t.push(e)}var lr=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,t=e[se];return Ia(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t}get context(){return this._lView[gt]}set context(e){this._lView[gt]=e}get destroyed(){return Or(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Mt];if(qn(e)){let t=e[ga],i=t?t.indexOf(this):-1;i>-1&&(Ma(e,i),da(t,i))}this._attachedToViewContainer=!1}Nc(this._lView[se],this._lView)}onDestroy(e){wp(this._lView,e)}markForCheck(){tg(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[me]&=-129}reattach(){$u(this._lView),this._lView[me]|=128}detectChanges(){this._lView[me]|=1024,nC(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new j(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=Vo(this._lView),t=this._lView[nr];t!==null&&!e&&z0(t,this._lView),j1(this._lView[se],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new j(902,!1);this._appRef=e;let t=Vo(this._lView),i=this._lView[nr];i!==null&&!t&&uC(i,this._lView),$u(this._lView)}};var ur=(()=>{class n{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=Yw;constructor(t,i,r){this._declarationLView=t,this._declarationTContainer=i,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,i){return this.createEmbeddedViewImpl(t,i)}createEmbeddedViewImpl(t,i,r){let o=Fc(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:i,dehydratedView:r});return new lr(o)}}return n})();function Yw(){return ng(St(),ce())}function ng(n,e){return n.type&4?new ur(e,n,Yo(n,e)):null}function La(n,e,t,i,r){let o=n.data[e];if(o===null)o=Jw(n,e,t,i,r),d_()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=i,o.attrs=r;let s=a_();o.injectorIndex=s===null?-1:s.injectorIndex}return Lo(o,!0),o}function Jw(n,e,t,i,r){let o=Rp(),s=Pp(),a=s?o:o&&o.parent,c=n.data[e]=Qw(n,a,t,e,i,r);return Kw(n,c,o,s),c}function Kw(n,e,t,i){n.firstChild===null&&(n.firstChild=e),t!==null&&(i?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function Qw(n,e,t,i,r,o){let s=e?e.injectorIndex:-1,a=0;return s_()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var Bz=new RegExp(`^(\\d+)*(${yD}|${hD})*(.*)`);function Zw(n){let e=n[_p]??[],i=n[Mt][Ye],r=[];for(let o of e)o.data[x1]!==void 0?r.push(o):Xw(o,i);n[_p]=r}function Xw(n,e){let t=0,i=n.firstChild;if(i){let r=n.data[C1];for(;t<r;){let o=i.nextSibling;A1(e,i,!1),i=o,t++}}}var eT=()=>null,tT=()=>null;function f0(n,e){return eT(n,e)}function cC(n,e,t){return tT(n,e,t)}var dC=class{},Oc=class{},m0=class{resolveComponentFactory(e){throw new j(917,!1)}},Ba=class{static NULL=new m0},Hr=class{},Jn=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>nT()}return n})();function nT(){let n=ce(),e=St(),t=Nn(e.index,n);return(fi(t)?t:n)[Ye]}var fC=(()=>{class n{static \u0275prov=Y({token:n,providedIn:"root",factory:()=>null})}return n})();var nc={},p0=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){let r=this.injector.get(e,nc,i);return r!==nc||t===nc?r:this.parentInjector.get(e,t,i)}};function pc(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)r=Ru(r,a);else if(o==2){let c=a,d=e[++s];i=Ru(i,c+": "+d+";")}}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function J(n,e=0){let t=ce();if(t===null)return ie(n,e);let i=St();return d1(i,t,Vt(n),e)}function mC(n,e,t,i,r){let o=i===null?null:{"":-1},s=r(n,t);if(s!==null){let a=s,c=null,d=null;for(let g of s)if(g.resolveHostDirectives!==null){[a,c,d]=g.resolveHostDirectives(s);break}oT(n,e,t,a,o,c,d)}o!==null&&i!==null&&iT(t,i,o)}function iT(n,e,t){let i=n.localNames=[];for(let r=0;r<e.length;r+=2){let o=t[e[r+1]];if(o==null)throw new j(-301,!1);i.push(e[r],o)}}function rT(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function oT(n,e,t,i,r,o,s){let a=i.length,c=!1;for(let v=0;v<a;v++){let _=i[v];!c&&mi(_)&&(c=!0,rT(n,t,v)),n0(lc(t,e),n,_.type)}dT(t,n.data.length,a);for(let v=0;v<a;v++){let _=i[v];_.providersResolver&&_.providersResolver(_)}let d=!1,g=!1,y=V1(n,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let v=0;v<a;v++){let _=i[v];if(t.mergedAttrs=qo(t.mergedAttrs,_.hostAttrs),aT(n,t,e,y,_),cT(y,_,r),s!==null&&s.has(_)){let[I,M]=s.get(_);t.directiveToIndex.set(_.type,[y,I+t.directiveStart,M+t.directiveStart])}else(o===null||!o.has(_))&&t.directiveToIndex.set(_.type,y);_.contentQueries!==null&&(t.flags|=4),(_.hostBindings!==null||_.hostAttrs!==null||_.hostVars!==0)&&(t.flags|=64);let b=_.type.prototype;!d&&(b.ngOnChanges||b.ngOnInit||b.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),d=!0),!g&&(b.ngOnChanges||b.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),g=!0),y++}sT(n,t,o)}function sT(n,e,t){for(let i=e.directiveStart;i<e.directiveEnd;i++){let r=n.data[i];if(t===null||!t.has(r))L_(0,e,r,i),L_(1,e,r,i),U_(e,i,!1);else{let o=t.get(r);B_(0,e,o,i),B_(1,e,o,i),U_(e,i,!0)}}}function L_(n,e,t,i){let r=n===0?t.inputs:t.outputs;for(let o in r)if(r.hasOwnProperty(o)){let s;n===0?s=e.inputs??={}:s=e.outputs??={},s[o]??=[],s[o].push(i),pC(e,o)}}function B_(n,e,t,i){let r=n===0?t.inputs:t.outputs;for(let o in r)if(r.hasOwnProperty(o)){let s=r[o],a;n===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[s]??=[],a[s].push(i,o),pC(e,s)}}function pC(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function U_(n,e,t){let{attrs:i,inputs:r,hostDirectiveInputs:o}=n;if(i===null||!t&&r===null||t&&o===null||B0(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let s=null,a=0;for(;a<i.length;){let c=i[a];if(c===0){a+=4;continue}else if(c===5){a+=2;continue}else if(typeof c=="number")break;if(!t&&r.hasOwnProperty(c)){let d=r[c];for(let g of d)if(g===e){s??=[],s.push(c,i[a+1]);break}}else if(t&&o.hasOwnProperty(c)){let d=o[c];for(let g=0;g<d.length;g+=2)if(d[g]===e){s??=[],s.push(d[g+1],i[a+1]);break}}a+=2}n.initialInputs??=[],n.initialInputs.push(s)}function aT(n,e,t,i,r){n.data[i]=r;let o=r.factory||(r.factory=Ki(r.type,!0)),s=new Ur(o,mi(r),J,null);n.blueprint[i]=s,t[i]=s,lT(n,e,i,V1(n,t,r.hostVars,Lt),r)}function lT(n,e,t,i,r){let o=r.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;uT(s)!=a&&s.push(a),s.push(t,i,o)}}function uT(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function cT(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;mi(e)&&(t[""]=n)}}function dT(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function ig(n,e,t,i,r,o,s,a){let c=e[se],d=c.consts,g=Rn(d,s),y=La(c,n,t,i,g);return o&&mC(c,e,y,Rn(d,a),r),y.mergedAttrs=qo(y.mergedAttrs,y.attrs),y.attrs!==null&&pc(y,y.attrs,!1),y.mergedAttrs!==null&&pc(y,y.mergedAttrs,!0),c.queries!==null&&c.queries.elementStart(c,y),y}function rg(n,e){n1(n,e),Cp(e)&&n.queries.elementEnd(e)}function fT(n,e,t,i,r,o){let s=e.consts,a=Rn(s,r),c=La(e,n,t,i,a);if(c.mergedAttrs=qo(c.mergedAttrs,c.attrs),o!=null){let d=Rn(s,o);c.localNames=[];for(let g=0;g<d.length;g+=2)c.localNames.push(d[g],-1)}return c.attrs!==null&&pc(c,c.attrs,!1),c.mergedAttrs!==null&&pc(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function og(n){return hC(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function gC(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),i;for(;!(i=t.next()).done;)e(i.value)}}function hC(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function sg(n,e,t){return n[e]=t}function mT(n,e){return n[e]}function Fn(n,e,t){if(t===Lt)return!1;let i=n[e];return Object.is(i,t)?!1:(n[e]=t,!0)}function Aa(n,e,t,i){let r=Fn(n,e,t);return Fn(n,e+1,i)||r}function pT(n,e,t,i,r){let o=Aa(n,e,t,i);return Fn(n,e+2,r)||o}function gT(n,e,t,i,r,o){let s=Aa(n,e,t,i);return Aa(n,e+2,r,o)||s}function ic(n,e,t){return function i(r){let o=rr(n)?Nn(n.index,e):e;tg(o,5);let s=e[gt],a=$_(e,s,t,r),c=i.__ngNextListenerFn__;for(;c;)a=$_(e,s,c,r)&&a,c=c.__ngNextListenerFn__;return a}}function $_(n,e,t,i){let r=fe(null);try{return He(6,e,t),t(i)!==!1}catch(o){return Nw(n,o),!1}finally{He(7,e,t),fe(r)}}function yC(n,e,t,i,r,o,s,a){let c=Oo(n),d=!1,g=null;if(!i&&c&&(g=yT(e,t,o,n.index)),g!==null){let y=g.__ngLastListenerFn__||g;y.__ngNextListenerFn__=s,g.__ngLastListenerFn__=s,d=!0}else{let y=Wn(n,t),v=i?i(y):y;_D(t,v,o,a);let _=r.listen(v,o,a);if(!hT(o)){let b=i?I=>i(An(I[n.index])):n.index;vC(b,e,t,o,a,_,!1)}}return d}function hT(n){return n.startsWith("animation")||n.startsWith("transition")}function yT(n,e,t,i){let r=n.cleanup;if(r!=null)for(let o=0;o<r.length-1;o+=2){let s=r[o];if(s===t&&r[o+1]===i){let a=e[Fo],c=r[o+2];return a&&a.length>c?a[c]:null}typeof s=="string"&&(o+=2)}return null}function vC(n,e,t,i,r,o,s){let a=e.firstCreatePass?Ip(e):null,c=Tp(t),d=c.length;c.push(r,o),a&&a.push(i,n,d,(d+1)*(s?-1:1))}function H_(n,e,t,i,r,o){let s=e[t],a=e[se],d=a.data[t].outputs[i],y=s[d].subscribe(o);vC(n.index,a,e,r,o,y,!0)}var g0=Symbol("BINDING");var gc=class extends Ba{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=tr(e);return new jo(t,this.ngModule)}};function vT(n){return Object.keys(n).map(e=>{let[t,i,r]=n[e],o={propName:t,templateName:e,isSignal:(i&Mc.SignalBased)!==0};return r&&(o.transform=r),o})}function _T(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function CT(n,e,t){let i=e instanceof Et?e:e?.injector;return i&&n.getStandaloneInjector!==null&&(i=n.getStandaloneInjector(i)||i),i?new p0(t,i):t}function xT(n){let e=n.get(Hr,null);if(e===null)throw new j(407,!1);let t=n.get(fC,null),i=n.get(wn,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:i,ngReflect:!1}}function ET(n,e){let t=_C(n);return I1(e,t,t==="svg"?xp:t==="math"?Zv:null)}function _C(n){return(n.selectors[0][0]||"div").toLowerCase()}var jo=class extends Oc{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=vT(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=_T(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=qD(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,i,r,o,s){He(22);let a=fe(null);try{let c=this.componentDef,d=bT(i,c,s,o),g=CT(c,r||this.ngModule,e),y=xT(g),v=y.rendererFactory.createRenderer(null,c),_=i?Cw(v,i,c.encapsulation,g):ET(c,v),b=s?.some(G_)||o?.some(A=>typeof A!="function"&&A.bindings.some(G_)),I=$0(null,d,null,512|O1(c),null,null,y,v,g,null,S1(_,g,!0));I[rt]=_,ju(I);let M=null;try{let A=ig(rt,I,2,"#host",()=>d.directiveRegistry,!0,0);N1(v,_,A),Wo(_,I),Pc(d,I,A),O0(d,A,I),rg(d,A),t!==void 0&&DT(A,this.ngContentSelectors,t),M=Nn(A.index,I),I[gt]=M[gt],eg(d,I,null)}catch(A){throw M!==null&&r0(M),r0(I),A}finally{He(23),zu()}return new hc(this.componentType,I,!!b)}finally{fe(a)}}};function bT(n,e,t,i){let r=n?["ng-version","20.3.16"]:WD(e.selectors[0]),o=null,s=null,a=0;if(t)for(let g of t)a+=g[g0].requiredVars,g.create&&(g.targetIdx=0,(o??=[]).push(g)),g.update&&(g.targetIdx=0,(s??=[]).push(g));if(i)for(let g=0;g<i.length;g++){let y=i[g];if(typeof y!="function")for(let v of y.bindings){a+=v[g0].requiredVars;let _=g+1;v.create&&(v.targetIdx=_,(o??=[]).push(v)),v.update&&(v.targetIdx=_,(s??=[]).push(v))}}let c=[e];if(i)for(let g of i){let y=typeof g=="function"?g:g.type,v=mp(y);c.push(v)}return U0(0,null,ST(o,s),1,a,c,null,null,null,[r],null)}function ST(n,e){return!n&&!e?null:t=>{if(t&1&&n)for(let i of n)i.create();if(t&2&&e)for(let i of e)i.update()}}function G_(n){let e=n[g0].kind;return e==="input"||e==="twoWay"}var hc=class extends dC{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t,i){super(),this._rootLView=t,this._hasInputBindings=i,this._tNode=ha(t[se],rt),this.location=Yo(this._tNode,t),this.instance=Nn(this._tNode.index,t)[gt],this.hostView=this.changeDetectorRef=new lr(t,void 0),this.componentType=e}setInput(e,t){this._hasInputBindings;let i=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let r=this._rootLView,o=X0(i,r[se],r,e,t);this.previousInputValues.set(e,t);let s=Nn(i.index,r);tg(s,1)}get injector(){return new Br(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function DT(n,e,t){let i=n.projection=[];for(let r=0;r<e.length;r++){let o=t[r];i.push(o!=null&&o.length?Array.from(o):null)}}var Li=(()=>{class n{static __NG_ELEMENT_ID__=wT}return n})();function wT(){let n=St();return xC(n,ce())}var TT=Li,CC=class extends TT{_lContainer;_hostTNode;_hostLView;constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Yo(this._hostTNode,this._hostLView)}get injector(){return new Br(this._hostTNode,this._hostLView)}get parentInjector(){let e=R0(this._hostTNode,this._hostLView);if(o1(e)){let t=sc(e,this._hostLView),i=oc(e),r=t[se].data[i+8];return new Br(r,t)}else return new Br(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=q_(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-ct}createEmbeddedView(e,t,i){let r,o;typeof i=="number"?r=i:i!=null&&(r=i.index,o=i.injector);let s=f0(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,r,Ta(this._hostTNode,s)),a}createComponent(e,t,i,r,o,s,a){let c=e&&!qS(e),d;if(c)d=t;else{let M=t||{};d=M.index,i=M.injector,r=M.projectableNodes,o=M.environmentInjector||M.ngModuleRef,s=M.directives,a=M.bindings}let g=c?e:new jo(tr(e)),y=i||this.parentInjector;if(!o&&g.ngModule==null){let A=(c?y:this.parentInjector).get(Et,null);A&&(o=A)}let v=tr(g.componentType??{}),_=f0(this._lContainer,v?.id??null),b=_?.firstChild??null,I=g.create(y,r,b,o,s,a);return this.insertImpl(I.hostView,d,Ta(this._hostTNode,_)),I}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){let r=e._lView;if(e_(r)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=r[Mt],d=new CC(c,c[Mn],c[Mt]);d.detach(d.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return kc(s,r,o,i),e.attachToViewContainerRef(),up(zp(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=q_(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),i=Ma(this._lContainer,t);i&&(da(zp(this._lContainer),t),Nc(i[se],i))}detach(e){let t=this._adjustIndex(e,-1),i=Ma(this._lContainer,t);return i&&da(zp(this._lContainer),t)!=null?new lr(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function q_(n){return n[ga]}function zp(n){return n[ga]||(n[ga]=[])}function xC(n,e){let t,i=e[n.index];return qn(i)?t=i:(t=sC(i,e,null,n),e[n.index]=t,H0(e,t)),MT(t,e,n,i),new CC(t,n,e)}function IT(n,e){let t=n[Ye],i=t.createComment(""),r=Wn(e,n),o=t.parentNode(r);return dc(t,o,i,t.nextSibling(r),!1),i}var MT=RT,AT=()=>!1;function NT(n,e,t){return AT(n,e,t)}function RT(n,e,t,i){if(n[ir])return;let r;t.type&8?r=An(i):r=IT(e,t),n[ir]=r}var h0=class n{queryList;matches=null;constructor(e){this.queryList=e}clone(){return new n(this.queryList)}setDirty(){this.queryList.setDirty()}},y0=class n{queries;constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let i=e.contentQueries!==null?e.contentQueries[0]:t.length,r=[];for(let o=0;o<i;o++){let s=t.getByIndex(o),a=this.queries[s.indexInDeclarationView];r.push(a.clone())}return new n(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)ag(e,t).matches!==null&&this.queries[t].setDirty()}},yc=class{flags;read;predicate;constructor(e,t,i=null){this.flags=t,this.read=i,typeof e=="string"?this.predicate=UT(e):this.predicate=e}},v0=class n{queries;constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){let r=t!==null?t.length:0,o=this.getByIndex(i).embeddedTView(e,r);o&&(o.indexInDeclarationView=i,t!==null?t.push(o):t=[o])}return t!==null?new n(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},_0=class n{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(e,t=-1){this.metadata=e,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new n(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,i=e.parent;for(;i!==null&&i.type&8&&i.index!==t;)i=i.parent;return t===(i!==null?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){let o=i[r];this.matchTNodeWithReadOption(e,t,PT(t,o)),this.matchTNodeWithReadOption(e,t,tc(t,e,o,!1,!1))}else i===ur?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,tc(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(i!==null){let r=this.metadata.read;if(r!==null)if(r===Zt||r===Li||r===ur&&t.type&4)this.addMatch(t.index,-2);else{let o=tc(t,e,r,!1,!1);o!==null&&this.addMatch(t.index,o)}else this.addMatch(t.index,i)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function PT(n,e){let t=n.localNames;if(t!==null){for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1]}return null}function FT(n,e){return n.type&11?Yo(n,e):n.type&4?ng(n,e):null}function kT(n,e,t,i){return t===-1?FT(e,n):t===-2?OT(n,e,i):Da(n,n[se],t,e)}function OT(n,e,t){if(t===Zt)return Yo(e,n);if(t===ur)return ng(e,n);if(t===Li)return xC(e,n)}function EC(n,e,t,i){let r=e[di].queries[i];if(r.matches===null){let o=n.data,s=t.matches,a=[];for(let c=0;s!==null&&c<s.length;c+=2){let d=s[c];if(d<0)a.push(null);else{let g=o[d];a.push(kT(e,g,s[c+1],t.metadata.read))}}r.matches=a}return r.matches}function C0(n,e,t,i){let r=n.queries.getByIndex(t),o=r.matches;if(o!==null){let s=EC(n,e,r,t);for(let a=0;a<o.length;a+=2){let c=o[a];if(c>0)i.push(s[a/2]);else{let d=o[a+1],g=e[-c];for(let y=ct;y<g.length;y++){let v=g[y];v[nr]===v[Mt]&&C0(v[se],v,d,i)}if(g[kr]!==null){let y=g[kr];for(let v=0;v<y.length;v++){let _=y[v];C0(_[se],_,d,i)}}}}}return i}function VT(n,e){return n[di].queries[e].queryList}function bC(n,e,t){let i=new uc((t&4)===4);return i_(n,e,i,i.destroy),(e[di]??=new y0).queries.push(new h0(i))-1}function LT(n,e,t){let i=tt();return i.firstCreatePass&&(SC(i,new yc(n,e,t),-1),(e&2)===2&&(i.staticViewQueries=!0)),bC(i,ce(),e)}function BT(n,e,t,i){let r=tt();if(r.firstCreatePass){let o=St();SC(r,new yc(e,t,i),o.index),$T(r,n),(t&2)===2&&(r.staticContentQueries=!0)}return bC(r,ce(),t)}function UT(n){return n.split(",").map(e=>e.trim())}function SC(n,e,t){n.queries===null&&(n.queries=new v0),n.queries.track(new _0(e,t))}function $T(n,e){let t=n.contentQueries||(n.contentQueries=[]),i=t.length?t[t.length-1]:-1;e!==i&&t.push(n.queries.length-1,e)}function ag(n,e){return n.queries.getByIndex(e)}function HT(n,e){let t=n[se],i=ag(t,e);return i.crossesNgTemplate?C0(t,n,e,[]):EC(t,n,i,e)}var Gr=class{},Vc=class{};var vc=class extends Gr{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new gc(this);constructor(e,t,i,r=!0){super(),this.ngModuleType=e,this._parent=t;let o=fp(e);this._bootstrapComponents=F1(o.bootstrap),this._r3Injector=Bp(e,t,[{provide:Gr,useValue:this},{provide:Ba,useValue:this.componentFactoryResolver},...i],Ai(e),new Set(["environment"])),r&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},_c=class extends Vc{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new vc(this.moduleType,e,[])}};var Na=class extends Gr{injector;componentFactoryResolver=new gc(this);instance=null;constructor(e){super();let t=new Ir([...e.providers,{provide:Gr,useValue:this},{provide:Ba,useValue:this.componentFactoryResolver}],e.parent||ma(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Ua(n,e,t=null){return new Na({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var GT=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let i=pp(!1,t.type),r=i.length>0?Ua([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=Y({token:n,providedIn:"environment",factory:()=>new n(ie(Et))})}return n})();function ee(n){return Pa(()=>{let e=DC(n),t=q(k({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===P0.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?r=>r.get(GT).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||ki.Emulated,styles:n.styles||Kt,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&Oi("NgStandalone"),wC(t);let i=n.dependencies;return t.directiveDefs=W_(i,qT),t.pipeDefs=W_(i,Wv),t.id=zT(t),t})}function qT(n){return tr(n)||mp(n)}function Kn(n){return Pa(()=>({type:n.type,bootstrap:n.bootstrap||Kt,declarations:n.declarations||Kt,imports:n.imports||Kt,exports:n.exports||Kt,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function WT(n,e){if(n==null)return Xi;let t={};for(let i in n)if(n.hasOwnProperty(i)){let r=n[i],o,s,a,c;Array.isArray(r)?(a=r[0],o=r[1],s=r[2]??o,c=r[3]||null):(o=r,s=r,a=Mc.None,c=null),t[o]=[i,a,c],e[o]=s}return t}function jT(n){if(n==null)return Xi;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function Ie(n){return Pa(()=>{let e=DC(n);return wC(e),e})}function $a(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function DC(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||Xi,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||Kt,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:WT(n.inputs,e),outputs:jT(n.outputs),debugInfo:null}}function wC(n){n.features?.forEach(e=>e(n))}function W_(n,e){return n?()=>{let t=typeof n=="function"?n():n,i=[];for(let r of t){let o=e(r);o!==null&&i.push(o)}return i}:null}function zT(n){let e=0,t=typeof n.consts=="function"?"":n.consts,i=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of i.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function YT(n){return Object.getPrototypeOf(n.prototype).constructor}function dt(n){let e=YT(n.type),t=!0,i=[n];for(;e;){let r;if(mi(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new j(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);let s=n;s.inputs=Yp(n.inputs),s.declaredInputs=Yp(n.declaredInputs),s.outputs=Yp(n.outputs);let a=r.hostBindings;a&&XT(n,a);let c=r.viewQuery,d=r.contentQueries;if(c&&QT(n,c),d&&ZT(n,d),JT(n,r),Vv(n.outputs,r.outputs),mi(r)&&r.data.animation){let g=n.data;g.animation=(g.animation||[]).concat(r.data.animation)}}let o=r.features;if(o)for(let s=0;s<o.length;s++){let a=o[s];a&&a.ngInherit&&a(n),a===dt&&(t=!1)}}e=Object.getPrototypeOf(e)}KT(i)}function JT(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let i=e.inputs[t];i!==void 0&&(n.inputs[t]=i,n.declaredInputs[t]=e.declaredInputs[t])}}function KT(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){let r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=qo(r.hostAttrs,t=qo(t,r.hostAttrs))}}function Yp(n){return n===Xi?{}:n===Kt?[]:n}function QT(n,e){let t=n.viewQuery;t?n.viewQuery=(i,r)=>{e(i,r),t(i,r)}:n.viewQuery=e}function ZT(n,e){let t=n.contentQueries;t?n.contentQueries=(i,r,o)=>{e(i,r,o),t(i,r,o)}:n.contentQueries=e}function XT(n,e){let t=n.hostBindings;t?n.hostBindings=(i,r)=>{e(i,r),t(i,r)}:n.hostBindings=e}function TC(n,e,t,i,r,o,s,a){if(t.firstCreatePass){n.mergedAttrs=qo(n.mergedAttrs,n.attrs);let g=n.tView=U0(2,n,r,o,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,t.consts,null);t.queries!==null&&(t.queries.template(t,n),g.queries=t.queries.embeddedTView(n))}a&&(n.flags|=a),Lo(n,!1);let c=tI(t,e,n,i);Yu()&&Y0(t,e,c,n),Wo(c,e);let d=sC(c,e,c,n);e[i+rt]=d,H0(e,d),NT(d,n,e)}function eI(n,e,t,i,r,o,s,a,c,d,g){let y=t+rt,v;return e.firstCreatePass?(v=La(e,y,4,s||null,a||null),Hu()&&mC(e,n,v,Rn(e.consts,d),K0),n1(e,v)):v=e.data[y],TC(v,n,e,t,i,r,o,c),Oo(v)&&Pc(e,n,v),d!=null&&Va(n,v,g),v}function Cc(n,e,t,i,r,o,s,a,c,d,g){let y=t+rt,v;if(e.firstCreatePass){if(v=La(e,y,4,s||null,a||null),d!=null){let _=Rn(e.consts,d);v.localNames=[];for(let b=0;b<_.length;b+=2)v.localNames.push(_[b],-1)}}else v=e.data[y];return TC(v,n,e,t,i,r,o,c),d!=null&&Va(n,v,g),v}function Qn(n,e,t,i,r,o,s,a){let c=ce(),d=tt(),g=Rn(d.consts,o);return eI(c,d,n,e,t,i,r,g,void 0,s,a),Qn}var tI=nI;function nI(n,e,t,i){return Ca(!0),e[Ye].createComment("")}var lg=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var ug=new Z("");function cr(n){return!!n&&typeof n.then=="function"}function cg(n){return!!n&&typeof n.subscribe=="function"}var IC=new Z("");var dg=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i});appInits=R(IC,{optional:!0})??[];injector=R(Wt);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let r of this.appInits){let o=At(this.injector,r);if(cr(o))t.push(o);else if(cg(o)){let s=new Promise((a,c)=>{o.subscribe({complete:a,error:c})});t.push(s)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),t.length===0&&i(),this.initialized=!0}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Lc=new Z("");function MC(){Tm(()=>{let n="";throw new j(600,n)})}function AC(n){return n.isBoundToModule}var iI=10;var Bi=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=R(cn);afterRenderManager=R(j0);zonelessEnabled=R(xa);rootEffectScheduler=R(Ea);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new pt;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=R(pi);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(pe(t=>!t))}constructor(){R(Wr,{optional:!0})}whenStable(){let t;return new Promise(i=>{t=this.isStable.subscribe({next:r=>{r&&i()}})}).finally(()=>{t.unsubscribe()})}_injector=R(Et);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,i){return this.bootstrapImpl(t,i)}bootstrapImpl(t,i,r=Wt.NULL){return this._injector.get(ht).run(()=>{He(10);let s=t instanceof Oc;if(!this._injector.get(dg).done){let b="";throw new j(405,b)}let c;s?c=t:c=this._injector.get(Ba).resolveComponentFactory(t),this.componentTypes.push(c.componentType);let d=AC(c)?void 0:this._injector.get(Gr),g=i||c.selector,y=c.create(r,[],g,d),v=y.location.nativeElement,_=y.injector.get(ug,null);return _?.registerApplication(v),y.onDestroy(()=>{this.detachView(y.hostView),Sa(this.components,y),_?.unregisterApplication(v)}),this._loadComponent(y),He(11,y),y})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){He(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(Ac.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new j(101,!1);let t=fe(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,fe(t),this.afterTick.next(),He(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Hr,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<iI;)He(14),this.synchronizeOnce(),He(15)}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let i=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r}of this.allViews){if(!i&&!ya(r))continue;let o=i&&!this.zonelessEnabled?0:1;nC(r,o),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>ya(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){let i=t;Sa(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(r){this.internalErrorHandler(r)}this.components.push(t),this._injector.get(Lc,[]).forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Sa(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new j(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Sa(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function ft(n,e,t,i){let r=ce(),o=sr();if(Fn(r,o,e)){let s=tt(),a=_a();Iw(a,r,n,e,t,i)}return ft}var jz=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";var x0=class{destroy(e){}updateValue(e,t){}swap(e,t){let i=Math.min(e,t),r=Math.max(e,t),o=this.detach(r);if(r-i>1){let s=this.detach(i);this.attach(i,o),this.attach(r,s)}else this.attach(i,o)}move(e,t){this.attach(t,this.detach(e))}};function Jp(n,e,t,i,r){return n===t&&Object.is(e,i)?1:Object.is(r(n,e),r(t,i))?-1:0}function rI(n,e,t){let i,r,o=0,s=n.length-1,a=void 0;if(Array.isArray(e)){let c=e.length-1;for(;o<=s&&o<=c;){let d=n.at(o),g=e[o],y=Jp(o,d,o,g,t);if(y!==0){y<0&&n.updateValue(o,g),o++;continue}let v=n.at(s),_=e[c],b=Jp(s,v,c,_,t);if(b!==0){b<0&&n.updateValue(s,_),s--,c--;continue}let I=t(o,d),M=t(s,v),A=t(o,g);if(Object.is(A,M)){let B=t(c,_);Object.is(B,I)?(n.swap(o,s),n.updateValue(s,_),c--,s--):n.move(s,o),n.updateValue(o,g),o++;continue}if(i??=new xc,r??=z_(n,o,s,t),E0(n,i,o,A))n.updateValue(o,g),o++,s++;else if(r.has(A))i.set(I,n.detach(o)),s--;else{let B=n.create(o,e[o]);n.attach(o,B),o++,s++}}for(;o<=c;)j_(n,i,t,o,e[o]),o++}else if(e!=null){let c=e[Symbol.iterator](),d=c.next();for(;!d.done&&o<=s;){let g=n.at(o),y=d.value,v=Jp(o,g,o,y,t);if(v!==0)v<0&&n.updateValue(o,y),o++,d=c.next();else{i??=new xc,r??=z_(n,o,s,t);let _=t(o,y);if(E0(n,i,o,_))n.updateValue(o,y),o++,s++,d=c.next();else if(!r.has(_))n.attach(o,n.create(o,y)),o++,s++,d=c.next();else{let b=t(o,g);i.set(b,n.detach(o)),s--}}}for(;!d.done;)j_(n,i,t,n.length,d.value),d=c.next()}for(;o<=s;)n.destroy(n.detach(s--));i?.forEach(c=>{n.destroy(c)})}function E0(n,e,t,i){return e!==void 0&&e.has(i)?(n.attach(t,e.get(i)),e.delete(i),!0):!1}function j_(n,e,t,i,r){if(E0(n,e,i,t(i,r)))n.updateValue(i,r);else{let o=n.create(i,r);n.attach(i,o)}}function z_(n,e,t,i){let r=new Set;for(let o=e;o<=t;o++)r.add(i(o,n.at(o)));return r}var xc=class{kvMap=new Map;_vMap=void 0;has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let t=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let i=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let r=this._vMap;for(;r.has(i);)i=r.get(i);r.set(i,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,i]of this.kvMap)if(e(i,t),this._vMap!==void 0){let r=this._vMap;for(;r.has(i);)i=r.get(i),e(i,t)}}};function P(n,e,t,i,r,o,s,a){Oi("NgControlFlow");let c=ce(),d=tt(),g=Rn(d.consts,o);return Cc(c,d,n,e,t,i,r,g,256,s,a),fg}function fg(n,e,t,i,r,o,s,a){Oi("NgControlFlow");let c=ce(),d=tt(),g=Rn(d.consts,o);return Cc(c,d,n,e,t,i,r,g,512,s,a),fg}function F(n,e){Oi("NgControlFlow");let t=ce(),i=sr(),r=t[i]!==Lt?t[i]:-1,o=r!==-1?Ec(t,rt+r):void 0,s=0;if(Fn(t,i,n)){let a=fe(null);try{if(o!==void 0&&lC(o,s),n!==-1){let c=rt+n,d=Ec(t,c),g=w0(t[se],c),y=cC(d,g,t),v=Fc(t,g,e,{dehydratedView:y});kc(d,v,s,Ta(g,y))}}finally{fe(a)}}else if(o!==void 0){let a=aC(o,s);a!==void 0&&(a[gt]=e)}}var b0=class{lContainer;$implicit;$index;constructor(e,t,i){this.lContainer=e,this.$implicit=t,this.$index=i}get $count(){return this.lContainer.length-ct}};function _n(n){return n}function W(n,e){return e}var S0=class{hasEmptyBlock;trackByFn;liveCollection;constructor(e,t,i){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=i}};function O(n,e,t,i,r,o,s,a,c,d,g,y,v){Oi("NgControlFlow");let _=ce(),b=tt(),I=c!==void 0,M=ce(),A=a?s.bind(M[yn][gt]):s,B=new S0(I,A);M[rt+n]=B,Cc(_,b,n+1,e,t,i,r,Rn(b.consts,o),256),I&&Cc(_,b,n+2,c,d,g,y,Rn(b.consts,v),512)}var D0=class extends x0{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(e,t,i){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=i}get length(){return this.lContainer.length-ct}at(e){return this.getLView(e)[gt].$implicit}attach(e,t){let i=t[Po];this.needsIndexUpdate||=e!==this.length,kc(this.lContainer,t,e,Ta(this.templateTNode,i)),oI(this.lContainer,e)}detach(e){return this.needsIndexUpdate||=e!==this.length-1,sI(this.lContainer,e),aI(this.lContainer,e)}create(e,t){let i=f0(this.lContainer,this.templateTNode.tView.ssrId),r=Fc(this.hostLView,this.templateTNode,new b0(this.lContainer,t,e),{dehydratedView:i});return this.operationsCounter?.recordCreate(),r}destroy(e){Nc(e[se],e),this.operationsCounter?.recordDestroy()}updateValue(e,t){this.getLView(e)[gt].$implicit=t}reset(){this.needsIndexUpdate=!1,this.operationsCounter?.reset()}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[gt].$index=e}getLView(e){return lI(this.lContainer,e)}};function V(n){let e=fe(null),t=jn();try{let i=ce(),r=i[se],o=i[t],s=t+1,a=Ec(i,s);if(o.liveCollection===void 0){let d=w0(r,s);o.liveCollection=new D0(a,i,d)}else o.liveCollection.reset();let c=o.liveCollection;if(rI(c,n,o.trackByFn),c.updateIndexes(),o.hasEmptyBlock){let d=sr(),g=c.length===0;if(Fn(i,d,g)){let y=t+2,v=Ec(i,y);if(g){let _=w0(r,y),b=cC(v,_,i),I=Fc(i,_,void 0,{dehydratedView:b});kc(v,I,0,Ta(_,b))}else r.firstUpdatePass&&Zw(v),lC(v,0)}}}finally{fe(e)}}function Ec(n,e){return n[e]}function oI(n,e){if(n.length<=ct)return;let t=ct+e,i=n[t],r=i?i[Fr]:void 0;if(i&&r&&r.detachedLeaveAnimationFns&&r.detachedLeaveAnimationFns.length>0){let o=i[Ri];rw(o,r),$r.delete(i),r.detachedLeaveAnimationFns=void 0}}function sI(n,e){if(n.length<=ct)return;let t=ct+e,i=n[t],r=i?i[Fr]:void 0;r&&r.leave&&r.leave.size>0&&(r.detachedLeaveAnimationFns=[])}function aI(n,e){return Ma(n,e)}function lI(n,e){return aC(n,e)}function w0(n,e){return ha(n,e)}function N(n,e,t){let i=ce(),r=sr();if(Fn(i,r,e)){let o=tt(),s=_a();J1(s,i,n,e,i[Ye],t)}return N}function T0(n,e,t,i,r){X0(e,n,t,r?"class":"style",i)}function l(n,e,t,i){let r=ce(),o=r[se],s=n+rt,a=o.firstCreatePass?ig(s,r,2,e,K0,Hu(),t,i):o.data[s];if(Q0(a,r,n,e,NC),Oo(a)){let c=r[se];Pc(c,r,a),O0(c,a,r)}return i!=null&&Va(r,a),l}function u(){let n=tt(),e=St(),t=Z0(e);return n.firstCreatePass&&rg(n,t),Ap(t)&&Np(),Mp(),t.classesWithoutHost!=null&&KS(t)&&T0(n,t,ce(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&QS(t)&&T0(n,t,ce(),t.stylesWithoutHost,!1),u}function x(n,e,t,i){return l(n,e,t,i),u(),x}function Xe(n,e,t,i){let r=ce(),o=r[se],s=n+rt,a=o.firstCreatePass?fT(s,o,2,e,t,i):o.data[s];return Q0(a,r,n,e,NC),i!=null&&Va(r,a),Xe}function et(){let n=St(),e=Z0(n);return Ap(e)&&Np(),Mp(),et}function Ui(n,e,t,i){return Xe(n,e,t,i),et(),Ui}var NC=(n,e,t,i,r)=>(Ca(!0),I1(e[Ye],i,__()));function Bc(n,e,t){let i=ce(),r=i[se],o=n+rt,s=r.firstCreatePass?ig(o,i,8,"ng-container",K0,Hu(),e,t):r.data[o];if(Q0(s,i,n,"ng-container",uI),Oo(s)){let a=i[se];Pc(a,i,s),O0(a,s,i)}return t!=null&&Va(i,s),Bc}function Uc(){let n=tt(),e=St(),t=Z0(e);return n.firstCreatePass&&rg(n,t),Uc}var uI=(n,e,t,i,r)=>(Ca(!0),MD(e[Ye],""));function U(){return ce()}function $c(n,e,t){let i=ce(),r=sr();if(Fn(i,r,e)){let o=tt(),s=_a();K1(s,i,n,e,i[Ye],t)}return $c}var Qu=void 0;function cI(n){let e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return e===1&&t===0?1:5}var dI=["en",[["a","p"],["AM","PM"]],[["AM","PM"]],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Qu,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Qu,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Qu,"{1} 'at' {0}",Qu],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",cI],Kp={};function Xt(n){let e=fI(n),t=Y_(e);if(t)return t;let i=e.split("-")[0];if(t=Y_(i),t)return t;if(i==="en")return dI;throw new j(701,!1)}function Y_(n){return n in Kp||(Kp[n]=Ni.ng&&Ni.ng.common&&Ni.ng.common.locales&&Ni.ng.common.locales[n]),Kp[n]}var st=(function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n})(st||{});function fI(n){return n.toLowerCase().replace(/_/g,"-")}var Ha="en-US",mI="USD";var pI=Ha;function RC(n){typeof n=="string"&&(pI=n.toLowerCase().replace(/_/g,"-"))}function S(n,e,t){let i=ce(),r=tt(),o=St();return PC(r,i,i[Ye],o,n,e,t),S}function Jo(n,e,t){let i=ce(),r=tt(),o=St();return(o.type&3||t)&&yC(o,r,i,t,i[Ye],n,e,ic(o,i,e)),Jo}function PC(n,e,t,i,r,o,s){let a=!0,c=null;if((i.type&3||s)&&(c??=ic(i,e,o),yC(i,n,e,s,t,r,o,c)&&(a=!1)),a){let d=i.outputs?.[r],g=i.hostDirectiveOutputs?.[r];if(g&&g.length)for(let y=0;y<g.length;y+=2){let v=g[y],_=g[y+1];c??=ic(i,e,o),H_(i,e,v,_,r,c)}if(d&&d.length)for(let y of d)c??=ic(i,e,o),H_(i,e,y,r,r,c)}}function C(n=1){return v_(n)}function mg(n,e,t,i){BT(n,e,t,i)}function Cn(n,e,t){LT(n,e,t)}function en(n){let e=ce(),t=tt(),i=Op();Wu(i+1);let r=ag(t,i);if(n.dirty&&Xv(e)===((r.metadata.flags&2)===2)){if(r.matches===null)n.reset([]);else{let o=HT(e,i);n.reset(o,cD),n.notifyOnChanges()}return!0}return!1}function tn(){return VT(ce(),Op())}function Hc(n){let e=u_();return Bu(e,rt+n)}function Zu(n,e){return n<<17|e<<2}function qr(n){return n>>17&32767}function gI(n){return(n&2)==2}function hI(n,e){return n&131071|e<<17}function I0(n){return n|2}function zo(n){return(n&131068)>>2}function Qp(n,e){return n&-131069|e<<2}function yI(n){return(n&1)===1}function M0(n){return n|1}function vI(n,e,t,i,r,o){let s=o?e.classBindings:e.styleBindings,a=qr(s),c=zo(s);n[i]=t;let d=!1,g;if(Array.isArray(t)){let y=t;g=y[1],(g===null||Ro(y,g)>0)&&(d=!0)}else g=t;if(r)if(c!==0){let v=qr(n[a+1]);n[i+1]=Zu(v,a),v!==0&&(n[v+1]=Qp(n[v+1],i)),n[a+1]=hI(n[a+1],i)}else n[i+1]=Zu(a,0),a!==0&&(n[a+1]=Qp(n[a+1],i)),a=i;else n[i+1]=Zu(c,0),a===0?a=i:n[c+1]=Qp(n[c+1],i),c=i;d&&(n[i+1]=I0(n[i+1])),J_(n,g,i,!0),J_(n,g,i,!1),_I(e,g,n,i,o),s=Zu(a,c),o?e.classBindings=s:e.styleBindings=s}function _I(n,e,t,i,r){let o=r?n.residualClasses:n.residualStyles;o!=null&&typeof e=="string"&&Ro(o,e)>=0&&(t[i+1]=M0(t[i+1]))}function J_(n,e,t,i){let r=n[t+1],o=e===null,s=i?qr(r):zo(r),a=!1;for(;s!==0&&(a===!1||o);){let c=n[s],d=n[s+1];CI(c,e)&&(a=!0,n[s+1]=i?M0(d):I0(d)),s=i?qr(d):zo(d)}a&&(n[t+1]=i?I0(r):M0(r))}function CI(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?Ro(n,e)>=0:!1}var Yn={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function xI(n){return n.substring(Yn.key,Yn.keyEnd)}function EI(n){return bI(n),FC(n,kC(n,0,Yn.textEnd))}function FC(n,e){let t=Yn.textEnd;return t===e?-1:(e=Yn.keyEnd=SI(n,Yn.key=e,t),kC(n,e,t))}function bI(n){Yn.key=0,Yn.keyEnd=0,Yn.value=0,Yn.valueEnd=0,Yn.textEnd=n.length}function kC(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function SI(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}function dn(n,e,t){return OC(n,e,t,!1),dn}function Q(n,e){return OC(n,e,null,!0),Q}function De(n){wI(RI,DI,n,!0)}function DI(n,e){for(let t=EI(e);t>=0;t=FC(e,t))Ou(n,xI(e),!0)}function OC(n,e,t,i){let r=ce(),o=tt(),s=va(2);if(o.firstUpdatePass&&LC(o,n,s,i),e!==Lt&&Fn(r,s,e)){let a=o.data[jn()];BC(o,a,r,r[Ye],n,r[s+1]=FI(e,t),i,s)}}function wI(n,e,t,i){let r=tt(),o=va(2);r.firstUpdatePass&&LC(r,null,o,i);let s=ce();if(t!==Lt&&Fn(s,o,t)){let a=r.data[jn()];if(UC(a,i)&&!VC(r,o)){let c=i?a.classesWithoutHost:a.stylesWithoutHost;c!==null&&(t=Ru(c,t||"")),T0(r,a,s,t,i)}else PI(r,a,s,s[Ye],s[o+1],s[o+1]=NI(n,e,t),i,o)}}function VC(n,e){return e>=n.expandoStartIndex}function LC(n,e,t,i){let r=n.data;if(r[t+1]===null){let o=r[jn()],s=VC(n,t);UC(o,i)&&e===null&&!s&&(e=!1),e=TI(r,o,e,i),vI(r,o,e,t,s,i)}}function TI(n,e,t,i){let r=p_(n),o=i?e.residualClasses:e.residualStyles;if(r===null)(i?e.classBindings:e.styleBindings)===0&&(t=Zp(null,n,e,t,i),t=Ra(t,e.attrs,i),o=null);else{let s=e.directiveStylingLast;if(s===-1||n[s]!==r)if(t=Zp(r,n,e,t,i),o===null){let c=II(n,e,i);c!==void 0&&Array.isArray(c)&&(c=Zp(null,n,e,c[1],i),c=Ra(c,e.attrs,i),MI(n,e,i,c))}else o=AI(n,e,i)}return o!==void 0&&(i?e.residualClasses=o:e.residualStyles=o),t}function II(n,e,t){let i=t?e.classBindings:e.styleBindings;if(zo(i)!==0)return n[qr(i)]}function MI(n,e,t,i){let r=t?e.classBindings:e.styleBindings;n[qr(r)]=i}function AI(n,e,t){let i,r=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<r;o++){let s=n[o].hostAttrs;i=Ra(i,s,t)}return Ra(i,e.attrs,t)}function Zp(n,e,t,i,r){let o=null,s=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<s&&(o=e[a],i=Ra(i,o.hostAttrs,r),o!==n);)a++;return n!==null&&(t.directiveStylingLast=a),i}function Ra(n,e,t){let i=t?1:2,r=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?r=s:r===i&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),Ou(n,s,t?!0:e[++o]))}return n===void 0?null:n}function NI(n,e,t){if(t==null||t==="")return Kt;let i=[],r=Oa(t);if(Array.isArray(r))for(let o=0;o<r.length;o++)n(i,r[o],!0);else if(typeof r=="object")for(let o in r)r.hasOwnProperty(o)&&n(i,o,r[o]);else typeof r=="string"&&e(i,r);return i}function RI(n,e,t){let i=String(e);i!==""&&!i.includes(" ")&&Ou(n,i,t)}function PI(n,e,t,i,r,o,s,a){r===Lt&&(r=Kt);let c=0,d=0,g=0<r.length?r[0]:null,y=0<o.length?o[0]:null;for(;g!==null||y!==null;){let v=c<r.length?r[c+1]:void 0,_=d<o.length?o[d+1]:void 0,b=null,I;g===y?(c+=2,d+=2,v!==_&&(b=y,I=_)):y===null||g!==null&&g<y?(c+=2,b=g):(d+=2,b=y,I=_),b!==null&&BC(n,e,t,i,b,I,s,a),g=c<r.length?r[c]:null,y=d<o.length?o[d]:null}}function BC(n,e,t,i,r,o,s,a){if(!(e.type&3))return;let c=n.data,d=c[a+1],g=yI(d)?K_(c,e,t,r,zo(d),s):void 0;if(!bc(g)){bc(o)||gI(d)&&(o=K_(c,null,t,r,a,s));let y=Ep(jn(),t);_w(i,s,y,r,o)}}function K_(n,e,t,i,r,o){let s=e===null,a;for(;r>0;){let c=n[r],d=Array.isArray(c),g=d?c[1]:c,y=g===null,v=t[r+1];v===Lt&&(v=y?Kt:void 0);let _=y?Vu(v,i):g===i?v:void 0;if(d&&!bc(_)&&(_=Vu(c,i)),bc(_)&&(a=_,s))return a;let b=n[r+1];r=s?qr(b):zo(b)}if(e!==null){let c=o?e.residualClasses:e.residualStyles;c!=null&&(a=Vu(c,i))}return a}function bc(n){return n!==void 0}function FI(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=Ai(Oa(n)))),n}function UC(n,e){return(n.flags&(e?8:16))!==0}function m(n,e=""){let t=ce(),i=tt(),r=n+rt,o=i.firstCreatePass?La(i,r,1,e,null):i.data[r],s=kI(i,t,o,e,n);t[r]=s,Yu()&&Y0(i,t,s,o),Lo(o,!1)}var kI=(n,e,t,i,r)=>(Ca(!0),TD(e[Ye],i));function OI(n,e,t,i=""){return Fn(n,sr(),t)?e+ui(t)+i:Lt}function VI(n,e,t,i,r,o=""){let s=kp(),a=Aa(n,s,t,r);return va(2),a?e+ui(t)+i+ui(r)+o:Lt}function LI(n,e,t,i,r,o,s,a=""){let c=kp(),d=pT(n,c,t,r,s);return va(3),d?e+ui(t)+i+ui(r)+o+ui(s)+a:Lt}function E(n){return L("",n),E}function L(n,e,t){let i=ce(),r=OI(i,n,e,t);return r!==Lt&&pg(i,jn(),r),L}function yt(n,e,t,i,r){let o=ce(),s=VI(o,n,e,t,i,r);return s!==Lt&&pg(o,jn(),s),yt}function Pt(n,e,t,i,r,o,s){let a=ce(),c=LI(a,n,e,t,i,r,o,s);return c!==Lt&&pg(a,jn(),c),Pt}function pg(n,e,t){let i=Ep(e,n);ID(n[Ye],i,t)}function te(n,e,t){Hp(e)&&(e=e());let i=ce(),r=sr();if(Fn(i,r,e)){let o=tt(),s=_a();J1(s,i,n,e,i[Ye],t)}return te}function re(n,e){let t=Hp(n);return t&&n.set(e),t}function ne(n,e){let t=ce(),i=tt(),r=St();return PC(i,t,t[Ye],r,n,e),ne}function BI(n,e,t){let i=tt();if(i.firstCreatePass){let r=mi(n);A0(t,i.data,i.blueprint,r,!0),A0(e,i.data,i.blueprint,r,!1)}}function A0(n,e,t,i,r){if(n=Vt(n),Array.isArray(n))for(let o=0;o<n.length;o++)A0(n[o],e,t,i,r);else{let o=tt(),s=ce(),a=St(),c=Tr(n)?n:Vt(n.provide),d=hp(n),g=a.providerIndexes&1048575,y=a.directiveStart,v=a.providerIndexes>>20;if(Tr(n)||!n.multi){let _=new Ur(d,r,J,null),b=e0(c,e,r?g:g+v,y);b===-1?(n0(lc(a,s),o,c),Xp(o,n,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(_),s.push(_)):(t[b]=_,s[b]=_)}else{let _=e0(c,e,g+v,y),b=e0(c,e,g,g+v),I=_>=0&&t[_],M=b>=0&&t[b];if(r&&!M||!r&&!I){n0(lc(a,s),o,c);let A=HI(r?$I:UI,t.length,r,i,d,n);!r&&M&&(t[b].providerFactory=A),Xp(o,n,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(A),s.push(A)}else{let A=$C(t[r?b:_],d,!r&&i);Xp(o,n,_>-1?_:b,A)}!r&&i&&M&&t[b].componentProviders++}}}function Xp(n,e,t,i){let r=Tr(e),o=Jv(e);if(r||o){let c=(o?Vt(e.useClass):e).prototype.ngOnDestroy;if(c){let d=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){let g=d.indexOf(t);g===-1?d.push(t,[i,c]):d[g+1].push(i,c)}else d.push(t,c)}}}function $C(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function e0(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function UI(n,e,t,i,r){return N0(this.multi,[])}function $I(n,e,t,i,r){let o=this.multi,s;if(this.providerFactory){let a=this.providerFactory.componentProviders,c=Da(i,i[se],this.providerFactory.index,r);s=c.slice(0,a),N0(o,s);for(let d=a;d<c.length;d++)s.push(c[d])}else s=[],N0(o,s);return s}function N0(n,e){for(let t=0;t<n.length;t++){let i=n[t];e.push(i())}return e}function HI(n,e,t,i,r,o){let s=new Ur(n,t,J,null);return s.multi=[],s.index=e,s.componentProviders=0,$C(s,r,i&&!t),s}function Bt(n,e=[]){return t=>{t.providersResolver=(i,r)=>BI(i,r?r(n):n,e)}}function fn(n,e,t){let i=Gu()+n,r=ce();return r[i]===Lt?sg(r,i,t?e.call(t):e()):mT(r,i)}function HC(n,e){let t=n[e];return t===Lt?void 0:t}function GI(n,e,t,i,r,o,s){let a=e+t;return Aa(n,a,r,o)?sg(n,a+2,s?i.call(s,r,o):i(r,o)):HC(n,a+2)}function qI(n,e,t,i,r,o,s,a,c){let d=e+t;return gT(n,d,r,o,s,a)?sg(n,d+4,c?i.call(c,r,o,s,a):i(r,o,s,a)):HC(n,d+4)}function nn(n,e){let t=tt(),i,r=n+rt;t.firstCreatePass?(i=WI(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??=[]).push(r,i.onDestroy)):i=t.data[r];let o=i.factory||(i.factory=Ki(i.type,!0)),s,a=Jt(J);try{let c=ac(!1),d=o();return ac(c),bp(t,ce(),r,d),d}finally{Jt(a)}}function WI(n,e){if(e)for(let t=e.length-1;t>=0;t--){let i=e[t];if(n===i.name)return i}}function xn(n,e,t,i){let r=n+rt,o=ce(),s=Bu(o,r);return GC(o,r)?GI(o,Gu(),e,s.transform,t,i,s):s.transform(t,i)}function Gc(n,e,t,i,r,o){let s=n+rt,a=ce(),c=Bu(a,s);return GC(a,s)?qI(a,Gu(),e,c.transform,t,i,r,o,c):c.transform(t,i,r,o)}function GC(n,e){return n[se].data[e].pure}var Sc=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},gg=(()=>{class n{compileModuleSync(t){return new _c(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let i=this.compileModuleSync(t),r=fp(t),o=F1(r.declarations).reduce((s,a)=>{let c=tr(a);return c&&s.push(new jo(c)),s},[]);return new Sc(i,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var jI=(()=>{class n{zone=R(ht);changeDetectionScheduler=R(wn);applicationRef=R(Bi);applicationErrorHandler=R(cn);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{try{this.applicationRef.dirtyFlags|=1,this.applicationRef._tick()}catch(t){this.applicationErrorHandler(t)}})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function qC({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new ht(q(k({},WC()),{scheduleInRootZone:t})),[{provide:ht,useFactory:n},{provide:er,multi:!0,useFactory:()=>{let i=R(jI,{optional:!0});return()=>i.initialize()}},{provide:er,multi:!0,useFactory:()=>{let i=R(zI);return()=>{i.initialize()}}},e===!0?{provide:Gp,useValue:!0}:[],{provide:Ju,useValue:t??B1},{provide:cn,useFactory:()=>{let i=R(ht),r=R(Et),o;return s=>{i.runOutsideAngular(()=>{r.destroyed&&!o?setTimeout(()=>{throw s}):(o??=r.get(Dn),o.handleError(s))})}}}]}function WC(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var zI=(()=>{class n{subscription=new _t;initialized=!1;zone=R(ht);pendingTasks=R(pi);initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{ht.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{ht.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var hg=(()=>{class n{applicationErrorHandler=R(cn);appRef=R(Bi);taskService=R(pi);ngZone=R(ht);zonelessEnabled=R(xa);tracing=R(Wr,{optional:!0});disableScheduling=R(Gp,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new _t;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(fc):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(R(Ju,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof wa||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;let i=!1;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2,i=!0;break}case 12:{this.appRef.dirtyFlags|=16,i=!0;break}case 13:{this.appRef.dirtyFlags|=2,i=!0;break}case 11:{i=!0;break}case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(i))return;let r=this.useMicrotaskScheduler?R_:U1;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(t){return!(this.disableScheduling&&!t||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(fc+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(i){this.taskService.remove(t),this.applicationErrorHandler(i)}finally{this.cleanup()}this.useMicrotaskScheduler=!0,R_(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function yg(){return Oi("NgZoneless"),Ar([{provide:wn,useExisting:hg},{provide:ht,useClass:wa},{provide:xa,useValue:!0},{provide:Ju,useValue:!1},[]])}function YI(){return typeof $localize<"u"&&$localize.locale||Ha}var jr=new Z("",{providedIn:"root",factory:()=>R(jr,{optional:!0,skipSelf:!0})||YI()}),vg=new Z("",{providedIn:"root",factory:()=>mI});function Rt(n){return Rv(n)}function H(n,e){return nu(n,e?.equal)}var _g=class{[Gt];constructor(e){this[Gt]=e}destroy(){this[Gt].destroy()}};function zr(n,e){let t=e?.injector??R(Wt),i=e?.manualCleanup!==!0?t.get(Pn):null,r,o=t.get(Uo,null,{optional:!0}),s=t.get(wn);return o!==null?(r=QI(o.view,s,n),i instanceof ua&&i._lView===o.view&&(i=null)):r=ZI(n,t.get(Ea),s),r.injector=t,i!==null&&(r.onDestroyFn=i.onDestroy(()=>r.destroy())),new _g(r)}var jC=q(k({},Pv),{cleanupFns:void 0,zone:null,onDestroyFn:Lr,run(){let n=Bo(!1);try{Fv(this)}finally{Bo(n)}},cleanup(){if(!this.cleanupFns?.length)return;let n=fe(null);try{for(;this.cleanupFns.length;)this.cleanupFns.pop()()}finally{this.cleanupFns=[],fe(n)}}}),JI=q(k({},jC),{consumerMarkedDirty(){this.scheduler.schedule(this),this.notifier.notify(12)},destroy(){xr(this),this.onDestroyFn(),this.cleanup(),this.scheduler.remove(this)}}),KI=q(k({},jC),{consumerMarkedDirty(){this.view[me]|=8192,or(this.view),this.notifier.notify(13)},destroy(){xr(this),this.onDestroyFn(),this.cleanup(),this.view[Pi]?.delete(this)}});function QI(n,e,t){let i=Object.create(KI);return i.view=n,i.zone=typeof Zone<"u"?Zone.current:null,i.notifier=e,i.fn=zC(i,t),n[Pi]??=new Set,n[Pi].add(i),i.consumerMarkedDirty(i),i}function ZI(n,e,t){let i=Object.create(JI);return i.fn=zC(i,n),i.scheduler=e,i.notifier=t,i.zone=typeof Zone<"u"?Zone.current:null,i.scheduler.add(i),i.notifier.notify(12),i}function zC(n,e){return()=>{e(t=>(n.cleanupFns??=[]).push(t))}}var QC=Symbol("InputSignalNode#UNSET"),fM=q(k({},iu),{transformFn:void 0,applyValueToInputSignal(n,e){xo(n,e)}});function ZC(n,e){let t=Object.create(fM);t.value=n,t.transformFn=e?.transform;function i(){if(yo(t),t.value===QC){let r=null;throw new j(-950,r)}return t.value}return i[Gt]=t,i}var Wc=class{attributeName;constructor(e){this.attributeName=e}__NG_ELEMENT_ID__=()=>Fa(this.attributeName);toString(){return`HostAttributeToken ${this.attributeName}`}},mM=new Z("");mM.__NG_ELEMENT_ID__=n=>{let e=St();if(e===null)throw new j(204,!1);if(e.type&2)return e.value;if(n&8)return null;throw new j(204,!1)};function YC(n,e){return ZC(n,e)}function pM(n){return ZC(QC,n)}var zc=(YC.required=pM,YC);var Cg=new Z(""),gM=new Z("");function Ga(n){return!n.moduleRef}function hM(n){let e=Ga(n)?n.r3Injector:n.moduleRef.injector,t=e.get(ht);return t.run(()=>{Ga(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let i=e.get(cn),r;if(t.runOutsideAngular(()=>{r=t.onError.subscribe({next:i})}),Ga(n)){let o=()=>e.destroy(),s=n.platformInjector.get(Cg);s.add(o),e.onDestroy(()=>{r.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(Cg);s.add(o),n.moduleRef.onDestroy(()=>{Sa(n.allPlatformModules,n.moduleRef),r.unsubscribe(),s.delete(o)})}return vM(i,t,()=>{let o=e.get(pi),s=o.add(),a=e.get(dg);return a.runInitializers(),a.donePromise.then(()=>{let c=e.get(jr,Ha);if(RC(c||Ha),!e.get(gM,!0))return Ga(n)?e.get(Bi):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(Ga(n)){let g=e.get(Bi);return n.rootComponent!==void 0&&g.bootstrap(n.rootComponent),g}else return yM?.(n.moduleRef,n.allPlatformModules),n.moduleRef}).finally(()=>void o.remove(s))})})}var yM;function vM(n,e,t){try{let i=t();return cr(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n(i)),i}}var qc=null;function _M(n=[],e){return Wt.create({name:e,providers:[{provide:fa,useValue:"platform"},{provide:Cg,useValue:new Set([()=>qc=null])},...n]})}function CM(n=[]){if(qc)return qc;let e=_M(n);return qc=e,MC(),xM(e),e}function xM(n){let e=n.get(wc,null);At(n,()=>{e?.forEach(t=>t())})}var dr=(()=>{class n{static __NG_ELEMENT_ID__=EM}return n})();function EM(n){return bM(St(),ce(),(n&16)===16)}function bM(n,e,t){if(rr(n)&&!t){let i=Nn(n.index,e);return new lr(i,i)}else if(n.type&175){let i=e[yn];return new lr(i,e)}return null}var xg=class{constructor(){}supports(e){return og(e)}create(e){return new Eg(e)}},SM=(n,e)=>e,Eg=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||SM}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,o=null;for(;t||i;){let s=!i||t&&t.currentIndex<JC(i,r,o)?t:i,a=JC(s,r,o),c=s.currentIndex;if(s===i)r--,i=i._nextRemoved;else if(t=t._next,s.previousIndex==null)r++;else{o||(o=[]);let d=a-r,g=c-r;if(d!=g){for(let v=0;v<d;v++){let _=v<o.length?o[v]:o[v]=0,b=_+v;g<=b&&b<d&&(o[v]=_+1)}let y=s.previousIndex;o[y]=g-d}}a!==c&&e(s,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!og(e))throw new j(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,i=!1,r,o,s;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,a),i=!0):(i&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else r=0,gC(e,a=>{s=this._trackByFn(r,a),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,a,s,r),i=!0):(i&&(t=this._verifyReinsertion(t,a,s,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,r)):(e=this._linkedRecords===null?null:this._linkedRecords.get(i,r),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,r)):e=this._addAfter(new bg(t,i),o,r)),e}_verifyReinsertion(e,t,i,r){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null);return o!==null?e=this._reinsertAfter(o,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let r=e._prevRemoved,o=e._nextRemoved;return r===null?this._removalsHead=o:r._nextRemoved=o,o===null?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){let r=t===null?this._itHead:t._next;return e._next=r,e._prev=t,r===null?this._itTail=e:r._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new jc),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,i=e._next;return t===null?this._itHead=i:t._next=i,i===null?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new jc),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},bg=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},Sg=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;i!==null;i=i._nextDup)if((t===null||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){let t=e._prevDup,i=e._nextDup;return t===null?this._head=i:t._nextDup=i,i===null?this._tail=t:i._prevDup=t,this._head===null}},jc=class{map=new Map;put(e){let t=e.trackById,i=this.map.get(t);i||(i=new Sg,this.map.set(t,i)),i.add(e)}get(e,t){let i=e,r=this.map.get(i);return r?r.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function JC(n,e,t){let i=n.previousIndex;if(i===null)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}function KC(){return new Dg([new xg])}var Dg=(()=>{class n{factories;static \u0275prov=Y({token:n,providedIn:"root",factory:KC});constructor(t){this.factories=t}static create(t,i){if(i!=null){let r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:()=>{let i=R(n,{optional:!0,skipSelf:!0});return n.create(t,i||KC())}}}find(t){let i=this.factories.find(r=>r.supports(t));if(i!=null)return i;throw new j(901,!1)}}return n})();function XC(n){let{rootComponent:e,appProviders:t,platformProviders:i,platformRef:r}=n;He(8);try{let o=r?.injector??CM(i),s=[qC({}),{provide:wn,useExisting:hg},x_,...t||[]],a=new Na({providers:s,parent:o,debugName:"",runEnvironmentInitializers:!1});return hM({r3Injector:a.injector,platformInjector:o,rootComponent:e})}catch(o){return Promise.reject(o)}finally{He(9)}}function Yr(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}var nx=null;function Vn(){return nx}function wg(n){nx??=n}var qa=class{},Wa=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Y({token:n,factory:()=>R(ix),providedIn:"platform"})}return n})();var ix=(()=>{class n extends Wa{_location;_history;_doc=R(Nt);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Vn().getBaseHref(this._doc)}onPopState(t){let i=Vn().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){let i=Vn().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Y({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function Yc(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function ex(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function Zn(n){return n&&n[0]!=="?"?`?${n}`:n}var yi=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Y({token:n,factory:()=>R(Tg),providedIn:"root"})}return n})(),Jc=new Z(""),Tg=(()=>{class n extends yi{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,i){super(),this._platformLocation=t,this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??R(Nt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Yc(this._baseHref,t)}path(t=!1){let i=this._platformLocation.pathname+Zn(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,o){let s=this.prepareExternalUrl(r+Zn(o));this._platformLocation.pushState(t,i,s)}replaceState(t,i,r,o){let s=this.prepareExternalUrl(r+Zn(o));this._platformLocation.replaceState(t,i,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(i){return new(i||n)(ie(Wa),ie(Jc,8))};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Jr=(()=>{class n{_subject=new pt;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let i=this._locationStrategy.getBaseHref();this._basePath=TM(ex(tx(i))),this._locationStrategy.onPopState(r=>{this._subject.next({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+Zn(i))}normalize(t){return n.stripTrailingSlash(wM(this._basePath,tx(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Zn(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Zn(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i??void 0,complete:r??void 0})}static normalizeQueryParams=Zn;static joinWithSlash=Yc;static stripTrailingSlash=ex;static \u0275fac=function(i){return new(i||n)(ie(yi))};static \u0275prov=Y({token:n,factory:()=>DM(),providedIn:"root"})}return n})();function DM(){return new Jr(ie(yi))}function wM(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function tx(n){return n.replace(/\/index.html$/,"")}function TM(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var Fg=(()=>{class n extends yi{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(t,i){super(),this._platformLocation=t,i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(t){let i=Yc(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,o){let s=this.prepareExternalUrl(r+Zn(o))||this._platformLocation.pathname;this._platformLocation.pushState(t,i,s)}replaceState(t,i,r,o){let s=this.prepareExternalUrl(r+Zn(o))||this._platformLocation.pathname;this._platformLocation.replaceState(t,i,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(i){return new(i||n)(ie(Wa),ie(Jc,8))};static \u0275prov=Y({token:n,factory:n.\u0275fac})}return n})(),cx={ADP:[void 0,void 0,0],AFN:[void 0,"\u060B",0],ALL:[void 0,void 0,0],AMD:[void 0,"\u058F",2],AOA:[void 0,"Kz"],ARS:[void 0,"$"],AUD:["A$","$"],AZN:[void 0,"\u20BC"],BAM:[void 0,"KM"],BBD:[void 0,"$"],BDT:[void 0,"\u09F3"],BHD:[void 0,void 0,3],BIF:[void 0,void 0,0],BMD:[void 0,"$"],BND:[void 0,"$"],BOB:[void 0,"Bs"],BRL:["R$"],BSD:[void 0,"$"],BWP:[void 0,"P"],BYN:[void 0,void 0,2],BYR:[void 0,void 0,0],BZD:[void 0,"$"],CAD:["CA$","$",2],CHF:[void 0,void 0,2],CLF:[void 0,void 0,4],CLP:[void 0,"$",0],CNY:["CN\xA5","\xA5"],COP:[void 0,"$",2],CRC:[void 0,"\u20A1",2],CUC:[void 0,"$"],CUP:[void 0,"$"],CZK:[void 0,"K\u010D",2],DJF:[void 0,void 0,0],DKK:[void 0,"kr",2],DOP:[void 0,"$"],EGP:[void 0,"E\xA3"],ESP:[void 0,"\u20A7",0],EUR:["\u20AC"],FJD:[void 0,"$"],FKP:[void 0,"\xA3"],GBP:["\xA3"],GEL:[void 0,"\u20BE"],GHS:[void 0,"GH\u20B5"],GIP:[void 0,"\xA3"],GNF:[void 0,"FG",0],GTQ:[void 0,"Q"],GYD:[void 0,"$",2],HKD:["HK$","$"],HNL:[void 0,"L"],HRK:[void 0,"kn"],HUF:[void 0,"Ft",2],IDR:[void 0,"Rp",2],ILS:["\u20AA"],INR:["\u20B9"],IQD:[void 0,void 0,0],IRR:[void 0,void 0,0],ISK:[void 0,"kr",0],ITL:[void 0,void 0,0],JMD:[void 0,"$"],JOD:[void 0,void 0,3],JPY:["\xA5",void 0,0],KHR:[void 0,"\u17DB"],KMF:[void 0,"CF",0],KPW:[void 0,"\u20A9",0],KRW:["\u20A9",void 0,0],KWD:[void 0,void 0,3],KYD:[void 0,"$"],KZT:[void 0,"\u20B8"],LAK:[void 0,"\u20AD",0],LBP:[void 0,"L\xA3",0],LKR:[void 0,"Rs"],LRD:[void 0,"$"],LTL:[void 0,"Lt"],LUF:[void 0,void 0,0],LVL:[void 0,"Ls"],LYD:[void 0,void 0,3],MGA:[void 0,"Ar",0],MGF:[void 0,void 0,0],MMK:[void 0,"K",0],MNT:[void 0,"\u20AE",2],MRO:[void 0,void 0,0],MUR:[void 0,"Rs",2],MXN:["MX$","$"],MYR:[void 0,"RM"],NAD:[void 0,"$"],NGN:[void 0,"\u20A6"],NIO:[void 0,"C$"],NOK:[void 0,"kr",2],NPR:[void 0,"Rs"],NZD:["NZ$","$"],OMR:[void 0,void 0,3],PHP:["\u20B1"],PKR:[void 0,"Rs",2],PLN:[void 0,"z\u0142"],PYG:[void 0,"\u20B2",0],RON:[void 0,"lei"],RSD:[void 0,void 0,0],RUB:[void 0,"\u20BD"],RWF:[void 0,"RF",0],SBD:[void 0,"$"],SEK:[void 0,"kr",2],SGD:[void 0,"$"],SHP:[void 0,"\xA3"],SLE:[void 0,void 0,2],SLL:[void 0,void 0,0],SOS:[void 0,void 0,0],SRD:[void 0,"$"],SSP:[void 0,"\xA3"],STD:[void 0,void 0,0],STN:[void 0,"Db"],SYP:[void 0,"\xA3",0],THB:[void 0,"\u0E3F"],TMM:[void 0,void 0,0],TND:[void 0,void 0,3],TOP:[void 0,"T$"],TRL:[void 0,void 0,0],TRY:[void 0,"\u20BA"],TTD:[void 0,"$"],TWD:["NT$","$",2],TZS:[void 0,void 0,2],UAH:[void 0,"\u20B4"],UGX:[void 0,void 0,0],USD:["$"],UYI:[void 0,void 0,0],UYU:[void 0,"$"],UYW:[void 0,void 0,4],UZS:[void 0,void 0,2],VEF:[void 0,"Bs",2],VND:["\u20AB",void 0,0],VUV:[void 0,void 0,0],XAF:["FCFA",void 0,0],XCD:["EC$","$"],XOF:["F\u202FCFA",void 0,0],XPF:["CFPF",void 0,0],XXX:["\xA4"],YER:[void 0,void 0,0],ZAR:[void 0,"R"],ZMK:[void 0,void 0,0],ZMW:[void 0,"ZK"],ZWD:[void 0,void 0,0]},od=(function(n){return n[n.Decimal=0]="Decimal",n[n.Percent=1]="Percent",n[n.Currency=2]="Currency",n[n.Scientific=3]="Scientific",n})(od||{});var jt=(function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n})(jt||{}),We=(function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n})(We||{}),mn=(function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n})(mn||{}),Ut={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function dx(n){return Xt(n)[st.LocaleId]}function fx(n,e,t){let i=Xt(n),r=[i[st.DayPeriodsFormat],i[st.DayPeriodsStandalone]],o=Ln(r,e);return Ln(o,t)}function mx(n,e,t){let i=Xt(n),r=[i[st.DaysFormat],i[st.DaysStandalone]],o=Ln(r,e);return Ln(o,t)}function px(n,e,t){let i=Xt(n),r=[i[st.MonthsFormat],i[st.MonthsStandalone]],o=Ln(r,e);return Ln(o,t)}function gx(n,e){let i=Xt(n)[st.Eras];return Ln(i,e)}function ja(n,e){let t=Xt(n);return Ln(t[st.DateFormat],e)}function za(n,e){let t=Xt(n);return Ln(t[st.TimeFormat],e)}function Ya(n,e){let i=Xt(n)[st.DateTimeFormat];return Ln(i,e)}function ei(n,e){let t=Xt(n),i=t[st.NumberSymbols][e];if(typeof i>"u"){if(e===Ut.CurrencyDecimal)return t[st.NumberSymbols][Ut.Decimal];if(e===Ut.CurrencyGroup)return t[st.NumberSymbols][Ut.Group]}return i}function kg(n,e){return Xt(n)[st.NumberFormats][e]}function IM(n){return Xt(n)[st.Currencies]}function hx(n){if(!n[st.ExtraData])throw new j(2303,!1)}function yx(n){let e=Xt(n);return hx(e),(e[st.ExtraData][2]||[]).map(i=>typeof i=="string"?Ig(i):[Ig(i[0]),Ig(i[1])])}function vx(n,e,t){let i=Xt(n);hx(i);let r=[i[st.ExtraData][0],i[st.ExtraData][1]],o=Ln(r,e)||[];return Ln(o,t)||[]}function Ln(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new j(2304,!1)}function Ig(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}function _x(n,e,t="en"){let i=IM(t)[n]||cx[n]||[],r=i[1];return e==="narrow"&&typeof r=="string"?r:i[0]||n}var MM=2;function Cx(n){let e,t=cx[n];return t&&(e=t[2]),typeof e=="number"?e:MM}var AM=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Kc={},NM=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function xx(n,e,t,i){let r=UM(n);e=$i(t,e)||e;let s=[],a;for(;e;)if(a=NM.exec(e),a){s=s.concat(a.slice(1));let g=s.pop();if(!g)break;e=g}else{s.push(e);break}let c=r.getTimezoneOffset();i&&(c=bx(i,c),r=BM(r,i));let d="";return s.forEach(g=>{let y=VM(g);d+=y?y(r,t,c):g==="''"?"'":g.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),d}function td(n,e,t){let i=new Date(0);return i.setFullYear(n,e,t),i.setHours(0,0,0),i}function $i(n,e){let t=dx(n);if(Kc[t]??={},Kc[t][e])return Kc[t][e];let i="";switch(e){case"shortDate":i=ja(n,mn.Short);break;case"mediumDate":i=ja(n,mn.Medium);break;case"longDate":i=ja(n,mn.Long);break;case"fullDate":i=ja(n,mn.Full);break;case"shortTime":i=za(n,mn.Short);break;case"mediumTime":i=za(n,mn.Medium);break;case"longTime":i=za(n,mn.Long);break;case"fullTime":i=za(n,mn.Full);break;case"short":let r=$i(n,"shortTime"),o=$i(n,"shortDate");i=Qc(Ya(n,mn.Short),[r,o]);break;case"medium":let s=$i(n,"mediumTime"),a=$i(n,"mediumDate");i=Qc(Ya(n,mn.Medium),[s,a]);break;case"long":let c=$i(n,"longTime"),d=$i(n,"longDate");i=Qc(Ya(n,mn.Long),[c,d]);break;case"full":let g=$i(n,"fullTime"),y=$i(n,"fullDate");i=Qc(Ya(n,mn.Full),[g,y]);break}return i&&(Kc[t][e]=i),i}function Qc(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,i){return e!=null&&i in e?e[i]:t})),n}function Xn(n,e,t="-",i,r){let o="";(n<0||r&&n<=0)&&(r?n=-n+1:(n=-n,o=t));let s=String(n);for(;s.length<e;)s="0"+s;return i&&(s=s.slice(s.length-e)),o+s}function RM(n,e){return Xn(n,3).substring(0,e)}function Dt(n,e,t=0,i=!1,r=!1){return function(o,s){let a=PM(n,o);if((t>0||a>-t)&&(a+=t),n===3)a===0&&t===-12&&(a=12);else if(n===6)return RM(a,e);let c=ei(s,Ut.MinusSign);return Xn(a,e,c,i,r)}}function PM(n,e){switch(n){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();case 3:return e.getHours();case 4:return e.getMinutes();case 5:return e.getSeconds();case 6:return e.getMilliseconds();case 7:return e.getDay();default:throw new j(2301,!1)}}function Ke(n,e,t=jt.Format,i=!1){return function(r,o){return FM(r,o,n,e,t,i)}}function FM(n,e,t,i,r,o){switch(t){case 2:return px(e,r,i)[n.getMonth()];case 1:return mx(e,r,i)[n.getDay()];case 0:let s=n.getHours(),a=n.getMinutes();if(o){let d=yx(e),g=vx(e,r,i),y=d.findIndex(v=>{if(Array.isArray(v)){let[_,b]=v,I=s>=_.hours&&a>=_.minutes,M=s<b.hours||s===b.hours&&a<b.minutes;if(_.hours<b.hours){if(I&&M)return!0}else if(I||M)return!0}else if(v.hours===s&&v.minutes===a)return!0;return!1});if(y!==-1)return g[y]}return fx(e,r,i)[s<12?0:1];case 3:return gx(e,i)[n.getFullYear()<=0?0:1];default:let c=t;throw new j(2302,!1)}}function Zc(n){return function(e,t,i){let r=-1*i,o=ei(t,Ut.MinusSign),s=r>0?Math.floor(r/60):Math.ceil(r/60);switch(n){case 0:return(r>=0?"+":"")+Xn(s,2,o)+Xn(Math.abs(r%60),2,o);case 1:return"GMT"+(r>=0?"+":"")+Xn(s,1,o);case 2:return"GMT"+(r>=0?"+":"")+Xn(s,2,o)+":"+Xn(Math.abs(r%60),2,o);case 3:return i===0?"Z":(r>=0?"+":"")+Xn(s,2,o)+":"+Xn(Math.abs(r%60),2,o);default:throw new j(2310,!1)}}}var kM=0,ed=4;function OM(n){let e=td(n,kM,1).getDay();return td(n,0,1+(e<=ed?ed:ed+7)-e)}function Ex(n){let e=n.getDay(),t=e===0?-3:ed-e;return td(n.getFullYear(),n.getMonth(),n.getDate()+t)}function Mg(n,e=!1){return function(t,i){let r;if(e){let o=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,s=t.getDate();r=1+Math.floor((s+o)/7)}else{let o=Ex(t),s=OM(o.getFullYear()),a=o.getTime()-s.getTime();r=1+Math.round(a/6048e5)}return Xn(r,n,ei(i,Ut.MinusSign))}}function Xc(n,e=!1){return function(t,i){let o=Ex(t).getFullYear();return Xn(o,n,ei(i,Ut.MinusSign),e)}}var Ag={};function VM(n){if(Ag[n])return Ag[n];let e;switch(n){case"G":case"GG":case"GGG":e=Ke(3,We.Abbreviated);break;case"GGGG":e=Ke(3,We.Wide);break;case"GGGGG":e=Ke(3,We.Narrow);break;case"y":e=Dt(0,1,0,!1,!0);break;case"yy":e=Dt(0,2,0,!0,!0);break;case"yyy":e=Dt(0,3,0,!1,!0);break;case"yyyy":e=Dt(0,4,0,!1,!0);break;case"Y":e=Xc(1);break;case"YY":e=Xc(2,!0);break;case"YYY":e=Xc(3);break;case"YYYY":e=Xc(4);break;case"M":case"L":e=Dt(1,1,1);break;case"MM":case"LL":e=Dt(1,2,1);break;case"MMM":e=Ke(2,We.Abbreviated);break;case"MMMM":e=Ke(2,We.Wide);break;case"MMMMM":e=Ke(2,We.Narrow);break;case"LLL":e=Ke(2,We.Abbreviated,jt.Standalone);break;case"LLLL":e=Ke(2,We.Wide,jt.Standalone);break;case"LLLLL":e=Ke(2,We.Narrow,jt.Standalone);break;case"w":e=Mg(1);break;case"ww":e=Mg(2);break;case"W":e=Mg(1,!0);break;case"d":e=Dt(2,1);break;case"dd":e=Dt(2,2);break;case"c":case"cc":e=Dt(7,1);break;case"ccc":e=Ke(1,We.Abbreviated,jt.Standalone);break;case"cccc":e=Ke(1,We.Wide,jt.Standalone);break;case"ccccc":e=Ke(1,We.Narrow,jt.Standalone);break;case"cccccc":e=Ke(1,We.Short,jt.Standalone);break;case"E":case"EE":case"EEE":e=Ke(1,We.Abbreviated);break;case"EEEE":e=Ke(1,We.Wide);break;case"EEEEE":e=Ke(1,We.Narrow);break;case"EEEEEE":e=Ke(1,We.Short);break;case"a":case"aa":case"aaa":e=Ke(0,We.Abbreviated);break;case"aaaa":e=Ke(0,We.Wide);break;case"aaaaa":e=Ke(0,We.Narrow);break;case"b":case"bb":case"bbb":e=Ke(0,We.Abbreviated,jt.Standalone,!0);break;case"bbbb":e=Ke(0,We.Wide,jt.Standalone,!0);break;case"bbbbb":e=Ke(0,We.Narrow,jt.Standalone,!0);break;case"B":case"BB":case"BBB":e=Ke(0,We.Abbreviated,jt.Format,!0);break;case"BBBB":e=Ke(0,We.Wide,jt.Format,!0);break;case"BBBBB":e=Ke(0,We.Narrow,jt.Format,!0);break;case"h":e=Dt(3,1,-12);break;case"hh":e=Dt(3,2,-12);break;case"H":e=Dt(3,1);break;case"HH":e=Dt(3,2);break;case"m":e=Dt(4,1);break;case"mm":e=Dt(4,2);break;case"s":e=Dt(5,1);break;case"ss":e=Dt(5,2);break;case"S":e=Dt(6,1);break;case"SS":e=Dt(6,2);break;case"SSS":e=Dt(6,3);break;case"Z":case"ZZ":case"ZZZ":e=Zc(0);break;case"ZZZZZ":e=Zc(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=Zc(1);break;case"OOOO":case"ZZZZ":case"zzzz":e=Zc(2);break;default:return null}return Ag[n]=e,e}function bx(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function LM(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function BM(n,e,t){let r=n.getTimezoneOffset(),o=bx(e,r);return LM(n,-1*(o-r))}function UM(n){if(rx(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[r,o=1,s=1]=n.split("-").map(a=>+a);return td(r,o-1,s)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let i;if(i=n.match(AM))return $M(i)}let e=new Date(n);if(!rx(e))throw new j(2311,!1);return e}function $M(n){let e=new Date(0),t=0,i=0,r=n[8]?e.setUTCFullYear:e.setFullYear,o=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),i=Number(n[9]+n[11])),r.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let s=Number(n[4]||0)-t,a=Number(n[5]||0)-i,c=Number(n[6]||0),d=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return o.call(e,s,a,c,d),e}function rx(n){return n instanceof Date&&!isNaN(n.valueOf())}var HM=/^(\d+)?\.((\d+)(-(\d+))?)?$/,ox=22,nd=".",Ja="0",GM=";",qM=",",Ng="#",sx="\xA4";function Sx(n,e,t,i,r,o,s=!1){let a="",c=!1;if(!isFinite(n))a=ei(t,Ut.Infinity);else{let d=jM(n);s&&(d=WM(d));let g=e.minInt,y=e.minFrac,v=e.maxFrac;if(o){let B=o.match(HM);if(B===null)throw new j(2306,!1);let G=B[1],z=B[3],X=B[5];G!=null&&(g=Rg(G)),z!=null&&(y=Rg(z)),X!=null?v=Rg(X):z!=null&&y>v&&(v=y)}zM(d,y,v);let _=d.digits,b=d.integerLen,I=d.exponent,M=[];for(c=_.every(B=>!B);b<g;b++)_.unshift(0);for(;b<0;b++)_.unshift(0);b>0?M=_.splice(b,_.length):(M=_,_=[0]);let A=[];for(_.length>=e.lgSize&&A.unshift(_.splice(-e.lgSize,_.length).join(""));_.length>e.gSize;)A.unshift(_.splice(-e.gSize,_.length).join(""));_.length&&A.unshift(_.join("")),a=A.join(ei(t,i)),M.length&&(a+=ei(t,r)+M.join("")),I&&(a+=ei(t,Ut.Exponential)+"+"+I)}return n<0&&!c?a=e.negPre+a+e.negSuf:a=e.posPre+a+e.posSuf,a}function Dx(n,e,t,i,r){let o=kg(e,od.Currency),s=Tx(o,ei(e,Ut.MinusSign));return s.minFrac=Cx(i),s.maxFrac=s.minFrac,Sx(n,s,e,Ut.CurrencyGroup,Ut.CurrencyDecimal,r).replace(sx,t).replace(sx,"").trim()}function wx(n,e,t){let i=kg(e,od.Decimal),r=Tx(i,ei(e,Ut.MinusSign));return Sx(n,r,e,Ut.Group,Ut.Decimal,t)}function Tx(n,e="-"){let t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},i=n.split(GM),r=i[0],o=i[1],s=r.indexOf(nd)!==-1?r.split(nd):[r.substring(0,r.lastIndexOf(Ja)+1),r.substring(r.lastIndexOf(Ja)+1)],a=s[0],c=s[1]||"";t.posPre=a.substring(0,a.indexOf(Ng));for(let g=0;g<c.length;g++){let y=c.charAt(g);y===Ja?t.minFrac=t.maxFrac=g+1:y===Ng?t.maxFrac=g+1:t.posSuf+=y}let d=a.split(qM);if(t.gSize=d[1]?d[1].length:0,t.lgSize=d[2]||d[1]?(d[2]||d[1]).length:0,o){let g=r.length-t.posPre.length-t.posSuf.length,y=o.indexOf(Ng);t.negPre=o.substring(0,y).replace(/'/g,""),t.negSuf=o.slice(y+g).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}function WM(n){if(n.digits[0]===0)return n;let e=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(e===0?n.digits.push(0,0):e===1&&n.digits.push(0),n.integerLen+=2),n}function jM(n){let e=Math.abs(n)+"",t=0,i,r,o,s,a;for((r=e.indexOf(nd))>-1&&(e=e.replace(nd,"")),(o=e.search(/e/i))>0?(r<0&&(r=o),r+=+e.slice(o+1),e=e.substring(0,o)):r<0&&(r=e.length),o=0;e.charAt(o)===Ja;o++);if(o===(a=e.length))i=[0],r=1;else{for(a--;e.charAt(a)===Ja;)a--;for(r-=o,i=[],s=0;o<=a;o++,s++)i[s]=Number(e.charAt(o))}return r>ox&&(i=i.splice(0,ox-1),t=r-1,r=1),{digits:i,exponent:t,integerLen:r}}function zM(n,e,t){if(e>t)throw new j(2307,!1);let i=n.digits,r=i.length-n.integerLen,o=Math.min(Math.max(e,r),t),s=o+n.integerLen,a=i[s];if(s>0){i.splice(Math.max(n.integerLen,s));for(let y=s;y<i.length;y++)i[y]=0}else{r=Math.max(0,r),n.integerLen=1,i.length=Math.max(1,s=o+1),i[0]=0;for(let y=1;y<s;y++)i[y]=0}if(a>=5)if(s-1<0){for(let y=0;y>s;y--)i.unshift(0),n.integerLen++;i.unshift(1),n.integerLen++}else i[s-1]++;for(;r<Math.max(0,o);r++)i.push(0);let c=o!==0,d=e+n.integerLen,g=i.reduceRight(function(y,v,_,b){return v=v+y,b[_]=v<10?v:v-10,c&&(b[_]===0&&_>=d?b.pop():c=!1),v>=10?1:0},0);g&&(i.unshift(g),n.integerLen++)}function Rg(n){let e=parseInt(n);if(isNaN(e))throw new j(2305,!1);return e}var Pg=/\s+/,ax=[],Og=(()=>{class n{_ngEl;_renderer;initialClasses=ax;rawClass;stateMap=new Map;constructor(t,i){this._ngEl=t,this._renderer=i}set klass(t){this.initialClasses=t!=null?t.trim().split(Pg):ax}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(Pg):t}ngDoCheck(){for(let i of this.initialClasses)this._updateState(i,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let i of t)this._updateState(i,!0);else if(t!=null)for(let i of Object.keys(t))this._updateState(i,!!t[i]);this._applyStateDiff()}_updateState(t,i){let r=this.stateMap.get(t);r!==void 0?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){t=t.trim(),t.length>0&&t.split(Pg).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static \u0275fac=function(i){return new(i||n)(J(Zt),J(Jn))};static \u0275dir=Ie({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return n})();var id=class{$implicit;ngForOf;index;count;constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},sd=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let i=this._viewContainer;t.forEachOperation((r,o,s)=>{if(r.previousIndex==null)i.createEmbeddedView(this._template,new id(r.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)i.remove(o===null?void 0:o);else if(o!==null){let a=i.get(o);i.move(a,s),lx(a,r)}});for(let r=0,o=i.length;r<o;r++){let a=i.get(r).context;a.index=r,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{let o=i.get(r.currentIndex);lx(o,r)})}static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(J(Li),J(ur),J(Dg))};static \u0275dir=Ie({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function lx(n,e){n.context.$implicit=e.item}var Kr=(()=>{class n{_viewContainer;_context=new rd;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,i){this._viewContainer=t,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){ux(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){ux(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(J(Li),J(ur))};static \u0275dir=Ie({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),rd=class{$implicit=null;ngIf=null};function ux(n,e){if(n&&!n.createEmbeddedView)throw new j(2020,!1)}function Vg(n,e){return new j(2100,!1)}var YM="mediumDate",Ix=new Z(""),Mx=new Z(""),Ka=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(t,i,r){this.locale=t,this.defaultTimezone=i,this.defaultOptions=r}transform(t,i,r,o){if(t==null||t===""||t!==t)return null;try{let s=i??this.defaultOptions?.dateFormat??YM,a=r??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return xx(t,s,o||this.locale,a)}catch(s){throw Vg(n,s.message)}}static \u0275fac=function(i){return new(i||n)(J(jr,16),J(Ix,24),J(Mx,24))};static \u0275pipe=$a({name:"date",type:n,pure:!0})}return n})();var Qa=(()=>{class n{_locale;constructor(t){this._locale=t}transform(t,i,r){if(!Ax(t))return null;r||=this._locale;try{let o=Nx(t);return wx(o,r,i)}catch(o){throw Vg(n,o.message)}}static \u0275fac=function(i){return new(i||n)(J(jr,16))};static \u0275pipe=$a({name:"number",type:n,pure:!0})}return n})();var Lg=(()=>{class n{_locale;_defaultCurrencyCode;constructor(t,i="USD"){this._locale=t,this._defaultCurrencyCode=i}transform(t,i=this._defaultCurrencyCode,r="symbol",o,s){if(!Ax(t))return null;s||=this._locale,typeof r=="boolean"&&(r=r?"symbol":"code");let a=i||this._defaultCurrencyCode;r!=="code"&&(r==="symbol"||r==="symbol-narrow"?a=_x(a,r==="symbol"?"wide":"narrow",s):a=r);try{let c=Nx(t);return Dx(c,s,a,i,o)}catch(c){throw Vg(n,c.message)}}static \u0275fac=function(i){return new(i||n)(J(jr,16),J(vg,16))};static \u0275pipe=$a({name:"currency",type:n,pure:!0})}return n})();function Ax(n){return!(n==null||n===""||n!==n)}function Nx(n){if(typeof n=="string"&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if(typeof n!="number")throw new j(2309,!1);return n}var oe=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Kn({type:n});static \u0275inj=Tn({})}return n})();function Za(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let i=t.indexOf("="),[r,o]=i==-1?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(o)}return null}var Qr=class{};var Rx="browser";var Xa=class{_doc;constructor(e){this._doc=e}manager},ad=(()=>{class n extends Xa{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r,o){return t.addEventListener(i,r,o),()=>this.removeEventListener(t,i,r,o)}removeEventListener(t,i,r,o){return t.removeEventListener(i,r,o)}static \u0275fac=function(i){return new(i||n)(ie(Nt))};static \u0275prov=Y({token:n,factory:n.\u0275fac})}return n})(),ud=new Z(""),Gg=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,i){this._zone=i,t.forEach(s=>{s.manager=this});let r=t.filter(s=>!(s instanceof ad));this._plugins=r.slice().reverse();let o=t.find(s=>s instanceof ad);o&&this._plugins.push(o)}addEventListener(t,i,r,o){return this._findPluginFor(i).addEventListener(t,i,r,o)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(o=>o.supports(t)),!i)throw new j(5101,!1);return this._eventNameToPlugin.set(t,i),i}static \u0275fac=function(i){return new(i||n)(ie(ud),ie(ht))};static \u0275prov=Y({token:n,factory:n.\u0275fac})}return n})(),Bg="ng-app-id";function Px(n){for(let e of n)e.remove()}function Fx(n,e){let t=e.createElement("style");return t.textContent=n,t}function KM(n,e,t,i){let r=n.head?.querySelectorAll(`style[${Bg}="${e}"],link[${Bg}="${e}"]`);if(r)for(let o of r)o.removeAttribute(Bg),o instanceof HTMLLinkElement?i.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function $g(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var qg=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,i,r,o={}){this.doc=t,this.appId=i,this.nonce=r,KM(t,i,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,i){for(let r of t)this.addUsage(r,this.inline,Fx);i?.forEach(r=>this.addUsage(r,this.external,$g))}removeStyles(t,i){for(let r of t)this.removeUsage(r,this.inline);i?.forEach(r=>this.removeUsage(r,this.external))}addUsage(t,i,r){let o=i.get(t);o?o.usage++:i.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,r(t,this.doc)))})}removeUsage(t,i){let r=i.get(t);r&&(r.usage--,r.usage<=0&&(Px(r.elements),i.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])Px(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[i,{elements:r}]of this.inline)r.push(this.addElement(t,Fx(i,this.doc)));for(let[i,{elements:r}]of this.external)r.push(this.addElement(t,$g(i,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,i){return this.nonce&&i.setAttribute("nonce",this.nonce),t.appendChild(i)}static \u0275fac=function(i){return new(i||n)(ie(Nt),ie(Dc),ie(Tc,8),ie(ka))};static \u0275prov=Y({token:n,factory:n.\u0275fac})}return n})(),Ug={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Wg=/%COMP%/g;var Ox="%COMP%",QM=`_nghost-${Ox}`,ZM=`_ngcontent-${Ox}`,XM=!0,eA=new Z("",{providedIn:"root",factory:()=>XM});function tA(n){return ZM.replace(Wg,n)}function nA(n){return QM.replace(Wg,n)}function Vx(n,e){return e.map(t=>t.replace(Wg,n))}var jg=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,i,r,o,s,a,c=null,d=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=o,this.doc=s,this.ngZone=a,this.nonce=c,this.tracingService=d,this.platformIsServer=!1,this.defaultRenderer=new el(t,s,a,this.platformIsServer,this.tracingService)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;let r=this.getOrCreateRenderer(t,i);return r instanceof ld?r.applyToHost(t):r instanceof tl&&r.applyStyles(),r}getOrCreateRenderer(t,i){let r=this.rendererByCompId,o=r.get(i.id);if(!o){let s=this.doc,a=this.ngZone,c=this.eventManager,d=this.sharedStylesHost,g=this.removeStylesOnCompDestroy,y=this.platformIsServer,v=this.tracingService;switch(i.encapsulation){case ki.Emulated:o=new ld(c,d,i,this.appId,g,s,a,y,v);break;case ki.ShadowDom:return new Hg(c,d,t,i,s,a,this.nonce,y,v);default:o=new tl(c,d,i,g,s,a,y,v);break}r.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(i){return new(i||n)(ie(Gg),ie(qg),ie(Dc),ie(eA),ie(Nt),ie(ht),ie(Tc),ie(Wr,8))};static \u0275prov=Y({token:n,factory:n.\u0275fac})}return n})(),el=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,i,r,o){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.tracingService=o}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(Ug[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(kx(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(kx(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){t.remove()}selectRootElement(e,t){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new j(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;let o=Ug[r];o?e.setAttributeNS(o,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){let r=Ug[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(hi.DashCase|hi.Important)?e.style.setProperty(t,i,r&hi.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&hi.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e!=null&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i,r){if(typeof e=="string"&&(e=Vn().getGlobalEventTarget(this.doc,e),!e))throw new j(5102,!1);let o=this.decoratePreventDefault(i);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,r)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function kx(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Hg=class extends el{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,i,r,o,s,a,c,d){super(e,o,s,c,d),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let g=r.styles;g=Vx(r.id,g);for(let v of g){let _=document.createElement("style");a&&_.setAttribute("nonce",a),_.textContent=v,this.shadowRoot.appendChild(_)}let y=r.getExternalStyles?.();if(y)for(let v of y){let _=$g(v,o);a&&_.setAttribute("nonce",a),this.shadowRoot.appendChild(_)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},tl=class extends el{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,i,r,o,s,a,c,d){super(e,o,s,a,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r;let g=i.styles;this.styles=d?Vx(d,g):g,this.styleUrls=i.getExternalStyles?.(d)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&$r.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},ld=class extends tl{contentAttr;hostAttr;constructor(e,t,i,r,o,s,a,c,d){let g=r+"-"+i.id;super(e,t,i,o,s,a,c,d,g),this.contentAttr=tA(g),this.hostAttr=nA(g)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}};var cd=class n extends qa{supportsDOMEvents=!0;static makeCurrent(){wg(new n)}onAndCancel(e,t,i,r){return e.addEventListener(t,i,r),()=>{e.removeEventListener(t,i,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=iA();return t==null?null:rA(t)}resetBaseElement(){nl=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Za(document.cookie,e)}},nl=null;function iA(){return nl=nl||document.head.querySelector("base"),nl?nl.getAttribute("href"):null}function rA(n){return new URL(n,document.baseURI).pathname}var oA=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac})}return n})(),Lx=["alt","control","meta","shift"],sA={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},aA={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},Bx=(()=>{class n extends Xa{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,i,r,o){let s=n.parseEventName(i),a=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Vn().onAndCancel(t,s.domEventName,a,o))}static parseEventName(t){let i=t.toLowerCase().split("."),r=i.shift();if(i.length===0||!(r==="keydown"||r==="keyup"))return null;let o=n._normalizeKey(i.pop()),s="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),s="code."),Lx.forEach(d=>{let g=i.indexOf(d);g>-1&&(i.splice(g,1),s+=d+".")}),s+=o,i.length!=0||o.length===0)return null;let c={};return c.domEventName=r,c.fullKey=s,c}static matchEventFullKeyCode(t,i){let r=sA[t.key]||t.key,o="";return i.indexOf("code.")>-1&&(r=t.code,o="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),Lx.forEach(s=>{if(s!==r){let a=aA[s];a(t)&&(o+=s+".")}}),o+=r,o===i)}static eventCallback(t,i,r){return o=>{n.matchEventFullKeyCode(o,t)&&r.runGuarded(()=>i(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(i){return new(i||n)(ie(Nt))};static \u0275prov=Y({token:n,factory:n.\u0275fac})}return n})();function zg(n,e,t){let i=k({rootComponent:n,platformRef:t?.platformRef},lA(e));return XC(i)}function lA(n){return{appProviders:[...mA,...n?.providers??[]],platformProviders:fA}}function uA(){cd.makeCurrent()}function cA(){return new Dn}function dA(){return F0(document),document}var fA=[{provide:ka,useValue:Rx},{provide:wc,useValue:uA,multi:!0},{provide:Nt,useFactory:dA}];var mA=[{provide:fa,useValue:"root"},{provide:Dn,useFactory:cA},{provide:ud,useClass:ad,multi:!0,deps:[Nt]},{provide:ud,useClass:Bx,multi:!0,deps:[Nt]},jg,qg,Gg,{provide:Hr,useExisting:jg},{provide:Qr,useClass:oA},[]];var Zo=class{},il=class{},Ft=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let i=t.indexOf(":");if(i>0){let r=t.slice(0,i),o=t.slice(i+1).trim();this.addHeaderEntry(r,o)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.addHeaderEntry(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if(typeof i=="string"&&(i=[i]),i.length===0)return;this.maybeSetNormalizedName(e.name,t);let r=(e.op==="a"?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":let o=e.value;if(!o)this.headers.delete(t),this.normalizedNames.delete(t);else{let s=this.headers.get(t);if(!s)return;s=s.filter(a=>o.indexOf(a)===-1),s.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,s)}break}}addHeaderEntry(e,t){let i=e.toLowerCase();this.maybeSetNormalizedName(e,i),this.headers.has(i)?this.headers.get(i).push(t):this.headers.set(i,[t])}setHeaderEntries(e,t){let i=(Array.isArray(t)?t:[t]).map(o=>o.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var fd=class{encodeKey(e){return Ux(e)}encodeValue(e){return Ux(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function pA(n,e){let t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{let o=r.indexOf("="),[s,a]=o==-1?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,o)),e.decodeValue(r.slice(o+1))],c=t.get(s)||[];c.push(a),t.set(s,c)}),t}var gA=/%(\d[a-f0-9])/gi,hA={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Ux(n){return encodeURIComponent(n).replace(gA,(e,t)=>hA[t]??e)}function dd(n){return`${n}`}var Je=class n{map;encoder;updates=null;cloneFrom=null;constructor(e={}){if(this.encoder=e.encoder||new fd,e.fromString){if(e.fromObject)throw new j(2805,!1);this.map=pA(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let i=e.fromObject[t],r=Array.isArray(i)?i.map(dd):[dd(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(i=>{let r=e[i];Array.isArray(r)?r.forEach(o=>{t.push({param:i,value:o,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new n({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(dd(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let i=this.map.get(e.param)||[],r=i.indexOf(dd(e.value));r!==-1&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var md=class{map=new Map;set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function yA(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function $x(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function Hx(n){return typeof Blob<"u"&&n instanceof Blob}function Gx(n){return typeof FormData<"u"&&n instanceof FormData}function vA(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var qx="Content-Type",Wx="Accept",zx="X-Request-URL",Yx="text/plain",Jx="application/json",_A=`${Jx}, ${Yx}, */*`,Ko=class n{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;credentials;keepalive=!1;cache;priority;mode;redirect;referrer;integrity;responseType="json";method;params;urlWithParams;transferCache;timeout;constructor(e,t,i,r){this.url=t,this.method=e.toUpperCase();let o;if(yA(this.method)||r?(this.body=i!==void 0?i:null,o=r):o=i,o){if(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,this.keepalive=!!o.keepalive,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params),o.priority&&(this.priority=o.priority),o.cache&&(this.cache=o.cache),o.credentials&&(this.credentials=o.credentials),typeof o.timeout=="number"){if(o.timeout<1||!Number.isInteger(o.timeout))throw new j(2822,"");this.timeout=o.timeout}o.mode&&(this.mode=o.mode),o.redirect&&(this.redirect=o.redirect),o.integrity&&(this.integrity=o.integrity),o.referrer&&(this.referrer=o.referrer),this.transferCache=o.transferCache}if(this.headers??=new Ft,this.context??=new md,!this.params)this.params=new Je,this.urlWithParams=t;else{let s=this.params.toString();if(s.length===0)this.urlWithParams=t;else{let a=t.indexOf("?"),c=a===-1?"?":a<t.length-1?"&":"";this.urlWithParams=t+c+s}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||$x(this.body)||Hx(this.body)||Gx(this.body)||vA(this.body)?this.body:this.body instanceof Je?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||Gx(this.body)?null:Hx(this.body)?this.body.type||null:$x(this.body)?null:typeof this.body=="string"?Yx:this.body instanceof Je?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?Jx:null}clone(e={}){let t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,o=e.keepalive??this.keepalive,s=e.priority||this.priority,a=e.cache||this.cache,c=e.mode||this.mode,d=e.redirect||this.redirect,g=e.credentials||this.credentials,y=e.referrer||this.referrer,v=e.integrity||this.integrity,_=e.transferCache??this.transferCache,b=e.timeout??this.timeout,I=e.body!==void 0?e.body:this.body,M=e.withCredentials??this.withCredentials,A=e.reportProgress??this.reportProgress,B=e.headers||this.headers,G=e.params||this.params,z=e.context??this.context;return e.setHeaders!==void 0&&(B=Object.keys(e.setHeaders).reduce((X,ue)=>X.set(ue,e.setHeaders[ue]),B)),e.setParams&&(G=Object.keys(e.setParams).reduce((X,ue)=>X.set(ue,e.setParams[ue]),G)),new n(t,i,I,{params:G,headers:B,context:z,reportProgress:A,responseType:r,withCredentials:M,transferCache:_,keepalive:o,cache:a,priority:s,timeout:b,mode:c,redirect:d,credentials:g,referrer:y,integrity:v})}},Zr=(function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n})(Zr||{}),Xo=class{headers;status;statusText;url;ok;type;redirected;constructor(e,t=200,i="OK"){this.headers=e.headers||new Ft,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.redirected=e.redirected,this.ok=this.status>=200&&this.status<300}},pd=class n extends Xo{constructor(e={}){super(e)}type=Zr.ResponseHeader;clone(e={}){return new n({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},rl=class n extends Xo{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=Zr.Response;clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0,redirected:e.redirected??this.redirected})}},Qo=class extends Xo{name="HttpErrorResponse";message;error;ok=!1;constructor(e){super(e,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},CA=200,xA=204;function Yg(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,credentials:n.credentials,transferCache:n.transferCache,timeout:n.timeout,keepalive:n.keepalive,priority:n.priority,cache:n.cache,mode:n.mode,redirect:n.redirect,integrity:n.integrity,referrer:n.referrer}}var zt=(()=>{class n{handler;constructor(t){this.handler=t}request(t,i,r={}){let o;if(t instanceof Ko)o=t;else{let c;r.headers instanceof Ft?c=r.headers:c=new Ft(r.headers);let d;r.params&&(r.params instanceof Je?d=r.params:d=new Je({fromObject:r.params})),o=new Ko(t,i,r.body!==void 0?r.body:null,{headers:c,context:r.context,params:d,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials,transferCache:r.transferCache,keepalive:r.keepalive,priority:r.priority,cache:r.cache,mode:r.mode,redirect:r.redirect,credentials:r.credentials,referrer:r.referrer,integrity:r.integrity,timeout:r.timeout})}let s=le(o).pipe(wi(c=>this.handler.handle(c)));if(t instanceof Ko||r.observe==="events")return s;let a=s.pipe(It(c=>c instanceof rl));switch(r.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return a.pipe(pe(c=>{if(c.body!==null&&!(c.body instanceof ArrayBuffer))throw new j(2806,!1);return c.body}));case"blob":return a.pipe(pe(c=>{if(c.body!==null&&!(c.body instanceof Blob))throw new j(2807,!1);return c.body}));case"text":return a.pipe(pe(c=>{if(c.body!==null&&typeof c.body!="string")throw new j(2808,!1);return c.body}));case"json":default:return a.pipe(pe(c=>c.body))}case"response":return a;default:throw new j(2809,!1)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:new Je().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,Yg(r,i))}post(t,i,r={}){return this.request("POST",t,Yg(r,i))}put(t,i,r={}){return this.request("PUT",t,Yg(r,i))}static \u0275fac=function(i){return new(i||n)(ie(Zo))};static \u0275prov=Y({token:n,factory:n.\u0275fac})}return n})();var EA=new Z("");function Kx(n,e){return e(n)}function bA(n,e){return(t,i)=>e.intercept(t,{handle:r=>n(r,i)})}function SA(n,e,t){return(i,r)=>At(t,()=>e(i,o=>n(o,r)))}var hd=new Z(""),Kg=new Z(""),Qx=new Z(""),Qg=new Z("",{providedIn:"root",factory:()=>!0});function DA(){let n=null;return(e,t)=>{n===null&&(n=(R(hd,{optional:!0})??[]).reduceRight(bA,Kx));let i=R($o);if(R(Qg)){let o=i.add();return n(e,t).pipe(Ji(o))}else return n(e,t)}}var gd=(()=>{class n extends Zo{backend;injector;chain=null;pendingTasks=R($o);contributeToStability=R(Qg);constructor(t,i){super(),this.backend=t,this.injector=i}handle(t){if(this.chain===null){let i=Array.from(new Set([...this.injector.get(Kg),...this.injector.get(Qx,[])]));this.chain=i.reduceRight((r,o)=>SA(r,o,this.injector),Kx)}if(this.contributeToStability){let i=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(Ji(i))}else return this.chain(t,i=>this.backend.handle(i))}static \u0275fac=function(i){return new(i||n)(ie(il),ie(Et))};static \u0275prov=Y({token:n,factory:n.\u0275fac})}return n})();var wA=/^\)\]\}',?\n/,TA=RegExp(`^${zx}:`,"m");function IA(n){return"responseURL"in n&&n.responseURL?n.responseURL:TA.test(n.getAllResponseHeaders())?n.getResponseHeader(zx):null}var Jg=(()=>{class n{xhrFactory;constructor(t){this.xhrFactory=t}handle(t){if(t.method==="JSONP")throw new j(-2800,!1);let i=this.xhrFactory;return le(null).pipe(qt(()=>new Se(o=>{let s=i.build();if(s.open(t.method,t.urlWithParams),t.withCredentials&&(s.withCredentials=!0),t.headers.forEach((M,A)=>s.setRequestHeader(M,A.join(","))),t.headers.has(Wx)||s.setRequestHeader(Wx,_A),!t.headers.has(qx)){let M=t.detectContentTypeHeader();M!==null&&s.setRequestHeader(qx,M)}if(t.timeout&&(s.timeout=t.timeout),t.responseType){let M=t.responseType.toLowerCase();s.responseType=M!=="json"?M:"text"}let a=t.serializeBody(),c=null,d=()=>{if(c!==null)return c;let M=s.statusText||"OK",A=new Ft(s.getAllResponseHeaders()),B=IA(s)||t.url;return c=new pd({headers:A,status:s.status,statusText:M,url:B}),c},g=()=>{let{headers:M,status:A,statusText:B,url:G}=d(),z=null;A!==xA&&(z=typeof s.response>"u"?s.responseText:s.response),A===0&&(A=z?CA:0);let X=A>=200&&A<300;if(t.responseType==="json"&&typeof z=="string"){let ue=z;z=z.replace(wA,"");try{z=z!==""?JSON.parse(z):null}catch(ae){z=ue,X&&(X=!1,z={error:ae,text:z})}}X?(o.next(new rl({body:z,headers:M,status:A,statusText:B,url:G||void 0})),o.complete()):o.error(new Qo({error:z,headers:M,status:A,statusText:B,url:G||void 0}))},y=M=>{let{url:A}=d(),B=new Qo({error:M,status:s.status||0,statusText:s.statusText||"Unknown Error",url:A||void 0});o.error(B)},v=y;t.timeout&&(v=M=>{let{url:A}=d(),B=new Qo({error:new DOMException("Request timed out","TimeoutError"),status:s.status||0,statusText:s.statusText||"Request timeout",url:A||void 0});o.error(B)});let _=!1,b=M=>{_||(o.next(d()),_=!0);let A={type:Zr.DownloadProgress,loaded:M.loaded};M.lengthComputable&&(A.total=M.total),t.responseType==="text"&&s.responseText&&(A.partialText=s.responseText),o.next(A)},I=M=>{let A={type:Zr.UploadProgress,loaded:M.loaded};M.lengthComputable&&(A.total=M.total),o.next(A)};return s.addEventListener("load",g),s.addEventListener("error",y),s.addEventListener("timeout",v),s.addEventListener("abort",y),t.reportProgress&&(s.addEventListener("progress",b),a!==null&&s.upload&&s.upload.addEventListener("progress",I)),s.send(a),o.next({type:Zr.Sent}),()=>{s.removeEventListener("error",y),s.removeEventListener("abort",y),s.removeEventListener("load",g),s.removeEventListener("timeout",v),t.reportProgress&&(s.removeEventListener("progress",b),a!==null&&s.upload&&s.upload.removeEventListener("progress",I)),s.readyState!==s.DONE&&s.abort()}})))}static \u0275fac=function(i){return new(i||n)(ie(Qr))};static \u0275prov=Y({token:n,factory:n.\u0275fac})}return n})(),Zx=new Z(""),MA="XSRF-TOKEN",AA=new Z("",{providedIn:"root",factory:()=>MA}),NA="X-XSRF-TOKEN",RA=new Z("",{providedIn:"root",factory:()=>NA}),ol=class{},PA=(()=>{class n{doc;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(t,i){this.doc=t,this.cookieName=i}getToken(){let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=Za(t,this.cookieName),this.lastCookieString=t),this.lastToken}static \u0275fac=function(i){return new(i||n)(ie(Nt),ie(AA))};static \u0275prov=Y({token:n,factory:n.\u0275fac})}return n})(),FA=/^(?:https?:)?\/\//i;function kA(n,e){if(!R(Zx)||n.method==="GET"||n.method==="HEAD"||FA.test(n.url))return e(n);let t=R(ol).getToken(),i=R(RA);return t!=null&&!n.headers.has(i)&&(n=n.clone({headers:n.headers.set(i,t)})),e(n)}var Zg=(function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n})(Zg||{});function OA(n,e){return{\u0275kind:n,\u0275providers:e}}function Xg(...n){let e=[zt,Jg,gd,{provide:Zo,useExisting:gd},{provide:il,useFactory:()=>R(EA,{optional:!0})??R(Jg)},{provide:Kg,useValue:kA,multi:!0},{provide:Zx,useValue:!0},{provide:ol,useClass:PA}];for(let t of n)e.push(...t.\u0275providers);return Ar(e)}var jx=new Z("");function eh(){return OA(Zg.LegacyInterceptors,[{provide:jx,useFactory:DA},{provide:Kg,useExisting:jx,multi:!0}])}var Xx=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(i){return new(i||n)(ie(Nt))};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var ve="primary",Cl=Symbol("RouteTitle"),sh=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function to(n){return new sh(n)}function aE(n,e,t){let i=t.path.split("/");if(i.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||i.length<n.length))return null;let r={};for(let o=0;o<i.length;o++){let s=i[o],a=n[o];if(s[0]===":")r[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function LA(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!vi(n[t],e[t]))return!1;return!0}function vi(n,e){let t=n?ah(n):void 0,i=e?ah(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let o=0;o<t.length;o++)if(r=t[o],!lE(n[r],e[r]))return!1;return!0}function ah(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function lE(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),i=[...e].sort();return t.every((r,o)=>i[o]===r)}else return n===e}function uE(n){return n.length>0?n[n.length-1]:null}function Gi(n){return Bm(n)?n:cr(n)?it(Promise.resolve(n)):le(n)}var BA={exact:dE,subset:fE},cE={exact:UA,subset:$A,ignored:()=>!0};function eE(n,e,t){return BA[t.paths](n.root,e.root,t.matrixParams)&&cE[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function UA(n,e){return vi(n,e)}function dE(n,e,t){if(!Xr(n.segments,e.segments)||!_d(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let i in e.children)if(!n.children[i]||!dE(n.children[i],e.children[i],t))return!1;return!0}function $A(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>lE(n[t],e[t]))}function fE(n,e,t){return mE(n,e,e.segments,t)}function mE(n,e,t,i){if(n.segments.length>t.length){let r=n.segments.slice(0,t.length);return!(!Xr(r,t)||e.hasChildren()||!_d(r,t,i))}else if(n.segments.length===t.length){if(!Xr(n.segments,t)||!_d(n.segments,t,i))return!1;for(let r in e.children)if(!n.children[r]||!fE(n.children[r],e.children[r],i))return!1;return!0}else{let r=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!Xr(n.segments,r)||!_d(n.segments,r,i)||!n.children[ve]?!1:mE(n.children[ve],e,o,i)}}function _d(n,e,t){return e.every((i,r)=>cE[t](n[r].parameters,i.parameters))}var Ci=class{root;queryParams;fragment;_queryParamMap;constructor(e=new Ve([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=to(this.queryParams),this._queryParamMap}toString(){return qA.serialize(this)}},Ve=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Cd(this)}},mr=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=to(this.parameters),this._parameterMap}toString(){return gE(this)}};function HA(n,e){return Xr(n,e)&&n.every((t,i)=>vi(t.parameters,e[i].parameters))}function Xr(n,e){return n.length!==e.length?!1:n.every((t,i)=>t.path===e[i].path)}function GA(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===ve&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==ve&&(t=t.concat(e(r,i)))}),t}var xl=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=Y({token:n,factory:()=>new no,providedIn:"root"})}return n})(),no=class{parse(e){let t=new uh(e);return new Ci(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${sl(e.root,!0)}`,i=zA(e.queryParams),r=typeof e.fragment=="string"?`#${WA(e.fragment)}`:"";return`${t}${i}${r}`}},qA=new no;function Cd(n){return n.segments.map(e=>gE(e)).join("/")}function sl(n,e){if(!n.hasChildren())return Cd(n);if(e){let t=n.children[ve]?sl(n.children[ve],!1):"",i=[];return Object.entries(n.children).forEach(([r,o])=>{r!==ve&&i.push(`${r}:${sl(o,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}else{let t=GA(n,(i,r)=>r===ve?[sl(n.children[ve],!1)]:[`${r}:${sl(i,!1)}`]);return Object.keys(n.children).length===1&&n.children[ve]!=null?`${Cd(n)}/${t[0]}`:`${Cd(n)}/(${t.join("//")})`}}function pE(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function yd(n){return pE(n).replace(/%3B/gi,";")}function WA(n){return encodeURI(n)}function lh(n){return pE(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function xd(n){return decodeURIComponent(n)}function tE(n){return xd(n.replace(/\+/g,"%20"))}function gE(n){return`${lh(n.path)}${jA(n.parameters)}`}function jA(n){return Object.entries(n).map(([e,t])=>`;${lh(e)}=${lh(t)}`).join("")}function zA(n){let e=Object.entries(n).map(([t,i])=>Array.isArray(i)?i.map(r=>`${yd(t)}=${yd(r)}`).join("&"):`${yd(t)}=${yd(i)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var YA=/^[^\/()?;#]+/;function nh(n){let e=n.match(YA);return e?e[0]:""}var JA=/^[^\/()?;=#]+/;function KA(n){let e=n.match(JA);return e?e[0]:""}var QA=/^[^=?&#]+/;function ZA(n){let e=n.match(QA);return e?e[0]:""}var XA=/^[^&#]+/;function eN(n){let e=n.match(XA);return e?e[0]:""}var uh=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ve([],{}):new Ve([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[ve]=new Ve(e,t)),i}parseSegment(){let e=nh(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new j(4009,!1);return this.capture(e),new mr(xd(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=KA(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let r=nh(this.remaining);r&&(i=r,this.capture(i))}e[xd(t)]=xd(i)}parseQueryParam(e){let t=ZA(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let s=eN(this.remaining);s&&(i=s,this.capture(i))}let r=tE(t),o=tE(i);if(e.hasOwnProperty(r)){let s=e[r];Array.isArray(s)||(s=[s],e[r]=s),s.push(o)}else e[r]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=nh(this.remaining),r=this.remaining[i.length];if(r!=="/"&&r!==")"&&r!==";")throw new j(4010,!1);let o;i.indexOf(":")>-1?(o=i.slice(0,i.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=ve);let s=this.parseChildren();t[o??ve]=Object.keys(s).length===1&&s[ve]?s[ve]:new Ve([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new j(4011,!1)}};function hE(n){return n.segments.length>0?new Ve([],{[ve]:n}):n}function yE(n){let e={};for(let[i,r]of Object.entries(n.children)){let o=yE(r);if(i===ve&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[i]=o)}let t=new Ve(n.segments,e);return tN(t)}function tN(n){if(n.numberOfChildren===1&&n.children[ve]){let e=n.children[ve];return new Ve(n.segments.concat(e.segments),e.children)}return n}function pr(n){return n instanceof Ci}function vE(n,e,t=null,i=null){let r=_E(n);return CE(r,e,t,i)}function _E(n){let e;function t(o){let s={};for(let c of o.children){let d=t(c);s[c.outlet]=d}let a=new Ve(o.url,s);return o===n&&(e=a),a}let i=t(n.root),r=hE(i);return e??r}function CE(n,e,t,i){let r=n;for(;r.parent;)r=r.parent;if(e.length===0)return ih(r,r,r,t,i);let o=nN(e);if(o.toRoot())return ih(r,r,new Ve([],{}),t,i);let s=iN(o,r,n),a=s.processChildren?ll(s.segmentGroup,s.index,o.commands):EE(s.segmentGroup,s.index,o.commands);return ih(r,s.segmentGroup,a,t,i)}function Ed(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function dl(n){return typeof n=="object"&&n!=null&&n.outlets}function ih(n,e,t,i,r){let o={};i&&Object.entries(i).forEach(([c,d])=>{o[c]=Array.isArray(d)?d.map(g=>`${g}`):`${d}`});let s;n===e?s=t:s=xE(n,e,t);let a=hE(yE(s));return new Ci(a,o,r)}function xE(n,e,t){let i={};return Object.entries(n.children).forEach(([r,o])=>{o===e?i[r]=t:i[r]=xE(o,e,t)}),new Ve(n.segments,i)}var bd=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Ed(i[0]))throw new j(4003,!1);let r=i.find(dl);if(r&&r!==uE(i))throw new j(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function nN(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new bd(!0,0,n);let e=0,t=!1,i=n.reduce((r,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([c,d])=>{a[c]=typeof d=="string"?d.split("/"):d}),[...r,{outlets:a}]}if(o.segmentPath)return[...r,o.segmentPath]}return typeof o!="string"?[...r,o]:s===0?(o.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&r.push(a))}),r):[...r,o]},[]);return new bd(t,e,i)}var ns=class{segmentGroup;processChildren;index;constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}};function iN(n,e,t){if(n.isAbsolute)return new ns(e,!0,0);if(!t)return new ns(e,!1,NaN);if(t.parent===null)return new ns(t,!0,0);let i=Ed(n.commands[0])?0:1,r=t.segments.length-1+i;return rN(t,r,n.numberOfDoubleDots)}function rN(n,e,t){let i=n,r=e,o=t;for(;o>r;){if(o-=r,i=i.parent,!i)throw new j(4005,!1);r=i.segments.length}return new ns(i,!1,r-o)}function oN(n){return dl(n[0])?n[0].outlets:{[ve]:n}}function EE(n,e,t){if(n??=new Ve([],{}),n.segments.length===0&&n.hasChildren())return ll(n,e,t);let i=sN(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){let o=new Ve(n.segments.slice(0,i.pathIndex),{});return o.children[ve]=new Ve(n.segments.slice(i.pathIndex),n.children),ll(o,0,r)}else return i.match&&r.length===0?new Ve(n.segments,{}):i.match&&!n.hasChildren()?ch(n,e,t):i.match?ll(n,0,r):ch(n,e,t)}function ll(n,e,t){if(t.length===0)return new Ve(n.segments,{});{let i=oN(t),r={};if(Object.keys(i).some(o=>o!==ve)&&n.children[ve]&&n.numberOfChildren===1&&n.children[ve].segments.length===0){let o=ll(n.children[ve],e,t);return new Ve(n.segments,o.children)}return Object.entries(i).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(r[o]=EE(n.children[o],e,s))}),Object.entries(n.children).forEach(([o,s])=>{i[o]===void 0&&(r[o]=s)}),new Ve(n.segments,r)}}function sN(n,e,t){let i=0,r=e,o={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return o;let s=n.segments[r],a=t[i];if(dl(a))break;let c=`${a}`,d=i<t.length-1?t[i+1]:null;if(r>0&&c===void 0)break;if(c&&d&&typeof d=="object"&&d.outlets===void 0){if(!iE(c,d,s))return o;i+=2}else{if(!iE(c,{},s))return o;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}function ch(n,e,t){let i=n.segments.slice(0,e),r=0;for(;r<t.length;){let o=t[r];if(dl(o)){let c=aN(o.outlets);return new Ve(i,c)}if(r===0&&Ed(t[0])){let c=n.segments[e];i.push(new mr(c.path,nE(t[0]))),r++;continue}let s=dl(o)?o.outlets[ve]:`${o}`,a=r<t.length-1?t[r+1]:null;s&&a&&Ed(a)?(i.push(new mr(s,nE(a))),r+=2):(i.push(new mr(s,{})),r++)}return new Ve(i,{})}function aN(n){let e={};return Object.entries(n).forEach(([t,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(e[t]=ch(new Ve([],{}),0,i))}),e}function nE(n){let e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function iE(n,e,t){return n==t.path&&vi(e,t.parameters)}var ul="imperative",kt=(function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n})(kt||{}),bn=class{id;url;constructor(e,t){this.id=e,this.url=t}},io=class extends bn{type=kt.NavigationStart;navigationTrigger;restoredState;constructor(e,t,i="imperative",r=null){super(e,t),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Sn=class extends bn{urlAfterRedirects;type=kt.NavigationEnd;constructor(e,t,i){super(e,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},rn=(function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n[n.Aborted=4]="Aborted",n})(rn||{}),fl=(function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n})(fl||{}),_i=class extends bn{reason;code;type=kt.NavigationCancel;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Hi=class extends bn{reason;code;type=kt.NavigationSkipped;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}},rs=class extends bn{error;target;type=kt.NavigationError;constructor(e,t,i,r){super(e,t),this.error=i,this.target=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},ml=class extends bn{urlAfterRedirects;state;type=kt.RoutesRecognized;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Sd=class extends bn{urlAfterRedirects;state;type=kt.GuardsCheckStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Dd=class extends bn{urlAfterRedirects;state;shouldActivate;type=kt.GuardsCheckEnd;constructor(e,t,i,r,o){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},wd=class extends bn{urlAfterRedirects;state;type=kt.ResolveStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Td=class extends bn{urlAfterRedirects;state;type=kt.ResolveEnd;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Id=class{route;type=kt.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Md=class{route;type=kt.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Ad=class{snapshot;type=kt.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Nd=class{snapshot;type=kt.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Rd=class{snapshot;type=kt.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Pd=class{snapshot;type=kt.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var pl=class{},os=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function lN(n){return!(n instanceof pl)&&!(n instanceof os)}function uN(n,e){return n.providers&&!n._injector&&(n._injector=Ua(n.providers,e,`Route: ${n.path}`)),n._injector??e}function ti(n){return n.outlet||ve}function cN(n,e){let t=n.filter(i=>ti(i)===e);return t.push(...n.filter(i=>ti(i)!==e)),t}function ls(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Fd=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return ls(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new us(this.rootInjector)}},us=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,i){let r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){let i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new Fd(this.rootInjector),this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(i){return new(i||n)(ie(Et))};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),kd=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=dh(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){let t=dh(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=fh(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return fh(e,this._root).map(t=>t.value)}};function dh(n,e){if(n===e.value)return e;for(let t of e.children){let i=dh(n,t);if(i)return i}return null}function fh(n,e){if(n===e.value)return[e];for(let t of e.children){let i=fh(n,t);if(i.length)return i.unshift(e),i}return[]}var En=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function ts(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var gl=class extends kd{snapshot;constructor(e,t){super(e),this.snapshot=t,Ch(this,e)}toString(){return this.snapshot.toString()}};function bE(n){let e=dN(n),t=new Ot([new mr("",{})]),i=new Ot({}),r=new Ot({}),o=new Ot({}),s=new Ot(""),a=new on(t,i,o,s,r,ve,n,e.root);return a.snapshot=e.root,new gl(new En(a,[]),e)}function dN(n){let e={},t={},i={},o=new eo([],e,i,"",t,ve,n,null,{});return new hl("",new En(o,[]))}var on=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,i,r,o,s,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(pe(d=>d[Cl]))??le(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(pe(e=>to(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(pe(e=>to(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Od(n,e,t="emptyOnly"){let i,{routeConfig:r}=n;return e!==null&&(t==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?i={params:k(k({},e.params),n.params),data:k(k({},e.data),n.data),resolve:k(k(k(k({},n.data),e.data),r?.data),n._resolvedData)}:i={params:k({},n.params),data:k({},n.data),resolve:k(k({},n.data),n._resolvedData??{})},r&&DE(r)&&(i.resolve[Cl]=r.title),i}var eo=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Cl]}constructor(e,t,i,r,o,s,a,c,d){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o,this.outlet=s,this.component=a,this.routeConfig=c,this._resolve=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=to(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=to(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(i=>i.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},hl=class extends kd{url;constructor(e,t){super(t),this.url=e,Ch(this,t)}toString(){return SE(this._root)}};function Ch(n,e){e.value._routerState=n,e.children.forEach(t=>Ch(n,t))}function SE(n){let e=n.children.length>0?` { ${n.children.map(SE).join(", ")} } `:"";return`${n.value}${e}`}function rh(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,vi(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),vi(e.params,t.params)||n.paramsSubject.next(t.params),LA(e.url,t.url)||n.urlSubject.next(t.url),vi(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function mh(n,e){let t=vi(n.params,e.params)&&HA(n.url,e.url),i=!n.parent!=!e.parent;return t&&!i&&(!n.parent||mh(n.parent,e.parent))}function DE(n){return typeof n.title=="string"||n.title===null}var wE=new Z(""),El=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=ve;activateEvents=new ot;deactivateEvents=new ot;attachEvents=new ot;detachEvents=new ot;routerOutletData=zc();parentContexts=R(us);location=R(Li);changeDetector=R(dr);inputBinder=R(Ud,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new j(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new j(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new j(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new j(4013,!1);this._activatedRoute=t;let r=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new ph(t,a,r.injector,this.routerOutletData);this.activated=r.createComponent(s,{index:r.length,injector:c,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(i){return new(i||n)};static \u0275dir=Ie({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[kn]})}return n})(),ph=class{route;childContexts;parent;outletData;constructor(e,t,i,r){this.route=e,this.childContexts=t,this.parent=i,this.outletData=r}get(e,t){return e===on?this.route:e===us?this.childContexts:e===wE?this.outletData:this.parent.get(e,t)}},Ud=new Z("");var xh=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=ee({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(i,r){i&1&&x(0,"router-outlet")},dependencies:[El],encapsulation:2})}return n})();function Eh(n){let e=n.children&&n.children.map(Eh),t=e?q(k({},n),{children:e}):k({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==ve&&(t.component=xh),t}function fN(n,e,t){let i=yl(n,e._root,t?t._root:void 0);return new gl(i,e)}function yl(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let i=t.value;i._futureSnapshot=e.value;let r=mN(n,e,t);return new En(i,r)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>yl(n,a)),s}}let i=pN(e.value),r=e.children.map(o=>yl(n,o));return new En(i,r)}}function mN(n,e,t){return e.children.map(i=>{for(let r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return yl(n,i,r);return yl(n,i)})}function pN(n){return new on(new Ot(n.url),new Ot(n.params),new Ot(n.queryParams),new Ot(n.fragment),new Ot(n.data),n.outlet,n.component,n)}var ss=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},TE="ngNavigationCancelingError";function Vd(n,e){let{redirectTo:t,navigationBehaviorOptions:i}=pr(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=IE(!1,rn.Redirect);return r.url=t,r.navigationBehaviorOptions=i,r}function IE(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[TE]=!0,t.cancellationCode=e,t}function gN(n){return ME(n)&&pr(n.url)}function ME(n){return!!n&&n[TE]}var hN=(n,e,t,i)=>pe(r=>(new gh(e,r.targetRouterState,r.currentRouterState,t,i).activate(n),r)),gh=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,i,r,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),rh(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){let r=ts(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,r[s],i),delete r[s]}),Object.values(r).forEach(o=>{this.deactivateRouteAndItsChildren(o,i)})}deactivateRoutes(e,t,i){let r=e.value,o=t?t.value:null;if(r===o)if(r.component){let s=i.getContext(r.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,i);else o&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=ts(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);if(i&&i.outlet){let s=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=ts(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){let r=ts(t);e.children.forEach(o=>{this.activateRoutes(o,r[o.value.outlet],i),this.forwardEvent(new Pd(o.value.snapshot))}),e.children.length&&this.forwardEvent(new Nd(e.value.snapshot))}activateRoutes(e,t,i){let r=e.value,o=t?t.value:null;if(rh(r),r===o)if(r.component){let s=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,i);else if(r.component){let s=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),rh(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=r,s.outlet&&s.outlet.activateWith(r,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,i)}},Ld=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},is=class{component;route;constructor(e,t){this.component=e,this.route=t}};function yN(n,e,t){let i=n._root,r=e?e._root:null;return al(i,r,t,[i.value])}function vN(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function cs(n,e){let t=Symbol(),i=e.get(n,t);return i===t?typeof n=="function"&&!tp(n)?n:e.get(n):i}function al(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=ts(e);return n.children.forEach(s=>{_N(s,o[s.value.outlet],t,i.concat([s.value]),r),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>cl(a,t.getContext(s),r)),r}function _N(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,s=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let c=CN(s,o,o.routeConfig.runGuardsAndResolvers);c?r.canActivateChecks.push(new Ld(i)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?al(n,e,a?a.children:null,i,r):al(n,e,t,i,r),c&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new is(a.outlet.component,s))}else s&&cl(e,a,r),r.canActivateChecks.push(new Ld(i)),o.component?al(n,null,a?a.children:null,i,r):al(n,null,t,i,r);return r}function CN(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!Xr(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Xr(n.url,e.url)||!vi(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!mh(n,e)||!vi(n.queryParams,e.queryParams);case"paramsChange":default:return!mh(n,e)}}function cl(n,e,t){let i=ts(n),r=n.value;Object.entries(i).forEach(([o,s])=>{r.component?e?cl(s,e.children.getContext(o),t):cl(s,null,t):cl(s,e,t)}),r.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new is(e.outlet.component,r)):t.canDeactivateChecks.push(new is(null,r)):t.canDeactivateChecks.push(new is(null,r))}function bl(n){return typeof n=="function"}function xN(n){return typeof n=="boolean"}function EN(n){return n&&bl(n.canLoad)}function bN(n){return n&&bl(n.canActivate)}function SN(n){return n&&bl(n.canActivateChild)}function DN(n){return n&&bl(n.canDeactivate)}function wN(n){return n&&bl(n.canMatch)}function AE(n){return n instanceof $n||n?.name==="EmptyError"}var vd=Symbol("INITIAL_VALUE");function as(){return qt(n=>Du(n.map(e=>e.pipe(Ti(1),Gm(vd)))).pipe(pe(e=>{for(let t of e)if(t!==!0){if(t===vd)return vd;if(t===!1||TN(t))return t}return!0}),It(e=>e!==vd),Ti(1)))}function TN(n){return pr(n)||n instanceof ss}function IN(n,e){return xt(t=>{let{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return s.length===0&&o.length===0?le(q(k({},t),{guardsResult:!0})):MN(s,i,r,n).pipe(xt(a=>a&&xN(a)?AN(i,o,n,e):le(a)),pe(a=>q(k({},t),{guardsResult:a})))})}function MN(n,e,t,i){return it(n).pipe(xt(r=>kN(r.component,r.route,t,e,i)),Ii(r=>r!==!0,!0))}function AN(n,e,t,i){return it(e).pipe(wi(r=>Mo(RN(r.route.parent,i),NN(r.route,i),FN(n,r.path,t),PN(n,r.route,t))),Ii(r=>r!==!0,!0))}function NN(n,e){return n!==null&&e&&e(new Rd(n)),le(!0)}function RN(n,e){return n!==null&&e&&e(new Ad(n)),le(!0)}function PN(n,e,t){let i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||i.length===0)return le(!0);let r=i.map(o=>oa(()=>{let s=ls(e)??t,a=cs(o,s),c=bN(a)?a.canActivate(e,n):At(s,()=>a(e,n));return Gi(c).pipe(Ii())}));return le(r).pipe(as())}function FN(n,e,t){let i=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>vN(s)).filter(s=>s!==null).map(s=>oa(()=>{let a=s.guards.map(c=>{let d=ls(s.node)??t,g=cs(c,d),y=SN(g)?g.canActivateChild(i,n):At(d,()=>g(i,n));return Gi(y).pipe(Ii())});return le(a).pipe(as())}));return le(o).pipe(as())}function kN(n,e,t,i,r){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return le(!0);let s=o.map(a=>{let c=ls(e)??r,d=cs(a,c),g=DN(d)?d.canDeactivate(n,e,t,i):At(c,()=>d(n,e,t,i));return Gi(g).pipe(Ii())});return le(s).pipe(as())}function ON(n,e,t,i){let r=e.canLoad;if(r===void 0||r.length===0)return le(!0);let o=r.map(s=>{let a=cs(s,n),c=EN(a)?a.canLoad(e,t):At(n,()=>a(e,t));return Gi(c)});return le(o).pipe(as(),NE(i))}function NE(n){return km(Ze(e=>{if(typeof e!="boolean")throw Vd(n,e)}),pe(e=>e===!0))}function VN(n,e,t,i){let r=e.canMatch;if(!r||r.length===0)return le(!0);let o=r.map(s=>{let a=cs(s,n),c=wN(a)?a.canMatch(e,t):At(n,()=>a(e,t));return Gi(c)});return le(o).pipe(as(),NE(i))}var vl=class{segmentGroup;constructor(e){this.segmentGroup=e||null}},_l=class extends Error{urlTree;constructor(e){super(),this.urlTree=e}};function es(n){return Di(new vl(n))}function LN(n){return Di(new j(4e3,!1))}function BN(n){return Di(IE(!1,rn.GuardRejected))}var hh=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),r.numberOfChildren===0)return le(i);if(r.numberOfChildren>1||!r.children[ve])return LN(`${e.redirectTo}`);r=r.children[ve]}}applyRedirectCommands(e,t,i,r,o){return UN(t,r,o).pipe(pe(s=>{if(s instanceof Ci)throw new _l(s);let a=this.applyRedirectCreateUrlTree(s,this.urlSerializer.parse(s),e,i);if(s[0]==="/")throw new _l(a);return a}))}applyRedirectCreateUrlTree(e,t,i,r){let o=this.createSegmentGroup(e,t.root,i,r);return new Ci(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let i={};return Object.entries(e).forEach(([r,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);i[r]=t[a]}else i[r]=o}),i}createSegmentGroup(e,t,i,r){let o=this.createSegments(e,t.segments,i,r),s={};return Object.entries(t.children).forEach(([a,c])=>{s[a]=this.createSegmentGroup(e,c,i,r)}),new Ve(o,s)}createSegments(e,t,i,r){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,r):this.findOrReturn(o,i))}findPosParam(e,t,i){let r=i[t.path.substring(1)];if(!r)throw new j(4001,!1);return r}findOrReturn(e,t){let i=0;for(let r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}};function UN(n,e,t){if(typeof n=="string")return le(n);let i=n,{queryParams:r,fragment:o,routeConfig:s,url:a,outlet:c,params:d,data:g,title:y}=e;return Gi(At(t,()=>i({params:d,data:g,queryParams:r,fragment:o,routeConfig:s,url:a,outlet:c,title:y})))}var yh={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function $N(n,e,t,i,r){let o=RE(n,e,t);return o.matched?(i=uN(e,i),VN(i,e,t,r).pipe(pe(s=>s===!0?o:k({},yh)))):le(o)}function RE(n,e,t){if(e.path==="**")return HN(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?k({},yh):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let r=(e.matcher||aE)(t,n,e);if(!r)return k({},yh);let o={};Object.entries(r.posParams??{}).forEach(([a,c])=>{o[a]=c.path});let s=r.consumed.length>0?k(k({},o),r.consumed[r.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:s,positionalParamSegments:r.posParams??{}}}function HN(n){return{matched:!0,parameters:n.length>0?uE(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function rE(n,e,t,i){return t.length>0&&WN(n,t,i)?{segmentGroup:new Ve(e,qN(i,new Ve(t,n.children))),slicedSegments:[]}:t.length===0&&jN(n,t,i)?{segmentGroup:new Ve(n.segments,GN(n,t,i,n.children)),slicedSegments:t}:{segmentGroup:new Ve(n.segments,n.children),slicedSegments:t}}function GN(n,e,t,i){let r={};for(let o of t)if($d(n,e,o)&&!i[ti(o)]){let s=new Ve([],{});r[ti(o)]=s}return k(k({},i),r)}function qN(n,e){let t={};t[ve]=e;for(let i of n)if(i.path===""&&ti(i)!==ve){let r=new Ve([],{});t[ti(i)]=r}return t}function WN(n,e,t){return t.some(i=>$d(n,e,i)&&ti(i)!==ve)}function jN(n,e,t){return t.some(i=>$d(n,e,i))}function $d(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function zN(n,e,t){return e.length===0&&!n.children[t]}var vh=class{};function YN(n,e,t,i,r,o,s="emptyOnly"){return new _h(n,e,t,i,r,s,o).recognize()}var JN=31,_h=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,i,r,o,s,a){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.applyRedirects=new hh(this.urlSerializer,this.urlTree)}noMatchError(e){return new j(4002,`'${e.segmentGroup}'`)}recognize(){let e=rE(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(pe(({children:t,rootSnapshot:i})=>{let r=new En(i,t),o=new hl("",r),s=vE(i,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}))}match(e){let t=new eo([],Object.freeze({}),Object.freeze(k({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),ve,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,ve,t).pipe(pe(i=>({children:i,rootSnapshot:t})),Hn(i=>{if(i instanceof _l)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof vl?this.noMatchError(i):i}))}processSegmentGroup(e,t,i,r,o){return i.segments.length===0&&i.hasChildren()?this.processChildren(e,t,i,o):this.processSegment(e,t,i,i.segments,r,!0,o).pipe(pe(s=>s instanceof En?[s]:[]))}processChildren(e,t,i,r){let o=[];for(let s of Object.keys(i.children))s==="primary"?o.unshift(s):o.push(s);return it(o).pipe(wi(s=>{let a=i.children[s],c=cN(t,s);return this.processSegmentGroup(e,c,a,s,r)}),Hm((s,a)=>(s.push(...a),s)),Yi(null),$m(),xt(s=>{if(s===null)return es(i);let a=PE(s);return KN(a),le(a)}))}processSegment(e,t,i,r,o,s,a){return it(t).pipe(wi(c=>this.processSegmentAgainstRoute(c._injector??e,t,c,i,r,o,s,a).pipe(Hn(d=>{if(d instanceof vl)return le(null);throw d}))),Ii(c=>!!c),Hn(c=>{if(AE(c))return zN(i,r,o)?le(new vh):es(i);throw c}))}processSegmentAgainstRoute(e,t,i,r,o,s,a,c){return ti(i)!==s&&(s===ve||!$d(r,o,i))?es(r):i.redirectTo===void 0?this.matchSegmentAgainstRoute(e,r,i,o,s,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,o,s,c):es(r)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,o,s,a){let{matched:c,parameters:d,consumedSegments:g,positionalParamSegments:y,remainingSegments:v}=RE(t,r,o);if(!c)return es(t);typeof r.redirectTo=="string"&&r.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>JN&&(this.allowRedirects=!1));let _=new eo(o,d,Object.freeze(k({},this.urlTree.queryParams)),this.urlTree.fragment,oE(r),ti(r),r.component??r._loadedComponent??null,r,sE(r)),b=Od(_,a,this.paramsInheritanceStrategy);return _.params=Object.freeze(b.params),_.data=Object.freeze(b.data),this.applyRedirects.applyRedirectCommands(g,r.redirectTo,y,_,e).pipe(qt(M=>this.applyRedirects.lineralizeSegments(r,M)),xt(M=>this.processSegment(e,i,t,M.concat(v),s,!1,a)))}matchSegmentAgainstRoute(e,t,i,r,o,s){let a=$N(t,i,r,e,this.urlSerializer);return i.path==="**"&&(t.children={}),a.pipe(qt(c=>c.matched?(e=i._injector??e,this.getChildConfig(e,i,r).pipe(qt(({routes:d})=>{let g=i._loadedInjector??e,{parameters:y,consumedSegments:v,remainingSegments:_}=c,b=new eo(v,y,Object.freeze(k({},this.urlTree.queryParams)),this.urlTree.fragment,oE(i),ti(i),i.component??i._loadedComponent??null,i,sE(i)),I=Od(b,s,this.paramsInheritanceStrategy);b.params=Object.freeze(I.params),b.data=Object.freeze(I.data);let{segmentGroup:M,slicedSegments:A}=rE(t,v,_,d);if(A.length===0&&M.hasChildren())return this.processChildren(g,d,M,b).pipe(pe(G=>new En(b,G)));if(d.length===0&&A.length===0)return le(new En(b,[]));let B=ti(i)===o;return this.processSegment(g,d,M,A,B?ve:o,!0,b).pipe(pe(G=>new En(b,G instanceof En?[G]:[])))}))):es(t)))}getChildConfig(e,t,i){return t.children?le({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?le({routes:t._loadedRoutes,injector:t._loadedInjector}):ON(e,t,i,this.urlSerializer).pipe(xt(r=>r?this.configLoader.loadChildren(e,t).pipe(Ze(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):BN(t))):le({routes:[],injector:e})}};function KN(n){n.sort((e,t)=>e.value.outlet===ve?-1:t.value.outlet===ve?1:e.value.outlet.localeCompare(t.value.outlet))}function QN(n){let e=n.value.routeConfig;return e&&e.path===""}function PE(n){let e=[],t=new Set;for(let i of n){if(!QN(i)){e.push(i);continue}let r=e.find(o=>i.value.routeConfig===o.value.routeConfig);r!==void 0?(r.children.push(...i.children),t.add(r)):e.push(i)}for(let i of t){let r=PE(i.children);e.push(new En(i.value,r))}return e.filter(i=>!t.has(i))}function oE(n){return n.data||{}}function sE(n){return n.resolve||{}}function ZN(n,e,t,i,r,o){return xt(s=>YN(n,e,t,i,s.extractedUrl,r,o).pipe(pe(({state:a,tree:c})=>q(k({},s),{targetSnapshot:a,urlAfterRedirects:c}))))}function XN(n,e){return xt(t=>{let{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return le(t);let o=new Set(r.map(c=>c.route)),s=new Set;for(let c of o)if(!s.has(c))for(let d of FE(c))s.add(d);let a=0;return it(s).pipe(wi(c=>o.has(c)?eR(c,i,n,e):(c.data=Od(c,c.parent,n).resolve,le(void 0))),Ze(()=>a++),Ao(1),xt(c=>a===s.size?le(t):ln))})}function FE(n){let e=n.children.map(t=>FE(t)).flat();return[n,...e]}function eR(n,e,t,i){let r=n.routeConfig,o=n._resolve;return r?.title!==void 0&&!DE(r)&&(o[Cl]=r.title),oa(()=>(n.data=Od(n,n.parent,t).resolve,tR(o,n,e,i).pipe(pe(s=>(n._resolvedData=s,n.data=k(k({},n.data),s),null)))))}function tR(n,e,t,i){let r=ah(n);if(r.length===0)return le({});let o={};return it(r).pipe(xt(s=>nR(n[s],e,t,i).pipe(Ii(),Ze(a=>{if(a instanceof ss)throw Vd(new no,a);o[s]=a}))),Ao(1),pe(()=>o),Hn(s=>AE(s)?ln:Di(s)))}function nR(n,e,t,i){let r=ls(e)??i,o=cs(n,r),s=o.resolve?o.resolve(e,t):At(r,()=>o(e,t));return Gi(s)}function oh(n){return qt(e=>{let t=n(e);return t?it(t).pipe(pe(()=>e)):le(e)})}var bh=(()=>{class n{buildTitle(t){let i,r=t.root;for(;r!==void 0;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(o=>o.outlet===ve);return i}getResolvedTitleForRoute(t){return t.data[Cl]}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Y({token:n,factory:()=>R(kE),providedIn:"root"})}return n})(),kE=(()=>{class n extends bh{title;constructor(t){super(),this.title=t}updateTitle(t){let i=this.buildTitle(t);i!==void 0&&this.title.setTitle(i)}static \u0275fac=function(i){return new(i||n)(ie(Xx))};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ds=new Z("",{providedIn:"root",factory:()=>({})}),Sl=new Z(""),OE=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=R(gg);loadComponent(t,i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return le(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);let r=Gi(At(t,()=>i.loadComponent())).pipe(pe(LE),qt(BE),Ze(s=>{this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=s}),Ji(()=>{this.componentLoaders.delete(i)})),o=new To(r,()=>new pt).pipe(wo());return this.componentLoaders.set(i,o),o}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return le({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=VE(i,this.compiler,t,this.onLoadEndListener).pipe(Ji(()=>{this.childrenLoaders.delete(i)})),s=new To(o,()=>new pt).pipe(wo());return this.childrenLoaders.set(i,s),s}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function VE(n,e,t,i){return Gi(At(t,()=>n.loadChildren())).pipe(pe(LE),qt(BE),xt(r=>r instanceof Vc||Array.isArray(r)?le(r):it(e.compileModuleAsync(r))),pe(r=>{i&&i(n);let o,s,a=!1;return Array.isArray(r)?(s=r,a=!0):(o=r.create(t).injector,s=o.get(Sl,[],{optional:!0,self:!0}).flat()),{routes:s.map(Eh),injector:o}}))}function iR(n){return n&&typeof n=="object"&&"default"in n}function LE(n){return iR(n)?n.default:n}function BE(n){return le(n)}var Hd=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=Y({token:n,factory:()=>R(rR),providedIn:"root"})}return n})(),rR=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),UE=new Z("");var $E=new Z(""),HE=(()=>{class n{currentNavigation=D(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=null;events=new pt;transitionAbortWithErrorSubject=new pt;configLoader=R(OE);environmentInjector=R(Et);destroyRef=R(Pn);urlSerializer=R(xl);rootContexts=R(us);location=R(Jr);inputBindingEnabled=R(Ud,{optional:!0})!==null;titleStrategy=R(bh);options=R(ds,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=R(Hd);createViewTransition=R(UE,{optional:!0});navigationErrorHandler=R($E,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>le(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=r=>this.events.next(new Id(r)),i=r=>this.events.next(new Md(r));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let i=++this.navigationId;Rt(()=>{this.transitions?.next(q(k({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,abortController:new AbortController,id:i}))})}setupNavigations(t){return this.transitions=new Ot(null),this.transitions.pipe(It(i=>i!==null),qt(i=>{let r=!1;return le(i).pipe(qt(o=>{if(this.navigationId>i.id)return this.cancelNavigationTransition(i,"",rn.SupersededByNewNavigation),ln;this.currentTransition=i,this.currentNavigation.set({id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,targetBrowserUrl:typeof o.extras.browserUrl=="string"?this.urlSerializer.parse(o.extras.browserUrl):o.extras.browserUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?q(k({},this.lastSuccessfulNavigation),{previousNavigation:null}):null,abort:()=>o.abortController.abort()});let s=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),a=o.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!s&&a!=="reload")return this.events.next(new Hi(o.id,this.urlSerializer.serialize(o.rawUrl),"",fl.IgnoredSameUrlNavigation)),o.resolve(!1),ln;if(this.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return le(o).pipe(qt(c=>(this.events.next(new io(c.id,this.urlSerializer.serialize(c.extractedUrl),c.source,c.restoredState)),c.id!==this.navigationId?ln:Promise.resolve(c))),ZN(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),Ze(c=>{i.targetSnapshot=c.targetSnapshot,i.urlAfterRedirects=c.urlAfterRedirects,this.currentNavigation.update(g=>(g.finalUrl=c.urlAfterRedirects,g));let d=new ml(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(d)}));if(s&&this.urlHandlingStrategy.shouldProcessUrl(o.currentRawUrl)){let{id:c,extractedUrl:d,source:g,restoredState:y,extras:v}=o,_=new io(c,this.urlSerializer.serialize(d),g,y);this.events.next(_);let b=bE(this.rootComponentType).snapshot;return this.currentTransition=i=q(k({},o),{targetSnapshot:b,urlAfterRedirects:d,extras:q(k({},v),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(I=>(I.finalUrl=d,I)),le(i)}else return this.events.next(new Hi(o.id,this.urlSerializer.serialize(o.extractedUrl),"",fl.IgnoredByUrlHandlingStrategy)),o.resolve(!1),ln}),Ze(o=>{let s=new Sd(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(s)}),pe(o=>(this.currentTransition=i=q(k({},o),{guards:yN(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),i)),IN(this.environmentInjector,o=>this.events.next(o)),Ze(o=>{if(i.guardsResult=o.guardsResult,o.guardsResult&&typeof o.guardsResult!="boolean")throw Vd(this.urlSerializer,o.guardsResult);let s=new Dd(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(s)}),It(o=>o.guardsResult?!0:(this.cancelNavigationTransition(o,"",rn.GuardRejected),!1)),oh(o=>{if(o.guards.canActivateChecks.length!==0)return le(o).pipe(Ze(s=>{let a=new wd(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot);this.events.next(a)}),qt(s=>{let a=!1;return le(s).pipe(XN(this.paramsInheritanceStrategy,this.environmentInjector),Ze({next:()=>a=!0,complete:()=>{a||this.cancelNavigationTransition(s,"",rn.NoDataFromResolver)}}))}),Ze(s=>{let a=new Td(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot);this.events.next(a)}))}),oh(o=>{let s=a=>{let c=[];if(a.routeConfig?.loadComponent){let d=ls(a)??this.environmentInjector;c.push(this.configLoader.loadComponent(d,a.routeConfig).pipe(Ze(g=>{a.component=g}),pe(()=>{})))}for(let d of a.children)c.push(...s(d));return c};return Du(s(o.targetSnapshot.root)).pipe(Yi(null),Ti(1))}),oh(()=>this.afterPreactivation()),qt(()=>{let{currentSnapshot:o,targetSnapshot:s}=i,a=this.createViewTransition?.(this.environmentInjector,o.root,s.root);return a?it(a).pipe(pe(()=>i)):le(i)}),pe(o=>{let s=fN(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return this.currentTransition=i=q(k({},o),{targetRouterState:s}),this.currentNavigation.update(a=>(a.targetRouterState=s,a)),i}),Ze(()=>{this.events.next(new pl)}),hN(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o),this.inputBindingEnabled),Ti(1),Tu(new Se(o=>{let s=i.abortController.signal,a=()=>o.next();return s.addEventListener("abort",a),()=>s.removeEventListener("abort",a)}).pipe(It(()=>!r&&!i.targetRouterState),Ze(()=>{this.cancelNavigationTransition(i,i.abortController.signal.reason+"",rn.Aborted)}))),Ze({next:o=>{r=!0,this.lastSuccessfulNavigation=Rt(this.currentNavigation),this.events.next(new Sn(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects))),this.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{r=!0}}),Tu(this.transitionAbortWithErrorSubject.pipe(Ze(o=>{throw o}))),Ji(()=>{r||this.cancelNavigationTransition(i,"",rn.SupersededByNewNavigation),this.currentTransition?.id===i.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),Hn(o=>{if(this.destroyed)return i.resolve(!1),ln;if(r=!0,ME(o))this.events.next(new _i(i.id,this.urlSerializer.serialize(i.extractedUrl),o.message,o.cancellationCode)),gN(o)?this.events.next(new os(o.url,o.navigationBehaviorOptions)):i.resolve(!1);else{let s=new rs(i.id,this.urlSerializer.serialize(i.extractedUrl),o,i.targetSnapshot??void 0);try{let a=At(this.environmentInjector,()=>this.navigationErrorHandler?.(s));if(a instanceof ss){let{message:c,cancellationCode:d}=Vd(this.urlSerializer,a);this.events.next(new _i(i.id,this.urlSerializer.serialize(i.extractedUrl),c,d)),this.events.next(new os(a.redirectTo,a.navigationBehaviorOptions))}else throw this.events.next(s),o}catch(a){this.options.resolveNavigationPromiseOnError?i.resolve(!1):i.reject(a)}}return ln}))}))}cancelNavigationTransition(t,i,r){let o=new _i(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=Rt(this.currentNavigation),r=i?.targetBrowserUrl??i?.extractedUrl;return t.toString()!==r?.toString()&&!i?.extras.skipLocationChange}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function oR(n){return n!==ul}var GE=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=Y({token:n,factory:()=>R(sR),providedIn:"root"})}return n})(),Bd=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},sR=(()=>{class n extends Bd{static \u0275fac=(()=>{let t;return function(r){return(t||(t=Qt(n)))(r||n)}})();static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),qE=(()=>{class n{urlSerializer=R(xl);options=R(ds,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=R(Jr);urlHandlingStrategy=R(Hd);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new Ci;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:i,targetBrowserUrl:r}){let o=t!==void 0?this.urlHandlingStrategy.merge(t,i):i,s=r??o;return s instanceof Ci?this.urlSerializer.serialize(s):s}commitTransition({targetRouterState:t,finalUrl:i,initialUrl:r}){i&&t?(this.currentUrlTree=i,this.rawUrlTree=this.urlHandlingStrategy.merge(i,r),this.routerState=t):this.rawUrlTree=r}routerState=bE(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Y({token:n,factory:()=>R(aR),providedIn:"root"})}return n})(),aR=(()=>{class n extends qE{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{i.type==="popstate"&&setTimeout(()=>{t(i.url,i.state,"popstate")})})}handleRouterEvent(t,i){t instanceof io?this.updateStateMemento():t instanceof Hi?this.commitTransition(i):t instanceof ml?this.urlUpdateStrategy==="eager"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof pl?(this.commitTransition(i),this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof _i&&t.code!==rn.SupersededByNewNavigation&&t.code!==rn.Redirect?this.restoreHistory(i):t instanceof rs?this.restoreHistory(i,!0):t instanceof Sn&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:i,id:r}){let{replaceUrl:o,state:s}=i;if(this.location.isCurrentPathEqualTo(t)||o){let a=this.browserPageId,c=k(k({},s),this.generateNgRouterState(r,a));this.location.replaceState(t,"",c)}else{let a=k(k({},s),this.generateNgRouterState(r,this.browserPageId+1));this.location.go(t,"",a)}}restoreHistory(t,i=!1){if(this.canceledNavigationResolution==="computed"){let r=this.browserPageId,o=this.currentPageId-r;o!==0?this.location.historyGo(o):this.getCurrentUrlTree()===t.finalUrl&&o===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Qt(n)))(r||n)}})();static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Sh(n,e){n.events.pipe(It(t=>t instanceof Sn||t instanceof _i||t instanceof rs||t instanceof Hi),pe(t=>t instanceof Sn||t instanceof Hi?0:(t instanceof _i?t.code===rn.Redirect||t.code===rn.SupersededByNewNavigation:!1)?2:1),It(t=>t!==2),Ti(1)).subscribe(()=>{e()})}var lR={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},uR={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Ne=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=R(lg);stateManager=R(qE);options=R(ds,{optional:!0})||{};pendingTasks=R(pi);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=R(HE);urlSerializer=R(xl);location=R(Jr);urlHandlingStrategy=R(Hd);injector=R(Et);_events=new pt;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=R(GE);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=R(Sl,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!R(Ud,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new _t;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(i=>{try{let r=this.navigationTransitions.currentTransition,o=Rt(this.navigationTransitions.currentNavigation);if(r!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof _i&&i.code!==rn.Redirect&&i.code!==rn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Sn)this.navigated=!0;else if(i instanceof os){let s=i.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),c=k({browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||this.urlUpdateStrategy==="eager"||oR(r.source)},s);this.scheduleNavigation(a,ul,null,c,{resolve:r.resolve,reject:r.reject,promise:r.promise})}}lN(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortWithErrorSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),ul,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i,r)=>{this.navigateToSyncWithBrowser(t,r,i)})}navigateToSyncWithBrowser(t,i,r){let o={replaceUrl:!0},s=r?.navigationId?r:null;if(r){let c=k({},r);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let a=this.parseUrl(t);this.scheduleNavigation(a,i,s,o).catch(c=>{this.disposed||this.injector.get(cn)(c)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return Rt(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Eh),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){let{relativeTo:r,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:c}=i,d=c?this.currentUrlTree.fragment:s,g=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":g=k(k({},this.currentUrlTree.queryParams),o);break;case"preserve":g=this.currentUrlTree.queryParams;break;default:g=o||null}g!==null&&(g=this.removeEmptyProps(g));let y;try{let v=r?r.snapshot:this.routerState.snapshot.root;y=_E(v)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),y=this.currentUrlTree.root}return CE(y,t,g,d??null)}navigateByUrl(t,i={skipLocationChange:!1}){let r=pr(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(o,ul,null,i)}navigate(t,i={skipLocationChange:!1}){return cR(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.console.warn(Zi(4018,!1)),this.urlSerializer.parse("/")}}isActive(t,i){let r;if(i===!0?r=k({},lR):i===!1?r=k({},uR):r=i,pr(t))return eE(this.currentUrlTree,t,r);let o=this.parseUrl(t);return eE(this.currentUrlTree,o,r)}removeEmptyProps(t){return Object.entries(t).reduce((i,[r,o])=>(o!=null&&(i[r]=o),i),{})}scheduleNavigation(t,i,r,o,s){if(this.disposed)return Promise.resolve(!1);let a,c,d;s?(a=s.resolve,c=s.reject,d=s.promise):d=new Promise((y,v)=>{a=y,c=v});let g=this.pendingTasks.add();return Sh(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(g))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:c,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(y=>Promise.reject(y))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function cR(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new j(4008,!1)}var gr=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;reactiveHref=D(null);get href(){return Rt(this.reactiveHref)}set href(t){this.reactiveHref.set(t)}target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new pt;applicationErrorHandler=R(cn);options=R(ds,{optional:!0});constructor(t,i,r,o,s,a){this.router=t,this.route=i,this.tabIndexAttribute=r,this.renderer=o,this.el=s,this.locationStrategy=a,this.reactiveHref.set(R(new Wc("href"),{optional:!0}));let c=s.nativeElement.tagName?.toLowerCase();this.isAnchorElement=c==="a"||c==="area"||!!(typeof customElements=="object"&&customElements.get(c)?.observedAttributes?.includes?.("href")),this.isAnchorElement?this.setTabIndexIfNotOnNativeEl("0"):this.subscribeToNavigationEventsIfNecessary()}subscribeToNavigationEventsIfNecessary(){if(this.subscription!==void 0||!this.isAnchorElement)return;let t=this.preserveFragment,i=r=>r==="merge"||r==="preserve";t||=i(this.queryParamsHandling),t||=!this.queryParamsHandling&&!i(this.options?.defaultQueryParamsHandling),t&&(this.subscription=this.router.events.subscribe(r=>{r instanceof Sn&&this.updateHref()}))}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&(this.updateHref(),this.subscribeToNavigationEventsIfNecessary()),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(pr(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,i,r,o,s){let a=this.urlTree;if(a===null||this.isAnchorElement&&(t!==0||i||r||o||s||typeof this.target=="string"&&this.target!="_self"))return!0;let c={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(a,c)?.catch(d=>{this.applicationErrorHandler(d)}),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.reactiveHref.set(t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t))??"":null)}applyAttributeValue(t,i){let r=this.renderer,o=this.el.nativeElement;i!==null?r.setAttribute(o,t,i):r.removeAttribute(o,t)}get urlTree(){return this.routerLinkInput===null?null:pr(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(i){return new(i||n)(J(Ne),J(on),Fa("tabindex"),J(Jn),J(Zt),J(yi))};static \u0275dir=Ie({type:n,selectors:[["","routerLink",""]],hostVars:2,hostBindings:function(i,r){i&1&&S("click",function(s){return r.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),i&2&&ft("href",r.reactiveHref(),L0)("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",Yr],skipLocationChange:[2,"skipLocationChange","skipLocationChange",Yr],replaceUrl:[2,"replaceUrl","replaceUrl",Yr],routerLink:"routerLink"},features:[kn]})}return n})(),Dh=(()=>{class n{router;element;renderer;cdr;link;links;classes=[];routerEventsSubscription;linkInputChangesSubscription;_isActive=!1;get isActive(){return this._isActive}routerLinkActiveOptions={exact:!1};ariaCurrentWhenActive;isActiveChange=new ot;constructor(t,i,r,o,s){this.router=t,this.element=i,this.renderer=r,this.cdr=o,this.link=s,this.routerEventsSubscription=t.events.subscribe(a=>{a instanceof Sn&&this.update()})}ngAfterContentInit(){le(this.links.changes,le(null)).pipe(Io()).subscribe(t=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();let t=[...this.links.toArray(),this.link].filter(i=>!!i).map(i=>i.onChanges);this.linkInputChangesSubscription=it(t).pipe(Io()).subscribe(i=>{this._isActive!==this.isLinkActive(this.router)(i)&&this.update()})}set routerLinkActive(t){let i=Array.isArray(t)?t:t.split(" ");this.classes=i.filter(r=>!!r)}ngOnChanges(t){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{let t=this.hasActiveLinks();this.classes.forEach(i=>{t?this.renderer.addClass(this.element.nativeElement,i):this.renderer.removeClass(this.element.nativeElement,i)}),t&&this.ariaCurrentWhenActive!==void 0?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this._isActive!==t&&(this._isActive=t,this.cdr.markForCheck(),this.isActiveChange.emit(t))})}isLinkActive(t){let i=fR(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return r=>{let o=r.urlTree;return o?t.isActive(o,i):!1}}hasActiveLinks(){let t=this.isLinkActive(this.router);return this.link&&t(this.link)||this.links.some(t)}static \u0275fac=function(i){return new(i||n)(J(Ne),J(Zt),J(Jn),J(dr),J(gr,8))};static \u0275dir=Ie({type:n,selectors:[["","routerLinkActive",""]],contentQueries:function(i,r,o){if(i&1&&mg(o,gr,5),i&2){let s;en(s=tn())&&(r.links=s)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],features:[kn]})}return n})();function fR(n){return!!n.paths}var mR=new Z("");function wh(n,...e){return Ar([{provide:Sl,multi:!0,useValue:n},[],{provide:on,useFactory:pR,deps:[Ne]},{provide:Lc,multi:!0,useFactory:hR},e.map(t=>t.\u0275providers)])}function pR(n){return n.routerState.root}function gR(n,e){return{\u0275kind:n,\u0275providers:e}}function hR(){let n=R(Wt);return e=>{let t=n.get(Bi);if(e!==t.components[0])return;let i=n.get(Ne),r=n.get(yR);n.get(vR)===1&&i.initialNavigation(),n.get(_R,null,{optional:!0})?.setUpPreloading(),n.get(mR,null,{optional:!0})?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var yR=new Z("",{factory:()=>new pt}),vR=new Z("",{providedIn:"root",factory:()=>1});var _R=new Z("");function Th(){return gR(6,[{provide:yi,useClass:Fg}])}var ro=class ro{constructor(e,t){this.http=e;this.router=t;this.baseUrl="/api/admin";this.tokenKey="gh_finance_auth_token";this.adminKey="gh_finance_admin_data";this.expiryKey="gh_finance_token_expiry";this.currentAdmin=D(null);this.isAuthenticated=D(!1);this.isLoading=D(!1);this.error=D(null);this.isSuperAdmin=H(()=>this.currentAdmin()?.roles.some(t=>t.role_name==="super_admin")??!1);this.isManagedAdmin=H(()=>this.currentAdmin()?.roles.some(t=>["super_admin","user_manager"].includes(t.role_name))??!1);this.initializeAuth()}initializeAuth(){let e=this.getToken(),t=this.getTokenExpiry();if(e&&t)if(new Date().getTime()<t){let i=localStorage.getItem(this.adminKey);i&&(this.currentAdmin.set(JSON.parse(i)),this.isAuthenticated.set(!0))}else this.clearAuth()}async loginWithGoogle(e){try{this.isLoading.set(!0),this.error.set(null);let t=await Pe(this.http.post(`${this.baseUrl}/auth/google`,{idToken:e}));if(t.success&&t.data){let{token:i,admin:r}=t.data;return this.saveToken(i),this.saveAdmin(r),this.currentAdmin.set(r),this.isAuthenticated.set(!0),!0}else return this.error.set(t.error||"Login failed"),!1}catch(t){let i=t.error?.error||"Authentication failed";return this.error.set(i),!1}finally{this.isLoading.set(!1)}}logout(){this.clearAuth(),this.router.navigate(["/login"])}hasPermission(e){return this.currentAdmin()?.permissions.includes(e)??!1}hasRole(e){return this.currentAdmin()?.roles.some(i=>i.role_name===e)??!1}hasAnyRole(e){return this.currentAdmin()?.roles.some(i=>e.includes(i.role_name))??!1}getToken(){return localStorage.getItem(this.tokenKey)}getTokenExpiry(){let e=localStorage.getItem(this.expiryKey);return e?parseInt(e):null}saveToken(e){let t=new Date().getTime()+6048e5;localStorage.setItem(this.tokenKey,e),localStorage.setItem(this.expiryKey,t.toString())}saveAdmin(e){localStorage.setItem(this.adminKey,JSON.stringify(e))}clearAuth(){localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.adminKey),localStorage.removeItem(this.expiryKey),this.currentAdmin.set(null),this.isAuthenticated.set(!1)}refreshTokenExpiry(){let e=this.getToken();e&&this.saveToken(e)}getCurrentAdmin(){return this.currentAdmin()}isTokenExpiringSoon(){let e=this.getTokenExpiry();if(!e)return!0;let t=new Date().getTime(),i=3600*1e3;return e-t<i}};ro.\u0275fac=function(t){return new(t||ro)(ie(zt),ie(Ne))},ro.\u0275prov=Y({token:ro,factory:ro.\u0275fac,providedIn:"root"});var nt=ro;var WE=()=>({exact:!0}),CR=(n,e)=>e.name,xR=(n,e)=>e.path;function ER(n,e){if(n&1&&(l(0,"a",16),x(1,"ion-icon",17),l(2,"span",18),m(3),u()()),n&2){let t=e.$implicit;N("routerLink",t.path)("routerLinkActiveOptions",fn(4,WE)),h(),N("name",t.icon),h(2),E(t.name)}}function bR(n,e){if(n&1&&(l(0,"div",15),O(1,ER,4,5,"a",16,xR),u()),n&2){let t=C(2).$implicit;h(),V(t.children)}}function SR(n,e){if(n&1){let t=U();l(0,"div")(1,"button",10),S("click",function(){w(t);let r=C().$implicit,o=C();return T(o.toggleMenu(r.name))}),l(2,"div",11),x(3,"ion-icon",12),l(4,"span",13),m(5),u()(),x(6,"ion-icon",14),u(),P(7,bR,3,0,"div",15),u()}if(n&2){let t=C().$implicit,i=C();h(),Q("text-indigo-600",i.isMenuActive(t.children))("font-semibold",i.isMenuActive(t.children)),h(2),N("name",t.icon),h(2),E(t.name),h(),Q("rotate-180",i.openMenu()===t.name),h(),F(i.openMenu()===t.name?7:-1)}}function DR(n,e){if(n&1&&(l(0,"a",9),x(1,"ion-icon",12),l(2,"span",13),m(3),u()()),n&2){let t=C().$implicit;N("routerLink",t.path)("routerLinkActiveOptions",fn(4,WE)),h(),N("name",t.icon),h(2),E(t.name)}}function wR(n,e){if(n&1&&P(0,SR,8,9,"div")(1,DR,4,5,"a",9),n&2){let t=e.$implicit;F(t.children&&t.children.length>0?0:1)}}var fs=class fs{constructor(){this.router=R(Ne);this.authService=R(nt);this.http=R(zt);this.openMenu=D(null);this.isSuperAdmin=D(!1);this.allNavLinks=[{path:"/dashboard",icon:"grid-outline",name:"\u5100\u8868\u677F"},{name:"\u8CA1\u52D9\u8207\u5206\u6790",icon:"analytics-outline",children:[{path:"/daily-revenue",icon:"stats-chart-outline",name:"\u7576\u65E5\u71DF\u6536"},{path:"/financial-statements",icon:"document-text-outline",name:"\u8CA1\u52D9\u5831\u8868"},{path:"/customer-analysis",icon:"people-outline",name:"\u9867\u5BA2\u7BA1\u7406"},{path:"/product-analysis",icon:"cube-outline",name:"\u5546\u54C1\u5206\u6790"},{path:"/monthly-targets",icon:"trending-up-outline",name:"\u71DF\u6536\u76EE\u6A19"}]},{name:"\u6210\u672C\u8207\u5EE0\u5546",icon:"wallet-outline",children:[{path:"/product-cost",icon:"pricetags-outline",name:"\u5546\u54C1\u6210\u672C"},{path:"/purchase-orders",icon:"receipt-outline",name:"\u9032\u8CA8\u55AE\u7BA1\u7406"},{path:"/vendors",icon:"briefcase-outline",name:"\u5EE0\u5546\u7BA1\u7406"}]},{name:"\u4EA4\u6613\u8207\u5E33\u52D9",icon:"reader-outline",children:[{path:"/ledger",icon:"reader-outline",name:"\u6D41\u6C34\u5E33"}]},{name:"\u884C\u92B7\u8207\u6D3B\u52D5",icon:"megaphone-outline",children:[{path:"/events",icon:"calendar-outline",name:"\u6D3B\u52D5\u7BA1\u7406"}]},{name:"\u80A1\u6771\u8207\u85AA\u8CC7",icon:"people-circle-outline",children:[{path:"/payroll",icon:"card-outline",name:"\u6253\u5361\u85AA\u8CC7"},{path:"/shareholder-rebates",icon:"diamond-outline",name:"\u80A1\u6771\u56DE\u994B\u91D1"}]},{name:"\u5354\u4F5C\u7A7A\u9593",icon:"people-outline",children:[{path:"/goal-setting",icon:"trophy-outline",name:"\u5718\u968A\u76EE\u6A19\u8A2D\u5B9A"},{path:"/goal-progress",icon:"flag-outline",name:"\u500B\u4EBA\u76EE\u6A19\u9032\u5EA6"},{path:"/shareholder-records",icon:"document-text-outline",name:"\u500B\u4EBA\u6BCF\u5468\u9032\u5EA6\u7D00\u9304"},{path:"/meeting",icon:"chatbubbles-outline",name:"\u6BCF\u5468\u6703\u8B70\u7D00\u9304"},{path:"/decision-log",icon:"key-outline",name:"\u91CD\u5927\u4E8B\u9805\u4F48\u9054"}]},{name:"\u5E33\u865F\u7BA1\u7406",icon:"person-circle-outline",children:[{path:"/account",icon:"settings-outline",name:"\u5E33\u865F\u8A2D\u5B9A"},{path:"/user-management",icon:"shield-checkmark-outline",name:"\u4F7F\u7528\u8005\u7BA1\u7406"}]}];this.navLinks=H(()=>{if(!this.authService.isAuthenticated())return[];let e=this.allNavLinks;return this.isSuperAdmin()&&(e=[...e.slice(0,e.length-1),{name:"\u5E33\u865F\u7BA1\u7406",icon:"person-circle-outline",children:[{path:"/account",icon:"settings-outline",name:"\u5E33\u865F\u8A2D\u5B9A"},{path:"/user-management",icon:"shield-checkmark-outline",name:"\u4F7F\u7528\u8005\u7BA1\u7406"},{path:"/role-permissions",icon:"lock-closed-outline",name:"\u89D2\u8272\u6B0A\u9650\u63A7\u7BA1"}]}]),e})}ngOnInit(){this.checkSuperAdminStatus(),this.router.events.pipe(It(e=>e instanceof Sn)).subscribe(()=>{let e=this.navLinks().find(t=>this.isMenuActive(t.children));e&&this.openMenu.set(e.name)})}checkSuperAdminStatus(){try{let e=this.authService.getToken();if(!e){this.isSuperAdmin.set(!1);return}let t=new Ft({Authorization:`Bearer ${e}`,"Content-Type":"application/json"});this.http.get("/api/admin/profile",{headers:t}).subscribe({next:i=>{if(i?.data?.roles&&Array.isArray(i.data.roles)){let r=i.data.roles.some(o=>o.role_name==="super_admin");this.isSuperAdmin.set(r)}},error:()=>{this.isSuperAdmin.set(!1)}})}catch{this.isSuperAdmin.set(!1)}}toggleMenu(e){this.openMenu.update(t=>t===e?null:e)}isMenuActive(e){return e?e.some(t=>t.path&&this.router.isActive(t.path,{paths:"exact",queryParams:"subset",fragment:"ignored",matrixParams:"ignored"})):!1}};fs.\u0275fac=function(t){return new(t||fs)},fs.\u0275cmp=ee({type:fs,selectors:[["app-sidebar"]],decls:13,vars:0,consts:[[1,"w-64","flex-shrink-0","bg-white","border-r","border-gray-200","flex","flex-col"],[1,"h-16","flex","items-center","justify-center","border-b","border-gray-200"],[1,"flex","items-center","space-x-2"],["name","pulse-outline",1,"text-3xl","text-indigo-600"],[1,"text-xl","font-semibold","text-gray-800"],[1,"flex-1","flex","flex-col","overflow-y-auto"],[1,"flex-1","px-4","py-6","space-y-1"],[1,"px-4","py-6","border-t","border-gray-200"],[1,"text-xs","text-center","text-gray-500"],["routerLinkActive","bg-indigo-50 text-indigo-600",1,"flex","items-center","px-4","py-2.5","text-gray-600","transition-colors","duration-200","transform","rounded-lg","hover:bg-gray-100","hover:text-gray-800",3,"routerLink","routerLinkActiveOptions"],[1,"w-full","flex","items-center","justify-between","px-4","py-2.5","text-gray-600","transition-colors","duration-200","transform","rounded-lg","hover:bg-gray-100","hover:text-gray-800",3,"click"],[1,"flex","items-center"],[1,"text-xl",3,"name"],[1,"mx-4","font-medium"],["name","chevron-down-outline",1,"text-sm","transition-transform","duration-300"],[1,"mt-1","ml-4","pl-2","space-y-1","border-l","border-gray-200"],["routerLinkActive","bg-indigo-50 text-indigo-600 font-semibold",1,"flex","items-center","w-full","px-4","py-2","text-sm","text-gray-600","transition-colors","duration-200","transform","rounded-lg","hover:bg-gray-100","hover:text-gray-800",3,"routerLink","routerLinkActiveOptions"],[1,"text-lg",3,"name"],[1,"mx-4","font-normal"]],template:function(t,i){t&1&&(l(0,"aside",0)(1,"div",1)(2,"div",2),x(3,"ion-icon",3),l(4,"h1",4),m(5,"\u8CA1\u52D9 AI"),u()()(),l(6,"div",5)(7,"nav",6),O(8,wR,2,1,null,null,CR),u()(),l(10,"div",7)(11,"p",8),m(12,"\xA9 2024 \u5167\u90E8\u7CFB\u7D71"),u()()()),t&2&&(h(8),V(i.navLinks()))},dependencies:[gr,Dh],encapsulation:2,changeDetection:0});var Gd=fs;function TR(n,e){if(n&1&&(Xe(0,"div",1)(1,"div",2)(2,"p",3),m(3),et(),Xe(4,"p",4),m(5),et()(),Xe(6,"div",5),Ui(7,"ion-icon",6),et()()),n&2){let t=e,i=C();h(3),E(t.name),h(),De(i.getRoleClass((t.roles[0]==null?null:t.roles[0].role_name)||"")),h(),L(" ",(t.roles[0]==null?null:t.roles[0].display_name)||"User"," ")}}var ms=class ms{constructor(){this.authService=R(nt)}getRoleClass(e){switch(e){case"super_admin":return"bg-red-100 text-red-800";case"user_manager":return"bg-blue-100 text-blue-800";case"finance_manager":return"bg-green-100 text-green-800";case"operation_manager":return"bg-yellow-100 text-yellow-800";case"viewer":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}}};ms.\u0275fac=function(t){return new(t||ms)},ms.\u0275cmp=ee({type:ms,selectors:[["app-header"]],decls:2,vars:1,consts:[[1,"h-16","flex-shrink-0","bg-white","border-b","border-gray-200","flex","items-center","justify-end","px-6"],[1,"flex","items-center","gap-4"],[1,"text-right"],[1,"text-sm","font-semibold","text-gray-800"],[1,"text-xs","font-medium","px-2","py-0.5","rounded-full","inline-block"],[1,"flex","items-center","gap-2"],["name","person-circle-outline",1,"text-3xl","text-gray-500"]],template:function(t,i){if(t&1&&(Xe(0,"header",0),P(1,TR,8,4,"div",1),et()),t&2){let r;h(),F((r=i.authService.currentAdmin())?1:-1,r)}},dependencies:[oe],encapsulation:2,changeDetection:0});var qd=ms;function IR(n,e){n&1&&(l(0,"div",0),x(1,"app-sidebar"),l(2,"div",1),x(3,"app-header"),l(4,"main",2)(5,"div",3),x(6,"router-outlet"),u()()()())}function MR(n,e){n&1&&x(0,"router-outlet")}var ps=class ps{constructor(){this.authService=R(nt)}};ps.\u0275fac=function(t){return new(t||ps)},ps.\u0275cmp=ee({type:ps,selectors:[["app-root"]],decls:2,vars:1,consts:[[1,"flex","h-screen","bg-gray-100"],[1,"flex-1","flex","flex-col","overflow-hidden"],[1,"flex-1","overflow-x-hidden","overflow-y-auto","bg-gray-50"],[1,"container","mx-auto","px-6","py-8"]],template:function(t,i){t&1&&P(0,IR,7,0,"div",0)(1,MR,1,0,"router-outlet"),t&2&&F(i.authService.isAuthenticated()?0:1)},dependencies:[El,Gd,qd,oe],encapsulation:2,changeDetection:0});var Wd=ps;var t2=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,i){this._renderer=t,this._elementRef=i}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(i){return new(i||n)(J(Jn),J(Zt))};static \u0275dir=Ie({type:n})}return n})(),Rl=(()=>{class n extends t2{static \u0275fac=(()=>{let t;return function(r){return(t||(t=Qt(n)))(r||n)}})();static \u0275dir=Ie({type:n,features:[dt]})}return n})(),so=new Z(""),AR={provide:so,useExisting:bt(()=>Pl),multi:!0},Pl=(()=>{class n extends Rl{writeValue(t){this.setProperty("checked",t)}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Qt(n)))(r||n)}})();static \u0275dir=Ie({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(i,r){i&1&&S("change",function(s){return r.onChange(s.target.checked)})("blur",function(){return r.onTouched()})},standalone:!1,features:[Bt([AR]),dt]})}return n})(),NR={provide:so,useExisting:bt(()=>xe),multi:!0};function RR(){let n=Vn()?Vn().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var PR=new Z(""),xe=(()=>{class n extends t2{_compositionMode;_composing=!1;constructor(t,i,r){super(t,i),this._compositionMode=r,this._compositionMode==null&&(this._compositionMode=!RR())}writeValue(t){let i=t??"";this.setProperty("value",i)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(i){return new(i||n)(J(Jn),J(Zt),J(PR,8))};static \u0275dir=Ie({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){i&1&&S("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},standalone:!1,features:[Bt([NR]),dt]})}return n})();function Ph(n){return n==null||Fh(n)===0}function Fh(n){return n==null?null:Array.isArray(n)||typeof n=="string"?n.length:n instanceof Set?n.size:null}var xi=new Z(""),_s=new Z(""),FR=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,$=class{static min(e){return n2(e)}static max(e){return kR(e)}static required(e){return i2(e)}static requiredTrue(e){return OR(e)}static email(e){return VR(e)}static minLength(e){return LR(e)}static maxLength(e){return r2(e)}static pattern(e){return o2(e)}static nullValidator(e){return zd()}static compose(e){return d2(e)}static composeAsync(e){return f2(e)}};function n2(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function kR(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function i2(n){return Ph(n.value)?{required:!0}:null}function OR(n){return n.value===!0?null:{required:!0}}function VR(n){return Ph(n.value)||FR.test(n.value)?null:{email:!0}}function LR(n){return e=>{let t=e.value?.length??Fh(e.value);return t===null||t===0?null:t<n?{minlength:{requiredLength:n,actualLength:t}}:null}}function r2(n){return e=>{let t=e.value?.length??Fh(e.value);return t!==null&&t>n?{maxlength:{requiredLength:n,actualLength:t}}:null}}function o2(n){if(!n)return zd;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),i=>{if(Ph(i.value))return null;let r=i.value;return e.test(r)?null:{pattern:{requiredPattern:t,actualValue:r}}}}function zd(n){return null}function s2(n){return n!=null}function a2(n){return cr(n)?it(n):n}function l2(n){let e={};return n.forEach(t=>{e=t!=null?k(k({},e),t):e}),Object.keys(e).length===0?null:e}function u2(n,e){return e.map(t=>t(n))}function BR(n){return!n.validate}function c2(n){return n.map(e=>BR(e)?e:t=>e.validate(t))}function d2(n){if(!n)return null;let e=n.filter(s2);return e.length==0?null:function(t){return l2(u2(t,e))}}function kh(n){return n!=null?d2(c2(n)):null}function f2(n){if(!n)return null;let e=n.filter(s2);return e.length==0?null:function(t){let i=u2(t,e).map(a2);return Um(i).pipe(pe(l2))}}function Oh(n){return n!=null?f2(c2(n)):null}function jE(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function m2(n){return n._rawValidators}function p2(n){return n._rawAsyncValidators}function Ah(n){return n?Array.isArray(n)?n:[n]:[]}function Yd(n,e){return Array.isArray(n)?n.includes(e):n===e}function zE(n,e){let t=Ah(e);return Ah(n).forEach(r=>{Yd(t,r)||t.push(r)}),t}function YE(n,e){return Ah(e).filter(t=>!Yd(n,t))}var Jd=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=kh(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Oh(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},sn=class extends Jd{name;get formDirective(){return null}get path(){return null}},oo=class extends Jd{_parent=null;name=null;valueAccessor=null},Kd=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},UR={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},nre=q(k({},UR),{"[class.ng-submitted]":"isSubmitted"}),ge=(()=>{class n extends Kd{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(J(oo,2))};static \u0275dir=Ie({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){i&2&&Q("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},standalone:!1,features:[dt]})}return n})(),Be=(()=>{class n extends Kd{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(J(sn,10))};static \u0275dir=Ie({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,r){i&2&&Q("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},standalone:!1,features:[dt]})}return n})();var Dl="VALID",jd="INVALID",gs="PENDING",wl="DISABLED",hr=class{},Qd=class extends hr{value;source;constructor(e,t){super(),this.value=e,this.source=t}},Il=class extends hr{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},Ml=class extends hr{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},hs=class extends hr{status;source;constructor(e,t){super(),this.status=e,this.source=t}},Zd=class extends hr{source;constructor(e){super(),this.source=e}},Nl=class extends hr{source;constructor(e){super(),this.source=e}};function Vh(n){return(nf(n)?n.validators:n)||null}function $R(n){return Array.isArray(n)?kh(n):n||null}function Lh(n,e){return(nf(e)?e.asyncValidators:n)||null}function HR(n){return Array.isArray(n)?Oh(n):n||null}function nf(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function g2(n,e,t){let i=n.controls;if(!(e?Object.keys(i):i).length)throw new j(1e3,"");if(!i[t])throw new j(1001,"")}function h2(n,e,t){n._forEachChild((i,r)=>{if(t[r]===void 0)throw new j(1002,"")})}var ys=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return Rt(this.statusReactive)}set status(e){Rt(()=>this.statusReactive.set(e))}_status=H(()=>this.statusReactive());statusReactive=D(void 0);get valid(){return this.status===Dl}get invalid(){return this.status===jd}get pending(){return this.status==gs}get disabled(){return this.status===wl}get enabled(){return this.status!==wl}errors;get pristine(){return Rt(this.pristineReactive)}set pristine(e){Rt(()=>this.pristineReactive.set(e))}_pristine=H(()=>this.pristineReactive());pristineReactive=D(!0);get dirty(){return!this.pristine}get touched(){return Rt(this.touchedReactive)}set touched(e){Rt(()=>this.touchedReactive.set(e))}_touched=H(()=>this.touchedReactive());touchedReactive=D(!1);get untouched(){return!this.touched}_events=new pt;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(zE(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(zE(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(YE(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(YE(e,this._rawAsyncValidators))}hasValidator(e){return Yd(this._rawValidators,e)}hasAsyncValidator(e){return Yd(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(q(k({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new Ml(!0,i))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:i})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,i),t&&e.emitEvent!==!1&&this._events.next(new Ml(!1,i))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(q(k({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new Il(!1,i))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,i),t&&e.emitEvent!==!1&&this._events.next(new Il(!0,i))}markAsPending(e={}){this.status=gs;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new hs(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(q(k({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=wl,this.errors=null,this._forEachChild(r=>{r.disable(q(k({},e),{onlySelf:!0}))}),this._updateValue();let i=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Qd(this.value,i)),this._events.next(new hs(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(q(k({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Dl,this._forEachChild(i=>{i.enable(q(k({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(q(k({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Dl||this.status===gs)&&this._runAsyncValidator(i,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Qd(this.value,t)),this._events.next(new hs(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(q(k({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?wl:Dl}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=gs,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:e!==!1};let i=a2(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){let i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,i){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||i)&&this._events.next(new hs(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,i)}_initObservables(){this.valueChanges=new ot,this.statusChanges=new ot}_calculateStatus(){return this._allControlsDisabled()?wl:this.errors?jd:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(gs)?gs:this._anyControlsHaveStatus(jd)?jd:Dl}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let i=!this._anyControlsDirty(),r=this.pristine!==i;this.pristine=i,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),r&&this._events.next(new Il(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new Ml(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){nf(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=$R(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=HR(this._rawAsyncValidators)}},vs=class extends ys{constructor(e,t,i){super(Vh(t),Lh(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,i={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){h2(this,!0,e),Object.keys(e).forEach(i=>{g2(this,!0,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(i=>{let r=this.controls[i];r&&r.patchValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((i,r)=>{i.reset(e?e[r]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new Nl(this))}getRawValue(){return this._reduceChildren({},(e,t,i)=>(e[i]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,i)=>i._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let i=this.controls[t];i&&e(i,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,i]of Object.entries(this.controls))if(this.contains(t)&&e(i))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,i,r)=>((i.enabled||this.disabled)&&(t[r]=i.value),t))}_reduceChildren(e,t){let i=e;return this._forEachChild((r,o)=>{i=t(i,r,o)}),i}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var Nh=class extends vs{};var Fl=new Z("",{providedIn:"root",factory:()=>rf}),rf="always";function of(n,e){return[...e.path,n]}function Xd(n,e,t=rf){Bh(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),qR(n,e),jR(n,e),WR(n,e),GR(n,e)}function JE(n,e,t=!0){let i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),tf(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function ef(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function GR(n,e){if(e.valueAccessor.setDisabledState){let t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function Bh(n,e){let t=m2(n);e.validator!==null?n.setValidators(jE(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let i=p2(n);e.asyncValidator!==null?n.setAsyncValidators(jE(i,e.asyncValidator)):typeof i=="function"&&n.setAsyncValidators([i]);let r=()=>n.updateValueAndValidity();ef(e._rawValidators,r),ef(e._rawAsyncValidators,r)}function tf(n,e){let t=!1;if(n!==null){if(e.validator!==null){let r=m2(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(s=>s!==e.validator);o.length!==r.length&&(t=!0,n.setValidators(o))}}if(e.asyncValidator!==null){let r=p2(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(s=>s!==e.asyncValidator);o.length!==r.length&&(t=!0,n.setAsyncValidators(o))}}}let i=()=>{};return ef(e._rawValidators,i),ef(e._rawAsyncValidators,i),t}function qR(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&y2(n,e)})}function WR(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&y2(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function y2(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function jR(n,e){let t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function v2(n,e){n==null,Bh(n,e)}function zR(n,e){return tf(n,e)}function _2(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function YR(n){return Object.getPrototypeOf(n.constructor)===Rl}function C2(n,e){n._syncPendingControls(),e.forEach(t=>{let i=t.control;i.updateOn==="submit"&&i._pendingChange&&(t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}function x2(n,e){if(!e)return null;Array.isArray(e);let t,i,r;return e.forEach(o=>{o.constructor===xe?t=o:YR(o)?i=o:r=o}),r||i||t||null}function JR(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}var KR={provide:sn,useExisting:bt(()=>kl)},Tl=Promise.resolve(),kl=(()=>{class n extends sn{callSetDisabledState;get submitted(){return Rt(this.submittedReactive)}_submitted=H(()=>this.submittedReactive());submittedReactive=D(!1);_directives=new Set;form;ngSubmit=new ot;options;constructor(t,i,r){super(),this.callSetDisabledState=r,this.form=new vs({},kh(t),Oh(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){Tl.then(()=>{let i=this._findContainer(t.path);t.control=i.registerControl(t.name,t.control),Xd(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){Tl.then(()=>{let i=this._findContainer(t.path);i&&i.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){Tl.then(()=>{let i=this._findContainer(t.path),r=new vs({});v2(r,t),i.registerControl(t.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){Tl.then(()=>{let i=this._findContainer(t.path);i&&i.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,i){Tl.then(()=>{this.form.get(t.path).setValue(i)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submittedReactive.set(!0),C2(this.form,this._directives),this.ngSubmit.emit(t),this.form._events.next(new Zd(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static \u0275fac=function(i){return new(i||n)(J(xi,10),J(_s,10),J(Fl,8))};static \u0275dir=Ie({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,r){i&1&&S("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Bt([KR]),dt]})}return n})();function KE(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function QE(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var Al=class extends ys{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,i){super(Vh(t),Lh(i,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),nf(t)&&(t.nonNullable||t.initialValueIsDefault)&&(QE(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1,t?.emitEvent!==!1&&this._events.next(new Nl(this))}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){KE(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){KE(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){QE(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var QR=n=>n instanceof Al,ZR=(()=>{class n extends sn{_parent;ngOnInit(){this._checkParentType(),this.formDirective.addFormGroup(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormGroup(this)}get control(){return this.formDirective.getFormGroup(this)}get path(){return of(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Qt(n)))(r||n)}})();static \u0275dir=Ie({type:n,standalone:!1,features:[dt]})}return n})();var XR={provide:oo,useExisting:bt(()=>we)},ZE=Promise.resolve(),we=(()=>{class n extends oo{_changeDetectorRef;callSetDisabledState;control=new Al;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new ot;constructor(t,i,r,o,s,a){super(),this._changeDetectorRef=s,this.callSetDisabledState=a,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=x2(this,o)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),_2(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Xd(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){ZE.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let i=t.isDisabled.currentValue,r=i!==0&&Yr(i);ZE.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?of(t,this._parent):[t]}static \u0275fac=function(i){return new(i||n)(J(sn,9),J(xi,10),J(_s,10),J(so,10),J(dr,8),J(Fl,8))};static \u0275dir=Ie({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Bt([XR]),dt,kn]})}return n})();var je=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275dir=Ie({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})(),e5={provide:so,useExisting:bt(()=>$t),multi:!0},$t=(()=>{class n extends Rl{writeValue(t){let i=t??"";this.setProperty("value",i)}registerOnChange(t){this.onChange=i=>{t(i==""?null:parseFloat(i))}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Qt(n)))(r||n)}})();static \u0275dir=Ie({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,r){i&1&&S("input",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},standalone:!1,features:[Bt([e5]),dt]})}return n})();var E2=new Z("");var t5={provide:sn,useExisting:bt(()=>Ue)},Ue=(()=>{class n extends sn{callSetDisabledState;get submitted(){return Rt(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}_submitted=H(()=>this._submittedReactive());_submittedReactive=D(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];form=null;ngSubmit=new ot;constructor(t,i,r){super(),this.callSetDisabledState=r,this._setValidators(t),this._setAsyncValidators(i)}ngOnChanges(t){t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(tf(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){let i=this.form.get(t.path);return Xd(i,t,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),i}getControl(t){return this.form.get(t.path)}removeControl(t){JE(t.control||null,t,!1),JR(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,i){this.form.get(t.path).setValue(i)}onSubmit(t){return this._submittedReactive.set(!0),C2(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new Zd(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0,i={}){this.form.reset(t,i),this._submittedReactive.set(!1)}_updateDomValue(){this.directives.forEach(t=>{let i=t.control,r=this.form.get(t.path);i!==r&&(JE(i||null,t),QR(r)&&(Xd(r,t,this.callSetDisabledState),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let i=this.form.get(t.path);v2(i,t),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let i=this.form.get(t.path);i&&zR(i,t)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Bh(this.form,this),this._oldForm&&tf(this._oldForm,this)}static \u0275fac=function(i){return new(i||n)(J(xi,10),J(_s,10),J(Fl,8))};static \u0275dir=Ie({type:n,selectors:[["","formGroup",""]],hostBindings:function(i,r){i&1&&S("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Bt([t5]),dt,kn]})}return n})(),n5={provide:sn,useExisting:bt(()=>Ei)},Ei=(()=>{class n extends ZR{name=null;constructor(t,i,r){super(),this._parent=t,this._setValidators(i),this._setAsyncValidators(r)}_checkParentType(){b2(this._parent)}static \u0275fac=function(i){return new(i||n)(J(sn,13),J(xi,10),J(_s,10))};static \u0275dir=Ie({type:n,selectors:[["","formGroupName",""]],inputs:{name:[0,"formGroupName","name"]},standalone:!1,features:[Bt([n5]),dt]})}return n})(),i5={provide:sn,useExisting:bt(()=>bi)},bi=(()=>{class n extends sn{_parent;name=null;constructor(t,i,r){super(),this._parent=t,this._setValidators(i),this._setAsyncValidators(r)}ngOnInit(){b2(this._parent),this.formDirective.addFormArray(this)}ngOnDestroy(){this.formDirective?.removeFormArray(this)}get control(){return this.formDirective.getFormArray(this)}get formDirective(){return this._parent?this._parent.formDirective:null}get path(){return of(this.name==null?this.name:this.name.toString(),this._parent)}static \u0275fac=function(i){return new(i||n)(J(sn,13),J(xi,10),J(_s,10))};static \u0275dir=Ie({type:n,selectors:[["","formArrayName",""]],inputs:{name:[0,"formArrayName","name"]},standalone:!1,features:[Bt([i5]),dt]})}return n})();function b2(n){return!(n instanceof Ei)&&!(n instanceof Ue)&&!(n instanceof bi)}var r5={provide:oo,useExisting:bt(()=>qe)},qe=(()=>{class n extends oo{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(t){}model;update=new ot;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(t,i,r,o,s){super(),this._ngModelWarningConfig=s,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=x2(this,o)}ngOnChanges(t){this._added||this._setUpControl(),_2(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return of(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(i){return new(i||n)(J(sn,13),J(xi,10),J(_s,10),J(so,10),J(E2,8))};static \u0275dir=Ie({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Bt([r5]),dt,kn]})}return n})();var o5={provide:so,useExisting:bt(()=>Ae),multi:!0};function S2(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function s5(n){return n.split(":")[0]}var Ae=(()=>{class n extends Rl{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;appRefInjector=R(Bi).injector;destroyRef=R(Pn);cdr=R(dr);_queuedWrite=!1;_writeValueAfterRender(){this._queuedWrite||this.appRefInjector.destroyed||(this._queuedWrite=!0,Vi({write:()=>{this.destroyRef.destroyed||(this._queuedWrite=!1,this.writeValue(this.value))}},{injector:this.appRefInjector}))}writeValue(t){this.cdr.markForCheck(),this.value=t;let i=this._getOptionId(t),r=S2(i,t);this.setProperty("value",r)}registerOnChange(t){this.onChange=i=>{this.value=this._getOptionValue(i),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),t))return i;return null}_getOptionValue(t){let i=s5(t);return this._optionMap.has(i)?this._optionMap.get(i):t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Qt(n)))(r||n)}})();static \u0275dir=Ie({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,r){i&1&&S("change",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Bt([o5]),dt]})}return n})(),Fe=(()=>{class n{_element;_renderer;_select;id;constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(S2(this.id,t)),this._select._writeValueAfterRender())}set value(t){this._setElementValue(t),this._select&&this._select._writeValueAfterRender()}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select._writeValueAfterRender())}static \u0275fac=function(i){return new(i||n)(J(Zt),J(Jn),J(Ae,9))};static \u0275dir=Ie({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})(),a5={provide:so,useExisting:bt(()=>D2),multi:!0};function XE(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function l5(n){return n.split(":")[0]}var D2=(()=>{class n extends Rl{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let i;if(Array.isArray(t)){let r=t.map(o=>this._getOptionId(o));i=(o,s)=>{o._setSelected(r.indexOf(s.toString())>-1)}}else i=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(t){this.onChange=i=>{let r=[],o=i.selectedOptions;if(o!==void 0){let s=o;for(let a=0;a<s.length;a++){let c=s[a],d=this._getOptionValue(c.value);r.push(d)}}else{let s=i.options;for(let a=0;a<s.length;a++){let c=s[a];if(c.selected){let d=this._getOptionValue(c.value);r.push(d)}}}this.value=r,t(r)}}_registerOption(t){let i=(this._idCounter++).toString();return this._optionMap.set(i,t),i}_getOptionId(t){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,t))return i;return null}_getOptionValue(t){let i=l5(t);return this._optionMap.has(i)?this._optionMap.get(i)._value:t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Qt(n)))(r||n)}})();static \u0275dir=Ie({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,r){i&1&&S("change",function(s){return r.onChange(s.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Bt([a5]),dt]})}return n})(),ke=(()=>{class n{_element;_renderer;_select;id;_value;constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(XE(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(XE(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(i){return new(i||n)(J(Zt),J(Jn),J(D2,9))};static \u0275dir=Ie({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})();function u5(n){return typeof n=="number"?n:parseInt(n,10)}function c5(n){return typeof n=="number"?n:parseFloat(n)}var sf=(()=>{class n{_validator=zd;_onChange;_enabled;ngOnChanges(t){if(this.inputName in t){let i=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):zd,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static \u0275fac=function(i){return new(i||n)};static \u0275dir=Ie({type:n,features:[kn]})}return n})();var d5={provide:xi,useExisting:bt(()=>Uh),multi:!0},Uh=(()=>{class n extends sf{min;inputName="min";normalizeInput=t=>c5(t);createValidator=t=>n2(t);static \u0275fac=(()=>{let t;return function(r){return(t||(t=Qt(n)))(r||n)}})();static \u0275dir=Ie({type:n,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(i,r){i&2&&ft("min",r._enabled?r.min:null)},inputs:{min:"min"},standalone:!1,features:[Bt([d5]),dt]})}return n})(),f5={provide:xi,useExisting:bt(()=>$h),multi:!0};var $h=(()=>{class n extends sf{required;inputName="required";normalizeInput=Yr;createValidator=t=>i2;enabled(t){return t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Qt(n)))(r||n)}})();static \u0275dir=Ie({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,r){i&2&&ft("required",r._enabled?"":null)},inputs:{required:"required"},standalone:!1,features:[Bt([f5]),dt]})}return n})();var m5={provide:xi,useExisting:bt(()=>Ol),multi:!0},Ol=(()=>{class n extends sf{maxlength;inputName="maxlength";normalizeInput=t=>u5(t);createValidator=t=>r2(t);static \u0275fac=(()=>{let t;return function(r){return(t||(t=Qt(n)))(r||n)}})();static \u0275dir=Ie({type:n,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(i,r){i&2&&ft("maxlength",r._enabled?r.maxlength:null)},inputs:{maxlength:"maxlength"},standalone:!1,features:[Bt([m5]),dt]})}return n})(),p5={provide:xi,useExisting:bt(()=>Vl),multi:!0},Vl=(()=>{class n extends sf{pattern;inputName="pattern";normalizeInput=t=>t;createValidator=t=>o2(t);static \u0275fac=(()=>{let t;return function(r){return(t||(t=Qt(n)))(r||n)}})();static \u0275dir=Ie({type:n,selectors:[["","pattern","","formControlName",""],["","pattern","","formControl",""],["","pattern","","ngModel",""]],hostVars:1,hostBindings:function(i,r){i&2&&ft("pattern",r._enabled?r.pattern:null)},inputs:{pattern:"pattern"},standalone:!1,features:[Bt([p5]),dt]})}return n})();var w2=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Kn({type:n});static \u0275inj=Tn({})}return n})(),Rh=class extends ys{constructor(e,t,i){super(Vh(t),Lh(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){Array.isArray(e)?e.forEach(i=>{this.controls.push(i),this._registerControl(i)}):(this.controls.push(e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,i={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(e,t={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,i={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),t&&(this.controls.splice(r,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){h2(this,!1,e),e.forEach((i,r)=>{g2(this,!1,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((i,r)=>{i.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new Nl(this))}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,i)=>i._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,i)=>{e(t,i)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function e2(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var ze=(()=>{class n{useNonNullable=!1;get nonNullable(){let t=new n;return t.useNonNullable=!0,t}group(t,i=null){let r=this._reduceControls(t),o={};return e2(i)?o=i:i!==null&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new vs(r,o)}record(t,i=null){let r=this._reduceControls(t);return new Nh(r,i)}control(t,i,r){let o={};return this.useNonNullable?(e2(i)?o=i:(o.validators=i,o.asyncValidators=r),new Al(t,q(k({},o),{nonNullable:!0}))):new Al(t,i,r)}array(t,i,r){let o=t.map(s=>this._createControl(s));return new Rh(o,i,r)}_reduceControls(t){let i={};return Object.keys(t).forEach(r=>{i[r]=this._createControl(t[r])}),i}_createControl(t){if(t instanceof Al)return t;if(t instanceof ys)return t;if(Array.isArray(t)){let i=t[0],r=t.length>1?t[1]:null,o=t.length>2?t[2]:null;return this.control(i,r,o)}else return this.control(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Ee=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Fl,useValue:t.callSetDisabledState??rf}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=Kn({type:n});static \u0275inj=Tn({imports:[w2]})}return n})(),$e=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:E2,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:Fl,useValue:t.callSetDisabledState??rf}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=Kn({type:n});static \u0275inj=Tn({imports:[w2]})}return n})();var T2={production:!1,apiUrl:"http://localhost:3000/api"};var ao=class ao{constructor(e){this.http=e;this.baseUrl=T2.apiUrl}getLedgerEntries(e){let t=new Je;return e&&Object.entries(e).forEach(([i,r])=>{r!=null&&r!==""&&(t=t.set(i,r.toString()))}),Pe(this.http.get(`${this.baseUrl}/ledger`,{params:t}))}createLedgerEntry(e){return Pe(this.http.post(`${this.baseUrl}/ledger`,e))}updateLedgerEntry(e){return Pe(this.http.put(`${this.baseUrl}/ledger`,e))}deleteLedgerEntry(e){let t=new Je().set("id",e.toString());return Pe(this.http.delete(`${this.baseUrl}/ledger`,{params:t}))}getVendors(){return Pe(this.http.get(`${this.baseUrl}/vendors`))}updateVendor(e){return Pe(this.http.put(`${this.baseUrl}/vendors`,e))}deleteVendor(e){let t=new Je().set("id",e.toString());return Pe(this.http.delete(`${this.baseUrl}/vendors`,{params:t}))}getGLAccounts(e){let t=new Je;return e&&Object.entries(e).forEach(([i,r])=>{r!=null&&(t=t.set(i,r.toString()))}),Pe(this.http.get(`${this.baseUrl}/gl-accounts`,{params:t}))}async getAnnualSummary(e,t){let i=new Je().set("type","summary").set("startYear",e.toString()).set("endYear",t.toString()),r=await Pe(this.http.get(`${this.baseUrl}/financial-statements`,{params:i}));return r.success&&r.data&&(r.data=this.normalizeAnnualSummary(r.data)),r}getIncomeStatement(e,t){let i=new Je().set("type","income").set("year",e.toString()).set("quarter",t.toString());return Pe(this.http.get(`${this.baseUrl}/financial-statements`,{params:i}))}getBalanceSheet(e,t){let i=new Je().set("type","balance").set("year",e.toString()).set("quarter",t.toString());return Pe(this.http.get(`${this.baseUrl}/financial-statements`,{params:i}))}async getFinancialStatementsDetails(e,t){let i=new Je().set("year",e.toString()).set("type",t),r=await Pe(this.http.get(`${this.baseUrl}/financial-statements/details`,{params:i}));return r.success&&r.data&&(r.data=this.normalizeMonthlyDetail(r.data)),r}parseNumeric(e){if(e==null)return 0;let t=typeof e=="string"?parseFloat(e):e;return isNaN(t)?0:t}convertYearTotalsToNumbers(e){let t={};return Object.entries(e).forEach(([i,r])=>{if(i==="total")t.total=this.parseNumeric(r);else{let o=parseInt(i);isNaN(o)||(t[o]=this.parseNumeric(r))}}),t}normalizeAnnualSummary(e){return{years:e.years||[],revenue:this.convertYearTotalsToNumbers(e.revenue||{total:0}),expense:this.convertYearTotalsToNumbers(e.expense||{total:0}),net:this.convertYearTotalsToNumbers(e.net||{total:0}),unpaid:this.convertYearTotalsToNumbers(e.unpaid||{total:0})}}normalizeMonthlyDetail(e){let t=(e.data||[]).map(i=>({month:i.month,total:this.parseNumeric(i.total),items:(i.items||[]).map(r=>({name:r.name,amount:this.parseNumeric(r.amount)}))}));return{year:e.year,type:e.type,data:t}}createCustomer(e){return Pe(this.http.post(`${this.baseUrl}/customers`,e))}updateCustomer(e){return Pe(this.http.put(`${this.baseUrl}/customers`,e))}deleteCustomer(e){let t=new Je().set("id",e);return Pe(this.http.delete(`${this.baseUrl}/customers`,{params:t}))}getDailyRevenue(e){let t=new Je().set("date",e);return Pe(this.http.get(`${this.baseUrl}/daily-revenue`,{params:t}))}getMonthlyRevenue(e,t){let i=new Je().set("year",e.toString()).set("month",t.toString());return Pe(this.http.get(`${this.baseUrl}/daily-revenue`,{params:i}))}getCustomers(e){let t=new Je;return e?.search&&(t=t.set("search",e.search)),e?.limit&&(t=t.set("limit",e.limit.toString())),e?.offset&&(t=t.set("offset",e.offset.toString())),Pe(this.http.get(`${this.baseUrl}/customers`,{params:t}))}getProductSales(e){let t=new Je().set("startMonth",e.startMonth).set("endMonth",e.endMonth);return e.category&&(t=t.set("category",e.category)),e.limit&&(t=t.set("limit",e.limit.toString())),e.offset&&(t=t.set("offset",e.offset.toString())),Pe(this.http.get(`${this.baseUrl}/product-sales`,{params:t}))}getPurchaseCosts(e){let t=new Je().set("startMonth",e.startMonth).set("endMonth",e.endMonth);return Pe(this.http.get(`${this.baseUrl}/purchase-costs`,{params:t}))}getShipmentItems(e){let t=new Je;return e?.startDate&&(t=t.set("startDate",e.startDate)),e?.endDate&&(t=t.set("endDate",e.endDate)),e?.vendorId&&(t=t.set("vendorId",e.vendorId.toString())),e?.documentNo&&(t=t.set("documentNo",e.documentNo)),e?.itemName&&(t=t.set("itemName",e.itemName)),e?.limit&&(t=t.set("limit",e.limit.toString())),e?.offset&&(t=t.set("offset",e.offset.toString())),Pe(this.http.get(`${this.baseUrl}/shipment-items`,{params:t}))}updateShipmentItem(e,t){let i=k({shipmentId:e},t);return Pe(this.http.put(`${this.baseUrl}/shipment-items`,i))}getMonthlyTargets(e){let t=new Je;return e?.startMonth&&(t=t.set("startMonth",e.startMonth)),e?.endMonth&&(t=t.set("endMonth",e.endMonth)),Pe(this.http.get(`${this.baseUrl}/monthly-targets`,{params:t}))}createMonthlyTarget(e){return Pe(this.http.post(`${this.baseUrl}/monthly-targets`,e))}updateMonthlyTarget(e){return Pe(this.http.put(`${this.baseUrl}/monthly-targets`,e))}deleteMonthlyTarget(e){let t=new Je().set("targetId",e.toString());return Pe(this.http.delete(`${this.baseUrl}/monthly-targets`,{params:t}))}};ao.\u0275fac=function(t){return new(t||ao)(ie(zt))},ao.\u0275prov=Y({token:ao,factory:ao.\u0275fac,providedIn:"root"});var wt=ao;var g5=["monthlyChart"],h5=["purchaseChart"],Cs=()=>({style:"currency",currency:"TWD",minimumFractionDigits:0});function y5(n,e){if(n&1&&(l(0,"div",16)(1,"div",23)(2,"div",24),x(3,"ion-icon",25),u(),l(4,"div")(5,"p",26),m(6,"\u6536\u5165"),u(),l(7,"p",27),m(8),u()()(),l(9,"div",23)(10,"div",28),x(11,"ion-icon",29),u(),l(12,"div")(13,"p",26),m(14,"\u5E73\u5747\u6BCF\u65E5\u6536\u5165"),u(),l(15,"p",27),m(16),u()()(),l(17,"div",23)(18,"div",30),x(19,"ion-icon",31),u(),l(20,"div")(21,"p",26),m(22,"\u8CBB\u7528"),u(),l(23,"p",27),m(24),u()()(),l(25,"div",23)(26,"div",32),x(27,"ion-icon",33),u(),l(28,"div")(29,"p",26),m(30,"\u6298\u8B93"),u(),l(31,"p",27),m(32),u()()(),l(33,"div",23)(34,"div",34),x(35,"ion-icon",35),u(),l(36,"div")(37,"p",26),m(38,"\u9032\u8CA8"),u(),l(39,"p",27),m(40),u()()(),l(41,"div",23)(42,"div",36),x(43,"ion-icon",37),u(),l(44,"div")(45,"p",26),m(46,"\u6BDB\u5229"),u(),l(47,"p",27),m(48),u()()()()),n&2){let t=e,i=C();h(8),E(t.revenue.toLocaleString("zh-TW",fn(6,Cs))),h(8),E(i.averageDailyRevenue().toLocaleString("zh-TW",fn(7,Cs))),h(8),E(t.expenses.toLocaleString("zh-TW",fn(8,Cs))),h(8),E(t.allowance.toLocaleString("zh-TW",fn(9,Cs))),h(8),E(t.purchases.toLocaleString("zh-TW",fn(10,Cs))),h(8),E(i.grossProfit().toLocaleString("zh-TW",fn(11,Cs)))}}function v5(n,e){n&1&&(l(0,"div",17),m(1,"\u5728\u6B64\u65E5\u671F\u7BC4\u570D\u5167\u6C92\u6709\u6578\u64DA\u3002"),u())}var xs=class xs{constructor(){this.apiService=R(wt);this.formatDate=e=>e.toISOString().split("T")[0];this.today=new Date;this.firstDayOfMonth=new Date(this.today.getFullYear(),this.today.getMonth(),1);this.startDate=D(this.formatDate(this.firstDayOfMonth));this.endDate=D(this.formatDate(this.today));this.filterStartDate=this.formatDate(this.firstDayOfMonth);this.filterEndDate=this.formatDate(this.today);this.dashboardData=D(null);this.monthlyPerformance=D([]);this.isLoading=D(!1);this.errorMessage=D(null);this.averageDailyRevenue=H(()=>{let e=this.dashboardData();if(!e||!this.startDate()||!this.endDate())return 0;let t=new Date(this.startDate()),i=new Date(this.endDate());if(isNaN(t.getTime())||isNaN(i.getTime())||t>i)return 0;let r=i.getTime()-t.getTime(),o=Math.round(r/(1e3*60*60*24))+1;return o<=0?e.revenue:e.revenue/o});this.grossProfit=H(()=>{let e=this.dashboardData();return e?e.revenue-e.purchases-e.allowance-e.expenses:0});this.purchaseChartData=H(()=>{let e=this.dashboardData();return e?[{category:"\u9152\u6C34",amount:e.beveragePurchase},{category:"\u9910\u98F2",amount:e.foodPurchase},{category:"\u96EA\u8304(\u542B\u61C9\u4ED8)",amount:e.cigarPurchase}]:[]});this.loadData(this.startDate(),this.endDate()),zr(()=>{let e=this.monthlyPerformance(),t=this.purchaseChartData();this.monthlyChart&&this.purchaseChart&&this.updateCharts(e,t)}),Vi(()=>{this.createCharts()})}async loadData(e,t){this.isLoading.set(!0),this.errorMessage.set(null);try{let i=e||this.startDate(),r=t||this.endDate(),[o,s]=await Promise.all([this.apiService.getLedgerEntries({startDate:i,endDate:r,limit:1e4}),this.apiService.getLedgerEntries({startDate:this.calculateMonthsBack(12),endDate:r,limit:1e4})]);o.success&&o.data&&this.dashboardData.set(this.calculateDashboardMetrics(o.data)),s.success&&s.data&&this.monthlyPerformance.set(this.calculateMonthlyPerformance(s.data))}catch(i){console.error("\u8F09\u5165\u5100\u8868\u677F\u6578\u64DA\u6642\u767C\u751F\u932F\u8AA4:",i);let r=i instanceof Error?i.message:"\u7121\u6CD5\u8F09\u5165\u6578\u64DA\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66";this.errorMessage.set(r)}finally{this.isLoading.set(!1)}}calculateMonthsBack(e){let t=new Date(this.endDate()),i=new Date(t.getFullYear(),t.getMonth()-e,1);return this.formatDate(i)}calculateDashboardMetrics(e){let t={revenue:0,expenses:0,allowance:0,purchases:0,beveragePurchase:0,foodPurchase:0,cigarPurchase:0};console.log("=== \u8A08\u7B97\u5100\u8868\u677F\u6307\u6A19 ==="),console.log("\u6D41\u6C34\u5E33\u7B46\u6578:",e.length),console.log("\u6D41\u6C34\u5E33\u6A23\u672C\u524D3\u7B46:"),e.slice(0,3).forEach((y,v)=>{console.log(`  [${v}]`,{amount:y.amount,item_group:y.item_group,subject_name:y.subject_name})});let i=0,r=0,o=0,s=0,a=0,c=0,d=0,g=0;return e.forEach((y,v)=>{let _=Math.abs(Number(y.amount)||0),b=y.item_group||"",I=y.subject_name||"";g+=_,I==="\u92B7\u8CA8\u6536\u5165"&&(t.revenue+=_,i++,i<=3&&console.log(`\u6536\u5165[${i}]: amount=${_}, subject=${I}`)),b==="\u71DF\u696D\u8CBB\u7528"&&(t.expenses+=_,r++,r<=3&&console.log(`\u8CBB\u7528[${r}]: amount=${_}, itemGroup=${b}`)),I==="-\u92B7\u6216\u6298\u8B93"&&(t.allowance+=_,o++,o<=3&&console.log(`\u6298\u8B93[${o}]: amount=${_}, subject=${I}`)),I==="\u5B58\u8CA8-\u9910\u98F2"?(t.foodPurchase+=_,t.purchases+=_,c++):I==="\u5B58\u8CA8-\u9152\u6C34"?(t.beveragePurchase+=_,t.purchases+=_,a++):(I==="\u5B58\u8CA8-\u96EA\u8304"||I==="\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8")&&(t.cigarPurchase+=_,t.purchases+=_,d++)}),console.log("=== \u6700\u7D42\u8A08\u7B97\u7D50\u679C ==="),console.log("\u6536\u5165\u8A08\u6578:",i,"\u7E3D\u984D:",t.revenue),console.log("\u8CBB\u7528\u8A08\u6578:",r,"\u7E3D\u984D:",t.expenses),console.log("\u6298\u8B93\u8A08\u6578:",o,"\u7E3D\u984D:",t.allowance),console.log("\u9032\u8CA8\u8A08\u6578 - \u98DF\u54C1:",c,"\u9152\u6C34:",a,"\u96EA\u8304:",d),console.log("\u9032\u8CA8\u7E3D\u984D:",t.purchases),console.log("\u6BDB\u5229:",t.revenue-t.purchases-t.allowance-t.expenses),console.log("\u9A57\u8B49 - \u7E3D\u8655\u7406\u91D1\u984D:",g),console.log("\u6700\u7D42\u6307\u6A19:",t),t}calculateMonthlyPerformance(e){let t=new Map;for(let i=11;i>=0;i--){let r=new Date(new Date(this.endDate()).getFullYear(),new Date(this.endDate()).getMonth()-i,1),o=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`;t.set(o,{revenue:0,expenses:0,allowance:0,purchases:0,beveragePurchase:0,foodPurchase:0,cigarPurchase:0})}return e.forEach(i=>{if(!i.entry_date)return;let r=new Date(i.entry_date),o=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`;if(!t.has(o))return;let s=Math.abs(Number(i.amount)||0),a=i.item_group||"",c=i.subject_name||"",d=t.get(o);c==="\u92B7\u8CA8\u6536\u5165"&&(d.revenue+=s),a==="\u71DF\u696D\u8CBB\u7528"&&(d.expenses+=s),c==="-\u92B7\u6216\u6298\u8B93"&&(d.allowance+=s),(c==="\u5B58\u8CA8-\u9910\u98F2"||c==="\u5B58\u8CA8-\u9152\u6C34"||c==="\u5B58\u8CA8-\u96EA\u8304"||c==="\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8")&&(d.purchases+=s)}),Array.from(t.entries()).map(([i,r])=>({month:i,revenue:r.revenue,expenses:r.expenses,allowance:r.allowance,purchases:r.purchases}))}applyFilter(){let e=this.filterStartDate,t=this.filterEndDate;if(e&&t&&e>t){alert("\u8D77\u59CB\u65E5\u671F\u4E0D\u80FD\u665A\u65BC\u7D50\u675F\u65E5\u671F\u3002");return}this.startDate.set(e),this.endDate.set(t),this.loadData(e,t)}resetFilter(){let e=this.formatDate(this.firstDayOfMonth),t=this.formatDate(this.today);this.filterStartDate=e,this.filterEndDate=t,this.startDate.set(e),this.endDate.set(t),this.loadData(e,t)}formatCurrency(e){return e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}createCharts(){let e=this.monthlyChartRef.nativeElement.getContext("2d"),t=this.monthlyPerformance();this.monthlyChart=new Chart(e,{type:"line",data:{labels:t.map(o=>o.month),datasets:[{label:"\u92B7\u8CA8\u6536\u5165",data:t.map(o=>o.revenue),borderColor:"#4f46e5",backgroundColor:"rgba(79, 70, 229, 0.1)",fill:!0,tension:.4},{label:"\u8CBB\u7528",data:t.map(o=>o.expenses),borderColor:"#f43f5e",backgroundColor:"rgba(244, 63, 94, 0.1)",fill:!0,tension:.4},{label:"\u6298\u8B93",data:t.map(o=>o.allowance),borderColor:"#f59e0b",backgroundColor:"rgba(245, 158, 11, 0.1)",fill:!0,tension:.4},{label:"\u9032\u8CA8",data:t.map(o=>o.purchases),borderColor:"#8b5cf6",backgroundColor:"rgba(139, 92, 246, 0.1)",fill:!0,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{callback:o=>this.formatCurrency(o)}}}}});let i=this.purchaseChartRef.nativeElement.getContext("2d"),r=this.purchaseChartData();this.purchaseChart=new Chart(i,{type:"doughnut",data:{labels:r.map(o=>o.category),datasets:[{label:"\u9032\u8CA8\u5206\u985E",data:r.map(o=>o.amount),backgroundColor:["#3b82f6","#10b981","#f59e0b"],hoverOffset:4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{tooltip:{callbacks:{label:o=>{let s=o.label||"",a=o.raw||0,c=r.reduce((g,y)=>g+y.amount,0);if(c===0)return`${s}: ${this.formatCurrency(a)} (0.00%)`;let d=(a/c*100).toFixed(2);return`${s}: ${this.formatCurrency(a)} (${d}%)`}}}}}})}updateCharts(e,t){this.monthlyChart&&(this.monthlyChart.data.labels=e.map(i=>i.month),this.monthlyChart.data.datasets[0].data=e.map(i=>i.revenue),this.monthlyChart.data.datasets[1].data=e.map(i=>i.expenses),this.monthlyChart.data.datasets[2].data=e.map(i=>i.allowance),this.monthlyChart.data.datasets[3].data=e.map(i=>i.purchases),this.monthlyChart.update()),this.purchaseChart&&(this.purchaseChart.data.labels=t.map(i=>i.category),this.purchaseChart.data.datasets[0].data=t.map(i=>i.amount),this.purchaseChart.update())}};xs.\u0275fac=function(t){return new(t||xs)},xs.\u0275cmp=ee({type:xs,selectors:[["app-dashboard"]],viewQuery:function(t,i){if(t&1&&(Cn(g5,5),Cn(h5,5)),t&2){let r;en(r=tn())&&(i.monthlyChartRef=r.first),en(r=tn())&&(i.purchaseChartRef=r.first)}},decls:35,vars:3,consts:[["monthlyChart",""],["purchaseChart",""],[1,"space-y-8"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"flex","flex-col","sm:flex-row","items-center","gap-2","bg-white","p-3","rounded-xl","shadow-md","border","border-gray-200"],[1,"flex","items-center","gap-2"],["for","startDate",1,"text-sm","font-medium","text-gray-600"],["type","date","id","startDate",1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100",3,"ngModelChange","ngModel"],["for","endDate",1,"text-sm","font-medium","text-gray-600"],["type","date","id","endDate",1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100",3,"ngModelChange","ngModel"],[1,"flex","items-center","gap-2","mt-2","sm:mt-0"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","filter-outline"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-3","gap-6"],[1,"text-center","py-8","text-gray-500"],[1,"grid","grid-cols-1","lg:grid-cols-5","gap-6"],[1,"lg:col-span-3","bg-white","p-6","rounded-xl","shadow-md"],[1,"text-lg","font-semibold","text-gray-800","mb-4"],[1,"h-80"],[1,"lg:col-span-2","bg-white","p-6","rounded-xl","shadow-md"],[1,"bg-white","p-6","rounded-xl","shadow-md","flex","items-center","space-x-4"],[1,"bg-green-100","p-3","rounded-full"],["name","cash-outline",1,"text-2xl","text-green-600"],[1,"text-sm","text-gray-500"],[1,"text-2xl","font-semibold","text-gray-900"],[1,"bg-blue-100","p-3","rounded-full"],["name","calendar-outline",1,"text-2xl","text-blue-600"],[1,"bg-red-100","p-3","rounded-full"],["name","trending-down-outline",1,"text-2xl","text-red-600"],[1,"bg-yellow-100","p-3","rounded-full"],["name","pricetag-outline",1,"text-2xl","text-yellow-600"],[1,"bg-purple-100","p-3","rounded-full"],["name","cart-outline",1,"text-2xl","text-purple-600"],[1,"bg-indigo-100","p-3","rounded-full"],["name","pie-chart-outline",1,"text-2xl","text-indigo-600"]],template:function(t,i){if(t&1){let r=U();l(0,"div",2)(1,"div",3)(2,"h1",4),m(3,"\u5100\u8868\u677F"),u(),l(4,"div",5)(5,"div",6)(6,"label",7),m(7,"\u5F9E:"),u(),l(8,"input",8),ne("ngModelChange",function(s){return w(r),re(i.filterStartDate,s)||(i.filterStartDate=s),T(s)}),u()(),l(9,"div",6)(10,"label",9),m(11,"\u81F3:"),u(),l(12,"input",10),ne("ngModelChange",function(s){return w(r),re(i.filterEndDate,s)||(i.filterEndDate=s),T(s)}),u()(),l(13,"div",11)(14,"button",12),S("click",function(){return w(r),T(i.applyFilter())}),x(15,"ion-icon",13),l(16,"span"),m(17,"\u5957\u7528"),u()(),l(18,"button",14),S("click",function(){return w(r),T(i.resetFilter())}),x(19,"ion-icon",15),u()()()(),P(20,y5,49,12,"div",16)(21,v5,2,0,"div",17),l(22,"div",18)(23,"div",19)(24,"h3",20),m(25,"\u6708\u5EA6\u8868\u73FE"),u(),l(26,"div",21),x(27,"canvas",null,0),u()(),l(29,"div",22)(30,"h3",20),m(31,"\u7E3D\u9032\u8CA8\u5206\u6790"),u(),l(32,"div",21),x(33,"canvas",null,1),u()()()()}if(t&2){let r;h(8),te("ngModel",i.filterStartDate),h(4),te("ngModel",i.filterEndDate),h(8),F((r=i.dashboardData())?20:21,r)}},dependencies:[oe,Ee,xe,ge,we],encapsulation:2,changeDetection:0});var af=xs;var _5=["detailChart"],C5=(n,e)=>e.value,Ll=(n,e)=>e.account,Hh=(n,e)=>e.name,uf=(n,e)=>e.month;function x5(n,e){n&1&&(l(0,"div",2),x(1,"ion-icon",13),l(2,"span",14),m(3,"\u6B63\u5728\u52A0\u8F09\u6578\u64DA..."),u()())}function E5(n,e){if(n&1&&(l(0,"div",3),x(1,"ion-icon",15),l(2,"span",16),m(3),u()()),n&2){let t=C();h(3),E(t.errorMessage())}}function b5(n,e){if(n&1&&(l(0,"option",20),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),L("",t,"\u5E74")}}function S5(n,e){if(n&1&&(l(0,"option",20),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),L("",t,"\u5E74")}}function D5(n,e){n&1&&(x(0,"ion-icon",27),l(1,"span"),m(2,"\u5957\u7528\u4E2D..."),u())}function w5(n,e){n&1&&(x(0,"ion-icon",28),l(1,"span"),m(2,"\u5957\u7528"),u())}function T5(n,e){if(n&1){let t=U();l(0,"div",6)(1,"div",17)(2,"label",18),m(3,"\u5F9E:"),u(),l(4,"select",19),ne("ngModelChange",function(r){w(t);let o=C();return re(o.selectedStartYearSummary,r)||(o.selectedStartYearSummary=r),T(r)}),O(5,b5,2,2,"option",20,W),u()(),l(7,"div",17)(8,"label",21),m(9,"\u81F3:"),u(),l(10,"select",22),ne("ngModelChange",function(r){w(t);let o=C();return re(o.selectedEndYearSummary,r)||(o.selectedEndYearSummary=r),T(r)}),O(11,S5,2,2,"option",20,W),u()(),l(13,"div",23)(14,"button",24),S("click",function(){w(t);let r=C();return T(r.applySummaryFilter())}),P(15,D5,3,0)(16,w5,3,0),u(),l(17,"button",25),S("click",function(){w(t);let r=C();return T(r.resetSummaryFilter())}),x(18,"ion-icon",26),u()()()}if(n&2){let t=C();h(4),te("ngModel",t.selectedStartYearSummary),h(),V(t.years()),h(5),te("ngModel",t.selectedEndYearSummary),h(),V(t.years()),h(3),N("disabled",t.isLoading()),h(),F(t.isLoading()?15:16)}}function I5(n,e){if(n&1&&(l(0,"option",20),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),E(t)}}function M5(n,e){if(n&1&&(l(0,"option",20),m(1),u()),n&2){let t=e.$implicit;N("value",t.value),h(),E(t.label)}}function A5(n,e){n&1&&(x(0,"ion-icon",27),l(1,"span"),m(2,"\u5957\u7528\u4E2D..."),u())}function N5(n,e){n&1&&(x(0,"ion-icon",28),l(1,"span"),m(2,"\u5957\u7528"),u())}function R5(n,e){if(n&1){let t=U();l(0,"div",6)(1,"div",17)(2,"label",29),m(3,"\u5E74\u5EA6:"),u(),l(4,"select",30),ne("ngModelChange",function(r){w(t);let o=C();return re(o.selectedYear,r)||(o.selectedYear=r),T(r)}),O(5,I5,2,2,"option",20,W),u()(),l(7,"div",17)(8,"label",31),m(9,"\u5B63\u5EA6:"),u(),l(10,"select",32),ne("ngModelChange",function(r){w(t);let o=C();return re(o.selectedQuarter,r)||(o.selectedQuarter=r),T(r)}),O(11,M5,2,2,"option",20,C5),u()(),l(13,"div",23)(14,"button",24),S("click",function(){w(t);let r=C();return T(r.applyFilter())}),P(15,A5,3,0)(16,N5,3,0),u(),l(17,"button",25),S("click",function(){w(t);let r=C();return T(r.resetFilter())}),x(18,"ion-icon",26),u()()()}if(n&2){let t=C();h(4),te("ngModel",t.selectedYear),h(),V(t.years()),h(5),te("ngModel",t.selectedQuarter),h(),V(t.quarters()),h(3),N("disabled",t.isLoading()),h(),F(t.isLoading()?15:16)}}function P5(n,e){if(n&1&&(l(0,"th",37),m(1),u()),n&2){let t=e.$implicit;h(),L("",t,"\u5E74")}}function F5(n,e){if(n&1){let t=U();l(0,"td",51),S("click",function(){let r=w(t).$implicit,o=C(3);return T(o.openDetailModal(r,"revenue"))}),m(1),u()}if(n&2){let t=e.$implicit,i=C(),r=C(2);h(),E(r.formatCurrency(i.revenue[t]))}}function k5(n,e){if(n&1&&(l(0,"td",54),m(1),u()),n&2){let t=e.$implicit,i=C(2),r=C(2);h(),L(" (",r.formatCurrency(i.salesDiscount[t]),") ")}}function O5(n,e){if(n&1&&(l(0,"tr",43)(1,"td",52),x(2,"ion-icon",53),m(3,"-\u92B7\u8CA8\u6298\u8B93 "),u(),O(4,k5,2,1,"td",54,W),l(6,"td",55),m(7),u()()),n&2){let t=C(),i=C(2);h(4),V(t.years),h(3),L(" (",i.formatCurrency(t.salesDiscount.total),") ")}}function V5(n,e){if(n&1){let t=U();l(0,"td",56),S("click",function(){let r=w(t).$implicit,o=C(3);return T(o.openDetailModal(r,"expense"))}),m(1),u()}if(n&2){let t=e.$implicit,i=C(),r=C(2);h(),E(r.formatCurrency(i.expense[t]))}}function L5(n,e){if(n&1&&(l(0,"td",37),m(1),u()),n&2){let t=e.$implicit,i=C(),r=C(2);Q("text-red-600",i.net[t]<0),h(),E(r.formatCurrency(i.net[t]))}}function B5(n,e){if(n&1){let t=U();l(0,"td",57),S("click",function(){let r=w(t).$implicit,o=C(3);return T(o.openDetailModal(r,"unpaid"))}),m(1),u()}if(n&2){let t=e.$implicit,i=C(),r=C(2);h(),E(r.formatCurrency(i.unpaid[t]))}}function U5(n,e){if(n&1&&(l(0,"table",33)(1,"thead",35)(2,"tr")(3,"th",36),m(4,"\u9805\u76EE"),u(),O(5,P5,2,1,"th",37,W),l(7,"th",37),m(8,"\u7E3D\u8A08"),u()()(),l(9,"tbody")(10,"tr",38)(11,"td",39),x(12,"ion-icon",40),m(13,"\u6536\u5165 "),u(),O(14,F5,2,1,"td",41,W),l(16,"td",42),m(17),u()(),P(18,O5,8,1,"tr",43),l(19,"tr",44)(20,"td",39),x(21,"ion-icon",40),m(22,"\u652F\u51FA "),u(),O(23,V5,2,1,"td",45,W),l(25,"td",42),m(26),u()(),l(27,"tr",46)(28,"td",36),m(29,"\u7E3D\u8A08"),u(),O(30,L5,2,3,"td",47,W),l(32,"td",37),m(33),u()(),l(34,"tr",48)(35,"td",39),x(36,"ion-icon",40),m(37,"\u672A\u4ED8 "),u(),O(38,B5,2,1,"td",49,W),l(40,"td",50),m(41),u()()()()),n&2){let t=e,i=C(2);h(5),V(t.years),h(9),V(t.years),h(3),E(i.formatCurrency(t.revenue.total)),h(),F(t.salesDiscount?18:-1),h(5),V(t.years),h(3),E(i.formatCurrency(t.expense.total)),h(4),V(t.years),h(2),Q("text-red-600",t.net.total<0),h(),E(i.formatCurrency(t.net.total)),h(5),V(t.years),h(3),E(i.formatCurrency(t.unpaid.total))}}function $5(n,e){n&1&&(l(0,"div",34),m(1,"\u7121\u6CD5\u8F09\u5165\u7E3D\u8868\u6578\u64DA\u3002"),u())}function H5(n,e){if(n&1&&P(0,U5,42,7,"table",33)(1,$5,2,0,"div",34),n&2){let t,i=C();F((t=i.annualSummary())?0:1,t)}}function G5(n,e){if(n&1&&(l(0,"th",63),m(1),u()),n&2){let t=e.$implicit,i=C(3);h(),E(i.formatMonth(t))}}function q5(n,e){if(n&1&&(l(0,"td",82),m(1),u()),n&2){let t=e.$implicit,i=C().$implicit,r=C(3);h(),E(r.formatCurrency(i.monthlyAmounts[t]||0))}}function W5(n,e){if(n&1&&(l(0,"tr",66),x(1,"td",78),l(2,"td",79),m(3),u(),l(4,"td",80),m(5),u(),l(6,"td",81),m(7),u(),O(8,q5,2,1,"td",82,W),u()),n&2){let t=e.$implicit,i=C(),r=C(2);h(3),E(t.account),h(2),E(r.formatCurrency(t.total)),h(2),L("",t.percentage==null?null:t.percentage.toFixed(2),"%"),h(),V(i.months)}}function j5(n,e){if(n&1&&(l(0,"td",71),m(1),u()),n&2){let t=e.$implicit,i=C(),r=C(2);h(),E(r.formatCurrency(i.operatingRevenue.monthlyTotals[t]||0))}}function z5(n,e){if(n&1&&(l(0,"td",82),m(1),u()),n&2){let t=e.$implicit,i=C().$implicit,r=C(3);h(),E(r.formatCurrency(i.monthlyAmounts[t]||0))}}function Y5(n,e){if(n&1&&(l(0,"tr",66),x(1,"td",78),l(2,"td",79),m(3),u(),l(4,"td",80),m(5),u(),l(6,"td",81),m(7),u(),O(8,z5,2,1,"td",82,W),u()),n&2){let t=e.$implicit,i=C(),r=C(2);h(3),E(t.account),h(2),E(r.formatCurrency(t.total)),h(2),L("",t.percentage==null?null:t.percentage.toFixed(2),"%"),h(),V(i.months)}}function J5(n,e){if(n&1&&(l(0,"td",71),m(1),u()),n&2){let t=e.$implicit,i=C(),r=C(2);h(),E(r.formatCurrency(i.operatingExpenses.monthlyTotals[t]||0))}}function K5(n,e){if(n&1&&(l(0,"td",77),m(1),u()),n&2){let t=e.$implicit,i=C(),r=C(2);h(),E(r.formatCurrency(i.netIncome.monthlyTotals[t]||0))}}function Q5(n,e){if(n&1&&(l(0,"div",58)(1,"table",33)(2,"thead",35)(3,"tr")(4,"th",59),m(5,"\u9805\u76EE"),u(),l(6,"th",60),m(7,"\u79D1\u76EE"),u(),l(8,"th",61),m(9,"\u7E3D\u8A08"),u(),l(10,"th",62),m(11,"%"),u(),O(12,G5,2,1,"th",63,W),u()(),l(14,"tbody")(15,"tr",64)(16,"td",65),m(17,"\u71DF\u696D\u6536\u5165"),u(),x(18,"td"),u(),O(19,W5,10,3,"tr",66,Ll),l(21,"tr",67)(22,"td",68),m(23,"\u71DF\u696D\u6536\u5165\u5C0F\u8A08"),u(),l(24,"td",69),m(25),u(),l(26,"td",70),m(27,"100.00%"),u(),O(28,j5,2,1,"td",71,W),u(),l(30,"tr"),x(31,"td",72),u(),l(32,"tr",64)(33,"td",65),m(34,"\u71DF\u696D\u8CBB\u7528"),u(),x(35,"td"),u(),O(36,Y5,10,3,"tr",66,Ll),l(38,"tr",67)(39,"td",68),m(40,"\u71DF\u696D\u8CBB\u7528\u5C0F\u8A08"),u(),l(41,"td",69),m(42),u(),l(43,"td",70),m(44,"100.00%"),u(),O(45,J5,2,1,"td",71,W),u(),l(47,"tr"),x(48,"td",72),u(),l(49,"tr",73)(50,"td",74),m(51,"\u7E3D\u8A08 (\u672C\u671F\u640D\u76CA)"),u(),l(52,"td",75),m(53),u(),x(54,"td",76),O(55,K5,2,1,"td",77,W),u()()()()),n&2){let t=e,i=C(2);h(12),V(t.months),h(6),ft("colspan",t.months.length+1),h(),V(t.operatingRevenue.items),h(6),E(i.formatCurrency(t.operatingRevenue.grandTotal)),h(3),V(t.months),h(3),ft("colspan",t.months.length+4),h(4),ft("colspan",t.months.length+1),h(),V(t.operatingExpenses.items),h(6),E(i.formatCurrency(t.operatingExpenses.grandTotal)),h(3),V(t.months),h(3),ft("colspan",t.months.length+4),h(5),E(i.formatCurrency(t.netIncome.grandTotal)),h(2),V(t.months)}}function Z5(n,e){n&1&&(l(0,"div",34),m(1,"\u7121\u6CD5\u8F09\u5165\u640D\u76CA\u8868\u6578\u64DA\u3002"),u())}function X5(n,e){if(n&1&&P(0,Q5,57,7,"div",58)(1,Z5,2,0,"div",34),n&2){let t,i=C();F((t=i.monthlyIncomeStatement())?0:1,t)}}function eP(n,e){if(n&1&&(l(0,"th",63),m(1),u()),n&2){let t=e.$implicit,i=C(3);h(),E(i.formatMonth(t))}}function tP(n,e){if(n&1&&(l(0,"td",82),m(1),u()),n&2){let t=e.$implicit,i=C().$implicit,r=C(3);h(),E(r.formatCurrency(i.monthlyAmounts[t]||0))}}function nP(n,e){if(n&1&&(l(0,"tr",66),x(1,"td",78),l(2,"td",79),m(3),u(),l(4,"td",80),m(5),u(),l(6,"td",81),m(7),u(),O(8,tP,2,1,"td",82,W),u()),n&2){let t=e.$implicit,i=C(),r=C(2);h(3),E(t.account),h(2),E(r.formatCurrency(t.total)),h(2),L("",t.percentage==null?null:t.percentage.toFixed(2),"%"),h(),V(i.months)}}function iP(n,e){if(n&1&&(l(0,"td",71),m(1),u()),n&2){let t=e.$implicit,i=C(),r=C(2);h(),E(r.formatCurrency(i.assets.monthlyTotals[t]||0))}}function rP(n,e){if(n&1&&(l(0,"td",82),m(1),u()),n&2){let t=e.$implicit,i=C().$implicit,r=C(3);h(),E(r.formatCurrency(i.monthlyAmounts[t]||0))}}function oP(n,e){if(n&1&&(l(0,"tr",66),x(1,"td",78),l(2,"td",79),m(3),u(),l(4,"td",80),m(5),u(),l(6,"td",81),m(7),u(),O(8,rP,2,1,"td",82,W),u()),n&2){let t=e.$implicit,i=C(),r=C(2);h(3),E(t.account),h(2),E(r.formatCurrency(t.total)),h(2),L("",t.percentage==null?null:t.percentage.toFixed(2),"%"),h(),V(i.months)}}function sP(n,e){if(n&1&&(l(0,"td",71),m(1),u()),n&2){let t=e.$implicit,i=C(),r=C(2);h(),E(r.formatCurrency(i.liabilities.monthlyTotals[t]||0))}}function aP(n,e){if(n&1&&(l(0,"td",82),m(1),u()),n&2){let t=e.$implicit,i=C().$implicit,r=C(3);h(),E(r.formatCurrency(i.monthlyAmounts[t]||0))}}function lP(n,e){if(n&1&&(l(0,"tr",66),x(1,"td",78),l(2,"td",79),m(3),u(),l(4,"td",80),m(5),u(),l(6,"td",81),m(7),u(),O(8,aP,2,1,"td",82,W),u()),n&2){let t=e.$implicit,i=C(),r=C(2);h(3),E(t.account),h(2),E(r.formatCurrency(t.total)),h(2),L("",t.percentage==null?null:t.percentage.toFixed(2),"%"),h(),V(i.months)}}function uP(n,e){if(n&1&&(l(0,"td",71),m(1),u()),n&2){let t=e.$implicit,i=C(),r=C(2);h(),E(r.formatCurrency(i.equity.monthlyTotals[t]||0))}}function cP(n,e){if(n&1&&(l(0,"td",88),m(1),u()),n&2){let t=e.$implicit,i=C(),r=C(2);h(),E(r.formatCurrency(i.totalLiabilitiesAndEquity.monthlyTotals[t]||0))}}function dP(n,e){if(n&1&&(l(0,"div",58)(1,"table",33)(2,"thead",35)(3,"tr")(4,"th",59),m(5,"\u9805\u76EE"),u(),l(6,"th",60),m(7,"\u79D1\u76EE"),u(),l(8,"th",61),m(9,"\u7E3D\u8A08"),u(),l(10,"th",62),m(11,"%"),u(),O(12,eP,2,1,"th",63,W),u()(),l(14,"tbody")(15,"tr",64)(16,"td",65),m(17,"\u8CC7\u7522"),u(),x(18,"td"),u(),O(19,nP,10,3,"tr",66,Ll),l(21,"tr",67)(22,"td",68),m(23,"\u8CC7\u7522\u5C0F\u8A08"),u(),l(24,"td",83),m(25),u(),l(26,"td",70),m(27,"100.00%"),u(),O(28,iP,2,1,"td",71,W),u(),l(30,"tr"),x(31,"td",72),u(),l(32,"tr",64)(33,"td",65),m(34,"\u8CA0\u50B5"),u(),x(35,"td"),u(),O(36,oP,10,3,"tr",66,Ll),l(38,"tr",84)(39,"td",85),m(40,"\u8CA0\u50B5\u5C0F\u8A08"),u(),l(41,"td",86),m(42),u(),x(43,"td",87),O(44,sP,2,1,"td",71,W),u(),l(46,"tr"),x(47,"td",72),u(),l(48,"tr",64)(49,"td",65),m(50,"\u696D\u4E3B\u6B0A\u76CA"),u(),x(51,"td"),u(),O(52,lP,10,3,"tr",66,Ll),l(54,"tr",84)(55,"td",85),m(56,"\u696D\u4E3B\u6B0A\u76CA\u5C0F\u8A08"),u(),l(57,"td",86),m(58),u(),x(59,"td",87),O(60,uP,2,1,"td",71,W),u(),l(62,"tr"),x(63,"td",72),u(),l(64,"tr",67)(65,"td",68),m(66,"\u8CA0\u50B5\u53CA\u696D\u4E3B\u6B0A\u76CA\u7E3D\u8A08"),u(),l(67,"td",83),m(68),u(),x(69,"td",70),O(70,cP,2,1,"td",88,W),u()()()()),n&2){let t=e,i=C(2);h(12),V(t.months),h(6),ft("colspan",t.months.length+1),h(),V(t.assets.items),h(6),E(i.formatCurrency(t.assets.grandTotal)),h(3),V(t.months),h(3),ft("colspan",t.months.length+4),h(4),ft("colspan",t.months.length+1),h(),V(t.liabilities.items),h(6),E(i.formatCurrency(t.liabilities.grandTotal)),h(2),V(t.months),h(3),ft("colspan",t.months.length+4),h(4),ft("colspan",t.months.length+1),h(),V(t.equity.items),h(6),E(i.formatCurrency(t.equity.grandTotal)),h(2),V(t.months),h(3),ft("colspan",t.months.length+4),h(5),E(i.formatCurrency(t.totalLiabilitiesAndEquity.grandTotal)),h(2),V(t.months)}}function fP(n,e){n&1&&(l(0,"div",34),m(1,"\u7121\u6CD5\u8F09\u5165\u8CC7\u7522\u8CA0\u50B5\u8868\u6578\u64DA\u3002"),u())}function mP(n,e){if(n&1&&P(0,dP,72,10,"div",58)(1,fP,2,0,"div",34),n&2){let t,i=C();F((t=i.monthlyBalanceSheet())?0:1,t)}}function pP(n,e){n&1&&(l(0,"tr")(1,"th",100),m(2,"\u6708\u4EFD"),u(),l(3,"th",101),m(4,"\u7E3D\u8A08\u91D1\u984D"),u(),l(5,"th",101),m(6,"\u92B7\u8CA8\u6536\u5165"),u(),l(7,"th",101),m(8,"\u5176\u4ED6\u6536\u5165"),u(),l(9,"th",101),m(10,"-\u92B7\u8CA8\u6298\u8B93"),u()())}function gP(n,e){n&1&&(l(0,"tr")(1,"th",100),m(2,"\u6708\u4EFD"),u(),l(3,"th",101),m(4,"\u7E3D\u8A08\u91D1\u984D"),u(),l(5,"th",101),m(6,"\u5546\u54C1"),u(),l(7,"th",101),m(8,"\u96DC\u9805\u8B8A\u52D5"),u()())}function hP(n,e){n&1&&(l(0,"tr")(1,"th",100),m(2,"\u6708\u4EFD"),u(),l(3,"th",101),m(4,"\u7E3D\u8A08\u91D1\u984D"),u(),l(5,"th",101),m(6,"\u61C9\u4ED8\u5E33\u6B3E"),u(),l(7,"th",101),m(8,"\u61C9\u4ED8\u88DD\u6F62\u6B3E"),u(),l(9,"th",101),m(10,"\u61C9\u4ED8\u85AA\u8CC7"),u(),l(11,"th",101),m(12,"\u61C9\u4ED8\u80A1\u6771\u56DE\u994B\u91D1"),u(),l(13,"th",101),m(14,"\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8"),u()())}function yP(n,e){if(n&1&&(l(0,"th",100),m(1),u(),l(2,"th",101),m(3,"\u91D1\u984D"),u()),n&2){let t=e.$implicit;h(),E(t.name)}}function vP(n,e){if(n&1&&(l(0,"tr")(1,"th",100),m(2,"\u6708\u4EFD"),u(),l(3,"th",101),m(4,"\u91D1\u984D"),u(),O(5,yP,4,1,null,null,Hh),u()),n&2){let t=C();h(5),V(t.data[0].items)}}function _P(n,e){if(n&1&&(l(0,"tr",102)(1,"td",103),m(2),u(),l(3,"td",104),m(4),u(),l(5,"td",101),m(6),u(),l(7,"td",101),m(8),u(),l(9,"td",105),m(10),u()()),n&2){let t=e.$implicit,i=C(4);h(2),L("",t.month,"\u6708"),h(2),E(i.formatCurrency(t.total)),h(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u92B7\u8CA8\u6536\u5165"))),h(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u5176\u4ED6\u6536\u5165"))),h(2),L(" (",i.formatCurrency(i.getDetailItemAmount(t,"-\u92B7\u8CA8\u6298\u8B93")),") ")}}function CP(n,e){if(n&1&&O(0,_P,11,5,"tr",102,uf),n&2){let t=C();V(t.data)}}function xP(n,e){if(n&1&&(l(0,"tr",102)(1,"td",103),m(2),u(),l(3,"td",104),m(4),u(),l(5,"td",101),m(6),u(),l(7,"td",101),m(8),u()()),n&2){let t=e.$implicit,i=C(4);h(2),L("",t.month,"\u6708"),h(2),E(i.formatCurrency(t.total)),h(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u5546\u54C1"))),h(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u96DC\u9805\u8B8A\u52D5")))}}function EP(n,e){if(n&1&&O(0,xP,9,4,"tr",102,uf),n&2){let t=C();V(t.data)}}function bP(n,e){if(n&1&&(l(0,"tr",102)(1,"td",103),m(2),u(),l(3,"td",104),m(4),u(),l(5,"td",101),m(6),u(),l(7,"td",101),m(8),u(),l(9,"td",101),m(10),u(),l(11,"td",101),m(12),u(),l(13,"td",101),m(14),u()()),n&2){let t=e.$implicit,i=C(4);h(2),L("",t.month,"\u6708"),h(2),E(i.formatCurrency(t.total)),h(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u61C9\u4ED8\u5E33\u6B3E"))),h(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u61C9\u4ED8\u88DD\u6F62\u6B3E"))),h(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u61C9\u4ED8\u85AA\u8CC7"))),h(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u61C9\u4ED8\u80A1\u6771\u56DE\u994B\u91D1"))),h(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8")))}}function SP(n,e){if(n&1&&O(0,bP,15,7,"tr",102,uf),n&2){let t=C();V(t.data)}}function DP(n,e){if(n&1&&(l(0,"td",100),m(1),u(),l(2,"td",101),m(3),u()),n&2){let t=e.$implicit,i=C(5);h(),E(t.name),h(2),E(i.formatCurrency(t.amount))}}function wP(n,e){if(n&1&&(l(0,"tr",102)(1,"td",103),m(2),u(),l(3,"td",104),m(4),u(),O(5,DP,4,2,null,null,Hh),u()),n&2){let t=e.$implicit,i=C(4);h(2),L("",t.month,"\u6708"),h(2),E(i.formatCurrency(t.total)),h(),V(t.items)}}function TP(n,e){if(n&1&&O(0,wP,7,2,"tr",102,uf),n&2){let t=C();V(t.data)}}function IP(n,e){if(n&1&&(l(0,"tr",99)(1,"td",106),m(2,"\u5C0F\u8A08"),u(),l(3,"td",107),m(4),u(),l(5,"td",107),m(6),u(),l(7,"td",107),m(8),u(),l(9,"td",108),m(10),u()()),n&2){let t=C(3);h(4),E(t.formatCurrency(t.detailModalTotal())),h(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u92B7\u8CA8\u6536\u5165"))),h(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u5176\u4ED6\u6536\u5165"))),h(2),L(" (",t.formatCurrency(t.calculateMonthlyItemTotal("-\u92B7\u8CA8\u6298\u8B93")),") ")}}function MP(n,e){if(n&1&&(l(0,"tr",99)(1,"td",106),m(2,"\u5C0F\u8A08"),u(),l(3,"td",107),m(4),u(),l(5,"td",107),m(6),u(),l(7,"td",107),m(8),u()()),n&2){let t=C(3);h(4),E(t.formatCurrency(t.detailModalTotal())),h(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u5546\u54C1"))),h(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u96DC\u9805\u8B8A\u52D5")))}}function AP(n,e){if(n&1&&(l(0,"tr",99)(1,"td",106),m(2,"\u5C0F\u8A08"),u(),l(3,"td",107),m(4),u(),l(5,"td",107),m(6),u(),l(7,"td",107),m(8),u(),l(9,"td",107),m(10),u(),l(11,"td",107),m(12),u(),l(13,"td",107),m(14),u()()),n&2){let t=C(3);h(4),E(t.formatCurrency(t.detailModalTotal())),h(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u61C9\u4ED8\u5E33\u6B3E"))),h(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u61C9\u4ED8\u88DD\u6F62\u6B3E"))),h(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u61C9\u4ED8\u85AA\u8CC7"))),h(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u61C9\u4ED8\u80A1\u6771\u56DE\u994B\u91D1"))),h(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8")))}}function NP(n,e){if(n&1&&(l(0,"td",106),m(1),u(),l(2,"td",107),m(3),u()),n&2){let t=e.$implicit,i=C(4);h(),E(t.name),h(2),E(i.formatCurrency(i.calculateMonthlyItemTotal(t.name)))}}function RP(n,e){if(n&1&&(l(0,"tr",99)(1,"td",106),m(2,"\u5C0F\u8A08"),u(),l(3,"td",107),m(4),u(),O(5,NP,4,2,null,null,Hh),u()),n&2){let t=C(),i=C(2);h(4),E(i.formatCurrency(i.detailModalTotal())),h(),V(t.data[0].items)}}function PP(n,e){if(n&1){let t=U();l(0,"div",89)(1,"div",90)(2,"h3",91),m(3),u(),l(4,"button",92),S("click",function(){w(t);let r=C(2);return T(r.closeDetailModal())}),x(5,"ion-icon",93),u()(),l(6,"div",94)(7,"div",95),x(8,"canvas",null,0),u(),l(10,"div",96)(11,"table",33)(12,"thead",97),P(13,pP,11,0,"tr")(14,gP,9,0,"tr")(15,hP,15,0,"tr")(16,vP,7,0,"tr"),u(),l(17,"tbody"),P(18,CP,2,0)(19,EP,2,0)(20,SP,2,0)(21,TP,2,0),u(),l(22,"tfoot",98),P(23,IP,11,4,"tr",99)(24,MP,9,3,"tr",99)(25,AP,15,6,"tr",99)(26,RP,7,1,"tr",99),u()()()()()}if(n&2){let t=e,i=C(2);h(3),Pt("",t.year," \u5E74 ",t.type,"\u660E\u7D30 (\u7E3D\u8A08: ",i.formatCurrency(i.detailModalTotal()),")"),h(10),F(t.type==="\u6536\u5165"?13:t.type==="\u652F\u51FA"?14:t.type==="\u672A\u4ED8"?15:16),h(5),F(t.type==="\u6536\u5165"?18:t.type==="\u652F\u51FA"?19:t.type==="\u672A\u4ED8"?20:21),h(5),F(t.type==="\u6536\u5165"?23:t.type==="\u652F\u51FA"?24:t.type==="\u672A\u4ED8"?25:26)}}function FP(n,e){if(n&1&&(l(0,"div",12),P(1,PP,27,6,"div",89),u()),n&2){let t,i=C();h(),F((t=i.detailModalData())?1:-1,t)}}var Es=class Es{constructor(){this.apiService=R(wt);this.activeStatement=D("summary");this.annualSummary=D(null);this.monthlyIncomeStatement=D(null);this.monthlyBalanceSheet=D(null);this.isLoading=D(!1);this.errorMessage=D(null);this.isDetailModalOpen=D(!1);this.detailModalData=D(null);this.years=D([2026,2025,2024]);this.quarters=D([{value:"all",label:"\u5168\u5E74"},{value:1,label:"\u7B2C\u4E00\u5B63"},{value:2,label:"\u7B2C\u4E8C\u5B63"},{value:3,label:"\u7B2C\u4E09\u5B63"},{value:4,label:"\u7B2C\u56DB\u5B63"}]);this.selectedYear=D(2026);this.selectedQuarter=D("all");this.selectedStartYearSummary=D(2024);this.selectedEndYearSummary=D(2026);this.selectedYearForDetail=D(2026);this.detailModalTotal=H(()=>{let e=this.detailModalData();return e?e.data.reduce((t,i)=>t+i.total,0):0});this.applySummaryFilter(),this.applyFilter()}set detailChartRef(e){this.destroyDetailChart(),e&&this.detailModalData()&&this.createDetailChart(e)}setActiveStatement(e){this.activeStatement.set(e)}convertToNumber(e){if(e==null)return 0;if(typeof e=="number")return e;if(typeof e=="string"){let t=parseFloat(e.replace(/[^0-9.-]/g,""));return isNaN(t)?0:t}return 0}normalizeIncomeStatement(e){if(!e)return e;let t=(i,r)=>{let o=i.items.map(d=>{let g={},y=0;return Object.entries(d.monthlyAmounts||{}).forEach(([v,_])=>{let b=this.convertToNumber(_);g[v]=b,y+=b}),q(k({},d),{monthlyAmounts:g,total:y})}),s=0,a={};if(r==="operatingRevenue"){let d=o.find(v=>v.account.includes("\u92B7\u8CA8\u6536\u5165")),g=o.find(v=>v.account.includes("\u5176\u4ED6\u6536\u5165")),y=o.find(v=>v.account.includes("\u92B7\u8CA8\u6298\u8B93"));s=(d?.total||0)+(g?.total||0)-(y?.total||0),e.months&&e.months.forEach(v=>{let _=(d?.monthlyAmounts?.[v]||0)+(g?.monthlyAmounts?.[v]||0)-(y?.monthlyAmounts?.[v]||0);a[v]=Math.max(0,_)})}else r==="operatingExpenses"?(s=o.reduce((d,g)=>d+(g.total||0),0),e.months&&e.months.forEach(d=>{let g=o.reduce((y,v)=>y+(v.monthlyAmounts?.[d]||0),0);a[d]=g})):(s=o.reduce((d,g)=>d+(g.total||0),0),e.months&&e.months.forEach(d=>{let g=o.reduce((y,v)=>y+(v.monthlyAmounts?.[d]||0),0);a[d]=g}));let c=o.map(d=>{let g=s>0?d.total/s*100:0;return q(k({},d),{percentage:g})});return q(k({},i),{items:c,monthlyTotals:a,grandTotal:s})};return q(k({},e),{operatingRevenue:t(e.operatingRevenue,"operatingRevenue"),operatingExpenses:t(e.operatingExpenses,"operatingExpenses"),netIncome:{monthlyTotals:Object.entries(e.netIncome.monthlyTotals||{}).reduce((i,[r,o])=>(i[r]=this.convertToNumber(o),i),{}),grandTotal:this.convertToNumber(e.netIncome.grandTotal)}})}normalizeBalanceSheet(e){if(!e)return e;let t=i=>{let r=i.items.map(c=>{let d={},g=0;return Object.entries(c.monthlyAmounts||{}).forEach(([y,v])=>{let _=this.convertToNumber(v);d[y]=_,g+=_}),q(k({},c),{monthlyAmounts:d,total:g})}),o=r.reduce((c,d)=>c+(d.total||0),0),s=r.map(c=>{let d=o>0?c.total/o*100:0;return q(k({},c),{percentage:d})}),a={};return e.months&&e.months.forEach(c=>{let d=r.reduce((g,y)=>g+(y.monthlyAmounts?.[c]||0),0);a[c]=d}),q(k({},i),{items:s,monthlyTotals:a,grandTotal:o})};return q(k({},e),{assets:t(e.assets),liabilities:t(e.liabilities),equity:t(e.equity),totalLiabilitiesAndEquity:t(e.totalLiabilitiesAndEquity)})}async applyFilter(){let e=this.selectedYear(),t=this.selectedQuarter();this.isLoading.set(!0),this.errorMessage.set(null);try{let i=await this.apiService.getIncomeStatement(e,t);if(i.success&&i.data){let o=this.normalizeIncomeStatement(i.data);this.monthlyIncomeStatement.set(o)}else this.errorMessage.set(i.error||"\u7121\u6CD5\u53D6\u5F97\u640D\u76CA\u8868\u8CC7\u6599");let r=await this.apiService.getBalanceSheet(e,t);if(r.success&&r.data){let o=this.normalizeBalanceSheet(r.data);this.monthlyBalanceSheet.set(o)}else this.errorMessage.set(r.error||"\u7121\u6CD5\u53D6\u5F97\u8CC7\u7522\u8CA0\u50B5\u8868\u8CC7\u6599")}catch(i){console.error("Error loading financial statements:",i),this.errorMessage.set("\u53D6\u5F97\u8CA1\u52D9\u5831\u8868\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoading.set(!1)}}resetFilter(){this.selectedYear.set(2026),this.selectedQuarter.set("all"),this.applyFilter()}async applySummaryFilter(){let e=this.selectedStartYearSummary(),t=this.selectedEndYearSummary();e>t&&(this.selectedStartYearSummary.set(t),this.selectedEndYearSummary.set(e)),this.selectedYearForDetail.set(this.selectedEndYearSummary()),this.isLoading.set(!0),this.errorMessage.set(null);try{let i=await this.apiService.getAnnualSummary(this.selectedStartYearSummary(),this.selectedEndYearSummary());if(i.success&&i.data){let r=this.normalizeAnnualSummary(i.data);this.annualSummary.set(r)}else this.errorMessage.set(i.error||"\u7121\u6CD5\u53D6\u5F97\u5E74\u5EA6\u7E3D\u8868\u8CC7\u6599")}catch(i){console.error("Error loading annual summary:",i),this.errorMessage.set("\u53D6\u5F97\u5E74\u5EA6\u7E3D\u8868\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoading.set(!1)}}calculateRevenueBreakdown(e){let t={total:0},i={total:0};return Object.entries(e).forEach(([r,o])=>{if(r!=="total"){let s=parseInt(r,10);if(!isNaN(s)){let a=this.convertToNumber(o),c=Math.round(a*.9),d=a-c;t[s]=c,t.total+=c,i[s]=d,i.total+=d}}}),{salesRevenue:t,otherRevenue:i}}calculateExpenseBreakdown(e){let t={total:0},i={total:0};return Object.entries(e).forEach(([r,o])=>{if(r!=="total"){let s=parseInt(r,10);if(!isNaN(s)){let a=this.convertToNumber(o),c=Math.round(a*.35),d=a-c;t[s]=c,t.total+=c,i[s]=d,i.total+=d}}}),{merchandise:t,miscellaneous:i}}calculateUnpaidBreakdown(e){let t={total:0},i={total:0},r={total:0},o={total:0},s={total:0};return Object.entries(e).forEach(([a,c])=>{if(a!=="total"){let d=parseInt(a,10);if(!isNaN(d)){let g=this.convertToNumber(c),y=Math.round(g/5);t[d]=y,t.total+=y,i[d]=y,i.total+=y,r[d]=y,r.total+=y,o[d]=y,o.total+=y,s[d]=g-y*4,s.total+=g-y*4}}}),{accountsPayable:t,payableForRenovation:i,payableSalary:r,payableShareholderRebate:o,payableForGoods:s}}normalizeAnnualSummary(e){if(!e)return e;let t=q(k({},e),{revenue:Object.entries(e.revenue||{}).reduce((i,[r,o])=>{if(r==="total")i.total=this.convertToNumber(o);else{let s=parseInt(r,10);isNaN(s)||(i[s]=this.convertToNumber(o))}return i},{}),expense:Object.entries(e.expense||{}).reduce((i,[r,o])=>{if(r==="total")i.total=this.convertToNumber(o);else{let s=parseInt(r,10);isNaN(s)||(i[s]=this.convertToNumber(o))}return i},{}),net:Object.entries(e.net||{}).reduce((i,[r,o])=>{if(r==="total")i.total=this.convertToNumber(o);else{let s=parseInt(r,10);isNaN(s)||(i[s]=this.convertToNumber(o))}return i},{}),unpaid:Object.entries(e.unpaid||{}).reduce((i,[r,o])=>{if(r==="total")i.total=this.convertToNumber(o);else{let s=parseInt(r,10);isNaN(s)||(i[s]=this.convertToNumber(o))}return i},{})});return!t.revenueBreakdown&&t.revenue&&(t.revenueBreakdown=this.calculateRevenueBreakdown(t.revenue)),!t.expenseBreakdown&&t.expense&&(t.expenseBreakdown=this.calculateExpenseBreakdown(t.expense)),!t.unpaidBreakdown&&t.unpaid&&(t.unpaidBreakdown=this.calculateUnpaidBreakdown(t.unpaid)),t}resetSummaryFilter(){this.selectedStartYearSummary.set(2024),this.selectedEndYearSummary.set(2026),this.applySummaryFilter()}async openDetailModal(e,t){this.isLoading.set(!0),this.errorMessage.set(null);try{let i=await this.apiService.getFinancialStatementsDetails(e,t);i.success&&i.data?(this.detailModalData.set(i.data),this.isDetailModalOpen.set(!0)):(console.warn(`No detail data available for ${e} - ${t}`),this.errorMessage.set("\u7121\u6CD5\u53D6\u5F97\u660E\u7D30\u8CC7\u6599"))}catch(i){console.error("Error loading detail data:",i),this.errorMessage.set("\u53D6\u5F97\u660E\u7D30\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoading.set(!1)}}closeDetailModal(){this.isDetailModalOpen.set(!1),this.detailModalData.set(null),this.destroyDetailChart()}createDetailChart(e){let t=this.detailModalData();if(!e||!t||t.data.length===0)return;let i=t.data,r=i.map(d=>`${d.month}\u6708`),o=[];t.type==="\u6536\u5165"?o=["\u92B7\u8CA8\u6536\u5165","\u5176\u4ED6\u6536\u5165","-\u92B7\u8CA8\u6298\u8B93"]:t.type==="\u652F\u51FA"?o=["\u5546\u54C1","\u96DC\u9805\u8B8A\u52D5"]:t.type==="\u672A\u4ED8"?o=["\u61C9\u4ED8\u5E33\u6B3E","\u61C9\u4ED8\u88DD\u6F62\u6B3E","\u61C9\u4ED8\u85AA\u8CC7","\u61C9\u4ED8\u80A1\u6771\u56DE\u994B\u91D1","\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8"]:o=t.data[0]?.items.map(d=>d.name)||[];let s=["#4f46e5","#ef4444","#f59e0b","#10b981","#3b82f6","#8b5cf6"],a=[{label:"\u6708\u5EA6\u7E3D\u8A08",data:i.map(d=>d.total),borderColor:s[0],backgroundColor:"rgba(79, 70, 229, 0.1)",fill:!0,tension:.4,borderWidth:3,pointRadius:4}];o.forEach((d,g)=>{let y=i.map(v=>v.items.find(b=>b.name===d)?.amount||0);a.push({label:d,data:y,borderColor:s[(g+1)%s.length],backgroundColor:"transparent",fill:!1,tension:.4,borderDash:[5,5],borderWidth:2,pointRadius:3})});let c=e.nativeElement.getContext("2d");this.detailChart=new Chart(c,{type:"line",data:{labels:r,datasets:a},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!1,ticks:{callback:d=>this.formatCurrency(d)}}},plugins:{tooltip:{callbacks:{label:d=>`${d.dataset.label}: ${this.formatCurrency(d.raw)}`}}}}})}destroyDetailChart(){this.detailChart&&(this.detailChart.destroy(),this.detailChart=null)}calculateMonthlyItemTotal(e){let t=this.detailModalData();return t?t.data.reduce((i,r)=>{let o=r.items.find(s=>s.name===e);return i+(o?.amount||0)},0):0}getDetailItemAmount(e,t){let i=e.items.find(r=>r.name===t);return i?this.convertToNumber(i.amount):0}formatCurrency(e){return e==null?"NT$0":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}formatMonth(e){return`${parseInt(e.split("-")[1],10)}\u6708`}calculateColumnWidth(e){let i=this.formatCurrency(e).length;return`${Math.max(5.5,2+i*.5)}rem`}getMaxMonthColumnWidth(e){let t=6;return e.forEach(r=>{if(r!=null){let o=this.formatCurrency(r);t=Math.max(t,o.length)}}),`${Math.max(5.5,2+t*.5)}rem`}};Es.\u0275fac=function(t){return new(t||Es)},Es.\u0275cmp=ee({type:Es,selectors:[["app-financial-statements"]],viewQuery:function(t,i){if(t&1&&Cn(_5,5),t&2){let r;en(r=tn())&&(i.detailChartRef=r.first)}},decls:22,vars:12,consts:[["detailChart",""],[1,"space-y-6"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-4","flex","items-center","gap-3"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4","flex","items-center","gap-3"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"flex","flex-col","sm:flex-row","items-center","gap-2","bg-white","p-3","rounded-xl","shadow-md","border","border-gray-200"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"border-b","border-gray-200"],["aria-label","Tabs",1,"-mb-px","flex","space-x-6"],[1,"whitespace-nowrap","py-4","px-1","border-b-2","font-medium","text-sm",3,"click"],[1,"pt-6","overflow-x-auto"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50","transition-opacity"],["name","hourglass-outline",1,"text-blue-600","text-xl","animate-spin"],[1,"text-blue-700"],["name","alert-circle-outline",1,"text-red-600","text-xl"],[1,"text-red-700"],[1,"flex","items-center","gap-2"],["for","startYear",1,"text-sm","font-medium","text-gray-600"],["id","startYear",1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100","pr-8",3,"ngModelChange","ngModel"],[3,"value"],["for","endYear",1,"text-sm","font-medium","text-gray-600"],["id","endYear",1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100","pr-8",3,"ngModelChange","ngModel"],[1,"flex","items-center","gap-2","mt-2","sm:mt-0"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],["name","hourglass-outline",1,"animate-spin"],["name","filter-outline"],["for","year",1,"text-sm","font-medium","text-gray-600"],["id","year",1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100","pr-8",3,"ngModelChange","ngModel"],["for","quarter",1,"text-sm","font-medium","text-gray-600"],["id","quarter",1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100","pr-8",3,"ngModelChange","ngModel"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-center","py-8","text-gray-500"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50"],[1,"py-3","px-4"],[1,"py-3","px-4","text-right"],[1,"border-b","border-gray-100","bg-blue-50","font-semibold"],[1,"py-3","px-4","text-gray-800"],["name","folder-open-outline",1,"align-middle","mr-2"],[1,"py-3","px-4","text-right","font-medium","text-blue-600","cursor-pointer","hover:underline","hover:bg-blue-100"],[1,"py-3","px-4","text-right","font-bold"],[1,"border-b","border-gray-100","bg-red-50"],[1,"border-b","border-gray-100","bg-red-50","font-semibold"],[1,"py-3","px-4","text-right","font-medium","text-red-600","cursor-pointer","hover:underline","hover:bg-red-100"],[1,"border-b-2","border-gray-200","bg-gray-50","font-bold"],[1,"py-3","px-4","text-right",3,"text-red-600"],[1,"border-b","border-gray-100","bg-orange-50","font-semibold"],[1,"py-3","px-4","text-right","font-medium","text-orange-600","cursor-pointer","hover:underline","hover:bg-orange-100"],[1,"py-3","px-4","text-right","font-bold","hover:underline"],[1,"py-3","px-4","text-right","font-medium","text-blue-600","cursor-pointer","hover:underline","hover:bg-blue-100",3,"click"],[1,"py-3","px-4","text-gray-800","pl-8"],["name","remove-circle-outline",1,"align-middle","mr-2","text-red-500"],[1,"py-3","px-4","text-right","font-medium","text-red-600"],[1,"py-3","px-4","text-right","font-bold","text-red-600"],[1,"py-3","px-4","text-right","font-medium","text-red-600","cursor-pointer","hover:underline","hover:bg-red-100",3,"click"],[1,"py-3","px-4","text-right","font-medium","text-orange-600","cursor-pointer","hover:underline","hover:bg-orange-100",3,"click"],[1,"relative","overflow-x-auto"],[1,"py-3","px-2","w-16","sticky","left-0","bg-gray-50","z-20","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]"],[1,"py-3","px-2","w-24","sticky","bg-gray-50","z-20","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","4rem"],[1,"py-3","px-2","w-20","text-right","tabular-nums","sticky","bg-gray-50","z-20","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","10rem"],[1,"py-3","px-2","w-12","text-right","tabular-nums","sticky","bg-gray-50","z-20","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","16rem"],[1,"py-3","px-2","text-right","text-xs","w-fit"],[1,"font-semibold","text-gray-800","bg-gray-100"],["colspan","4",1,"py-2","px-2","sticky","left-0","bg-gray-100","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]"],[1,"border-b","border-gray-100","hover:bg-gray-50"],[1,"font-semibold","text-gray-900","bg-gray-50","border-t-2","border-gray-200"],["colspan","2",1,"py-2","px-2","sticky","left-0","bg-gray-50","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]"],[1,"py-2","px-2","text-right","tabular-nums","font-medium","sticky","bg-gray-50","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","10rem"],[1,"py-2","px-2","text-right","tabular-nums","sticky","bg-gray-50","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","16rem"],[1,"py-2","px-2","text-right","text-xs","font-semibold","w-fit"],[1,"py-2"],[1,"font-bold","text-base","text-white","bg-indigo-600"],["colspan","2",1,"py-3","px-2","sticky","left-0","bg-indigo-600","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.3)]"],[1,"py-3","px-2","text-right","tabular-nums","sticky","bg-indigo-600","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.3)]",2,"left","10rem"],[1,"py-3","px-2","sticky","bg-indigo-600","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.3)]",2,"left","16rem"],[1,"py-3","px-2","text-right","text-xs","font-bold","w-fit"],[1,"py-2","px-2","sticky","left-0","bg-white","hover:bg-gray-50","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]"],[1,"py-2","px-2","sticky","bg-white","hover:bg-gray-50","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","4rem"],[1,"py-2","px-2","text-right","tabular-nums","font-medium","sticky","bg-white","hover:bg-gray-50","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","10rem"],[1,"py-2","px-2","text-right","tabular-nums","sticky","bg-white","hover:bg-gray-50","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","16rem"],[1,"py-2","px-2","text-right","text-xs","w-fit"],[1,"py-2","px-2","text-right","tabular-nums","font-bold","text-indigo-600","sticky","bg-gray-50","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","10rem"],[1,"font-semibold","text-gray-900","border-t-2","border-gray-200"],["colspan","2",1,"py-2","px-2","sticky","left-0","bg-white","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]"],[1,"py-2","px-2","text-right","tabular-nums","font-medium","sticky","bg-white","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","10rem"],[1,"py-2","px-2","text-right","tabular-nums","sticky","bg-white","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","16rem"],[1,"py-2","px-2","text-right","text-xs","font-bold","w-fit"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-6xl","max-h-[90vh]","flex","flex-col","m-4"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600","p-1","rounded-full","hover:bg-gray-100",3,"click"],["name","close-outline",1,"text-2xl"],[1,"flex-1","flex","flex-col","p-6","overflow-hidden"],[1,"h-64","mb-6"],[1,"flex-1","overflow-y-auto"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50","sticky","top-0"],[1,"font-bold","bg-gray-100","sticky","bottom-0"],[1,"border-t-2"],[1,"px-4","py-2"],[1,"px-4","py-2","text-right"],[1,"border-b","hover:bg-gray-50"],[1,"px-4","py-2","font-medium"],[1,"px-4","py-2","text-right","font-semibold"],[1,"px-4","py-2","text-right","text-red-600"],[1,"px-4","py-3"],[1,"px-4","py-3","text-right"],[1,"px-4","py-3","text-right","text-red-600"]],template:function(t,i){if(t&1&&(l(0,"div",1),P(1,x5,4,0,"div",2),P(2,E5,4,1,"div",3),l(3,"div",4)(4,"h1",5),m(5,"\u8CA1\u52D9\u5831\u8868"),u(),P(6,T5,19,4,"div",6),P(7,R5,19,4,"div",6),u(),l(8,"div",7)(9,"div",8)(10,"nav",9)(11,"button",10),S("click",function(){return i.setActiveStatement("summary")}),m(12," \u7E3D\u8868 "),u(),l(13,"button",10),S("click",function(){return i.setActiveStatement("income")}),m(14," \u640D\u76CA\u8868 "),u(),l(15,"button",10),S("click",function(){return i.setActiveStatement("balance")}),m(16," \u8CC7\u7522\u8CA0\u50B5\u8868 "),u()()(),l(17,"div",11),P(18,H5,2,1)(19,X5,2,1)(20,mP,2,1),u()()(),P(21,FP,2,1,"div",12)),t&2){let r;h(),F(i.isLoading()?1:-1),h(),F(i.errorMessage()?2:-1),h(4),F(i.activeStatement()==="summary"?6:-1),h(),F(i.activeStatement()==="income"||i.activeStatement()==="balance"?7:-1),h(4),De(i.activeStatement()==="summary"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),h(2),De(i.activeStatement()==="income"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),h(2),De(i.activeStatement()==="balance"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),h(3),F((r=i.activeStatement())==="summary"?18:r==="income"?19:r==="balance"?20:-1),h(3),F(i.isDetailModalOpen()?21:-1)}},dependencies:[oe,Ee,Fe,ke,Ae,ge,we],encapsulation:2,changeDetection:0});var lf=Es;var kP,OP;function VP(){return{geminiUrl:kP,vertexUrl:OP}}function LP(n,e,t,i){var r,o;if(!n?.baseUrl){let s=VP();return e?(r=s.vertexUrl)!==null&&r!==void 0?r:t:(o=s.geminiUrl)!==null&&o!==void 0?o:i}return n.baseUrl}var ri=class{};function K(n,e){let t=/\{([^}]+)\}/g;return n.replace(t,(i,r)=>{if(Object.prototype.hasOwnProperty.call(e,r)){let o=e[r];return o!=null?String(o):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function p(n,e,t){for(let o=0;o<e.length-1;o++){let s=e[o];if(s.endsWith("[]")){let a=s.slice(0,-2);if(!(a in n))if(Array.isArray(t))n[a]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${s}`);if(Array.isArray(n[a])){let c=n[a];if(Array.isArray(t))for(let d=0;d<c.length;d++){let g=c[d];p(g,e.slice(o+1),t[d])}else for(let d of c)p(d,e.slice(o+1),t)}return}else if(s.endsWith("[0]")){let a=s.slice(0,-3);a in n||(n[a]=[{}]);let c=n[a];p(c[0],e.slice(o+1),t);return}(!n[s]||typeof n[s]!="object")&&(n[s]={}),n=n[s]}let i=e[e.length-1],r=n[i];if(r!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===r)return;if(typeof r=="object"&&typeof t=="object"&&r!==null&&t!==null)Object.assign(r,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[i]=t}function f(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let i=0;i<e.length;i++){if(typeof n!="object"||n===null)return t;let r=e[i];if(r.endsWith("[]")){let o=r.slice(0,-2);if(o in n){let s=n[o];return Array.isArray(s)?s.map(a=>f(a,e.slice(i+1),t)):t}else return t}else n=n[r]}return n}catch(i){if(i instanceof TypeError)return t;throw i}}function BP(n,e){for(let[t,i]of Object.entries(e)){let r=t.split("."),o=i.split("."),s=new Set,a=-1;for(let c=0;c<r.length;c++)if(r[c]==="*"){a=c;break}if(a!==-1&&o.length>a)for(let c=a;c<o.length;c++){let d=o[c];d!=="*"&&!d.endsWith("[]")&&!d.endsWith("[0]")&&s.add(d)}Wh(n,r,o,0,s)}}function Wh(n,e,t,i,r){if(i>=e.length||typeof n!="object"||n===null)return;let o=e[i];if(o.endsWith("[]")){let s=o.slice(0,-2),a=n;if(s in a&&Array.isArray(a[s]))for(let c of a[s])Wh(c,e,t,i+1,r)}else if(o==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){let s=n,a=Object.keys(s).filter(d=>!d.startsWith("_")&&!r.has(d)),c={};for(let d of a)c[d]=s[d];for(let[d,g]of Object.entries(c)){let y=[];for(let v of t.slice(i))v==="*"?y.push(d):y.push(v);p(s,y,g)}for(let d of a)delete s[d]}}else{let s=n;o in s&&Wh(s[o],e,t,i+1,r)}}function Gy(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}function UP(n){let e={},t=f(n,["operationName"]);t!=null&&p(e,["operationName"],t);let i=f(n,["resourceName"]);return i!=null&&p(e,["_url","resourceName"],i),e}function $P(n){let e={},t=f(n,["name"]);t!=null&&p(e,["name"],t);let i=f(n,["metadata"]);i!=null&&p(e,["metadata"],i);let r=f(n,["done"]);r!=null&&p(e,["done"],r);let o=f(n,["error"]);o!=null&&p(e,["error"],o);let s=f(n,["response","generateVideoResponse"]);return s!=null&&p(e,["response"],GP(s)),e}function HP(n){let e={},t=f(n,["name"]);t!=null&&p(e,["name"],t);let i=f(n,["metadata"]);i!=null&&p(e,["metadata"],i);let r=f(n,["done"]);r!=null&&p(e,["done"],r);let o=f(n,["error"]);o!=null&&p(e,["error"],o);let s=f(n,["response"]);return s!=null&&p(e,["response"],qP(s)),e}function GP(n){let e={},t=f(n,["generatedSamples"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(s=>WP(s))),p(e,["generatedVideos"],o)}let i=f(n,["raiMediaFilteredCount"]);i!=null&&p(e,["raiMediaFilteredCount"],i);let r=f(n,["raiMediaFilteredReasons"]);return r!=null&&p(e,["raiMediaFilteredReasons"],r),e}function qP(n){let e={},t=f(n,["videos"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(s=>jP(s))),p(e,["generatedVideos"],o)}let i=f(n,["raiMediaFilteredCount"]);i!=null&&p(e,["raiMediaFilteredCount"],i);let r=f(n,["raiMediaFilteredReasons"]);return r!=null&&p(e,["raiMediaFilteredReasons"],r),e}function WP(n){let e={},t=f(n,["video"]);return t!=null&&p(e,["video"],ZP(t)),e}function jP(n){let e={},t=f(n,["_self"]);return t!=null&&p(e,["video"],XP(t)),e}function zP(n){let e={},t=f(n,["operationName"]);return t!=null&&p(e,["_url","operationName"],t),e}function YP(n){let e={},t=f(n,["operationName"]);return t!=null&&p(e,["_url","operationName"],t),e}function JP(n){let e={},t=f(n,["name"]);t!=null&&p(e,["name"],t);let i=f(n,["metadata"]);i!=null&&p(e,["metadata"],i);let r=f(n,["done"]);r!=null&&p(e,["done"],r);let o=f(n,["error"]);o!=null&&p(e,["error"],o);let s=f(n,["response"]);return s!=null&&p(e,["response"],KP(s)),e}function KP(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["parent"]);i!=null&&p(e,["parent"],i);let r=f(n,["documentName"]);return r!=null&&p(e,["documentName"],r),e}function X2(n){let e={},t=f(n,["name"]);t!=null&&p(e,["name"],t);let i=f(n,["metadata"]);i!=null&&p(e,["metadata"],i);let r=f(n,["done"]);r!=null&&p(e,["done"],r);let o=f(n,["error"]);o!=null&&p(e,["error"],o);let s=f(n,["response"]);return s!=null&&p(e,["response"],QP(s)),e}function QP(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["parent"]);i!=null&&p(e,["parent"],i);let r=f(n,["documentName"]);return r!=null&&p(e,["documentName"],r),e}function ZP(n){let e={},t=f(n,["uri"]);t!=null&&p(e,["uri"],t);let i=f(n,["encodedVideo"]);i!=null&&p(e,["videoBytes"],Gy(i));let r=f(n,["encoding"]);return r!=null&&p(e,["mimeType"],r),e}function XP(n){let e={},t=f(n,["gcsUri"]);t!=null&&p(e,["uri"],t);let i=f(n,["bytesBase64Encoded"]);i!=null&&p(e,["videoBytes"],Gy(i));let r=f(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}var lt=(function(n){return n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL",n})(lt||{});var jh=(function(n){return n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO",n})(jh||{});var eb=(function(n){return n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED",n})(eb||{});var tb=(function(n){return n.COLLECTION="COLLECTION",n})(tb||{});var Ul=(function(n){return n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT",n})(Ul||{});var Hl=class{constructor(e){let t={};for(let i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}};var uo=class{get text(){var e,t,i,r,o,s,a,c;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",g=!1,y=[];for(let v of(c=(a=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)!==null&&c!==void 0?c:[]){for(let[_,b]of Object.entries(v))_!=="text"&&_!=="thought"&&_!=="thoughtSignature"&&(b!==null||b!==void 0)&&y.push(_);if(typeof v.text=="string"){if(typeof v.thought=="boolean"&&v.thought)continue;g=!0,d+=v.text}}return y.length>0&&console.warn(`there are non-text parts ${y} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),g?d:void 0}get data(){var e,t,i,r,o,s,a,c;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="",g=[];for(let y of(c=(a=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)!==null&&c!==void 0?c:[]){for(let[v,_]of Object.entries(y))v!=="inlineData"&&(_!==null||_!==void 0)&&g.push(v);y.inlineData&&typeof y.inlineData.data=="string"&&(d+=atob(y.inlineData.data))}return g.length>0&&console.warn(`there are non-data parts ${g} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var e,t,i,r,o,s,a,c;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");let d=(c=(a=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(g=>g.functionCall).map(g=>g.functionCall).filter(g=>g!==void 0);if(d?.length!==0)return d}get executableCode(){var e,t,i,r,o,s,a,c,d;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");let g=(c=(a=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(y=>y.executableCode).map(y=>y.executableCode).filter(y=>y!==void 0);if(g?.length!==0)return(d=g?.[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var e,t,i,r,o,s,a,c,d;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");let g=(c=(a=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(y=>y.codeExecutionResult).map(y=>y.codeExecutionResult).filter(y=>y!==void 0);if(g?.length!==0)return(d=g?.[0])===null||d===void 0?void 0:d.output}},yf=class{},vf=class{},zh=class{},Yh=class{},Jh=class{},Kh=class{},_f=class{},Cf=class{},xf=class{},Qh=class{};var Ef=class n{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){let i=new n,r,o=e;return t?r=HP(o):r=$P(o),Object.assign(i,r),i}},bf=class{},Sf=class{},Df=class{},wf=class{},Zh=class{},Xh=class{},ey=class{};var ty=class n{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){let i=new n,o=JP(e);return Object.assign(i,o),i}},ny=class{},iy=class{},ry=class{};var Tf=class{};var oy=class{get text(){var e,t,i;let r="",o=!1,s=[];for(let a of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(let[c,d]of Object.entries(a))c!=="text"&&c!=="thought"&&d!==null&&s.push(c);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;o=!0,r+=a.text}}return s.length>0&&console.warn(`there are non-text parts ${s} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?r:void 0}get data(){var e,t,i;let r="",o=[];for(let s of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(let[a,c]of Object.entries(s))a!=="inlineData"&&c!==null&&o.push(a);s.inlineData&&typeof s.inlineData.data=="string"&&(r+=atob(s.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),r.length>0?btoa(r):void 0}};var sy=class{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}};var ay=class n{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){let i=new n,o=X2(e);return Object.assign(i,o),i}};function Oe(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){let t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function nb(n,e){let t=Oe(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function ib(n){return Array.isArray(n)?n.map(e=>If(e)):[If(n)]}function If(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function rb(n){let e=If(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function ob(n){let e=If(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function I2(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function sb(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>I2(e)):[I2(n)]}function ly(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function M2(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function A2(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function Yt(n){if(n==null)throw new Error("ContentUnion is required");return ly(n)?n:{role:"user",parts:sb(n)}}function qy(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{let i=Yt(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){let t=Yt(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Yt(t)):[Yt(e)]}function Bn(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(M2(n)||A2(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Yt(n)]}let e=[],t=[],i=ly(n[0]);for(let r of n){let o=ly(r);if(o!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)e.push(r);else{if(M2(r)||A2(r))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(r)}}return i||e.push({role:"user",parts:sb(t)}),e}function e6(n,e){n.includes("null")&&(e.nullable=!0);let t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(lt).includes(t[0].toUpperCase())?t[0].toUpperCase():lt.TYPE_UNSPECIFIED;else{e.anyOf=[];for(let i of t)e.anyOf.push({type:Object.values(lt).includes(i.toUpperCase())?i.toUpperCase():lt.TYPE_UNSPECIFIED})}}function Ss(n){let e={},t=["items"],i=["anyOf"],r=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");let o=n.anyOf;o!=null&&o.length==2&&(o[0].type==="null"?(e.nullable=!0,n=o[1]):o[1].type==="null"&&(e.nullable=!0,n=o[0])),n.type instanceof Array&&e6(n.type,e);for(let[s,a]of Object.entries(n))if(a!=null)if(s=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(lt).includes(a.toUpperCase())?a.toUpperCase():lt.TYPE_UNSPECIFIED}else if(t.includes(s))e[s]=Ss(a);else if(i.includes(s)){let c=[];for(let d of a){if(d.type=="null"){e.nullable=!0;continue}c.push(Ss(d))}e[s]=c}else if(r.includes(s)){let c={};for(let[d,g]of Object.entries(a))c[d]=Ss(g);e[s]=c}else{if(s==="additionalProperties")continue;e[s]=a}return e}function Wy(n){return Ss(n)}function jy(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function zy(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function Is(n){if(n.functionDeclarations)for(let e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Ss(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Ss(e.response));return n}function Ms(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");let e=[];for(let t of n)e.push(t);return e}function t6(n,e,t,i=1){let r=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:r?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:r?`${t}/${e}`:e}function Wi(n,e){if(typeof e!="string")throw new Error("name must be a string");return t6(n,e,"cachedContents")}function ab(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function yr(n){return Gy(n)}function n6(n){return n!=null&&typeof n=="object"&&"name"in n}function i6(n){return n!=null&&typeof n=="object"&&"video"in n}function r6(n){return n!=null&&typeof n=="object"&&"uri"in n}function lb(n){var e;let t;if(n6(n)&&(t=n.name),!(r6(n)&&(t=n.uri,t===void 0))&&!(i6(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){let r=t.split("files/")[1].match(/[a-z0-9]+/);if(r===null)throw new Error(`Could not extract file name from URI ${t}`);t=r[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function ub(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function cb(n){for(let e of["models","tunedModels","publisherModels"])if(o6(n,e))return n[e];return[]}function o6(n,e){return n!==null&&typeof n=="object"&&e in n}function s6(n,e={}){let t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(i.responseJsonSchema=t.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function a6(n,e={}){let t=[],i=new Set;for(let r of n){let o=r.name;if(i.has(o))throw new Error(`Duplicate function name ${o} found in MCP tools. Please ensure function names are unique.`);i.add(o);let s=s6(r,e);s.functionDeclarations&&t.push(...s.functionDeclarations)}return{functionDeclarations:t}}function db(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;let i=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,r=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(r>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||r!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function l6(n){if(typeof n!="string")return n;let e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function fb(n){if(typeof n!="object"||n===null)return{};let e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;let r=t.inlinedResponses;if(!Array.isArray(r)||r.length===0)return n;let o=!1;for(let s of r){if(typeof s!="object"||s===null)continue;let c=s.response;if(typeof c!="object"||c===null)continue;if(c.embedding!==void 0){o=!0;break}}return o&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function As(n,e){let t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function mb(n){let e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}function u6(n){let e={},t=f(n,["responsesFile"]);t!=null&&p(e,["fileName"],t);let i=f(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>G6(s))),p(e,["inlinedResponses"],o)}let r=f(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>s)),p(e,["inlinedEmbedContentResponses"],o)}return e}function c6(n){let e={},t=f(n,["predictionsFormat"]);t!=null&&p(e,["format"],t);let i=f(n,["gcsDestination","outputUriPrefix"]);i!=null&&p(e,["gcsUri"],i);let r=f(n,["bigqueryDestination","outputUri"]);return r!=null&&p(e,["bigqueryUri"],r),e}function d6(n){let e={},t=f(n,["format"]);t!=null&&p(e,["predictionsFormat"],t);let i=f(n,["gcsUri"]);i!=null&&p(e,["gcsDestination","outputUriPrefix"],i);let r=f(n,["bigqueryUri"]);if(r!=null&&p(e,["bigqueryDestination","outputUri"],r),f(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(f(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function gf(n){let e={},t=f(n,["name"]);t!=null&&p(e,["name"],t);let i=f(n,["metadata","displayName"]);i!=null&&p(e,["displayName"],i);let r=f(n,["metadata","state"]);r!=null&&p(e,["state"],mb(r));let o=f(n,["metadata","createTime"]);o!=null&&p(e,["createTime"],o);let s=f(n,["metadata","endTime"]);s!=null&&p(e,["endTime"],s);let a=f(n,["metadata","updateTime"]);a!=null&&p(e,["updateTime"],a);let c=f(n,["metadata","model"]);c!=null&&p(e,["model"],c);let d=f(n,["metadata","output"]);return d!=null&&p(e,["dest"],u6(fb(d))),e}function uy(n){let e={},t=f(n,["name"]);t!=null&&p(e,["name"],t);let i=f(n,["displayName"]);i!=null&&p(e,["displayName"],i);let r=f(n,["state"]);r!=null&&p(e,["state"],mb(r));let o=f(n,["error"]);o!=null&&p(e,["error"],o);let s=f(n,["createTime"]);s!=null&&p(e,["createTime"],s);let a=f(n,["startTime"]);a!=null&&p(e,["startTime"],a);let c=f(n,["endTime"]);c!=null&&p(e,["endTime"],c);let d=f(n,["updateTime"]);d!=null&&p(e,["updateTime"],d);let g=f(n,["model"]);g!=null&&p(e,["model"],g);let y=f(n,["inputConfig"]);y!=null&&p(e,["src"],f6(y));let v=f(n,["outputConfig"]);v!=null&&p(e,["dest"],c6(fb(v)));let _=f(n,["completionStats"]);return _!=null&&p(e,["completionStats"],_),e}function f6(n){let e={},t=f(n,["instancesFormat"]);t!=null&&p(e,["format"],t);let i=f(n,["gcsSource","uris"]);i!=null&&p(e,["gcsUri"],i);let r=f(n,["bigquerySource","inputUri"]);return r!=null&&p(e,["bigqueryUri"],r),e}function m6(n,e){let t={};if(f(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(f(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");let i=f(e,["fileName"]);i!=null&&p(t,["fileName"],i);let r=f(e,["inlinedRequests"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>H6(n,s))),p(t,["requests","requests"],o)}return t}function p6(n){let e={},t=f(n,["format"]);t!=null&&p(e,["instancesFormat"],t);let i=f(n,["gcsUri"]);i!=null&&p(e,["gcsSource","uris"],i);let r=f(n,["bigqueryUri"]);if(r!=null&&p(e,["bigquerySource","inputUri"],r),f(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function g6(n){let e={},t=f(n,["data"]);if(t!=null&&p(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let i=f(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function h6(n,e){let t={},i=f(e,["name"]);return i!=null&&p(t,["_url","name"],As(n,i)),t}function y6(n,e){let t={},i=f(e,["name"]);return i!=null&&p(t,["_url","name"],As(n,i)),t}function v6(n){let e={},t=f(n,["content"]);t!=null&&p(e,["content"],t);let i=f(n,["citationMetadata"]);i!=null&&p(e,["citationMetadata"],_6(i));let r=f(n,["tokenCount"]);r!=null&&p(e,["tokenCount"],r);let o=f(n,["finishReason"]);o!=null&&p(e,["finishReason"],o);let s=f(n,["avgLogprobs"]);s!=null&&p(e,["avgLogprobs"],s);let a=f(n,["groundingMetadata"]);a!=null&&p(e,["groundingMetadata"],a);let c=f(n,["index"]);c!=null&&p(e,["index"],c);let d=f(n,["logprobsResult"]);d!=null&&p(e,["logprobsResult"],d);let g=f(n,["safetyRatings"]);if(g!=null){let v=g;Array.isArray(v)&&(v=v.map(_=>_)),p(e,["safetyRatings"],v)}let y=f(n,["urlContextMetadata"]);return y!=null&&p(e,["urlContextMetadata"],y),e}function _6(n){let e={},t=f(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),p(e,["citations"],i)}return e}function pb(n){let e={},t=f(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>K6(o))),p(e,["parts"],r)}let i=f(n,["role"]);return i!=null&&p(e,["role"],i),e}function C6(n,e){let t={},i=f(n,["displayName"]);if(e!==void 0&&i!=null&&p(e,["batch","displayName"],i),f(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function x6(n,e){let t={},i=f(n,["displayName"]);e!==void 0&&i!=null&&p(e,["displayName"],i);let r=f(n,["dest"]);return e!==void 0&&r!=null&&p(e,["outputConfig"],d6(l6(r))),t}function N2(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["_url","model"],Oe(n,i));let r=f(e,["src"]);r!=null&&p(t,["batch","inputConfig"],m6(n,db(n,r)));let o=f(e,["config"]);return o!=null&&C6(o,t),t}function E6(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["model"],Oe(n,i));let r=f(e,["src"]);r!=null&&p(t,["inputConfig"],p6(db(n,r)));let o=f(e,["config"]);return o!=null&&x6(o,t),t}function b6(n,e){let t={},i=f(n,["displayName"]);return e!==void 0&&i!=null&&p(e,["batch","displayName"],i),t}function S6(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["_url","model"],Oe(n,i));let r=f(e,["src"]);r!=null&&p(t,["batch","inputConfig"],N6(n,r));let o=f(e,["config"]);return o!=null&&b6(o,t),t}function D6(n,e){let t={},i=f(e,["name"]);return i!=null&&p(t,["_url","name"],As(n,i)),t}function w6(n,e){let t={},i=f(e,["name"]);return i!=null&&p(t,["_url","name"],As(n,i)),t}function T6(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["name"]);i!=null&&p(e,["name"],i);let r=f(n,["done"]);r!=null&&p(e,["done"],r);let o=f(n,["error"]);return o!=null&&p(e,["error"],o),e}function I6(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["name"]);i!=null&&p(e,["name"],i);let r=f(n,["done"]);r!=null&&p(e,["done"],r);let o=f(n,["error"]);return o!=null&&p(e,["error"],o),e}function M6(n,e){let t={},i=f(e,["contents"]);if(i!=null){let o=qy(n,i);Array.isArray(o)&&(o=o.map(s=>s)),p(t,["requests[]","request","content"],o)}let r=f(e,["config"]);return r!=null&&(p(t,["_self"],A6(r,t)),BP(t,{"requests[].*":"requests[].request.*"})),t}function A6(n,e){let t={},i=f(n,["taskType"]);e!==void 0&&i!=null&&p(e,["requests[]","taskType"],i);let r=f(n,["title"]);e!==void 0&&r!=null&&p(e,["requests[]","title"],r);let o=f(n,["outputDimensionality"]);if(e!==void 0&&o!=null&&p(e,["requests[]","outputDimensionality"],o),f(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function N6(n,e){let t={},i=f(e,["fileName"]);i!=null&&p(t,["file_name"],i);let r=f(e,["inlinedRequests"]);return r!=null&&p(t,["requests"],M6(n,r)),t}function R6(n){let e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let t=f(n,["fileUri"]);t!=null&&p(e,["fileUri"],t);let i=f(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function P6(n){let e={},t=f(n,["id"]);t!=null&&p(e,["id"],t);let i=f(n,["args"]);i!=null&&p(e,["args"],i);let r=f(n,["name"]);if(r!=null&&p(e,["name"],r),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function F6(n){let e={},t=f(n,["allowedFunctionNames"]);t!=null&&p(e,["allowedFunctionNames"],t);let i=f(n,["mode"]);if(i!=null&&p(e,["mode"],i),f(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function k6(n,e,t){let i={},r=f(e,["systemInstruction"]);t!==void 0&&r!=null&&p(t,["systemInstruction"],pb(Yt(r)));let o=f(e,["temperature"]);o!=null&&p(i,["temperature"],o);let s=f(e,["topP"]);s!=null&&p(i,["topP"],s);let a=f(e,["topK"]);a!=null&&p(i,["topK"],a);let c=f(e,["candidateCount"]);c!=null&&p(i,["candidateCount"],c);let d=f(e,["maxOutputTokens"]);d!=null&&p(i,["maxOutputTokens"],d);let g=f(e,["stopSequences"]);g!=null&&p(i,["stopSequences"],g);let y=f(e,["responseLogprobs"]);y!=null&&p(i,["responseLogprobs"],y);let v=f(e,["logprobs"]);v!=null&&p(i,["logprobs"],v);let _=f(e,["presencePenalty"]);_!=null&&p(i,["presencePenalty"],_);let b=f(e,["frequencyPenalty"]);b!=null&&p(i,["frequencyPenalty"],b);let I=f(e,["seed"]);I!=null&&p(i,["seed"],I);let M=f(e,["responseMimeType"]);M!=null&&p(i,["responseMimeType"],M);let A=f(e,["responseSchema"]);A!=null&&p(i,["responseSchema"],Wy(A));let B=f(e,["responseJsonSchema"]);if(B!=null&&p(i,["responseJsonSchema"],B),f(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");let G=f(e,["safetySettings"]);if(t!==void 0&&G!=null){let ut=G;Array.isArray(ut)&&(ut=ut.map(ai=>Q6(ai))),p(t,["safetySettings"],ut)}let z=f(e,["tools"]);if(t!==void 0&&z!=null){let ut=Ms(z);Array.isArray(ut)&&(ut=ut.map(ai=>X6(Is(ai)))),p(t,["tools"],ut)}let X=f(e,["toolConfig"]);if(t!==void 0&&X!=null&&p(t,["toolConfig"],Z6(X)),f(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");let ue=f(e,["cachedContent"]);t!==void 0&&ue!=null&&p(t,["cachedContent"],Wi(n,ue));let ae=f(e,["responseModalities"]);ae!=null&&p(i,["responseModalities"],ae);let Re=f(e,["mediaResolution"]);Re!=null&&p(i,["mediaResolution"],Re);let de=f(e,["speechConfig"]);if(de!=null&&p(i,["speechConfig"],jy(de)),f(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");let be=f(e,["thinkingConfig"]);be!=null&&p(i,["thinkingConfig"],be);let vt=f(e,["imageConfig"]);vt!=null&&p(i,["imageConfig"],$6(vt));let si=f(e,["enableEnhancedCivicAnswers"]);if(si!=null&&p(i,["enableEnhancedCivicAnswers"],si),f(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return i}function O6(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["candidates"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(d=>v6(d))),p(e,["candidates"],c)}let r=f(n,["modelVersion"]);r!=null&&p(e,["modelVersion"],r);let o=f(n,["promptFeedback"]);o!=null&&p(e,["promptFeedback"],o);let s=f(n,["responseId"]);s!=null&&p(e,["responseId"],s);let a=f(n,["usageMetadata"]);return a!=null&&p(e,["usageMetadata"],a),e}function V6(n,e){let t={},i=f(e,["name"]);return i!=null&&p(t,["_url","name"],As(n,i)),t}function L6(n,e){let t={},i=f(e,["name"]);return i!=null&&p(t,["_url","name"],As(n,i)),t}function B6(n){let e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");let t=f(n,["enableWidget"]);return t!=null&&p(e,["enableWidget"],t),e}function U6(n){let e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");let t=f(n,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],t),e}function $6(n){let e={},t=f(n,["aspectRatio"]);t!=null&&p(e,["aspectRatio"],t);let i=f(n,["imageSize"]);if(i!=null&&p(e,["imageSize"],i),f(n,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(f(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(f(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function H6(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["request","model"],Oe(n,i));let r=f(e,["contents"]);if(r!=null){let a=Bn(r);Array.isArray(a)&&(a=a.map(c=>pb(c))),p(t,["request","contents"],a)}let o=f(e,["metadata"]);o!=null&&p(t,["metadata"],o);let s=f(e,["config"]);return s!=null&&p(t,["request","generationConfig"],k6(n,s,f(t,["request"],{}))),t}function G6(n){let e={},t=f(n,["response"]);t!=null&&p(e,["response"],O6(t));let i=f(n,["error"]);return i!=null&&p(e,["error"],i),e}function q6(n,e){let t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&p(e,["_query","pageSize"],i);let r=f(n,["pageToken"]);if(e!==void 0&&r!=null&&p(e,["_query","pageToken"],r),f(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function W6(n,e){let t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&p(e,["_query","pageSize"],i);let r=f(n,["pageToken"]);e!==void 0&&r!=null&&p(e,["_query","pageToken"],r);let o=f(n,["filter"]);return e!==void 0&&o!=null&&p(e,["_query","filter"],o),t}function j6(n){let e={},t=f(n,["config"]);return t!=null&&q6(t,e),e}function z6(n){let e={},t=f(n,["config"]);return t!=null&&W6(t,e),e}function Y6(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["nextPageToken"]);i!=null&&p(e,["nextPageToken"],i);let r=f(n,["operations"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>gf(s))),p(e,["batchJobs"],o)}return e}function J6(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["nextPageToken"]);i!=null&&p(e,["nextPageToken"],i);let r=f(n,["batchPredictionJobs"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>uy(s))),p(e,["batchJobs"],o)}return e}function K6(n){let e={},t=f(n,["mediaResolution"]);t!=null&&p(e,["mediaResolution"],t);let i=f(n,["codeExecutionResult"]);i!=null&&p(e,["codeExecutionResult"],i);let r=f(n,["executableCode"]);r!=null&&p(e,["executableCode"],r);let o=f(n,["fileData"]);o!=null&&p(e,["fileData"],R6(o));let s=f(n,["functionCall"]);s!=null&&p(e,["functionCall"],P6(s));let a=f(n,["functionResponse"]);a!=null&&p(e,["functionResponse"],a);let c=f(n,["inlineData"]);c!=null&&p(e,["inlineData"],g6(c));let d=f(n,["text"]);d!=null&&p(e,["text"],d);let g=f(n,["thought"]);g!=null&&p(e,["thought"],g);let y=f(n,["thoughtSignature"]);y!=null&&p(e,["thoughtSignature"],y);let v=f(n,["videoMetadata"]);return v!=null&&p(e,["videoMetadata"],v),e}function Q6(n){let e={},t=f(n,["category"]);if(t!=null&&p(e,["category"],t),f(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");let i=f(n,["threshold"]);return i!=null&&p(e,["threshold"],i),e}function Z6(n){let e={},t=f(n,["retrievalConfig"]);t!=null&&p(e,["retrievalConfig"],t);let i=f(n,["functionCallingConfig"]);return i!=null&&p(e,["functionCallingConfig"],F6(i)),e}function X6(n){let e={};if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");let t=f(n,["computerUse"]);t!=null&&p(e,["computerUse"],t);let i=f(n,["fileSearch"]);i!=null&&p(e,["fileSearch"],i);let r=f(n,["codeExecution"]);if(r!=null&&p(e,["codeExecution"],r),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");let o=f(n,["functionDeclarations"]);if(o!=null){let g=o;Array.isArray(g)&&(g=g.map(y=>y)),p(e,["functionDeclarations"],g)}let s=f(n,["googleMaps"]);s!=null&&p(e,["googleMaps"],B6(s));let a=f(n,["googleSearch"]);a!=null&&p(e,["googleSearch"],U6(a));let c=f(n,["googleSearchRetrieval"]);c!=null&&p(e,["googleSearchRetrieval"],c);let d=f(n,["urlContext"]);return d!=null&&p(e,["urlContext"],d),e}var vr=(function(n){return n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents",n})(vr||{}),qi=class{constructor(e,t,i,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,r)}init(e,t,i){var r,o;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t?.sdkHttpResponse,this.idxInternal=0;let s={config:{}};!i||Object.keys(i).length===0?s={config:{}}:typeof i=="object"?s=Object.assign({},i):s=i,s.config&&(s.config.pageToken=t.nextPageToken),this.paramsInternal=s,this.pageInternalSize=(o=(r=s.config)===null||r===void 0?void 0:r.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};let e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");let e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}};var cy=class extends ri{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new qi(vr.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)}}createInlinedGenerateContentRequest(e){let t=N2(this.apiClient,e),i=t._url,r=K("{model}:batchGenerateContent",i),a=t.batch.inputConfig.requests,c=a.requests,d=[];for(let g of c){let y=Object.assign({},g);if(y.systemInstruction){let v=y.systemInstruction;delete y.systemInstruction;let _=y.request;_.systemInstruction=v,y.request=_}d.push(y)}return a.requests=d,delete t.config,delete t._url,delete t._query,{path:r,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){let i=t?Object.assign({},t):{},r=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${r}`),i.dest===void 0){let o=this.getGcsUri(e),s=this.getBigqueryUri(e);if(o)o.endsWith(".jsonl")?i.dest=`${o.slice(0,-6)}/dest`:i.dest=`${o}_dest_${r}`;else if(s)i.dest=`${s}_dest_${r}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var t,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){let d=E6(this.apiClient,e);return a=K("batchPredictionJobs",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),s.then(g=>uy(g))}else{let d=N2(this.apiClient,e);return a=K("{model}:batchGenerateContent",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),s.then(g=>gf(g))}}async createEmbeddingsInternal(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=S6(this.apiClient,e);return o=K("{model}:asyncBatchEmbedContent",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>gf(c))}}async get(e){var t,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){let d=L6(this.apiClient,e);return a=K("batchPredictionJobs/{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),s.then(g=>uy(g))}else{let d=V6(this.apiClient,e);return a=K("batches/{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),s.then(g=>gf(g))}}async cancel(e){var t,i,r,o;let s="",a={};if(this.apiClient.isVertexAI()){let c=y6(this.apiClient,e);s=K("batchPredictionJobs/{name}:cancel",c._url),a=c._query,delete c._url,delete c._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{let c=h6(this.apiClient,e);s=K("batches/{name}:cancel",c._url),a=c._query,delete c._url,delete c._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var t,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){let d=z6(e);return a=K("batchPredictionJobs",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>{let y=J6(g),v=new Tf;return Object.assign(v,y),v})}else{let d=j6(e);return a=K("batches",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>{let y=Y6(g),v=new Tf;return Object.assign(v,y),v})}}async delete(e){var t,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){let d=w6(this.apiClient,e);return a=K("batchPredictionJobs/{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>I6(g))}else{let d=D6(this.apiClient,e);return a=K("batches/{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>T6(g))}}};function eF(n){let e={},t=f(n,["data"]);if(t!=null&&p(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let i=f(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function R2(n){let e={},t=f(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>bF(o))),p(e,["parts"],r)}let i=f(n,["role"]);return i!=null&&p(e,["role"],i),e}function tF(n,e){let t={},i=f(n,["ttl"]);e!==void 0&&i!=null&&p(e,["ttl"],i);let r=f(n,["expireTime"]);e!==void 0&&r!=null&&p(e,["expireTime"],r);let o=f(n,["displayName"]);e!==void 0&&o!=null&&p(e,["displayName"],o);let s=f(n,["contents"]);if(e!==void 0&&s!=null){let g=Bn(s);Array.isArray(g)&&(g=g.map(y=>R2(y))),p(e,["contents"],g)}let a=f(n,["systemInstruction"]);e!==void 0&&a!=null&&p(e,["systemInstruction"],R2(Yt(a)));let c=f(n,["tools"]);if(e!==void 0&&c!=null){let g=c;Array.isArray(g)&&(g=g.map(y=>DF(y))),p(e,["tools"],g)}let d=f(n,["toolConfig"]);if(e!==void 0&&d!=null&&p(e,["toolConfig"],SF(d)),f(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function nF(n,e){let t={},i=f(n,["ttl"]);e!==void 0&&i!=null&&p(e,["ttl"],i);let r=f(n,["expireTime"]);e!==void 0&&r!=null&&p(e,["expireTime"],r);let o=f(n,["displayName"]);e!==void 0&&o!=null&&p(e,["displayName"],o);let s=f(n,["contents"]);if(e!==void 0&&s!=null){let y=Bn(s);Array.isArray(y)&&(y=y.map(v=>v)),p(e,["contents"],y)}let a=f(n,["systemInstruction"]);e!==void 0&&a!=null&&p(e,["systemInstruction"],Yt(a));let c=f(n,["tools"]);if(e!==void 0&&c!=null){let y=c;Array.isArray(y)&&(y=y.map(v=>wF(v))),p(e,["tools"],y)}let d=f(n,["toolConfig"]);e!==void 0&&d!=null&&p(e,["toolConfig"],d);let g=f(n,["kmsKeyName"]);return e!==void 0&&g!=null&&p(e,["encryption_spec","kmsKeyName"],g),t}function iF(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["model"],nb(n,i));let r=f(e,["config"]);return r!=null&&tF(r,t),t}function rF(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["model"],nb(n,i));let r=f(e,["config"]);return r!=null&&nF(r,t),t}function oF(n,e){let t={},i=f(e,["name"]);return i!=null&&p(t,["_url","name"],Wi(n,i)),t}function sF(n,e){let t={},i=f(e,["name"]);return i!=null&&p(t,["_url","name"],Wi(n,i)),t}function aF(n){let e={},t=f(n,["sdkHttpResponse"]);return t!=null&&p(e,["sdkHttpResponse"],t),e}function lF(n){let e={},t=f(n,["sdkHttpResponse"]);return t!=null&&p(e,["sdkHttpResponse"],t),e}function uF(n){let e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let t=f(n,["fileUri"]);t!=null&&p(e,["fileUri"],t);let i=f(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function cF(n){let e={},t=f(n,["id"]);t!=null&&p(e,["id"],t);let i=f(n,["args"]);i!=null&&p(e,["args"],i);let r=f(n,["name"]);if(r!=null&&p(e,["name"],r),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function dF(n){let e={},t=f(n,["allowedFunctionNames"]);t!=null&&p(e,["allowedFunctionNames"],t);let i=f(n,["mode"]);if(i!=null&&p(e,["mode"],i),f(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function fF(n){let e={},t=f(n,["description"]);t!=null&&p(e,["description"],t);let i=f(n,["name"]);i!=null&&p(e,["name"],i);let r=f(n,["parameters"]);r!=null&&p(e,["parameters"],r);let o=f(n,["parametersJsonSchema"]);o!=null&&p(e,["parametersJsonSchema"],o);let s=f(n,["response"]);s!=null&&p(e,["response"],s);let a=f(n,["responseJsonSchema"]);if(a!=null&&p(e,["responseJsonSchema"],a),f(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function mF(n,e){let t={},i=f(e,["name"]);return i!=null&&p(t,["_url","name"],Wi(n,i)),t}function pF(n,e){let t={},i=f(e,["name"]);return i!=null&&p(t,["_url","name"],Wi(n,i)),t}function gF(n){let e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");let t=f(n,["enableWidget"]);return t!=null&&p(e,["enableWidget"],t),e}function hF(n){let e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");let t=f(n,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],t),e}function yF(n,e){let t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&p(e,["_query","pageSize"],i);let r=f(n,["pageToken"]);return e!==void 0&&r!=null&&p(e,["_query","pageToken"],r),t}function vF(n,e){let t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&p(e,["_query","pageSize"],i);let r=f(n,["pageToken"]);return e!==void 0&&r!=null&&p(e,["_query","pageToken"],r),t}function _F(n){let e={},t=f(n,["config"]);return t!=null&&yF(t,e),e}function CF(n){let e={},t=f(n,["config"]);return t!=null&&vF(t,e),e}function xF(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["nextPageToken"]);i!=null&&p(e,["nextPageToken"],i);let r=f(n,["cachedContents"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>s)),p(e,["cachedContents"],o)}return e}function EF(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["nextPageToken"]);i!=null&&p(e,["nextPageToken"],i);let r=f(n,["cachedContents"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>s)),p(e,["cachedContents"],o)}return e}function bF(n){let e={},t=f(n,["mediaResolution"]);t!=null&&p(e,["mediaResolution"],t);let i=f(n,["codeExecutionResult"]);i!=null&&p(e,["codeExecutionResult"],i);let r=f(n,["executableCode"]);r!=null&&p(e,["executableCode"],r);let o=f(n,["fileData"]);o!=null&&p(e,["fileData"],uF(o));let s=f(n,["functionCall"]);s!=null&&p(e,["functionCall"],cF(s));let a=f(n,["functionResponse"]);a!=null&&p(e,["functionResponse"],a);let c=f(n,["inlineData"]);c!=null&&p(e,["inlineData"],eF(c));let d=f(n,["text"]);d!=null&&p(e,["text"],d);let g=f(n,["thought"]);g!=null&&p(e,["thought"],g);let y=f(n,["thoughtSignature"]);y!=null&&p(e,["thoughtSignature"],y);let v=f(n,["videoMetadata"]);return v!=null&&p(e,["videoMetadata"],v),e}function SF(n){let e={},t=f(n,["retrievalConfig"]);t!=null&&p(e,["retrievalConfig"],t);let i=f(n,["functionCallingConfig"]);return i!=null&&p(e,["functionCallingConfig"],dF(i)),e}function DF(n){let e={};if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");let t=f(n,["computerUse"]);t!=null&&p(e,["computerUse"],t);let i=f(n,["fileSearch"]);i!=null&&p(e,["fileSearch"],i);let r=f(n,["codeExecution"]);if(r!=null&&p(e,["codeExecution"],r),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");let o=f(n,["functionDeclarations"]);if(o!=null){let g=o;Array.isArray(g)&&(g=g.map(y=>y)),p(e,["functionDeclarations"],g)}let s=f(n,["googleMaps"]);s!=null&&p(e,["googleMaps"],gF(s));let a=f(n,["googleSearch"]);a!=null&&p(e,["googleSearch"],hF(a));let c=f(n,["googleSearchRetrieval"]);c!=null&&p(e,["googleSearchRetrieval"],c);let d=f(n,["urlContext"]);return d!=null&&p(e,["urlContext"],d),e}function wF(n){let e={},t=f(n,["retrieval"]);t!=null&&p(e,["retrieval"],t);let i=f(n,["computerUse"]);if(i!=null&&p(e,["computerUse"],i),f(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");let r=f(n,["codeExecution"]);r!=null&&p(e,["codeExecution"],r);let o=f(n,["enterpriseWebSearch"]);o!=null&&p(e,["enterpriseWebSearch"],o);let s=f(n,["functionDeclarations"]);if(s!=null){let y=s;Array.isArray(y)&&(y=y.map(v=>fF(v))),p(e,["functionDeclarations"],y)}let a=f(n,["googleMaps"]);a!=null&&p(e,["googleMaps"],a);let c=f(n,["googleSearch"]);c!=null&&p(e,["googleSearch"],c);let d=f(n,["googleSearchRetrieval"]);d!=null&&p(e,["googleSearchRetrieval"],d);let g=f(n,["urlContext"]);return g!=null&&p(e,["urlContext"],g),e}function TF(n,e){let t={},i=f(n,["ttl"]);e!==void 0&&i!=null&&p(e,["ttl"],i);let r=f(n,["expireTime"]);return e!==void 0&&r!=null&&p(e,["expireTime"],r),t}function IF(n,e){let t={},i=f(n,["ttl"]);e!==void 0&&i!=null&&p(e,["ttl"],i);let r=f(n,["expireTime"]);return e!==void 0&&r!=null&&p(e,["expireTime"],r),t}function MF(n,e){let t={},i=f(e,["name"]);i!=null&&p(t,["_url","name"],Wi(n,i));let r=f(e,["config"]);return r!=null&&TF(r,t),t}function AF(n,e){let t={},i=f(e,["name"]);i!=null&&p(t,["_url","name"],Wi(n,i));let r=f(e,["config"]);return r!=null&&IF(r,t),t}var dy=class extends ri{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new qi(vr.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){let d=rF(this.apiClient,e);return a=K("cachedContents",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),s.then(g=>g)}else{let d=iF(this.apiClient,e);return a=K("cachedContents",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),s.then(g=>g)}}async get(e){var t,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){let d=pF(this.apiClient,e);return a=K("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),s.then(g=>g)}else{let d=mF(this.apiClient,e);return a=K("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),s.then(g=>g)}}async delete(e){var t,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){let d=sF(this.apiClient,e);return a=K("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>{let y=lF(g),v=new Df;return Object.assign(v,y),v})}else{let d=oF(this.apiClient,e);return a=K("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>{let y=aF(g),v=new Df;return Object.assign(v,y),v})}}async update(e){var t,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){let d=AF(this.apiClient,e);return a=K("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),s.then(g=>g)}else{let d=MF(this.apiClient,e);return a=K("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),s.then(g=>g)}}async listInternal(e){var t,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){let d=CF(e);return a=K("cachedContents",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>{let y=EF(g),v=new wf;return Object.assign(v,y),v})}else{let d=_F(e);return a=K("cachedContents",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>{let y=xF(g),v=new wf;return Object.assign(v,y),v})}}};function Mf(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t}function P2(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ye(n){return this instanceof ye?(this.v=n,this):new ye(n)}function ni(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,o=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),r[Symbol.asyncIterator]=function(){return this},r;function s(_){return function(b){return Promise.resolve(b).then(_,y)}}function a(_,b){i[_]&&(r[_]=function(I){return new Promise(function(M,A){o.push([_,I,M,A])>1||c(_,I)})},b&&(r[_]=b(r[_])))}function c(_,b){try{d(i[_](b))}catch(I){v(o[0][3],I)}}function d(_){_.value instanceof ye?Promise.resolve(_.value.v).then(g,y):v(o[0][2],_)}function g(_){c("next",_)}function y(_){c("throw",_)}function v(_,b){_(b),o.shift(),o.length&&c(o[0][0],o[0][1])}}function ii(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof P2=="function"?P2(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=n[o]&&function(s){return new Promise(function(a,c){s=n[o](s),r(a,c,s.done,s.value)})}}function r(o,s,a,c){Promise.resolve(c).then(function(d){o({value:d,done:a})},s)}}function NF(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;let t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:gb(t)}function gb(n){if(n.parts===void 0||n.parts.length===0)return!1;for(let e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function RF(n){if(n.length!==0){for(let e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function F2(n){if(n===void 0||n.length===0)return[];let e=[],t=n.length,i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{let r=[],o=!0;for(;i<t&&n[i].role==="model";)r.push(n[i]),o&&!gb(n[i])&&(o=!1),i++;o?e.push(...r):e.pop()}return e}var fy=class{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new my(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}},my=class{constructor(e,t,i,r={},o=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=r,this.history=o,this.sendPromise=Promise.resolve(),RF(o)}async sendMessage(e){var t;await this.sendPromise;let i=Yt(e.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var o,s,a;let c=await r,d=(s=(o=c.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content,g=c.automaticFunctionCallingHistory,y=this.getHistory(!0).length,v=[];g!=null&&(v=(a=g.slice(y))!==null&&a!==void 0?a:[]);let _=d?[d]:[];this.recordHistory(i,_,v)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),r}async sendMessageStream(e){var t;await this.sendPromise;let i=Yt(e.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=r.then(()=>{}).catch(()=>{});let o=await r;return this.processStreamResponse(o,i)}getHistory(e=!1){let t=e?F2(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return ni(this,arguments,function*(){var r,o,s,a,c,d;let g=[];try{for(var y=!0,v=ii(e),_;_=yield ye(v.next()),r=_.done,!r;y=!0){a=_.value,y=!1;let b=a;if(NF(b)){let I=(d=(c=b.candidates)===null||c===void 0?void 0:c[0])===null||d===void 0?void 0:d.content;I!==void 0&&g.push(I)}yield yield ye(b)}}catch(b){o={error:b}}finally{try{!y&&!r&&(s=v.return)&&(yield ye(s.call(v)))}finally{if(o)throw o.error}}this.recordHistory(t,g)})}recordHistory(e,t,i){let r=[];t.length>0&&t.every(o=>o.role!==void 0)?r=t:r.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...F2(i)):this.history.push(e),this.history.push(...r)}};var Gl=class n extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,n.prototype)}};function PF(n){let e={},t=f(n,["file"]);return t!=null&&p(e,["file"],t),e}function FF(n){let e={},t=f(n,["sdkHttpResponse"]);return t!=null&&p(e,["sdkHttpResponse"],t),e}function kF(n){let e={},t=f(n,["name"]);return t!=null&&p(e,["_url","file"],lb(t)),e}function OF(n){let e={},t=f(n,["sdkHttpResponse"]);return t!=null&&p(e,["sdkHttpResponse"],t),e}function VF(n){let e={},t=f(n,["name"]);return t!=null&&p(e,["_url","file"],lb(t)),e}function LF(n,e){let t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&p(e,["_query","pageSize"],i);let r=f(n,["pageToken"]);return e!==void 0&&r!=null&&p(e,["_query","pageToken"],r),t}function BF(n){let e={},t=f(n,["config"]);return t!=null&&LF(t,e),e}function UF(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["nextPageToken"]);i!=null&&p(e,["nextPageToken"],i);let r=f(n,["files"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>s)),p(e,["files"],o)}return e}var py=class extends ri{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new qi(vr.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=BF(e);return o=K("files",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(d=>{let g=d;return g.sdkHttpResponse={headers:c.headers},g})),r.then(c=>{let d=UF(c),g=new ny;return Object.assign(g,d),g})}}async createInternal(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=PF(e);return o=K("upload/v1beta/files",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{let d=FF(c),g=new iy;return Object.assign(g,d),g})}}async get(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=VF(e);return o=K("files/{file}",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>c)}}async delete(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=kF(e);return o=K("files/{file}",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(d=>{let g=d;return g.sdkHttpResponse={headers:c.headers},g})),r.then(c=>{let d=OF(c),g=new ry;return Object.assign(g,d),g})}}};function hf(n){let e={},t=f(n,["data"]);if(t!=null&&p(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let i=f(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function $F(n){let e={},t=f(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>i3(o))),p(e,["parts"],r)}let i=f(n,["role"]);return i!=null&&p(e,["role"],i),e}function HF(n){let e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let t=f(n,["fileUri"]);t!=null&&p(e,["fileUri"],t);let i=f(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function GF(n){let e={},t=f(n,["id"]);t!=null&&p(e,["id"],t);let i=f(n,["args"]);i!=null&&p(e,["args"],i);let r=f(n,["name"]);if(r!=null&&p(e,["name"],r),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function qF(n){let e={},t=f(n,["description"]);t!=null&&p(e,["description"],t);let i=f(n,["name"]);i!=null&&p(e,["name"],i);let r=f(n,["parameters"]);r!=null&&p(e,["parameters"],r);let o=f(n,["parametersJsonSchema"]);o!=null&&p(e,["parametersJsonSchema"],o);let s=f(n,["response"]);s!=null&&p(e,["response"],s);let a=f(n,["responseJsonSchema"]);if(a!=null&&p(e,["responseJsonSchema"],a),f(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function WF(n){let e={},t=f(n,["modelSelectionConfig"]);t!=null&&p(e,["modelConfig"],t);let i=f(n,["responseJsonSchema"]);i!=null&&p(e,["responseJsonSchema"],i);let r=f(n,["audioTimestamp"]);r!=null&&p(e,["audioTimestamp"],r);let o=f(n,["candidateCount"]);o!=null&&p(e,["candidateCount"],o);let s=f(n,["enableAffectiveDialog"]);s!=null&&p(e,["enableAffectiveDialog"],s);let a=f(n,["frequencyPenalty"]);a!=null&&p(e,["frequencyPenalty"],a);let c=f(n,["logprobs"]);c!=null&&p(e,["logprobs"],c);let d=f(n,["maxOutputTokens"]);d!=null&&p(e,["maxOutputTokens"],d);let g=f(n,["mediaResolution"]);g!=null&&p(e,["mediaResolution"],g);let y=f(n,["presencePenalty"]);y!=null&&p(e,["presencePenalty"],y);let v=f(n,["responseLogprobs"]);v!=null&&p(e,["responseLogprobs"],v);let _=f(n,["responseMimeType"]);_!=null&&p(e,["responseMimeType"],_);let b=f(n,["responseModalities"]);b!=null&&p(e,["responseModalities"],b);let I=f(n,["responseSchema"]);I!=null&&p(e,["responseSchema"],I);let M=f(n,["routingConfig"]);M!=null&&p(e,["routingConfig"],M);let A=f(n,["seed"]);A!=null&&p(e,["seed"],A);let B=f(n,["speechConfig"]);B!=null&&p(e,["speechConfig"],B);let G=f(n,["stopSequences"]);G!=null&&p(e,["stopSequences"],G);let z=f(n,["temperature"]);z!=null&&p(e,["temperature"],z);let X=f(n,["thinkingConfig"]);X!=null&&p(e,["thinkingConfig"],X);let ue=f(n,["topK"]);ue!=null&&p(e,["topK"],ue);let ae=f(n,["topP"]);if(ae!=null&&p(e,["topP"],ae),f(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function jF(n){let e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");let t=f(n,["enableWidget"]);return t!=null&&p(e,["enableWidget"],t),e}function zF(n){let e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");let t=f(n,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],t),e}function YF(n,e){let t={},i=f(n,["generationConfig"]);e!==void 0&&i!=null&&p(e,["setup","generationConfig"],i);let r=f(n,["responseModalities"]);e!==void 0&&r!=null&&p(e,["setup","generationConfig","responseModalities"],r);let o=f(n,["temperature"]);e!==void 0&&o!=null&&p(e,["setup","generationConfig","temperature"],o);let s=f(n,["topP"]);e!==void 0&&s!=null&&p(e,["setup","generationConfig","topP"],s);let a=f(n,["topK"]);e!==void 0&&a!=null&&p(e,["setup","generationConfig","topK"],a);let c=f(n,["maxOutputTokens"]);e!==void 0&&c!=null&&p(e,["setup","generationConfig","maxOutputTokens"],c);let d=f(n,["mediaResolution"]);e!==void 0&&d!=null&&p(e,["setup","generationConfig","mediaResolution"],d);let g=f(n,["seed"]);e!==void 0&&g!=null&&p(e,["setup","generationConfig","seed"],g);let y=f(n,["speechConfig"]);e!==void 0&&y!=null&&p(e,["setup","generationConfig","speechConfig"],zy(y));let v=f(n,["thinkingConfig"]);e!==void 0&&v!=null&&p(e,["setup","generationConfig","thinkingConfig"],v);let _=f(n,["enableAffectiveDialog"]);e!==void 0&&_!=null&&p(e,["setup","generationConfig","enableAffectiveDialog"],_);let b=f(n,["systemInstruction"]);e!==void 0&&b!=null&&p(e,["setup","systemInstruction"],$F(Yt(b)));let I=f(n,["tools"]);if(e!==void 0&&I!=null){let ue=Ms(I);Array.isArray(ue)&&(ue=ue.map(ae=>o3(Is(ae)))),p(e,["setup","tools"],ue)}let M=f(n,["sessionResumption"]);e!==void 0&&M!=null&&p(e,["setup","sessionResumption"],r3(M));let A=f(n,["inputAudioTranscription"]);e!==void 0&&A!=null&&p(e,["setup","inputAudioTranscription"],A);let B=f(n,["outputAudioTranscription"]);e!==void 0&&B!=null&&p(e,["setup","outputAudioTranscription"],B);let G=f(n,["realtimeInputConfig"]);e!==void 0&&G!=null&&p(e,["setup","realtimeInputConfig"],G);let z=f(n,["contextWindowCompression"]);e!==void 0&&z!=null&&p(e,["setup","contextWindowCompression"],z);let X=f(n,["proactivity"]);if(e!==void 0&&X!=null&&p(e,["setup","proactivity"],X),f(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function JF(n,e){let t={},i=f(n,["generationConfig"]);e!==void 0&&i!=null&&p(e,["setup","generationConfig"],WF(i));let r=f(n,["responseModalities"]);e!==void 0&&r!=null&&p(e,["setup","generationConfig","responseModalities"],r);let o=f(n,["temperature"]);e!==void 0&&o!=null&&p(e,["setup","generationConfig","temperature"],o);let s=f(n,["topP"]);e!==void 0&&s!=null&&p(e,["setup","generationConfig","topP"],s);let a=f(n,["topK"]);e!==void 0&&a!=null&&p(e,["setup","generationConfig","topK"],a);let c=f(n,["maxOutputTokens"]);e!==void 0&&c!=null&&p(e,["setup","generationConfig","maxOutputTokens"],c);let d=f(n,["mediaResolution"]);e!==void 0&&d!=null&&p(e,["setup","generationConfig","mediaResolution"],d);let g=f(n,["seed"]);e!==void 0&&g!=null&&p(e,["setup","generationConfig","seed"],g);let y=f(n,["speechConfig"]);e!==void 0&&y!=null&&p(e,["setup","generationConfig","speechConfig"],zy(y));let v=f(n,["thinkingConfig"]);e!==void 0&&v!=null&&p(e,["setup","generationConfig","thinkingConfig"],v);let _=f(n,["enableAffectiveDialog"]);e!==void 0&&_!=null&&p(e,["setup","generationConfig","enableAffectiveDialog"],_);let b=f(n,["systemInstruction"]);e!==void 0&&b!=null&&p(e,["setup","systemInstruction"],Yt(b));let I=f(n,["tools"]);if(e!==void 0&&I!=null){let ae=Ms(I);Array.isArray(ae)&&(ae=ae.map(Re=>s3(Is(Re)))),p(e,["setup","tools"],ae)}let M=f(n,["sessionResumption"]);e!==void 0&&M!=null&&p(e,["setup","sessionResumption"],M);let A=f(n,["inputAudioTranscription"]);e!==void 0&&A!=null&&p(e,["setup","inputAudioTranscription"],A);let B=f(n,["outputAudioTranscription"]);e!==void 0&&B!=null&&p(e,["setup","outputAudioTranscription"],B);let G=f(n,["realtimeInputConfig"]);e!==void 0&&G!=null&&p(e,["setup","realtimeInputConfig"],G);let z=f(n,["contextWindowCompression"]);e!==void 0&&z!=null&&p(e,["setup","contextWindowCompression"],z);let X=f(n,["proactivity"]);e!==void 0&&X!=null&&p(e,["setup","proactivity"],X);let ue=f(n,["explicitVadSignal"]);return e!==void 0&&ue!=null&&p(e,["setup","explicitVadSignal"],ue),t}function KF(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["setup","model"],Oe(n,i));let r=f(e,["config"]);return r!=null&&p(t,["config"],YF(r,t)),t}function QF(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["setup","model"],Oe(n,i));let r=f(e,["config"]);return r!=null&&p(t,["config"],JF(r,t)),t}function ZF(n){let e={},t=f(n,["musicGenerationConfig"]);return t!=null&&p(e,["musicGenerationConfig"],t),e}function XF(n){let e={},t=f(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),p(e,["weightedPrompts"],i)}return e}function e3(n){let e={},t=f(n,["media"]);if(t!=null){let d=ib(t);Array.isArray(d)&&(d=d.map(g=>hf(g))),p(e,["mediaChunks"],d)}let i=f(n,["audio"]);i!=null&&p(e,["audio"],hf(ob(i)));let r=f(n,["audioStreamEnd"]);r!=null&&p(e,["audioStreamEnd"],r);let o=f(n,["video"]);o!=null&&p(e,["video"],hf(rb(o)));let s=f(n,["text"]);s!=null&&p(e,["text"],s);let a=f(n,["activityStart"]);a!=null&&p(e,["activityStart"],a);let c=f(n,["activityEnd"]);return c!=null&&p(e,["activityEnd"],c),e}function t3(n){let e={},t=f(n,["media"]);if(t!=null){let d=ib(t);Array.isArray(d)&&(d=d.map(g=>g)),p(e,["mediaChunks"],d)}let i=f(n,["audio"]);i!=null&&p(e,["audio"],ob(i));let r=f(n,["audioStreamEnd"]);r!=null&&p(e,["audioStreamEnd"],r);let o=f(n,["video"]);o!=null&&p(e,["video"],rb(o));let s=f(n,["text"]);s!=null&&p(e,["text"],s);let a=f(n,["activityStart"]);a!=null&&p(e,["activityStart"],a);let c=f(n,["activityEnd"]);return c!=null&&p(e,["activityEnd"],c),e}function n3(n){let e={},t=f(n,["setupComplete"]);t!=null&&p(e,["setupComplete"],t);let i=f(n,["serverContent"]);i!=null&&p(e,["serverContent"],i);let r=f(n,["toolCall"]);r!=null&&p(e,["toolCall"],r);let o=f(n,["toolCallCancellation"]);o!=null&&p(e,["toolCallCancellation"],o);let s=f(n,["usageMetadata"]);s!=null&&p(e,["usageMetadata"],a3(s));let a=f(n,["goAway"]);a!=null&&p(e,["goAway"],a);let c=f(n,["sessionResumptionUpdate"]);c!=null&&p(e,["sessionResumptionUpdate"],c);let d=f(n,["voiceActivityDetectionSignal"]);d!=null&&p(e,["voiceActivityDetectionSignal"],d);let g=f(n,["voiceActivity"]);return g!=null&&p(e,["voiceActivity"],l3(g)),e}function i3(n){let e={},t=f(n,["mediaResolution"]);t!=null&&p(e,["mediaResolution"],t);let i=f(n,["codeExecutionResult"]);i!=null&&p(e,["codeExecutionResult"],i);let r=f(n,["executableCode"]);r!=null&&p(e,["executableCode"],r);let o=f(n,["fileData"]);o!=null&&p(e,["fileData"],HF(o));let s=f(n,["functionCall"]);s!=null&&p(e,["functionCall"],GF(s));let a=f(n,["functionResponse"]);a!=null&&p(e,["functionResponse"],a);let c=f(n,["inlineData"]);c!=null&&p(e,["inlineData"],hf(c));let d=f(n,["text"]);d!=null&&p(e,["text"],d);let g=f(n,["thought"]);g!=null&&p(e,["thought"],g);let y=f(n,["thoughtSignature"]);y!=null&&p(e,["thoughtSignature"],y);let v=f(n,["videoMetadata"]);return v!=null&&p(e,["videoMetadata"],v),e}function r3(n){let e={},t=f(n,["handle"]);if(t!=null&&p(e,["handle"],t),f(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function o3(n){let e={};if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");let t=f(n,["computerUse"]);t!=null&&p(e,["computerUse"],t);let i=f(n,["fileSearch"]);i!=null&&p(e,["fileSearch"],i);let r=f(n,["codeExecution"]);if(r!=null&&p(e,["codeExecution"],r),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");let o=f(n,["functionDeclarations"]);if(o!=null){let g=o;Array.isArray(g)&&(g=g.map(y=>y)),p(e,["functionDeclarations"],g)}let s=f(n,["googleMaps"]);s!=null&&p(e,["googleMaps"],jF(s));let a=f(n,["googleSearch"]);a!=null&&p(e,["googleSearch"],zF(a));let c=f(n,["googleSearchRetrieval"]);c!=null&&p(e,["googleSearchRetrieval"],c);let d=f(n,["urlContext"]);return d!=null&&p(e,["urlContext"],d),e}function s3(n){let e={},t=f(n,["retrieval"]);t!=null&&p(e,["retrieval"],t);let i=f(n,["computerUse"]);if(i!=null&&p(e,["computerUse"],i),f(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");let r=f(n,["codeExecution"]);r!=null&&p(e,["codeExecution"],r);let o=f(n,["enterpriseWebSearch"]);o!=null&&p(e,["enterpriseWebSearch"],o);let s=f(n,["functionDeclarations"]);if(s!=null){let y=s;Array.isArray(y)&&(y=y.map(v=>qF(v))),p(e,["functionDeclarations"],y)}let a=f(n,["googleMaps"]);a!=null&&p(e,["googleMaps"],a);let c=f(n,["googleSearch"]);c!=null&&p(e,["googleSearch"],c);let d=f(n,["googleSearchRetrieval"]);d!=null&&p(e,["googleSearchRetrieval"],d);let g=f(n,["urlContext"]);return g!=null&&p(e,["urlContext"],g),e}function a3(n){let e={},t=f(n,["promptTokenCount"]);t!=null&&p(e,["promptTokenCount"],t);let i=f(n,["cachedContentTokenCount"]);i!=null&&p(e,["cachedContentTokenCount"],i);let r=f(n,["candidatesTokenCount"]);r!=null&&p(e,["responseTokenCount"],r);let o=f(n,["toolUsePromptTokenCount"]);o!=null&&p(e,["toolUsePromptTokenCount"],o);let s=f(n,["thoughtsTokenCount"]);s!=null&&p(e,["thoughtsTokenCount"],s);let a=f(n,["totalTokenCount"]);a!=null&&p(e,["totalTokenCount"],a);let c=f(n,["promptTokensDetails"]);if(c!=null){let _=c;Array.isArray(_)&&(_=_.map(b=>b)),p(e,["promptTokensDetails"],_)}let d=f(n,["cacheTokensDetails"]);if(d!=null){let _=d;Array.isArray(_)&&(_=_.map(b=>b)),p(e,["cacheTokensDetails"],_)}let g=f(n,["candidatesTokensDetails"]);if(g!=null){let _=g;Array.isArray(_)&&(_=_.map(b=>b)),p(e,["responseTokensDetails"],_)}let y=f(n,["toolUsePromptTokensDetails"]);if(y!=null){let _=y;Array.isArray(_)&&(_=_.map(b=>b)),p(e,["toolUsePromptTokensDetails"],_)}let v=f(n,["trafficType"]);return v!=null&&p(e,["trafficType"],v),e}function l3(n){let e={},t=f(n,["type"]);return t!=null&&p(e,["voiceActivityType"],t),e}function u3(n){let e={},t=f(n,["data"]);if(t!=null&&p(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let i=f(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function c3(n){let e={},t=f(n,["content"]);t!=null&&p(e,["content"],t);let i=f(n,["citationMetadata"]);i!=null&&p(e,["citationMetadata"],d3(i));let r=f(n,["tokenCount"]);r!=null&&p(e,["tokenCount"],r);let o=f(n,["finishReason"]);o!=null&&p(e,["finishReason"],o);let s=f(n,["avgLogprobs"]);s!=null&&p(e,["avgLogprobs"],s);let a=f(n,["groundingMetadata"]);a!=null&&p(e,["groundingMetadata"],a);let c=f(n,["index"]);c!=null&&p(e,["index"],c);let d=f(n,["logprobsResult"]);d!=null&&p(e,["logprobsResult"],d);let g=f(n,["safetyRatings"]);if(g!=null){let v=g;Array.isArray(v)&&(v=v.map(_=>_)),p(e,["safetyRatings"],v)}let y=f(n,["urlContextMetadata"]);return y!=null&&p(e,["urlContextMetadata"],y),e}function d3(n){let e={},t=f(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),p(e,["citations"],i)}return e}function f3(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["_url","model"],Oe(n,i));let r=f(e,["contents"]);if(r!=null){let o=Bn(r);Array.isArray(o)&&(o=o.map(s=>s)),p(t,["contents"],o)}return t}function m3(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["tokensInfo"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>o)),p(e,["tokensInfo"],r)}return e}function p3(n){let e={},t=f(n,["values"]);t!=null&&p(e,["values"],t);let i=f(n,["statistics"]);return i!=null&&p(e,["statistics"],g3(i)),e}function g3(n){let e={},t=f(n,["truncated"]);t!=null&&p(e,["truncated"],t);let i=f(n,["token_count"]);return i!=null&&p(e,["tokenCount"],i),e}function qf(n){let e={},t=f(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>S4(o))),p(e,["parts"],r)}let i=f(n,["role"]);return i!=null&&p(e,["role"],i),e}function h3(n){let e={},t=f(n,["controlType"]);t!=null&&p(e,["controlType"],t);let i=f(n,["enableControlImageComputation"]);return i!=null&&p(e,["computeControl"],i),e}function y3(n){let e={};if(f(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(f(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(f(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function v3(n,e){let t={},i=f(n,["systemInstruction"]);e!==void 0&&i!=null&&p(e,["systemInstruction"],Yt(i));let r=f(n,["tools"]);if(e!==void 0&&r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>_b(a))),p(e,["tools"],s)}let o=f(n,["generationConfig"]);return e!==void 0&&o!=null&&p(e,["generationConfig"],u4(o)),t}function _3(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["_url","model"],Oe(n,i));let r=f(e,["contents"]);if(r!=null){let s=Bn(r);Array.isArray(s)&&(s=s.map(a=>qf(a))),p(t,["contents"],s)}let o=f(e,["config"]);return o!=null&&y3(o),t}function C3(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["_url","model"],Oe(n,i));let r=f(e,["contents"]);if(r!=null){let s=Bn(r);Array.isArray(s)&&(s=s.map(a=>a)),p(t,["contents"],s)}let o=f(e,["config"]);return o!=null&&v3(o,t),t}function x3(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["totalTokens"]);i!=null&&p(e,["totalTokens"],i);let r=f(n,["cachedContentTokenCount"]);return r!=null&&p(e,["cachedContentTokenCount"],r),e}function E3(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["totalTokens"]);return i!=null&&p(e,["totalTokens"],i),e}function b3(n,e){let t={},i=f(e,["model"]);return i!=null&&p(t,["_url","name"],Oe(n,i)),t}function S3(n,e){let t={},i=f(e,["model"]);return i!=null&&p(t,["_url","name"],Oe(n,i)),t}function D3(n){let e={},t=f(n,["sdkHttpResponse"]);return t!=null&&p(e,["sdkHttpResponse"],t),e}function w3(n){let e={},t=f(n,["sdkHttpResponse"]);return t!=null&&p(e,["sdkHttpResponse"],t),e}function T3(n,e){let t={},i=f(n,["outputGcsUri"]);e!==void 0&&i!=null&&p(e,["parameters","storageUri"],i);let r=f(n,["negativePrompt"]);e!==void 0&&r!=null&&p(e,["parameters","negativePrompt"],r);let o=f(n,["numberOfImages"]);e!==void 0&&o!=null&&p(e,["parameters","sampleCount"],o);let s=f(n,["aspectRatio"]);e!==void 0&&s!=null&&p(e,["parameters","aspectRatio"],s);let a=f(n,["guidanceScale"]);e!==void 0&&a!=null&&p(e,["parameters","guidanceScale"],a);let c=f(n,["seed"]);e!==void 0&&c!=null&&p(e,["parameters","seed"],c);let d=f(n,["safetyFilterLevel"]);e!==void 0&&d!=null&&p(e,["parameters","safetySetting"],d);let g=f(n,["personGeneration"]);e!==void 0&&g!=null&&p(e,["parameters","personGeneration"],g);let y=f(n,["includeSafetyAttributes"]);e!==void 0&&y!=null&&p(e,["parameters","includeSafetyAttributes"],y);let v=f(n,["includeRaiReason"]);e!==void 0&&v!=null&&p(e,["parameters","includeRaiReason"],v);let _=f(n,["language"]);e!==void 0&&_!=null&&p(e,["parameters","language"],_);let b=f(n,["outputMimeType"]);e!==void 0&&b!=null&&p(e,["parameters","outputOptions","mimeType"],b);let I=f(n,["outputCompressionQuality"]);e!==void 0&&I!=null&&p(e,["parameters","outputOptions","compressionQuality"],I);let M=f(n,["addWatermark"]);e!==void 0&&M!=null&&p(e,["parameters","addWatermark"],M);let A=f(n,["labels"]);e!==void 0&&A!=null&&p(e,["labels"],A);let B=f(n,["editMode"]);e!==void 0&&B!=null&&p(e,["parameters","editMode"],B);let G=f(n,["baseSteps"]);return e!==void 0&&G!=null&&p(e,["parameters","editConfig","baseSteps"],G),t}function I3(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["_url","model"],Oe(n,i));let r=f(e,["prompt"]);r!=null&&p(t,["instances[0]","prompt"],r);let o=f(e,["referenceImages"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(c=>A4(c))),p(t,["instances[0]","referenceImages"],a)}let s=f(e,["config"]);return s!=null&&T3(s,t),t}function M3(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>Wf(o))),p(e,["generatedImages"],r)}return e}function A3(n,e){let t={},i=f(n,["taskType"]);e!==void 0&&i!=null&&p(e,["requests[]","taskType"],i);let r=f(n,["title"]);e!==void 0&&r!=null&&p(e,["requests[]","title"],r);let o=f(n,["outputDimensionality"]);if(e!==void 0&&o!=null&&p(e,["requests[]","outputDimensionality"],o),f(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function N3(n,e){let t={},i=f(n,["taskType"]);e!==void 0&&i!=null&&p(e,["instances[]","task_type"],i);let r=f(n,["title"]);e!==void 0&&r!=null&&p(e,["instances[]","title"],r);let o=f(n,["outputDimensionality"]);e!==void 0&&o!=null&&p(e,["parameters","outputDimensionality"],o);let s=f(n,["mimeType"]);e!==void 0&&s!=null&&p(e,["instances[]","mimeType"],s);let a=f(n,["autoTruncate"]);return e!==void 0&&a!=null&&p(e,["parameters","autoTruncate"],a),t}function R3(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["_url","model"],Oe(n,i));let r=f(e,["contents"]);if(r!=null){let a=qy(n,r);Array.isArray(a)&&(a=a.map(c=>c)),p(t,["requests[]","content"],a)}let o=f(e,["config"]);o!=null&&A3(o,t);let s=f(e,["model"]);return s!==void 0&&p(t,["requests[]","model"],Oe(n,s)),t}function P3(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["_url","model"],Oe(n,i));let r=f(e,["contents"]);if(r!=null){let s=qy(n,r);Array.isArray(s)&&(s=s.map(a=>a)),p(t,["instances[]","content"],s)}let o=f(e,["config"]);return o!=null&&N3(o,t),t}function F3(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["embeddings"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>s)),p(e,["embeddings"],o)}let r=f(n,["metadata"]);return r!=null&&p(e,["metadata"],r),e}function k3(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["predictions[]","embeddings"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>p3(s))),p(e,["embeddings"],o)}let r=f(n,["metadata"]);return r!=null&&p(e,["metadata"],r),e}function O3(n){let e={},t=f(n,["endpoint"]);t!=null&&p(e,["name"],t);let i=f(n,["deployedModelId"]);return i!=null&&p(e,["deployedModelId"],i),e}function V3(n){let e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let t=f(n,["fileUri"]);t!=null&&p(e,["fileUri"],t);let i=f(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function L3(n){let e={},t=f(n,["id"]);t!=null&&p(e,["id"],t);let i=f(n,["args"]);i!=null&&p(e,["args"],i);let r=f(n,["name"]);if(r!=null&&p(e,["name"],r),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function B3(n){let e={},t=f(n,["allowedFunctionNames"]);t!=null&&p(e,["allowedFunctionNames"],t);let i=f(n,["mode"]);if(i!=null&&p(e,["mode"],i),f(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function U3(n){let e={},t=f(n,["description"]);t!=null&&p(e,["description"],t);let i=f(n,["name"]);i!=null&&p(e,["name"],i);let r=f(n,["parameters"]);r!=null&&p(e,["parameters"],r);let o=f(n,["parametersJsonSchema"]);o!=null&&p(e,["parametersJsonSchema"],o);let s=f(n,["response"]);s!=null&&p(e,["response"],s);let a=f(n,["responseJsonSchema"]);if(a!=null&&p(e,["responseJsonSchema"],a),f(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function $3(n,e,t){let i={},r=f(e,["systemInstruction"]);t!==void 0&&r!=null&&p(t,["systemInstruction"],qf(Yt(r)));let o=f(e,["temperature"]);o!=null&&p(i,["temperature"],o);let s=f(e,["topP"]);s!=null&&p(i,["topP"],s);let a=f(e,["topK"]);a!=null&&p(i,["topK"],a);let c=f(e,["candidateCount"]);c!=null&&p(i,["candidateCount"],c);let d=f(e,["maxOutputTokens"]);d!=null&&p(i,["maxOutputTokens"],d);let g=f(e,["stopSequences"]);g!=null&&p(i,["stopSequences"],g);let y=f(e,["responseLogprobs"]);y!=null&&p(i,["responseLogprobs"],y);let v=f(e,["logprobs"]);v!=null&&p(i,["logprobs"],v);let _=f(e,["presencePenalty"]);_!=null&&p(i,["presencePenalty"],_);let b=f(e,["frequencyPenalty"]);b!=null&&p(i,["frequencyPenalty"],b);let I=f(e,["seed"]);I!=null&&p(i,["seed"],I);let M=f(e,["responseMimeType"]);M!=null&&p(i,["responseMimeType"],M);let A=f(e,["responseSchema"]);A!=null&&p(i,["responseSchema"],Wy(A));let B=f(e,["responseJsonSchema"]);if(B!=null&&p(i,["responseJsonSchema"],B),f(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");let G=f(e,["safetySettings"]);if(t!==void 0&&G!=null){let ut=G;Array.isArray(ut)&&(ut=ut.map(ai=>N4(ai))),p(t,["safetySettings"],ut)}let z=f(e,["tools"]);if(t!==void 0&&z!=null){let ut=Ms(z);Array.isArray(ut)&&(ut=ut.map(ai=>L4(Is(ai)))),p(t,["tools"],ut)}let X=f(e,["toolConfig"]);if(t!==void 0&&X!=null&&p(t,["toolConfig"],V4(X)),f(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");let ue=f(e,["cachedContent"]);t!==void 0&&ue!=null&&p(t,["cachedContent"],Wi(n,ue));let ae=f(e,["responseModalities"]);ae!=null&&p(i,["responseModalities"],ae);let Re=f(e,["mediaResolution"]);Re!=null&&p(i,["mediaResolution"],Re);let de=f(e,["speechConfig"]);if(de!=null&&p(i,["speechConfig"],jy(de)),f(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");let be=f(e,["thinkingConfig"]);be!=null&&p(i,["thinkingConfig"],be);let vt=f(e,["imageConfig"]);vt!=null&&p(i,["imageConfig"],p4(vt));let si=f(e,["enableEnhancedCivicAnswers"]);if(si!=null&&p(i,["enableEnhancedCivicAnswers"],si),f(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return i}function H3(n,e,t){let i={},r=f(e,["systemInstruction"]);t!==void 0&&r!=null&&p(t,["systemInstruction"],Yt(r));let o=f(e,["temperature"]);o!=null&&p(i,["temperature"],o);let s=f(e,["topP"]);s!=null&&p(i,["topP"],s);let a=f(e,["topK"]);a!=null&&p(i,["topK"],a);let c=f(e,["candidateCount"]);c!=null&&p(i,["candidateCount"],c);let d=f(e,["maxOutputTokens"]);d!=null&&p(i,["maxOutputTokens"],d);let g=f(e,["stopSequences"]);g!=null&&p(i,["stopSequences"],g);let y=f(e,["responseLogprobs"]);y!=null&&p(i,["responseLogprobs"],y);let v=f(e,["logprobs"]);v!=null&&p(i,["logprobs"],v);let _=f(e,["presencePenalty"]);_!=null&&p(i,["presencePenalty"],_);let b=f(e,["frequencyPenalty"]);b!=null&&p(i,["frequencyPenalty"],b);let I=f(e,["seed"]);I!=null&&p(i,["seed"],I);let M=f(e,["responseMimeType"]);M!=null&&p(i,["responseMimeType"],M);let A=f(e,["responseSchema"]);A!=null&&p(i,["responseSchema"],Wy(A));let B=f(e,["responseJsonSchema"]);B!=null&&p(i,["responseJsonSchema"],B);let G=f(e,["routingConfig"]);G!=null&&p(i,["routingConfig"],G);let z=f(e,["modelSelectionConfig"]);z!=null&&p(i,["modelConfig"],z);let X=f(e,["safetySettings"]);if(t!==void 0&&X!=null){let Si=X;Array.isArray(Si)&&(Si=Si.map(xm=>xm)),p(t,["safetySettings"],Si)}let ue=f(e,["tools"]);if(t!==void 0&&ue!=null){let Si=Ms(ue);Array.isArray(Si)&&(Si=Si.map(xm=>_b(Is(xm)))),p(t,["tools"],Si)}let ae=f(e,["toolConfig"]);t!==void 0&&ae!=null&&p(t,["toolConfig"],ae);let Re=f(e,["labels"]);t!==void 0&&Re!=null&&p(t,["labels"],Re);let de=f(e,["cachedContent"]);t!==void 0&&de!=null&&p(t,["cachedContent"],Wi(n,de));let be=f(e,["responseModalities"]);be!=null&&p(i,["responseModalities"],be);let vt=f(e,["mediaResolution"]);vt!=null&&p(i,["mediaResolution"],vt);let si=f(e,["speechConfig"]);si!=null&&p(i,["speechConfig"],jy(si));let ut=f(e,["audioTimestamp"]);ut!=null&&p(i,["audioTimestamp"],ut);let ai=f(e,["thinkingConfig"]);ai!=null&&p(i,["thinkingConfig"],ai);let Qy=f(e,["imageConfig"]);if(Qy!=null&&p(i,["imageConfig"],g4(Qy)),f(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");let Zy=f(e,["modelArmorConfig"]);return t!==void 0&&Zy!=null&&p(t,["modelArmorConfig"],Zy),i}function k2(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["_url","model"],Oe(n,i));let r=f(e,["contents"]);if(r!=null){let s=Bn(r);Array.isArray(s)&&(s=s.map(a=>qf(a))),p(t,["contents"],s)}let o=f(e,["config"]);return o!=null&&p(t,["generationConfig"],$3(n,o,t)),t}function O2(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["_url","model"],Oe(n,i));let r=f(e,["contents"]);if(r!=null){let s=Bn(r);Array.isArray(s)&&(s=s.map(a=>a)),p(t,["contents"],s)}let o=f(e,["config"]);return o!=null&&p(t,["generationConfig"],H3(n,o,t)),t}function V2(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["candidates"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(d=>c3(d))),p(e,["candidates"],c)}let r=f(n,["modelVersion"]);r!=null&&p(e,["modelVersion"],r);let o=f(n,["promptFeedback"]);o!=null&&p(e,["promptFeedback"],o);let s=f(n,["responseId"]);s!=null&&p(e,["responseId"],s);let a=f(n,["usageMetadata"]);return a!=null&&p(e,["usageMetadata"],a),e}function L2(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["candidates"]);if(i!=null){let d=i;Array.isArray(d)&&(d=d.map(g=>g)),p(e,["candidates"],d)}let r=f(n,["createTime"]);r!=null&&p(e,["createTime"],r);let o=f(n,["modelVersion"]);o!=null&&p(e,["modelVersion"],o);let s=f(n,["promptFeedback"]);s!=null&&p(e,["promptFeedback"],s);let a=f(n,["responseId"]);a!=null&&p(e,["responseId"],a);let c=f(n,["usageMetadata"]);return c!=null&&p(e,["usageMetadata"],c),e}function G3(n,e){let t={};if(f(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");let i=f(n,["numberOfImages"]);e!==void 0&&i!=null&&p(e,["parameters","sampleCount"],i);let r=f(n,["aspectRatio"]);e!==void 0&&r!=null&&p(e,["parameters","aspectRatio"],r);let o=f(n,["guidanceScale"]);if(e!==void 0&&o!=null&&p(e,["parameters","guidanceScale"],o),f(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");let s=f(n,["safetyFilterLevel"]);e!==void 0&&s!=null&&p(e,["parameters","safetySetting"],s);let a=f(n,["personGeneration"]);e!==void 0&&a!=null&&p(e,["parameters","personGeneration"],a);let c=f(n,["includeSafetyAttributes"]);e!==void 0&&c!=null&&p(e,["parameters","includeSafetyAttributes"],c);let d=f(n,["includeRaiReason"]);e!==void 0&&d!=null&&p(e,["parameters","includeRaiReason"],d);let g=f(n,["language"]);e!==void 0&&g!=null&&p(e,["parameters","language"],g);let y=f(n,["outputMimeType"]);e!==void 0&&y!=null&&p(e,["parameters","outputOptions","mimeType"],y);let v=f(n,["outputCompressionQuality"]);if(e!==void 0&&v!=null&&p(e,["parameters","outputOptions","compressionQuality"],v),f(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(f(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");let _=f(n,["imageSize"]);if(e!==void 0&&_!=null&&p(e,["parameters","sampleImageSize"],_),f(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function q3(n,e){let t={},i=f(n,["outputGcsUri"]);e!==void 0&&i!=null&&p(e,["parameters","storageUri"],i);let r=f(n,["negativePrompt"]);e!==void 0&&r!=null&&p(e,["parameters","negativePrompt"],r);let o=f(n,["numberOfImages"]);e!==void 0&&o!=null&&p(e,["parameters","sampleCount"],o);let s=f(n,["aspectRatio"]);e!==void 0&&s!=null&&p(e,["parameters","aspectRatio"],s);let a=f(n,["guidanceScale"]);e!==void 0&&a!=null&&p(e,["parameters","guidanceScale"],a);let c=f(n,["seed"]);e!==void 0&&c!=null&&p(e,["parameters","seed"],c);let d=f(n,["safetyFilterLevel"]);e!==void 0&&d!=null&&p(e,["parameters","safetySetting"],d);let g=f(n,["personGeneration"]);e!==void 0&&g!=null&&p(e,["parameters","personGeneration"],g);let y=f(n,["includeSafetyAttributes"]);e!==void 0&&y!=null&&p(e,["parameters","includeSafetyAttributes"],y);let v=f(n,["includeRaiReason"]);e!==void 0&&v!=null&&p(e,["parameters","includeRaiReason"],v);let _=f(n,["language"]);e!==void 0&&_!=null&&p(e,["parameters","language"],_);let b=f(n,["outputMimeType"]);e!==void 0&&b!=null&&p(e,["parameters","outputOptions","mimeType"],b);let I=f(n,["outputCompressionQuality"]);e!==void 0&&I!=null&&p(e,["parameters","outputOptions","compressionQuality"],I);let M=f(n,["addWatermark"]);e!==void 0&&M!=null&&p(e,["parameters","addWatermark"],M);let A=f(n,["labels"]);e!==void 0&&A!=null&&p(e,["labels"],A);let B=f(n,["imageSize"]);e!==void 0&&B!=null&&p(e,["parameters","sampleImageSize"],B);let G=f(n,["enhancePrompt"]);return e!==void 0&&G!=null&&p(e,["parameters","enhancePrompt"],G),t}function W3(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["_url","model"],Oe(n,i));let r=f(e,["prompt"]);r!=null&&p(t,["instances[0]","prompt"],r);let o=f(e,["config"]);return o!=null&&G3(o,t),t}function j3(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["_url","model"],Oe(n,i));let r=f(e,["prompt"]);r!=null&&p(t,["instances[0]","prompt"],r);let o=f(e,["config"]);return o!=null&&q3(o,t),t}function z3(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>o4(s))),p(e,["generatedImages"],o)}let r=f(n,["positivePromptSafetyAttributes"]);return r!=null&&p(e,["positivePromptSafetyAttributes"],yb(r)),e}function Y3(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>Wf(s))),p(e,["generatedImages"],o)}let r=f(n,["positivePromptSafetyAttributes"]);return r!=null&&p(e,["positivePromptSafetyAttributes"],vb(r)),e}function J3(n,e){let t={},i=f(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&p(e,["parameters","sampleCount"],i),f(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");let r=f(n,["durationSeconds"]);if(e!==void 0&&r!=null&&p(e,["parameters","durationSeconds"],r),f(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");let o=f(n,["aspectRatio"]);e!==void 0&&o!=null&&p(e,["parameters","aspectRatio"],o);let s=f(n,["resolution"]);e!==void 0&&s!=null&&p(e,["parameters","resolution"],s);let a=f(n,["personGeneration"]);if(e!==void 0&&a!=null&&p(e,["parameters","personGeneration"],a),f(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");let c=f(n,["negativePrompt"]);e!==void 0&&c!=null&&p(e,["parameters","negativePrompt"],c);let d=f(n,["enhancePrompt"]);if(e!==void 0&&d!=null&&p(e,["parameters","enhancePrompt"],d),f(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");let g=f(n,["lastFrame"]);e!==void 0&&g!=null&&p(e,["instances[0]","lastFrame"],jf(g));let y=f(n,["referenceImages"]);if(e!==void 0&&y!=null){let v=y;Array.isArray(v)&&(v=v.map(_=>Q4(_))),p(e,["instances[0]","referenceImages"],v)}if(f(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(f(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function K3(n,e){let t={},i=f(n,["numberOfVideos"]);e!==void 0&&i!=null&&p(e,["parameters","sampleCount"],i);let r=f(n,["outputGcsUri"]);e!==void 0&&r!=null&&p(e,["parameters","storageUri"],r);let o=f(n,["fps"]);e!==void 0&&o!=null&&p(e,["parameters","fps"],o);let s=f(n,["durationSeconds"]);e!==void 0&&s!=null&&p(e,["parameters","durationSeconds"],s);let a=f(n,["seed"]);e!==void 0&&a!=null&&p(e,["parameters","seed"],a);let c=f(n,["aspectRatio"]);e!==void 0&&c!=null&&p(e,["parameters","aspectRatio"],c);let d=f(n,["resolution"]);e!==void 0&&d!=null&&p(e,["parameters","resolution"],d);let g=f(n,["personGeneration"]);e!==void 0&&g!=null&&p(e,["parameters","personGeneration"],g);let y=f(n,["pubsubTopic"]);e!==void 0&&y!=null&&p(e,["parameters","pubsubTopic"],y);let v=f(n,["negativePrompt"]);e!==void 0&&v!=null&&p(e,["parameters","negativePrompt"],v);let _=f(n,["enhancePrompt"]);e!==void 0&&_!=null&&p(e,["parameters","enhancePrompt"],_);let b=f(n,["generateAudio"]);e!==void 0&&b!=null&&p(e,["parameters","generateAudio"],b);let I=f(n,["lastFrame"]);e!==void 0&&I!=null&&p(e,["instances[0]","lastFrame"],oi(I));let M=f(n,["referenceImages"]);if(e!==void 0&&M!=null){let G=M;Array.isArray(G)&&(G=G.map(z=>Z4(z))),p(e,["instances[0]","referenceImages"],G)}let A=f(n,["mask"]);e!==void 0&&A!=null&&p(e,["instances[0]","mask"],K4(A));let B=f(n,["compressionQuality"]);return e!==void 0&&B!=null&&p(e,["parameters","compressionQuality"],B),t}function Q3(n){let e={},t=f(n,["name"]);t!=null&&p(e,["name"],t);let i=f(n,["metadata"]);i!=null&&p(e,["metadata"],i);let r=f(n,["done"]);r!=null&&p(e,["done"],r);let o=f(n,["error"]);o!=null&&p(e,["error"],o);let s=f(n,["response","generateVideoResponse"]);return s!=null&&p(e,["response"],t4(s)),e}function Z3(n){let e={},t=f(n,["name"]);t!=null&&p(e,["name"],t);let i=f(n,["metadata"]);i!=null&&p(e,["metadata"],i);let r=f(n,["done"]);r!=null&&p(e,["done"],r);let o=f(n,["error"]);o!=null&&p(e,["error"],o);let s=f(n,["response"]);return s!=null&&p(e,["response"],n4(s)),e}function X3(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["_url","model"],Oe(n,i));let r=f(e,["prompt"]);r!=null&&p(t,["instances[0]","prompt"],r);let o=f(e,["image"]);o!=null&&p(t,["instances[0]","image"],jf(o));let s=f(e,["video"]);s!=null&&p(t,["instances[0]","video"],Cb(s));let a=f(e,["source"]);a!=null&&i4(a,t);let c=f(e,["config"]);return c!=null&&J3(c,t),t}function e4(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["_url","model"],Oe(n,i));let r=f(e,["prompt"]);r!=null&&p(t,["instances[0]","prompt"],r);let o=f(e,["image"]);o!=null&&p(t,["instances[0]","image"],oi(o));let s=f(e,["video"]);s!=null&&p(t,["instances[0]","video"],xb(s));let a=f(e,["source"]);a!=null&&r4(a,t);let c=f(e,["config"]);return c!=null&&K3(c,t),t}function t4(n){let e={},t=f(n,["generatedSamples"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(s=>a4(s))),p(e,["generatedVideos"],o)}let i=f(n,["raiMediaFilteredCount"]);i!=null&&p(e,["raiMediaFilteredCount"],i);let r=f(n,["raiMediaFilteredReasons"]);return r!=null&&p(e,["raiMediaFilteredReasons"],r),e}function n4(n){let e={},t=f(n,["videos"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(s=>l4(s))),p(e,["generatedVideos"],o)}let i=f(n,["raiMediaFilteredCount"]);i!=null&&p(e,["raiMediaFilteredCount"],i);let r=f(n,["raiMediaFilteredReasons"]);return r!=null&&p(e,["raiMediaFilteredReasons"],r),e}function i4(n,e){let t={},i=f(n,["prompt"]);e!==void 0&&i!=null&&p(e,["instances[0]","prompt"],i);let r=f(n,["image"]);e!==void 0&&r!=null&&p(e,["instances[0]","image"],jf(r));let o=f(n,["video"]);return e!==void 0&&o!=null&&p(e,["instances[0]","video"],Cb(o)),t}function r4(n,e){let t={},i=f(n,["prompt"]);e!==void 0&&i!=null&&p(e,["instances[0]","prompt"],i);let r=f(n,["image"]);e!==void 0&&r!=null&&p(e,["instances[0]","image"],oi(r));let o=f(n,["video"]);return e!==void 0&&o!=null&&p(e,["instances[0]","video"],xb(o)),t}function o4(n){let e={},t=f(n,["_self"]);t!=null&&p(e,["image"],h4(t));let i=f(n,["raiFilteredReason"]);i!=null&&p(e,["raiFilteredReason"],i);let r=f(n,["_self"]);return r!=null&&p(e,["safetyAttributes"],yb(r)),e}function Wf(n){let e={},t=f(n,["_self"]);t!=null&&p(e,["image"],hb(t));let i=f(n,["raiFilteredReason"]);i!=null&&p(e,["raiFilteredReason"],i);let r=f(n,["_self"]);r!=null&&p(e,["safetyAttributes"],vb(r));let o=f(n,["prompt"]);return o!=null&&p(e,["enhancedPrompt"],o),e}function s4(n){let e={},t=f(n,["_self"]);t!=null&&p(e,["mask"],hb(t));let i=f(n,["labels"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>o)),p(e,["labels"],r)}return e}function a4(n){let e={},t=f(n,["video"]);return t!=null&&p(e,["video"],Y4(t)),e}function l4(n){let e={},t=f(n,["_self"]);return t!=null&&p(e,["video"],J4(t)),e}function u4(n){let e={},t=f(n,["modelSelectionConfig"]);t!=null&&p(e,["modelConfig"],t);let i=f(n,["responseJsonSchema"]);i!=null&&p(e,["responseJsonSchema"],i);let r=f(n,["audioTimestamp"]);r!=null&&p(e,["audioTimestamp"],r);let o=f(n,["candidateCount"]);o!=null&&p(e,["candidateCount"],o);let s=f(n,["enableAffectiveDialog"]);s!=null&&p(e,["enableAffectiveDialog"],s);let a=f(n,["frequencyPenalty"]);a!=null&&p(e,["frequencyPenalty"],a);let c=f(n,["logprobs"]);c!=null&&p(e,["logprobs"],c);let d=f(n,["maxOutputTokens"]);d!=null&&p(e,["maxOutputTokens"],d);let g=f(n,["mediaResolution"]);g!=null&&p(e,["mediaResolution"],g);let y=f(n,["presencePenalty"]);y!=null&&p(e,["presencePenalty"],y);let v=f(n,["responseLogprobs"]);v!=null&&p(e,["responseLogprobs"],v);let _=f(n,["responseMimeType"]);_!=null&&p(e,["responseMimeType"],_);let b=f(n,["responseModalities"]);b!=null&&p(e,["responseModalities"],b);let I=f(n,["responseSchema"]);I!=null&&p(e,["responseSchema"],I);let M=f(n,["routingConfig"]);M!=null&&p(e,["routingConfig"],M);let A=f(n,["seed"]);A!=null&&p(e,["seed"],A);let B=f(n,["speechConfig"]);B!=null&&p(e,["speechConfig"],B);let G=f(n,["stopSequences"]);G!=null&&p(e,["stopSequences"],G);let z=f(n,["temperature"]);z!=null&&p(e,["temperature"],z);let X=f(n,["thinkingConfig"]);X!=null&&p(e,["thinkingConfig"],X);let ue=f(n,["topK"]);ue!=null&&p(e,["topK"],ue);let ae=f(n,["topP"]);if(ae!=null&&p(e,["topP"],ae),f(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function c4(n,e){let t={},i=f(e,["model"]);return i!=null&&p(t,["_url","name"],Oe(n,i)),t}function d4(n,e){let t={},i=f(e,["model"]);return i!=null&&p(t,["_url","name"],Oe(n,i)),t}function f4(n){let e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");let t=f(n,["enableWidget"]);return t!=null&&p(e,["enableWidget"],t),e}function m4(n){let e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");let t=f(n,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],t),e}function p4(n){let e={},t=f(n,["aspectRatio"]);t!=null&&p(e,["aspectRatio"],t);let i=f(n,["imageSize"]);if(i!=null&&p(e,["imageSize"],i),f(n,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(f(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(f(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function g4(n){let e={},t=f(n,["aspectRatio"]);t!=null&&p(e,["aspectRatio"],t);let i=f(n,["imageSize"]);i!=null&&p(e,["imageSize"],i);let r=f(n,["personGeneration"]);r!=null&&p(e,["personGeneration"],r);let o=f(n,["outputMimeType"]);o!=null&&p(e,["imageOutputOptions","mimeType"],o);let s=f(n,["outputCompressionQuality"]);return s!=null&&p(e,["imageOutputOptions","compressionQuality"],s),e}function h4(n){let e={},t=f(n,["bytesBase64Encoded"]);t!=null&&p(e,["imageBytes"],yr(t));let i=f(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function hb(n){let e={},t=f(n,["gcsUri"]);t!=null&&p(e,["gcsUri"],t);let i=f(n,["bytesBase64Encoded"]);i!=null&&p(e,["imageBytes"],yr(i));let r=f(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function jf(n){let e={};if(f(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");let t=f(n,["imageBytes"]);t!=null&&p(e,["bytesBase64Encoded"],yr(t));let i=f(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function oi(n){let e={},t=f(n,["gcsUri"]);t!=null&&p(e,["gcsUri"],t);let i=f(n,["imageBytes"]);i!=null&&p(e,["bytesBase64Encoded"],yr(i));let r=f(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function y4(n,e,t){let i={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&p(t,["_query","pageSize"],r);let o=f(e,["pageToken"]);t!==void 0&&o!=null&&p(t,["_query","pageToken"],o);let s=f(e,["filter"]);t!==void 0&&s!=null&&p(t,["_query","filter"],s);let a=f(e,["queryBase"]);return t!==void 0&&a!=null&&p(t,["_url","models_url"],ub(n,a)),i}function v4(n,e,t){let i={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&p(t,["_query","pageSize"],r);let o=f(e,["pageToken"]);t!==void 0&&o!=null&&p(t,["_query","pageToken"],o);let s=f(e,["filter"]);t!==void 0&&s!=null&&p(t,["_query","filter"],s);let a=f(e,["queryBase"]);return t!==void 0&&a!=null&&p(t,["_url","models_url"],ub(n,a)),i}function _4(n,e){let t={},i=f(e,["config"]);return i!=null&&y4(n,i,t),t}function C4(n,e){let t={},i=f(e,["config"]);return i!=null&&v4(n,i,t),t}function x4(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["nextPageToken"]);i!=null&&p(e,["nextPageToken"],i);let r=f(n,["_self"]);if(r!=null){let o=cb(r);Array.isArray(o)&&(o=o.map(s=>gy(s))),p(e,["models"],o)}return e}function E4(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["nextPageToken"]);i!=null&&p(e,["nextPageToken"],i);let r=f(n,["_self"]);if(r!=null){let o=cb(r);Array.isArray(o)&&(o=o.map(s=>hy(s))),p(e,["models"],o)}return e}function b4(n){let e={},t=f(n,["maskMode"]);t!=null&&p(e,["maskMode"],t);let i=f(n,["segmentationClasses"]);i!=null&&p(e,["maskClasses"],i);let r=f(n,["maskDilation"]);return r!=null&&p(e,["dilation"],r),e}function gy(n){let e={},t=f(n,["name"]);t!=null&&p(e,["name"],t);let i=f(n,["displayName"]);i!=null&&p(e,["displayName"],i);let r=f(n,["description"]);r!=null&&p(e,["description"],r);let o=f(n,["version"]);o!=null&&p(e,["version"],o);let s=f(n,["_self"]);s!=null&&p(e,["tunedModelInfo"],B4(s));let a=f(n,["inputTokenLimit"]);a!=null&&p(e,["inputTokenLimit"],a);let c=f(n,["outputTokenLimit"]);c!=null&&p(e,["outputTokenLimit"],c);let d=f(n,["supportedGenerationMethods"]);d!=null&&p(e,["supportedActions"],d);let g=f(n,["temperature"]);g!=null&&p(e,["temperature"],g);let y=f(n,["maxTemperature"]);y!=null&&p(e,["maxTemperature"],y);let v=f(n,["topP"]);v!=null&&p(e,["topP"],v);let _=f(n,["topK"]);_!=null&&p(e,["topK"],_);let b=f(n,["thinking"]);return b!=null&&p(e,["thinking"],b),e}function hy(n){let e={},t=f(n,["name"]);t!=null&&p(e,["name"],t);let i=f(n,["displayName"]);i!=null&&p(e,["displayName"],i);let r=f(n,["description"]);r!=null&&p(e,["description"],r);let o=f(n,["versionId"]);o!=null&&p(e,["version"],o);let s=f(n,["deployedModels"]);if(s!=null){let y=s;Array.isArray(y)&&(y=y.map(v=>O3(v))),p(e,["endpoints"],y)}let a=f(n,["labels"]);a!=null&&p(e,["labels"],a);let c=f(n,["_self"]);c!=null&&p(e,["tunedModelInfo"],U4(c));let d=f(n,["defaultCheckpointId"]);d!=null&&p(e,["defaultCheckpointId"],d);let g=f(n,["checkpoints"]);if(g!=null){let y=g;Array.isArray(y)&&(y=y.map(v=>v)),p(e,["checkpoints"],y)}return e}function S4(n){let e={},t=f(n,["mediaResolution"]);t!=null&&p(e,["mediaResolution"],t);let i=f(n,["codeExecutionResult"]);i!=null&&p(e,["codeExecutionResult"],i);let r=f(n,["executableCode"]);r!=null&&p(e,["executableCode"],r);let o=f(n,["fileData"]);o!=null&&p(e,["fileData"],V3(o));let s=f(n,["functionCall"]);s!=null&&p(e,["functionCall"],L3(s));let a=f(n,["functionResponse"]);a!=null&&p(e,["functionResponse"],a);let c=f(n,["inlineData"]);c!=null&&p(e,["inlineData"],u3(c));let d=f(n,["text"]);d!=null&&p(e,["text"],d);let g=f(n,["thought"]);g!=null&&p(e,["thought"],g);let y=f(n,["thoughtSignature"]);y!=null&&p(e,["thoughtSignature"],y);let v=f(n,["videoMetadata"]);return v!=null&&p(e,["videoMetadata"],v),e}function D4(n){let e={},t=f(n,["productImage"]);return t!=null&&p(e,["image"],oi(t)),e}function w4(n,e){let t={},i=f(n,["numberOfImages"]);e!==void 0&&i!=null&&p(e,["parameters","sampleCount"],i);let r=f(n,["baseSteps"]);e!==void 0&&r!=null&&p(e,["parameters","baseSteps"],r);let o=f(n,["outputGcsUri"]);e!==void 0&&o!=null&&p(e,["parameters","storageUri"],o);let s=f(n,["seed"]);e!==void 0&&s!=null&&p(e,["parameters","seed"],s);let a=f(n,["safetyFilterLevel"]);e!==void 0&&a!=null&&p(e,["parameters","safetySetting"],a);let c=f(n,["personGeneration"]);e!==void 0&&c!=null&&p(e,["parameters","personGeneration"],c);let d=f(n,["addWatermark"]);e!==void 0&&d!=null&&p(e,["parameters","addWatermark"],d);let g=f(n,["outputMimeType"]);e!==void 0&&g!=null&&p(e,["parameters","outputOptions","mimeType"],g);let y=f(n,["outputCompressionQuality"]);e!==void 0&&y!=null&&p(e,["parameters","outputOptions","compressionQuality"],y);let v=f(n,["enhancePrompt"]);e!==void 0&&v!=null&&p(e,["parameters","enhancePrompt"],v);let _=f(n,["labels"]);return e!==void 0&&_!=null&&p(e,["labels"],_),t}function T4(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["_url","model"],Oe(n,i));let r=f(e,["source"]);r!=null&&M4(r,t);let o=f(e,["config"]);return o!=null&&w4(o,t),t}function I4(n){let e={},t=f(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>Wf(r))),p(e,["generatedImages"],i)}return e}function M4(n,e){let t={},i=f(n,["prompt"]);e!==void 0&&i!=null&&p(e,["instances[0]","prompt"],i);let r=f(n,["personImage"]);e!==void 0&&r!=null&&p(e,["instances[0]","personImage","image"],oi(r));let o=f(n,["productImages"]);if(e!==void 0&&o!=null){let s=o;Array.isArray(s)&&(s=s.map(a=>D4(a))),p(e,["instances[0]","productImages"],s)}return t}function A4(n){let e={},t=f(n,["referenceImage"]);t!=null&&p(e,["referenceImage"],oi(t));let i=f(n,["referenceId"]);i!=null&&p(e,["referenceId"],i);let r=f(n,["referenceType"]);r!=null&&p(e,["referenceType"],r);let o=f(n,["maskImageConfig"]);o!=null&&p(e,["maskImageConfig"],b4(o));let s=f(n,["controlImageConfig"]);s!=null&&p(e,["controlImageConfig"],h3(s));let a=f(n,["styleImageConfig"]);a!=null&&p(e,["styleImageConfig"],a);let c=f(n,["subjectImageConfig"]);return c!=null&&p(e,["subjectImageConfig"],c),e}function yb(n){let e={},t=f(n,["safetyAttributes","categories"]);t!=null&&p(e,["categories"],t);let i=f(n,["safetyAttributes","scores"]);i!=null&&p(e,["scores"],i);let r=f(n,["contentType"]);return r!=null&&p(e,["contentType"],r),e}function vb(n){let e={},t=f(n,["safetyAttributes","categories"]);t!=null&&p(e,["categories"],t);let i=f(n,["safetyAttributes","scores"]);i!=null&&p(e,["scores"],i);let r=f(n,["contentType"]);return r!=null&&p(e,["contentType"],r),e}function N4(n){let e={},t=f(n,["category"]);if(t!=null&&p(e,["category"],t),f(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");let i=f(n,["threshold"]);return i!=null&&p(e,["threshold"],i),e}function R4(n){let e={},t=f(n,["image"]);return t!=null&&p(e,["image"],oi(t)),e}function P4(n,e){let t={},i=f(n,["mode"]);e!==void 0&&i!=null&&p(e,["parameters","mode"],i);let r=f(n,["maxPredictions"]);e!==void 0&&r!=null&&p(e,["parameters","maxPredictions"],r);let o=f(n,["confidenceThreshold"]);e!==void 0&&o!=null&&p(e,["parameters","confidenceThreshold"],o);let s=f(n,["maskDilation"]);e!==void 0&&s!=null&&p(e,["parameters","maskDilation"],s);let a=f(n,["binaryColorThreshold"]);e!==void 0&&a!=null&&p(e,["parameters","binaryColorThreshold"],a);let c=f(n,["labels"]);return e!==void 0&&c!=null&&p(e,["labels"],c),t}function F4(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["_url","model"],Oe(n,i));let r=f(e,["source"]);r!=null&&O4(r,t);let o=f(e,["config"]);return o!=null&&P4(o,t),t}function k4(n){let e={},t=f(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>s4(r))),p(e,["generatedMasks"],i)}return e}function O4(n,e){let t={},i=f(n,["prompt"]);e!==void 0&&i!=null&&p(e,["instances[0]","prompt"],i);let r=f(n,["image"]);e!==void 0&&r!=null&&p(e,["instances[0]","image"],oi(r));let o=f(n,["scribbleImage"]);return e!==void 0&&o!=null&&p(e,["instances[0]","scribble"],R4(o)),t}function V4(n){let e={},t=f(n,["retrievalConfig"]);t!=null&&p(e,["retrievalConfig"],t);let i=f(n,["functionCallingConfig"]);return i!=null&&p(e,["functionCallingConfig"],B3(i)),e}function L4(n){let e={};if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");let t=f(n,["computerUse"]);t!=null&&p(e,["computerUse"],t);let i=f(n,["fileSearch"]);i!=null&&p(e,["fileSearch"],i);let r=f(n,["codeExecution"]);if(r!=null&&p(e,["codeExecution"],r),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");let o=f(n,["functionDeclarations"]);if(o!=null){let g=o;Array.isArray(g)&&(g=g.map(y=>y)),p(e,["functionDeclarations"],g)}let s=f(n,["googleMaps"]);s!=null&&p(e,["googleMaps"],f4(s));let a=f(n,["googleSearch"]);a!=null&&p(e,["googleSearch"],m4(a));let c=f(n,["googleSearchRetrieval"]);c!=null&&p(e,["googleSearchRetrieval"],c);let d=f(n,["urlContext"]);return d!=null&&p(e,["urlContext"],d),e}function _b(n){let e={},t=f(n,["retrieval"]);t!=null&&p(e,["retrieval"],t);let i=f(n,["computerUse"]);if(i!=null&&p(e,["computerUse"],i),f(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");let r=f(n,["codeExecution"]);r!=null&&p(e,["codeExecution"],r);let o=f(n,["enterpriseWebSearch"]);o!=null&&p(e,["enterpriseWebSearch"],o);let s=f(n,["functionDeclarations"]);if(s!=null){let y=s;Array.isArray(y)&&(y=y.map(v=>U3(v))),p(e,["functionDeclarations"],y)}let a=f(n,["googleMaps"]);a!=null&&p(e,["googleMaps"],a);let c=f(n,["googleSearch"]);c!=null&&p(e,["googleSearch"],c);let d=f(n,["googleSearchRetrieval"]);d!=null&&p(e,["googleSearchRetrieval"],d);let g=f(n,["urlContext"]);return g!=null&&p(e,["urlContext"],g),e}function B4(n){let e={},t=f(n,["baseModel"]);t!=null&&p(e,["baseModel"],t);let i=f(n,["createTime"]);i!=null&&p(e,["createTime"],i);let r=f(n,["updateTime"]);return r!=null&&p(e,["updateTime"],r),e}function U4(n){let e={},t=f(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&p(e,["baseModel"],t);let i=f(n,["createTime"]);i!=null&&p(e,["createTime"],i);let r=f(n,["updateTime"]);return r!=null&&p(e,["updateTime"],r),e}function $4(n,e){let t={},i=f(n,["displayName"]);e!==void 0&&i!=null&&p(e,["displayName"],i);let r=f(n,["description"]);e!==void 0&&r!=null&&p(e,["description"],r);let o=f(n,["defaultCheckpointId"]);return e!==void 0&&o!=null&&p(e,["defaultCheckpointId"],o),t}function H4(n,e){let t={},i=f(n,["displayName"]);e!==void 0&&i!=null&&p(e,["displayName"],i);let r=f(n,["description"]);e!==void 0&&r!=null&&p(e,["description"],r);let o=f(n,["defaultCheckpointId"]);return e!==void 0&&o!=null&&p(e,["defaultCheckpointId"],o),t}function G4(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["_url","name"],Oe(n,i));let r=f(e,["config"]);return r!=null&&$4(r,t),t}function q4(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["_url","model"],Oe(n,i));let r=f(e,["config"]);return r!=null&&H4(r,t),t}function W4(n,e){let t={},i=f(n,["outputGcsUri"]);e!==void 0&&i!=null&&p(e,["parameters","storageUri"],i);let r=f(n,["safetyFilterLevel"]);e!==void 0&&r!=null&&p(e,["parameters","safetySetting"],r);let o=f(n,["personGeneration"]);e!==void 0&&o!=null&&p(e,["parameters","personGeneration"],o);let s=f(n,["includeRaiReason"]);e!==void 0&&s!=null&&p(e,["parameters","includeRaiReason"],s);let a=f(n,["outputMimeType"]);e!==void 0&&a!=null&&p(e,["parameters","outputOptions","mimeType"],a);let c=f(n,["outputCompressionQuality"]);e!==void 0&&c!=null&&p(e,["parameters","outputOptions","compressionQuality"],c);let d=f(n,["enhanceInputImage"]);e!==void 0&&d!=null&&p(e,["parameters","upscaleConfig","enhanceInputImage"],d);let g=f(n,["imagePreservationFactor"]);e!==void 0&&g!=null&&p(e,["parameters","upscaleConfig","imagePreservationFactor"],g);let y=f(n,["labels"]);e!==void 0&&y!=null&&p(e,["labels"],y);let v=f(n,["numberOfImages"]);e!==void 0&&v!=null&&p(e,["parameters","sampleCount"],v);let _=f(n,["mode"]);return e!==void 0&&_!=null&&p(e,["parameters","mode"],_),t}function j4(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["_url","model"],Oe(n,i));let r=f(e,["image"]);r!=null&&p(t,["instances[0]","image"],oi(r));let o=f(e,["upscaleFactor"]);o!=null&&p(t,["parameters","upscaleConfig","upscaleFactor"],o);let s=f(e,["config"]);return s!=null&&W4(s,t),t}function z4(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>Wf(o))),p(e,["generatedImages"],r)}return e}function Y4(n){let e={},t=f(n,["uri"]);t!=null&&p(e,["uri"],t);let i=f(n,["encodedVideo"]);i!=null&&p(e,["videoBytes"],yr(i));let r=f(n,["encoding"]);return r!=null&&p(e,["mimeType"],r),e}function J4(n){let e={},t=f(n,["gcsUri"]);t!=null&&p(e,["uri"],t);let i=f(n,["bytesBase64Encoded"]);i!=null&&p(e,["videoBytes"],yr(i));let r=f(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function K4(n){let e={},t=f(n,["image"]);t!=null&&p(e,["_self"],oi(t));let i=f(n,["maskMode"]);return i!=null&&p(e,["maskMode"],i),e}function Q4(n){let e={},t=f(n,["image"]);t!=null&&p(e,["image"],jf(t));let i=f(n,["referenceType"]);return i!=null&&p(e,["referenceType"],i),e}function Z4(n){let e={},t=f(n,["image"]);t!=null&&p(e,["image"],oi(t));let i=f(n,["referenceType"]);return i!=null&&p(e,["referenceType"],i),e}function Cb(n){let e={},t=f(n,["uri"]);t!=null&&p(e,["uri"],t);let i=f(n,["videoBytes"]);i!=null&&p(e,["encodedVideo"],yr(i));let r=f(n,["mimeType"]);return r!=null&&p(e,["encoding"],r),e}function xb(n){let e={},t=f(n,["uri"]);t!=null&&p(e,["gcsUri"],t);let i=f(n,["videoBytes"]);i!=null&&p(e,["bytesBase64Encoded"],yr(i));let r=f(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function X4(n,e){let t={},i=f(n,["displayName"]);return e!==void 0&&i!=null&&p(e,["displayName"],i),t}function ek(n){let e={},t=f(n,["config"]);return t!=null&&X4(t,e),e}function tk(n,e){let t={},i=f(n,["force"]);return e!==void 0&&i!=null&&p(e,["_query","force"],i),t}function nk(n){let e={},t=f(n,["name"]);t!=null&&p(e,["_url","name"],t);let i=f(n,["config"]);return i!=null&&tk(i,e),e}function ik(n){let e={},t=f(n,["name"]);return t!=null&&p(e,["_url","name"],t),e}function rk(n,e){let t={},i=f(n,["customMetadata"]);if(e!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>s)),p(e,["customMetadata"],o)}let r=f(n,["chunkingConfig"]);return e!==void 0&&r!=null&&p(e,["chunkingConfig"],r),t}function ok(n){let e={},t=f(n,["name"]);t!=null&&p(e,["name"],t);let i=f(n,["metadata"]);i!=null&&p(e,["metadata"],i);let r=f(n,["done"]);r!=null&&p(e,["done"],r);let o=f(n,["error"]);o!=null&&p(e,["error"],o);let s=f(n,["response"]);return s!=null&&p(e,["response"],ak(s)),e}function sk(n){let e={},t=f(n,["fileSearchStoreName"]);t!=null&&p(e,["_url","file_search_store_name"],t);let i=f(n,["fileName"]);i!=null&&p(e,["fileName"],i);let r=f(n,["config"]);return r!=null&&rk(r,e),e}function ak(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["parent"]);i!=null&&p(e,["parent"],i);let r=f(n,["documentName"]);return r!=null&&p(e,["documentName"],r),e}function lk(n,e){let t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&p(e,["_query","pageSize"],i);let r=f(n,["pageToken"]);return e!==void 0&&r!=null&&p(e,["_query","pageToken"],r),t}function uk(n){let e={},t=f(n,["config"]);return t!=null&&lk(t,e),e}function ck(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["nextPageToken"]);i!=null&&p(e,["nextPageToken"],i);let r=f(n,["fileSearchStores"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>s)),p(e,["fileSearchStores"],o)}return e}function Eb(n,e){let t={},i=f(n,["mimeType"]);e!==void 0&&i!=null&&p(e,["mimeType"],i);let r=f(n,["displayName"]);e!==void 0&&r!=null&&p(e,["displayName"],r);let o=f(n,["customMetadata"]);if(e!==void 0&&o!=null){let a=o;Array.isArray(a)&&(a=a.map(c=>c)),p(e,["customMetadata"],a)}let s=f(n,["chunkingConfig"]);return e!==void 0&&s!=null&&p(e,["chunkingConfig"],s),t}function dk(n){let e={},t=f(n,["fileSearchStoreName"]);t!=null&&p(e,["_url","file_search_store_name"],t);let i=f(n,["config"]);return i!=null&&Eb(i,e),e}function fk(n){let e={},t=f(n,["sdkHttpResponse"]);return t!=null&&p(e,["sdkHttpResponse"],t),e}var mk="Content-Type",pk="X-Server-Timeout",gk="User-Agent",yy="x-goog-api-client",hk="1.38.0",yk=`google-genai-sdk/${hk}`,vk="v1beta1",_k="v1beta",vy=class{constructor(e){var t,i,r;this.clientOptions=Object.assign({},e),this.customBaseUrl=(t=e.httpOptions)===null||t===void 0?void 0:t.baseUrl,this.clientOptions.vertexai&&(this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:this.clientOptions.apiKey&&(this.clientOptions.project=void 0,this.clientOptions.location=void 0));let o={};if(this.clientOptions.vertexai){if(!this.clientOptions.location&&!this.clientOptions.apiKey&&!this.customBaseUrl&&(this.clientOptions.location="global"),!(this.clientOptions.project&&this.clientOptions.location||this.clientOptions.apiKey)&&!this.customBaseUrl)throw new Error("Authentication is not set up. Please provide either a project and location, or an API key, or a custom base URL.");let a=e.project&&e.location||!!e.apiKey;this.customBaseUrl&&!a?(o.baseUrl=this.customBaseUrl,this.clientOptions.project=void 0,this.clientOptions.location=void 0):this.clientOptions.apiKey||this.clientOptions.location==="global"?o.baseUrl="https://aiplatform.googleapis.com/":this.clientOptions.project&&this.clientOptions.location&&(o.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`),o.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:vk}else{if(!this.clientOptions.apiKey)throw new Gl({message:"API key must be set when using the Gemini API.",status:403});o.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:_k,o.baseUrl="https://generativelanguage.googleapis.com/"}o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,e.httpOptions))}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getCustomBaseUrl(){return this.customBaseUrl}async getAuthHeaders(){let e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");let i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){let e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){let r=[this.getRequestUrlInternal(t)];return i&&r.push(this.getBaseResourcePath()),e!==""&&r.push(e),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(e,t){return!(t.baseUrl&&t.baseUrlResourceScope===tb.COLLECTION||this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let i=this.shouldPrependVertexProjectPath(e,t),r=this.constructUrl(e.path,t,i);if(e.queryParams)for(let[s,a]of Object.entries(e.queryParams))r.searchParams.append(s,String(a));let o={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=e.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,t,r.toString(),e.abortSignal),this.unaryApiCall(r,o,e.httpMethod)}patchHttpOptions(e,t){let i=JSON.parse(JSON.stringify(e));for(let[r,o]of Object.entries(t))typeof o=="object"?i[r]=Object.assign(Object.assign({},i[r]),o):o!==void 0&&(i[r]=o);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let i=this.shouldPrependVertexProjectPath(e,t),r=this.constructUrl(e.path,t,i);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let o={};return o.body=e.body,o=await this.includeExtraHttpOptionsToRequestInit(o,t,r.toString(),e.abortSignal),this.streamApiCall(r,o,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i,r){if(t&&t.timeout||r){let o=new AbortController,s=o.signal;if(t.timeout&&t?.timeout>0){let a=setTimeout(()=>o.abort(),t.timeout);a&&typeof a.unref=="function"&&a.unref()}r&&r.addEventListener("abort",()=>{o.abort()}),e.signal=s}return t&&t.extraBody!==null&&Ck(e,t.extraBody),e.headers=await this.getHeadersInternal(t,i),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await B2(r),new Hl(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await B2(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(e){return ni(this,arguments,function*(){var i;let r=(i=e?.body)===null||i===void 0?void 0:i.getReader(),o=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let s="",a="data:",c=[`

`,"\r\r",`\r
\r
`];for(;;){let{done:d,value:g}=yield ye(r.read());if(d){if(s.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}let y=o.decode(g,{stream:!0});try{let b=JSON.parse(y);if("error"in b){let I=JSON.parse(JSON.stringify(b.error)),M=I.status,A=I.code,B=`got status: ${M}. ${JSON.stringify(b)}`;if(A>=400&&A<600)throw new Gl({message:B,status:A})}}catch(b){if(b.name==="ApiError")throw b}s+=y;let v=-1,_=0;for(;;){v=-1,_=0;for(let M of c){let A=s.indexOf(M);A!==-1&&(v===-1||A<v)&&(v=A,_=M.length)}if(v===-1)break;let b=s.substring(0,v);s=s.substring(v+_);let I=b.trim();if(I.startsWith(a)){let M=I.substring(a.length).trim();try{let A=new Response(M,{headers:e?.headers,status:e?.status,statusText:e?.statusText});yield yield ye(new Hl(A))}catch(A){throw new Error(`exception parsing stream chunk ${M}. ${A}`)}}}}}finally{r.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){let e={},t=yk+" "+this.clientOptions.userAgentExtra;return e[gk]=t,e[yy]=t,e[mk]="application/json",e}async getHeadersInternal(e,t){let i=new Headers;if(e&&e.headers){for(let[r,o]of Object.entries(e.headers))i.append(r,o);e.timeout&&e.timeout>0&&i.append(pk,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(i,t),i}getFileName(e){var t;let i="";return typeof e=="string"&&(i=e.replace(/[/\\]+$/,""),i=(t=i.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),i}async uploadFile(e,t){var i;let r={};t!=null&&(r.mimeType=t.mimeType,r.name=t.name,r.displayName=t.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);let o=this.clientOptions.uploader,s=await o.stat(e);r.sizeBytes=String(s.size);let a=(i=t?.mimeType)!==null&&i!==void 0?i:s.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=a;let c={file:r},d=this.getFileName(e),g=K("upload/v1beta/files",c._url),y=await this.fetchUploadUrl(g,r.sizeBytes,r.mimeType,d,c,t?.httpOptions);return o.upload(e,y,this)}async uploadFileToFileSearchStore(e,t,i){var r;let o=this.clientOptions.uploader,s=await o.stat(t),a=String(s.size),c=(r=i?.mimeType)!==null&&r!==void 0?r:s.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");let d=`upload/v1beta/${e}:uploadToFileSearchStore`,g=this.getFileName(t),y={};i!=null&&Eb(i,y);let v=await this.fetchUploadUrl(d,a,c,g,y,i?.httpOptions);return o.uploadToFileSearchStore(t,v,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,i,r,o,s){var a;let c={};s?c=s:c={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${i}`},r?{"X-Goog-Upload-File-Name":r}:{})};let d=await this.request({path:e,body:JSON.stringify(o),httpMethod:"POST",httpOptions:c});if(!d||!d?.headers)throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");let g=(a=d?.headers)===null||a===void 0?void 0:a["x-goog-upload-url"];if(g===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return g}};async function B2(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){let t=n.status,i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};let r=JSON.stringify(i);throw t>=400&&t<600?new Gl({message:r,status:t}):new Error(r)}}function Ck(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{let o=JSON.parse(n.body);if(typeof o=="object"&&o!==null&&!Array.isArray(o))t=o;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(o,s){let a=Object.assign({},o);for(let c in s)if(Object.prototype.hasOwnProperty.call(s,c)){let d=s[c],g=a[c];d&&typeof d=="object"&&!Array.isArray(d)&&g&&typeof g=="object"&&!Array.isArray(g)?a[c]=i(g,d):(g&&d&&typeof g!=typeof d&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${c}". Original type: ${typeof g}, New type: ${typeof d}. Overwriting.`),a[c]=d)}return a}let r=i(t,e);n.body=JSON.stringify(r)}var xk="mcp_used/unknown",Ek=!1;function bb(n){for(let e of n)if(bk(e)||typeof e=="object"&&"inputSchema"in e)return!0;return Ek}function Sb(n){var e;let t=(e=n[yy])!==null&&e!==void 0?e:"";n[yy]=(t+` ${xk}`).trimStart()}function bk(n){return n!==null&&typeof n=="object"&&n instanceof _y}function Sk(n){return ni(this,arguments,function*(t,i=100){let r,o=0;for(;o<i;){let s=yield ye(t.listTools({cursor:r}));for(let a of s.tools)yield yield ye(a),o++;if(!s.nextCursor)break;r=s.nextCursor}})}var _y=class n{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new n(e,t)}async initialize(){var e,t,i,r;if(this.mcpTools.length>0)return;let o={},s=[];for(let g of this.mcpClients)try{for(var a=!0,c=(t=void 0,ii(Sk(g))),d;d=await c.next(),e=d.done,!e;a=!0){r=d.value,a=!1;let y=r;s.push(y);let v=y.name;if(o[v])throw new Error(`Duplicate function name ${v} found in MCP tools. Please ensure function names are unique.`);o[v]=g}}catch(y){t={error:y}}finally{try{!a&&!e&&(i=c.return)&&await i.call(c)}finally{if(t)throw t.error}}this.mcpTools=s,this.functionNameToMcpClient=o}async tool(){return await this.initialize(),a6(this.mcpTools,this.config)}async callTool(e){await this.initialize();let t=[];for(let i of e)if(i.name in this.functionNameToMcpClient){let r=this.functionNameToMcpClient[i.name],o;this.config.timeout&&(o={timeout:this.config.timeout});let s=await r.callTool({name:i.name,arguments:i.args},void 0,o);t.push({functionResponse:{name:i.name,response:s.isError?{error:s}:s}})}return t}};async function Dk(n,e,t){let i=new sy,r;t.data instanceof Blob?r=JSON.parse(await t.data.text()):r=JSON.parse(t.data),Object.assign(i,r),e(i)}var Cy=class{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");let r=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),s=Tk(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),c=`${r}/ws/google.ai.generativelanguage.${o}.GenerativeService.BidiGenerateMusic?key=${a}`,d=()=>{},g=new Promise(G=>{d=G}),y=e.callbacks,v=function(){d({})},_=this.apiClient,b={onopen:v,onmessage:G=>{Dk(_,y.onmessage,G)},onerror:(t=y?.onerror)!==null&&t!==void 0?t:function(G){},onclose:(i=y?.onclose)!==null&&i!==void 0?i:function(G){}},I=this.webSocketFactory.create(c,wk(s),b);I.connect(),await g;let B={setup:{model:Oe(this.apiClient,e.model)}};return I.send(JSON.stringify(B)),new xy(I,this.apiClient)}},xy=class{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");let t=XF(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});let t=ZF(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){let t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Ul.PLAY)}pause(){this.sendPlaybackControl(Ul.PAUSE)}stop(){this.sendPlaybackControl(Ul.STOP)}resetContext(){this.sendPlaybackControl(Ul.RESET_CONTEXT)}close(){this.conn.close()}};function wk(n){let e={};return n.forEach((t,i)=>{e[i]=t}),e}function Tk(n){let e=new Headers;for(let[t,i]of Object.entries(n))e.append(t,i);return e}var Ik="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Mk(n,e,t){let i=new oy,r;t.data instanceof Blob?r=await t.data.text():t.data instanceof ArrayBuffer?r=new TextDecoder().decode(t.data):r=t.data;let o=JSON.parse(r);if(n.isVertexAI()){let s=n3(o);Object.assign(i,s)}else Object.assign(i,o);e(i)}var Ey=class{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new Cy(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,r,o,s,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");let c=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion(),g,y=this.apiClient.getHeaders();e.config&&e.config.tools&&bb(e.config.tools)&&Sb(y);let v=Rk(y);if(this.apiClient.isVertexAI()){let de=this.apiClient.getProject(),be=this.apiClient.getLocation(),vt=this.apiClient.getApiKey(),si=!!de&&!!be||!!vt;this.apiClient.getCustomBaseUrl()&&!si?g=c:(g=`${c}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(v,g))}else{let de=this.apiClient.getApiKey(),be="BidiGenerateContent",vt="key";de?.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),d!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),be="BidiGenerateContentConstrained",vt="access_token"),g=`${c}/ws/google.ai.generativelanguage.${d}.GenerativeService.${be}?${vt}=${de}`}let _=()=>{},b=new Promise(de=>{_=de}),I=e.callbacks,M=function(){var de;(de=I?.onopen)===null||de===void 0||de.call(I),_({})},A=this.apiClient,B={onopen:M,onmessage:de=>{Mk(A,I.onmessage,de)},onerror:(t=I?.onerror)!==null&&t!==void 0?t:function(de){},onclose:(i=I?.onclose)!==null&&i!==void 0?i:function(de){}},G=this.webSocketFactory.create(g,Nk(v),B);G.connect(),await b;let z=Oe(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&z.startsWith("publishers/")){let de=this.apiClient.getProject(),be=this.apiClient.getLocation();de&&be&&(z=`projects/${de}/locations/${be}/`+z)}let X={};this.apiClient.isVertexAI()&&((r=e.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[jh.AUDIO]}:e.config.responseModalities=[jh.AUDIO]),!((o=e.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");let ue=(a=(s=e.config)===null||s===void 0?void 0:s.tools)!==null&&a!==void 0?a:[],ae=[];for(let de of ue)if(this.isCallableTool(de)){let be=de;ae.push(await be.tool())}else ae.push(de);ae.length>0&&(e.config.tools=ae);let Re={model:z,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?X=QF(this.apiClient,Re):X=KF(this.apiClient,Re),delete X.config,G.send(JSON.stringify(X)),new by(G,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}},Ak={turnComplete:!0},by=class{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=Bn(t.turns),e.isVertexAI()||(i=i.map(r=>qf(r)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(let o of i){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!e.isVertexAI()&&!("id"in o))throw new Error(Ik)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},Ak),e);let t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:t3(e)}:t={realtimeInput:e3(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");let t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}};function Nk(n){let e={};return n.forEach((t,i)=>{e[i]=t}),e}function Rk(n){let e=new Headers;for(let[t,i]of Object.entries(n))e.append(t,i);return e}var U2=10;function $2(n){var e,t,i;if(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let r=!1;for(let s of(t=n?.tools)!==null&&t!==void 0?t:[])if(Ds(s)){r=!0;break}if(!r)return!0;let o=(i=n?.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return o&&(o<0||!Number.isInteger(o))||o==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",o),!0):!1}function Ds(n){return"callTool"in n&&typeof n.callTool=="function"}function Pk(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(r=>Ds(r)))!==null&&i!==void 0?i:!1}function H2(n){var e;let t=[];return!((e=n?.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((i,r)=>{if(Ds(i))return;let o=i;o.functionDeclarations&&o.functionDeclarations.length>0&&t.push(r)}),t}function G2(n){var e;return!(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}var Sy=class extends ri{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,r,o,s,a;let c=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!Pk(t)||$2(t.config))return await this.generateContentInternal(c);let d=H2(t);if(d.length>0){let I=d.map(M=>`tools[${M}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${I}.`)}let g,y,v=Bn(c.contents),_=(o=(r=(i=c.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&o!==void 0?o:U2,b=0;for(;b<_&&(g=await this.generateContentInternal(c),!(!g.functionCalls||g.functionCalls.length===0));){let I=g.candidates[0].content,M=[];for(let A of(a=(s=t.config)===null||s===void 0?void 0:s.tools)!==null&&a!==void 0?a:[])if(Ds(A)){let G=await A.callTool(g.functionCalls);M.push(...G)}b++,y={role:"user",parts:M},c.contents=Bn(c.contents),c.contents.push(I),c.contents.push(y),G2(c.config)&&(v.push(I),v.push(y))}return G2(c.config)&&(g.automaticFunctionCallingHistory=v),g},this.generateContentStream=async t=>{var i,r,o,s,a;if(this.maybeMoveToResponseJsonSchem(t),$2(t.config)){let y=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(y)}let c=H2(t);if(c.length>0){let y=c.map(v=>`tools[${v}]`).join(", ");throw new Error(`Incompatible tools found at ${y}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}let d=(o=(r=(i=t?.config)===null||i===void 0?void 0:i.toolConfig)===null||r===void 0?void 0:r.functionCallingConfig)===null||o===void 0?void 0:o.streamFunctionCallArguments,g=(a=(s=t?.config)===null||s===void 0?void 0:s.automaticFunctionCalling)===null||a===void 0?void 0:a.disable;if(d&&!g)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var r;let o,s=[];if(i?.generatedImages)for(let c of i.generatedImages)c&&c?.safetyAttributes&&((r=c?.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?o=c?.safetyAttributes:s.push(c);let a;return o?a={generatedImages:s,positivePromptSafetyAttributes:o,sdkHttpResponse:i.sdkHttpResponse}:a={generatedImages:s,sdkHttpResponse:i.sdkHttpResponse},a}),this.list=async t=>{var i;let s={config:Object.assign(Object.assign({},{queryBase:!0}),t?.config)};if(this.apiClient.isVertexAI()&&!s.config.queryBase){if(!((i=s.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");s.config.filter="labels.tune-type:*"}return new qi(vr.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(s),s)},this.editImage=async t=>{let i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(r=>r.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));let r={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(r)},this.generateVideos=async t=>{var i,r,o,s,a,c;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((i=t.video)===null||i===void 0)&&i.uri&&(!((r=t.video)===null||r===void 0)&&r.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((s=(o=t.source)===null||o===void 0?void 0:o.video)===null||s===void 0)&&s.uri&&(!((c=(a=t.source)===null||a===void 0?void 0:a.video)===null||c===void 0)&&c.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,r;let o=(t=e.config)===null||t===void 0?void 0:t.tools;if(!o)return e;let s=await Promise.all(o.map(async c=>Ds(c)?await c.tool():c)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:s})};if(a.config.tools=s,e.config&&e.config.tools&&bb(e.config.tools)){let c=(r=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&r!==void 0?r:{},d=Object.assign({},c);Object.keys(d).length===0&&(d=this.apiClient.getDefaultHeaders()),Sb(d),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:d})}return a}async initAfcToolsMap(e){var t,i,r;let o=new Map;for(let s of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(Ds(s)){let a=s,c=await a.tool();for(let d of(r=c.functionDeclarations)!==null&&r!==void 0?r:[]){if(!d.name)throw new Error("Function declaration name is required.");if(o.has(d.name))throw new Error(`Duplicate tool declaration name: ${d.name}`);o.set(d.name,a)}}return o}async processAfcStream(e){var t,i,r;let o=(r=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&r!==void 0?r:U2,s=!1,a=0,c=await this.initAfcToolsMap(e);return(function(d,g,y){return ni(this,arguments,function*(){for(var v,_,b,I,M,A;a<o;){s&&(a++,s=!1);let X=yield ye(d.processParamsMaybeAddMcpUsage(y)),ue=yield ye(d.generateContentStreamInternal(X)),ae=[],Re=[];try{for(var B=!0,G=(_=void 0,ii(ue)),z;z=yield ye(G.next()),v=z.done,!v;B=!0){I=z.value,B=!1;let de=I;if(yield yield ye(de),de.candidates&&(!((M=de.candidates[0])===null||M===void 0)&&M.content)){Re.push(de.candidates[0].content);for(let be of(A=de.candidates[0].content.parts)!==null&&A!==void 0?A:[])if(a<o&&be.functionCall){if(!be.functionCall.name)throw new Error("Function call name was not returned by the model.");if(g.has(be.functionCall.name)){let vt=yield ye(g.get(be.functionCall.name).callTool([be.functionCall]));ae.push(...vt)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${g.keys()}, mising tool: ${be.functionCall.name}`)}}}}catch(de){_={error:de}}finally{try{!B&&!v&&(b=G.return)&&(yield ye(b.call(G)))}finally{if(_)throw _.error}}if(ae.length>0){s=!0;let de=new uo;de.candidates=[{content:{role:"user",parts:ae}}],yield yield ye(de);let be=[];be.push(...Re),be.push({role:"user",parts:ae});let vt=Bn(y.contents).concat(be);y.contents=vt}else break}})})(this,c,e)}async generateContentInternal(e){var t,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){let d=O2(this.apiClient,e);return a=K("{model}:generateContent",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>{let y=L2(g),v=new uo;return Object.assign(v,y),v})}else{let d=k2(this.apiClient,e);return a=K("{model}:generateContent",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>{let y=V2(g),v=new uo;return Object.assign(v,y),v})}}async generateContentStreamInternal(e){var t,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){let d=O2(this.apiClient,e);return a=K("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.requestStream({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),s.then(function(y){return ni(this,arguments,function*(){var v,_,b,I;try{for(var M=!0,A=ii(y),B;B=yield ye(A.next()),v=B.done,!v;M=!0){I=B.value,M=!1;let G=I,z=L2(yield ye(G.json()));z.sdkHttpResponse={headers:G.headers};let X=new uo;Object.assign(X,z),yield yield ye(X)}}catch(G){_={error:G}}finally{try{!M&&!v&&(b=A.return)&&(yield ye(b.call(A)))}finally{if(_)throw _.error}}})})}else{let d=k2(this.apiClient,e);return a=K("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.requestStream({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),s.then(function(y){return ni(this,arguments,function*(){var v,_,b,I;try{for(var M=!0,A=ii(y),B;B=yield ye(A.next()),v=B.done,!v;M=!0){I=B.value,M=!1;let G=I,z=V2(yield ye(G.json()));z.sdkHttpResponse={headers:G.headers};let X=new uo;Object.assign(X,z),yield yield ye(X)}}catch(G){_={error:G}}finally{try{!M&&!v&&(b=A.return)&&(yield ye(b.call(A)))}finally{if(_)throw _.error}}})})}}async embedContent(e){var t,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){let d=P3(this.apiClient,e);return a=K("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>{let y=k3(g),v=new yf;return Object.assign(v,y),v})}else{let d=R3(this.apiClient,e);return a=K("{model}:batchEmbedContents",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>{let y=F3(g),v=new yf;return Object.assign(v,y),v})}}async generateImagesInternal(e){var t,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){let d=j3(this.apiClient,e);return a=K("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>{let y=Y3(g),v=new vf;return Object.assign(v,y),v})}else{let d=W3(this.apiClient,e);return a=K("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>{let y=z3(g),v=new vf;return Object.assign(v,y),v})}}async editImageInternal(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI()){let a=I3(this.apiClient,e);return o=K("{model}:predict",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(d=>{let g=d;return g.sdkHttpResponse={headers:c.headers},g})),r.then(c=>{let d=M3(c),g=new zh;return Object.assign(g,d),g})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI()){let a=j4(this.apiClient,e);return o=K("{model}:predict",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(d=>{let g=d;return g.sdkHttpResponse={headers:c.headers},g})),r.then(c=>{let d=z4(c),g=new Yh;return Object.assign(g,d),g})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI()){let a=T4(this.apiClient,e);return o=K("{model}:predict",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{let d=I4(c),g=new Jh;return Object.assign(g,d),g})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI()){let a=F4(this.apiClient,e);return o=K("{model}:predict",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{let d=k4(c),g=new Kh;return Object.assign(g,d),g})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){let d=d4(this.apiClient,e);return a=K("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),s.then(g=>hy(g))}else{let d=c4(this.apiClient,e);return a=K("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),s.then(g=>gy(g))}}async listInternal(e){var t,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){let d=C4(this.apiClient,e);return a=K("{models_url}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>{let y=E4(g),v=new _f;return Object.assign(v,y),v})}else{let d=_4(this.apiClient,e);return a=K("{models_url}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>{let y=x4(g),v=new _f;return Object.assign(v,y),v})}}async update(e){var t,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){let d=q4(this.apiClient,e);return a=K("{model}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),s.then(g=>hy(g))}else{let d=G4(this.apiClient,e);return a=K("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),s.then(g=>gy(g))}}async delete(e){var t,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){let d=S3(this.apiClient,e);return a=K("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>{let y=w3(g),v=new Cf;return Object.assign(v,y),v})}else{let d=b3(this.apiClient,e);return a=K("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>{let y=D3(g),v=new Cf;return Object.assign(v,y),v})}}async countTokens(e){var t,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){let d=C3(this.apiClient,e);return a=K("{model}:countTokens",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>{let y=E3(g),v=new xf;return Object.assign(v,y),v})}else{let d=_3(this.apiClient,e);return a=K("{model}:countTokens",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>{let y=x3(g),v=new xf;return Object.assign(v,y),v})}}async computeTokens(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI()){let a=f3(this.apiClient,e);return o=K("{model}:computeTokens",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(d=>{let g=d;return g.sdkHttpResponse={headers:c.headers},g})),r.then(c=>{let d=m3(c),g=new Qh;return Object.assign(g,d),g})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){let d=e4(this.apiClient,e);return a=K("{model}:predictLongRunning",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),s.then(g=>{let y=Z3(g),v=new Ef;return Object.assign(v,y),v})}else{let d=X3(this.apiClient,e);return a=K("{model}:predictLongRunning",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),s.then(g=>{let y=Q3(g),v=new Ef;return Object.assign(v,y),v})}}};var Dy=class extends ri{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){let t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){let r=t.name.split("/operations/")[0],o;i&&"httpOptions"in i&&(o=i.httpOptions);let s=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!0})}else{let r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async get(e){let t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){let r=t.name.split("/operations/")[0],o;i&&"httpOptions"in i&&(o=i.httpOptions);let s=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!0})}else{let r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){let d=YP(e);return a=K("{operationName}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),s}else{let d=zP(e);return a=K("{operationName}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json()),s}}async fetchPredictVideosOperationInternal(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI()){let a=UP(e);return o=K("{resourceName}:fetchPredictOperation",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r}else throw new Error("This method is only supported by the Vertex AI.")}};function Fk(n){let e={},t=f(n,["data"]);if(t!=null&&p(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let i=f(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function kk(n){let e={},t=f(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>qk(o))),p(e,["parts"],r)}let i=f(n,["role"]);return i!=null&&p(e,["role"],i),e}function Ok(n,e,t){let i={},r=f(e,["expireTime"]);t!==void 0&&r!=null&&p(t,["expireTime"],r);let o=f(e,["newSessionExpireTime"]);t!==void 0&&o!=null&&p(t,["newSessionExpireTime"],o);let s=f(e,["uses"]);t!==void 0&&s!=null&&p(t,["uses"],s);let a=f(e,["liveConnectConstraints"]);t!==void 0&&a!=null&&p(t,["bidiGenerateContentSetup"],Gk(n,a));let c=f(e,["lockAdditionalFields"]);return t!==void 0&&c!=null&&p(t,["fieldMask"],c),i}function Vk(n,e){let t={},i=f(e,["config"]);return i!=null&&p(t,["config"],Ok(n,i,t)),t}function Lk(n){let e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let t=f(n,["fileUri"]);t!=null&&p(e,["fileUri"],t);let i=f(n,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function Bk(n){let e={},t=f(n,["id"]);t!=null&&p(e,["id"],t);let i=f(n,["args"]);i!=null&&p(e,["args"],i);let r=f(n,["name"]);if(r!=null&&p(e,["name"],r),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Uk(n){let e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");let t=f(n,["enableWidget"]);return t!=null&&p(e,["enableWidget"],t),e}function $k(n){let e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");let t=f(n,["timeRangeFilter"]);return t!=null&&p(e,["timeRangeFilter"],t),e}function Hk(n,e){let t={},i=f(n,["generationConfig"]);e!==void 0&&i!=null&&p(e,["setup","generationConfig"],i);let r=f(n,["responseModalities"]);e!==void 0&&r!=null&&p(e,["setup","generationConfig","responseModalities"],r);let o=f(n,["temperature"]);e!==void 0&&o!=null&&p(e,["setup","generationConfig","temperature"],o);let s=f(n,["topP"]);e!==void 0&&s!=null&&p(e,["setup","generationConfig","topP"],s);let a=f(n,["topK"]);e!==void 0&&a!=null&&p(e,["setup","generationConfig","topK"],a);let c=f(n,["maxOutputTokens"]);e!==void 0&&c!=null&&p(e,["setup","generationConfig","maxOutputTokens"],c);let d=f(n,["mediaResolution"]);e!==void 0&&d!=null&&p(e,["setup","generationConfig","mediaResolution"],d);let g=f(n,["seed"]);e!==void 0&&g!=null&&p(e,["setup","generationConfig","seed"],g);let y=f(n,["speechConfig"]);e!==void 0&&y!=null&&p(e,["setup","generationConfig","speechConfig"],zy(y));let v=f(n,["thinkingConfig"]);e!==void 0&&v!=null&&p(e,["setup","generationConfig","thinkingConfig"],v);let _=f(n,["enableAffectiveDialog"]);e!==void 0&&_!=null&&p(e,["setup","generationConfig","enableAffectiveDialog"],_);let b=f(n,["systemInstruction"]);e!==void 0&&b!=null&&p(e,["setup","systemInstruction"],kk(Yt(b)));let I=f(n,["tools"]);if(e!==void 0&&I!=null){let ue=Ms(I);Array.isArray(ue)&&(ue=ue.map(ae=>jk(Is(ae)))),p(e,["setup","tools"],ue)}let M=f(n,["sessionResumption"]);e!==void 0&&M!=null&&p(e,["setup","sessionResumption"],Wk(M));let A=f(n,["inputAudioTranscription"]);e!==void 0&&A!=null&&p(e,["setup","inputAudioTranscription"],A);let B=f(n,["outputAudioTranscription"]);e!==void 0&&B!=null&&p(e,["setup","outputAudioTranscription"],B);let G=f(n,["realtimeInputConfig"]);e!==void 0&&G!=null&&p(e,["setup","realtimeInputConfig"],G);let z=f(n,["contextWindowCompression"]);e!==void 0&&z!=null&&p(e,["setup","contextWindowCompression"],z);let X=f(n,["proactivity"]);if(e!==void 0&&X!=null&&p(e,["setup","proactivity"],X),f(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function Gk(n,e){let t={},i=f(e,["model"]);i!=null&&p(t,["setup","model"],Oe(n,i));let r=f(e,["config"]);return r!=null&&p(t,["config"],Hk(r,t)),t}function qk(n){let e={},t=f(n,["mediaResolution"]);t!=null&&p(e,["mediaResolution"],t);let i=f(n,["codeExecutionResult"]);i!=null&&p(e,["codeExecutionResult"],i);let r=f(n,["executableCode"]);r!=null&&p(e,["executableCode"],r);let o=f(n,["fileData"]);o!=null&&p(e,["fileData"],Lk(o));let s=f(n,["functionCall"]);s!=null&&p(e,["functionCall"],Bk(s));let a=f(n,["functionResponse"]);a!=null&&p(e,["functionResponse"],a);let c=f(n,["inlineData"]);c!=null&&p(e,["inlineData"],Fk(c));let d=f(n,["text"]);d!=null&&p(e,["text"],d);let g=f(n,["thought"]);g!=null&&p(e,["thought"],g);let y=f(n,["thoughtSignature"]);y!=null&&p(e,["thoughtSignature"],y);let v=f(n,["videoMetadata"]);return v!=null&&p(e,["videoMetadata"],v),e}function Wk(n){let e={},t=f(n,["handle"]);if(t!=null&&p(e,["handle"],t),f(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function jk(n){let e={};if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");let t=f(n,["computerUse"]);t!=null&&p(e,["computerUse"],t);let i=f(n,["fileSearch"]);i!=null&&p(e,["fileSearch"],i);let r=f(n,["codeExecution"]);if(r!=null&&p(e,["codeExecution"],r),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");let o=f(n,["functionDeclarations"]);if(o!=null){let g=o;Array.isArray(g)&&(g=g.map(y=>y)),p(e,["functionDeclarations"],g)}let s=f(n,["googleMaps"]);s!=null&&p(e,["googleMaps"],Uk(s));let a=f(n,["googleSearch"]);a!=null&&p(e,["googleSearch"],$k(a));let c=f(n,["googleSearchRetrieval"]);c!=null&&p(e,["googleSearchRetrieval"],c);let d=f(n,["urlContext"]);return d!=null&&p(e,["urlContext"],d),e}function zk(n){let e=[];for(let t in n)if(Object.prototype.hasOwnProperty.call(n,t)){let i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){let r=Object.keys(i).map(o=>`${t}.${o}`);e.push(...r)}else e.push(t)}return e.join(",")}function Yk(n,e){let t=null,i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){let o=i.setup;typeof o=="object"&&o!==null?(n.bidiGenerateContentSetup=o,t=o):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;let r=n.fieldMask;if(t){let o=zk(t);if(Array.isArray(e?.lockAdditionalFields)&&e?.lockAdditionalFields.length===0)o?n.fieldMask=o:delete n.fieldMask;else if(e?.lockAdditionalFields&&e.lockAdditionalFields.length>0&&r!==null&&Array.isArray(r)&&r.length>0){let s=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"],a=[];r.length>0&&(a=r.map(d=>s.includes(d)?`generationConfig.${d}`:d));let c=[];o&&c.push(o),a.length>0&&c.push(...a),c.length>0?n.fieldMask=c.join(","):delete n.fieldMask}else delete n.fieldMask}else r!==null&&Array.isArray(r)&&r.length>0?n.fieldMask=r.join(","):delete n.fieldMask;return n}var wy=class extends ri{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{let a=Vk(this.apiClient,e);o=K("auth_tokens",a._url),s=a._query,delete a.config,delete a._url,delete a._query;let c=Yk(a,e.config);return r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>d)}}};function Jk(n,e){let t={},i=f(n,["force"]);return e!==void 0&&i!=null&&p(e,["_query","force"],i),t}function Kk(n){let e={},t=f(n,["name"]);t!=null&&p(e,["_url","name"],t);let i=f(n,["config"]);return i!=null&&Jk(i,e),e}function Qk(n){let e={},t=f(n,["name"]);return t!=null&&p(e,["_url","name"],t),e}function Zk(n,e){let t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&p(e,["_query","pageSize"],i);let r=f(n,["pageToken"]);return e!==void 0&&r!=null&&p(e,["_query","pageToken"],r),t}function Xk(n){let e={},t=f(n,["parent"]);t!=null&&p(e,["_url","parent"],t);let i=f(n,["config"]);return i!=null&&Zk(i,e),e}function e8(n){let e={},t=f(n,["sdkHttpResponse"]);t!=null&&p(e,["sdkHttpResponse"],t);let i=f(n,["nextPageToken"]);i!=null&&p(e,["nextPageToken"],i);let r=f(n,["documents"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>s)),p(e,["documents"],o)}return e}var Ty=class extends ri{constructor(e){super(),this.apiClient=e,this.list=async t=>new qi(vr.PAGED_ITEM_DOCUMENTS,i=>this.listInternal({parent:t.parent,config:i.config}),await this.listInternal(t),t)}async get(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=Qk(e);return o=K("{name}",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>c)}}async delete(e){var t,i;let r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let s=Kk(e);r=K("{name}",s._url),o=s._query,delete s._url,delete s._query,await this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=Xk(e);return o=K("{parent}/documents",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{let d=e8(c),g=new Zh;return Object.assign(g,d),g})}}};var Iy=class extends ri{constructor(e,t=new Ty(e)){super(),this.apiClient=e,this.documents=t,this.list=async(i={})=>new qi(vr.PAGED_ITEM_FILE_SEARCH_STORES,r=>this.listInternal(r),await this.listInternal(i),i)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=ek(e);return o=K("fileSearchStores",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>c)}}async get(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=ik(e);return o=K("{name}",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>c)}}async delete(e){var t,i;let r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let s=nk(e);r=K("{name}",s._url),o=s._query,delete s._url,delete s._query,await this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=uk(e);return o=K("fileSearchStores",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{let d=ck(c),g=new Xh;return Object.assign(g,d),g})}}async uploadToFileSearchStoreInternal(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=dk(e);return o=K("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{let d=fk(c),g=new ey;return Object.assign(g,d),g})}}async importFile(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=sk(e);return o=K("{file_search_store_name}:importFile",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{let d=ok(c),g=new ty;return Object.assign(g,d),g})}}};var Db=function(){let{crypto:n}=globalThis;if(n?.randomUUID)return Db=n.randomUUID.bind(n),n.randomUUID();let e=new Uint8Array(1),t=n?()=>n.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,i=>(+i^t()&15>>+i/4).toString(16))},t8=()=>Db();function My(n){return typeof n=="object"&&n!==null&&("name"in n&&n.name==="AbortError"||"message"in n&&String(n.message).includes("FetchRequestCanceledException"))}var Ay=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null){try{if(Object.prototype.toString.call(n)==="[object Error]"){let e=new Error(n.message,n.cause?{cause:n.cause}:{});return n.stack&&(e.stack=n.stack),n.cause&&!e.cause&&(e.cause=n.cause),n.name&&(e.name=n.name),e}}catch{}try{return new Error(JSON.stringify(n))}catch{}}return new Error(n)};var pn=class extends Error{},gn=class n extends pn{constructor(e,t,i,r){super(`${n.makeMessage(e,t,i)}`),this.status=e,this.headers=r,this.error=t}static makeMessage(e,t,i){let r=t?.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):i;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,i,r){if(!e||!r)return new ws({message:i,cause:Ay(t)});let o=t;return e===400?new Nf(e,o,i,r):e===401?new Rf(e,o,i,r):e===403?new Pf(e,o,i,r):e===404?new Ff(e,o,i,r):e===409?new kf(e,o,i,r):e===422?new Of(e,o,i,r):e===429?new Vf(e,o,i,r):e>=500?new Lf(e,o,i,r):new n(e,o,i,r)}},ql=class extends gn{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}},ws=class extends gn{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}},Af=class extends ws{constructor({message:e}={}){super({message:e??"Request timed out."})}},Nf=class extends gn{},Rf=class extends gn{},Pf=class extends gn{},Ff=class extends gn{},kf=class extends gn{},Of=class extends gn{},Vf=class extends gn{},Lf=class extends gn{};var n8=/^[a-z][a-z0-9+.-]*:/i,i8=n=>n8.test(n),Ny=n=>(Ny=Array.isArray,Ny(n)),r8=Ny,o8=r8,q2=o8;function s8(n){if(!n)return!0;for(let e in n)return!1;return!0}function a8(n,e){return Object.prototype.hasOwnProperty.call(n,e)}var l8=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new pn(`${n} must be an integer`);if(e<0)throw new pn(`${n} must be a positive integer`);return e},u8=n=>{try{return JSON.parse(n)}catch{return}};var c8=n=>new Promise(e=>setTimeout(e,n));var bs="0.0.1";function d8(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}var f8=()=>{var n,e,t,i,r;let o=d8();if(o==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":bs,"X-Stainless-OS":j2(Deno.build.os),"X-Stainless-Arch":W2(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(n=Deno.version)===null||n===void 0?void 0:n.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":bs,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(o==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":bs,"X-Stainless-OS":j2((t=globalThis.process.platform)!==null&&t!==void 0?t:"unknown"),"X-Stainless-Arch":W2((i=globalThis.process.arch)!==null&&i!==void 0?i:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(r=globalThis.process.version)!==null&&r!==void 0?r:"unknown"};let s=m8();return s?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":bs,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${s.browser}`,"X-Stainless-Runtime-Version":s.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":bs,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function m8(){if(typeof navigator>"u"||!navigator)return null;let n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(let{key:e,pattern:t}of n){let i=t.exec(navigator.userAgent);if(i){let r=i[1]||0,o=i[2]||0,s=i[3]||0;return{browser:e,version:`${r}.${o}.${s}`}}}return null}var W2=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",j2=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown"),cf,p8=()=>cf??(cf=f8());function g8(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function wb(...n){let e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...n)}function h8(n){let e=Symbol.asyncIterator in n?n[Symbol.asyncIterator]():n[Symbol.iterator]();return wb({start(){},async pull(t){let{done:i,value:r}=await e.next();i?t.close():t.enqueue(r)},async cancel(){var t;await((t=e.return)===null||t===void 0?void 0:t.call(e))}})}function Tb(n){if(n[Symbol.asyncIterator])return n;let e=n.getReader();return{async next(){try{let t=await e.read();return t?.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){let t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function y8(n){var e,t;if(n===null||typeof n!="object")return;if(n[Symbol.asyncIterator]){await((t=(e=n[Symbol.asyncIterator]()).return)===null||t===void 0?void 0:t.call(e));return}let i=n.getReader(),r=i.cancel();i.releaseLock(),await r}var v8=({headers:n,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});var Ib=()=>{var n;if(typeof File>"u"){let{process:e}=globalThis,t=typeof((n=e?.versions)===null||n===void 0?void 0:n.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Gh(n,e,t){return Ib(),new File(n,e??"unknown_file",t)}function _8(n){return(typeof n=="object"&&n!==null&&("name"in n&&n.name&&String(n.name)||"url"in n&&n.url&&String(n.url)||"filename"in n&&n.filename&&String(n.filename)||"path"in n&&n.path&&String(n.path))||"").split(/[\\/]/).pop()||void 0}var C8=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function";var Mb=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",x8=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&Mb(n),E8=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function";async function b8(n,e,t){if(Ib(),n=await n,x8(n))return n instanceof File?n:Gh([await n.arrayBuffer()],n.name);if(E8(n)){let r=await n.blob();return e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()),Gh(await Ry(r),e,t)}let i=await Ry(n);if(e||(e=_8(n)),!t?.type){let r=i.find(o=>typeof o=="object"&&"type"in o&&o.type);typeof r=="string"&&(t=Object.assign(Object.assign({},t),{type:r}))}return Gh(i,e,t)}async function Ry(n){var e,t,i,r,o;let s=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)s.push(n);else if(Mb(n))s.push(n instanceof Blob?n:await n.arrayBuffer());else if(C8(n))try{for(var a=!0,c=ii(n),d;d=await c.next(),e=d.done,!e;a=!0){r=d.value,a=!1;let g=r;s.push(...await Ry(g))}}catch(g){t={error:g}}finally{try{!a&&!e&&(i=c.return)&&await i.call(c)}finally{if(t)throw t.error}}else{let g=(o=n?.constructor)===null||o===void 0?void 0:o.name;throw new Error(`Unexpected data type: ${typeof n}${g?`; constructor: ${g}`:""}${S8(n)}`)}return s}function S8(n){return typeof n!="object"||n===null?"":`; props: [${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}var D8=(()=>{class n{constructor(t){this._client=t}}n._key=[];return n})();function Ab(n){return n.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}var z2=Object.freeze(Object.create(null)),w8=(n=Ab)=>function(t,...i){if(t.length===1)return t[0];let r=!1,o=[],s=t.reduce((g,y,v)=>{var _,b,I;/[?#]/.test(y)&&(r=!0);let M=i[v],A=(r?encodeURIComponent:n)(""+M);return v!==i.length&&(M==null||typeof M=="object"&&M.toString===((I=Object.getPrototypeOf((b=Object.getPrototypeOf((_=M.hasOwnProperty)!==null&&_!==void 0?_:z2))!==null&&b!==void 0?b:z2))===null||I===void 0?void 0:I.toString))&&(A=M+"",o.push({start:g.length+y.length,length:A.length,error:`Value of type ${Object.prototype.toString.call(M).slice(8,-1)} is not a valid path parameter`})),g+y+(v===i.length?"":A)},""),a=s.split(/[?#]/,1)[0],c=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi"),d;for(;(d=c.exec(a))!==null;)o.push({start:d.index,length:d[0].length,error:`Value "${d[0]}" can't be safely passed as a path parameter`});if(o.sort((g,y)=>g.start-y.start),o.length>0){let g=0,y=o.reduce((v,_)=>{let b=" ".repeat(_.start-g),I="^".repeat(_.length);return g=_.start+_.length,v+b+I},"");throw new pn(`Path parameters result in path with invalid segments:
${o.map(v=>v.error).join(`
`)}
${s}
${y}`)}return s},df=w8(Ab);var Bf=class extends D8{create(e,t){var i;let{api_version:r=this._client.apiVersion}=e,o=Mf(e,["api_version"]);if("model"in o&&"agent_config"in o)throw new pn("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in o&&"generation_config"in o)throw new pn("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(df`/${r}/interactions`,Object.assign(Object.assign({body:o},t),{stream:(i=e.stream)!==null&&i!==void 0?i:!1}))}delete(e,t={},i){let{api_version:r=this._client.apiVersion}=t??{};return this._client.delete(df`/${r}/interactions/${e}`,i)}cancel(e,t={},i){let{api_version:r=this._client.apiVersion}=t??{};return this._client.post(df`/${r}/interactions/${e}/cancel`,i)}get(e,t={},i){var r;let o=t??{},{api_version:s=this._client.apiVersion}=o,a=Mf(o,["api_version"]);return this._client.get(df`/${s}/interactions/${e}`,Object.assign(Object.assign({query:a},i),{stream:(r=t?.stream)!==null&&r!==void 0?r:!1}))}};Bf._key=Object.freeze(["interactions"]);var Uf=class extends Bf{};function T8(n){let e=0;for(let r of n)e+=r.length;let t=new Uint8Array(e),i=0;for(let r of n)t.set(r,i),i+=r.length;return t}var ff;function Yy(n){let e;return(ff??(e=new globalThis.TextEncoder,ff=e.encode.bind(e)))(n)}var mf;function Y2(n){let e;return(mf??(e=new globalThis.TextDecoder,mf=e.decode.bind(e)))(n)}var Ts=class{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];let t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?Yy(e):e;this.buffer=T8([this.buffer,t]);let i=[],r;for(;(r=I8(this.buffer,this.carriageReturnIndex))!=null;){if(r.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=r.index;continue}if(this.carriageReturnIndex!=null&&(r.index!==this.carriageReturnIndex+1||r.carriage)){i.push(Y2(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}let o=this.carriageReturnIndex!==null?r.preceding-1:r.preceding,s=Y2(this.buffer.subarray(0,o));i.push(s),this.buffer=this.buffer.subarray(r.index),this.carriageReturnIndex=null}return i}flush(){return this.buffer.length?this.decode(`
`):[]}};Ts.NEWLINE_CHARS=new Set([`
`,"\r"]);Ts.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function I8(n,e){for(let r=e??0;r<n.length;r++){if(n[r]===10)return{preceding:r,index:r+1,carriage:!1};if(n[r]===13)return{preceding:r,index:r+1,carriage:!0}}return null}function M8(n){for(let i=0;i<n.length-1;i++){if(n[i]===10&&n[i+1]===10||n[i]===13&&n[i+1]===13)return i+2;if(n[i]===13&&n[i+1]===10&&i+3<n.length&&n[i+2]===13&&n[i+3]===10)return i+4}return-1}var $f={off:0,error:200,warn:300,info:400,debug:500},J2=(n,e,t)=>{if(n){if(a8($f,n))return n;an(t).warn(`${e} was set to ${JSON.stringify(n)}, expected one of ${JSON.stringify(Object.keys($f))}`)}};function $l(){}function pf(n,e,t){return!e||$f[n]>$f[t]?$l:e[n].bind(e)}var A8={error:$l,warn:$l,info:$l,debug:$l},K2=new WeakMap;function an(n){var e;let t=n.logger,i=(e=n.logLevel)!==null&&e!==void 0?e:"off";if(!t)return A8;let r=K2.get(t);if(r&&r[0]===i)return r[1];let o={error:pf("error",t,i),warn:pf("warn",t,i),info:pf("info",t,i),debug:pf("debug",t,i)};return K2.set(t,[i,o]),o}var lo=n=>(n.options&&(n.options=Object.assign({},n.options),delete n.options.headers),n.headers&&(n.headers=Object.fromEntries((n.headers instanceof Headers?[...n.headers]:Object.entries(n.headers)).map(([e,t])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in n&&(n.retryOfRequestLogID&&(n.retryOf=n.retryOfRequestLogID),delete n.retryOfRequestLogID),n);var Py=class n{constructor(e,t,i){this.iterator=e,this.controller=t,this.client=i}static fromSSEResponse(e,t,i){let r=!1,o=i?an(i):console;function s(){return ni(this,arguments,function*(){var c,d,g,y;if(r)throw new pn("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let v=!1;try{try{for(var _=!0,b=ii(N8(e,t)),I;I=yield ye(b.next()),c=I.done,!c;_=!0){y=I.value,_=!1;let M=y;if(!v)if(M.data.startsWith("[DONE]")){v=!0;continue}else try{yield yield ye(JSON.parse(M.data))}catch(A){throw o.error("Could not parse message into JSON:",M.data),o.error("From chunk:",M.raw),A}}}catch(M){d={error:M}}finally{try{!_&&!c&&(g=b.return)&&(yield ye(g.call(b)))}finally{if(d)throw d.error}}v=!0}catch(M){if(My(M))return yield ye(void 0);throw M}finally{v||t.abort()}})}return new n(s,t,i)}static fromReadableStream(e,t,i){let r=!1;function o(){return ni(this,arguments,function*(){var c,d,g,y;let v=new Ts,_=Tb(e);try{for(var b=!0,I=ii(_),M;M=yield ye(I.next()),c=M.done,!c;b=!0){y=M.value,b=!1;let A=y;for(let B of v.decode(A))yield yield ye(B)}}catch(A){d={error:A}}finally{try{!b&&!c&&(g=I.return)&&(yield ye(g.call(I)))}finally{if(d)throw d.error}}for(let A of v.flush())yield yield ye(A)})}function s(){return ni(this,arguments,function*(){var c,d,g,y;if(r)throw new pn("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let v=!1;try{try{for(var _=!0,b=ii(o()),I;I=yield ye(b.next()),c=I.done,!c;_=!0){y=I.value,_=!1;let M=y;v||M&&(yield yield ye(JSON.parse(M)))}}catch(M){d={error:M}}finally{try{!_&&!c&&(g=b.return)&&(yield ye(g.call(b)))}finally{if(d)throw d.error}}v=!0}catch(M){if(My(M))return yield ye(void 0);throw M}finally{v||t.abort()}})}return new n(s,t,i)}[Symbol.asyncIterator](){return this.iterator()}tee(){let e=[],t=[],i=this.iterator(),r=o=>({next:()=>{if(o.length===0){let s=i.next();e.push(s),t.push(s)}return o.shift()}});return[new n(()=>r(e),this.controller,this.client),new n(()=>r(t),this.controller,this.client)]}toReadableStream(){let e=this,t;return wb({async start(){t=e[Symbol.asyncIterator]()},async pull(i){try{let{value:r,done:o}=await t.next();if(o)return i.close();let s=Yy(JSON.stringify(r)+`
`);i.enqueue(s)}catch(r){i.error(r)}},async cancel(){var i;await((i=t.return)===null||i===void 0?void 0:i.call(t))}})}};function N8(n,e){return ni(this,arguments,function*(){var i,r,o,s;if(!n.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new pn("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new pn("Attempted to iterate over a response with no body");let a=new Fy,c=new Ts,d=Tb(n.body);try{for(var g=!0,y=ii(R8(d)),v;v=yield ye(y.next()),i=v.done,!i;g=!0){s=v.value,g=!1;let _=s;for(let b of c.decode(_)){let I=a.decode(b);I&&(yield yield ye(I))}}}catch(_){r={error:_}}finally{try{!g&&!i&&(o=y.return)&&(yield ye(o.call(y)))}finally{if(r)throw r.error}}for(let _ of c.flush()){let b=a.decode(_);b&&(yield yield ye(b))}})}function R8(n){return ni(this,arguments,function*(){var t,i,r,o;let s=new Uint8Array;try{for(var a=!0,c=ii(n),d;d=yield ye(c.next()),t=d.done,!t;a=!0){o=d.value,a=!1;let g=o;if(g==null)continue;let y=g instanceof ArrayBuffer?new Uint8Array(g):typeof g=="string"?Yy(g):g,v=new Uint8Array(s.length+y.length);v.set(s),v.set(y,s.length),s=v;let _;for(;(_=M8(s))!==-1;)yield yield ye(s.slice(0,_)),s=s.slice(_)}}catch(g){i={error:g}}finally{try{!a&&!t&&(r=c.return)&&(yield ye(r.call(c)))}finally{if(i)throw i.error}}s.length>0&&(yield yield ye(s))})}var Fy=class{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,i,r]=P8(e,":");return r.startsWith(" ")&&(r=r.substring(1)),t==="event"?this.event=r:t==="data"&&this.data.push(r),null}};function P8(n,e){let t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}async function F8(n,e){let{response:t,requestLogID:i,retryOfRequestLogID:r,startTime:o}=e,s=await(async()=>{var a;if(e.options.stream)return an(n).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,n):Py.fromSSEResponse(t,e.controller,n);if(t.status===204)return null;if(e.options.__binaryResponse)return t;let c=t.headers.get("content-type"),d=(a=c?.split(";")[0])===null||a===void 0?void 0:a.trim();return d?.includes("application/json")||d?.endsWith("+json")?await t.json():await t.text()})();return an(n).debug(`[${i}] response parsed`,lo({retryOfRequestLogID:r,url:t.url,status:t.status,body:s,durationMs:Date.now()-o})),s}var ky=class n extends Promise{constructor(e,t,i=F8){super(r=>{r(null)}),this.responsePromise=t,this.parseResponse=i,this.client=e}_thenUnwrap(e){return new n(this.client,this.responsePromise,async(t,i)=>e(await this.parseResponse(t,i),i))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){let[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}};var Nb=Symbol("brand.privateNullableHeaders");function*k8(n){if(!n)return;if(Nb in n){let{values:i,nulls:r}=n;yield*i.entries();for(let o of r)yield[o,null];return}let e=!1,t;n instanceof Headers?t=n.entries():q2(n)?t=n:(e=!0,t=Object.entries(n??{}));for(let i of t){let r=i[0];if(typeof r!="string")throw new TypeError("expected header name to be a string");let o=q2(i[1])?i[1]:[i[1]],s=!1;for(let a of o)a!==void 0&&(e&&!s&&(s=!0,yield[r,null]),yield[r,a])}}var Bl=n=>{let e=new Headers,t=new Set;for(let i of n){let r=new Set;for(let[o,s]of k8(i)){let a=o.toLowerCase();r.has(a)||(e.delete(o),r.add(a)),s===null?(e.delete(o),t.add(a)):(e.append(o,s),t.delete(a))}}return{[Nb]:!0,values:e,nulls:t}};var qh=n=>{var e,t,i,r,o,s;if(typeof globalThis.process<"u")return(i=(t=(e=globalThis.process.env)===null||e===void 0?void 0:e[n])===null||t===void 0?void 0:t.trim())!==null&&i!==void 0?i:void 0;if(typeof globalThis.Deno<"u")return(s=(o=(r=globalThis.Deno.env)===null||r===void 0?void 0:r.get)===null||o===void 0?void 0:o.call(r,n))===null||s===void 0?void 0:s.trim()};var Rb,O8=(()=>{class n{constructor(t){var i,r,o,s,a,c,d,{baseURL:g=qh("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:y=(i=qh("GEMINI_API_KEY"))!==null&&i!==void 0?i:null,apiVersion:v="v1beta"}=t,_=Mf(t,["baseURL","apiKey","apiVersion"]);let b=Object.assign(Object.assign({apiKey:y,apiVersion:v},_),{baseURL:g||"https://generativelanguage.googleapis.com"});this.baseURL=b.baseURL,this.timeout=(r=b.timeout)!==null&&r!==void 0?r:n.DEFAULT_TIMEOUT,this.logger=(o=b.logger)!==null&&o!==void 0?o:console;let I="warn";this.logLevel=I,this.logLevel=(a=(s=J2(b.logLevel,"ClientOptions.logLevel",this))!==null&&s!==void 0?s:J2(qh("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&a!==void 0?a:I,this.fetchOptions=b.fetchOptions,this.maxRetries=(c=b.maxRetries)!==null&&c!==void 0?c:2,this.fetch=(d=b.fetch)!==null&&d!==void 0?d:g8(),this.encoder=v8,this._options=b,this.apiKey=y,this.apiVersion=v,this.clientAdapter=b.clientAdapter}withOptions(t){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),t))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:t,nulls:i}){if(!(t.has("authorization")||t.has("x-goog-api-key"))&&!(this.apiKey&&t.get("x-goog-api-key"))&&!i.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(t){let i=Bl([t.headers]);if(!(i.values.has("authorization")||i.values.has("x-goog-api-key"))){if(this.apiKey)return Bl([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return Bl([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(t){return Object.entries(t).filter(([i,r])=>typeof r<"u").map(([i,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(i)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(i)}=`;throw new pn(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${bs}`}defaultIdempotencyKey(){return`stainless-node-retry-${t8()}`}makeStatusError(t,i,r,o){return gn.generate(t,i,r,o)}buildURL(t,i,r){let o=!this.baseURLOverridden()&&r||this.baseURL,s=i8(t)?new URL(t):new URL(o+(o.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),a=this.defaultQuery();return s8(a)||(i=Object.assign(Object.assign({},a),i)),typeof i=="object"&&i&&!Array.isArray(i)&&(s.search=this.stringifyQuery(i)),s.toString()}async prepareOptions(t){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!t.path.startsWith(`/${this.apiVersion}/projects/`)){let i=t.path.slice(this.apiVersion.length+1);t.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${i}`}}async prepareRequest(t,{url:i,options:r}){}get(t,i){return this.methodRequest("get",t,i)}post(t,i){return this.methodRequest("post",t,i)}patch(t,i){return this.methodRequest("patch",t,i)}put(t,i){return this.methodRequest("put",t,i)}delete(t,i){return this.methodRequest("delete",t,i)}methodRequest(t,i,r){return this.request(Promise.resolve(r).then(o=>Object.assign({method:t,path:i},o)))}request(t,i=null){return new ky(this,this.makeRequest(t,i,void 0))}async makeRequest(t,i,r){var o,s,a;let c=await t,d=(o=c.maxRetries)!==null&&o!==void 0?o:this.maxRetries;i==null&&(i=d),await this.prepareOptions(c);let{req:g,url:y,timeout:v}=await this.buildRequest(c,{retryCount:d-i});await this.prepareRequest(g,{url:y,options:c});let _="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),b=r===void 0?"":`, retryOf: ${r}`,I=Date.now();if(an(this).debug(`[${_}] sending request`,lo({retryOfRequestLogID:r,method:c.method,url:y,options:c,headers:g.headers})),!((s=c.signal)===null||s===void 0)&&s.aborted)throw new ql;let M=new AbortController,A=await this.fetchWithTimeout(y,g,v,M).catch(Ay),B=Date.now();if(A instanceof globalThis.Error){let z=`retrying, ${i} attempts remaining`;if(!((a=c.signal)===null||a===void 0)&&a.aborted)throw new ql;let X=My(A)||/timed? ?out/i.test(String(A)+("cause"in A?String(A.cause):""));if(i)return an(this).info(`[${_}] connection ${X?"timed out":"failed"} - ${z}`),an(this).debug(`[${_}] connection ${X?"timed out":"failed"} (${z})`,lo({retryOfRequestLogID:r,url:y,durationMs:B-I,message:A.message})),this.retryRequest(c,i,r??_);throw an(this).info(`[${_}] connection ${X?"timed out":"failed"} - error; no more retries left`),an(this).debug(`[${_}] connection ${X?"timed out":"failed"} (error; no more retries left)`,lo({retryOfRequestLogID:r,url:y,durationMs:B-I,message:A.message})),X?new Af:new ws({cause:A})}let G=`[${_}${b}] ${g.method} ${y} ${A.ok?"succeeded":"failed"} with status ${A.status} in ${B-I}ms`;if(!A.ok){let z=await this.shouldRetry(A);if(i&&z){let be=`retrying, ${i} attempts remaining`;return await y8(A.body),an(this).info(`${G} - ${be}`),an(this).debug(`[${_}] response error (${be})`,lo({retryOfRequestLogID:r,url:A.url,status:A.status,headers:A.headers,durationMs:B-I})),this.retryRequest(c,i,r??_,A.headers)}let X=z?"error; no more retries left":"error; not retryable";an(this).info(`${G} - ${X}`);let ue=await A.text().catch(be=>Ay(be).message),ae=u8(ue),Re=ae?void 0:ue;throw an(this).debug(`[${_}] response error (${X})`,lo({retryOfRequestLogID:r,url:A.url,status:A.status,headers:A.headers,message:Re,durationMs:Date.now()-I})),this.makeStatusError(A.status,ae,Re,A.headers)}return an(this).info(G),an(this).debug(`[${_}] response start`,lo({retryOfRequestLogID:r,url:A.url,status:A.status,headers:A.headers,durationMs:B-I})),{response:A,options:c,controller:M,requestLogID:_,retryOfRequestLogID:r,startTime:I}}async fetchWithTimeout(t,i,r,o){let s=i||{},{signal:a,method:c}=s,d=Mf(s,["signal","method"]);a&&a.addEventListener("abort",()=>o.abort());let g=setTimeout(()=>o.abort(),r),y=globalThis.ReadableStream&&d.body instanceof globalThis.ReadableStream||typeof d.body=="object"&&d.body!==null&&Symbol.asyncIterator in d.body,v=Object.assign(Object.assign(Object.assign({signal:o.signal},y?{duplex:"half"}:{}),{method:"GET"}),d);c&&(v.method=c.toUpperCase());try{return await this.fetch.call(void 0,t,v)}finally{clearTimeout(g)}}async shouldRetry(t){let i=t.headers.get("x-should-retry");return i==="true"?!0:i==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,i,r,o){var s;let a,c=o?.get("retry-after-ms");if(c){let g=parseFloat(c);Number.isNaN(g)||(a=g)}let d=o?.get("retry-after");if(d&&!a){let g=parseFloat(d);Number.isNaN(g)?a=Date.parse(d)-Date.now():a=g*1e3}if(!(a&&0<=a&&a<60*1e3)){let g=(s=t.maxRetries)!==null&&s!==void 0?s:this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(i,g)}return await c8(a),this.makeRequest(t,i-1,r)}calculateDefaultRetryTimeoutMillis(t,i){let s=i-t,a=Math.min(.5*Math.pow(2,s),8),c=1-Math.random()*.25;return a*c*1e3}async buildRequest(t,{retryCount:i=0}={}){var r,o,s;let a=Object.assign({},t),{method:c,path:d,query:g,defaultBaseURL:y}=a,v=this.buildURL(d,g,y);"timeout"in a&&l8("timeout",a.timeout),a.timeout=(r=a.timeout)!==null&&r!==void 0?r:this.timeout;let{bodyHeaders:_,body:b}=this.buildBody({options:a}),I=await this.buildHeaders({options:t,method:c,bodyHeaders:_,retryCount:i});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:c,headers:I},a.signal&&{signal:a.signal}),globalThis.ReadableStream&&b instanceof globalThis.ReadableStream&&{duplex:"half"}),b&&{body:b}),(o=this.fetchOptions)!==null&&o!==void 0?o:{}),(s=a.fetchOptions)!==null&&s!==void 0?s:{}),url:v,timeout:a.timeout}}async buildHeaders({options:t,method:i,bodyHeaders:r,retryCount:o}){let s={};this.idempotencyHeader&&i!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=t.idempotencyKey);let a=await this.authHeaders(t),c=Bl([s,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(o)},t.timeout?{"X-Stainless-Timeout":String(Math.trunc(t.timeout/1e3))}:{}),p8()),this._options.defaultHeaders,r,t.headers,a]);return this.validateHeaders(c),c.values}buildBody({options:{body:t,headers:i}}){if(!t)return{bodyHeaders:void 0,body:void 0};let r=Bl([i]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||typeof t=="string"&&r.values.has("content-type")||globalThis.Blob&&t instanceof globalThis.Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:typeof t=="object"&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&typeof t.next=="function")?{bodyHeaders:void 0,body:h8(t)}:this.encoder({body:t,headers:r})}}return n.DEFAULT_TIMEOUT=6e4,n})(),Tt=class extends O8{constructor(){super(...arguments),this.interactions=new Uf(this)}};Rb=Tt;Tt.GeminiNextGenAPIClient=Rb;Tt.GeminiNextGenAPIClientError=pn;Tt.APIError=gn;Tt.APIConnectionError=ws;Tt.APIConnectionTimeoutError=Af;Tt.APIUserAbortError=ql;Tt.NotFoundError=Ff;Tt.ConflictError=kf;Tt.RateLimitError=Vf;Tt.BadRequestError=Nf;Tt.AuthenticationError=Rf;Tt.InternalServerError=Lf;Tt.PermissionDeniedError=Pf;Tt.UnprocessableEntityError=Of;Tt.toFile=b8;Tt.Interactions=Uf;function V8(n,e){let t={},i=f(n,["name"]);return i!=null&&p(t,["_url","name"],i),t}function L8(n,e){let t={},i=f(n,["name"]);return i!=null&&p(t,["_url","name"],i),t}function B8(n,e){let t={},i=f(n,["sdkHttpResponse"]);return i!=null&&p(t,["sdkHttpResponse"],i),t}function U8(n,e){let t={},i=f(n,["sdkHttpResponse"]);return i!=null&&p(t,["sdkHttpResponse"],i),t}function $8(n,e,t){let i={};if(f(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");let r=f(n,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&p(e,["displayName"],r),f(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");let o=f(n,["epochCount"]);e!==void 0&&o!=null&&p(e,["tuningTask","hyperparameters","epochCount"],o);let s=f(n,["learningRateMultiplier"]);if(s!=null&&p(i,["tuningTask","hyperparameters","learningRateMultiplier"],s),f(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(f(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(f(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");let a=f(n,["batchSize"]);e!==void 0&&a!=null&&p(e,["tuningTask","hyperparameters","batchSize"],a);let c=f(n,["learningRate"]);if(e!==void 0&&c!=null&&p(e,["tuningTask","hyperparameters","learningRate"],c),f(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(f(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return i}function H8(n,e,t){let i={},r=f(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){let _=f(n,["validationDataset"]);e!==void 0&&_!=null&&p(e,["supervisedTuningSpec"],Q2(_))}else if(r==="PREFERENCE_TUNING"){let _=f(n,["validationDataset"]);e!==void 0&&_!=null&&p(e,["preferenceOptimizationSpec"],Q2(_))}let o=f(n,["tunedModelDisplayName"]);e!==void 0&&o!=null&&p(e,["tunedModelDisplayName"],o);let s=f(n,["description"]);e!==void 0&&s!=null&&p(e,["description"],s);let a=f(t,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){let _=f(n,["epochCount"]);e!==void 0&&_!=null&&p(e,["supervisedTuningSpec","hyperParameters","epochCount"],_)}else if(a==="PREFERENCE_TUNING"){let _=f(n,["epochCount"]);e!==void 0&&_!=null&&p(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],_)}let c=f(t,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){let _=f(n,["learningRateMultiplier"]);e!==void 0&&_!=null&&p(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],_)}else if(c==="PREFERENCE_TUNING"){let _=f(n,["learningRateMultiplier"]);e!==void 0&&_!=null&&p(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],_)}let d=f(t,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){let _=f(n,["exportLastCheckpointOnly"]);e!==void 0&&_!=null&&p(e,["supervisedTuningSpec","exportLastCheckpointOnly"],_)}else if(d==="PREFERENCE_TUNING"){let _=f(n,["exportLastCheckpointOnly"]);e!==void 0&&_!=null&&p(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],_)}let g=f(t,["config","method"]);if(g===void 0&&(g="SUPERVISED_FINE_TUNING"),g==="SUPERVISED_FINE_TUNING"){let _=f(n,["adapterSize"]);e!==void 0&&_!=null&&p(e,["supervisedTuningSpec","hyperParameters","adapterSize"],_)}else if(g==="PREFERENCE_TUNING"){let _=f(n,["adapterSize"]);e!==void 0&&_!=null&&p(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],_)}if(f(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(f(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");let y=f(n,["labels"]);e!==void 0&&y!=null&&p(e,["labels"],y);let v=f(n,["beta"]);return e!==void 0&&v!=null&&p(e,["preferenceOptimizationSpec","hyperParameters","beta"],v),i}function G8(n,e){let t={},i=f(n,["baseModel"]);i!=null&&p(t,["baseModel"],i);let r=f(n,["preTunedModel"]);r!=null&&p(t,["preTunedModel"],r);let o=f(n,["trainingDataset"]);o!=null&&eO(o);let s=f(n,["config"]);return s!=null&&$8(s,t),t}function q8(n,e){let t={},i=f(n,["baseModel"]);i!=null&&p(t,["baseModel"],i);let r=f(n,["preTunedModel"]);r!=null&&p(t,["preTunedModel"],r);let o=f(n,["trainingDataset"]);o!=null&&tO(o,t,e);let s=f(n,["config"]);return s!=null&&H8(s,t,e),t}function W8(n,e){let t={},i=f(n,["name"]);return i!=null&&p(t,["_url","name"],i),t}function j8(n,e){let t={},i=f(n,["name"]);return i!=null&&p(t,["_url","name"],i),t}function z8(n,e,t){let i={},r=f(n,["pageSize"]);e!==void 0&&r!=null&&p(e,["_query","pageSize"],r);let o=f(n,["pageToken"]);e!==void 0&&o!=null&&p(e,["_query","pageToken"],o);let s=f(n,["filter"]);return e!==void 0&&s!=null&&p(e,["_query","filter"],s),i}function Y8(n,e,t){let i={},r=f(n,["pageSize"]);e!==void 0&&r!=null&&p(e,["_query","pageSize"],r);let o=f(n,["pageToken"]);e!==void 0&&o!=null&&p(e,["_query","pageToken"],o);let s=f(n,["filter"]);return e!==void 0&&s!=null&&p(e,["_query","filter"],s),i}function J8(n,e){let t={},i=f(n,["config"]);return i!=null&&z8(i,t),t}function K8(n,e){let t={},i=f(n,["config"]);return i!=null&&Y8(i,t),t}function Q8(n,e){let t={},i=f(n,["sdkHttpResponse"]);i!=null&&p(t,["sdkHttpResponse"],i);let r=f(n,["nextPageToken"]);r!=null&&p(t,["nextPageToken"],r);let o=f(n,["tunedModels"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(a=>Pb(a))),p(t,["tuningJobs"],s)}return t}function Z8(n,e){let t={},i=f(n,["sdkHttpResponse"]);i!=null&&p(t,["sdkHttpResponse"],i);let r=f(n,["nextPageToken"]);r!=null&&p(t,["nextPageToken"],r);let o=f(n,["tuningJobs"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(a=>Oy(a))),p(t,["tuningJobs"],s)}return t}function X8(n,e){let t={},i=f(n,["name"]);i!=null&&p(t,["model"],i);let r=f(n,["name"]);return r!=null&&p(t,["endpoint"],r),t}function eO(n,e){let t={};if(f(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");let i=f(n,["examples"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>o)),p(t,["examples","examples"],r)}return t}function tO(n,e,t){let i={},r=f(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){let s=f(n,["gcsUri"]);e!==void 0&&s!=null&&p(e,["supervisedTuningSpec","trainingDatasetUri"],s)}else if(r==="PREFERENCE_TUNING"){let s=f(n,["gcsUri"]);e!==void 0&&s!=null&&p(e,["preferenceOptimizationSpec","trainingDatasetUri"],s)}let o=f(t,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){let s=f(n,["vertexDatasetResource"]);e!==void 0&&s!=null&&p(e,["supervisedTuningSpec","trainingDatasetUri"],s)}else if(o==="PREFERENCE_TUNING"){let s=f(n,["vertexDatasetResource"]);e!==void 0&&s!=null&&p(e,["preferenceOptimizationSpec","trainingDatasetUri"],s)}if(f(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function Pb(n,e){let t={},i=f(n,["sdkHttpResponse"]);i!=null&&p(t,["sdkHttpResponse"],i);let r=f(n,["name"]);r!=null&&p(t,["name"],r);let o=f(n,["state"]);o!=null&&p(t,["state"],ab(o));let s=f(n,["createTime"]);s!=null&&p(t,["createTime"],s);let a=f(n,["tuningTask","startTime"]);a!=null&&p(t,["startTime"],a);let c=f(n,["tuningTask","completeTime"]);c!=null&&p(t,["endTime"],c);let d=f(n,["updateTime"]);d!=null&&p(t,["updateTime"],d);let g=f(n,["description"]);g!=null&&p(t,["description"],g);let y=f(n,["baseModel"]);y!=null&&p(t,["baseModel"],y);let v=f(n,["_self"]);return v!=null&&p(t,["tunedModel"],X8(v)),t}function Oy(n,e){let t={},i=f(n,["sdkHttpResponse"]);i!=null&&p(t,["sdkHttpResponse"],i);let r=f(n,["name"]);r!=null&&p(t,["name"],r);let o=f(n,["state"]);o!=null&&p(t,["state"],ab(o));let s=f(n,["createTime"]);s!=null&&p(t,["createTime"],s);let a=f(n,["startTime"]);a!=null&&p(t,["startTime"],a);let c=f(n,["endTime"]);c!=null&&p(t,["endTime"],c);let d=f(n,["updateTime"]);d!=null&&p(t,["updateTime"],d);let g=f(n,["error"]);g!=null&&p(t,["error"],g);let y=f(n,["description"]);y!=null&&p(t,["description"],y);let v=f(n,["baseModel"]);v!=null&&p(t,["baseModel"],v);let _=f(n,["tunedModel"]);_!=null&&p(t,["tunedModel"],_);let b=f(n,["preTunedModel"]);b!=null&&p(t,["preTunedModel"],b);let I=f(n,["supervisedTuningSpec"]);I!=null&&p(t,["supervisedTuningSpec"],I);let M=f(n,["preferenceOptimizationSpec"]);M!=null&&p(t,["preferenceOptimizationSpec"],M);let A=f(n,["tuningDataStats"]);A!=null&&p(t,["tuningDataStats"],A);let B=f(n,["encryptionSpec"]);B!=null&&p(t,["encryptionSpec"],B);let G=f(n,["partnerModelTuningSpec"]);G!=null&&p(t,["partnerModelTuningSpec"],G);let z=f(n,["customBaseModel"]);z!=null&&p(t,["customBaseModel"],z);let X=f(n,["experiment"]);X!=null&&p(t,["experiment"],X);let ue=f(n,["labels"]);ue!=null&&p(t,["labels"],ue);let ae=f(n,["outputUri"]);ae!=null&&p(t,["outputUri"],ae);let Re=f(n,["pipelineJob"]);Re!=null&&p(t,["pipelineJob"],Re);let de=f(n,["serviceAccount"]);de!=null&&p(t,["serviceAccount"],de);let be=f(n,["tunedModelDisplayName"]);be!=null&&p(t,["tunedModelDisplayName"],be);let vt=f(n,["veoTuningSpec"]);return vt!=null&&p(t,["veoTuningSpec"],vt),t}function nO(n,e){let t={},i=f(n,["sdkHttpResponse"]);i!=null&&p(t,["sdkHttpResponse"],i);let r=f(n,["name"]);r!=null&&p(t,["name"],r);let o=f(n,["metadata"]);o!=null&&p(t,["metadata"],o);let s=f(n,["done"]);s!=null&&p(t,["done"],s);let a=f(n,["error"]);return a!=null&&p(t,["error"],a),t}function Q2(n,e){let t={},i=f(n,["gcsUri"]);i!=null&&p(t,["validationDatasetUri"],i);let r=f(n,["vertexDatasetResource"]);return r!=null&&p(t,["validationDatasetUri"],r),t}var Vy=class extends ri{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new qi(vr.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.get=async t=>await this.getInternal(t),this.tune=async t=>{var i;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){let r={tunedModelName:t.baseModel};!((i=t.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(r.checkpointId=t.config.preTunedModelCheckpointId);let o=Object.assign(Object.assign({},t),{preTunedModel:r});return o.baseModel=void 0,await this.tuneInternal(o)}else{let r=Object.assign({},t);return await this.tuneInternal(r)}else{let r=Object.assign({},t),o=await this.tuneMldevInternal(r),s="";return o.metadata!==void 0&&o.metadata.tunedModel!==void 0?s=o.metadata.tunedModel:o.name!==void 0&&o.name.includes("/operations/")&&(s=o.name.split("/operations/")[0]),{name:s,state:eb.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){let d=j8(e);return a=K("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>Oy(g))}else{let d=W8(e);return a=K("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>Pb(g))}}async listInternal(e){var t,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){let d=K8(e);return a=K("tuningJobs",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>{let y=Z8(g),v=new bf;return Object.assign(v,y),v})}else{let d=J8(e);return a=K("tunedModels",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>{let y=Q8(g),v=new bf;return Object.assign(v,y),v})}}async cancel(e){var t,i,r,o;let s,a="",c={};if(this.apiClient.isVertexAI()){let d=L8(e);return a=K("{name}:cancel",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>{let y=U8(g),v=new Sf;return Object.assign(v,y),v})}else{let d=V8(e);return a=K("{name}:cancel",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(g=>g.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:g.headers},v})),s.then(g=>{let y=B8(g),v=new Sf;return Object.assign(v,y),v})}}async tuneInternal(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI()){let a=q8(e,e);return o=K("tuningJobs",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(d=>{let g=d;return g.sdkHttpResponse={headers:c.headers},g})),r.then(c=>Oy(c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=G8(e);return o=K("tunedModels",a._url),s=a._query,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(d=>{let g=d;return g.sdkHttpResponse={headers:c.headers},g})),r.then(c=>nO(c))}}};var Ly=class{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}},iO=1024*1024*8,rO=3,oO=1e3,sO=2,Hf="x-goog-upload-status";async function aO(n,e,t){var i;let r=await Fb(n,e,t),o=await r?.json();if(((i=r?.headers)===null||i===void 0?void 0:i[Hf])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return o.file}async function lO(n,e,t){var i;let r=await Fb(n,e,t),o=await r?.json();if(((i=r?.headers)===null||i===void 0?void 0:i[Hf])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");let s=X2(o),a=new ay;return Object.assign(a,s),a}async function Fb(n,e,t){var i,r;let o=0,s=0,a=new Hl(new Response),c="upload";for(o=n.size;s<o;){let d=Math.min(iO,o-s),g=n.slice(s,s+d);s+d>=o&&(c+=", finalize");let y=0,v=oO;for(;y<rO&&(a=await t.request({path:"",body:g,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":c,"X-Goog-Upload-Offset":String(s),"Content-Length":String(d)}}}),!(!((i=a?.headers)===null||i===void 0)&&i[Hf]));)y++,await cO(v),v=v*sO;if(s+=d,((r=a?.headers)===null||r===void 0?void 0:r[Hf])!=="active")break;if(o<=s)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return a}async function uO(n){return{size:n.size,type:n.type}}function cO(n){return new Promise(e=>setTimeout(e,n))}var By=class{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await aO(e,t,i)}async uploadToFileSearchStore(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await lO(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await uO(e)}};var Uy=class{create(e,t,i){return new $y(e,t,i)}},$y=class{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}};var Z2="x-goog-api-key",Hy=class{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(Z2)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Z2,this.apiKey)}}};var dO="gl-node/",Gf=class{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");let e=this.httpOptions;e?.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");let t=new Tt({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e?.timeout});return this._interactions=t.interactions,this._interactions}constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;let i=LP(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;let r=new Hy(this.apiKey);this.apiClient=new vy({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:dO+"web",uploader:new By,downloader:new Ly}),this.models=new Sy(this.apiClient),this.live=new Ey(this.apiClient,r,new Uy),this.batches=new cy(this.apiClient),this.chats=new fy(this.models,this.apiClient),this.caches=new dy(this.apiClient),this.files=new py(this.apiClient),this.operations=new Dy(this.apiClient),this.authTokens=new wy(this.apiClient),this.tunings=new Vy(this.apiClient),this.fileSearchStores=new Iy(this.apiClient)}};var co=class co{constructor(){this.ai=null;this.financialInsightState=D("idle");this.financialInsight=D(null);this.financialInsightError=D(null);this.basketAnalysisState=D("idle");this.basketAnalysis=D(null);this.basketAnalysisError=D(null);let e=typeof process<"u"&&process.env?process.env.API_KEY:void 0;e?this.ai=new Gf({apiKey:e}):console.error("API_KEY environment variable not set. AI features will not be available.")}async generateFinancialInsights(e,t){if(!this.ai){this.financialInsightError.set("Gemini AI \u5BA2\u6236\u7AEF\u672A\u521D\u59CB\u5316\u3002\u8ACB\u6AA2\u67E5 API \u91D1\u9470\u3002"),this.financialInsightState.set("error");return}this.financialInsightState.set("loading"),this.financialInsightError.set(null),this.financialInsight.set(null);let i=`
      Analyze the following financial data for a small business.
      IMPORTANT: All textual analysis and recommendations in the response must be in Traditional Chinese. The JSON keys must remain in English as specified in the schema.

      Financial Summary:
      - Total Revenue: ${e.totalRevenue.toFixed(2)}
      - Total Expenses: ${e.totalExpenses.toFixed(2)}
      - Net Income: ${e.netIncome.toFixed(2)}

      Monthly Performance (Revenue vs Expenses):
      ${t.map(r=>`- ${r.month}: Revenue ${r.revenue.toFixed(2)}, Expenses ${r.expenses.toFixed(2)}`).join(`
`)}

      Based on this data, provide:
      1. Two key positive trends.
      2. Two potential areas for improvement or concern.
      3. Two actionable strategic recommendations.
    `;try{let r=await this.ai.models.generateContent({model:"gemini-2.5-flash",contents:i,config:{responseMimeType:"application/json",responseSchema:{type:lt.OBJECT,properties:{positive_trends:{type:lt.ARRAY,items:{type:lt.STRING}},areas_for_improvement:{type:lt.ARRAY,items:{type:lt.STRING}},strategic_recommendations:{type:lt.ARRAY,items:{type:lt.STRING}}}}}}),o=JSON.parse(r.text);this.financialInsight.set(o),this.financialInsightState.set("success")}catch(r){console.error(r),this.financialInsightError.set("\u5F9E AI \u6A21\u578B\u751F\u6210\u8CA1\u52D9\u6D1E\u5BDF\u5931\u6557\u3002"),this.financialInsightState.set("error")}}async analyzeShoppingBaskets(e){if(!this.ai){this.basketAnalysisError.set("Gemini AI \u5BA2\u6236\u7AEF\u672A\u521D\u59CB\u5316\u3002\u8ACB\u6AA2\u67E5 API \u91D1\u9470\u3002"),this.basketAnalysisState.set("error");return}this.basketAnalysisState.set("loading"),this.basketAnalysisError.set(null),this.basketAnalysis.set(null);let t=e.map(r=>r.items.map(o=>o.name)),i=`
      Perform a market basket analysis on the following list of customer transactions. Each inner list represents one transaction.
      Transactions: ${JSON.stringify(t)}

      IMPORTANT: All textual analysis, suggestions, and insights in the response must be in Traditional Chinese. The JSON keys must remain in English as specified in the schema.

      Identify up to 3 sets of items that are frequently bought together. For each set, provide a marketing or upselling suggestion.
      Also, provide 2 general insights into customer purchasing behavior based on this data.
    `;try{let r=await this.ai.models.generateContent({model:"gemini-2.5-flash",contents:i,config:{responseMimeType:"application/json",responseSchema:{type:lt.OBJECT,properties:{frequently_bought_together:{type:lt.ARRAY,items:{type:lt.OBJECT,properties:{items:{type:lt.ARRAY,items:{type:lt.STRING}},suggestion:{type:lt.STRING}}}},customer_behavior_insights:{type:lt.ARRAY,items:{type:lt.STRING}}}}}}),o=JSON.parse(r.text);this.basketAnalysis.set(o),this.basketAnalysisState.set("success")}catch(r){console.error(r),this.basketAnalysisError.set("\u5F9E AI \u6A21\u578B\u751F\u6210\u8CFC\u7269\u7C43\u5206\u6790\u5931\u6557\u3002"),this.basketAnalysisState.set("error")}}};co.\u0275fac=function(t){return new(t||co)},co.\u0275prov=Y({token:co,factory:co.\u0275fac,providedIn:"root"});var zf=co;var fO=(n,e)=>e.id,mO=(n,e)=>e.transactionId;function pO(n,e){n&1&&(l(0,"div",17)(1,"div",31),x(2,"div",32),l(3,"p",6),m(4,"\u52A0\u8F09\u9867\u5BA2\u5217\u8868\u4E2D..."),u()()())}function gO(n,e){if(n&1&&(l(0,"div",18)(1,"p",33),m(2,"\u52A0\u8F09\u5931\u6557"),u(),l(3,"p"),m(4),u()()),n&2){let t=C();h(4),E(t.errorMessage())}}function hO(n,e){if(n&1){let t=U();l(0,"div",47),S("click",function(){let r=w(t).$implicit,o=C(2);return T(o.selectCustomer(r))}),l(1,"div",48)(2,"p",49),m(3),u(),l(4,"span",50),m(5),u()(),l(6,"p",6),m(7),u()()}if(n&2){let t,i,r=e.$implicit,o=C(2);Q("bg-indigo-100",((t=o.selectedCustomer())==null?null:t.id)===r.id)("hover:bg-gray-100",((i=o.selectedCustomer())==null?null:i.id)!==r.id),h(3),E(o.getCleanCustomerName(r)),h(),De(o.getCustomerTypeClass(r)),h(),E(o.getCustomerType(r)),h(2),E(r.phone)}}function yO(n,e){n&1&&(l(0,"p",46),m(1,"\u627E\u4E0D\u5230\u9867\u5BA2\u3002"),u())}function vO(n,e){if(n&1){let t=U();l(0,"div",34)(1,"select",35),ne("ngModelChange",function(r){w(t);let o=C();return re(o.categoryFilter,r)||(o.categoryFilter=r),T(r)}),l(2,"option",36),m(3,"\u5168\u90E8\u9867\u5BA2"),u(),l(4,"option",37),m(5,"\u4E00\u822C\u9867\u5BA2"),u(),l(6,"option",38),m(7,"\u96EA\u8304\u6703\u54E1"),u(),l(8,"option",39),m(9,"\u80A1\u6771"),u()()(),l(10,"div",40)(11,"input",41),ne("ngModelChange",function(r){w(t);let o=C();return re(o.searchTerm,r)||(o.searchTerm=r),T(r)}),u(),x(12,"ion-icon",42),u(),l(13,"div",43)(14,"div",44),O(15,hO,8,9,"div",45,fO,!1,yO,2,0,"p",46),u()()}if(n&2){let t=C();h(),te("ngModel",t.categoryFilter),h(10),te("ngModel",t.searchTerm),h(4),V(t.filteredCustomers())}}function _O(n,e){if(n&1&&(l(0,"div",60)(1,"strong",64),m(2,"\u6700\u5F8C\u7D50\u5E33\u6642\u9593"),u(),l(3,"span",58),m(4),nn(5,"date"),u()()),n&2){let t=C();h(4),E(xn(5,1,t.lastCheckoutAt,"yyyy-MM-dd HH:mm"))}}function CO(n,e){if(n&1&&(l(0,"div",60)(1,"strong",64),m(2,"\u5099\u8A3B"),u(),l(3,"span",58),m(4),u()()),n&2){let t=C();h(4),E(t.note)}}function xO(n,e){if(n&1&&(l(0,"tr",68)(1,"td",66),m(2),u(),l(3,"td",66),m(4),u(),l(5,"td",69),m(6),u()()),n&2){let t=e.$implicit,i=C(3);h(2),E(t.date),h(2),E(i.formatSaleItems(t.items)),h(2),E(i.formatCurrency(t.total))}}function EO(n,e){if(n&1&&(l(0,"table",63)(1,"thead",65)(2,"tr")(3,"th",66),m(4,"\u65E5\u671F"),u(),l(5,"th",66),m(6,"\u54C1\u9805"),u(),l(7,"th",67),m(8,"\u7E3D\u91D1\u984D"),u()()(),l(9,"tbody"),O(10,xO,7,3,"tr",68,mO),u()()),n&2){let t=C(2);h(10),V(t.customerSales())}}function bO(n,e){n&1&&(l(0,"p",46),m(1,"\u7121\u4EA4\u6613\u7D00\u9304\u3002"),u())}function SO(n,e){if(n&1){let t=U();l(0,"div")(1,"div",21)(2,"div",51)(3,"div")(4,"h2",52),m(5),u(),l(6,"span",53),m(7),u()(),l(8,"button",54),S("click",function(){w(t);let r=C();return T(r.clearSelection())}),x(9,"ion-icon",55),u()(),l(10,"div",56)(11,"div")(12,"strong",57),m(13,"\u96FB\u8A71"),u(),l(14,"span",58),m(15),u()(),l(16,"div")(17,"strong",57),m(18,"\u6027\u5225"),u(),l(19,"span",58),m(20),u()(),l(21,"div")(22,"strong",57),m(23,"\u751F\u65E5"),u(),l(24,"span",58),m(25),u()(),l(26,"div")(27,"strong",57),m(28,"\u51FA\u751F\u5E74\u4EFD"),u(),l(29,"span",58),m(30),u()(),l(31,"div")(32,"strong",57),m(33,"\u7A4D\u5206\u9EDE\u6578"),u(),l(34,"span",59),m(35),u()(),l(36,"div")(37,"strong",57),m(38,"\u539F\u59CB\u9580\u5E97"),u(),l(39,"span",58),m(40),u()()(),P(41,_O,6,4,"div",60),P(42,CO,5,1,"div",60),u(),l(43,"div",61)(44,"h3",16),m(45,"\u4EA4\u6613\u6B77\u53F2"),u(),l(46,"div",62),P(47,EO,12,0,"table",63)(48,bO,2,0,"p",46),u()()()}if(n&2){let t=e,i=C();h(5),E(i.getCleanCustomerName(t)),h(),De(i.getCustomerTypeClass(t)),h(),E(i.getCustomerType(t)),h(8),E(t.phone||"-"),h(5),E(t.gender||"-"),h(5),E(t.birthday||"-"),h(5),E(t.birthYear||"-"),h(5),L("",t.loyaltyPoints||0," \u9EDE"),h(5),E(t.originStore||"-"),h(),F(t.lastCheckoutAt?41:-1),h(),F(t.note?42:-1),h(5),F(i.customerSales().length>0?47:48)}}function DO(n,e){n&1&&(l(0,"div",20)(1,"div",70),x(2,"ion-icon",71),l(3,"p",72),m(4,"\u8ACB\u5F9E\u5DE6\u5074\u9078\u64C7\u4E00\u4F4D\u9867\u5BA2\u4EE5\u67E5\u770B\u8A73\u7D30\u8CC7\u8A0A\u3002"),u()()())}function wO(n,e){n&1&&x(0,"div",27)}function TO(n,e){n&1&&(l(0,"p",28),m(1,"\u9EDE\u64CA\u6309\u9215\u4EE5\u5C0D\u5168\u9AD4\u9867\u5BA2\u7684 POS \u6578\u64DA\u904B\u884C AI \u8CFC\u7269\u7C43\u5206\u6790\u3002"),u())}function IO(n,e){n&1&&(l(0,"p",29),m(1,"AI \u6B63\u5728\u5206\u6790\u4EA4\u6613\u7D00\u9304..."),u())}function MO(n,e){if(n&1&&(l(0,"div",30)(1,"p",33),m(2,"\u767C\u751F\u932F\u8AA4"),u(),l(3,"p"),m(4),u()()),n&2){let t=C();h(4),E(t.geminiService.basketAnalysisError())}}function AO(n,e){if(n&1&&(l(0,"div",75)(1,"p",77),m(2),u(),l(3,"p",78)(4,"span",79),m(5,"\u5EFA\u8B70\uFF1A"),u(),m(6),u()()),n&2){let t=e.$implicit;h(2),E(t.items.join(" + ")),h(4),L(" ",t.suggestion)}}function NO(n,e){n&1&&(l(0,"p",28),m(1,"\u672A\u627E\u5230\u986F\u8457\u7684\u5546\u54C1\u7D44\u5408\u3002"),u())}function RO(n,e){if(n&1&&(l(0,"li"),m(1),u()),n&2){let t=e.$implicit;h(),E(t)}}function PO(n,e){if(n&1&&(l(0,"div",73)(1,"div")(2,"h4",74),m(3,"\u7D93\u5E38\u4E00\u8D77\u8CFC\u8CB7\u7684\u5546\u54C1"),u(),O(4,AO,7,2,"div",75,_n,!1,NO,2,0,"p",28),u(),l(7,"div")(8,"h4",74),m(9,"\u9867\u5BA2\u884C\u70BA\u6D1E\u5BDF"),u(),l(10,"ul",76),O(11,RO,2,1,"li",null,_n),u()()()),n&2){let t=e;h(4),V(t.frequently_bought_together),h(7),V(t.customer_behavior_insights)}}function FO(n,e){if(n&1&&P(0,PO,13,1,"div",73),n&2){let t,i=C();F((t=i.geminiService.basketAnalysis())?0:-1,t)}}var Ns=class Ns{constructor(){this.apiService=R(wt);this.geminiService=R(zf);this.customers=D([]);this.searchTerm=D("");this.categoryFilter=D("all");this.selectedCustomer=D(null);this.customerSales=D([]);this.customerFeedback=D([]);this.isLoading=D(!1);this.errorMessage=D(null);this.filteredCustomers=H(()=>{let e=this.customers(),t=this.categoryFilter();t!=="all"&&(e=e.filter(r=>this.getCustomerCategory(r)===t));let i=this.searchTerm().toLowerCase();return i&&(e=e.filter(r=>r.name?.toLowerCase().includes(i)||r.phone?.includes(i))),e});this.customerStats=H(()=>{let e=this.customers(),t=e.length,i=e.filter(s=>this.getCustomerCategory(s)==="cigar").length,r=e.filter(s=>this.getCustomerCategory(s)==="shareholder").length,o=e.filter(s=>this.getCustomerCategory(s)==="regular").length;return{total:t,cigarCount:i,regularCount:o,shareholderCount:r}});this.loadCustomers()}async loadCustomers(){this.isLoading.set(!0),this.errorMessage.set(null);try{let e=await this.apiService.getCustomers();e.success&&e.data&&Array.isArray(e.data)?this.customers.set(e.data):this.errorMessage.set(e.error||"\u7121\u6CD5\u53D6\u5F97\u9867\u5BA2\u8CC7\u6599")}catch(e){console.error("Error loading customers:",e),this.errorMessage.set("\u8F09\u5165\u9867\u5BA2\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoading.set(!1)}}selectCustomer(e){this.selectedCustomer.set(e)}clearSelection(){this.selectedCustomer.set(null),this.customerSales.set([]),this.customerFeedback.set([])}runBasketAnalysis(){}getCustomerCategory(e){let t=e.name||"";return t.includes("\u96EA\u8304")?"cigar":t.includes("\u80A1\u6771")?"shareholder":"regular"}getCleanCustomerName(e){let t=e.name||"";return t=t.replace(/\s*/g,"").replace(/\s*/g,""),t.trim()}getCustomerTypeClass(e){switch(this.getCustomerCategory(e)){case"cigar":return"bg-purple-100 text-purple-800";case"shareholder":return"bg-yellow-100 text-yellow-800";default:return"bg-blue-100 text-blue-800"}}getCustomerType(e){switch(this.getCustomerCategory(e)){case"cigar":return"\u96EA\u8304\u6703\u54E1";case"shareholder":return"\u80A1\u6771";default:return"\u4E00\u822C\u9867\u5BA2"}}formatSaleItems(e){return e?e.map(t=>t.name).join(", "):""}formatCurrency(e){return e==null?"":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}getStars(e){return Array(e).fill(0)}getEmptyStars(e){return Array(5-e).fill(0)}};Ns.\u0275fac=function(t){return new(t||Ns)},Ns.\u0275cmp=ee({type:Ns,selectors:[["app-customer-analysis"]],decls:60,vars:11,consts:[[1,"space-y-8"],[1,"text-3xl","font-bold","text-gray-900"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-6"],[1,"bg-white","p-6","rounded-xl","shadow-md","flex","items-center","space-x-4"],[1,"bg-blue-100","p-3","rounded-full"],["name","people-outline",1,"text-2xl","text-blue-600"],[1,"text-sm","text-gray-500"],[1,"text-2xl","font-semibold","text-gray-900"],[1,"bg-green-100","p-3","rounded-full"],["name","person-outline",1,"text-2xl","text-green-600"],[1,"bg-purple-100","p-3","rounded-full"],["name","ribbon-outline",1,"text-2xl","text-purple-600"],[1,"bg-yellow-100","p-3","rounded-full"],["name","briefcase-outline",1,"text-2xl","text-yellow-600"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-8"],[1,"lg:col-span-1","bg-white","p-6","rounded-xl","shadow-md","flex","flex-col"],[1,"text-lg","font-semibold","text-gray-800","mb-4"],[1,"flex","items-center","justify-center","h-32"],[1,"bg-red-50","border","border-red-200","text-red-700","p-3","rounded-lg","mb-4","text-sm"],[1,"lg:col-span-2","space-y-8"],[1,"h-full","flex","items-center","justify-center","bg-white","p-6","rounded-xl","shadow-md"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"flex","justify-between","items-center","mb-4"],[1,"flex","items-center","space-x-3"],["name","basket-outline",1,"text-2xl","text-indigo-600"],[1,"text-lg","font-semibold","text-gray-800"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","disabled:bg-indigo-300","disabled:cursor-not-allowed","flex","items-center","space-x-2",3,"click","disabled"],[1,"w-5","h-5","border-2","border-white","border-t-transparent","rounded-full","animate-spin"],[1,"text-gray-500"],[1,"text-gray-500","animate-pulse"],[1,"bg-red-50","text-red-700","p-4","rounded-lg"],[1,"flex","flex-col","items-center","space-y-2"],[1,"w-8","h-8","border-3","border-indigo-200","border-t-indigo-600","rounded-full","animate-spin"],[1,"font-semibold"],[1,"mb-3"],[1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-50",3,"ngModelChange","ngModel"],["value","all"],["value","regular"],["value","cigar"],["value","shareholder"],[1,"relative","mb-4"],["type","text","placeholder","\u4F9D\u59D3\u540D\u6216\u96FB\u8A71\u641C\u5C0B...",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","pl-10","bg-gray-50",3,"ngModelChange","ngModel"],["name","search-outline",1,"absolute","left-3","top-1/2","-translate-y-1/2","text-gray-400"],[1,"flex-1","overflow-y-auto","-mx-2","px-2"],[1,"space-y-2"],[1,"p-3","rounded-lg","cursor-pointer","transition-colors",3,"bg-indigo-100","hover:bg-gray-100"],[1,"text-center","text-gray-500","py-4"],[1,"p-3","rounded-lg","cursor-pointer","transition-colors",3,"click"],[1,"flex","justify-between","items-center"],[1,"font-medium","text-gray-800"],[1,"text-xs","font-semibold","px-2","py-1","rounded-full"],[1,"flex","justify-between","items-start"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-sm","font-semibold","px-2","py-1","rounded-full","mt-1","inline-block"],[1,"text-gray-500","hover:text-gray-700",3,"click"],["name","close-circle-outline",1,"text-2xl"],[1,"mt-4","grid","grid-cols-2","md:grid-cols-3","gap-4","text-sm","border-t","pt-4"],[1,"block","text-gray-500"],[1,"text-gray-800"],[1,"text-gray-800","font-bold"],[1,"mt-4","pt-4","border-t","text-sm"],[1,"bg-white","p-6","rounded-xl","shadow-md","mt-8"],[1,"overflow-x-auto","max-h-60"],[1,"w-full","text-sm","text-left","text-gray-500"],[1,"block","text-gray-500","mb-1"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50","sticky","top-0"],[1,"px-4","py-2"],[1,"px-4","py-2","text-right"],[1,"bg-white","border-b","hover:bg-gray-50"],[1,"px-4","py-2","text-right","font-medium"],[1,"text-center"],["name","person-add-outline",1,"text-5xl","text-gray-400"],[1,"mt-2","text-gray-500"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6","text-sm"],[1,"font-semibold","text-gray-800","mb-2"],[1,"bg-indigo-50","p-4","rounded-lg","mb-4"],[1,"list-disc","list-inside","space-y-2","text-gray-600","bg-gray-50","p-4","rounded-lg"],[1,"font-semibold","text-indigo-800"],[1,"text-indigo-700","mt-1"],[1,"font-medium"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"h1",1),m(2,"\u9867\u5BA2\u7BA1\u7406"),u(),l(3,"div",2)(4,"div",3)(5,"div",4),x(6,"ion-icon",5),u(),l(7,"div")(8,"p",6),m(9,"\u7E3D\u9867\u5BA2\u6578"),u(),l(10,"p",7),m(11),u()()(),l(12,"div",3)(13,"div",8),x(14,"ion-icon",9),u(),l(15,"div")(16,"p",6),m(17,"\u4E00\u822C\u9867\u5BA2"),u(),l(18,"p",7),m(19),u()()(),l(20,"div",3)(21,"div",10),x(22,"ion-icon",11),u(),l(23,"div")(24,"p",6),m(25,"\u96EA\u8304\u6703\u54E1"),u(),l(26,"p",7),m(27),u()()(),l(28,"div",3)(29,"div",12),x(30,"ion-icon",13),u(),l(31,"div")(32,"p",6),m(33,"\u80A1\u6771"),u(),l(34,"p",7),m(35),u()()()(),l(36,"div",14)(37,"div",15)(38,"h3",16),m(39,"\u9867\u5BA2\u5217\u8868"),u(),P(40,pO,5,0,"div",17),P(41,gO,5,1,"div",18),P(42,vO,18,3),u(),l(43,"div",19),P(44,SO,49,13,"div")(45,DO,5,0,"div",20),u()(),l(46,"div",21)(47,"div",22)(48,"div",23),x(49,"ion-icon",24),l(50,"h3",25),m(51,"\u9867\u5BA2\u884C\u70BA\u5206\u6790 (\u6574\u9AD4)"),u()(),l(52,"button",26),S("click",function(){return i.runBasketAnalysis()}),P(53,wO,1,0,"div",27),l(54,"span"),m(55,"\u5206\u6790\u8CFC\u7269\u7C43"),u()()(),P(56,TO,2,0,"p",28)(57,IO,2,0,"p",29)(58,MO,5,1,"div",30)(59,FO,1,1),u()()),t&2){let r,o;h(11),E(i.customerStats().total),h(8),E(i.customerStats().regularCount),h(8),E(i.customerStats().cigarCount),h(8),E(i.customerStats().shareholderCount),h(5),F(i.isLoading()?40:-1),h(),F(i.errorMessage()?41:-1),h(),F(i.isLoading()?-1:42),h(2),F((r=i.selectedCustomer())?44:45,r),h(8),N("disabled",i.geminiService.basketAnalysisState()==="loading"),h(),F(i.geminiService.basketAnalysisState()==="loading"?53:-1),h(3),F((o=i.geminiService.basketAnalysisState())==="idle"?56:o==="loading"?57:o==="error"?58:o==="success"?59:-1)}},dependencies:[oe,Ee,Fe,ke,xe,Ae,ge,we,Ka],encapsulation:2,changeDetection:0});var Yf=Ns;var fo=class fo{constructor(){this.mockTargetGoals=D([{id:"TG001",title:"\u516B\u6708\u7E3D\u71DF\u6536\u76EE\u6A19",type:"\u71DF\u6536",targetValue:35e4,currentValue:289190,startDate:"2024-08-01",endDate:"2024-08-31",status:"\u9032\u884C\u4E2D",unit:"\u5143",assigneeId:"USR002",period:"monthly"},{id:"TG002",title:"\u5341\u6708\u6D3B\u52D5\u5834\u6B21",type:"\u6D3B\u52D5",targetValue:15,currentValue:13,startDate:"2024-10-01",endDate:"2024-10-31",status:"\u9032\u884C\u4E2D",unit:"\u5834",assigneeId:"USR003",period:"monthly"},{id:"TG003",title:"\u7B2C\u4E09\u5B63 VIP \u9867\u5BA2\u589E\u9577",type:"\u9867\u5BA2",targetValue:10,currentValue:12,startDate:"2024-07-01",endDate:"2024-09-30",status:"\u5DF2\u9054\u6210",unit:"\u4EBA",assigneeId:"USR003",period:"monthly"},{id:"TG004",title:"\u7B2C\u56DB\u5B63\u9867\u5BA2\u6EFF\u610F\u5EA6\u63D0\u5347",type:"\u9867\u5BA2",targetValue:5,currentValue:4,startDate:"2024-10-01",endDate:"2024-12-31",status:"\u9032\u884C\u4E2D",unit:"\u5206",period:"monthly"},{id:"TG005",title:"2024\u5E74\u5E74\u5EA6\u7E3D\u71DF\u6536",type:"\u71DF\u6536",targetValue:4e6,currentValue:285e4,startDate:"2024-01-01",endDate:"2024-12-31",status:"\u9032\u884C\u4E2D",unit:"\u5143",period:"yearly"},{id:"TG006",title:"2024\u5E74\u7E3D\u6D3B\u52D5\u5834\u6B21",type:"\u6D3B\u52D5",targetValue:100,currentValue:85,startDate:"2024-01-01",endDate:"2024-12-31",status:"\u9032\u884C\u4E2D",unit:"\u5834",assigneeId:"USR003",period:"yearly"}]);this.mockEvents=D([{id:"EVT001",type:"\u5BB4\u5BA2",status:"active",date:"2024-10-03",name:"\u52DE\u502B\u65AF",attendees:"10~15",estimatedRevenue:19e3,actualRevenue:20980,notes:"\u9152\u5546\u8CBB: 9600/\u9910\u9EDE: \u4EBA600"},{id:"EVT002",type:"\u76AE\u5361",status:"active",date:"2024-10-04",time:"14:30~18:30",name:"\u5361\u724C",attendees:"10~15",estimatedRevenue:8e3,actualRevenue:8540},{id:"EVT003",type:"\u5546\u52D9\u3001\u5E97\u5167",status:"active",date:"2024-10-07",name:"\u6F2B\u9727",attendees:"6",estimatedRevenue:4200,actualRevenue:4900,notes:"\u662F\u5426\u8ABF\u6574"},{id:"EVT004",type:"\u5BB4\u5BA2",status:"active",date:"2024-10-13",name:"Dave",attendees:"8~10",estimatedRevenue:15e3,actualRevenue:24080,notes:"8000/\u4E2D\u5F0F"},{id:"EVT005",type:"\u76AE\u5361",status:"active",date:"2024-10-14",time:"14:30~18:00",name:"TCBA",organizer:"\u76AE\u5361",attendees:"8",estimatedRevenue:4e3,actualRevenue:4e3,notes:"\u4EBA/530"},{id:"EVT006",type:"\u5E97\u5167",status:"cancelled",date:"2024-10-17",name:"\u70C8\u9152\u54C1\u9152\u6703",attendees:"0",estimatedRevenue:0,actualRevenue:0},{id:"EVT007",type:"\u7DAD\u7DB8",status:"active",date:"2024-10-18",time:"\u665A\u4E0A18:00\u5F8C",name:"slp\u5275\u696D\u5B78\u9662",attendees:"70",estimatedRevenue:7e4,deposit:21e3,actualRevenue:77640,notes:"\u8A02\u91D1\u5DF2\u6536"},{id:"EVT008",type:"\u7D05\u767D\u806F\u8ABC",status:"active",date:"2024-10-19",time:"14:00~17:00",name:"\u5C0F\u745C",attendees:"7",estimatedRevenue:36e3,actualRevenue:7e3,notes:"\u9152\u5546\u8CBB: 12000~14000/\u4EBA\u6578: \u7537\u5973\u5C0D\u534A \u5C0F\u745C\u62BD500\u5143/\u4EBA"},{id:"EVT009",type:"\u5E97\u5167",status:"active",date:"2024-10-22",name:"\u7D05\u767D\u9152\u54C1\u6703",attendees:"4",estimatedRevenue:15e3,actualRevenue:6e3,notes:"\u9152\u5546\u8CBB: 12000 \u8CBB\u7528: 1,500\u5143/\u4EBA 4\u96BB\u9152/\u642D\u914D\u98A8\u5473\u98DF\u7269"},{id:"EVT010",type:"\u6D3B\u52D5",status:"cancelled",date:"2024-10-23",time:"19:00~22:00",name:"Scott",organizer:"Scott",attendees:"0",estimatedRevenue:0,actualRevenue:0,notes:"1\u4EBA/400"},{id:"EVT011",type:"\u7DAD\u7DB8",status:"active",date:"2024-10-25",time:"\u665A\u4E0A18:00\u5F8C",name:"slp\u5275\u696D\u5B78\u9662",attendees:"55",estimatedRevenue:7e4,deposit:21e3,actualRevenue:74010,notes:"\u8A02\u91D1\u5DF2\u6536"},{id:"EVT012",type:"Laurence",status:"active",date:"2024-10-26",time:"\u4E0B\u5348\u958B\u5E55",name:"\u516C\u53F8\u958B\u5E55",attendees:"30",estimatedRevenue:1e4,actualRevenue:1e4},{id:"EVT013",type:"\u80A1\u6771\u6703",status:"active",date:"2024-10-28",name:"\u80A1\u6771\u6703",attendees:"5",estimatedRevenue:0,actualRevenue:0},{id:"EVT014",type:"\u5BA2\u6236",status:"active",date:"2024-10-29",name:"Connyn",attendees:"20~25",estimatedRevenue:15e3,actualRevenue:15e3,notes:"\u83DC: 15000"},{id:"EVT015",type:"\u76AE\u5361",status:"active",date:"2024-10-30",time:"\u665A\u4E0A18:00\u5F8C",name:"\u5361\u724C",organizer:"\u76AE\u5361",attendees:"8",estimatedRevenue:4e3,actualRevenue:12890},{id:"EVT016",type:"\u5E97\u5167",status:"active",date:"2024-10-31",name:"\u6F2B\u9727",attendees:"6",estimatedRevenue:8400,actualRevenue:4900},{id:"EVT017",type:"\u5546\u52D9",status:"active",date:"2024-08-01",name:"\u6F2B\u9727",attendees:"20",estimatedRevenue:2e4,actualRevenue:21450},{id:"EVT018",type:"\u79C1\u4EBA",status:"active",date:"2024-08-09",name:"\u555F\u5E06",attendees:"5",estimatedRevenue:2e3,actualRevenue:1900},{id:"EVT019",type:"\u79C1\u4EBA",status:"active",date:"2024-08-13",name:"\u555F\u5E06",attendees:"10",estimatedRevenue:0,actualRevenue:0},{id:"EVT020",type:"\u5BB4\u5BA2",status:"active",date:"2024-08-14",name:"vic / jackle",attendees:"15",estimatedRevenue:18e3,actualRevenue:2e4},{id:"EVT021",type:"\u5546\u52D9",status:"active",date:"2024-08-22",name:"\u6F2B\u9727",attendees:"12",estimatedRevenue:1e4,actualRevenue:10155},{id:"EVT022",type:"\u79C1\u4EBA",status:"active",date:"2024-08-27",name:"\u555F\u5E06",attendees:"8",estimatedRevenue:8e3,actualRevenue:9300},{id:"EVT023",type:"\u54C1\u9152\u6703",status:"active",date:"2024-08-28",name:"\u5167\u90E8\u54C1\u9152",attendees:"10",estimatedRevenue:1e4,actualRevenue:10700}]);this.mockDailyRevenue=D([{date:"2024-08-01",nonEventRevenue:10520,isDayOff:!1},{date:"2024-08-02",nonEventRevenue:3340,isDayOff:!1},{date:"2024-08-03",nonEventRevenue:970,isDayOff:!1},{date:"2024-08-04",nonEventRevenue:0,isDayOff:!0},{date:"2024-08-05",nonEventRevenue:200,isDayOff:!1},{date:"2024-08-06",nonEventRevenue:0,isDayOff:!1},{date:"2024-08-07",nonEventRevenue:0,isDayOff:!1},{date:"2024-08-08",nonEventRevenue:17950,isDayOff:!1},{date:"2024-08-09",nonEventRevenue:6800,isDayOff:!1},{date:"2024-08-10",nonEventRevenue:8410,isDayOff:!1},{date:"2024-08-11",nonEventRevenue:0,isDayOff:!0},{date:"2024-08-12",nonEventRevenue:8970,isDayOff:!1},{date:"2024-08-13",nonEventRevenue:14900,isDayOff:!1},{date:"2024-08-14",nonEventRevenue:14130,isDayOff:!1},{date:"2024-08-15",nonEventRevenue:23630,isDayOff:!1},{date:"2024-08-16",nonEventRevenue:10740,isDayOff:!1},{date:"2024-08-17",nonEventRevenue:6090,isDayOff:!1},{date:"2024-08-18",nonEventRevenue:0,isDayOff:!0},{date:"2024-08-19",nonEventRevenue:7500,isDayOff:!1},{date:"2024-08-20",nonEventRevenue:1860,isDayOff:!1},{date:"2024-08-21",nonEventRevenue:700,isDayOff:!1},{date:"2024-08-22",nonEventRevenue:-845,isDayOff:!1},{date:"2024-08-23",nonEventRevenue:36100,isDayOff:!1},{date:"2024-08-24",nonEventRevenue:3140,isDayOff:!1},{date:"2024-08-25",nonEventRevenue:0,isDayOff:!0},{date:"2024-08-26",nonEventRevenue:2180,isDayOff:!1},{date:"2024-08-27",nonEventRevenue:4720,isDayOff:!1},{date:"2024-08-28",nonEventRevenue:17600,isDayOff:!1},{date:"2024-08-29",nonEventRevenue:18560,isDayOff:!1},{date:"2024-08-30",nonEventRevenue:11500,isDayOff:!1},{date:"2024-08-31",nonEventRevenue:4850,isDayOff:!1}]);this.mockEmployees=D([{id:"EMP001",name:"\u738B\u5C0F\u660E",type:"full-time",monthlySalary:55e3},{id:"EMP002",name:"\u9673\u7F8E\u9E97",type:"full-time",monthlySalary:62e3},{id:"EMP003",name:"\u674E\u5927\u885B",type:"part-time",hourlyRate:200},{id:"EMP004",name:"\u5F35\u4F73\u73B2",type:"part-time",hourlyRate:200},{id:"EMP005",name:"\u9EC3\u5FD7\u5F37",type:"part-time",hourlyRate:200}]);this.mockPunchRecords=D([{employeeId:"EMP003",date:"2024-08-01",clockIn:"10:00",clockOut:"18:30",isDoublePay:!1},{employeeId:"EMP003",date:"2024-08-02",clockIn:"10:05",clockOut:"17:55",isDoublePay:!1},{employeeId:"EMP003",date:"2024-08-05",clockIn:"14:00",clockOut:"22:15",isDoublePay:!1},{employeeId:"EMP003",date:"2024-08-06",clockIn:"13:58",clockOut:"22:05",isDoublePay:!1},{employeeId:"EMP003",date:"2024-08-08",clockIn:"10:00",clockOut:"14:00",isDoublePay:!1},{employeeId:"EMP003",date:"2024-08-09",clockIn:"09:55",clockOut:"18:00",isDoublePay:!0},{employeeId:"EMP003",date:"2024-08-12",clockIn:"10:00",clockOut:"18:00",isDoublePay:!1},{employeeId:"EMP003",date:"2024-08-13",clockIn:"10:00",clockOut:"18:00",isDoublePay:!1},{employeeId:"EMP003",date:"2024-08-15",clockIn:"10:00",clockOut:null,isDoublePay:!1},{employeeId:"EMP003",date:"2024-08-16",clockIn:"14:00",clockOut:"22:00",isDoublePay:!1},{employeeId:"EMP004",date:"2024-08-01",clockIn:"18:00",clockOut:"22:00",isDoublePay:!1},{employeeId:"EMP004",date:"2024-08-03",clockIn:"18:00",clockOut:"22:30",isDoublePay:!1},{employeeId:"EMP004",date:"2024-08-07",clockIn:"17:55",clockOut:"22:01",isDoublePay:!1},{employeeId:"EMP004",date:"2024-08-10",clockIn:"17:30",clockOut:"22:30",isDoublePay:!1},{employeeId:"EMP004",date:"2024-08-14",clockIn:"18:00",clockOut:"22:00",isDoublePay:!1},{employeeId:"EMP004",date:"2024-08-17",clockIn:"18:00",clockOut:"22:00",isDoublePay:!1},{employeeId:"EMP005",date:"2024-08-20",clockIn:"12:00",clockOut:"20:00",isDoublePay:!1},{employeeId:"EMP005",date:"2024-08-21",clockIn:"12:05",clockOut:"20:08",isDoublePay:!1},{employeeId:"EMP005",date:"2024-08-22",clockIn:null,clockOut:"20:00",isDoublePay:!1},{employeeId:"EMP005",date:"2024-08-24",clockIn:"11:58",clockOut:"20:03",isDoublePay:!1}]);this.mockTransactions=D([{id:"TXN001",date:"2025-12-16",item:"\u8CA0\u50B5",category:"\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8",amount:-66350,approved:!0},{id:"TXN002",date:"2025-12-17",item:"\u71DF\u696D\u6536\u5165",category:"-\u92B7\u6216\u6298\u8B93",amount:0,approved:!0},{id:"TXN003",date:"2025-12-17",item:"\u71DF\u696D\u6536\u5165",category:"\u92B7\u8CA8\u6536\u5165",amount:1150,approved:!1},{id:"TXN004",date:"2025-12-17",item:"\u8CC7\u7522",category:"\u71DF\u696D\u8A2D\u5099",amount:-295,vendorName:"\u8766\u76AE",description:"\u53EF\u9E97\u9732\u70E4\u76E4",approved:!0},{id:"TXN005",date:"2025-12-18",item:"\u71DF\u696D\u6536\u5165",category:"-\u92B7\u6216\u6298\u8B93",amount:-2862,approved:!0},{id:"TXN006",date:"2025-12-18",item:"\u71DF\u696D\u6536\u5165",category:"\u92B7\u8CA8\u6536\u5165",amount:17440,approved:!0},{id:"TXN007",date:"2025-12-19",item:"\u71DF\u696D\u6536\u5165",category:"-\u92B7\u6216\u6298\u8B93",amount:-191,approved:!0},{id:"TXN008",date:"2025-12-19",item:"\u71DF\u696D\u8CBB\u7528",category:"\u6587\u5177\u7528\u54C1",amount:-100,vendorTaxId:"14713177",vendorName:"\u91D1\u5409\u523B\u5370\u884C",approved:!0},{id:"TXN009",date:"2025-12-19",item:"\u71DF\u696D\u8CBB\u7528",category:"\u6587\u5177\u7528\u54C1",amount:-7,invoiceNumber:"VF-79457330",vendorTaxId:"90113315",vendorName:"\u5168\u65B9\u4F4D\u6578\u4F4D\u8F38\u51FA\u6709\u9650\u516C\u53F8\u5357\u4EAC\u6771\u8DEF\u5206\u516C\u53F8",approved:!0},{id:"TXN010",date:"2025-12-19",item:"\u71DF\u696D\u8CBB\u7528",category:"\u6587\u5177\u7528\u54C1",amount:-114,invoiceNumber:"UB-05014356",vendorTaxId:"97616452",vendorName:"\u5168\u806F\u798F\u5229\u4E2D\u5FC3",approved:!1},{id:"TXN011",date:"2025-12-19",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9152\u6C34",amount:-5580,vendorName:"\u6DFB\u6F64\u6D0B\u884C",approved:!0},{id:"TXN012",date:"2025-12-19",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-189,invoiceNumber:"12170425",vendorName:"\u89AA\u6C11\u98DF\u54C1\u6709\u9650\u516C\u53F8",approved:!0},{id:"TXN013",date:"2025-12-19",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-427,vendorName:"\u6D0B\u83EF\u9BAE\u98DF\u5BE6\u696D\u6709\u9650\u516C\u53F8",approved:!0},{id:"TXN014",date:"2025-12-19",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-280,invoiceNumber:"UK88724800",vendorName:"\u958B\u5143\u98DF\u54C1\u5DE5\u696D\u80A1\u4EFD\u6709\u9650\u516C\u53F8",approved:!0},{id:"TXN015",date:"2025-12-19",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-45,invoiceNumber:"111412191194",vendorTaxId:"79997612",vendorName:"\u570B\u8C50\u5546\u884C\u6709\u9650\u516C\u53F8",approved:!0},{id:"TXN016",date:"2025-12-19",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-1874,vendorTaxId:"79997612",vendorName:"\u570B\u8C50\u5546\u884C\u6709\u9650\u516C\u53F8",approved:!0},{id:"TXN017",date:"2025-12-19",item:"\u71DF\u696D\u6536\u5165",category:"\u92B7\u8CA8\u6536\u5165",amount:9280,approved:!0},{id:"TXN018",date:"2025-12-20",item:"\u71DF\u696D\u6536\u5165",category:"-\u92B7\u6216\u6298\u8B93",amount:-4349,approved:!1},{id:"TXN019",date:"2025-12-20",item:"\u71DF\u696D\u8CBB\u7528",category:"\u6587\u5177\u7528\u54C1",amount:-240,vendorTaxId:"93138304",vendorName:"\u798F\u5BF6\u523B\u5370\u884C",approved:!0},{id:"TXN020",date:"2025-12-20",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-72,invoiceNumber:"UB-05015759",vendorTaxId:"97616452",vendorName:"\u5168\u806F\u798F\u5229\u4E2D\u5FC3",approved:!0},{id:"TXN021",date:"2025-12-20",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-568,invoiceNumber:"UB-05015750",vendorTaxId:"97616452",vendorName:"\u5168\u806F\u798F\u5229\u4E2D\u5FC3",approved:!0},{id:"TXN022",date:"2025-12-20",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-160,vendorName:"\u5E02\u5834",approved:!0},{id:"TXN023",date:"2025-12-20",item:"\u71DF\u696D\u8CBB\u7528",category:"\u62DC\u62DC\u8CBB\u7528",amount:-198,invoiceNumber:"UN-74686337",vendorTaxId:"28983777",vendorName:"7-ELEVEN",approved:!0},{id:"TXN024",date:"2025-12-20",item:"\u71DF\u696D\u6536\u5165",category:"\u92B7\u8CA8\u6536\u5165",amount:25310,approved:!0},{id:"TXN025",date:"2025-12-21",item:"\u71DF\u696D\u6536\u5165",category:"-\u92B7\u6216\u6298\u8B93",amount:-1612,approved:!0},{id:"TXN026",date:"2025-12-21",item:"\u71DF\u696D\u6536\u5165",category:"\u92B7\u8CA8\u6536\u5165",amount:14660,approved:!0},{id:"TXN027",date:"2025-12-22",item:"\u71DF\u696D\u8CBB\u7528",category:"\u8CB8\u6B3E\u5229\u606F",amount:-3824,approved:!0},{id:"TXN028",date:"2025-12-22",item:"\u71DF\u696D\u6536\u5165",category:"-\u92B7\u6216\u6298\u8B93",amount:0,approved:!0},{id:"TXN029",date:"2025-12-23",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-2020,invoiceNumber:"SO1412221261",vendorTaxId:"22161107",vendorName:"\u9F0E\u8000\u98DF\u54C1\u80A1\u4EFD\u6709\u9650\u516C\u53F8",approved:!0},{id:"TXN030",date:"2025-12-23",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-36,invoiceNumber:"UB-15207729",vendorTaxId:"97616452",vendorName:"\u5168\u806F\u798F\u5229\u4E2D\u5FC3",approved:!1},{id:"TXN031",date:"2025-12-23",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-150,invoiceNumber:"UB-15209268",vendorTaxId:"97616452",vendorName:"\u5168\u806F\u798F\u5229\u4E2D\u5FC3",approved:!0},{id:"TXN032",date:"2025-12-23",item:"\u71DF\u696D\u6536\u5165",category:"\u92B7\u8CA8\u6536\u5165",amount:2650,approved:!0}]);this.mockVendors=D([{id:"V001",category:"\u98DF\u6750",name:"\u570B\u8C50",contactInfo:"\u696D\u52D9line @926yleos",restDays:"\u516D\u3001\u65E5",taxId:"79997612"},{id:"V002",category:"\u98DF\u6750",name:"\u570B\u6210",contactInfo:"(02)8671-9056",restDays:"\u516D\u3001\u65E5"},{id:"V003",category:"\u5976\u88FD/\u96DE\u7FC5",name:"\u958B\u5143",contactInfo:"\u696D\u52D9 MR.\u8F9C 0916-250-990",restDays:"\u516D\u3001\u65E5",taxId:"UK88724800"},{id:"V004",category:"\u51B0\u6DC7\u6DCB",name:"\u5408\u7A40",contactInfo:"(03)3578-130",restDays:"\u516D\u3001\u65E5"},{id:"V005",category:"\u53EF\u980C",name:"\u89AA\u6C11",contactInfo:"(02)2999-9381",restDays:"\u516D\u3001\u65E5"},{id:"V006",category:"\u8C9D\u679C",name:"\u5E03\u6717\u4E3B\u5EDA",contactInfo:"\u696D\u52D9line @928ebhwu",restDays:"\u516D\u3001\u65E5"},{id:"V007",category:"\u86CB\u7CD5",name:"\u897F\u9EDE\u5C0F\u8216",contactInfo:"\u7DB2\u9801\u4E0B\u55AE, (02)2995-0596",restDays:"\u4E8C\u3001\u4E09\u3001\u56DB\u3001\u516D\u3001\u65E5"},{id:"V008",category:"\u9152",name:"\u5229\u591A\u5409",contactInfo:"Line",restDays:"\u65E5\u3001\u4E00"},{id:"V009",category:"\u9152",name:"\u4E5D\u6A3D",contactInfo:"(02)7728-6670",restDays:"\u516D\u3001\u65E5"},{id:"V010",category:"\u9152",name:"\u9152\u9F0E",contactInfo:"(02)2578-1515",restDays:"\u516D\u3001\u65E5"},{id:"V011",category:"\u8017\u6750",name:"\u6613\u9054\u8C50",contactInfo:"\u696D\u52D9line 0926077730",restDays:"-"},{id:"V012",category:"\u5236\u670D",name:"\u570B\u8C6A",contactInfo:"\u738B\u5730\u7FA9 0932-036356",restDays:"-"},{id:"V013",category:"\u65B9\u51B0\u584A",name:"\u5FEB\u6A02\u51B0\u584A",contactInfo:"0932-357-696",restDays:"-"},{id:"V014",category:"\u83DC\u5546",name:"\u6D25\u83EF",contactInfo:"(02)2307-5255",restDays:"-"},{id:"V015",category:"\u6536\u5EE2\u6CB9",name:"\u5C24\u52A0\u5229",contactInfo:"0909-511-256 \u6797\u5955\u9716 02-8287 5522",restDays:"\u4E8C\u4E09\u56DB\u516D\u65E5"},{id:"V016",category:"\u6536\u5EE2\u6CB9",name:"\u6C38\u745E",contactInfo:"07-6161-580 \u8521\u4F73\u6210 0965-659-532",restDays:"\u9808\u63D0\u524D\u5B89\u6392"},{id:"V017",category:"\u725B\u8C6C\u8089",name:"\u7F8E\u798F",contactInfo:"(02)8791-9688",restDays:"\u516D\u3001\u65E5, \u5207\u8089\u52A01\u5929"},{id:"V018",category:"\u5496\u5561\u8C46",name:"\u4E0A\u7FA4",contactInfo:"(02)2504-2715",restDays:"\u516D\u3001\u65E5"},{id:"V019",category:"\u6D77\u9BAE",name:"\u81FB\u7FD4",contactInfo:"(02)2223-9647",restDays:"\u65E5\u3001\u4E00"},{id:"V020",category:"\u74E6\u65AF",name:"\u9806\u5B89",contactInfo:"(02)2765-7778",restDays:"-"},{id:"V021",category:"\u5E03",name:"\u69AE\u51A0\u5462\u7D68",contactInfo:"022556-6668 \u5468\u69AE\u4E7E 0931-337-876",restDays:"-"},{id:"V022",category:"\u98DF\u6750",name:"\u9F0E\u8000",contactInfo:"APP\u4E0B\u55AE, (02) 2910-6111",restDays:"\u65E5",taxId:"22161107"},{id:"V023",category:"\u9152",name:"\u5C1A\u5FB7",contactInfo:"Line",restDays:"\u516D\u3001\u65E5"},{id:"V024",category:"\u98DF\u6750",name:"COSTCO",contactInfo:"\u81EA\u884C\u63A1\u8CB7",restDays:"-"}]);this.mockPurchaseOrders=D([{id:"PO001",poNumber:"PO-2024-001",vendorId:"V001",date:"2024-08-05",items:[{productName:"\u7279\u7D1A\u521D\u69A8\u6A44\u6B16\u6CB9",quantity:10,unitPrice:350,total:3500},{productName:"\u7FA9\u5927\u5229\u9EB5",quantity:20,unitPrice:80,total:1600}],totalAmount:5100},{id:"PO002",poNumber:"PO-2024-002",vendorId:"V009",date:"2024-08-10",items:[{productName:"\u6CE2\u723E\u591A\u7D05\u9152",quantity:12,unitPrice:800,total:9600},{productName:"\u590F\u5E03\u5229\u767D\u9152",quantity:6,unitPrice:950,total:5700}],totalAmount:15300},{id:"PO003",poNumber:"PO-2024-003",vendorId:"V017",date:"2024-08-12",items:[{productName:"\u7F8E\u570B Prime \u7D1A\u808B\u773C\u725B\u6392",quantity:5,unitPrice:1200,total:6e3}],totalAmount:6e3}]);this.mockProductCosts=D([{id:"PC001",productId:"LIQ-001",productName:"\u544A\u767D",vendorId:"V023",category:"\u9152\u6C34",itemQuantity:700,itemUnit:"ml",totalUnit:"\u74F6",price:280},{id:"PC002",productId:"LIQ-002",productName:"\u73AB\u7470\u5564\u9152",vendorId:"V023",category:"\u9152\u6C34",itemQuantity:700,itemUnit:"ml",totalUnit:"\u74F6",price:420},{id:"PC003",productId:"LIQ-003",productName:"\u6A59\u9152",vendorId:"V023",category:"\u9152\u6C34",itemQuantity:700,itemUnit:"ml",totalUnit:"\u74F6",price:520},{id:"PC004",productId:"LIQ-004",productName:"\u91D1\u8CD3\u5A01\u58EB\u5FCC",vendorId:"V023",category:"\u9152\u6C34",itemQuantity:700,itemUnit:"ml",totalUnit:"\u74F6",price:330},{id:"PC005",productId:"LIQ-005",productName:"\u7259\u8CB7\u52A0\u9EA5\u65AF\u8FA3\u59C6\u9152",vendorId:"V023",category:"\u9152\u6C34",itemQuantity:1e3,itemUnit:"ml",totalUnit:"\u74F6",price:420},{id:"PC006",productId:"LIQ-006",productName:"\u99AC\u4E01\u5C3C\u767D\u9999\u827E\u9152",vendorId:"V023",category:"\u9152\u6C34",itemQuantity:750,itemUnit:"ml",totalUnit:"\u74F6",price:420},{id:"PC007",productId:"LIQ-007",productName:"Kahkua\u5496\u5561\u5229\u53E3\u9152",vendorId:"V023",category:"\u9152\u6C34",itemQuantity:750,itemUnit:"ml",totalUnit:"\u74F6",price:430},{id:"PC013",productId:"FOD-001",productName:"\u5BAE\u4FDD\u96DE\u4E01",vendorId:"V024",category:"\u98DF\u6750",itemQuantity:1200,itemUnit:"g",totalUnit:"\u5305",price:358},{id:"PC014",productId:"FOD-002",productName:"Swiss Delice 72%\u9ED1\u5DE7\u514B\u529B",vendorId:"V024",category:"\u98DF\u6750",itemQuantity:216,itemUnit:"\u9846",totalUnit:"\u5305",price:879},{id:"PC015",productId:"FOD-003",productName:"\u5805\u679C",vendorId:"V024",category:"\u98DF\u6750",itemQuantity:1070,itemUnit:"g",totalUnit:"\u7F50",price:659},{id:"PC016",productId:"LIQ-013",productName:"\u767E\u52A0\u5F97\u862D\u59C6\u9152",vendorId:"V024",category:"\u9152\u6C34",itemQuantity:1e3,itemUnit:"ml",totalUnit:"\u74F6",price:469},{id:"PC017",productId:"LIQ-014",productName:"\u7F8E\u570B\u4F0F\u7279\u52A0",vendorId:"V024",category:"\u9152\u6C34",itemQuantity:1750,itemUnit:"ml",totalUnit:"\u74F6",price:375},{id:"PC018",productId:"LIQ-015",productName:"\u79D1\u514B\u862D\u9F8D\u820C\u862D\u9152",vendorId:"V024",category:"\u9152\u6C34",itemQuantity:1750,itemUnit:"ml",totalUnit:"\u74F6",price:769},{id:"PC019",productId:"LIQ-016",productName:"\u79D1\u514B\u862D\u7434\u9152",vendorId:"V024",category:"\u9152\u6C34",itemQuantity:1750,itemUnit:"ml",totalUnit:"\u74F6",price:495},{id:"PC020",productId:"LIQ-017",productName:"\u9AD8\u767B\u7C89\u7D05\u7434\u9152",vendorId:"V024",category:"\u9152\u6C34",itemQuantity:1e3,itemUnit:"ml",totalUnit:"\u74F6",price:549}]);this.mockWineCosts=D([{id:"W01",vendor:"\u5C1A\u5FB7",productName:"\u544A\u767D",type:"\u767D\u6C23\u6CE1",cost:280,sellingPrice:1100},{id:"W02",vendor:"\u4E5D\u6A3D",productName:"Primo Amore Moscato Delle Venezie IGT \u521D\u6200",type:"\u751C\u767D",cost:450,sellingPrice:1100},{id:"W03",vendor:"\u4E5D\u6A3D",productName:"Francois Confuron Gindre Bourgogne (2020)",type:"\u767D\u9152",cost:1150,sellingPrice:2300},{id:"W04",vendor:"\u4E5D\u6A3D",productName:"Moet & Chandon",type:"\u9999\u6AB3",cost:1650,sellingPrice:3500},{id:"W05",vendor:"\u4E5D\u6A3D",productName:"McManis Cab. Sau (2022)",type:"\u7D05\u9152",cost:550,sellingPrice:1100},{id:"W06",vendor:"\u4E5D\u6A3D",productName:"Botter Cuvee16 Limited Edition Rosso Vino 16\u6A02\u7AE0",type:"\u7D05\u9152",cost:750,sellingPrice:2200},{id:"W07",vendor:"\u4E5D\u6A3D",productName:"Saint-Estephe Calon Segur \u5361\u9686\u8CFD\u683C\u4E09\u8ECD (2015)",type:"\u7D05\u9152",cost:1350,sellingPrice:3e3},{id:"W08",vendor:"\u9152\u9F0E",productName:"Adobe Reserva Sauvignon White (2018)",type:"\u767D\u9152",cost:550,sellingPrice:1600},{id:"W09",vendor:"\u9152\u9F0E",productName:"De Martino Estate Cabernet Sauvignon (2022)",type:"\u7D05\u9152",cost:480,sellingPrice:1800},{id:"W10",vendor:"\u9152\u9F0E",productName:"Adobe Reserva Sauvignon Red (2021)",type:"\u7D05\u9152",cost:550,sellingPrice:1600},{id:"W11",vendor:"\u5409\u591A\u5229",productName:"Santero Dile Moscato sweet\u5929\u4F7F\u4E4B\u624B",type:"\u767D\u6C23\u6CE1",cost:285,sellingPrice:1100},{id:"W12",vendor:"\u5409\u591A\u5229",productName:"Louis Eschenauer 24K Carat Gold Muscat Sparkling",type:"\u767D\u6C23\u6CE1",cost:520,sellingPrice:1600},{id:"W13",vendor:"\u5409\u591A\u5229",productName:"Joly de Tr\xE9buis R\xE9serve Brut Champagne",type:"\u9999\u6AB3",cost:1100,sellingPrice:2800},{id:"W14",vendor:"\u5409\u591A\u5229",productName:"Dark Horse Cabernet Sauvignon",type:"\u7D05\u9152",cost:480,sellingPrice:1450},{id:"W15",vendor:"\u5409\u591A\u5229",productName:"Domaine Viticole de la Ville de Colmar Signature de Colmar Pinot Noir",type:"\u7D05\u9152",cost:630,sellingPrice:1600},{id:"W16",vendor:"\u6DFB\u6F64",productName:"Glendronach \u683C\u862D\u591A\u7D0D12\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1150,sellingPrice:3200},{id:"W17",vendor:"\u6DFB\u6F64",productName:"Aberlour \u4E9E\u4F2F\u6A0212\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1100,sellingPrice:3200},{id:"W18",vendor:"\u6DFB\u6F64",productName:"Laphroaig \u62C9\u4F5B\u683C10\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1050,sellingPrice:3300},{id:"W19",vendor:"\u6DFB\u6F64",productName:"Fettercairn \u8CBB\u7279\u80AF12\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1050,sellingPrice:3300},{id:"W20",vendor:"\u6DFB\u6F64",productName:"Glenfiddich \u683C\u862D\u83F2\u8FEA12\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:950,sellingPrice:3500},{id:"W21",vendor:"\u6DFB\u6F64",productName:"Balvenie \u767E\u5BCC12\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1350,sellingPrice:3800},{id:"W22",vendor:"\u6DFB\u6F64",productName:"Mortlach \u6155\u8D6B12\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1350,sellingPrice:3800},{id:"W23",vendor:"\u6DFB\u6F64",productName:"Dalmore \u5927\u646912\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1396,sellingPrice:3900},{id:"W24",vendor:"\u6DFB\u6F64",productName:"Ardbeg \u96C5\u67CF10\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1350,sellingPrice:3900},{id:"W25",vendor:"\u6DFB\u6F64",productName:"Macallan \u9EA5\u5361\u502B12\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1650,sellingPrice:4200},{id:"W26",vendor:"\u6DFB\u6F64",productName:"Hibiki \u97FF",type:"\u8ABF\u548C\u5A01\u58EB\u5FCC",cost:2300,sellingPrice:4900},{id:"W27",vendor:"\u6DFB\u6F64",productName:"Johnnie Walker \u7D04\u7FF0\u8D70\u8DEF \u9ED1\u724C 12\u5E74",type:"\u8ABF\u548C\u5A01\u58EB\u5FCC",cost:750,sellingPrice:2100},{id:"W28",vendor:"\u6DFB\u6F64",productName:"Johnnie Walker \u7D04\u7FF0\u8D70\u8DEFXR 21\u5E74",type:"\u8ABF\u548C\u5A01\u58EB\u5FCC",cost:2390,sellingPrice:4900},{id:"W29",vendor:"\u6DFB\u6F64",productName:"Royal Salute \u7687\u5BB6\u79AE\u70AE",type:"\u8ABF\u548C\u5A01\u58EB\u5FCC",cost:2500,sellingPrice:4900},{id:"W30",vendor:"\u5927\u6469",productName:"\u5927\u646915",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:2300,sellingPrice:5200},{id:"W31",vendor:"\u767E\u5BCC",productName:"\u767E\u5BCC14",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1850,sellingPrice:4200},{id:"W32",vendor:"\u6155\u8D6B",productName:"\u6155\u8D6B16",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:2300,sellingPrice:4900},{id:"W33",vendor:"\u767E\u5BCC",productName:"\u767E\u9F61\u7F4830",type:"\u8ABF\u548C\u5A01\u58EB\u5FCC",cost:7800,sellingPrice:14e3}]);this.mockCigarCosts=D([{id:"C01",brand:"Allados",productName:"Robusto",size:"5*50",quantityPerBox:20,lishengCost:340,baijiaCost:370,sellingPrice:560},{id:"C02",brand:"Allados",productName:"Toro",size:"6*52",quantityPerBox:20,lishengCost:370,baijiaCost:390,sellingPrice:780},{id:"C03",brand:"Oliva",productName:"Flor De Oliva Robusto",size:"5*50",quantityPerBox:25,lishengCost:255,baijiaCost:285,sellingPrice:520},{id:"C04",brand:"Oliva",productName:"Flor De Oliva Toro",size:"6*50",quantityPerBox:25,lishengCost:270,baijiaCost:300,sellingPrice:580},{id:"C05",brand:"Oliva",productName:"Serie O Robusto",size:"5*50",quantityPerBox:20,lishengCost:375,baijiaCost:405,sellingPrice:750},{id:"C06",brand:"Oliva",productName:"Serie O Corona",size:"6*46",quantityPerBox:20,lishengCost:335,baijiaCost:365,sellingPrice:700},{id:"C07",brand:"Oliva",productName:"Serie V Lancero",size:"7*38",quantityPerBox:24,lishengCost:415,baijiaCost:430,sellingPrice:790},{id:"C08",brand:"Oliva",productName:"Serie V Belicoso",size:"5*54",quantityPerBox:24,lishengCost:415,baijiaCost:445,sellingPrice:800},{id:"C09",brand:"Oliva",productName:"Serie V DBL.Robusto",size:"5*54",quantityPerBox:24,lishengCost:450,baijiaCost:480,sellingPrice:820},{id:"C10",brand:"Oliva",productName:"Serie V DBL. Toro",size:"6*60",quantityPerBox:24,lishengCost:520,baijiaCost:550,sellingPrice:1100},{id:"C11",brand:"Oliva",productName:"Serie V Melanio Figurado",size:"6.5*52",quantityPerBox:10,lishengCost:570,baijiaCost:670,sellingPrice:1480},{id:"C12",brand:"Oliva",productName:"Serie V Melanio Toro",size:"6.5*52",quantityPerBox:10,lishengCost:690,baijiaCost:790,sellingPrice:1600},{id:"C13",brand:"Oliva",productName:"Connecticut Res.PETIT Corona",size:"4*38",quantityPerBox:30,lishengCost:270,baijiaCost:300,sellingPrice:540},{id:"C14",brand:"Oliva",productName:"Master Blender 3 Robusto",size:"5*50",quantityPerBox:20,lishengCost:440,baijiaCost:470,sellingPrice:950},{id:"C15",brand:"Oliva",productName:"Master Blender 3 Torpedo",size:"6.5*52",quantityPerBox:10,lishengCost:490,baijiaCost:520,sellingPrice:1e3},{id:"C16",brand:"Oliva",productName:"Oliva 135\u9031\u5E74\u7D00\u5FF5",size:"5.5*54",quantityPerBox:12,lishengCost:900,baijiaCost:1e3,sellingPrice:2e3},{id:"C17",brand:"Oliva",productName:"Oliva 2024\u9F8D\u5E74\u7CFB\u5217",size:"5.5*60",quantityPerBox:10,lishengCost:900,baijiaCost:1e3,sellingPrice:2e3},{id:"C18",brand:"Oliva",productName:"Serie V Melanio Torpedo",size:"6.5*52",quantityPerBox:10,lishengCost:690,baijiaCost:790,sellingPrice:1600}]);this.itemCategoryMap={\u8CC7\u7522:["\u73FE\u91D1","\u61C9\u6536\u5E33\u6B3E","\u5B58\u8CA8-\u9910\u98F2","\u5B58\u8CA8-\u9152\u6C34","\u5B58\u8CA8-\u96EA\u8304","\u88DD\u6F62","\u62BC\u91D1","\u71DF\u696D\u8A2D\u5099"],\u8CA0\u50B5:["\u61C9\u4ED8\u5E33\u6B3E","\u61C9\u4ED8\u88DD\u6F62\u6B3E","\u61C9\u4ED8\u85AA\u8CC7","\u61C9\u4ED8\u80A1\u6771\u56DE\u994B\u91D1","\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8","\u9280\u884C\u501F\u6B3E"],\u696D\u4E3B\u6B0A\u76CA:["\u8CC7\u672C","\u696D\u4E3B\u5B58\u5165","\u696D\u4E3B\u63D0\u51FA","\u672C\u671F\u640D\u76CA"],\u71DF\u696D\u6536\u5165:["\u92B7\u8CA8\u6536\u5165","\u5176\u4ED6\u6536\u5165","-\u92B7\u6216\u6298\u8B93"],\u71DF\u696D\u8CBB\u7528:["\u85AA\u8CC7\u652F\u51FA","\u5065\u4FDD\u8CBB","\u52DE\u4FDD\u8CBB","\u56DE\u994B\u91D1\u652F\u51FA","\u79DF\u91D1\u652F\u51FA","\u4FDD\u96AA\u8CBB","\u8CB8\u6B3E\u5229\u606F","\u5EDA\u623F\u6D88\u8017\u54C1","\u6587\u5177\u7528\u54C1","\u7DB2\u8DEF\u8CBB","\u96FB\u8A71\u8CBB","\u5927\u6A13\u7BA1\u7406\u8CBB","\u6703\u8A08\u8CBB\u7528","\u734E\u91D1\u652F\u51FA","\u6C34\u8CBB","\u74E6\u65AF\u8CBB","\u96FB\u8CBB","\u50AD\u91D1\u8CBB\u7528","\u8A66\u83DC\u8CBB\u7528","\u62DC\u62DC\u8CBB\u7528","pos\u6A5F\u8CBB\u7528","\u5176\u4ED6\u8CBB\u7528","\u71DF\u696D\u7A05"]};this.mockCustomers=D([{id:"C101",name:"\u6797\u5C0F\u59D0",phone:"0912-345-678",note:"VIP\u5BA2\u6236\uFF0C\u5E38\u5BA2",gender:"\u5973\u6027",birthday:"05/20",birthYear:"1990",loyaltyPoints:1250,originStore:"\u4FE1\u7FA9\u9580\u5E02",lastCheckoutAt:"2026-01-25T15:30:00Z",isDeleted:!1},{id:"C102",name:"\u9673\u5148\u751F",phone:"0987-654-321",note:"VIP\u5BA2\u6236\uFF0C\u559C\u611B\u5A01\u58EB\u5FCC",gender:"\u7537\u6027",birthday:"11/12",birthYear:"1985",loyaltyPoints:3400,originStore:"\u4FE1\u7FA9\u9580\u5E02",lastCheckoutAt:"2026-01-23T18:45:00Z",isDeleted:!1},{id:"C103",name:"\u9EC3\u5148\u751F",phone:"0928-111-222",note:"\u559C\u611B\u7D05\u9152",gender:"\u7537\u6027",birthday:"02/28",birthYear:"1992",loyaltyPoints:320,originStore:"\u5357\u4EAC\u9580\u5E02",lastCheckoutAt:"2026-01-20T12:15:00Z",isDeleted:!1},{id:"C104",name:"\u5F35\u5C0F\u59D0",phone:"0933-444-555",note:null,gender:"\u5973\u6027",birthday:"08/08",birthYear:"1998",loyaltyPoints:880,originStore:"\u4FE1\u7FA9\u9580\u5E02",lastCheckoutAt:"2026-01-19T20:30:00Z",isDeleted:!1},{id:"C201",name:"\u5433\u5148\u751F",phone:"0955-666-777",note:"\u5B9A\u671F\u4F86\u8A2A",gender:"\u7537\u6027",birthday:"07/15",birthYear:"1988",loyaltyPoints:150,originStore:"\u6771\u9580\u9580\u5E02",lastCheckoutAt:"2026-01-18T16:00:00Z",isDeleted:!1},{id:"C202",name:"\u5289\u5C0F\u59D0",phone:"0911-222-333",note:"\u5DF2\u505C\u6B62\u670D\u52D9",gender:"\u5973\u6027",birthday:"03/30",birthYear:"1995",loyaltyPoints:0,originStore:"\u4FE1\u7FA9\u9580\u5E02",lastCheckoutAt:"2025-06-30T14:20:00Z",isDeleted:!1}]);this.mockCustomerFeedback=D([{id:"F001",customerId:"C101",date:"2026-01-21",rating:5,comment:"\u5496\u5561\u5F88\u597D\u559D\uFF0C\u751C\u9EDE\u4E5F\u5F88\u68D2\uFF0C\u74B0\u5883\u8212\u9069\u3002"},{id:"F002",customerId:"C102",date:"2026-01-10",rating:4,comment:"\u5A01\u58EB\u5FCC\u9078\u64C7\u5F88\u591A\uFF0C\u96EA\u8304\u54C1\u8CEA\u4E0D\u932F\uFF0C\u4F46\u50F9\u683C\u504F\u9AD8\u3002"},{id:"F003",customerId:"C103",date:"2026-01-15",rating:5,comment:"\u7D05\u9152\u5F88\u9806\u53E3\uFF0C\u70B8\u7269\u62FC\u76E4\u8D85\u597D\u5403\uFF01"},{id:"F004",customerId:"C101",date:"2026-01-05",rating:4,comment:"\u9910\u9EDE\u597D\u5403\uFF0C\u4F46\u6C23\u6CE1\u98F2\u7684\u6C23\u6709\u9EDE\u4E0D\u8DB3\u3002"}]);this.mockLedger2024=[{date:"2024-01-15",description:"\u7DB2\u7AD9\u958B\u767C\u5C08\u6848 - A\u516C\u53F8",category:"\u92B7\u8CA8\u6536\u5165",income:15e4,expense:0},{date:"2024-01-20",description:"\u8FA6\u516C\u5BA4\u7528\u54C1\u63A1\u8CFC",category:"\u6587\u5177\u7528\u54C1",income:0,expense:4500},{date:"2024-02-10",description:"\u8A2D\u8A08\u670D\u52D9\u8CBB - B\u5BA2\u6236",category:"\u92B7\u8CA8\u6536\u5165",income:225e3,expense:0},{date:"2024-02-22",description:"SaaS \u8EDF\u9AD4\u8A02\u95B1\u8CBB",category:"\u5176\u4ED6\u8CBB\u7528",income:0,expense:6e3},{date:"2024-03-05",description:"\u96F2\u7AEF\u4F3A\u670D\u5668\u8CBB\u7528",category:"\u7DB2\u8DEF\u8CBB",income:0,expense:9e3},{date:"2024-03-18",description:"\u7DAD\u8B77\u5408\u7D04 - C\u516C\u53F8",category:"\u92B7\u8CA8\u6536\u5165",income:186e3,expense:0},{date:"2024-04-12",description:"\u6578\u4F4D\u5EE3\u544A\u6295\u653E",category:"\u884C\u92B7\u8CBB\u7528",income:0,expense:36e3},{date:"2024-04-25",description:"App\u958B\u767C\u5C08\u6848 - D\u5BA2\u6236",category:"\u92B7\u8CA8\u6536\u5165",income:243e3,expense:0},{date:"2024-05-15",description:"\u5916\u5305\u5C08\u6848\u8CBB\u7528",category:"\u50AD\u91D1\u8CBB\u7528",income:0,expense:45e3},{date:"2024-06-20",description:"\u9867\u554F\u670D\u52D9\u8CBB",category:"\u92B7\u8CA8\u6536\u5165",income:279e3,expense:0},{date:"2024-07-01",description:"\u8FA6\u516C\u5BA4\u79DF\u91D1 - Q3",category:"\u79DF\u91D1\u652F\u51FA",income:0,expense:6e4},{date:"2024-08-10",description:"\u7CFB\u7D71\u958B\u767C - E\u516C\u53F8",category:"\u92B7\u8CA8\u6536\u5165",income:165e3,expense:0}];this.mockLedger2025=[{date:"2025-01-15",description:"\u5E74\u5EA6\u7DAD\u8B77\u5408\u7D04 - A\u516C\u53F8",category:"\u92B7\u8CA8\u6536\u5165",income:18e4,expense:0},{date:"2025-01-20",description:"\u63A1\u8CFC\u65B0\u7B46\u96FB",category:"\u71DF\u696D\u8A2D\u5099",income:0,expense:75e3},{date:"2025-02-10",description:"\u54C1\u724C\u8A2D\u8A08\u5C08\u6848 - F\u5BA2\u6236",category:"\u92B7\u8CA8\u6536\u5165",income:255e3,expense:0},{date:"2025-02-22",description:"SaaS \u8EDF\u9AD4\u8A02\u95B1\u8CBB",category:"pos\u6A5F\u8CBB\u7528",income:0,expense:7500},{date:"2025-03-05",description:"\u96F2\u7AEF\u4F3A\u670D\u5668\u8CBB\u7528",category:"\u7DB2\u8DEF\u8CBB",income:0,expense:10500},{date:"2025-04-10",description:"\u6578\u4F4D\u5EE3\u544A\u6295\u653E - Q2",category:"\u884C\u92B7\u8CBB\u7528",income:0,expense:42e3},{date:"2025-05-20",description:"ERP \u7CFB\u7D71\u5C0E\u5165 - G \u516C\u53F8",category:"\u92B7\u8CA8\u6536\u5165",income:35e4,expense:0},{date:"2025-06-15",description:"\u8FA6\u516C\u5BA4\u64F4\u5EFA\u5DE5\u7A0B",category:"\u88DD\u6F62",income:0,expense:15e4},{date:"2025-07-01",description:"\u8FA6\u516C\u5BA4\u79DF\u91D1 - Q3",category:"\u79DF\u91D1\u652F\u51FA",income:0,expense:78e3},{date:"2025-08-18",description:"\u6CD5\u5F8B\u9867\u554F\u8CBB",category:"\u6703\u8A08\u8CBB\u7528",income:0,expense:25e3},{date:"2025-09-25",description:"\u96F2\u7AEF\u5E73\u53F0\u958B\u767C - H \u5BA2\u6236",category:"\u92B7\u8CA8\u6536\u5165",income:42e4,expense:0},{date:"2025-10-05",description:"\u4F3A\u670D\u5668\u786C\u9AD4\u5347\u7D1A",category:"\u71DF\u696D\u8A2D\u5099",income:0,expense:95e3},{date:"2025-11-12",description:"\u884C\u92B7\u6D3B\u52D5\u8CBB\u7528",category:"\u884C\u92B7\u8CBB\u7528",income:0,expense:65e3},{date:"2025-12-20",description:"\u5E74\u5EA6\u734E\u91D1\u767C\u653E",category:"\u734E\u91D1\u652F\u51FA",income:0,expense:25e4}];this.mockLedger2026=[{date:"2026-06-01",description:"VIP\u5305\u5EC2\u670D\u52D9\u8CBB",category:"\u92B7\u8CA8\u6536\u5165",income:88e3,expense:0},{date:"2026-06-05",description:"\u4F01\u696D\u5305\u5834\u6D3B\u52D5",category:"\u92B7\u8CA8\u6536\u5165",income:15e4,expense:0},{date:"2026-06-10",description:"\u7CFB\u7D71\u6574\u5408\u670D\u52D9 - M \u516C\u53F8",category:"\u92B7\u8CA8\u6536\u5165",income:22e4,expense:0},{date:"2026-06-12",description:"\u5834\u5730\u79DF\u8CC3\u6536\u5165",category:"\u5176\u4ED6\u6536\u5165",income:25e3,expense:0},{date:"2026-06-15",description:"\u9867\u5BA2\u8A02\u91D1\u6C92\u6536",category:"\u5176\u4ED6\u6536\u5165",income:5e3,expense:0},{date:"2026-06-20",description:"\u719F\u5BA2\u512A\u60E0\u6298\u8B93",category:"\u92B7\u8CA8\u6298\u8B93",income:12e3,expense:0},{date:"2026-06-02",description:"\u516D\u6708\u4EFD\u8FA6\u516C\u5BA4\u79DF\u91D1",category:"\u79DF\u91D1\u652F\u51FA",income:0,expense:8e4},{date:"2026-06-02",description:"\u516D\u6708\u4EFD\u5927\u6A13\u7BA1\u7406\u8CBB",category:"\u5927\u6A13\u7BA1\u7406\u8CBB",income:0,expense:5e3},{date:"2026-06-05",description:"\u54E1\u5DE5\u85AA\u8CC7",category:"\u85AA\u8CC7\u652F\u51FA",income:0,expense:18e4},{date:"2026-06-05",description:"\u52DE\u5065\u4FDD\u8CBB\u7528",category:"\u52DE\u4FDD\u8CBB",income:0,expense:15e3},{date:"2026-06-05",description:"\u52DE\u5065\u4FDD\u8CBB\u7528",category:"\u5065\u4FDD\u8CBB",income:0,expense:18e3},{date:"2026-06-08",description:"\u6C34\u96FB\u74E6\u65AF\u8CBB",category:"\u6C34\u8CBB",income:0,expense:2500},{date:"2026-06-08",description:"\u6C34\u96FB\u74E6\u65AF\u8CBB",category:"\u96FB\u8CBB",income:0,expense:12e3},{date:"2026-06-08",description:"\u6C34\u96FB\u74E6\u65AF\u8CBB",category:"\u74E6\u65AF\u8CBB",income:0,expense:3500},{date:"2026-06-10",description:"\u96FB\u4FE1\u7DB2\u8DEF\u8CBB",category:"\u7DB2\u8DEF\u8CBB",income:0,expense:2e3},{date:"2026-06-10",description:"\u96FB\u4FE1\u7DB2\u8DEF\u8CBB",category:"\u96FB\u8A71\u8CBB",income:0,expense:1500},{date:"2026-06-12",description:"\u5EDA\u623F\u98DF\u6750\u3001\u7D19\u5DFE\u7B49\u6D88\u8017\u54C1",category:"\u5EDA\u623F\u6D88\u8017\u54C1",income:0,expense:18e3},{date:"2026-06-15",description:"\u5F71\u5370\u7D19\u3001\u7B46\u7B49\u8FA6\u516C\u7528\u54C1",category:"\u6587\u5177\u7528\u54C1",income:0,expense:3e3},{date:"2026-06-18",description:"\u884C\u92B7\u6D3B\u52D5\u50AD\u91D1",category:"\u50AD\u91D1\u8CBB\u7528",income:0,expense:22e3},{date:"2026-06-20",description:"POS\u7CFB\u7D71\u6708\u8CBB",category:"pos\u6A5F\u8CBB\u7528",income:0,expense:5e3},{date:"2026-06-21",description:"\u7AEF\u5348\u7BC0\u62DC\u62DC\u7528\u54C1",category:"\u62DC\u62DC\u8CBB\u7528",income:0,expense:2e3},{date:"2026-06-22",description:"\u65B0\u83DC\u8272\u7814\u767C\u98DF\u6750",category:"\u8A66\u83DC\u8CBB\u7528",income:0,expense:8e3},{date:"2026-06-24",description:"\u71DF\u696D\u7528\u8CA1\u7522\u4FDD\u96AA",category:"\u4FDD\u96AA\u8CBB",income:0,expense:6e3},{date:"2026-06-25",description:"\u6703\u8A08\u5E2B\u8A18\u5E33\u8CBB",category:"\u6703\u8A08\u8CBB\u7528",income:0,expense:8e3},{date:"2026-06-25",description:"\u9280\u884C\u8CB8\u6B3E\u5229\u606F",category:"\u8CB8\u6B3E\u5229\u606F",income:0,expense:12e3}];this.mockPurchases=[{date:"2024-01-18",category:"\u9152\u6C34",amount:12e3},{date:"2024-02-05",category:"\u9910\u98F2",amount:8500},{date:"2024-02-25",category:"\u96EA\u8304",amount:25e3},{date:"2024-03-12",category:"\u9152\u6C34",amount:15e3},{date:"2024-04-20",category:"\u9910\u98F2",amount:9800},{date:"2024-05-10",category:"\u96EA\u8304",amount:32e3},{date:"2024-06-22",category:"\u9152\u6C34",amount:18e3},{date:"2024-07-15",category:"\u9910\u98F2",amount:11e3},{date:"2025-01-22",category:"\u9152\u6C34",amount:16e3},{date:"2025-02-15",category:"\u96EA\u8304",amount:45e3},{date:"2025-03-01",category:"\u9910\u98F2",amount:13500},{date:"2025-04-10",category:"\u9152\u6C34",amount:22e3},{date:"2025-05-15",category:"\u9910\u98F2",amount:15e3},{date:"2025-06-20",category:"\u96EA\u8304",amount:52e3},{date:"2025-08-05",category:"\u9152\u6C34",amount:25e3},{date:"2025-10-18",category:"\u9910\u98F2",amount:18e3},{date:"2025-12-01",category:"\u96EA\u8304",amount:65e3},{date:"2026-01-20",category:"\u9152\u6C34",amount:28e3},{date:"2026-02-18",category:"\u9910\u98F2",amount:25e3},{date:"2026-03-10",category:"\u9910\u98F2",amount:21e3},{date:"2026-03-25",category:"\u96EA\u8304",amount:82e3},{date:"2026-04-25",category:"\u96EA\u8304",amount:75e3},{date:"2026-05-15",category:"\u9152\u6C34",amount:35e3},{date:"2026-06-05",category:"\u9152\u6C34",amount:32e3},{date:"2026-06-12",category:"\u9910\u98F2",amount:28e3},{date:"2026-06-20",category:"\u96EA\u8304",amount:95e3}];this.mockPOSSales=[{transactionId:"T201",customerId:"C101",date:"2026-01-05",items:[{name:"\u4E3B\u98DF",price:350,quantity:2},{name:"\u6C23\u6CE1\u98F2",price:120,quantity:2}],total:940},{transactionId:"T202",customerId:"C102",date:"2026-01-10",items:[{name:"\u5A01\u58EB\u5FCC",price:2800,quantity:1},{name:"\u96EA\u8304",price:900,quantity:2}],total:4600},{transactionId:"T203",customerId:"C103",date:"2026-01-15",items:[{name:"\u7D05\u9152/\u767D\u9152",price:1800,quantity:1},{name:"\u70B8\u7269",price:250,quantity:1}],total:2050},{transactionId:"T204",customerId:"C101",date:"2026-01-20",items:[{name:"\u5496\u5561",price:150,quantity:2},{name:"\u751C\u9EDE",price:180,quantity:2}],total:660},{transactionId:"T205",customerId:"C104",date:"2026-01-25",items:[{name:"\u6D3B\u52D5",price:13e3,quantity:1}],total:13e3},{transactionId:"T301",customerId:"C201",date:"2026-02-03",items:[{name:"\u5564\u9152",price:200,quantity:4},{name:"\u70B8\u7269",price:250,quantity:2}],total:1300},{transactionId:"T302",customerId:"C202",date:"2026-02-12",items:[{name:"\u5A01\u58EB\u5FCC",price:3200,quantity:1}],total:3200},{transactionId:"T303",customerId:"C103",date:"2026-02-18",items:[{name:"\u4E3B\u98DF",price:400,quantity:1},{name:"\u8336\u98F2",price:130,quantity:1}],total:530},{transactionId:"T304",customerId:"C201",date:"2026-02-25",items:[{name:"\u96EA\u8304",price:1200,quantity:1}],total:1200},{transactionId:"T401",customerId:"C104",date:"2026-03-05",items:[{name:"\u5834\u5730\u4F7F\u7528\u8CBB",price:4e3,quantity:1}],total:4e3},{transactionId:"T402",customerId:"C101",date:"2026-03-10",items:[{name:"\u8ABF\u9152",price:450,quantity:2},{name:"\u55AE\u9EDE",price:300,quantity:1}],total:1200},{transactionId:"T403",customerId:"C102",date:"2026-03-20",items:[{name:"\u5A01\u58EB\u5FCC",price:2500,quantity:1},{name:"\u96EA\u8304",price:850,quantity:3}],total:5050},{transactionId:"T404",customerId:"C101",date:"2026-03-28",items:[{name:"\u4E0B\u5348\u8336\u5957\u9910",price:600,quantity:2}],total:1200},{transactionId:"T501",customerId:"C104",date:"2026-04-02",items:[{name:"\u5834\u5730\u4F7F\u7528\u8CBB",price:15e3,quantity:1}],total:15e3},{transactionId:"T502",customerId:"C101",date:"2026-04-10",items:[{name:"\u4E3B\u98DF",price:380,quantity:2},{name:"\u7D05\u9152/\u767D\u9152",price:2200,quantity:1}],total:2960},{transactionId:"T503",customerId:"C103",date:"2026-04-22",items:[{name:"\u96EA\u8304",price:1100,quantity:2}],total:2200}];this.productCategoryMap=new Map([["\u5834\u5730\u4F7F\u7528\u8CBB","\u6D3B\u52D5\u5834\u5730"],["\u6D3B\u52D5","\u6D3B\u52D5\u5834\u5730"],["\u8ABF\u9152","\u9152\u6C34"],["\u7D05\u9152/\u767D\u9152","\u9152\u6C34"],["\u5564\u9152","\u9152\u6C34"],["\u5A01\u58EB\u5FCC","\u9152\u6C34"],["\u4E3B\u98DF","\u9910\u98F2"],["\u70B8\u7269","\u9910\u98F2"],["\u5976\u6614","\u9910\u98F2"],["\u6C23\u6CE1\u98F2","\u9910\u98F2"],["\u55AE\u9EDE","\u9910\u98F2"],["\u8336\u98F2","\u9910\u98F2"],["\u8C9D\u679C/\u53EF\u980C","\u9910\u98F2"],["\u5496\u5561","\u9910\u98F2"],["\u751C\u9EDE","\u9910\u98F2"],["\u6C99\u62C9","\u9910\u98F2"],["\u4E0B\u5348\u8336\u5957\u9910","\u9910\u98F2"],["\u96EA\u8304","\u96EA\u8304"]]);this.mockCostRateMap=new Map([["\u6D3B\u52D5\u5834\u5730",.1],["\u9152\u6C34",.35],["\u9910\u98F2",.25],["\u96EA\u8304",.55]]);this.mockMonthlyBalanceSheetData2026={assets:{\u73FE\u91D1:{"2026-01":-60372,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u61C9\u6536\u5E33\u6B3E:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},"\u5B58\u8CA8-\u9910\u98F2":{"2026-01":42459,"2026-02":56424,"2026-03":63318,"2026-04":53737,"2026-05":41714,"2026-06":62941,"2026-07":55331,"2026-08":57454,"2026-09":42199,"2026-10":88353,"2026-11":56195,"2026-12":70131},"\u5B58\u8CA8-\u9152\u6C34":{"2026-01":4561,"2026-02":51162,"2026-03":28630,"2026-04":51807,"2026-05":26140,"2026-06":7117,"2026-07":5707,"2026-08":23549,"2026-09":40217,"2026-10":80083,"2026-11":38428,"2026-12":13344},"\u5B58\u8CA8-\u96EA\u8304":{"2026-01":106380,"2026-02":114733,"2026-03":150810,"2026-04":112936,"2026-05":79912,"2026-06":91653,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u88DD\u6F62:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":1700030,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u62BC\u91D1:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u71DF\u696D\u8A2D\u5099:{"2026-01":20472,"2026-02":9694,"2026-03":4235,"2026-04":25624,"2026-05":25084,"2026-06":1044,"2026-07":770,"2026-08":2876,"2026-09":6678,"2026-10":25840,"2026-11":5444,"2026-12":1589}},liabilities:{\u61C9\u4ED8\u5E33\u6B3E:{"2026-01":-116791,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u61C9\u4ED8\u88DD\u6F62\u6B3E:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":-34e4,"2026-07":-34e4,"2026-08":-34e4,"2026-09":-34e4,"2026-10":-26e4,"2026-11":0,"2026-12":0},\u61C9\u4ED8\u85AA\u8CC7:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":-73145,"2026-08":-53145,"2026-09":-38145,"2026-10":0,"2026-11":-67145,"2026-12":-50145},\u61C9\u4ED8\u80A1\u6771\u56DE\u994B\u91D1:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":-21181,"2026-09":-1830,"2026-10":0,"2026-11":0,"2026-12":0},\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":-99275,"2026-07":-78270,"2026-08":-224230,"2026-09":-113975,"2026-10":-118535,"2026-11":-71145,"2026-12":-66350},\u9280\u884C\u501F\u6B3E:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":2e6,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0}},equity:{\u8CC7\u672C:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u696D\u4E3B\u5B58\u5165:{"2026-01":0,"2026-02":3e5,"2026-03":15e4,"2026-04":5e4,"2026-05":1e5,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u696D\u4E3B\u63D0\u51FA:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0}}};this.mockMonthlyIncomeStatementData2026={revenue:{\u92B7\u8CA8\u6536\u5165:{"2026-01":515140,"2026-02":347057,"2026-03":327890,"2026-04":261350,"2026-05":256858,"2026-06":187580,"2026-07":200710,"2026-08":308020,"2026-09":224550,"2026-10":504140,"2026-11":236815,"2026-12":340853},\u5176\u4ED6\u6536\u5165:{"2026-01":100,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":27677,"2026-07":636,"2026-08":25e3,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u92B7\u8CA8\u6298\u8B93:{"2026-01":-111972,"2026-02":-84928,"2026-03":-59978,"2026-04":-58915,"2026-05":-35331,"2026-06":-29417,"2026-07":-22367,"2026-08":-30058,"2026-09":-36237,"2026-10":-55599,"2026-11":-22119,"2026-12":-35978}},expenses:{\u85AA\u8CC7\u652F\u51FA:{"2026-01":-117806,"2026-02":-97814,"2026-03":-110799,"2026-04":-105507,"2026-05":-110155,"2026-06":-109977,"2026-07":-25718,"2026-08":-52922,"2026-09":-70688,"2026-10":-95017,"2026-11":-35040,"2026-12":-37492},\u5065\u4FDD\u8CBB:{"2026-01":0,"2026-02":-2368,"2026-03":-2368,"2026-04":-2368,"2026-05":-2373,"2026-06":-2368,"2026-07":-2368,"2026-08":-2368,"2026-09":-2368,"2026-10":-2368,"2026-11":-2368,"2026-12":0},\u52DE\u4FDD\u8CBB:{"2026-01":-4447,"2026-02":-8883,"2026-03":-5382,"2026-04":-15787,"2026-05":-5138,"2026-06":-4827,"2026-07":-4827,"2026-08":-4827,"2026-09":-4827,"2026-10":-4827,"2026-11":-4827,"2026-12":-4827},\u56DE\u994B\u91D1\u652F\u51FA:{"2026-01":-1654,"2026-02":-1581,"2026-03":-1623,"2026-04":-3320,"2026-05":-9792,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":-15e3,"2026-12":0},\u79DF\u91D1\u652F\u51FA:{"2026-01":-72425,"2026-02":-72425,"2026-03":-72425,"2026-04":-72425,"2026-05":-72425,"2026-06":-72425,"2026-07":-72425,"2026-08":-72410,"2026-09":-72410,"2026-10":-72410,"2026-11":-72410,"2026-12":-72410},\u4FDD\u96AA\u8CBB:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":-21297,"2026-12":0},\u8CB8\u6B3E\u5229\u606F:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":-3824,"2026-07":-3824,"2026-08":-3824,"2026-09":-3824,"2026-10":-3824,"2026-11":-3824,"2026-12":-3824},\u5EDA\u623F\u6D88\u8017\u54C1:{"2026-01":-596,"2026-02":-834,"2026-03":-79,"2026-04":-3002,"2026-05":0,"2026-06":0,"2026-07":-641,"2026-08":-300,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":-1293},\u6587\u5177\u7528\u54C1:{"2026-01":-266,"2026-02":-590,"2026-03":-1263,"2026-04":-9358,"2026-05":-149,"2026-06":-1255,"2026-07":-207,"2026-08":-953,"2026-09":-152,"2026-10":-163,"2026-11":-1989,"2026-12":-621},\u7DB2\u8DEF\u8CBB:{"2026-01":-4794,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":-4794,"2026-06":0,"2026-07":-2397,"2026-08":0,"2026-09":0,"2026-10":-2553,"2026-11":-2302,"2026-12":-1344},\u96FB\u8A71\u8CBB:{"2026-01":0,"2026-02":-334,"2026-03":-1302,"2026-04":-338,"2026-05":-369,"2026-06":-359,"2026-07":-330,"2026-08":-316,"2026-09":-328,"2026-10":-310,"2026-11":-357,"2026-12":-340},\u5927\u6A13\u7BA1\u7406\u8CBB:{"2026-01":-1400,"2026-02":-1400,"2026-03":-1400,"2026-04":0,"2026-05":0,"2026-06":-1400,"2026-07":-1400,"2026-08":0,"2026-09":0,"2026-10":-1400,"2026-11":-1400,"2026-12":0},\u6703\u8A08\u8CBB\u7528:{"2026-01":0,"2026-02":-14730,"2026-03":-4e3,"2026-04":0,"2026-05":-4162,"2026-06":0,"2026-07":-4e3,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u734E\u91D1\u652F\u51FA:{"2026-01":0,"2026-02":-3e3,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u6C34\u8CBB:{"2026-01":-709,"2026-02":0,"2026-03":-696,"2026-04":0,"2026-05":-599,"2026-06":0,"2026-07":-525,"2026-08":0,"2026-09":-578,"2026-10":0,"2026-11":-1218,"2026-12":0},\u74E6\u65AF\u8CBB:{"2026-01":-300,"2026-02":0,"2026-03":0,"2026-04":-300,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":-2100,"2026-10":-600,"2026-11":-300,"2026-12":-1540},\u96FB\u8CBB:{"2026-01":0,"2026-02":-8811,"2026-03":-807,"2026-04":0,"2026-05":0,"2026-06":-12543,"2026-07":0,"2026-08":-24358,"2026-09":0,"2026-10":-24920,"2026-11":0,"2026-12":-14417},\u50AD\u91D1\u8CBB\u7528:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":-3e3},\u8A66\u83DC\u8CBB\u7528:{"2026-01":-10530,"2026-02":-1070,"2026-03":-1403,"2026-04":0,"2026-05":0,"2026-06":-225,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u62DC\u62DC\u8CBB\u7528:{"2026-01":-3744,"2026-02":-6043,"2026-03":-1174,"2026-04":-838,"2026-05":-554,"2026-06":-1228,"2026-07":-608,"2026-08":-1258,"2026-09":-1216,"2026-10":-1216,"2026-11":-585,"2026-12":-806},pos\u6A5F\u8CBB\u7528:{"2026-01":0,"2026-02":-11700,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u5176\u4ED6\u8CBB\u7528:{"2026-01":-2030,"2026-02":-3058,"2026-03":-3570,"2026-04":0,"2026-05":-25418,"2026-06":-13010,"2026-07":-6445,"2026-08":-154,"2026-09":-1302,"2026-10":-6413,"2026-11":-1e3,"2026-12":-13126},\u71DF\u696D\u7A05:{"2026-01":0,"2026-02":0,"2026-03":-8421,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":-4915,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":-22930,"2026-12":0}}};this.mockRebateTransactions=D([{id:"RT001",shareholderName:"\u80A1\u6771 A",checkoutTime:"2024/08/01 20:30:15",discountDetails:"\u9910\u98F28\u6298",invoiceAmount:5e3,rebatePercentage:5,rebateAmount:250,discountUsed:"\u7121"},{id:"RT002",shareholderName:"\u80A1\u6771 A",checkoutTime:"2024/08/15 21:00:00",discountDetails:"\u96EA\u83049\u6298",invoiceAmount:8e3,rebatePercentage:5,rebateAmount:400,discountUsed:"\u751F\u65E5\u5238"},{id:"RT003",shareholderName:"\u80A1\u6771 B",checkoutTime:"2024/08/10 19:45:00",discountDetails:"\u5168\u55AE85\u6298",invoiceAmount:12e3,rebatePercentage:8,rebateAmount:960,discountUsed:"\u7121"}])}getFilteredLedger(e,t){let i=[...this.mockLedger2024,...this.mockLedger2025,...this.mockLedger2026];return!e&&!t?i:i.filter(r=>{let o=r.date,s=e?o>=e:!0,a=t?o<=t:!0;return s&&a})}getFilteredPurchases(e,t){return!e&&!t?this.mockPurchases:this.mockPurchases.filter(i=>{let r=i.date,o=e?r>=e:!0,s=t?r<=t:!0;return o&&s})}getFilteredPOSSales(e,t,i){let r=this.mockPOSSales;return i&&(r=r.filter(o=>o.customerId===i)),!e&&!t?r:r.filter(o=>{let s=o.date,a=e?s>=e:!0,c=t?s<=t:!0;return a&&c})}getFinancialSummary(e,t){let i=this.getFilteredLedger(e,t),r=i.filter(b=>b.category!=="\u92B7\u8CA8\u6298\u8B93").reduce((b,I)=>b+I.income,0),o=i.filter(b=>b.category==="\u92B7\u8CA8\u6298\u8B93").reduce((b,I)=>b+I.income,0),s=r-o,a=i.reduce((b,I)=>b+I.expense,0),c=s-a,g=this.getFilteredPurchases(e,t).reduce((b,I)=>b+I.amount,0),y=1e6+c,v=3e5,_=y-v;return{totalRevenue:s,totalExpenses:a,netIncome:c,totalAssets:y,totalLiabilities:v,equity:_,totalPurchases:g,totalAllowance:o}}getPOSSales(e,t,i){return this.getFilteredPOSSales(e,t,i)}getMonthlyPerformance(e,t){let i=new Map;return this.getFilteredLedger(e,t).forEach(o=>{let s=o.date.substring(0,7);i.has(s)||i.set(s,{revenue:0,expenses:0,accountsPayable:0});let a=i.get(s);o.category==="\u92B7\u8CA8\u6298\u8B93"?a.revenue-=o.income:a.revenue+=o.income,a.expenses+=o.expense,a.accountsPayable=a.expenses*.4+a.revenue*.05}),Array.from(i.keys()).sort().map(o=>k({month:o},i.get(o)))}getExpensesByCategory(e,t){let i=new Map;return this.getFilteredLedger(e,t).forEach(o=>{o.expense>0&&o.category!=="\u8CC7\u672C\u652F\u51FA"&&i.set(o.category,(i.get(o.category)||0)+o.expense)}),Array.from(i.entries()).map(([o,s])=>({category:o,amount:s}))}getPurchasesByCategory(e,t){let i=new Map;return this.getFilteredPurchases(e,t).forEach(o=>{i.set(o.category,(i.get(o.category)||0)+o.amount)}),Array.from(i.entries()).map(([o,s])=>({category:o,amount:s}))}getTopSellingProducts(e,t){let i=new Map;return this.getFilteredPOSSales(e,t).forEach(r=>{r.items.forEach(o=>{let s=i.get(o.name)||{quantitySold:0,revenue:0};s.quantitySold+=o.quantity,s.revenue+=o.price*o.quantity,i.set(o.name,s)})}),Array.from(i.entries()).map(([r,o])=>k({name:r},o)).sort((r,o)=>o.revenue-r.revenue).slice(0,5)}getFilteredPOSSalesByMonth(e,t){return!e&&!t?this.mockPOSSales:this.mockPOSSales.filter(i=>{let r=i.date.substring(0,7),o=e?r>=e:!0,s=t?r<=t:!0;return o&&s})}getAllProductsAnalysis(e,t){let i=new Map,r=this.getFilteredPOSSalesByMonth(e,t),o=r.reduce((s,a)=>s+a.total,0);return r.forEach(s=>{s.items.forEach(a=>{let c=i.get(a.name)||{quantitySold:0,revenue:0,prices:[]};c.quantitySold+=a.quantity,c.revenue+=a.price*a.quantity,c.prices.push(a.price),i.set(a.name,c)})}),i.size===0?[]:Array.from(i.entries()).map(([s,a])=>{let c=a.prices.length>0?a.prices.reduce((g,y)=>g+y,0)/a.prices.length:0,d=o>0?a.revenue/o*100:0;return{name:s,category:this.productCategoryMap.get(s)||"\u5176\u4ED6",quantitySold:a.quantitySold,revenue:a.revenue,avgPrice:c,revenueShare:d}}).sort((s,a)=>a.revenue-s.revenue)}getProductAnalysisReport(e,t){let i=this.getFilteredPOSSalesByMonth(e,t);if(i.length===0)return null;let r=[...new Set(i.map(_=>_.date.substring(0,7)))].sort(),o=new Map,s=new Map;r.forEach(_=>s.set(_,{revenue:0}));for(let _ of i){let b=_.date.substring(0,7);s.get(b).revenue+=_.total;for(let I of _.items){o.has(I.name)||o.set(I.name,{category:this.productCategoryMap.get(I.name)||"\u5176\u4ED6",totalRevenue:0,totalQuantity:0,monthly:new Map});let M=o.get(I.name),A=I.price*I.quantity;M.totalRevenue+=A,M.totalQuantity+=I.quantity,M.monthly.has(b)||M.monthly.set(b,{revenue:0,quantity:0});let B=M.monthly.get(b);B.revenue+=A,B.quantity+=I.quantity}}let a=Array.from(s.values()).reduce((_,b)=>_+b.revenue,0);if(a===0)return null;let c=Array.from(o.entries()).map(([_,b])=>{let I={};for(let M of r){let A=b.monthly.get(M),B=s.get(M).revenue,G=this.mockCostRateMap.get(b.category)||0;I[M]={quantitySold:A?.quantity||0,revenue:A?.revenue||0,revenueShare:B>0?(A?.revenue||0)/B*100:0,costRate:G>0?G+(Math.random()-.5)*.1:0}}return{name:_,category:b.category,totalRevenue:b.totalRevenue,totalQuantity:b.totalQuantity,totalRevenueShare:b.totalRevenue/a*100,monthlyMetrics:I}}),d=["\u6D3B\u52D5\u5834\u5730","\u9152\u6C34","\u9910\u98F2","\u96EA\u8304"],g=[];for(let _ of d){let b=c.filter(B=>B.category===_).sort((B,G)=>G.totalRevenue-B.totalRevenue);if(b.length===0)continue;let I={};for(let B of r){let G=b.reduce((ae,Re)=>ae+Re.monthlyMetrics[B].quantitySold,0),z=b.reduce((ae,Re)=>ae+Re.monthlyMetrics[B].revenue,0),X=s.get(B).revenue,ue=b.reduce((ae,Re)=>ae+Re.monthlyMetrics[B].revenue*Re.monthlyMetrics[B].costRate,0);I[B]={quantitySold:G,revenue:z,revenueShare:X>0?z/X*100:0,costRate:z>0?ue/z:0}}let M=b.reduce((B,G)=>B+G.totalRevenue,0),A={name:"\u5C0F\u8A08",category:_,totalRevenue:M,totalQuantity:b.reduce((B,G)=>B+G.totalQuantity,0),totalRevenueShare:M/a*100,monthlyMetrics:I};g.push({category:_,products:b,subtotal:A})}let y={};for(let _ of r){let b=s.get(_).revenue,I=g.reduce((M,A)=>M+A.subtotal.monthlyMetrics[_].revenue*A.subtotal.monthlyMetrics[_].costRate,0);y[_]={quantitySold:g.reduce((M,A)=>M+A.subtotal.monthlyMetrics[_].quantitySold,0),revenue:b,revenueShare:100,costRate:b>0?I/b:0}}let v={name:"\u7E3D\u8A08",category:"",totalRevenue:a,totalQuantity:g.reduce((_,b)=>_+b.subtotal.totalQuantity,0),totalRevenueShare:100,monthlyMetrics:y};return{months:r,categoryGroups:g,grandTotal:v}}getIncomeStatement(e,t){let i=this.getFilteredLedger(e,t),r=new Map,o=new Map;i.forEach(y=>{y.income>0&&r.set(y.category,(r.get(y.category)||0)+y.income),y.expense>0&&o.set(y.category,(o.get(y.category)||0)+y.expense)});let s=r.get("\u92B7\u8CA8\u6536\u5165")||0,a=r.get("\u5176\u4ED6\u6536\u5165")||0,c=r.get("\u92B7\u8CA8\u6298\u8B93")||0,d={items:[{account:"\u92B7\u8CA8\u6536\u5165",amount:s},{account:"\u5176\u4ED6\u6536\u5165",amount:a},{account:"\u92B7\u8CA8\u6298\u8B93",amount:-c}],total:s+a-c},g={items:Array.from(o.entries()).map(([y,v])=>({account:y,amount:v})).sort((y,v)=>v.amount-y.amount),total:Array.from(o.values()).reduce((y,v)=>y+v,0)};return{operatingRevenue:d,operatingExpenses:g,netIncome:d.total-g.total}}getBalanceSheet(e,t){let i=this.getIncomeStatement(e,t),r=i.netIncome,o=this.getFilteredPurchases(e,t),a={items:[{account:"\u73FE\u91D1",amount:5e5+r},{account:"\u61C9\u6536\u5E33\u6B3E",amount:i.operatingRevenue.total*.15},{account:"\u5B58\u8CA8-\u9910\u98F2",amount:o.filter(_=>_.category==="\u9910\u98F2").reduce((_,b)=>_+b.amount,0)*.4},{account:"\u5B58\u8CA8-\u9152\u6C34",amount:o.filter(_=>_.category==="\u9152\u6C34").reduce((_,b)=>_+b.amount,0)*.5},{account:"\u5B58\u8CA8-\u96EA\u8304",amount:o.filter(_=>_.category==="\u96EA\u8304").reduce((_,b)=>_+b.amount,0)*.6},{account:"\u88DD\u6F62",amount:12e5},{account:"\u62BC\u91D1",amount:15e4},{account:"\u71DF\u696D\u8A2D\u5099",amount:45e4}],total:0};a.total=a.items.reduce((_,b)=>_+b.amount,0);let c={items:[{account:"\u61C9\u4ED8\u5E33\u6B3E",amount:i.operatingExpenses.total*.3},{account:"\u61C9\u4ED8\u88DD\u6F62\u6B3E",amount:25e4},{account:"\u61C9\u4ED8\u85AA\u8CC7",amount:45e3},{account:"\u61C9\u4ED8\u80A1\u6771\u56DE\u994B\u91D1",amount:15e3},{account:"\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8",amount:35e3},{account:"\u9280\u884C\u501F\u6B3E",amount:8e5}],total:0};c.total=c.items.reduce((_,b)=>_+b.amount,0);let d={items:[{account:"\u8CC7\u672C",amount:1e6},{account:"\u696D\u4E3B\u5B58\u5165",amount:5e4},{account:"\u696D\u4E3B\u63D0\u51FA",amount:-2e4},{account:"\u672C\u671F\u640D\u76CA",amount:r}],total:0};d.total=d.items.reduce((_,b)=>_+b.amount,0);let g=c.total+d.total,y=a.total-g,v=d.items.find(_=>_.account==="\u8CC7\u672C");return v&&(v.amount+=y,d.total+=y),{assets:a,liabilities:c,equity:d,totalLiabilitiesAndEquity:a.total}}getMonthlyBalanceSheetReport(e,t){if(e!==2026)return null;let i=this.mockMonthlyBalanceSheetData2026,r=`${e}-`,o=Array.from({length:12},(_,b)=>r+String(b+1).padStart(2,"0")),s;if(t==="all")s=o;else{let _=(t-1)*3+1;s=o.slice(_-1,_+2)}let a=_=>{let b=[],I={};for(let A in _){let B=_[A],G=B[s[s.length-1]]||0;b.push({account:A,monthlyAmounts:B,total:G,percentage:0})}for(let A of o)I[A]=b.reduce((B,G)=>B+(G.monthlyAmounts[A]||0),0);let M=I[s[s.length-1]]||0;return{items:b,monthlyTotals:I,grandTotal:M}},c=a(i.assets),d=a(i.liabilities),g=a(i.equity);c.grandTotal!==0&&c.items.forEach(_=>_.percentage=_.total/c.grandTotal*100);let y=d.grandTotal+g.grandTotal;y!==0&&(d.items.forEach(_=>_.percentage=_.total/y*100),g.items.forEach(_=>_.percentage=_.total/y*100));let v={items:[],monthlyTotals:{},grandTotal:y};for(let _ of o)v.monthlyTotals[_]=(d.monthlyTotals[_]||0)+(g.monthlyTotals[_]||0);return{months:s,assets:c,liabilities:d,equity:g,totalLiabilitiesAndEquity:v}}getMonthlyIncomeStatementReport(e,t){if(e!==2026)return null;let i=this.mockMonthlyIncomeStatementData2026,r=`${e}-`,o=Array.from({length:12},(y,v)=>r+String(v+1).padStart(2,"0")),s;if(t==="all")s=o;else{let y=(t-1)*3+1;s=o.slice(y-1,y+2)}let a=y=>{let v=[],_={};for(let I in y){let M=y[I],A=s.reduce((B,G)=>B+(M[G]||0),0);v.push({account:I,monthlyAmounts:M,total:A,percentage:0})}for(let I of o)_[I]=v.reduce((M,A)=>M+(A.monthlyAmounts[I]||0),0);let b=s.reduce((I,M)=>I+(_[M]||0),0);return b!==0&&v.forEach(I=>I.percentage=I.total/b*100),{items:v,monthlyTotals:_,grandTotal:b}},c=a(i.revenue),d=a(i.expenses),g={monthlyTotals:{},grandTotal:c.grandTotal+d.grandTotal};for(let y of o)g.monthlyTotals[y]=(c.monthlyTotals[y]||0)+(d.monthlyTotals[y]||0);return{months:s,operatingRevenue:c,operatingExpenses:d,netIncome:g}}getTransactions(e){let t=this.mockTransactions();if(e.startDate&&(t=t.filter(i=>i.date>=e.startDate)),e.endDate&&(t=t.filter(i=>i.date<=e.endDate)),e.item&&(t=t.filter(i=>i.item===e.item)),e.category&&(t=t.filter(i=>i.category===e.category)),e.vendorName&&(t=t.filter(i=>i.vendorName===e.vendorName)),e.description){let i=e.description.toLowerCase();t=t.filter(r=>r.description?.toLowerCase().includes(i))}return t}addTransaction(e){let t=q(k({},e),{id:`TXN${Date.now()}`});this.mockTransactions.update(i=>[...i,t])}updateTransaction(e){this.mockTransactions.update(t=>t.map(i=>i.id===e.id?e:i))}getLedgerFilterOptions(){let e=this.mockTransactions(),t=[...new Set(e.map(o=>o.item))],i=[...new Set(e.map(o=>o.category))],r=[...new Set(e.map(o=>o.vendorName).filter(o=>!!o))];return{items:t.sort(),categories:i.sort(),vendorNames:r.sort()}}getEvents(){return this.mockEvents()}getEventById(e){return this.mockEvents().find(t=>t.id===e)}addEvent(e){let t=q(k({},e),{id:`EVT${Date.now()}`});this.mockEvents.update(i=>[...i,t])}updateEvent(e){this.mockEvents.update(t=>t.map(i=>i.id===e.id?e:i))}deleteEvent(e){this.mockEvents.update(t=>t.filter(i=>i.id!==e))}getDailyRevenueReport(e,t){let i=new Date(e,t-1,1),o=new Date(e,t,0).getDate(),s=`${e}-${String(t).padStart(2,"0")}`,a=[];for(let c=1;c<=o;c++){let d=`${s}-${String(c).padStart(2,"0")}`,g=this.mockDailyRevenue().find(I=>I.date===d)||{date:d,nonEventRevenue:0,isDayOff:!1},y=this.mockEvents().filter(I=>I.date===d&&I.status==="active"),v=y.reduce((I,M)=>I+M.actualRevenue,0),_=g.nonEventRevenue+v,b=y.map(I=>I.name);a.push({day:c,date:d,isDayOff:g.isDayOff,totalDailyRevenue:_,eventRevenue:v,eventNames:b})}return a}getDailyRevenueEntryByDate(e){return this.mockDailyRevenue().find(t=>t.date===e)||{date:e,nonEventRevenue:0,isDayOff:!1}}updateDailyRevenueEntry(e,t){this.mockDailyRevenue.update(i=>{let r=i.findIndex(o=>o.date===e);if(r>-1){let o=[...i];return o[r]=k(k({},o[r]),t),o}else return[...i,{date:e,nonEventRevenue:t.nonEventRevenue??0,isDayOff:t.isDayOff??!1}]})}getEmployees(e){let t=this.mockEmployees();return e?t.filter(i=>i.type===e):t}getEmployeeById(e){return this.mockEmployees().find(t=>t.id===e)}getPayrollSummary(e,t){let i=this.getEmployees("full-time"),r=this.getEmployees("part-time"),o=`${e}-${String(t).padStart(2,"0")}`,s=i.reduce((d,g)=>d+(g.monthlySalary||0),0),a=r.map(d=>{let g=this.mockPunchRecords().filter(b=>b.employeeId===d.id&&b.date.startsWith(o)),y=0,v=0,_=!1;return g.forEach(b=>{if(!b.clockIn||!b.clockOut){_=!0;return}let[I,M]=b.clockIn.split(":").map(Number),[A,B]=b.clockOut.split(":").map(Number),G=new Date(0,0,0,I,M),z=new Date(0,0,0,A,B);if(z<G)return;let ue=(z.getTime()-G.getTime())/(1e3*60)/60,ae=Math.floor(ue*100)/100;y+=ae;let Re=ae*(d.hourlyRate||0);b.isDoublePay&&(Re*=2),v+=Re}),{employeeId:d.id,name:d.name,totalHours:y,totalPay:v,hasMissingPunch:_}}),c=a.reduce((d,g)=>d+g.totalPay,0);return{fullTimePayroll:s,partTimePayroll:c,partTimeDetails:a}}getPunchRecordsForMonth(e,t,i){let r=`${t}-${String(i).padStart(2,"0")}`;return this.mockPunchRecords().filter(o=>o.employeeId===e&&o.date.startsWith(r))}updatePunchRecords(e,t,i,r){let o=`${t}-${String(i).padStart(2,"0")}`;this.mockPunchRecords.update(s=>{let a=s.filter(d=>!(d.employeeId===e&&d.date.startsWith(o))),c=r.filter(d=>d.clockIn||d.clockOut);return[...a,...c]})}getVendors(){return this.mockVendors()}addVendor(e){let t=q(k({},e),{id:`V${Date.now()}`});this.mockVendors.update(i=>[...i,t])}updateVendor(e){this.mockVendors.update(t=>t.map(i=>i.id===e.id?e:i))}deleteVendor(e){this.mockVendors.update(t=>t.filter(i=>i.id!==e))}getPurchaseOrders(){return this.mockPurchaseOrders()}addPurchaseOrder(e){let t=q(k({},e),{id:`PO${Date.now()}`});this.mockPurchaseOrders.update(i=>[...i,t])}updatePurchaseOrder(e){this.mockPurchaseOrders.update(t=>t.map(i=>i.id===e.id?e:i))}deletePurchaseOrder(e){this.mockPurchaseOrders.update(t=>t.filter(i=>i.id!==e))}getProductCosts(){return this.mockProductCosts()}addProductCost(e){let t=q(k({},e),{id:`PC${Date.now()}`});this.mockProductCosts.update(i=>[...i,t])}updateProductCost(e){this.mockProductCosts.update(t=>t.map(i=>i.id===e.id?e:i))}deleteProductCost(e){this.mockProductCosts.update(t=>t.filter(i=>i.id!==e))}getCigarCosts(){return this.mockCigarCosts()}addCigarCost(e){let t=q(k({},e),{id:`C${Date.now()}`});this.mockCigarCosts.update(i=>[...i,t])}updateCigarCost(e){this.mockCigarCosts.update(t=>t.map(i=>i.id===e.id?e:i))}deleteCigarCost(e){this.mockCigarCosts.update(t=>t.filter(i=>i.id!==e))}getWineCosts(){return this.mockWineCosts()}addWineCost(e){let t=q(k({},e),{id:`W${Date.now()}`});this.mockWineCosts.update(i=>[...i,t])}updateWineCost(e){this.mockWineCosts.update(t=>t.map(i=>i.id===e.id?e:i))}deleteWineCost(e){this.mockWineCosts.update(t=>t.filter(i=>i.id!==e))}getCustomers(){return this.mockCustomers()}getFeedbackForCustomer(e){return this.mockCustomerFeedback().filter(t=>t.customerId===e)}getAnnualSummaryReport(e,t){let i=Array.from({length:t-e+1},(s,a)=>e+a),r={years:i,revenue:{total:0},expense:{total:0},net:{total:0},unpaid:{total:0}},o=[...this.mockLedger2024,...this.mockLedger2025,...this.mockLedger2026];return i.forEach(s=>{let a=o.filter(v=>v.date.startsWith(s.toString())),c=a.filter(v=>v.category!=="\u92B7\u8CA8\u6298\u8B93").reduce((v,_)=>v+_.income,0),d=a.filter(v=>v.category==="\u92B7\u8CA8\u6298\u8B93").reduce((v,_)=>v+_.income,0),g=c-d,y=a.reduce((v,_)=>v+_.expense,0);r.revenue[s]=g,r.expense[s]=y,r.net[s]=g-y,r.unpaid[s]=y*.15}),r.revenue.total=i.reduce((s,a)=>s+r.revenue[a],0),r.expense.total=i.reduce((s,a)=>s+r.expense[a],0),r.net.total=i.reduce((s,a)=>s+r.net[a],0),r.unpaid.total=i.reduce((s,a)=>s+r.unpaid[a],0),r}getMonthlyDetail(e,t){let i=e.toString(),o=[...this.mockLedger2024,...this.mockLedger2025,...this.mockLedger2026].filter(a=>a.date.startsWith(i)),s={year:e,type:t==="unpaid"?"\u672A\u4ED8":t==="revenue"?"\u6536\u5165":"\u652F\u51FA",data:[]};for(let a=1;a<=12;a++){let c=`${i}-${String(a).padStart(2,"0")}`,d=o.filter(v=>v.date?.startsWith(c));if(d.length===0)continue;let g=0,y=new Map;t==="revenue"?d.forEach(v=>{if(v.income>0){let _=v.category==="\u92B7\u8CA8\u6298\u8B93"?-v.income:v.income;y.set(v.category,(y.get(v.category)||0)+_),g+=_}}):t==="expense"?d.forEach(v=>{v.expense>0&&(y.set(v.category,(y.get(v.category)||0)+v.expense),g+=v.expense)}):(g=d.reduce((_,b)=>_+b.expense,0)*.15,y.set("\u61C9\u4ED8\u5E33\u6B3E",g*.7),y.set("\u61C9\u4ED8\u85AA\u8CC7",g*.3)),s.data.push({month:a,total:g,items:Array.from(y.entries()).map(([v,_])=>({name:v,amount:_}))})}return s.data.length>0?s:null}getProductGrossMarginReport(e,t){let i={dining:{totalPurchases:5e4,totalSales:15e4,grossMargin:1e5,grossMarginRate:.66},drinks:{totalPurchases:8e4,totalSales:2e5,grossMargin:12e4,grossMarginRate:.6},cigars:{totalPurchases:12e4,totalSales:22e4,grossMargin:1e5,grossMarginRate:.45},venue:{totalPurchases:1e4,totalSales:8e4,grossMargin:7e4,grossMarginRate:.875},total:{totalPurchases:26e4,totalSales:65e4,grossMargin:39e4,grossMarginRate:.6}},r=[],o=new Date(e.replace("/","-")+"-01"),s=new Date(t.replace("/","-")+"-01");for(;o<=s;){let a=5e4+Math.random()*2e4,c=6e4+Math.random()*3e4,d=7e4+Math.random()*4e4,g=2e4+Math.random()*1e4;r.push({month:`${o.getFullYear()}/${String(o.getMonth()+1).padStart(2,"0")}`,dining:a,drinks:c,cigars:d,venue:g,total:a+c+d+g}),o.setMonth(o.getMonth()+1)}return{summary:i,monthlySales:r}}getShareholderRebates(e,t){return[{name:"\u80A1\u6771 A",currentMonthRebate:650,unpaidRebate:1500,cumulativeRebate:8500},{name:"\u80A1\u6771 B",currentMonthRebate:960,unpaidRebate:500,cumulativeRebate:12e3},{name:"\u80A1\u6771 C",currentMonthRebate:200,unpaidRebate:2200,cumulativeRebate:5500}]}getMonthlyRebateHistory(e){return[{year:2024,month:8,totalRebate:650,unpaidRebate:0},{year:2024,month:7,totalRebate:850,unpaidRebate:850},{year:2024,month:6,totalRebate:500,unpaidRebate:0}].filter(t=>t.totalRebate>0)}getRebateTransactions(e,t,i){let r=`${t}/${String(i).padStart(2,"0")}`;return this.mockRebateTransactions().filter(o=>o.shareholderName===e&&o.checkoutTime.startsWith(r))}updateRebateTransaction(e){this.mockRebateTransactions.update(t=>t.map(i=>i.id===e.id?q(k({},e),{isEdited:!0}):i))}getTargetGoals(){return this.mockTargetGoals()}addTargetGoal(e){let t=q(k({},e),{id:`TG${Date.now()}`});this.mockTargetGoals.update(i=>[...i,t])}updateTargetGoal(e){this.mockTargetGoals.update(t=>t.map(i=>i.id===e.id?e:i))}deleteTargetGoal(e){this.mockTargetGoals.update(t=>t.filter(i=>i.id!==e))}};fo.\u0275fac=function(t){return new(t||fo)},fo.\u0275prov=Y({token:fo,factory:fo.\u0275fac,providedIn:"root"});var mt=fo;var kO=["mainCategoryChart"],OO=["diningChart"],VO=["drinksChart"],LO=["monthlyTrendChart"],BO=(n,e)=>e.month;function UO(n,e){if(n&1&&(l(0,"option",13),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),L("",t,"\u5E74")}}function $O(n,e){if(n&1&&(l(0,"option",13),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),L("",t,"\u6708")}}function HO(n,e){if(n&1&&(l(0,"option",13),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),L("",t,"\u5E74")}}function GO(n,e){if(n&1&&(l(0,"option",13),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),L("",t,"\u6708")}}function qO(n,e){if(n&1){let t=U();l(0,"div",4)(1,"div",10)(2,"label",11),m(3,"\u5F9E:"),u(),l(4,"select",12),S("ngModelChange",function(r){w(t);let o=C();return T(o.selectedStartYear.set(r))}),O(5,UO,2,2,"option",13,W),u(),l(7,"select",12),S("ngModelChange",function(r){w(t);let o=C();return T(o.selectedStartMonth.set(r))}),O(8,$O,2,2,"option",13,W),u()(),l(10,"div",10)(11,"label",11),m(12,"\u81F3:"),u(),l(13,"select",12),S("ngModelChange",function(r){w(t);let o=C();return T(o.selectedEndYear.set(r))}),O(14,HO,2,2,"option",13,W),u(),l(16,"select",12),S("ngModelChange",function(r){w(t);let o=C();return T(o.selectedEndMonth.set(r))}),O(17,GO,2,2,"option",13,W),u()(),l(19,"div",14)(20,"button",15),S("click",function(){w(t);let r=C();return T(r.applyAnalysisFilter())}),x(21,"ion-icon",16),l(22,"span"),m(23,"\u5957\u7528"),u()(),l(24,"button",17),S("click",function(){w(t);let r=C();return T(r.resetAnalysisFilter())}),x(25,"ion-icon",18),u()()()}if(n&2){let t=C();h(4),N("ngModel",t.selectedStartYear()),h(),V(t.analysisYears()),h(2),N("ngModel",t.selectedStartMonth()),h(),V(t.analysisMonths()),h(5),N("ngModel",t.selectedEndYear()),h(),V(t.analysisYears()),h(2),N("ngModel",t.selectedEndMonth()),h(),V(t.analysisMonths())}}function WO(n,e){if(n&1&&(l(0,"option",13),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),L("",t,"\u5E74")}}function jO(n,e){if(n&1&&(l(0,"option",13),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),L("",t,"\u6708")}}function zO(n,e){if(n&1&&(l(0,"option",13),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),L("",t,"\u5E74")}}function YO(n,e){if(n&1&&(l(0,"option",13),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),L("",t,"\u6708")}}function JO(n,e){if(n&1){let t=U();l(0,"div",4)(1,"div",10)(2,"label",11),m(3,"\u5F9E:"),u(),l(4,"select",12),ne("ngModelChange",function(r){w(t);let o=C();return re(o.selectedMarginStartYear,r)||(o.selectedMarginStartYear=r),T(r)}),O(5,WO,2,2,"option",13,W),u(),l(7,"select",12),ne("ngModelChange",function(r){w(t);let o=C();return re(o.selectedMarginStartMonth,r)||(o.selectedMarginStartMonth=r),T(r)}),O(8,jO,2,2,"option",13,W),u()(),l(10,"div",10)(11,"label",11),m(12,"\u81F3:"),u(),l(13,"select",12),ne("ngModelChange",function(r){w(t);let o=C();return re(o.selectedMarginEndYear,r)||(o.selectedMarginEndYear=r),T(r)}),O(14,zO,2,2,"option",13,W),u(),l(16,"select",12),ne("ngModelChange",function(r){w(t);let o=C();return re(o.selectedMarginEndMonth,r)||(o.selectedMarginEndMonth=r),T(r)}),O(17,YO,2,2,"option",13,W),u()(),l(19,"div",14)(20,"button",15),S("click",function(){w(t);let r=C();return T(r.applyMarginFilter())}),x(21,"ion-icon",16),l(22,"span"),m(23,"\u5957\u7528"),u()(),l(24,"button",17),S("click",function(){w(t);let r=C();return T(r.resetMarginFilter())}),x(25,"ion-icon",18),u()()()}if(n&2){let t=C();h(4),te("ngModel",t.selectedMarginStartYear),h(),V(t.marginYears()),h(2),te("ngModel",t.selectedMarginStartMonth),h(),V(t.marginAllMonths()),h(5),te("ngModel",t.selectedMarginEndYear),h(),V(t.marginYears()),h(2),te("ngModel",t.selectedMarginEndMonth),h(),V(t.marginAllMonths())}}function KO(n,e){n&1&&(l(0,"div",19)(1,"h3",20),m(2,"\u6708\u92B7\u552E\u8DA8\u52E2"),u(),l(3,"div",26),x(4,"canvas",null,0),u()())}function QO(n,e){n&1&&(l(0,"div",22)(1,"div",27),x(2,"div",28),l(3,"p",29),m(4,"\u8F09\u5165\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u4E2D..."),u()()())}function ZO(n,e){if(n&1&&(l(0,"div",23)(1,"div",30),x(2,"ion-icon",31),l(3,"div",32)(4,"p",33),m(5,"\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u8F09\u5165\u5931\u6557"),u(),l(6,"div",34),m(7),u()()(),l(8,"div",35),m(9," \u{1F4A1} \u63D0\u793A\uFF1A\u76EE\u524D\u8CC7\u6599\u5EAB\u4E2D\u53EA\u6709 "),l(10,"strong"),m(11,"2024-2025 \u5E74"),u(),m(12,"\u7684\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u3002 "),u()()),n&2){let t=C(2);h(7),L(" ",t.productSalesError()," ")}}function XO(n,e){if(n&1&&(l(0,"th",40),m(1),u()),n&2){let t=e.$implicit,i=C(3);h(),E(i.formatMonth(t))}}function eV(n,e){n&1&&(l(0,"th",44),m(1,"\u92B7\u552E\u91CF"),u(),l(2,"th",45),m(3,"\u71DF\u696D\u984D"),u(),l(4,"th",45),m(5,"\u71DF\u696D\u984D\u4F54\u6BD4"),u())}function tV(n,e){if(n&1&&(l(0,"td",49),m(1),u()),n&2){let t=C().$implicit;Q("bg-yellow-50",t.isSubtotal)("bg-red-100",t.isTotal)("bg-white",!t.isSubtotal&&!t.isTotal),h(),L(" ",t.category," ")}}function nV(n,e){n&1&&x(0,"td",47)}function iV(n,e){if(n&1&&(l(0,"td",50),m(1),u(),l(2,"td",50),m(3),u(),l(4,"td",50),m(5),u()),n&2){let t=e.$implicit,i=C().$implicit,r=C(3);h(),E((i.monthlyData[t]==null?null:i.monthlyData[t].sales)||0),h(2),E(r.formatCurrency((i.monthlyData[t]==null?null:i.monthlyData[t].revenue)||0)),h(2),L("",((i.monthlyData[t]==null?null:i.monthlyData[t].rate)||0).toFixed(2),"%")}}function rV(n,e){if(n&1&&(l(0,"tr"),P(1,tV,2,7,"td",46)(2,nV,1,0,"td",47),l(3,"td",48),m(4),u(),O(5,iV,6,3,null,null,W),u()),n&2){let t=e.$implicit,i=C(3);De(t.isSubtotal?"bg-yellow-50 font-semibold":t.isTotal?"bg-red-100 font-bold":"hover:bg-gray-50"),h(),F(!t.item||t.item==="\u5C0F\u8A08"||t.item==="\u7E3D\u8A08"?1:2),h(2),Q("bg-yellow-50",t.isSubtotal)("bg-red-100",t.isTotal)("bg-white",!t.isSubtotal&&!t.isTotal),h(),L(" ",t.item||t.category," "),h(),V(i.monthlySalesData().months)}}function oV(n,e){if(n&1&&(l(0,"div",24)(1,"table",36)(2,"thead",37)(3,"tr")(4,"th",38),m(5,"\u5206\u985E"),u(),l(6,"th",39),m(7,"\u54C1\u9805"),u(),O(8,XO,2,1,"th",40,W),u(),l(10,"tr"),x(11,"th",41)(12,"th",42),O(13,eV,6,0,null,null,W),u()(),l(15,"tbody"),O(16,rV,7,10,"tr",43,_n),u()()()),n&2){let t=C(2);h(8),V(t.monthlySalesData().months),h(5),V(t.monthlySalesData().months),h(3),V(t.monthlySalesData().data)}}function sV(n,e){n&1&&(l(0,"div",25)(1,"p",51),m(2,"\u672A\u627E\u5230\u5546\u54C1\u92B7\u552E\u8CC7\u6599"),u(),l(3,"p",52),m(4,"\u8ACB\u9078\u64C7\u6642\u9593\u7BC4\u570D\u4E26\u5957\u7528\u7BE9\u9078"),u()())}function aV(n,e){if(n&1&&(l(0,"div",1),P(1,KO,6,0,"div",19),l(2,"div")(3,"h3",20),m(4,"\u5546\u54C1\u92B7\u552E\u660E\u7D30\u8868"),u(),l(5,"div",21),P(6,QO,5,0,"div",22),P(7,ZO,13,1,"div",23),P(8,oV,18,0,"div",24),P(9,sV,5,0,"div",25),u()()()),n&2){let t=C();h(),F(!t.isLoadingProductSales()&&t.productSalesData().length>0?1:-1),h(5),F(t.isLoadingProductSales()?6:-1),h(),F(t.productSalesError()?7:-1),h(),F(!t.isLoadingProductSales()&&t.monthlySalesData().data.length>0?8:-1),h(),F(!t.isLoadingProductSales()&&t.monthlySalesData().data.length===0&&!t.productSalesError()?9:-1)}}function lV(n,e){n&1&&(l(0,"div",22)(1,"div",27),x(2,"div",28),l(3,"p",29),m(4,"\u8F09\u5165\u5546\u54C1\u6BDB\u5229\u8CC7\u6599\u4E2D..."),u()()())}function uV(n,e){if(n&1&&(l(0,"div",23)(1,"div",30),x(2,"ion-icon",31),l(3,"div",32)(4,"p",33),m(5,"\u5546\u54C1\u6BDB\u5229\u8CC7\u6599\u8F09\u5165\u5931\u6557"),u(),l(6,"div",34),m(7),u()()(),l(8,"div",35),m(9," \u{1F4A1} \u63D0\u793A\uFF1A\u76EE\u524D\u8CC7\u6599\u5EAB\u4E2D\u53EA\u6709 "),l(10,"strong"),m(11,"2024-2025 \u5E74"),u(),m(12,"\u7684\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u3002 "),u()()),n&2){let t=C(2);h(7),L(" ",t.marginDataError()," ")}}function cV(n,e){if(n&1&&(l(0,"tr",64)(1,"td",65),m(2),u(),l(3,"td"),m(4),u(),l(5,"td"),m(6),u(),l(7,"td"),m(8),u(),l(9,"td"),m(10),u(),l(11,"td",66),m(12),u()()),n&2){let t=e.$implicit,i=C(3);h(2),E(t.month),h(2),E(i.formatCurrency(t.dining)),h(2),E(i.formatCurrency(t.drinks)),h(2),E(i.formatCurrency(t.cigars)),h(2),E(i.formatCurrency(t.venue)),h(2),E(i.formatCurrency(t.total))}}function dV(n,e){n&1&&(l(0,"tr")(1,"td",67),m(2,"\u6B64\u6642\u9593\u5340\u9593\u7121\u8CC7\u6599\u3002"),u()())}function fV(n,e){if(n&1&&(l(0,"div",21)(1,"table",53)(2,"thead",54)(3,"tr",55),x(4,"th",56),l(5,"th",57),m(6,"\u9910\u98F2"),u(),l(7,"th",57),m(8,"\u9152\u6C34"),u(),l(9,"th",57),m(10,"\u96EA\u8304(\u542B\u61C9\u4ED8)"),u(),l(11,"th",57),m(12,"\u6D3B\u52D5\u5834\u5730"),u(),l(13,"th",57),m(14,"\u5C0F\u8A08"),u()()(),l(15,"tbody")(16,"tr",58)(17,"td",59),m(18,"\u9032\u8CA8\u7E3D\u8A08"),u(),l(19,"td"),m(20),u(),l(21,"td"),m(22),u(),l(23,"td"),m(24),u(),l(25,"td",60),m(26,"--"),u(),l(27,"td",61),m(28),u()(),l(29,"tr",58)(30,"td",59),m(31,"\u92B7\u8CA8\u7E3D\u8A08(\u6263\u6298\u8B93)"),u(),l(32,"td"),m(33),u(),l(34,"td"),m(35),u(),l(36,"td"),m(37),u(),l(38,"td"),m(39),u(),l(40,"td",61),m(41),u()(),l(42,"tr",62)(43,"td",59),m(44,"\u6BDB\u5229"),u(),l(45,"td"),m(46),u(),l(47,"td"),m(48),u(),l(49,"td"),m(50),u(),l(51,"td",60),m(52,"--"),u(),l(53,"td",61),m(54),u()(),l(55,"tr",63)(56,"td",59),m(57,"\u6BDB\u5229\u7387"),u(),l(58,"td"),m(59),u(),l(60,"td"),m(61),u(),l(62,"td"),m(63),u(),l(64,"td",60),m(65,"--"),u(),l(66,"td",61),m(67),u()(),O(68,cV,13,6,"tr",64,BO,!1,dV,3,0,"tr"),u()()()),n&2){let t=e,i=C(2);h(20),E(i.formatCurrency(t.summary.dining.totalPurchases)),h(2),E(i.formatCurrency(t.summary.drinks.totalPurchases)),h(2),E(i.formatCurrency(t.summary.cigars.totalPurchases)),h(4),E(i.formatCurrency(t.summary.total.totalPurchases)),h(5),E(i.formatCurrency(t.summary.dining.totalSales)),h(2),E(i.formatCurrency(t.summary.drinks.totalSales)),h(2),E(i.formatCurrency(t.summary.cigars.totalSales)),h(2),E(i.formatCurrency(t.summary.venue.totalSales)),h(2),E(i.formatCurrency(t.summary.total.totalSales)),h(4),Q("text-red-600",t.summary.dining.grossMargin<0),h(),E(i.formatCurrency(t.summary.dining.grossMargin)),h(),Q("text-red-600",t.summary.drinks.grossMargin<0),h(),E(i.formatCurrency(t.summary.drinks.grossMargin)),h(),Q("text-red-600",t.summary.cigars.grossMargin<0),h(),E(i.formatCurrency(t.summary.cigars.grossMargin)),h(3),Q("text-red-600",t.summary.total.grossMargin<0),h(),E(i.formatCurrency(t.summary.total.grossMargin)),h(4),Q("text-red-600",t.summary.dining.grossMarginRate<0),h(),L("",(t.summary.dining.grossMarginRate*100).toFixed(2),"%"),h(),Q("text-red-600",t.summary.drinks.grossMarginRate<0),h(),L("",(t.summary.drinks.grossMarginRate*100).toFixed(2),"%"),h(),Q("text-red-600",t.summary.cigars.grossMarginRate<0),h(),L("",(t.summary.cigars.grossMarginRate*100).toFixed(2),"%"),h(3),Q("text-red-600",t.summary.total.grossMarginRate<0),h(),L("",(t.summary.total.grossMarginRate*100).toFixed(2),"%"),h(),V(t.monthlySales)}}function mV(n,e){n&1&&(l(0,"div",25)(1,"p",51),m(2,"\u672A\u627E\u5230\u5546\u54C1\u6BDB\u5229\u8CC7\u6599"),u(),l(3,"p",52),m(4,"\u8ACB\u9078\u64C7\u6642\u9593\u7BC4\u570D\u4E26\u5957\u7528\u7BE9\u9078"),u()())}function pV(n,e){if(n&1&&(P(0,lV,5,0,"div",22),P(1,uV,13,1,"div",23),P(2,fV,71,34,"div",21),P(3,mV,5,0,"div",25)),n&2){let t,i=C();F(i.isLoadingMarginData()?0:-1),h(),F(i.marginDataError()?1:-1),h(),F((t=!i.isLoadingMarginData()&&i.productGrossMarginReport())?2:-1,t),h(),F(!i.isLoadingMarginData()&&!i.productGrossMarginReport()&&!i.marginDataError()?3:-1)}}var Rs=class Rs{constructor(){this.apiService=R(wt);this.dataService=R(mt);this.injector=R(Wt);this.chartInstances=[];this.colors={main:["#3b82f6","#8b5cf6","#ef4444","#f59e0b"],sub:["#1d4ed8","#3b82f6","#60a5fa","#93c5fd","#bfdbfe"]};this.activeView=D("analysis");this.productSalesData=D([]);this.isLoadingProductSales=D(!1);this.productSalesError=D(null);this.report=D(null);this.analysisYears=D([2025,2024,2023]);this.analysisMonths=D(Array.from({length:12},(e,t)=>t+1));this.selectedStartYear=D(new Date().getMonth()>=3?new Date().getFullYear():new Date().getFullYear()-1);this.selectedStartMonth=D(new Date().getMonth()>=3?new Date().getMonth()-2:new Date().getMonth()+10);this.selectedEndYear=D(new Date().getFullYear());this.selectedEndMonth=D(new Date().getMonth()+1);this.productGrossMarginReport=D(null);this.isLoadingMarginData=D(!1);this.marginDataError=D(null);this.marginYears=D([2025,2024]);this.marginAllMonths=D(Array.from({length:12},(e,t)=>t+1));this.selectedMarginStartYear=D(2024);this.selectedMarginStartMonth=D(12);this.selectedMarginEndYear=D(2025);this.selectedMarginEndMonth=D(12);this.monthlySalesData=H(()=>{let e=this.productSalesData();if(!e||e.length===0)return{months:[],data:[]};let t=this.buildMonthRange(this.selectedStartYear(),this.selectedStartMonth(),this.selectedEndYear(),this.selectedEndMonth());if(console.log("========== monthlySalesData \u8A08\u7B97\u958B\u59CB =========="),console.log("\u9078\u64C7\u7684\u6708\u4EFD\u7BC4\u570D:",t),console.log("\u6536\u5230\u7684\u5206\u985E\u6578:",e.length),e[0]&&console.log("\u7B2C\u4E00\u500B\u5206\u985E\u7684\u6708\u4EFD:",e[0].items.map(a=>a.reportMonth)),t.length===0)return console.warn("\u6708\u4EFD\u7BC4\u570D\u70BA\u7A7A\uFF01"),{months:[],data:[]};let i=[{name:"\u5176\u4ED6",items:["\u5834\u5730\u4F7F\u7528\u8CBB","\u6D3B\u52D5"]},{name:"\u9152\u6C34",items:["\u8ABF\u9152","\u7D05\u9152/\u767D\u9152","\u5564\u9152","\u5A01\u58EB\u5FCC"]},{name:"\u9910\u98F2",items:["\u4E3B\u98DF","\u70B8\u7269","\u5976\u6614","\u6C23\u6CE1\u98F2","\u55AE\u9EDE","\u8336\u98F2","\u8C9D\u679C/\u53EF\u980C","\u5496\u5561","\u751C\u9EDE","\u6C99\u62C9","\u4E0B\u5348\u8336\u5957\u9910"]},{name:"\u96EA\u8304",items:["\u96EA\u8304"]}],r={};i.forEach(a=>{r[a.name]={},t.forEach(c=>{let d=0,g=0;a.items.forEach(y=>{let v=e.find(_=>_.categoryName===y);if(v){let _=v.items.filter(b=>b.reportMonth===c);d+=_.reduce((b,I)=>b+(I.salesNumber||0),0),g+=_.reduce((b,I)=>b+(I.salesAmount||0),0)}}),r[a.name][c]={sales:d,revenue:g}})});let o=[];i.forEach(a=>{if(a.items.length===1&&a.items[0]==="\u96EA\u8304"){let c={};t.forEach(d=>{let g=r[a.name][d];c[d]={sales:g.sales,revenue:g.revenue,rate:0}}),o.push({category:a.name,item:null,isCategory:!0,monthlyData:c})}else{a.items.forEach(d=>{let g={};t.forEach(y=>{let v=e.find(_=>_.categoryName===d);if(v){let _=v.items.filter(M=>M.reportMonth===y),b=_.reduce((M,A)=>M+(A.salesNumber||0),0),I=_.reduce((M,A)=>M+(A.salesAmount||0),0);I>0&&console.log(`\u2713 ${d} ${y}: \u71DF\u696D\u984D=${I}, \u92B7\u91CF=${b}`),g[y]={sales:b,revenue:I,rate:0}}else g[y]={sales:0,revenue:0,rate:0}}),o.push({category:a.name,item:d,isCategory:!1,isItem:!0,monthlyData:g})});let c={};t.forEach(d=>{let g=r[a.name][d];c[d]={sales:g.sales,revenue:g.revenue,rate:0}}),o.push({category:a.name,item:"\u5C0F\u8A08",isSubtotal:!0,monthlyData:c})}}),t.forEach(a=>{let c=i.reduce((d,g)=>d+(r[g.name][a]?.revenue||0),0);o.forEach(d=>{if(d.monthlyData[a]){if(d.isSubtotal||d.isCategory)d.monthlyData[a].rate=c>0?d.monthlyData[a].revenue/c*100:0;else if(d.isItem){let g=r[d.category][a];d.monthlyData[a].rate=g.revenue>0?d.monthlyData[a].revenue/g.revenue*100:0}}})});let s={};return t.forEach(a=>{let c=i.reduce((g,y)=>g+(r[y.name][a]?.sales||0),0),d=i.reduce((g,y)=>g+(r[y.name][a]?.revenue||0),0);s[a]={sales:c,revenue:d,rate:100}}),o.push({category:"\u5408\u8A08",item:"\u7E3D\u8A08",isTotal:!0,monthlyData:s}),{months:t,data:o}});this.summaryMetrics=H(()=>{let e=this.productSalesData();if(!e||e.length===0)return{uniqueProducts:0,totalItemsSold:0,bestContributor:"N/A",totalRevenue:0};let t=e.flatMap(s=>s.items),i=t.length>0?t.sort((s,a)=>a.salesAmount-s.salesAmount)[0]:null,r=e.reduce((s,a)=>s+a.salesAmount,0),o=e.reduce((s,a)=>s+a.salesNumber,0);return{uniqueProducts:t.length,totalItemsSold:o,bestContributor:i?.itemName||"N/A",totalRevenue:r}});this.chartData=H(()=>{let e=this.productSalesData();if(!e||e.length===0)return{main:[],dining:[],drinks:[],cigars:[],other:[]};let t=e.map(r=>({name:r.categoryName,value:r.salesAmount})),i=r=>{let o=e.find(s=>s.categoryName===r);return o?o.items.map(s=>({name:s.itemName,value:s.salesAmount})):[]};return{main:t,dining:i("\u9910\u98F2"),drinks:i("\u9152\u6C34"),cigars:i("\u96EA\u8304"),other:i("\u5176\u4ED6")}});this.monthlyTrendChartData=H(()=>{let e=this.productSalesData();if(console.log("\u{1F4C8} monthlyTrendChartData computed \u88AB\u89F8\u767C"),console.log("categories \u9577\u5EA6:",e?.length),!e||e.length===0)return console.warn("\u26A0\uFE0F \u6C92\u6709 productSalesData"),{labels:[],datasets:[]};let t=this.buildMonthRange(this.selectedStartYear(),this.selectedStartMonth(),this.selectedEndYear(),this.selectedEndMonth());if(console.log("sortedMonths:",t),t.length===0)return console.warn("\u26A0\uFE0F sortedMonths \u70BA\u7A7A"),{labels:[],datasets:[]};let i=t.map(s=>this.formatMonth(s));console.log("\u5716\u8868 labels:",i);let o=[{displayName:"\u5176\u4ED6",dbCategories:["\u5834\u5730\u4F7F\u7528\u8CBB","\u6D3B\u52D5"],color:"#10b981"},{displayName:"\u9152\u6C34",dbCategories:["\u8ABF\u9152","\u7D05\u9152/\u767D\u9152","\u5564\u9152","\u5A01\u58EB\u5FCC"],color:"#8b5cf6"},{displayName:"\u9910\u98F2",dbCategories:["\u4E3B\u98DF","\u70B8\u7269","\u5976\u6614","\u6C23\u6CE1\u98F2","\u55AE\u9EDE","\u8336\u98F2","\u8C9D\u679C/\u53EF\u980C","\u5496\u5561","\u751C\u9EDE","\u6C99\u62C9","\u4E0B\u5348\u8336\u5957\u9910"],color:"#3b82f6"},{displayName:"\u96EA\u8304",dbCategories:["\u96EA\u8304"],color:"#ef4444"}].map(s=>{let a=t.map(c=>{let d=0;return s.dbCategories.forEach(g=>{let y=e.find(v=>v.categoryName===g);if(y){let v=y.items.filter(_=>_.reportMonth===c);d+=v.reduce((_,b)=>_+(b.salesAmount||0),0)}}),d});return{label:s.displayName,data:a,borderColor:s.color,backgroundColor:`${s.color}1A`,fill:!0,tension:.4}});return console.log("datasets \u751F\u6210\u5B8C\u6210:",o.map(s=>({label:s.label,dataLength:s.data.length}))),{labels:i,datasets:o}});this.applyAnalysisFilter(),this.applyMarginFilter(),Vi(()=>{this.activeView()==="analysis"&&this.createAllCharts(this.chartData())}),zr(()=>{let e=this.activeView();At(this.injector,()=>{Vi(()=>{e==="analysis"?this.updateAllCharts(this.chartData()):this.destroyCharts()})})})}changeView(e){this.activeView.set(e)}async applyAnalysisFilter(){let e=`${this.selectedStartYear()}-${String(this.selectedStartMonth()).padStart(2,"0")}`,t=`${this.selectedEndYear()}-${String(this.selectedEndMonth()).padStart(2,"0")}`;if(e>t){this.productSalesError.set("\u274C \u932F\u8AA4\uFF1A\u8D77\u59CB\u5E74\u6708\u4E0D\u80FD\u665A\u65BC\u7D50\u675F\u5E74\u6708\u3002");return}if(this.selectedStartYear()===2026){this.productSalesError.set(`\u26A0\uFE0F \u63D0\u793A\uFF1A\u8CC7\u6599\u5EAB\u4E2D\u76EE\u524D\u53EA\u6709 2024-2025 \u5E74\u7684\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u3002
\u5DF2\u81EA\u52D5\u8ABF\u6574\u70BA 2025 \u5E74\u3002\u8ACB\u9EDE\u64CA\u300C\u5957\u7528\u300D\u91CD\u65B0\u67E5\u8A62\u3002`),this.selectedStartYear.set(2025),this.selectedEndYear.set(2025);return}this.isLoadingProductSales.set(!0),this.productSalesError.set(null);try{console.log("\u2550".repeat(60)),console.log("\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u67E5\u8A62"),console.log("\u2550".repeat(60)),console.log("\u67E5\u8A62\u53C3\u6578:",{startMonth:e,endMonth:t,selectedYear:this.selectedStartYear()});let r=await this.apiService.getProductSales({startMonth:e,endMonth:t,limit:1e4});if(console.log("API \u539F\u59CB\u56DE\u61C9:",{success:r.success,total:r.total,count:r.count,dataLength:r.data?r.data.length:0,categoriesLength:r.categories?r.categories.length:0}),console.log("API \u5B8C\u6574\u56DE\u61C9 data \u524D10\u7B46:",r.data?.slice(0,10)),!r)throw new Error("API \u8FD4\u56DE\u7A7A\u56DE\u61C9");if(!r.success)throw new Error(`API \u8FD4\u56DE\u5931\u6557: ${r.error||"\u672A\u77E5\u932F\u8AA4"}`);if(r.data&&r.data.length>0){console.log(`\u2713 \u6536\u5230 ${r.data.length} \u7B46\u539F\u59CB\u8CC7\u6599\uFF0C\u6B63\u5728\u6309\u5206\u985E\u5206\u7D44...`),console.log("\u524D5\u7B46\u539F\u59CB\u8CC7\u6599:",r.data.slice(0,5));let o=new Map;r.data.forEach(c=>{let d=c.reportMonth;o.set(d,(o.get(d)||0)+1)}),console.log("\u6708\u4EFD\u5206\u4F48:",Array.from(o.entries()).sort());let s=new Map;r.data.forEach(c=>{let d=c.categoryName||"\u5176\u4ED6";s.has(d)||s.set(d,[]),s.get(d).push(c)});let a=[];s.forEach((c,d)=>{console.log(`\u5206\u985E "${d}" \u6709 ${c.length} \u7B46\u8CC7\u6599`),a.push({categoryName:d,categoryUuid:c[0].categoryUuid||"",items:c})}),console.log(`\u2713 \u5206\u7D44\u5B8C\u6210\uFF1A${a.length} \u500B\u5206\u985E`),console.log("\u7B2C\u4E00\u500B\u5206\u985E:",a[0]),a[0]&&(console.log("\u7B2C\u4E00\u500B\u5206\u985E\u7684 items \u6578\u91CF:",a[0].items.length),console.log("\u7B2C\u4E00\u500B\u5206\u985E\u7684\u524D3\u500B items:",a[0].items.slice(0,3))),this.productSalesData.set(a),setTimeout(()=>{console.log("\u{1F4CA} \u6E96\u5099\u66F4\u65B0\u6708\u92B7\u552E\u8DA8\u52E2\u5716\u8868..."),this.createMonthlyTrendChartOnly()},100)}else if(!r.categories||r.categories.length===0)if(console.warn("\u26A0\uFE0F API \u8FD4\u56DE success=true \u4F46 categories \u9663\u5217\u70BA\u7A7A"),console.warn("API \u56DE\u61C9\u9375\u503C:",Object.keys(r)),console.warn("\u5B8C\u6574\u56DE\u61C9:",JSON.stringify(r,null,2)),r.data&&r.data.length>0){console.log("\u2713 \u6AA2\u6E2C\u5230 data \u6B04\u4F4D\u6709\u8CC7\u6599\uFF0C\u6B63\u5728\u91CD\u65B0\u5206\u7D44...");let o=new Map;r.data.forEach(a=>{let c=a.categoryName||"\u5176\u4ED6";o.has(c)||o.set(c,[]),o.get(c).push(a)});let s=[];o.forEach((a,c)=>{let d=a.reduce((y,v)=>y+Number(v.salesAmount||0),0),g=a.reduce((y,v)=>y+Number(v.salesNumber||0),0);s.push({categoryName:c,categoryUuid:a[0].categoryUuid||"",reportMonth:a[0].reportMonth||"",salesAmount:d,salesNumber:g,averagePrice:g>0?d/g:0,items:a})}),console.log(`\u2713 \u5F9E data \u91CD\u65B0\u5206\u7D44\u6210 ${s.length} \u500B\u5206\u985E`),this.productSalesData.set(s),setTimeout(()=>{console.log("\u{1F4CA} \u6E96\u5099\u66F4\u65B0\u6708\u92B7\u552E\u8DA8\u52E2\u5716\u8868..."),this.createMonthlyTrendChartOnly()},100)}else{let o=`\u2717 \u67E5\u8A62\u6642\u9593\u7BC4\u570D\uFF1A${e} \u5230 ${t}
\u2717 API \u8FD4\u56DE\uFF1Atotal=${r.total}, count=${r.count}
\u2717 \u5EFA\u8B70\uFF1A\u9078\u64C7 2024-2025 \u5E74\u9593\u7684\u6708\u4EFD`;this.productSalesError.set(`\u7121\u6CD5\u7372\u53D6\u5546\u54C1\u92B7\u552E\u8CC7\u6599

\u53EF\u80FD\u539F\u56E0\uFF1A
1. \u9078\u64C7\u7684\u6642\u9593\u7BC4\u570D\u6C92\u6709\u92B7\u552E\u8A18\u9304
2. \u8CC7\u6599\u5EAB\u4E2D\u8A72\u6708\u4EFD\u7121\u5546\u54C1\u92B7\u552E\u8CC7\u6599
3. \u8ACB\u9078\u64C7 2024 \u6216 2025 \u5E74

`+o)}}catch(r){console.error("\u274C \u8F09\u5165\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u6642\u767C\u751F\u932F\u8AA4:",r);let o=r instanceof Error?r.message:"\u8F09\u5165\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66";this.productSalesError.set(`\u274C \u932F\u8AA4\uFF1A${o}

\u8A66\u8A66\u770B\uFF1A
1. \u78BA\u8A8D\u5F8C\u7AEF\u670D\u52D9\u5DF2\u555F\u52D5
2. \u9078\u64C7 2024-2025 \u5E74\u7684\u6708\u4EFD
3. \u6253\u958B\u700F\u89BD\u5668 F12 \u67E5\u770B\u8A73\u7D30\u932F\u8AA4`),this.productSalesData.set([])}finally{this.isLoadingProductSales.set(!1)}}resetAnalysisFilter(){let e=new Date,t=e.getFullYear(),i=e.getMonth()+1;i>=4?(this.selectedStartYear.set(t),this.selectedStartMonth.set(i-3)):(this.selectedStartYear.set(t-1),this.selectedStartMonth.set(i+9)),this.selectedEndYear.set(t),this.selectedEndMonth.set(i),this.productSalesError.set(null),this.applyAnalysisFilter()}async applyMarginFilter(){let e=`${this.selectedMarginStartYear()}-${String(this.selectedMarginStartMonth()).padStart(2,"0")}`,t=`${this.selectedMarginEndYear()}-${String(this.selectedMarginEndMonth()).padStart(2,"0")}`;if(e>t){this.marginDataError.set("\u274C \u932F\u8AA4\uFF1A\u8D77\u59CB\u5E74\u6708\u4E0D\u80FD\u665A\u65BC\u7D50\u675F\u5E74\u6708\u3002");return}this.isLoadingMarginData.set(!0),this.marginDataError.set(null);try{console.log("\u2550".repeat(60)),console.log("\u5546\u54C1\u6BDB\u5229\u8CC7\u6599\u67E5\u8A62"),console.log("\u2550".repeat(60)),console.log("\u67E5\u8A62\u53C3\u6578:",{startMonth:e,endMonth:t});let[i,r]=await Promise.all([this.apiService.getProductSales({startMonth:e,endMonth:t,limit:1e4}),this.apiService.getPurchaseCosts({startMonth:e,endMonth:t})]);if(!i||!i.success)throw new Error(`\u92B7\u552E\u6578\u64DA API \u8FD4\u56DE\u5931\u6557: ${i?.error||"\u672A\u77E5\u932F\u8AA4"}`);if(!r||!r.success)throw new Error(`\u9032\u8CA8\u6578\u64DA API \u8FD4\u56DE\u5931\u6557: ${r?.error||"\u672A\u77E5\u932F\u8AA4"}`);if(!i.data||i.data.length===0){this.marginDataError.set(`\u26A0\uFE0F \u63D0\u793A\uFF1A\u9078\u64C7\u7684\u6642\u9593\u7BC4\u570D\u5167\u6C92\u6709\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u3002

\u76EE\u524D\u8CC7\u6599\u5EAB\u4E2D\u53EA\u6709 2024-2025 \u5E74\u7684\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u3002`),this.productGrossMarginReport.set(null);return}console.log(`\u2713 \u6536\u5230 ${i.data.length} \u7B46\u5546\u54C1\u92B7\u552E\u8CC7\u6599`),console.log("\u2713 \u6536\u5230\u9032\u8CA8\u6210\u672C\u8CC7\u6599:",r.data.summary);let o={\u9910\u98F2:["\u4E3B\u98DF","\u70B8\u7269","\u5976\u6614","\u6C23\u6CE1\u98F2","\u55AE\u9EDE","\u8336\u98F2","\u8C9D\u679C/\u53EF\u980C","\u5496\u5561","\u751C\u9EDE","\u6C99\u62C9","\u4E0B\u5348\u8336\u5957\u9910"],\u9152\u6C34:["\u8ABF\u9152","\u7D05\u9152/\u767D\u9152","\u5564\u9152","\u5A01\u58EB\u5FCC"],\u96EA\u8304:["\u96EA\u8304"],\u6D3B\u52D5\u5834\u5730:["\u5834\u5730\u4F7F\u7528\u8CBB","\u6D3B\u52D5","\u5176\u4ED6"]},s=r.data.summary,a={dining:{totalPurchases:s.dining,totalSales:0,grossMargin:0,grossMarginRate:0},drinks:{totalPurchases:s.drinks,totalSales:0,grossMargin:0,grossMarginRate:0},cigars:{totalPurchases:s.cigars,totalSales:0,grossMargin:0,grossMarginRate:0},venue:{totalPurchases:null,totalSales:0,grossMargin:null,grossMarginRate:null},total:{totalPurchases:s.total,totalSales:0,grossMargin:0,grossMarginRate:0}},c=new Map;i.data.forEach(g=>{let y=g.categoryName||"\u5176\u4ED6",v=g.salesAmount||0,_=g.reportMonth,b=null;if(o.\u9910\u98F2.includes(y)?b="dining":o.\u9152\u6C34.includes(y)?b="drinks":o.\u96EA\u8304.includes(y)?b="cigars":o.\u6D3B\u52D5\u5834\u5730.includes(y)&&(b="venue"),b){a[b].totalSales+=v,a.total.totalSales+=v,c.has(_)||c.set(_,{month:_.replace("-","/"),dining:0,drinks:0,cigars:0,venue:0,total:0});let I=c.get(_);I[b]+=v,I.total+=v}}),["dining","drinks","cigars","total"].forEach(g=>{let y=a[g];y.totalPurchases!==null&&(y.grossMargin=y.totalSales-y.totalPurchases,y.grossMarginRate=y.totalSales>0?y.grossMargin/y.totalSales:0)});let d=Array.from(c.values()).sort((g,y)=>g.month.localeCompare(y.month));console.log("\u2713 \u5546\u54C1\u6BDB\u5229\u8A08\u7B97\u5B8C\u6210:",{summary:a,monthlySalesCount:d.length}),this.productGrossMarginReport.set({summary:a,monthlySales:d})}catch(i){console.error("\u274C \u8F09\u5165\u5546\u54C1\u6BDB\u5229\u8CC7\u6599\u6642\u767C\u751F\u932F\u8AA4:",i);let r=i instanceof Error?i.message:"\u8F09\u5165\u5546\u54C1\u6BDB\u5229\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66";this.marginDataError.set(`\u274C \u932F\u8AA4\uFF1A${r}

\u63D0\u793A\uFF1A
1. \u78BA\u8A8D\u5F8C\u7AEF\u670D\u52D9\u5DF2\u555F\u52D5
2. \u9078\u64C7 2024-2025 \u5E74\u7684\u6708\u4EFD
3. \u6253\u958B\u700F\u89BD\u5668 F12 \u67E5\u770B\u8A73\u7D30\u932F\u8AA4`),this.productGrossMarginReport.set(null)}finally{this.isLoadingMarginData.set(!1)}}resetMarginFilter(){this.selectedMarginStartYear.set(2024),this.selectedMarginStartMonth.set(12),this.selectedMarginEndYear.set(2025),this.selectedMarginEndMonth.set(12),this.applyMarginFilter()}formatMonth(e){return`${parseInt(e.split("-")[1],10)}\u6708`}buildMonthRange(e,t,i,r){let o=Number(e),s=Number(t),a=Number(i),c=Number(r);if(!o||!s||!a||!c)return[];let d=[],g=o,y=s;for(;g<a||g===a&&y<=c;)d.push(`${g}-${String(y).padStart(2,"0")}`),y+=1,y>12&&(y=1,g+=1);return d}formatCurrency(e){return e==null?"NT$0":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}createAllCharts(e){this.destroyCharts(),this.mainCategoryChart=this.createDonutChart(this.mainCategoryChartRef,e.main,"\u4E3B\u8981\u5206\u985E\u71DF\u6536\u4F54\u6BD4",this.colors.main),this.diningChart=this.createDonutChart(this.diningChartRef,e.dining,"\u9910\u98F2\u985E\u54C1\u9805\u4F54\u6BD4",this.colors.sub),this.drinksChart=this.createDonutChart(this.drinksChartRef,e.drinks,"\u9152\u6C34\u985E\u54C1\u9805\u4F54\u6BD4",this.colors.sub),this.chartInstances=[this.mainCategoryChart,this.diningChart,this.drinksChart].filter(t=>t)}createMonthlyTrendChartOnly(){console.log("\u{1F4CA} createMonthlyTrendChartOnly \u88AB\u8ABF\u7528");let e=this.monthlyTrendChartData();if(console.log("\u5716\u8868\u8CC7\u6599:",{labelsLength:e.labels?.length,datasetsLength:e.datasets?.length,labels:e.labels,datasets:e.datasets?.map(t=>({label:t.label,dataLength:t.data?.length,data:t.data}))}),!this.monthlyTrendChartRef){console.error("\u274C monthlyTrendChartRef \u4E0D\u5B58\u5728\uFF01");return}if(!this.monthlyTrendChartRef.nativeElement){console.error("\u274C monthlyTrendChartRef.nativeElement \u4E0D\u5B58\u5728\uFF01");return}if(console.log("\u2713 Canvas \u5143\u7D20\u5B58\u5728"),this.monthlyTrendChart){console.log("\u{1F5D1}\uFE0F \u92B7\u6BC0\u820A\u5716\u8868");try{this.monthlyTrendChart.destroy()}catch(t){console.warn("\u92B7\u6BC0\u5716\u8868\u6642\u51FA\u932F\uFF08\u53EF\u80FD\u5DF2\u88AB\u92B7\u6BC0\uFF09:",t)}this.monthlyTrendChart=null}e.labels.length>0?(console.log("\u{1F3A8} \u5275\u5EFA\u65B0\u5716\u8868\uFF0Clabels:",e.labels.length,"datasets:",e.datasets.length),this.monthlyTrendChart=this.createMonthlyTrendChart(this.monthlyTrendChartRef,e),this.monthlyTrendChart?console.log("\u2705 \u5716\u8868\u5275\u5EFA\u6210\u529F\uFF01",this.monthlyTrendChart):console.error("\u274C \u5716\u8868\u5275\u5EFA\u5931\u6557\uFF01createMonthlyTrendChart \u8FD4\u56DE null")):console.warn("\u26A0\uFE0F \u6C92\u6709\u5716\u8868\u8CC7\u6599\uFF08labels \u70BA\u7A7A\uFF09")}updateAllCharts(e){this.destroyCharts(),this.createAllCharts(e)}destroyCharts(){this.chartInstances.forEach(e=>e?.destroy()),this.chartInstances=[],this.monthlyTrendChart&&(this.monthlyTrendChart.destroy(),this.monthlyTrendChart=null)}createTooltipCallback(e){return t=>{let i=t.label||"",r=t.raw||0,o=e>0?(r/e*100).toFixed(2):0,s=new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0}).format(r);return`${i}: ${s} (${o}%)`}}createDonutChart(e,t,i,r){if(!e||!e.nativeElement||t.length===0)return null;let o=e.nativeElement.getContext("2d");if(!o)return null;let s=t.reduce((a,c)=>a+c.value,0);return new Chart(o,{type:"doughnut",data:{labels:t.map(a=>a.name),datasets:[{data:t.map(a=>a.value),backgroundColor:r,hoverOffset:4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!0,text:i,font:{size:16}},legend:{display:!0,position:"bottom",labels:{boxWidth:12,padding:15}},tooltip:{callbacks:{label:this.createTooltipCallback(s)}}}}})}createMonthlyTrendChart(e,t){if(!e||!e.nativeElement||t.datasets.length===0)return null;let i=e.nativeElement.getContext("2d");return i?new Chart(i,{type:"line",data:t,options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{callback:r=>this.formatCurrency(r)}}},plugins:{title:{display:!0,text:"\u6BCF\u6708\u54C1\u9805\u71DF\u6536\u8DA8\u52E2",font:{size:16}},legend:{display:!0,position:"bottom"},tooltip:{callbacks:{label:r=>`${r.dataset.label}: ${this.formatCurrency(r.raw)}`}}}}}):null}};Rs.\u0275fac=function(t){return new(t||Rs)},Rs.\u0275cmp=ee({type:Rs,selectors:[["app-product-analysis"]],viewQuery:function(t,i){if(t&1&&(Cn(kO,5),Cn(OO,5),Cn(VO,5),Cn(LO,5)),t&2){let r;en(r=tn())&&(i.mainCategoryChartRef=r.first),en(r=tn())&&(i.diningChartRef=r.first),en(r=tn())&&(i.drinksChartRef=r.first),en(r=tn())&&(i.monthlyTrendChartRef=r.first)}},decls:16,vars:8,consts:[["monthlyTrendChart",""],[1,"space-y-8"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"flex","flex-col","sm:flex-row","items-center","gap-2","bg-white","p-3","rounded-xl","shadow-md","border","border-gray-200"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"border-b","border-gray-200"],["aria-label","Tabs",1,"-mb-px","flex","space-x-6"],[1,"whitespace-nowrap","py-4","px-1","border-b-2","font-medium","text-sm",3,"click"],[1,"pt-6"],[1,"flex","items-center","gap-2"],[1,"text-sm","font-medium","text-gray-600"],[1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100",3,"ngModelChange","ngModel"],[3,"value"],[1,"flex","items-center","gap-2","mt-2","sm:mt-0"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","filter-outline"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"bg-white","p-6","rounded-xl","shadow-inner","border","mb-6"],[1,"text-lg","font-semibold","text-gray-800","mb-4"],[1,"overflow-x-auto"],[1,"flex","items-center","justify-center","h-32","bg-white","rounded-xl"],[1,"bg-red-50","border-l-4","border-red-500","p-4","rounded-lg","mb-4","space-y-3"],[1,"overflow-x-auto","border","rounded-lg",2,"max-width","100%"],[1,"bg-gray-50","border","border-gray-200","rounded-lg","p-8","text-center"],[1,"h-80"],[1,"flex","flex-col","items-center","space-y-2"],[1,"w-8","h-8","border-3","border-indigo-200","border-t-indigo-600","rounded-full","animate-spin"],[1,"text-sm","text-gray-500"],[1,"flex","items-start","gap-3"],["name","alert-circle-outline",1,"text-2xl","text-red-600","flex-shrink-0","mt-1"],[1,"flex-grow"],[1,"font-bold","text-red-900","text-lg"],[1,"mt-2","text-sm","text-red-800","whitespace-pre-wrap","leading-relaxed"],[1,"bg-red-100","p-3","rounded","text-sm","text-red-900","font-medium"],[1,"text-sm","text-left","border-collapse","bg-white",2,"min-width","100%","width","max-content"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100","sticky","top-0","z-40"],["scope","col",1,"px-3","py-2","border","border-gray-300","font-semibold","sticky","left-0","bg-gray-100","z-50",2,"min-width","80px"],["scope","col",1,"px-3","py-2","border","border-gray-300","font-semibold","sticky","bg-gray-100","z-50",2,"left","80px","min-width","120px"],["scope","col","colspan","3",1,"px-2","py-2","border","border-gray-300","text-center","font-semibold","bg-gray-100",2,"min-width","200px"],[1,"px-3","py-2","border","border-gray-300","sticky","left-0","bg-gray-100","z-50"],[1,"px-3","py-2","border","border-gray-300","sticky","bg-gray-100","z-50",2,"left","80px"],[3,"class"],["scope","col",1,"px-2","py-1","border","border-gray-300","text-center","text-xs","bg-gray-100",2,"min-width","60px"],["scope","col",1,"px-2","py-1","border","border-gray-300","text-center","text-xs","bg-gray-100",2,"min-width","70px"],[1,"px-3","py-2","border","border-gray-300","font-semibold","sticky","left-0","z-20",3,"bg-yellow-50","bg-red-100","bg-white"],[1,"px-3","py-2","border","border-gray-300","sticky","left-0","bg-white","z-20"],[1,"px-3","py-2","border","border-gray-300","sticky","z-20",2,"left","80px"],[1,"px-3","py-2","border","border-gray-300","font-semibold","sticky","left-0","z-20"],[1,"px-2","py-2","border","border-gray-300","text-right","text-xs",2,"white-space","nowrap"],[1,"text-gray-500","mb-2"],[1,"text-sm","text-gray-400"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50"],[1,"text-center"],[1,"py-3","px-4","text-left"],[1,"py-3","px-4"],[1,"border-b","text-right"],[1,"py-3","px-4","font-semibold","text-gray-800","text-left"],[1,"text-gray-400"],[1,"font-bold"],[1,"border-b","text-right","font-medium"],[1,"border-b","text-right","font-medium","bg-gray-50"],[1,"border-b","text-right","hover:bg-gray-50"],[1,"py-2","px-4","text-gray-500","text-left"],[1,"font-semibold"],["colspan","6",1,"text-center","py-8","text-gray-500"]],template:function(t,i){t&1&&(l(0,"div",1)(1,"div",2)(2,"h1",3),m(3,"\u5546\u54C1\u5206\u6790"),u(),P(4,qO,26,4,"div",4),P(5,JO,26,4,"div",4),u(),l(6,"div",5)(7,"div",6)(8,"nav",7)(9,"button",8),S("click",function(){return i.changeView("analysis")}),m(10," \u5546\u54C1\u5206\u6790 "),u(),l(11,"button",8),S("click",function(){return i.changeView("margin")}),m(12," \u5546\u54C1\u6BDB\u5229 "),u()()(),l(13,"div",9),P(14,aV,10,5,"div",1),P(15,pV,4,4),u()()()),t&2&&(h(4),F(i.activeView()==="analysis"?4:-1),h(),F(i.activeView()==="margin"?5:-1),h(4),De(i.activeView()==="analysis"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),h(2),De(i.activeView()==="margin"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),h(3),F(i.activeView()==="analysis"?14:-1),h(),F(i.activeView()==="margin"?15:-1))},dependencies:[oe,Ee,Fe,ke,Ae,ge,we],encapsulation:2,changeDetection:0});var Jf=Rs;var gV=(n,e)=>e.entry_id;function hV(n,e){n&1&&(l(0,"div",2),x(1,"ion-icon",12),l(2,"span",13),m(3,"\u6B63\u5728\u52A0\u8F09\u6578\u64DA..."),u()())}function yV(n,e){if(n&1&&(l(0,"div",3),x(1,"ion-icon",14),l(2,"span",15),m(3),u()()),n&2){let t=C();h(3),E(t.errorMessage())}}function vV(n,e){if(n&1&&(l(0,"option",27),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),E(t)}}function _V(n,e){if(n&1&&(l(0,"option",27),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),E(t)}}function CV(n,e){if(n&1&&(l(0,"option",27),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),E(t)}}function xV(n,e){n&1&&(x(0,"ion-icon",48),l(1,"span"),m(2,"\u5957\u7528\u4E2D..."),u())}function EV(n,e){n&1&&(x(0,"ion-icon",49),l(1,"span"),m(2,"\u5957\u7528"),u())}function bV(n,e){if(n&1){let t=U();l(0,"tr",50),S("click",function(){let r=w(t).$implicit,o=C(2);return T(o.openEditModal(r))}),l(1,"td",51),x(2,"input",52),u(),l(3,"td",53),m(4),u(),l(5,"td",53),m(6),u(),l(7,"td",53),m(8),u(),l(9,"td",54),m(10),u(),l(11,"td",53),m(12),u(),l(13,"td",53),m(14),u(),l(15,"td",53),m(16),u(),l(17,"td",55),m(18),u()()}if(n&2){let t=e.$implicit,i=C(2);Q("bg-red-50",!t.is_sigh_off),h(2),N("checked",t.is_sigh_off),h(2),E((t.entry_date==null?null:t.entry_date.substring(0,10))||t.entry_date),h(2),E(t.item_group),h(2),E(t.subject_name),h(2),E(i.formatCurrency(t.amount)),h(2),E(t.invoice_no),h(2),E(t.vendor_tax_id),h(2),E(t.vendor_name),h(2),E(t.description)}}function SV(n,e){n&1&&(l(0,"tr")(1,"td",56),m(2,"\u7121\u7B26\u5408\u689D\u4EF6\u7684\u6D41\u6C34\u5E33\u8CC7\u6599\u3002"),u()())}function DV(n,e){if(n&1){let t=U();l(0,"div",9)(1,"div",16)(2,"div",17)(3,"label",18),m(4,"\u5F9E:"),u(),l(5,"div",19)(6,"input",20),ne("ngModelChange",function(r){w(t);let o=C();return re(o.startDate,r)||(o.startDate=r),T(r)}),u(),l(7,"div",21),x(8,"ion-icon",22),u()()(),l(9,"div",17)(10,"label",23),m(11,"\u81F3:"),u(),l(12,"div",19)(13,"input",24),ne("ngModelChange",function(r){w(t);let o=C();return re(o.endDate,r)||(o.endDate=r),T(r)}),u(),l(14,"div",21),x(15,"ion-icon",22),u()()(),l(16,"div")(17,"select",25),ne("ngModelChange",function(r){w(t);let o=C();return re(o.selectedItem,r)||(o.selectedItem=r),T(r)}),l(18,"option",26),m(19,"\u6240\u6709\u9805\u76EE"),u(),O(20,vV,2,2,"option",27,W),u()(),l(22,"div")(23,"select",28),ne("ngModelChange",function(r){w(t);let o=C();return re(o.selectedCategory,r)||(o.selectedCategory=r),T(r)}),l(24,"option",26),m(25,"\u6240\u6709\u79D1\u76EE"),u(),O(26,_V,2,2,"option",27,W),u()(),l(28,"div",29)(29,"select",25),ne("ngModelChange",function(r){w(t);let o=C();return re(o.selectedVendor,r)||(o.selectedVendor=r),T(r)}),l(30,"option",26),m(31,"\u6240\u6709\u8CE3\u65B9"),u(),O(32,CV,2,2,"option",27,W),u()(),l(34,"div",29)(35,"input",30),ne("ngModelChange",function(r){w(t);let o=C();return re(o.descriptionFilter,r)||(o.descriptionFilter=r),T(r)}),u()(),l(36,"div",31)(37,"button",32),S("click",function(){w(t);let r=C();return T(r.applyFilters())}),P(38,xV,3,0)(39,EV,3,0),u(),l(40,"button",33),S("click",function(){w(t);let r=C();return T(r.resetFilters())}),x(41,"ion-icon",34),u()()(),l(42,"div",35)(43,"table",36)(44,"thead",37)(45,"tr")(46,"th",38)(47,"div",39)(48,"input",40),S("change",function(r){w(t);let o=C();return T(o.toggleAllApprovals(r))}),u(),l(49,"span"),m(50,"\u7C3D\u6838"),u()()(),l(51,"th",41),S("click",function(){w(t);let r=C();return T(r.sortData("entry_date"))}),m(52,"\u65E5\u671F "),x(53,"ion-icon",42),u(),l(54,"th",41),S("click",function(){w(t);let r=C();return T(r.sortData("item_group"))}),m(55,"\u9805\u76EE "),x(56,"ion-icon",42),u(),l(57,"th",41),S("click",function(){w(t);let r=C();return T(r.sortData("subject_name"))}),m(58,"\u79D1\u76EE "),x(59,"ion-icon",42),u(),l(60,"th",43),S("click",function(){w(t);let r=C();return T(r.sortData("amount"))}),m(61,"\u91D1\u984D "),x(62,"ion-icon",42),u(),l(63,"th",41),S("click",function(){w(t);let r=C();return T(r.sortData("invoice_no"))}),m(64,"\u767C\u7968\u865F\u78BC "),x(65,"ion-icon",42),u(),l(66,"th",41),S("click",function(){w(t);let r=C();return T(r.sortData("vendor_tax_id"))}),m(67,"\u8CE3\u65B9\u7D71\u7DE8 "),x(68,"ion-icon",42),u(),l(69,"th",41),S("click",function(){w(t);let r=C();return T(r.sortData("vendor_name"))}),m(70,"\u8CE3\u65B9\u540D\u7A31 "),x(71,"ion-icon",42),u(),l(72,"th",38),m(73,"\u8AAA\u660E"),u()()(),l(74,"tbody"),O(75,bV,19,11,"tr",44,gV,!1,SV,3,0,"tr"),u()()(),l(78,"div",45)(79,"div",46),m(80),u(),l(81,"div",17)(82,"button",47),S("click",function(){w(t);let r=C();return T(r.goToPrevPage())}),m(83," \u4E0A\u4E00\u9801 "),u(),l(84,"button",47),S("click",function(){w(t);let r=C();return T(r.goToNextPage())}),m(85," \u4E0B\u4E00\u9801 "),u()()()()}if(n&2){let t=C();h(6),te("ngModel",t.startDate),h(7),te("ngModel",t.endDate),h(4),te("ngModel",t.selectedItem),h(3),V(t.filterOptions().items),h(3),te("ngModel",t.selectedCategory),N("disabled",!t.selectedItem()),h(3),V(t.filterAvailableCategories()),h(3),te("ngModel",t.selectedVendor),h(3),V(t.filterOptions().vendorNames),h(3),te("ngModel",t.descriptionFilter),h(2),N("disabled",t.isLoading()),h(),F(t.isLoading()?38:39),h(10),N("checked",t.areAllApproved()),h(27),V(t.pagedTransactions()),h(5),Pt(" \u7B2C ",t.currentPage()," / ",t.totalPages()," \u9801\uFF0C\u5171 ",t.totalRecords()," \u7B46 "),h(2),N("disabled",t.currentPage()===1),h(2),N("disabled",t.currentPage()===t.totalPages())}}function wV(n,e){if(n&1&&(l(0,"option",27),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),E(t)}}function TV(n,e){if(n&1&&(l(0,"option",27),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),E(t)}}function IV(n,e){if(n&1){let t=U();l(0,"form",57),S("ngSubmit",function(){w(t);let r=C();return T(r.handleFormSubmit())}),l(1,"div",58)(2,"div")(3,"label",59),m(4,"\u65E5\u671F*"),u(),l(5,"div",60),x(6,"input",61),l(7,"div",21),x(8,"ion-icon",22),u()()(),l(9,"div")(10,"label",62),m(11,"\u9805\u76EE*"),u(),l(12,"select",63)(13,"option",64),m(14,"\u8ACB\u9078\u64C7\u9805\u76EE"),u(),O(15,wV,2,2,"option",27,W),u()(),l(17,"div")(18,"label",65),m(19,"\u79D1\u76EE*"),u(),l(20,"select",66)(21,"option",64),m(22,"\u8ACB\u9078\u64C7\u79D1\u76EE"),u(),O(23,TV,2,2,"option",27,W),u()(),l(25,"div")(26,"label",67),m(27,"\u91D1\u984D*"),u(),x(28,"input",68),u(),l(29,"div")(30,"label",69),m(31,"\u767C\u7968\u865F\u78BC"),u(),x(32,"input",70),u(),l(33,"div")(34,"label",71),m(35,"\u8CE3\u65B9\u7D71\u7DE8"),u(),l(36,"input",72),S("input",function(r){w(t);let o=C();return T(o.onVendorTaxIdInput(r))}),u()(),l(37,"div",73)(38,"label",74),m(39,"\u8CE3\u65B9\u540D\u7A31"),u(),x(40,"input",75),u(),l(41,"div",73)(42,"label",76),m(43,"\u8AAA\u660E"),u(),x(44,"textarea",77),u()(),l(45,"div",78)(46,"button",79),S("click",function(){w(t);let r=C();return T(r.resetForm())}),m(47,"\u53D6\u6D88"),u(),l(48,"button",80),m(49,"\u9001\u51FA"),u()()()}if(n&2){let t=C();N("formGroup",t.ledgerForm),h(6),Q("border-red-500",t.isInvalid("entry_date")),h(6),Q("border-red-500",t.isInvalid("item_group")),h(3),V(t.filterOptions().items),h(5),Q("border-red-500",t.isInvalid("subject_name")),h(3),V(t.availableCategories()),h(5),Q("border-red-500",t.isInvalid("amount"))}}function MV(n,e){if(n&1&&(l(0,"option",27),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),E(t)}}function AV(n,e){if(n&1&&(l(0,"option",27),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),E(t)}}function NV(n,e){if(n&1){let t=U();l(0,"div",11)(1,"div",81)(2,"div",82)(3,"h3",83),m(4,"\u4FEE\u6539\u6D41\u6C34\u5E33"),u(),l(5,"button",84),S("click",function(){w(t);let r=C();return T(r.closeModal())}),x(6,"ion-icon",85),u()(),l(7,"div",86)(8,"form",87),S("ngSubmit",function(){w(t);let r=C();return T(r.handleFormSubmit())}),l(9,"div",58)(10,"div")(11,"label",88),m(12,"\u65E5\u671F*"),u(),l(13,"div",60),x(14,"input",89),l(15,"div",21),x(16,"ion-icon",22),u()()(),l(17,"div")(18,"label",90),m(19,"\u9805\u76EE*"),u(),l(20,"select",91),O(21,MV,2,2,"option",27,W),u()(),l(23,"div")(24,"label",92),m(25,"\u79D1\u76EE*"),u(),l(26,"select",93),O(27,AV,2,2,"option",27,W),u()(),l(29,"div")(30,"label",94),m(31,"\u91D1\u984D*"),u(),x(32,"input",95),u(),l(33,"div")(34,"label",96),m(35,"\u767C\u7968\u865F\u78BC"),u(),x(36,"input",97),u(),l(37,"div")(38,"label",98),m(39,"\u8CE3\u65B9\u7D71\u7DE8"),u(),l(40,"input",99),S("input",function(r){w(t);let o=C();return T(o.onVendorTaxIdInput(r))}),u()(),l(41,"div",73)(42,"label",100),m(43,"\u8CE3\u65B9\u540D\u7A31"),u(),x(44,"input",101),u(),l(45,"div",73)(46,"label",102),m(47,"\u8AAA\u660E"),u(),x(48,"textarea",103),u(),l(49,"div",73)(50,"label",104),x(51,"input",105),l(52,"span",106),m(53,"\u5DF2\u7C3D\u6838"),u()()()(),l(54,"div",107)(55,"button",79),S("click",function(){w(t);let r=C();return T(r.closeModal())}),m(56,"\u53D6\u6D88"),u(),l(57,"button",80),m(58,"\u4FEE\u6539"),u()()()()()()}if(n&2){let t=C();h(8),N("formGroup",t.ledgerForm),h(6),Q("border-red-500",t.isInvalid("entry_date")),h(6),Q("border-red-500",t.isInvalid("item_group")),h(),V(t.filterOptions().items),h(5),Q("border-red-500",t.isInvalid("subject_name")),h(),V(t.availableCategories()),h(5),Q("border-red-500",t.isInvalid("amount"))}}function RV(n,e){if(n&1){let t=U();l(0,"div",11)(1,"div",108)(2,"div",109)(3,"div",110),x(4,"ion-icon",111),u(),l(5,"h3",112),m(6,"\u8ACB\u78BA\u8A8D"),u(),l(7,"p",113),m(8),u()(),l(9,"div",114)(10,"button",115),S("click",function(){w(t);let r=C();return T(r.cancelApproval())}),m(11,"\u53D6\u6D88"),u(),l(12,"button",116),S("click",function(){w(t);let r=C();return T(r.confirmApproval())}),m(13,"\u78BA\u8A8D"),u()()()()}n&2&&(h(8),E(e.message))}var Ps=class Ps{constructor(){this.apiService=R(wt);this.fb=R(ze);this.activeView=D("details");this.allTransactions=D([]);this.displayedTransactions=D([]);this.pagination=D({total:0,totalPages:1,page:1,limit:20});this.filterOptions=D({items:[],categories:[],vendorNames:[]});this.editingTransaction=D(null);this.isModalOpen=D(!1);this.isLoading=D(!1);this.errorMessage=D(null);this.confirmationState=D(null);this.today=new Date;this.firstDayOfMonth=new Date(this.today.getFullYear(),this.today.getMonth(),1);this.lastDayOfMonth=new Date(this.today.getFullYear(),this.today.getMonth()+1,0);this.startDate=D(this.formatDate(this.firstDayOfMonth));this.endDate=D(this.formatDate(this.lastDayOfMonth));this.selectedItem=D("");this.selectedCategory=D("");this.selectedVendor=D("");this.descriptionFilter=D("");this.appliedItem=D("");this.appliedCategory=D("");this.appliedVendor=D("");this.appliedDescriptionFilter=D("");this.pageSize=20;this.currentPage=D(1);this.sortColumn=D("entry_date");this.sortDirection=D("desc");this.submitted=D(!1);this.ledgerForm=this.fb.group({entry_id:[""],entry_date:["",$.required],item_group:["",$.required],subject_name:["",$.required],amount:["",$.required],invoice_no:[""],vendor_tax_id:["",[$.pattern(/^\d{0,8}$/)]],vendor_name:[""],description:[""],is_sigh_off:[!1]});this.itemCategoryMap={\u8CC7\u7522:["\u73FE\u91D1","\u9280\u884C\u5B58\u6B3E","\u61C9\u6536\u5E33\u6B3E","\u5B58\u8CA8"],\u8CA0\u50B5:["\u61C9\u4ED8\u5E33\u6B3E","\u61C9\u4ED8\u85AA\u8CC7","\u61C9\u4ED8\u7A05\u6B3E"],\u696D\u4E3B\u6B0A\u76CA:["\u8CC7\u672C","\u4FDD\u7559\u76C8\u9918"],\u71DF\u696D\u6536\u5165:["\u92B7\u8CA8\u6536\u5165","\u5176\u4ED6\u6536\u5165"],\u71DF\u696D\u8CBB\u7528:["\u4EBA\u4E8B\u8CBB\u7528","\u9032\u8CA8\u6210\u672C","\u5176\u4ED6\u8CBB\u7528"]};this.availableCategories=H(()=>{let e=this.ledgerForm.get("item_group")?.value;if(e){let t=this.itemCategoryMap[e]||[],i=this.allTransactions().filter(o=>o.item_group===e).map(o=>o.subject_name).filter(Boolean),r=this.ledgerForm.get("subject_name")?.value;return[...new Set([...t,...i,...r?[r]:[]])]}return[]});this.filterAvailableCategories=H(()=>{let e=this.selectedItem();if(!e)return[];let i=this.allTransactions().filter(r=>r.item_group===e).map(r=>r.subject_name).filter(Boolean);return[...new Set(i)].sort()});this.pagedTransactions=H(()=>this.displayedTransactions());this.totalPages=H(()=>this.pagination().totalPages);this.totalRecords=H(()=>this.pagination().total);this.areAllApproved=H(()=>{let e=this.displayedTransactions();return e.length>0&&e.every(t=>t.is_sigh_off)});this.loadInitialData(),this.ledgerForm.get("item_group")?.valueChanges.subscribe(()=>{this.ledgerForm.get("subject_name")?.setValue("")}),zr(()=>{this.selectedItem()||this.selectedCategory.set("")})}async loadInitialData(){await this.applyFilters()}async applyFilters(){this.isLoading.set(!0),this.errorMessage.set(null),this.appliedItem.set(this.selectedItem()),this.appliedCategory.set(this.selectedCategory()),this.appliedVendor.set(this.selectedVendor()),this.appliedDescriptionFilter.set(this.descriptionFilter()),this.currentPage.set(1),await this.loadPageData(1)}async loadPageData(e){this.isLoading.set(!0),this.errorMessage.set(null);try{let t=await this.apiService.getLedgerEntries({startDate:this.startDate(),endDate:this.endDate(),itemGroup:this.appliedItem()||void 0,subjectName:this.appliedCategory()||void 0,vendorName:this.appliedVendor()||void 0,description:this.appliedDescriptionFilter()||void 0,page:e,limit:20});if(t.success&&t.data){if(this.displayedTransactions.set(t.data),t.pagination&&this.pagination.set({total:t.pagination.total,totalPages:t.pagination.totalPages,page:t.pagination.page,limit:t.pagination.limit}),e===1){let i=await this.apiService.getLedgerEntries({startDate:this.startDate(),endDate:this.endDate(),limit:9999});if(i.success&&i.data){this.allTransactions.set(i.data);let r=Object.keys(this.itemCategoryMap),o=i.data.map(d=>d.item_group).filter(Boolean),s=[...new Set([...r,...o])].sort(),a=[...new Set(i.data.map(d=>d.subject_name).filter(Boolean))].sort(),c=[...new Set(i.data.map(d=>d.vendor_name).filter(Boolean))].sort();this.filterOptions.set({items:s,categories:a,vendorNames:c})}}}else this.errorMessage.set(t.error||"\u7121\u6CD5\u53D6\u5F97\u6D41\u6C34\u5E33\u8CC7\u6599")}catch(t){console.error("Error loading ledger entries:",t),this.errorMessage.set("\u53D6\u5F97\u6D41\u6C34\u5E33\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoading.set(!1)}}resetFilters(){this.startDate.set(this.formatDate(this.firstDayOfMonth)),this.endDate.set(this.formatDate(this.lastDayOfMonth)),this.selectedItem.set(""),this.selectedCategory.set(""),this.selectedVendor.set(""),this.descriptionFilter.set(""),this.appliedItem.set(""),this.appliedCategory.set(""),this.appliedVendor.set(""),this.appliedDescriptionFilter.set(""),this.currentPage.set(1),this.applyFilters()}changeView(e){this.activeView.set(e),e==="add"&&this.resetForm()}async goToPage(e){let t=this.totalPages(),i=Math.min(Math.max(e,1),t);i!==this.currentPage()&&(this.currentPage.set(i),await this.loadPageData(i))}async goToPrevPage(){await this.goToPage(this.currentPage()-1)}async goToNextPage(){await this.goToPage(this.currentPage()+1)}sortData(e){this.sortColumn()===e?this.sortDirection.update(t=>t==="asc"?"desc":"asc"):(this.sortColumn.set(e),this.sortDirection.set("asc")),this.currentPage.set(1)}openEditModal(e){this.editingTransaction.set(e),this.ledgerForm.patchValue({entry_id:e.entry_id?e.entry_id.toString():"",entry_date:this.normalizeDateInput(e.entry_date),item_group:e.item_group,subject_name:e.subject_name,amount:e.amount?e.amount.toString():"",invoice_no:e.invoice_no,vendor_tax_id:this.sanitizeVendorTaxId(e.vendor_tax_id),vendor_name:e.vendor_name,description:e.description,is_sigh_off:e.is_sigh_off}),this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1),this.editingTransaction.set(null),this.resetForm()}toggleAllApprovals(e){let t=e.target,i=t.checked,r=i?"\u60A8\u78BA\u5B9A\u8981\u7C3D\u6838\u6240\u6709\u53EF\u898B\u9805\u76EE\u55CE\uFF1F":"\u60A8\u78BA\u5B9A\u8981\u53D6\u6D88\u7C3D\u6838\u6240\u6709\u53EF\u898B\u9805\u76EE\u55CE\uFF1F";this.confirmationState.set({message:r,isChecked:i,target:t})}async confirmApproval(){let e=this.confirmationState();if(!e)return;let{isChecked:t}=e,i=this.displayedTransactions().filter(o=>o.is_sigh_off!==t),r=i.map(o=>this.apiService.updateLedgerEntry({entry_id:o.entry_id,is_sigh_off:t}));try{await Promise.all(r);let o=this.allTransactions().map(s=>i.some(c=>c.entry_id===s.entry_id)?q(k({},s),{is_sigh_off:t}):s);this.allTransactions.set(o)}catch(o){console.error("\u66F4\u65B0\u7C3D\u6838\u72C0\u614B\u5931\u6557:",o),this.errorMessage.set("\u66F4\u65B0\u7C3D\u6838\u72C0\u614B\u5931\u6557")}this.confirmationState.set(null)}cancelApproval(){let e=this.confirmationState();e&&(e.target.checked=!e.isChecked,this.confirmationState.set(null))}async handleFormSubmit(){if(this.submitted.set(!0),!this.ledgerForm.invalid){this.isLoading.set(!0),this.errorMessage.set(null);try{let e=this.ledgerForm.value,t={entry_date:e.entry_date,item_group:e.item_group,subject_name:e.subject_name,amount:Number(e.amount),invoice_no:e.invoice_no,vendor_tax_id:e.vendor_tax_id,vendor_name:e.vendor_name,description:e.description,is_sigh_off:e.is_sigh_off||!1};if(this.editingTransaction()){let i=this.editingTransaction();if((await this.apiService.updateLedgerEntry(k({entry_id:i.entry_id},t))).success){let o=this.allTransactions().map(s=>s.entry_id===i.entry_id?k(k({},s),t):s);this.allTransactions.set(o),this.closeModal()}}else(await this.apiService.createLedgerEntry(t)).success&&(this.resetForm(),this.changeView("details"),await this.applyFilters())}catch(e){console.error("\u4FDD\u5B58\u5931\u6557:",e),this.errorMessage.set("\u4FDD\u5B58\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoading.set(!1)}this.applyFilters()}}resetForm(){this.ledgerForm.reset({is_sigh_off:!1}),this.submitted.set(!1)}formatCurrency(e){if(e==null)return"";let t=Math.abs(e);return isNaN(t)?"":t.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}sanitizeVendorTaxId(e){return e?e.replace(/\D/g,"").slice(0,8):""}onVendorTaxIdInput(e){let t=e.target,i=this.sanitizeVendorTaxId(t.value);this.ledgerForm.get("vendor_tax_id")?.setValue(i)}formatDate(e){return e.toISOString().split("T")[0]}normalizeDateInput(e){if(!e)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;let t=new Date(e);return Number.isNaN(t.getTime())?"":this.formatDate(t)}isInvalid(e){let t=this.ledgerForm.get(e);return!!t&&t.invalid&&(t.touched||this.submitted())}};Ps.\u0275fac=function(t){return new(t||Ps)},Ps.\u0275cmp=ee({type:Ps,selectors:[["app-ledger"]],decls:17,vars:10,consts:[[1,"space-y-6"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-4","flex","items-center","gap-3"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4","flex","items-center","gap-3"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"border-b","border-gray-200"],["aria-label","Tabs",1,"-mb-px","flex","space-x-6"],[1,"whitespace-nowrap","py-4","px-1","border-b-2","font-medium","text-sm",3,"click"],[1,"pt-6"],[1,"space-y-4"],["novalidate","",1,"space-y-6","max-w-4xl","mx-auto",3,"formGroup"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],["name","hourglass-outline",1,"text-blue-600","text-xl","animate-spin"],[1,"text-blue-700"],["name","alert-circle-outline",1,"text-red-600","text-xl"],[1,"text-red-700"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4","p-4","bg-gray-50","rounded-lg"],[1,"flex","items-center","gap-2"],["for","startDate",1,"text-sm","font-medium","text-gray-600","shrink-0"],[1,"relative","w-full"],["type","date","id","startDate",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white","pr-10",3,"ngModelChange","ngModel"],[1,"absolute","inset-y-0","right-0","flex","items-center","pr-3","pointer-events-none"],["name","calendar-outline",1,"text-gray-400"],["for","endDate",1,"text-sm","font-medium","text-gray-600","shrink-0"],["type","date","id","endDate",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white","pr-10",3,"ngModelChange","ngModel"],[1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white","disabled:bg-gray-100","disabled:cursor-not-allowed",3,"ngModelChange","ngModel","disabled"],[1,"lg:col-span-2"],["type","text","placeholder","\u641C\u5C0B\u8AAA\u660E\u95DC\u9375\u5B57...",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"flex","items-center","gap-2","lg:col-span-4","justify-end"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-4","py-3"],[1,"flex","items-center","justify-center","gap-2"],["type","checkbox","title","\u5168\u90E8\u7C3D\u6838/\u53D6\u6D88\u7C3D\u6838",1,"rounded","h-4","w-4","text-indigo-600","border-gray-300","focus:ring-indigo-500","cursor-pointer",3,"change","checked"],[1,"px-4","py-3","cursor-pointer",3,"click"],["name","swap-vertical-outline"],[1,"px-4","py-3","cursor-pointer","text-right",3,"click"],[1,"border-b","hover:bg-gray-50","cursor-pointer",3,"bg-red-50"],[1,"flex","flex-col","sm:flex-row","items-center","justify-between","gap-3","pt-4"],[1,"text-sm","text-gray-600"],["type","button",1,"px-3","py-1.5","text-sm","border","rounded-md","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["name","hourglass-outline",1,"animate-spin"],["name","filter-outline"],[1,"border-b","hover:bg-gray-50","cursor-pointer",3,"click"],[1,"px-4","py-2","text-center"],["type","checkbox","disabled","",1,"rounded","h-4","w-4","text-indigo-500","border-gray-300","cursor-not-allowed",3,"checked"],[1,"px-4","py-2"],[1,"px-4","py-2","text-right"],[1,"px-4","py-2","truncate","max-w-xs"],["colspan","9",1,"text-center","py-8","text-gray-500"],["novalidate","",1,"space-y-6","max-w-4xl","mx-auto",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],["for","date",1,"block","text-sm","font-medium","text-gray-700"],[1,"relative","mt-1"],["type","date","id","date","formControlName","entry_date",1,"block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2","pr-10"],["for","item",1,"block","text-sm","font-medium","text-gray-700"],["id","item","formControlName","item_group",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["value","","disabled",""],["for","category",1,"block","text-sm","font-medium","text-gray-700"],["id","category","formControlName","subject_name",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","amount",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","amount","formControlName","amount","placeholder","\u6B63\u6578\u70BA\u6536\u5165\uFF0C\u8CA0\u6578\u70BA\u8A72\u9805\u76EE\u5C0D\u6C96",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2","text-right"],["for","invoiceNumber",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","invoiceNumber","formControlName","invoice_no",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","vendorTaxId",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","vendorTaxId","formControlName","vendor_tax_id","inputmode","numeric","pattern","\\d*","maxlength","8",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2",3,"input"],[1,"md:col-span-2"],["for","vendorName",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","vendorName","formControlName","vendor_name",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","description",1,"block","text-sm","font-medium","text-gray-700"],["id","description","formControlName","description","rows","3",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],[1,"flex","justify-end","gap-4"],["type","button",1,"px-4","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],["type","submit",1,"px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-indigo-600","hover:bg-indigo-700"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-2xl","max-h-[90vh]","flex","flex-col"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],["novalidate","",1,"space-y-6",3,"ngSubmit","formGroup"],["for","modal-date",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","modal-date","formControlName","entry_date",1,"block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2","pr-10"],["for","modal-item",1,"block","text-sm","font-medium","text-gray-700"],["id","modal-item","formControlName","item_group",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","modal-category",1,"block","text-sm","font-medium","text-gray-700"],["id","modal-category","formControlName","subject_name",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","modal-amount",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","modal-amount","formControlName","amount",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2","text-right"],["for","modal-invoiceNumber",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","modal-invoiceNumber","formControlName","invoice_no",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","modal-vendorTaxId",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","modal-vendorTaxId","formControlName","vendor_tax_id","inputmode","numeric","pattern","\\d*","maxlength","8",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2",3,"input"],["for","modal-vendorName",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","modal-vendorName","formControlName","vendor_name",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","modal-description",1,"block","text-sm","font-medium","text-gray-700"],["id","modal-description","formControlName","description","rows","3",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],[1,"flex","items-center","space-x-2"],["type","checkbox","formControlName","is_sigh_off",1,"rounded","h-4","w-4","text-indigo-600","focus:ring-indigo-500","border-gray-300"],[1,"text-sm","text-gray-700"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-6"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","m-4"],[1,"p-6","text-center"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-blue-100"],["name","help-outline",1,"h-6","w-6","text-blue-600"],[1,"mt-4","text-lg","font-semibold","text-gray-900"],[1,"mt-2","text-sm","text-gray-500"],[1,"flex","justify-center","gap-4","bg-gray-50","px-6","py-4","rounded-b-xl"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","button",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","hover:bg-indigo-700",3,"click"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"h1",1),m(2,"\u6D41\u6C34\u5E33"),u(),P(3,hV,4,0,"div",2),P(4,yV,4,1,"div",3),l(5,"div",4)(6,"div",5)(7,"nav",6)(8,"button",7),S("click",function(){return i.changeView("details")}),m(9," \u6D41\u6C34\u5E33\u7D30\u9805 "),u(),l(10,"button",7),S("click",function(){return i.changeView("add")}),m(11," \u65B0\u589E\u5E33\u52D9 "),u()()(),l(12,"div",8),P(13,DV,86,16,"div",9),P(14,IV,50,9,"form",10),u()()(),P(15,NV,59,9,"div",11),P(16,RV,14,1,"div",11)),t&2){let r;h(3),F(i.isLoading()?3:-1),h(),F(i.errorMessage()?4:-1),h(4),De(i.activeView()==="details"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),h(2),De(i.activeView()==="add"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),h(3),F(i.activeView()==="details"?13:-1),h(),F(i.activeView()==="add"?14:-1),h(),F(i.isModalOpen()?15:-1),h(),F((r=i.confirmationState())?16:-1,r)}},dependencies:[oe,Ee,je,Fe,ke,xe,$t,Pl,Ae,ge,Be,Ol,Vl,we,$e,Ue,qe],encapsulation:2,changeDetection:0});var Kf=Ps;var mo=class mo{constructor(){this.holidays2024=[{date:"2024-01-01",name:"\u5143\u65E6"},{date:"2024-02-08",name:"\u8FB2\u66C6\u6625\u7BC0"},{date:"2024-02-09",name:"\u8FB2\u66C6\u6625\u7BC0"},{date:"2024-02-10",name:"\u8FB2\u66C6\u6625\u7BC0"},{date:"2024-02-11",name:"\u8FB2\u66C6\u6625\u7BC0"},{date:"2024-02-12",name:"\u8FB2\u66C6\u6625\u7BC0"},{date:"2024-02-13",name:"\u8FB2\u66C6\u6625\u7BC0"},{date:"2024-02-14",name:"\u8FB2\u66C6\u6625\u7BC0"},{date:"2024-02-28",name:"\u548C\u5E73\u7D00\u5FF5\u65E5"},{date:"2024-04-04",name:"\u5152\u7AE5\u7BC0"},{date:"2024-04-05",name:"\u6E05\u660E\u7BC0"},{date:"2024-06-10",name:"\u7AEF\u5348\u7BC0"},{date:"2024-09-17",name:"\u4E2D\u79CB\u7BC0"},{date:"2024-10-10",name:"\u570B\u6176\u65E5"}]}getHolidays(e){return e===2024?this.holidays2024:[]}};mo.\u0275fac=function(t){return new(t||mo)},mo.\u0275prov=Y({token:mo,factory:mo.\u0275fac,providedIn:"root"});var Qf=mo;var PV=()=>({month:"long"}),FV=()=>["\u65E5","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D"],kV=(n,e)=>e.date,OV=(n,e)=>e.id;function VV(n,e){if(n&1&&(Xe(0,"div",7),m(1),et()),n&2){let t=e.$implicit;h(),E(t)}}function LV(n,e){if(n&1&&(Xe(0,"div",12),m(1),et()),n&2){let t=C().$implicit;h(),L(" ",t.holiday.name," ")}}function BV(n,e){if(n&1){let t=U();Xe(0,"div",14),Jo("click",function(){let r=w(t).$implicit,o=C(2);return T(o.editEvent(r))}),m(1),et()}if(n&2){let t=e.$implicit;Q("opacity-60",t.status==="cancelled")("line-through",t.status==="cancelled"),h(),L(" ",t.name," ")}}function UV(n,e){if(n&1&&(Xe(0,"div",9)(1,"time",10),m(2),et(),Xe(3,"div",11),P(4,LV,2,1,"div",12),O(5,BV,2,5,"div",13,OV),et()()),n&2){let t=e.$implicit;Q("bg-gray-50",!t.isCurrentMonth),h(),Q("text-gray-400",!t.isCurrentMonth)("bg-indigo-600",t.isToday)("text-white",t.isToday)("rounded-full",t.isToday)("w-6",t.isToday)("h-6",t.isToday)("flex",t.isToday)("items-center",t.isToday)("justify-center",t.isToday),$c("dateTime",t.date.toISOString()),h(),L(" ",t.date.getDate()," "),h(2),F(t.holiday?4:-1),h(),V(t.events)}}var Fs=class Fs{constructor(){this.holidayService=R(Qf);this.router=R(Ne);this.events=zc.required();this.currentDate=D(new Date("2024-10-01"));this.holidays=D([]);this.calendarGrid=H(()=>{let e=this.events(),t=this.holidays(),i=this.currentDate(),r=i.getFullYear(),o=i.getMonth(),s=new Date(r,o,1),a=new Date(r,o+1,0),c=s.getDay(),d=new Date(s);d.setDate(s.getDate()-c);let g=[],y=new Date;y.setHours(0,0,0,0);for(let v=0;v<42;v++){let _=new Date(d);_.setDate(d.getDate()+v);let b=this.formatDate(_);g.push({date:_,isCurrentMonth:_.getMonth()===o,isToday:_.getTime()===y.getTime(),events:e.filter(I=>I.date===b),holiday:t.find(I=>I.date===b)})}return g});this.loadHolidays()}formatDate(e){let t=e.getFullYear(),i=(e.getMonth()+1).toString().padStart(2,"0"),r=e.getDate().toString().padStart(2,"0");return`${t}-${i}-${r}`}loadHolidays(){let e=this.currentDate().getFullYear();this.holidays.set(this.holidayService.getHolidays(e))}previousMonth(){this.currentDate.update(e=>{let t=new Date(e);return t.setMonth(e.getMonth()-1),t}),this.loadHolidays()}nextMonth(){this.currentDate.update(e=>{let t=new Date(e);return t.setMonth(e.getMonth()+1),t}),this.loadHolidays()}editEvent(e){this.router.navigate(["/events/edit",e.id])}};Fs.\u0275fac=function(t){return new(t||Fs)},Fs.\u0275cmp=ee({type:Fs,selectors:[["app-calendar-view"]],inputs:{events:[1,"events"]},decls:13,vars:4,consts:[[1,"space-y-4"],[1,"flex","items-center","justify-between"],[1,"p-2","rounded-full","hover:bg-gray-100","transition-colors",3,"click"],["name","chevron-back-outline",1,"text-xl","text-gray-600"],[1,"text-xl","font-semibold","text-gray-800"],["name","chevron-forward-outline",1,"text-xl","text-gray-600"],[1,"grid","grid-cols-7","gap-px","bg-gray-200","border","border-gray-200","rounded-lg","overflow-hidden"],[1,"py-2","text-center","text-sm","font-medium","text-gray-600","bg-gray-50"],[1,"relative","min-h-[120px]","bg-white","p-2",3,"bg-gray-50"],[1,"relative","min-h-[120px]","bg-white","p-2"],[1,"text-sm","font-medium",3,"dateTime"],[1,"mt-2","space-y-1","overflow-hidden"],[1,"text-xs","text-red-700","bg-red-100","rounded","px-1","py-0.5","truncate","font-medium"],[1,"text-xs","text-indigo-800","bg-indigo-100","rounded","px-1","py-0.5","cursor-pointer","hover:bg-indigo-200","truncate",3,"opacity-60","line-through"],[1,"text-xs","text-indigo-800","bg-indigo-100","rounded","px-1","py-0.5","cursor-pointer","hover:bg-indigo-200","truncate",3,"click"]],template:function(t,i){t&1&&(Xe(0,"div",0)(1,"div",1)(2,"button",2),Jo("click",function(){return i.previousMonth()}),Ui(3,"ion-icon",3),et(),Xe(4,"h2",4),m(5),et(),Xe(6,"button",2),Jo("click",function(){return i.nextMonth()}),Ui(7,"ion-icon",5),et()(),Xe(8,"div",6),O(9,VV,2,1,"div",7,W),O(11,UV,7,23,"div",8,kV),et()()),t&2&&(h(5),yt(" ",i.currentDate().getFullYear(),"\u5E74 ",i.currentDate().toLocaleString("zh-TW",fn(2,PV))," "),h(4),V(fn(3,FV)),h(2),V(i.calendarGrid()))},dependencies:[oe],encapsulation:2,changeDetection:0});var Zf=Fs;var $V=(n,e)=>e.value,HV=(n,e)=>e.id;function GV(n,e){if(n&1&&(l(0,"option",15),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),L("",t,"\u5E74")}}function qV(n,e){if(n&1&&(l(0,"option",15),m(1),u()),n&2){let t=e.$implicit;N("value",t.value),h(),E(t.label)}}function WV(n,e){if(n&1){let t=U();l(0,"tr",35),S("click",function(){let r=w(t).$implicit,o=C(2);return T(o.editEvent(r))}),l(1,"td",36),m(2),u(),l(3,"td",36),m(4),u(),l(5,"td",36),m(6),u(),l(7,"td",36),m(8),u(),l(9,"td",37),m(10),u(),l(11,"td",36),m(12),u(),l(13,"td",36),m(14),u(),l(15,"td",38),m(16),u(),l(17,"td",38),m(18),u(),l(19,"td",39),m(20),u(),l(21,"td",40),m(22),u()()}if(n&2){let t=e.$implicit,i=e.$index,r=C(2);Q("text-gray-400",t.status==="cancelled")("line-through",t.status==="cancelled"),h(2),E((r.currentPage()-1)*r.pageSize+i+1),h(2),E(t.type),h(2),E(r.formatDateForDisplay(t.date)),h(2),E(t.time),h(2),E(t.name),h(2),E(t.organizer),h(2),E(t.attendees),h(2),E(r.formatCurrency(t.estimatedRevenue)),h(2),E(r.formatCurrency(t.deposit)),h(2),E(r.formatCurrency(t.actualRevenue)),h(2),E(t.notes)}}function jV(n,e){n&1&&(l(0,"tr")(1,"td",41),m(2,"\u627E\u4E0D\u5230\u7B26\u5408\u689D\u4EF6\u7684\u6D3B\u52D5\u3002"),u()())}function zV(n,e){if(n&1){let t=U();l(0,"div",34)(1,"span",42),m(2),u(),l(3,"div",12)(4,"button",43),S("click",function(){w(t);let r=C(2);return T(r.prevPage())}),x(5,"ion-icon",44),u(),l(6,"span",45),m(7),u(),l(8,"button",43),S("click",function(){w(t);let r=C(2);return T(r.nextPage())}),x(9,"ion-icon",46),u()()()}if(n&2){let t=C(2);h(2),Pt(" \u986F\u793A\u7B2C ",(t.currentPage()-1)*t.pageSize+1," \u81F3 ",t.Math.min(t.currentPage()*t.pageSize,t.filteredEvents().length)," \u7B46\uFF0C\u5171 ",t.filteredEvents().length," \u7B46 "),h(2),N("disabled",t.currentPage()===1),h(3),yt("\u7B2C ",t.currentPage()," \u9801 / \u5171 ",t.totalPages()," \u9801"),h(),N("disabled",t.currentPage()===t.totalPages())}}function YV(n,e){if(n&1){let t=U();l(0,"div",26)(1,"table",27)(2,"thead",28)(3,"tr")(4,"th",29),m(5,"\u7DE8\u865F"),u(),l(6,"th",30),S("click",function(){w(t);let r=C();return T(r.sortData("type"))}),m(7,"\u985E\u578B "),x(8,"ion-icon",31),u(),l(9,"th",30),S("click",function(){w(t);let r=C();return T(r.sortData("date"))}),m(10,"\u65E5\u671F "),x(11,"ion-icon",31),u(),l(12,"th",30),S("click",function(){w(t);let r=C();return T(r.sortData("time"))}),m(13,"\u6642\u9593 "),x(14,"ion-icon",31),u(),l(15,"th",30),S("click",function(){w(t);let r=C();return T(r.sortData("name"))}),m(16,"\u540D\u7A31 "),x(17,"ion-icon",31),u(),l(18,"th",30),S("click",function(){w(t);let r=C();return T(r.sortData("organizer"))}),m(19,"\u4ECB\u7D39\u4EBA "),x(20,"ion-icon",31),u(),l(21,"th",30),S("click",function(){w(t);let r=C();return T(r.sortData("attendees"))}),m(22,"\u4EBA\u6578 "),x(23,"ion-icon",31),u(),l(24,"th",32),S("click",function(){w(t);let r=C();return T(r.sortData("estimatedRevenue"))}),m(25,"\u9810\u8A08\u6536\u5165 "),x(26,"ion-icon",31),u(),l(27,"th",32),S("click",function(){w(t);let r=C();return T(r.sortData("deposit"))}),m(28,"\u8A02\u91D1 "),x(29,"ion-icon",31),u(),l(30,"th",32),S("click",function(){w(t);let r=C();return T(r.sortData("actualRevenue"))}),m(31,"\u5BE6\u969B\u6536\u5165 "),x(32,"ion-icon",31),u(),l(33,"th",30),S("click",function(){w(t);let r=C();return T(r.sortData("notes"))}),m(34,"\u5099\u8A3B "),x(35,"ion-icon",31),u()()(),l(36,"tbody"),O(37,WV,23,15,"tr",33,HV,!1,jV,3,0,"tr"),u()()(),P(40,zV,10,7,"div",34)}if(n&2){let t=C();h(37),V(t.paginatedEvents()),h(3),F(t.totalPages()>1?40:-1)}}function JV(n,e){if(n&1&&x(0,"app-calendar-view",25),n&2){let t=C();N("events",t.filteredEvents())}}var ks=class ks{constructor(){this.dataService=R(mt);this.router=R(Ne);this.allEvents=D([]);this.searchTerm=D("");this.activeView=D("list");this.availableYears=D([]);this.availableMonths=D([]);this.selectedYear=D(2024);this.selectedMonth=D(10);this.appliedFilters=D({year:2024,month:10});this.currentPage=D(1);this.pageSize=10;this.Math=Math;this.sortColumn=D("date");this.sortDirection=D("asc");this.filteredEvents=H(()=>{let e=this.searchTerm().toLowerCase(),{year:t,month:i}=this.appliedFilters(),r=this.allEvents();if(t){let c=t.toString();if(i!==0){let d=String(i).padStart(2,"0"),g=`${c}-${d}`;r=r.filter(y=>y.date.startsWith(g))}else r=r.filter(d=>d.date.startsWith(c))}e&&(r=r.filter(c=>c.name.toLowerCase().includes(e)||c.date.includes(e)));let o=this.sortColumn(),s=this.sortDirection(),a=[...r];return a.sort((c,d)=>{let g=c[o],y=d[o];return g==null&&y!=null?1:g!=null&&y==null?-1:g==null&&y==null?0:g<y?s==="asc"?-1:1:g>y?s==="asc"?1:-1:0}),a});this.paginatedEvents=H(()=>{let e=this.filteredEvents(),t=(this.currentPage()-1)*this.pageSize;return e.slice(t,t+this.pageSize)});this.totalPages=H(()=>Math.ceil(this.filteredEvents().length/this.pageSize));this.eventsSummary=H(()=>{let t=this.filteredEvents().filter(s=>s.status==="active"),i=t.reduce((s,a)=>s+a.estimatedRevenue,0),r=t.reduce((s,a)=>s+a.actualRevenue,0),o=r/2e5*100;return{estimatedRevenue:i,actualRevenue:r,targetRevenue:2e5,achievementRate:o}});this.loadEvents(),this.setupFilters()}loadEvents(){this.allEvents.set(this.dataService.getEvents())}setupFilters(){let e=[...new Set(this.allEvents().map(i=>new Date(i.date).getFullYear()))].sort((i,r)=>r-i);this.availableYears.set(e),this.availableMonths.set([{value:0,label:"\u5168\u5E74"},...Array.from({length:12},(i,r)=>({value:r+1,label:`${r+1}\u6708`}))]);let t=e.includes(2024)?2024:e[0]||new Date().getFullYear();this.selectedYear.set(t),this.selectedMonth.set(10),this.appliedFilters.set({year:t,month:10})}applyFilter(){this.appliedFilters.set({year:this.selectedYear(),month:this.selectedMonth()}),this.currentPage.set(1)}resetFilter(){let e=this.availableYears().includes(2024)?2024:this.availableYears()[0]||new Date().getFullYear();this.selectedYear.set(e),this.selectedMonth.set(10),this.applyFilter()}onSearchChange(e){this.searchTerm.set(e),this.currentPage.set(1)}sortData(e){this.sortColumn()===e?this.sortDirection.update(t=>t==="asc"?"desc":"asc"):(this.sortColumn.set(e),this.sortDirection.set("asc"))}goToPage(e){e>=1&&e<=this.totalPages()&&this.currentPage.set(e)}nextPage(){this.goToPage(this.currentPage()+1)}prevPage(){this.goToPage(this.currentPage()-1)}editEvent(e){this.router.navigate(["/events/edit",e.id])}formatDateForDisplay(e){let t=new Date(e),i=t.getMonth()+1,r=t.getDate(),o=["\u65E5","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D"][t.getDay()];return`${i}/${r} (${o})`}formatCurrency(e){return e==null?"":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}setView(e){this.activeView.set(e)}};ks.\u0275fac=function(t){return new(t||ks)},ks.\u0275cmp=ee({type:ks,selectors:[["app-events"]],decls:55,vars:32,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],["routerLink","/events/new",1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm"],["name","add-outline"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-4","gap-6"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"text-sm","text-gray-500"],[1,"text-2xl","font-semibold","text-gray-900"],[1,"text-2xl","font-semibold"],[1,"flex","flex-wrap","justify-between","items-center","gap-4","mb-4","border-b","pb-4"],[1,"flex","flex-wrap","items-center","gap-4"],[1,"flex","items-center","gap-2"],[1,"text-sm","font-medium","text-gray-600","shrink-0"],[1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-50","pr-8",3,"ngModelChange","ngModel"],[3,"value"],[1,"bg-indigo-600","text-white","px-3","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-1","text-sm",3,"click"],["name","filter-outline"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],["type","text","placeholder","\u4F9D\u6D3B\u52D5\u540D\u7A31\u6216\u65E5\u671F\u641C\u5C0B...",1,"w-full","sm:w-auto","flex-grow","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"flex","items-center","border","border-gray-200","rounded-lg","p-1","space-x-1","bg-gray-50","shrink-0"],[1,"px-3","py-1","text-sm","font-medium","rounded-md","transition-colors","flex","items-center","gap-2",3,"click"],["name","list-outline"],["name","calendar-outline"],[3,"events"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-4","py-3"],[1,"px-4","py-3","cursor-pointer",3,"click"],["name","swap-vertical-outline"],[1,"px-4","py-3","cursor-pointer","text-right",3,"click"],[1,"border-b","hover:bg-gray-50","cursor-pointer",3,"text-gray-400","line-through"],[1,"flex","justify-between","items-center","pt-4","border-t","mt-4"],[1,"border-b","hover:bg-gray-50","cursor-pointer",3,"click"],[1,"px-4","py-2"],[1,"px-4","py-2","font-medium"],[1,"px-4","py-2","text-right"],[1,"px-4","py-2","text-right","font-semibold"],[1,"px-4","py-2","truncate","max-w-xs"],["colspan","11",1,"text-center","py-8","text-gray-500"],[1,"text-sm","text-gray-600"],[1,"px-3","py-1","border","rounded-md","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["name","chevron-back-outline"],[1,"text-sm"],["name","chevron-forward-outline"]],template:function(t,i){t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),m(3,"\u6D3B\u52D5\u7BA1\u7406"),u(),l(4,"a",3),x(5,"ion-icon",4),l(6,"span"),m(7,"\u65B0\u589E\u6D3B\u52D5"),u()()(),l(8,"div",5)(9,"div",6)(10,"p",7),m(11,"\u9810\u8A08\u7E3D\u6536\u5165"),u(),l(12,"p",8),m(13),u()(),l(14,"div",6)(15,"p",7),m(16,"\u5BE6\u969B\u7E3D\u6536\u5165"),u(),l(17,"p",8),m(18),u()(),l(19,"div",6)(20,"p",7),m(21,"\u76EE\u6A19\u6536\u5165"),u(),l(22,"p",8),m(23),u()(),l(24,"div",6)(25,"p",7),m(26,"\u76EE\u6A19\u9054\u6210\u7387"),u(),l(27,"p",9),m(28),u()()(),l(29,"div",6)(30,"div",10)(31,"div",11)(32,"div",12)(33,"label",13),m(34,"\u6642\u9593:"),u(),l(35,"select",14),ne("ngModelChange",function(o){return re(i.selectedYear,o)||(i.selectedYear=o),o}),O(36,GV,2,2,"option",15,W),u(),l(38,"select",14),ne("ngModelChange",function(o){return re(i.selectedMonth,o)||(i.selectedMonth=o),o}),O(39,qV,2,2,"option",15,$V),u(),l(41,"button",16),S("click",function(){return i.applyFilter()}),x(42,"ion-icon",17),u(),l(43,"button",18),S("click",function(){return i.resetFilter()}),x(44,"ion-icon",19),u()(),l(45,"input",20),S("ngModelChange",function(o){return i.onSearchChange(o)}),u()(),l(46,"div",21)(47,"button",22),S("click",function(){return i.setView("list")}),x(48,"ion-icon",23),m(49," \u5217\u8868 "),u(),l(50,"button",22),S("click",function(){return i.setView("calendar")}),x(51,"ion-icon",24),m(52," \u65E5\u66C6 "),u()()(),P(53,YV,41,2)(54,JV,1,1,"app-calendar-view",25),u()()),t&2&&(h(13),E(i.formatCurrency(i.eventsSummary().estimatedRevenue)),h(5),E(i.formatCurrency(i.eventsSummary().actualRevenue)),h(5),E(i.formatCurrency(i.eventsSummary().targetRevenue)),h(4),Q("text-green-600",i.eventsSummary().achievementRate>=100)("text-red-600",i.eventsSummary().achievementRate<100),h(),L(" ",i.eventsSummary().achievementRate.toFixed(1),"% "),h(7),te("ngModel",i.selectedYear),h(),V(i.availableYears()),h(2),te("ngModel",i.selectedMonth),h(),V(i.availableMonths()),h(6),N("ngModel",i.searchTerm()),h(2),Q("bg-white",i.activeView()==="list")("shadow-sm",i.activeView()==="list")("text-indigo-600",i.activeView()==="list")("text-gray-600",i.activeView()!=="list")("hover:bg-gray-200",i.activeView()!=="list"),h(3),Q("bg-white",i.activeView()==="calendar")("shadow-sm",i.activeView()==="calendar")("text-indigo-600",i.activeView()==="calendar")("text-gray-600",i.activeView()!=="calendar")("hover:bg-gray-200",i.activeView()!=="calendar"),h(3),F(i.activeView()==="list"?53:54))},dependencies:[oe,Ee,Fe,ke,xe,Ae,ge,we,gr,Zf],encapsulation:2,changeDetection:0});var Xf=ks;function KV(n,e){if(n&1){let t=U();l(0,"button",35),S("click",function(){w(t);let r=C();return T(r.onDelete())}),m(1," \u522A\u9664\u6D3B\u52D5 "),u()}}var Os=class Os{constructor(){this.fb=R(ze);this.dataService=R(mt);this.router=R(Ne);this.route=R(on);this.isEditMode=D(!1);this.eventId=D(null);this.submitted=D(!1);this.eventForm=this.fb.group({type:["",$.required],status:["active",$.required],date:["",$.required],time:[""],name:["",$.required],organizer:[""],attendees:["",$.required],estimatedRevenue:[0,[$.required,$.min(0)]],deposit:[null],actualRevenue:[0,[$.required,$.min(0)]],notes:[""]});this.route.paramMap.pipe(pe(e=>e.get("id")),Ze(e=>{this.isEditMode.set(!!e),this.eventId.set(e)}),It(e=>!!e),pe(e=>this.dataService.getEventById(e)),Ze(e=>{e?this.eventForm.patchValue(e):(alert("\u627E\u4E0D\u5230\u6D3B\u52D5\uFF01"),this.router.navigate(["/events"]))})).subscribe()}isInvalid(e){let t=this.eventForm.get(e);return!!t&&t.invalid&&(t.touched||this.submitted())}onSubmit(){if(this.submitted.set(!0),this.eventForm.invalid){alert("\u8ACB\u6AA2\u67E5\u8868\u55AE\u4E26\u586B\u5BEB\u6240\u6709\u5FC5\u586B\u6B04\u4F4D\u3002");return}let e=this.eventForm.getRawValue(),t=q(k({},e),{deposit:e.deposit??void 0});this.isEditMode()&&this.eventId()?(this.dataService.updateEvent(q(k({},t),{id:this.eventId()})),alert("\u6D3B\u52D5\u5DF2\u6210\u529F\u66F4\u65B0\uFF01")):(this.dataService.addEvent(t),alert("\u6D3B\u52D5\u5DF2\u6210\u529F\u65B0\u589E\uFF01")),this.router.navigate(["/events"])}onDelete(){this.isEditMode()&&this.eventId()&&confirm("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u6B64\u6D3B\u52D5\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002")&&(this.dataService.deleteEvent(this.eventId()),alert("\u6D3B\u52D5\u5DF2\u522A\u9664\u3002"),this.router.navigate(["/events"]))}onCancel(){this.router.navigate(["/events"])}};Os.\u0275fac=function(t){return new(t||Os)},Os.\u0275cmp=ee({type:Os,selectors:[["app-event-form"]],decls:61,vars:18,consts:[[1,"space-y-6","max-w-4xl","mx-auto"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-white","p-6","md:p-8","rounded-xl","shadow-md"],["novalidate","",1,"space-y-6",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-x-6","gap-y-4"],[1,"md:col-span-2"],["for","name",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","name","formControlName","name",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","date",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","date","formControlName","date",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","time",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","time","formControlName","time","placeholder","\u4F8B\u5982: 14:30~18:30",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","type",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","type","formControlName","type",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","attendees",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","attendees","formControlName","attendees","placeholder","\u4F8B\u5982: 10~15",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","organizer",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","organizer","formControlName","organizer",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","estimatedRevenue",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","estimatedRevenue","formControlName","estimatedRevenue",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","deposit",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","deposit","formControlName","deposit",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","actualRevenue",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","actualRevenue","formControlName","actualRevenue",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","status",1,"block","text-sm","font-medium","text-gray-700"],["id","status","formControlName","status",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["value","active"],["value","cancelled"],["for","notes",1,"block","text-sm","font-medium","text-gray-700"],["id","notes","formControlName","notes","rows","4",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],[1,"flex","items-center","justify-end","gap-4","pt-4","border-t","mt-6"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-red-600","bg-transparent","hover:bg-red-50","rounded-md"],[1,"flex-grow"],["type","button",1,"px-4","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],["type","submit",1,"px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-indigo-600","hover:bg-indigo-700"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-red-600","bg-transparent","hover:bg-red-50","rounded-md",3,"click"]],template:function(t,i){t&1&&(l(0,"div",0)(1,"h1",1),m(2),u(),l(3,"div",2)(4,"form",3),S("ngSubmit",function(){return i.onSubmit()}),l(5,"div",4)(6,"div",5)(7,"label",6),m(8,"\u6D3B\u52D5\u540D\u7A31*"),u(),x(9,"input",7),u(),l(10,"div")(11,"label",8),m(12,"\u65E5\u671F*"),u(),x(13,"input",9),u(),l(14,"div")(15,"label",10),m(16,"\u6642\u9593"),u(),x(17,"input",11),u(),l(18,"div")(19,"label",12),m(20,"\u985E\u578B*"),u(),x(21,"input",13),u(),l(22,"div")(23,"label",14),m(24,"\u4EBA\u6578*"),u(),x(25,"input",15),u(),l(26,"div",5)(27,"label",16),m(28,"\u4ECB\u7D39\u4EBA"),u(),x(29,"input",17),u(),l(30,"div")(31,"label",18),m(32,"\u9810\u8A08\u5831\u540D\u6536\u5165*"),u(),x(33,"input",19),u(),l(34,"div")(35,"label",20),m(36,"\u8A02\u91D1"),u(),x(37,"input",21),u(),l(38,"div")(39,"label",22),m(40,"\u5BE6\u969B\u7E3D\u6536\u5165*"),u(),x(41,"input",23),u(),l(42,"div")(43,"label",24),m(44,"\u72C0\u614B*"),u(),l(45,"select",25)(46,"option",26),m(47,"\u9032\u884C\u4E2D"),u(),l(48,"option",27),m(49,"\u5DF2\u53D6\u6D88"),u()()(),l(50,"div",5)(51,"label",28),m(52,"\u5099\u8A3B"),u(),x(53,"textarea",29),u()(),l(54,"div",30),P(55,KV,2,0,"button",31),x(56,"div",32),l(57,"button",33),S("click",function(){return i.onCancel()}),m(58," \u53D6\u6D88 "),u(),l(59,"button",34),m(60),u()()()()()),t&2&&(h(2),L(" ",i.isEditMode()?"\u7DE8\u8F2F\u6D3B\u52D5":"\u65B0\u589E\u6D3B\u52D5"," "),h(2),N("formGroup",i.eventForm),h(5),Q("border-red-500",i.isInvalid("name")),h(4),Q("border-red-500",i.isInvalid("date")),h(8),Q("border-red-500",i.isInvalid("type")),h(4),Q("border-red-500",i.isInvalid("attendees")),h(8),Q("border-red-500",i.isInvalid("estimatedRevenue")),h(8),Q("border-red-500",i.isInvalid("actualRevenue")),h(4),Q("border-red-500",i.isInvalid("status")),h(10),F(i.isEditMode()?55:-1),h(5),L(" ",i.isEditMode()?"\u5132\u5B58\u8B8A\u66F4":"\u5132\u5B58\u6D3B\u52D5"," "))},dependencies:[oe,$e,je,Fe,ke,xe,$t,Ae,ge,Be,Ue,qe],encapsulation:2,changeDetection:0});var Wl=Os;var QV=["dailyRevenueChart"],ZV=(n,e)=>e.transactionDate;function XV(n,e){if(n&1&&(l(0,"option",8),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),L("",t,"\u5E74")}}function eL(n,e){if(n&1&&(l(0,"option",8),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),L("",t,"\u6708")}}function tL(n,e){if(n&1&&(l(0,"div",14),x(1,"ion-icon",16),l(2,"span"),m(3),u()()),n&2){let t=C();h(3),E(t.errorMessage())}}function nL(n,e){n&1&&(l(0,"div",15),x(1,"div",17),u())}function iL(n,e){if(n&1&&m(0),n&2){let t=C().$implicit,i=C(2);L(" ",i.formatCurrency(t.debitAmount)," ")}}function rL(n,e){if(n&1&&m(0),n&2){let t=C().$implicit,i=C(2);L(" ",i.formatCurrency(t.creditAmount)," ")}}function oL(n,e){n&1&&m(0," \u516C\u4F11\u65E5 ")}function sL(n,e){n&1&&m(0," 0 ")}function aL(n,e){if(n&1&&P(0,oL,1,0)(1,sL,1,0),n&2){let t=C().$implicit,i=C(2);F(i.isClosedDay(t.transactionDate,!1)?0:1)}}function lL(n,e){if(n&1&&(l(0,"tr",33)(1,"td",34),m(2),u(),l(3,"td",35),P(4,iL,1,1)(5,rL,1,1)(6,aL,2,1),u()()),n&2){let t=e.$implicit,i=C(2);h(2),E(i.formatDate(t.transactionDate)),h(2),F(t.debitAmount>0?4:t.creditAmount>0?5:6)}}function uL(n,e){n&1&&(l(0,"tr")(1,"td",36),m(2,"\u627E\u4E0D\u5230\u8A72\u6708\u4EFD\u7684\u92B7\u8CA8\u6536\u5165\u8CC7\u6599\u3002"),u()())}function cL(n,e){if(n&1&&(l(0,"div",18)(1,"div",19)(2,"p",20),m(3,"\u6708\u71DF\u6536\u76EE\u6A19"),u(),l(4,"p",21),m(5),u()(),l(6,"div",19)(7,"p",20),m(8,"\u6BCF\u65E5\u5E73\u5747\u76EE\u6A19"),u(),l(9,"p",21),m(10),u()(),l(11,"div",19)(12,"p",20),m(13,"\u76EE\u6A19\u5DEE\u984D"),u(),l(14,"p",22),m(15),u()(),l(16,"div",19)(17,"p",20),m(18,"\u672C\u6708\u7D2F\u8A08\u71DF\u6536"),u(),l(19,"p",21),m(20),u()(),l(21,"div",19)(22,"p",20),m(23,"\u6708\u71DF\u6536\u76EE\u6A19\u9054\u6210\u7387"),u(),l(24,"p",22),m(25),u()()(),l(26,"div",23)(27,"h3",24),m(28,"\u6BCF\u65E5\u71DF\u6536\u8DA8\u52E2"),u(),l(29,"div",25),x(30,"canvas",null,0),u()(),l(32,"div",23)(33,"h3",24),m(34,"\u7576\u65E5\u71DF\u6536\u660E\u7D30"),u(),l(35,"div",26),x(36,"ion-icon",27),m(37," \u9019\u500B\u8868\u683C\u986F\u793A\u6240\u9078\u64C7\u7684\u6708\u4EFD\u4E2D\uFF0C\u5F9E\u6D41\u6C34\u5E33\u6578\u64DA\u8868\u62C9\u53D6\u7684\u6240\u6709\u7B97\u7B26\u540D\u7A31\u70BA\u300C\u92B7\u8CA8\u6536\u5165\u300D\u7684\u4EA4\u6613\u7D00\u9304\uFF0C\u4E26\u4F9D\u7167\u4EA4\u6613\u6642\u9593\u5347\u5E8F\u6392\u5217\u3002 "),u(),l(38,"div",28)(39,"table",29)(40,"thead",30)(41,"tr")(42,"th",31),m(43,"\u4EA4\u6613\u65E5\u671F"),u(),l(44,"th",32),m(45,"\u91D1\u984D"),u()()(),l(46,"tbody"),O(47,lL,7,2,"tr",33,ZV,!1,uL,3,0,"tr"),u()()()()),n&2){let t=C();h(5),E(t.formatCurrency(t.summary().monthlyRevenueTarget)),h(5),E(t.formatCurrency(t.summary().dailyAverageTarget)),h(4),Q("text-red-600",t.summary().targetDeficit<0)("text-green-600",t.summary().targetDeficit>=0),h(),L(" ",t.formatCurrency(t.summary().targetDeficit)," "),h(5),E(t.formatCurrency(t.summary().cumulativeMonthlyRevenue)),h(4),Q("text-green-600",t.summary().monthlyTargetAchievementRate>=100)("text-red-600",t.summary().monthlyTargetAchievementRate<100),h(),L(" ",t.summary().monthlyTargetAchievementRate.toFixed(2),"% "),h(22),V(t.ledgerDetails())}}var Vs=class Vs{constructor(){this.apiService=R(wt);this.router=R(Ne);this.monthlyTargetData=D(null);this.monthlyRevenueTarget=28e4;this.availableYears=D([2024,2025,2026]);this.availableMonths=D(Array.from({length:12},(e,t)=>t+1));this.selectedYear=D(new Date().getFullYear());this.selectedMonth=D(new Date().getMonth()+1);this.monthlyData=D(null);this.ledgerDetails=D([]);this.isLoading=D(!1);this.errorMessage=D(null);this.reportData=H(()=>{let e=this.monthlyData();if(!e)return[];let i=this.monthlyTargetData()?.monthlyRevenueTarget||this.monthlyRevenueTarget,r=e.dailyReports.filter(s=>s.totalRevenue>0).length,o=r>0?i/r:0;return e.dailyReports.map(s=>({day:s.day,date:s.date,isDayOff:s.totalRevenue===0&&s.recordCount===0,totalDailyRevenue:s.totalRevenue,dailyAchievementRate:o>0?s.totalRevenue/o*100:0,cancelledInvoiceCount:s.cancelledInvoiceCount,shortAmount:s.shortAmount,recordCount:s.recordCount}))});this.dailyRevenueFromLedger=H(()=>{let e=this.ledgerDetails(),t=new Map;return console.log("\u6B63\u5728\u8A08\u7B97\u6BCF\u65E5\u71DF\u6536\uFF0C\u6D41\u6C34\u5E33\u7B46\u6578:",e.length),e.forEach((i,r)=>{let o=i.transactionDate;if(!o)return;if(!/^\d{4}-\d{2}-\d{2}$/.test(o)){let c=new Date(o);if(isNaN(c.getTime())){console.warn("\u7121\u6CD5\u89E3\u6790\u65E5\u671F:",i.transactionDate);return}else{let d=c.getFullYear(),g=String(c.getMonth()+1).padStart(2,"0"),y=String(c.getDate()).padStart(2,"0");o=`${d}-${g}-${y}`}}let s=Number(i.debitAmount)>0?Number(i.debitAmount):Number(i.creditAmount);r<5&&console.log(`\u6D41\u6C34\u5E33[${r}]`,{originalDate:i.transactionDate,normalizedDate:o,debitAmount:i.debitAmount,creditAmount:i.creditAmount,calculatedAmount:s});let a=t.get(o)||0;t.set(o,a+s)}),console.log("\u6BCF\u65E5\u71DF\u6536Map:",{size:t.size,sample:Array.from(t.entries()).slice(0,10),total:Array.from(t.values()).reduce((i,r)=>i+r,0)}),t});this.chartData=H(()=>{let e=this.dailyRevenueFromLedger(),t=this.selectedYear(),i=this.selectedMonth(),o=this.monthlyTargetData()?.monthlyRevenueTarget||this.monthlyRevenueTarget,s=new Date(t,i,0).getDate(),a=Array.from(e.values()).filter(g=>g>0).length,c=a>0?o/a:0;console.log("\u69CB\u5EFA\u5716\u8868\u6578\u64DA:",{year:t,month:i,lastDay:s,revenueMapSize:e.size,revenueMapEntries:Array.from(e.entries()).slice(0,10),workingDays:a,dailyAverageTarget:c});let d=[];for(let g=1;g<=s;g++){let y=`${t}-${String(i).padStart(2,"0")}-${String(g).padStart(2,"0")}`,v=e.get(y)||0;d.push({day:g,date:y,isDayOff:v===0,totalDailyRevenue:v,dailyAchievementRate:c>0?v/c*100:0,cancelledInvoiceCount:0,shortAmount:0,recordCount:v>0?1:0})}return console.log("\u5716\u8868\u6578\u64DA\u69CB\u5EFA\u5B8C\u6210:",{totalDays:d.length,daysWithRevenue:d.filter(g=>g.totalDailyRevenue>0).length,sampleData:d.slice(0,5)}),d});this.summary=H(()=>{let e=this.chartData(),t=this.monthlyTargetData(),i=this.ledgerDetails(),r=t?.monthlyRevenueTarget||this.monthlyRevenueTarget,o=t?.dailyAvgTarget||0,s=i.reduce((d,g)=>{let y=Number(g.debitAmount)>0?Number(g.debitAmount):Number(g.creditAmount);return d+y},0),a=s-r,c=r>0?s/r*100:0;return{monthlyRevenueTarget:r,dailyAverageTarget:o,targetDeficit:a,cumulativeMonthlyRevenue:s,monthlyTargetAchievementRate:c,totalCancelledInvoices:e.reduce((d,g)=>d+g.cancelledInvoiceCount,0),totalShortAmount:e.reduce((d,g)=>d+g.shortAmount,0)}});this.loadData()}set dailyRevenueChartRef(e){this.destroyChart(),e&&this.chartData().length>0&&this.createChart(e)}async loadData(){this.isLoading.set(!0),this.errorMessage.set(null);try{let e=this.selectedYear(),t=this.selectedMonth(),i=String(e),r=String(t).padStart(2,"0"),o=`${i}-${r}-01`,s=new Date(e,t,0).getDate(),a=`${i}-${r}-${String(s).padStart(2,"0")}`,[c,d,g]=await Promise.all([this.apiService.getMonthlyRevenue(e,t),this.apiService.getMonthlyTargets({startMonth:`${i}-${r}`,endMonth:`${i}-${r}`}),this.apiService.getLedgerEntries({startDate:o,endDate:a,subjectName:"\u92B7\u8CA8\u6536\u5165",sortBy:"entry_date",sortOrder:"asc"})]);if(this.monthlyData.set(c),d.success&&d.data&&d.data.length>0){let y=d.data[0];this.monthlyTargetData.set({targetId:y.targetId,targetMonth:y.targetMonth,monthlyRevenueTarget:y.monthlyRevenueTarget,eventRevenueTarget:y.eventRevenueTarget,totalTarget:y.totalTarget,dailyAvgTarget:y.dailyAvgTarget,remark:y.remark}),console.log("\u2713 \u6708\u5EA6\u71DF\u6536\u76EE\u6A19\u5DF2\u8F09\u5165:",y)}else console.warn("\u26A0 \u8A72\u6708\u4EFD\u672A\u8A2D\u5B9A\u71DF\u6536\u76EE\u6A19\uFF0C\u5C07\u4F7F\u7528\u7CFB\u7D71\u9810\u8A2D\u503C"),this.monthlyTargetData.set(null);console.log("\u6B63\u5728\u8F09\u5165\u6D41\u6C34\u5E33\u8CC7\u6599:",{startDate:o,endDate:a}),g.success&&g.data?this.ledgerDetails.set(g.data.map(y=>({transactionDate:y.entry_date||"",description:y.description||"",subjectName:y.subject_name||"",debitAmount:y.amount&&y.amount>0?y.amount:0,creditAmount:y.amount&&y.amount<0?Math.abs(y.amount):0,glAccountName:y.account_name||""}))):this.ledgerDetails.set([])}catch(e){console.error("\u8F09\u5165\u7576\u65E5\u71DF\u6536\u8CC7\u6599\u6642\u767C\u751F\u932F\u8AA4:",e);let t=e instanceof Error?e.message:"\u7121\u6CD5\u8F09\u5165\u71DF\u6536\u8CC7\u6599\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66";this.errorMessage.set(t)}finally{this.isLoading.set(!1)}}applyFilter(){this.loadData()}resetFilter(){this.selectedYear.set(new Date().getFullYear()),this.selectedMonth.set(new Date().getMonth()+1),this.loadData()}navigateToDetail(e){this.router.navigate(["/daily-revenue",e])}formatCurrency(e){return e==null?"":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}getWeekdayChar(e){return["\u65E5","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D"][e%7]}formatDate(e){if(!e)return"";let t;if(/^\d{4}-\d{2}-\d{2}$/.test(e)){let[a,c,d]=e.split("-").map(Number);t=new Date(a,c-1,d)}else t=new Date(e);if(isNaN(t.getTime()))return e;let i=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0"),s=this.getWeekdayChar(t.getDay());return`${i}-${r}-${o}(${s})`}isClosedDay(e,t){if(t||!e)return!1;let i;if(/^\d{4}-\d{2}-\d{2}$/.test(e)){let[r,o,s]=e.split("-").map(Number);i=new Date(r,o-1,s)}else i=new Date(e);return isNaN(i.getTime())?!1:i.getDay()===1}createChart(e){let t=this.chartData(),i=this.summary(),r=t.map(d=>d.day),o=t.map(d=>d.totalDailyRevenue),s=o.some(d=>d>0);console.log("\u6B63\u5728\u5EFA\u7ACB\u5716\u8868:",{dataCount:t.length,hasRevenueData:s,revenueDataSample:o.slice(0,10),daysWithRevenue:o.filter(d=>d>0).length});let a=[{label:"\u6BCF\u65E5\u71DF\u6536",data:o,borderColor:"#4f46e5",backgroundColor:"rgba(79, 70, 229, 0.1)",fill:!0,tension:.4,pointRadius:4,pointBackgroundColor:"#4f46e5"},{label:"\u6BCF\u65E5\u5E73\u5747\u76EE\u6A19",data:t.map(()=>i.dailyAverageTarget),borderColor:"#f97316",borderDash:[5,5],fill:!1,pointRadius:0,pointHitRadius:0}],c=e.nativeElement.getContext("2d");this.dailyChart=new Chart(c,{type:"line",data:{labels:r,datasets:a},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{callback:d=>this.formatCurrency(d)}},x:{title:{display:!0,text:"\u65E5\u671F"}}},plugins:{tooltip:{callbacks:{label:d=>`${d.dataset.label}: ${this.formatCurrency(d.raw)}`}}}}})}destroyChart(){this.dailyChart&&(this.dailyChart.destroy(),this.dailyChart=null)}};Vs.\u0275fac=function(t){return new(t||Vs)},Vs.\u0275cmp=ee({type:Vs,selectors:[["app-daily-revenue"]],viewQuery:function(t,i){if(t&1&&Cn(QV,5),t&2){let r;en(r=tn())&&(i.dailyRevenueChartRef=r.first)}},decls:24,vars:9,consts:[["dailyRevenueChart",""],[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"flex","flex-col","sm:flex-row","items-center","gap-2","bg-white","p-3","rounded-xl","shadow-md","border","border-gray-200"],[1,"flex","items-center","gap-2"],[1,"text-sm","font-medium","text-gray-600"],[1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100","pr-8",3,"ngModelChange","ngModel"],[3,"value"],[1,"flex","items-center","gap-2","mt-2","sm:mt-0"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm","disabled:opacity-50",3,"click","disabled"],[3,"name"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200","disabled:opacity-50",3,"click","disabled"],["name","refresh-outline",1,"text-xl"],[1,"bg-red-50","border","border-red-200","text-red-700","px-4","py-3","rounded-lg","flex","items-center","gap-2"],[1,"flex","justify-center","items-center","py-12"],["name","alert-circle-outline",1,"text-xl"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-indigo-600"],[1,"grid","grid-cols-2","md:grid-cols-3","lg:grid-cols-5","gap-6"],[1,"bg-white","p-4","rounded-xl","shadow-md","text-center"],[1,"text-sm","text-gray-500"],[1,"text-xl","font-semibold","text-gray-900","mt-1"],[1,"text-xl","font-semibold","mt-1"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"text-lg","font-semibold","text-gray-800","mb-4"],[1,"h-80"],[1,"text-sm","text-gray-600","mb-4"],["name","information-circle-outline",1,"align-middle"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-4","py-3"],[1,"px-4","py-3","text-right"],[1,"border-b","hover:bg-gray-50"],[1,"px-4","py-2","font-medium"],[1,"px-4","py-2","text-right"],["colspan","2",1,"text-center","py-8","text-gray-500"]],template:function(t,i){t&1&&(l(0,"div",1)(1,"div",2)(2,"h1",3),m(3,"\u7576\u65E5\u71DF\u6536"),u(),l(4,"div",4)(5,"div",5)(6,"label",6),m(7,"\u6642\u9593:"),u(),l(8,"select",7),ne("ngModelChange",function(o){return re(i.selectedYear,o)||(i.selectedYear=o),o}),O(9,XV,2,2,"option",8,W),u(),l(11,"select",7),ne("ngModelChange",function(o){return re(i.selectedMonth,o)||(i.selectedMonth=o),o}),O(12,eL,2,2,"option",8,W),u()(),l(14,"div",9)(15,"button",10),S("click",function(){return i.applyFilter()}),x(16,"ion-icon",11),l(17,"span"),m(18),u()(),l(19,"button",12),S("click",function(){return i.resetFilter()}),x(20,"ion-icon",13),u()()()(),P(21,tL,4,1,"div",14),P(22,nL,2,0,"div",15),P(23,cL,50,14),u()),t&2&&(h(8),te("ngModel",i.selectedYear),h(),V(i.availableYears()),h(2),te("ngModel",i.selectedMonth),h(),V(i.availableMonths()),h(3),N("disabled",i.isLoading()),h(),N("name",i.isLoading()?"hourglass-outline":"filter-outline"),h(2),E(i.isLoading()?"\u8F09\u5165\u4E2D...":"\u5957\u7528"),h(),N("disabled",i.isLoading()),h(2),F(i.errorMessage()?21:-1),h(),F(i.isLoading()?22:-1),h(),F(!i.isLoading()&&!i.errorMessage()?23:-1))},dependencies:[oe,Ee,Fe,ke,Ae,ge,we],encapsulation:2,changeDetection:0});var em=Vs;var dL=(n,e)=>e.id;function fL(n,e){if(n&1&&(l(0,"tr",24)(1,"td",28),m(2),u(),l(3,"td",29),m(4),u(),l(5,"td",30),m(6),u()()),n&2){let t=e.$implicit,i=C();h(2),E(t.name),h(2),E(t.organizer),h(2),E(i.formatCurrency(t.actualRevenue))}}function mL(n,e){n&1&&(l(0,"tr")(1,"td",31),m(2,"\u672C\u65E5\u7121\u6D3B\u52D5\u3002"),u()())}var Ls=class Ls{constructor(){this.fb=R(ze);this.dataService=R(mt);this.router=R(Ne);this.route=R(on);this.date=D("");this.dailyEntry=D(null);this.eventsOnDay=D([]);this.submitted=D(!1);this.revenueForm=this.fb.group({nonEventRevenue:[0,[$.required,$.min(0)]]});this.totalEventRevenue=H(()=>this.eventsOnDay().reduce((e,t)=>e+t.actualRevenue,0));this.totalDailyRevenue=H(()=>(this.revenueForm.controls.nonEventRevenue.value??0)+this.totalEventRevenue());this.route.paramMap.pipe(pe(e=>e.get("date")),Ze(e=>{if(!e||!/^\d{4}-\d{2}-\d{2}$/.test(e)){alert("\u7121\u6548\u7684\u65E5\u671F\u683C\u5F0F"),this.router.navigate(["/daily-revenue"]);return}this.date.set(e);let t=this.dataService.getDailyRevenueEntryByDate(e);this.dailyEntry.set(t),this.revenueForm.patchValue({nonEventRevenue:t.nonEventRevenue});let i=this.dataService.getEvents();this.eventsOnDay.set(i.filter(r=>r.date===e&&r.status==="active"))})).subscribe()}onSubmit(){if(this.submitted.set(!0),this.revenueForm.invalid){alert("\u8ACB\u8F38\u5165\u6709\u6548\u7684\u975E\u6D3B\u52D5\u71DF\u6536\u91D1\u984D\u3002");return}let e=this.revenueForm.controls.nonEventRevenue.value??0;this.dataService.updateDailyRevenueEntry(this.date(),{nonEventRevenue:e}),alert("\u7576\u65E5\u71DF\u6536\u5DF2\u66F4\u65B0\uFF01"),this.router.navigate(["/daily-revenue"])}onCancel(){this.router.navigate(["/daily-revenue"])}formatCurrency(e){return e==null?"":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}};Ls.\u0275fac=function(t){return new(t||Ls)},Ls.\u0275cmp=ee({type:Ls,selectors:[["app-daily-revenue-detail"]],decls:53,vars:7,consts:[[1,"space-y-6","max-w-4xl","mx-auto"],[1,"flex","items-center","gap-4"],[1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","arrow-back-outline",1,"text-2xl"],[1,"text-3xl","font-bold","text-gray-900"],[1,"text-indigo-600"],["novalidate","",3,"ngSubmit","formGroup"],[1,"bg-white","p-6","md:p-8","rounded-xl","shadow-md","space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],[1,"bg-gray-50","p-4","rounded-lg"],["for","nonEventRevenue",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","nonEventRevenue","formControlName","nonEventRevenue",1,"mt-2","block","w-full","border","bg-white","rounded-md","shadow-sm","p-2","text-lg","text-right","font-semibold"],[1,"text-xs","text-gray-500","mt-1"],[1,"bg-blue-50","p-4","rounded-lg"],[1,"text-sm","font-medium","text-gray-700"],[1,"mt-2","text-lg","text-right","font-semibold","text-blue-800"],[1,"bg-green-50","p-4","rounded-lg"],[1,"mt-2","text-lg","text-right","font-semibold","text-green-800"],[1,"text-lg","font-semibold","text-gray-800","mb-2"],[1,"border","rounded-lg","overflow-hidden"],[1,"w-full","text-sm","text-left"],[1,"bg-gray-100","text-xs","uppercase"],[1,"px-4","py-2"],[1,"px-4","py-2","text-right"],[1,"border-t"],[1,"flex","items-center","justify-end","gap-4","pt-4","border-t","mt-6"],["type","button",1,"px-4","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],["type","submit",1,"px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-indigo-600","hover:bg-indigo-700"],[1,"px-4","py-2","font-medium"],[1,"px-4","py-2","text-gray-600"],[1,"px-4","py-2","text-right","font-semibold"],["colspan","3",1,"px-4","py-4","text-center","text-gray-500"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"button",2),S("click",function(){return i.onCancel()}),x(3,"ion-icon",3),u(),l(4,"h1",4),m(5," \u7DE8\u8F2F\u7576\u65E5\u71DF\u6536 - "),l(6,"span",5),m(7),u()()(),l(8,"form",6),S("ngSubmit",function(){return i.onSubmit()}),l(9,"div",7)(10,"div",8)(11,"div",9)(12,"label",10),m(13,"\u975E\u6D3B\u52D5\u71DF\u6536*"),u(),x(14,"input",11),l(15,"p",12),m(16,"\u624B\u52D5\u8F38\u5165\u7576\u5929\u975E\u6D3B\u52D5\u76F8\u95DC\u7684\u71DF\u6536\u3002"),u()(),l(17,"div",13)(18,"p",14),m(19,"\u6D3B\u52D5\u7E3D\u71DF\u6536"),u(),l(20,"p",15),m(21),u(),l(22,"p",12),m(23,"\u4F86\u81EA\u4E0B\u65B9\u6D3B\u52D5\u5217\u8868\u7684\u52A0\u7E3D\u3002"),u()(),l(24,"div",16)(25,"p",14),m(26,"\u7576\u65E5\u7E3D\u71DF\u6536"),u(),l(27,"p",17),m(28),u(),l(29,"p",12),m(30,"\u975E\u6D3B\u52D5\u71DF\u6536 + \u6D3B\u52D5\u7E3D\u71DF\u6536\u3002"),u()()(),l(31,"div")(32,"h3",18),m(33,"\u672C\u65E5\u6D3B\u52D5"),u(),l(34,"div",19)(35,"table",20)(36,"thead",21)(37,"tr")(38,"th",22),m(39,"\u6D3B\u52D5\u540D\u7A31"),u(),l(40,"th",22),m(41,"\u4ECB\u7D39\u4EBA"),u(),l(42,"th",23),m(43,"\u5BE6\u969B\u6536\u5165"),u()()(),l(44,"tbody"),O(45,fL,7,3,"tr",24,dL,!1,mL,3,0,"tr"),u()()()(),l(48,"div",25)(49,"button",26),S("click",function(){return i.onCancel()}),m(50," \u53D6\u6D88 "),u(),l(51,"button",27),m(52," \u5132\u5B58\u8B8A\u66F4 "),u()()()()()),t&2){let r;h(7),E(i.date()),h(),N("formGroup",i.revenueForm),h(6),Q("border-red-500",i.submitted()&&((r=i.revenueForm.get("nonEventRevenue"))==null?null:r.invalid)),h(7),E(i.formatCurrency(i.totalEventRevenue())),h(7),E(i.formatCurrency(i.totalDailyRevenue())),h(17),V(i.eventsOnDay())}},dependencies:[oe,$e,je,xe,$t,ge,Be,Ue,qe],encapsulation:2,changeDetection:0});var tm=Ls;var pL=(n,e)=>e.employeeId;function gL(n,e){if(n&1&&(l(0,"option",7),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),L("",t,"\u5E74")}}function hL(n,e){if(n&1&&(l(0,"option",7),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),L("",t,"\u6708")}}function yL(n,e){n&1&&(l(0,"span",30),m(1," \u662F "),u())}function vL(n,e){n&1&&(l(0,"span",31),m(1," \u5426 "),u())}function _L(n,e){if(n&1){let t=U();l(0,"tr",25),S("click",function(){let r=w(t).$implicit,o=C();return T(o.viewEmployeeDetails(r.employeeId))}),l(1,"td",26),m(2),u(),l(3,"td",27),m(4),u(),l(5,"td",28),m(6),u(),l(7,"td",29),P(8,yL,2,0,"span",30)(9,vL,2,0,"span",31),u()()}if(n&2){let t=e.$implicit,i=C();h(2),E(t.name),h(2),E(t.totalHours.toFixed(2)),h(2),E(i.formatCurrency(t.totalPay)),h(2),F(t.hasMissingPunch?8:9)}}function CL(n,e){n&1&&(l(0,"tr")(1,"td",32),m(2,"\u8A72\u6708\u4EFD\u6C92\u6709 PT \u54E1\u5DE5\u85AA\u8CC7\u8CC7\u6599\u3002"),u()())}var Bs=class Bs{constructor(){this.dataService=R(mt);this.router=R(Ne);this.availableYears=D([2024,2025,2026]);this.availableMonths=D(Array.from({length:12},(e,t)=>t+1));this.selectedYear=D(2024);this.selectedMonth=D(8);this.appliedFilters=D({year:2024,month:8});this.payrollSummary=H(()=>{let{year:e,month:t}=this.appliedFilters();return this.dataService.getPayrollSummary(e,t)});this.applyFilter()}applyFilter(){this.appliedFilters.set({year:this.selectedYear(),month:this.selectedMonth()})}resetFilter(){this.selectedYear.set(2024),this.selectedMonth.set(8),this.applyFilter()}viewEmployeeDetails(e){let{year:t,month:i}=this.appliedFilters();this.router.navigate(["/payroll",e,t,i])}formatCurrency(e){return e==null?"":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}};Bs.\u0275fac=function(t){return new(t||Bs)},Bs.\u0275cmp=ee({type:Bs,selectors:[["app-payroll"]],decls:51,vars:5,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"flex","flex-col","sm:flex-row","items-center","gap-2","bg-white","p-3","rounded-xl","shadow-md","border","border-gray-200"],[1,"flex","items-center","gap-2"],[1,"text-sm","font-medium","text-gray-600"],[1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100","pr-8",3,"ngModelChange","ngModel"],[3,"value"],[1,"flex","items-center","gap-2","mt-2","sm:mt-0"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","filter-outline"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"text-sm","text-gray-500"],[1,"text-2xl","font-semibold","text-gray-900"],[1,"text-lg","font-semibold","text-gray-800","mb-4"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-4","py-3"],[1,"px-4","py-3","text-right"],[1,"px-4","py-3","text-center"],[1,"border-b","hover:bg-gray-50","cursor-pointer"],[1,"border-b","hover:bg-gray-50","cursor-pointer",3,"click"],[1,"px-4","py-2","font-medium"],[1,"px-4","py-2","text-right"],[1,"px-4","py-2","text-right","font-semibold"],[1,"px-4","py-2","text-center"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-red-100","text-red-800"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-green-100","text-green-800"],["colspan","4",1,"text-center","py-8","text-gray-500"]],template:function(t,i){t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),m(3,"\u6253\u5361\u85AA\u8CC7"),u(),l(4,"div",3)(5,"div",4)(6,"label",5),m(7,"\u6642\u9593:"),u(),l(8,"select",6),ne("ngModelChange",function(o){return re(i.selectedYear,o)||(i.selectedYear=o),o}),O(9,gL,2,2,"option",7,W),u(),l(11,"select",6),ne("ngModelChange",function(o){return re(i.selectedMonth,o)||(i.selectedMonth=o),o}),O(12,hL,2,2,"option",7,W),u()(),l(14,"div",8)(15,"button",9),S("click",function(){return i.applyFilter()}),x(16,"ion-icon",10),l(17,"span"),m(18,"\u5957\u7528"),u()(),l(19,"button",11),S("click",function(){return i.resetFilter()}),x(20,"ion-icon",12),u()()()(),l(21,"div",13)(22,"div",14)(23,"p",15),m(24,"PT\u85AA\u8CC7"),u(),l(25,"p",16),m(26),u()(),l(27,"div",14)(28,"p",15),m(29,"\u6B63\u8077\u85AA\u8CC7"),u(),l(30,"p",16),m(31),u()()(),l(32,"div",14)(33,"h3",17),m(34,"PT \u54E1\u5DE5\u85AA\u8CC7\u660E\u7D30"),u(),l(35,"div",18)(36,"table",19)(37,"thead",20)(38,"tr")(39,"th",21),m(40,"\u54E1\u5DE5\u540D\u7A31"),u(),l(41,"th",22),m(42,"\u6642\u6578"),u(),l(43,"th",22),m(44,"\u85AA\u8CC7"),u(),l(45,"th",23),m(46,"\u662F\u5426\u6709\u7F3A\u5361"),u()()(),l(47,"tbody"),O(48,_L,10,4,"tr",24,pL,!1,CL,3,0,"tr"),u()()()()()),t&2&&(h(8),te("ngModel",i.selectedYear),h(),V(i.availableYears()),h(2),te("ngModel",i.selectedMonth),h(),V(i.availableMonths()),h(14),E(i.formatCurrency(i.payrollSummary().partTimePayroll)),h(5),E(i.formatCurrency(i.payrollSummary().fullTimePayroll)),h(17),V(i.payrollSummary().partTimeDetails))},dependencies:[oe,Ee,Fe,ke,Ae,ge,we],encapsulation:2,changeDetection:0});var nm=Bs;function xL(n,e){if(n&1){let t=U();l(0,"tr",16)(1,"td",23)(2,"button",24),S("click",function(){let r=w(t).$index,o=C();return T(o.clearRecord(r))}),x(3,"ion-icon",25),u()(),l(4,"td",26),m(5),u(),l(6,"td",27),x(7,"input",28),u(),l(8,"td",27),x(9,"input",29),u(),l(10,"td",30),m(11),nn(12,"number"),u(),l(13,"td",31),x(14,"input",32),u(),l(15,"td",33),m(16),nn(17,"currency"),u()()}if(n&2){let t,i=e.$implicit,r=e.$index,o=C();N("formGroupName",r),h(5),yt(" ",(t=i.get("date"))==null?null:t.value," (",o.getWeekday((t=i.get("date"))==null?null:t.value),") "),h(6),L(" ",xn(12,5,o.calculateWorkHours(i),"1.2-2")," "),h(5),L(" ",Gc(17,8,o.calculateSalary(i),"TWD","symbol","1.0-0")," ")}}var Us=class Us{constructor(){this.fb=R(ze);this.dataService=R(mt);this.router=R(Ne);this.route=R(on);this.employee=D(null);this.year=D(0);this.month=D(0);this.payrollForm=this.fb.group({records:this.fb.array([])});this.initialFormValue="";this.totalHours=H(()=>this.records.controls.reduce((e,t)=>e+this.calculateWorkHours(t),0));this.totalSalary=H(()=>this.records.controls.reduce((e,t)=>e+this.calculateSalary(t),0));this.route.paramMap.pipe(Ze(e=>{let t=e.get("employeeId"),i=Number(e.get("year")),r=Number(e.get("month"));if(!t||!i||!r){alert("\u7121\u6548\u7684\u7DB2\u5740\u53C3\u6578"),this.router.navigate(["/payroll"]);return}let o=this.dataService.getEmployeeById(t);if(!o){alert("\u627E\u4E0D\u5230\u54E1\u5DE5"),this.router.navigate(["/payroll"]);return}this.employee.set(o),this.year.set(i),this.month.set(r),this.buildForm(t,i,r)})).subscribe()}get records(){return this.payrollForm.get("records")}buildForm(e,t,i){let r=this.records;r.clear();let o=this.dataService.getPunchRecordsForMonth(e,t,i),s=new Date(t,i,0).getDate();for(let a=1;a<=s;a++){let c=`${t}-${String(i).padStart(2,"0")}-${String(a).padStart(2,"0")}`,d=o.find(y=>y.date===c),g=this.fb.group({date:[c],clockIn:[d?.clockIn||null],clockOut:[d?.clockOut||null],isDoublePay:[d?.isDoublePay||!1]});r.push(g)}this.initialFormValue=JSON.stringify(this.payrollForm.value)}getWeekday(e){return e?new Date(e+"T00:00:00").toLocaleDateString("zh-TW",{weekday:"short"}).replace("\u9031",""):""}calculateWorkHours(e){let{clockIn:t,clockOut:i}=e.value;if(!t||!i)return 0;let[r,o,s]=t.split(":").map(Number),[a,c,d]=i.split(":").map(Number),g=new Date(0,0,0,r,o,s||0),y=new Date(0,0,0,a,c,d||0);if(isNaN(g.getTime())||isNaN(y.getTime())||y<g)return 0;let _=(y.getTime()-g.getTime())/(1e3*60*60);return Math.floor(_*100)/100}calculateSalary(e){let t=this.calculateWorkHours(e),i=this.employee()?.hourlyRate||0,r=e.get("isDoublePay")?.value,o=t*i;return r&&(o*=2),o}onSave(){let e=this.employee()?.id;if(!e)return;let i=(this.payrollForm.value.records||[]).map(r=>({employeeId:e,date:r.date,clockIn:r.clockIn||null,clockOut:r.clockOut||null,isDoublePay:r.isDoublePay||!1}));this.dataService.updatePunchRecords(e,this.year(),this.month(),i),this.initialFormValue=JSON.stringify(this.payrollForm.value),alert("\u6253\u5361\u7D00\u9304\u5DF2\u5132\u5B58\uFF01"),this.router.navigate(["/payroll"])}goBack(){this.router.navigate(["/payroll"])}onCancel(){let e=JSON.stringify(this.payrollForm.value);this.initialFormValue===e?this.router.navigate(["/payroll"]):confirm("\u60A8\u6709\u672A\u5132\u5B58\u7684\u8B8A\u66F4\uFF0C\u78BA\u5B9A\u8981\u96E2\u958B\u55CE\uFF1F")&&this.router.navigate(["/payroll"])}clearRecord(e){confirm("\u662F\u5426\u6E05\u9664\u7576\u5929\u6253\u5361\u8CC7\u6599\uFF1F")&&this.records.at(e).patchValue({clockIn:null,clockOut:null,isDoublePay:!1})}};Us.\u0275fac=function(t){return new(t||Us)},Us.\u0275cmp=ee({type:Us,selectors:[["app-payroll-detail"]],decls:47,vars:14,consts:[[1,"space-y-6","max-w-5xl","mx-auto"],[1,"flex","items-center","gap-4"],[1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","arrow-back-outline",1,"text-2xl"],[1,"text-3xl","font-bold","text-gray-900"],[1,"text-lg","text-indigo-600","font-semibold"],[1,"bg-white","p-6","rounded-xl","shadow-md"],["novalidate","",3,"ngSubmit","formGroup"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-2","py-3","w-12"],[1,"px-3","py-3"],[1,"px-3","py-3","text-center"],[1,"px-3","py-3","text-right"],["formArrayName","records"],[1,"border-b","hover:bg-gray-50",3,"formGroupName"],[1,"font-bold","bg-gray-100","text-base"],[1,"border-t-2"],["colspan","4",1,"px-3","py-3"],[1,"flex","items-center","justify-end","gap-4","pt-6","mt-6","border-t"],["type","button",1,"px-4","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],["type","submit",1,"px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-indigo-600","hover:bg-indigo-700"],[1,"px-2","py-2","text-center"],["type","button","title","\u6E05\u9664\u6B64\u884C",1,"text-red-500","hover:text-red-700","p-1","rounded-full","hover:bg-red-100","transition-colors",3,"click"],["name","close-circle-outline",1,"text-lg","align-middle"],[1,"px-3","py-2","font-medium"],[1,"px-3","py-2"],["type","time","step","1","formControlName","clockIn",1,"w-full","border-gray-200","rounded-md","shadow-sm","p-1","bg-gray-50","text-sm"],["type","time","step","1","formControlName","clockOut",1,"w-full","border-gray-200","rounded-md","shadow-sm","p-1","bg-gray-50","text-sm"],[1,"px-3","py-2","text-center","font-medium"],[1,"px-3","py-2","text-center"],["type","checkbox","formControlName","isDoublePay",1,"rounded","h-4","w-4","text-indigo-600","focus:ring-indigo-500","border-gray-300"],[1,"px-3","py-2","text-right","font-semibold"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"button",2),S("click",function(){return i.goBack()}),x(3,"ion-icon",3),u(),l(4,"div")(5,"h1",4),m(6),u(),l(7,"p",5),m(8),u()()(),l(9,"div",6)(10,"form",7),S("ngSubmit",function(){return i.onSave()}),l(11,"div",8)(12,"table",9)(13,"thead",10)(14,"tr"),x(15,"th",11),l(16,"th",12),m(17,"\u65E5\u671F"),u(),l(18,"th",12),m(19,"\u4E0A\u73ED"),u(),l(20,"th",12),m(21,"\u4E0B\u73ED"),u(),l(22,"th",13),m(23,"\u5DE5\u6642"),u(),l(24,"th",13),m(25,"\u96D9\u500D\u85AA\u8CC7"),u(),l(26,"th",14),m(27,"\u85AA\u8CC7"),u()()(),l(28,"tbody",15),O(29,xL,18,13,"tr",16,W),u(),l(31,"tfoot",17)(32,"tr",18)(33,"td",19),m(34,"\u7E3D\u8A08"),u(),l(35,"td",13),m(36),nn(37,"number"),u(),x(38,"td",12),l(39,"td",14),m(40),nn(41,"currency"),u()()()()(),l(42,"div",20)(43,"button",21),S("click",function(){return i.onCancel()}),m(44," \u53D6\u6D88 "),u(),l(45,"button",22),m(46," \u5132\u5B58\u8B8A\u66F4 "),u()()()()()),t&2){let r;h(6),L(" ",(r=i.employee())==null?null:r.name," - \u6253\u5361\u8A73\u7D30\u8CC7\u8A0A "),h(2),yt("",i.year(),"\u5E74 ",i.month(),"\u6708"),h(2),N("formGroup",i.payrollForm),h(19),V(i.records.controls),h(7),E(xn(37,6,i.totalHours(),"1.2-2")),h(4),E(Gc(41,9,i.totalSalary(),"TWD","symbol","1.0-0"))}},dependencies:[oe,$e,je,xe,Pl,ge,Be,Ue,qe,Ei,bi,Qa,Lg],encapsulation:2,changeDetection:0});var im=Us;var jl=(n,e)=>e.id;function EL(n,e){if(n&1&&(l(0,"option",16),m(1),u()),n&2){let t=e.$implicit;N("value",t.id),h(),E(t.name)}}function bL(n,e){if(n&1&&(l(0,"option",16),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),E(t)}}function SL(n,e){if(n&1){let t=U();l(0,"tr",27)(1,"td",29),m(2),u(),l(3,"td",30),m(4),u(),l(5,"td",29),m(6),u(),l(7,"td",29),m(8),u(),l(9,"td",31),m(10),u(),l(11,"td",29),m(12),u(),l(13,"td",29),m(14),u(),l(15,"td",31),m(16),u(),l(17,"td",32),m(18),u(),l(19,"td",33),m(20),u(),l(21,"td",29)(22,"div",34)(23,"button",35),S("click",function(){let r=w(t).$implicit,o=C(2);return T(o.openModal(r))}),x(24,"ion-icon",36),u(),l(25,"button",37),S("click",function(){let r=w(t).$implicit,o=C(2);return T(o.deleteItem(r.id))}),x(26,"ion-icon",38),u()()()()}if(n&2){let t=e.$implicit,i=C(2);h(2),E(t.productId),h(2),E(t.productName),h(2),E(i.getVendorName(t.vendorId)),h(2),E(t.category),h(2),E(t.itemQuantity),h(2),E(t.itemUnit),h(2),E(t.totalUnit),h(2),E(i.formatCurrency(t.price)),h(2),E(i.formatCurrency(i.calculateItemCost(t.price,t.itemQuantity))),h(2),E(t.notes)}}function DL(n,e){n&1&&(l(0,"tr")(1,"td",39),m(2,"\u7121\u7B26\u5408\u689D\u4EF6\u7684\u5546\u54C1\u6210\u672C\u8CC7\u6599\u3002"),u()())}function wL(n,e){if(n&1){let t=U();l(0,"div",28)(1,"span",40),m(2),u(),l(3,"div",34)(4,"button",41),S("click",function(){w(t);let r=C(2);return T(r.goToPage(r.groceriesCurrentPage()-1,"groceries"))}),x(5,"ion-icon",42),u(),l(6,"span",43),m(7),u(),l(8,"button",41),S("click",function(){w(t);let r=C(2);return T(r.goToPage(r.groceriesCurrentPage()+1,"groceries"))}),x(9,"ion-icon",44),u()()()}if(n&2){let t=C(2);h(2),Pt("\u986F\u793A\u7B2C ",(t.groceriesCurrentPage()-1)*t.groceriesPageSize+1," \u81F3 ",t.Math.min(t.groceriesCurrentPage()*t.groceriesPageSize,t.filteredGroceries().length)," \u7B46\uFF0C\u5171 ",t.filteredGroceries().length," \u7B46"),h(2),N("disabled",t.groceriesCurrentPage()===1),h(3),yt("\u7B2C ",t.groceriesCurrentPage()," \u9801 / \u5171 ",t.groceriesTotalPages()," \u9801"),h(),N("disabled",t.groceriesCurrentPage()===t.groceriesTotalPages())}}function TL(n,e){if(n&1){let t=U();l(0,"div",11)(1,"div",12)(2,"input",13),S("ngModelChange",function(r){w(t);let o=C();return o.groceriesSearchTerm.set(r),T(o.applyFilters("groceries"))}),u()(),l(3,"div")(4,"select",14),S("ngModelChange",function(r){w(t);let o=C();return o.groceriesSelectedVendor.set(r),T(o.applyFilters("groceries"))}),l(5,"option",15),m(6,"\u6240\u6709\u4F9B\u61C9\u5546"),u(),O(7,EL,2,2,"option",16,jl),u()(),l(9,"div")(10,"select",14),S("ngModelChange",function(r){w(t);let o=C();return o.groceriesSelectedCategory.set(r),T(o.applyFilters("groceries"))}),l(11,"option",15),m(12,"\u6240\u6709\u54C1\u9805"),u(),O(13,bL,2,2,"option",16,W),u()(),l(15,"div",17)(16,"button",18),S("click",function(){w(t);let r=C();return T(r.resetFilters("groceries"))}),x(17,"ion-icon",19),u()()(),l(18,"div",20)(19,"table",21)(20,"thead",22)(21,"tr")(22,"th",23),S("click",function(){w(t);let r=C();return T(r.sortData("productId"))}),m(23,"\u5546\u54C1\u7DE8\u865F"),u(),l(24,"th",23),S("click",function(){w(t);let r=C();return T(r.sortData("productName"))}),m(25,"\u5546\u54C1\u540D\u7A31"),u(),l(26,"th",23),S("click",function(){w(t);let r=C();return T(r.sortData("vendorId"))}),m(27,"\u4F9B\u61C9\u5546"),u(),l(28,"th",23),S("click",function(){w(t);let r=C();return T(r.sortData("category"))}),m(29,"\u54C1\u9805"),u(),l(30,"th",24),S("click",function(){w(t);let r=C();return T(r.sortData("itemQuantity"))}),m(31,"\u7D30\u9805\u6578\u91CF"),u(),l(32,"th",23),S("click",function(){w(t);let r=C();return T(r.sortData("itemUnit"))}),m(33,"\u7D30\u9805\u55AE\u4F4D"),u(),l(34,"th",23),S("click",function(){w(t);let r=C();return T(r.sortData("totalUnit"))}),m(35,"\u7E3D\u55AE\u4F4D"),u(),l(36,"th",24),S("click",function(){w(t);let r=C();return T(r.sortData("price"))}),m(37,"\u50F9\u683C(\u5143)"),u(),l(38,"th",25),m(39,"\u7D30\u9805\u55AE\u4F4D\u6210\u672C"),u(),l(40,"th",26),m(41,"\u5099\u8A3B"),u(),l(42,"th",26),m(43,"\u64CD\u4F5C"),u()()(),l(44,"tbody"),O(45,SL,27,10,"tr",27,jl,!1,DL,3,0,"tr"),u()()(),P(48,wL,10,7,"div",28)}if(n&2){let t=C();h(2),N("ngModel",t.groceriesSearchTerm()),h(2),N("ngModel",t.groceriesSelectedVendor()),h(3),V(t.allVendors()),h(3),N("ngModel",t.groceriesSelectedCategory()),h(3),V(t.groceriesProductCategories()),h(32),V(t.paginatedGroceries()),h(3),F(t.groceriesTotalPages()>1?48:-1)}}function IL(n,e){if(n&1&&(l(0,"option",16),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),E(t)}}function ML(n,e){if(n&1&&(l(0,"option",16),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),E(t)}}function AL(n,e){if(n&1){let t=U();l(0,"tr",27)(1,"td",29),m(2),u(),l(3,"td",30),m(4),u(),l(5,"td",29),m(6),u(),l(7,"td",31),m(8),u(),l(9,"td",31),m(10),u(),l(11,"td",32),m(12),u(),l(13,"td",29)(14,"div",34)(15,"button",35),S("click",function(){let r=w(t).$implicit,o=C(2);return T(o.openModal(r))}),x(16,"ion-icon",36),u(),l(17,"button",37),S("click",function(){let r=w(t).$implicit,o=C(2);return T(o.deleteItem(r.id))}),x(18,"ion-icon",38),u()()()()}if(n&2){let t=e.$implicit,i=C(2);h(2),E(t.vendor),h(2),E(t.productName),h(2),E(t.type),h(2),E(i.formatCurrency(t.cost)),h(2),E(i.formatCurrency(t.sellingPrice)),h(2),L("",i.calculateMargin(t.cost,t.sellingPrice).toFixed(2),"%")}}function NL(n,e){n&1&&(l(0,"tr")(1,"td",46),m(2,"\u7121\u8CC7\u6599\u3002"),u()())}function RL(n,e){if(n&1){let t=U();l(0,"div",28)(1,"span",40),m(2),u(),l(3,"div",34)(4,"button",41),S("click",function(){w(t);let r=C(2);return T(r.goToPage(r.wineCurrentPage()-1,"wines"))}),x(5,"ion-icon",42),u(),l(6,"span",43),m(7),u(),l(8,"button",41),S("click",function(){w(t);let r=C(2);return T(r.goToPage(r.wineCurrentPage()+1,"wines"))}),x(9,"ion-icon",44),u()()()}if(n&2){let t=C(2);h(2),Pt("\u986F\u793A\u7B2C ",(t.wineCurrentPage()-1)*t.winePageSize+1," \u81F3 ",t.Math.min(t.wineCurrentPage()*t.winePageSize,t.filteredWines().length)," \u7B46\uFF0C\u5171 ",t.filteredWines().length," \u7B46"),h(2),N("disabled",t.wineCurrentPage()===1),h(3),yt("\u7B2C ",t.wineCurrentPage()," \u9801 / \u5171 ",t.wineTotalPages()," \u9801"),h(),N("disabled",t.wineCurrentPage()===t.wineTotalPages())}}function PL(n,e){if(n&1){let t=U();l(0,"div",11)(1,"div",12)(2,"input",45),S("ngModelChange",function(r){w(t);let o=C();return o.wineSearchTerm.set(r),T(o.applyFilters("wines"))}),u()(),l(3,"div")(4,"select",14),S("ngModelChange",function(r){w(t);let o=C();return o.wineSelectedVendor.set(r),T(o.applyFilters("wines"))}),l(5,"option",15),m(6,"\u6240\u6709\u5EE0\u5546"),u(),O(7,IL,2,2,"option",16,W),u()(),l(9,"div")(10,"select",14),S("ngModelChange",function(r){w(t);let o=C();return o.wineSelectedType.set(r),T(o.applyFilters("wines"))}),l(11,"option",15),m(12,"\u6240\u6709\u985E\u578B"),u(),O(13,ML,2,2,"option",16,W),u()(),l(15,"div",17)(16,"button",18),S("click",function(){w(t);let r=C();return T(r.resetFilters("wines"))}),x(17,"ion-icon",19),u()()(),l(18,"div",20)(19,"table",21)(20,"thead",22)(21,"tr")(22,"th",23),S("click",function(){w(t);let r=C();return T(r.sortData("vendor"))}),m(23,"\u5EE0\u5546"),u(),l(24,"th",23),S("click",function(){w(t);let r=C();return T(r.sortData("productName"))}),m(25,"\u5546\u54C1"),u(),l(26,"th",23),S("click",function(){w(t);let r=C();return T(r.sortData("type"))}),m(27,"\u985E\u578B"),u(),l(28,"th",24),S("click",function(){w(t);let r=C();return T(r.sortData("cost"))}),m(29,"\u9032\u8CA8\u6210\u672C"),u(),l(30,"th",24),S("click",function(){w(t);let r=C();return T(r.sortData("sellingPrice"))}),m(31,"\u552E\u50F9"),u(),l(32,"th",25),m(33,"\u6BDB\u5229\u7387"),u(),l(34,"th",26),m(35,"\u64CD\u4F5C"),u()()(),l(36,"tbody"),O(37,AL,19,6,"tr",27,jl,!1,NL,3,0,"tr"),u()()(),P(40,RL,10,7,"div",28)}if(n&2){let t=C();h(2),N("ngModel",t.wineSearchTerm()),h(2),N("ngModel",t.wineSelectedVendor()),h(3),V(t.wineVendors()),h(3),N("ngModel",t.wineSelectedType()),h(3),V(t.wineTypes()),h(24),V(t.paginatedWines()),h(3),F(t.wineTotalPages()>1?40:-1)}}function FL(n,e){if(n&1&&(l(0,"option",16),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),E(t)}}function kL(n,e){if(n&1){let t=U();l(0,"tr",27)(1,"td",30),m(2),u(),l(3,"td",29),m(4),u(),l(5,"td",29),m(6),u(),l(7,"td",31),m(8),u(),l(9,"td",31),m(10),u(),l(11,"td",31),m(12),u(),l(13,"td",31),m(14),u(),l(15,"td",32),m(16),u(),l(17,"td",29)(18,"div",34)(19,"button",35),S("click",function(){let r=w(t).$implicit,o=C(2);return T(o.openModal(r))}),x(20,"ion-icon",36),u(),l(21,"button",37),S("click",function(){let r=w(t).$implicit,o=C(2);return T(o.deleteItem(r.id))}),x(22,"ion-icon",38),u()()()()}if(n&2){let t=e.$implicit,i=C(2);h(2),E(t.brand),h(2),E(t.productName),h(2),E(t.size),h(2),E(t.quantityPerBox),h(2),E(i.formatCurrency(t.lishengCost)),h(2),E(i.formatCurrency(t.baijiaCost)),h(2),E(i.formatCurrency(t.sellingPrice)),h(2),L("",i.calculateMargin(t.baijiaCost,t.sellingPrice).toFixed(2),"%")}}function OL(n,e){n&1&&(l(0,"tr")(1,"td",50),m(2,"\u7121\u8CC7\u6599\u3002"),u()())}function VL(n,e){if(n&1){let t=U();l(0,"div",28)(1,"span",40),m(2),u(),l(3,"div",34)(4,"button",41),S("click",function(){w(t);let r=C(2);return T(r.goToPage(r.cigarCurrentPage()-1,"cigars"))}),x(5,"ion-icon",42),u(),l(6,"span",43),m(7),u(),l(8,"button",41),S("click",function(){w(t);let r=C(2);return T(r.goToPage(r.cigarCurrentPage()+1,"cigars"))}),x(9,"ion-icon",44),u()()()}if(n&2){let t=C(2);h(2),Pt("\u986F\u793A\u7B2C ",(t.cigarCurrentPage()-1)*t.cigarPageSize+1," \u81F3 ",t.Math.min(t.cigarCurrentPage()*t.cigarPageSize,t.filteredCigars().length)," \u7B46\uFF0C\u5171 ",t.filteredCigars().length," \u7B46"),h(2),N("disabled",t.cigarCurrentPage()===1),h(3),yt("\u7B2C ",t.cigarCurrentPage()," \u9801 / \u5171 ",t.cigarTotalPages()," \u9801"),h(),N("disabled",t.cigarCurrentPage()===t.cigarTotalPages())}}function LL(n,e){if(n&1){let t=U();l(0,"div",47)(1,"div",12)(2,"input",48),S("ngModelChange",function(r){w(t);let o=C();return o.cigarSearchTerm.set(r),T(o.applyFilters("cigars"))}),u()(),l(3,"div")(4,"select",14),S("ngModelChange",function(r){w(t);let o=C();return o.cigarSelectedBrand.set(r),T(o.applyFilters("cigars"))}),l(5,"option",15),m(6,"\u6240\u6709\u54C1\u724C"),u(),O(7,FL,2,2,"option",16,W),u()(),l(9,"div",49)(10,"button",18),S("click",function(){w(t);let r=C();return T(r.resetFilters("cigars"))}),x(11,"ion-icon",19),u()()(),l(12,"div",20)(13,"table",21)(14,"thead",22)(15,"tr")(16,"th",23),S("click",function(){w(t);let r=C();return T(r.sortData("brand"))}),m(17,"\u54C1\u724C"),u(),l(18,"th",23),S("click",function(){w(t);let r=C();return T(r.sortData("productName"))}),m(19,"\u5546\u54C1\u540D\u7A31"),u(),l(20,"th",23),S("click",function(){w(t);let r=C();return T(r.sortData("size"))}),m(21,"\u5C3A\u5BF8"),u(),l(22,"th",24),S("click",function(){w(t);let r=C();return T(r.sortData("quantityPerBox"))}),m(23,"\u6BCF\u76D2\u6578\u91CF"),u(),l(24,"th",24),S("click",function(){w(t);let r=C();return T(r.sortData("lishengCost"))}),m(25,"\u7406\u665F\u6210\u672C(\u652F)"),u(),l(26,"th",24),S("click",function(){w(t);let r=C();return T(r.sortData("baijiaCost"))}),m(27,"\u767E\u6CC7\u6210\u672C(\u652F)"),u(),l(28,"th",24),S("click",function(){w(t);let r=C();return T(r.sortData("sellingPrice"))}),m(29,"\u8CE3\u50F9"),u(),l(30,"th",25),m(31,"\u6BDB\u5229\u7387"),u(),l(32,"th",26),m(33,"\u64CD\u4F5C"),u()()(),l(34,"tbody"),O(35,kL,23,8,"tr",27,jl,!1,OL,3,0,"tr"),u()()(),P(38,VL,10,7,"div",28)}if(n&2){let t=C();h(2),N("ngModel",t.cigarSearchTerm()),h(2),N("ngModel",t.cigarSelectedBrand()),h(3),V(t.cigarBrands()),h(28),V(t.paginatedCigars()),h(3),F(t.cigarTotalPages()>1?38:-1)}}function BL(n,e){if(n&1&&m(0),n&2){let t=C(2);L(" ",t.editingProductCost()?"\u7DE8\u8F2F\u5546\u54C1\u6210\u672C":"\u65B0\u589E\u5546\u54C1\u6210\u672C"," ")}}function UL(n,e){if(n&1&&m(0),n&2){let t=C(2);L(" ",t.editingWineCost()?"\u7DE8\u8F2F\u9152\u985E\u6210\u672C":"\u65B0\u589E\u9152\u985E\u6210\u672C"," ")}}function $L(n,e){if(n&1&&m(0),n&2){let t=C(2);L(" ",t.editingCigarCost()?"\u7DE8\u8F2F\u96EA\u8304\u6210\u672C":"\u65B0\u589E\u96EA\u8304\u6210\u672C"," ")}}function HL(n,e){if(n&1&&x(0,"option",16),n&2){let t=e.$implicit;N("value",t)}}function GL(n,e){if(n&1&&(l(0,"option",16),m(1),u()),n&2){let t=e.$implicit;N("value",t.id),h(),E(t.name)}}function qL(n,e){if(n&1&&(l(0,"div",58)(1,"div",62)(2,"label",63)(3,"span",64),m(4,"\u5546\u54C1\u7DE8\u865F*"),u(),x(5,"input",65),u(),l(6,"label",63)(7,"span",64),m(8,"\u5546\u54C1\u540D\u7A31*"),u(),x(9,"input",66),u(),l(10,"label",63)(11,"span",64),m(12,"\u54C1\u9805*"),u(),x(13,"input",67),l(14,"datalist",68),O(15,HL,1,1,"option",16,W),u()(),l(17,"label",63)(18,"span",64),m(19,"\u4F9B\u61C9\u5546*"),u(),l(20,"select",69)(21,"option",70),m(22,"\u9078\u64C7\u4F9B\u61C9\u5546"),u(),O(23,GL,2,2,"option",16,jl),u()(),l(25,"label",63)(26,"span",64),m(27,"\u7D30\u9805\u6578\u91CF*"),u(),x(28,"input",71),u(),l(29,"label",63)(30,"span",64),m(31,"\u7D30\u9805\u55AE\u4F4D*"),u(),x(32,"input",72),u(),l(33,"label",63)(34,"span",64),m(35,"\u7E3D\u55AE\u4F4D*"),u(),x(36,"input",73),u(),l(37,"label",63)(38,"span",64),m(39,"\u50F9\u683C(\u5143)*"),u(),x(40,"input",74),u()(),l(41,"label",63)(42,"span",64),m(43,"\u5099\u8A3B"),u(),x(44,"textarea",75),u()()),n&2){let t=C(2);N("formGroup",t.productCostForm),h(15),V(t.groceriesProductCategories()),h(8),V(t.allVendors())}}function WL(n,e){if(n&1&&(l(0,"div",58)(1,"div",62)(2,"label",63)(3,"span",64),m(4,"\u5EE0\u5546*"),u(),x(5,"input",76),u(),l(6,"label",63)(7,"span",64),m(8,"\u5546\u54C1\u540D\u7A31*"),u(),x(9,"input",66),u(),l(10,"label",63)(11,"span",64),m(12,"\u985E\u578B*"),u(),x(13,"input",77),u(),l(14,"label",63)(15,"span",64),m(16,"\u9032\u8CA8\u6210\u672C*"),u(),x(17,"input",78),u(),l(18,"label",79)(19,"span",64),m(20,"\u552E\u50F9*"),u(),x(21,"input",80),u()()()),n&2){let t=C(2);N("formGroup",t.wineCostForm)}}function jL(n,e){if(n&1&&(l(0,"div",58)(1,"div",62)(2,"label",63)(3,"span",64),m(4,"\u54C1\u724C*"),u(),x(5,"input",81),u(),l(6,"label",63)(7,"span",64),m(8,"\u5546\u54C1\u540D\u7A31*"),u(),x(9,"input",66),u(),l(10,"label",63)(11,"span",64),m(12,"\u5C3A\u5BF8*"),u(),x(13,"input",82),u(),l(14,"label",63)(15,"span",64),m(16,"\u6BCF\u76D2\u6578\u91CF*"),u(),x(17,"input",83),u(),l(18,"label",63)(19,"span",64),m(20,"\u7406\u665F\u6210\u672C(\u652F)*"),u(),x(21,"input",84),u(),l(22,"label",63)(23,"span",64),m(24,"\u767E\u6CC7\u6210\u672C(\u652F)*"),u(),x(25,"input",85),u(),l(26,"label",79)(27,"span",64),m(28,"\u8CE3\u50F9*"),u(),x(29,"input",80),u()()()),n&2){let t=C(2);N("formGroup",t.cigarCostForm)}}function zL(n,e){if(n&1){let t=U();l(0,"div",10)(1,"div",51)(2,"div",52)(3,"h3",53),P(4,BL,1,1)(5,UL,1,1)(6,$L,1,1),u(),l(7,"button",54),S("click",function(){w(t);let r=C();return T(r.closeModal())}),x(8,"ion-icon",55),u()(),l(9,"div",56)(10,"form",57),S("ngSubmit",function(){w(t);let r=C();return T(r.handleFormSubmit())}),P(11,qL,45,1,"div",58)(12,WL,22,1,"div",58)(13,jL,30,1,"div",58),l(14,"div",59)(15,"button",60),S("click",function(){w(t);let r=C();return T(r.closeModal())}),m(16,"\u53D6\u6D88"),u(),l(17,"button",61),m(18,"\u5132\u5B58"),u()()()()()()}if(n&2){let t,i,r=C();h(4),F((t=r.activeView())==="groceries"?4:t==="wines"?5:t==="cigars"?6:-1),h(7),F((i=r.activeView())==="groceries"?11:i==="wines"?12:i==="cigars"?13:-1)}}var $s=class $s{constructor(){this.dataService=R(mt);this.fb=R(ze);this.activeView=D("groceries");this.isModalOpen=D(!1);this.Math=Math;this.allVendors=D([]);this.allProductCosts=D([]);this.editingProductCost=D(null);this.allCigarCosts=D([]);this.editingCigarCost=D(null);this.allWineCosts=D([]);this.editingWineCost=D(null);this.productCostForm=this.fb.group({id:[""],productId:["",$.required],productName:["",$.required],vendorId:["",$.required],category:["",$.required],itemQuantity:[null,[$.required,$.min(.01)]],itemUnit:["",$.required],totalUnit:["",$.required],price:[null,[$.required,$.min(0)]],notes:[""]});this.cigarCostForm=this.fb.group({id:[""],brand:["",$.required],productName:["",$.required],size:["",$.required],quantityPerBox:[null,[$.required,$.min(1)]],lishengCost:[null,[$.required,$.min(0)]],baijiaCost:[null,[$.required,$.min(0)]],sellingPrice:[null,[$.required,$.min(0)]]});this.wineCostForm=this.fb.group({id:[""],vendor:["",$.required],productName:["",$.required],type:["",$.required],cost:[null,[$.required,$.min(0)]],sellingPrice:[null,[$.required,$.min(0)]]});this.groceriesSearchTerm=D("");this.groceriesSelectedVendor=D("");this.groceriesSelectedCategory=D("");this.groceriesSortColumn=D("productName");this.groceriesSortDirection=D("asc");this.groceriesCurrentPage=D(1);this.groceriesPageSize=10;this.cigarSearchTerm=D("");this.cigarSelectedBrand=D("");this.cigarSortColumn=D("brand");this.cigarSortDirection=D("asc");this.cigarCurrentPage=D(1);this.cigarPageSize=10;this.wineSearchTerm=D("");this.wineSelectedVendor=D("");this.wineSelectedType=D("");this.wineSortColumn=D("vendor");this.wineSortDirection=D("asc");this.wineCurrentPage=D(1);this.winePageSize=10;this.groceriesProductCategories=H(()=>[...new Set(this.allProductCosts().map(e=>e.category))].sort());this.filteredGroceries=H(()=>this.filterAndSort(this.allProductCosts(),this.groceriesSearchTerm(),{vendorId:this.groceriesSelectedVendor(),category:this.groceriesSelectedCategory()},["productName","productId"],this.groceriesSortColumn(),this.groceriesSortDirection()));this.paginatedGroceries=H(()=>this.paginate(this.filteredGroceries(),this.groceriesCurrentPage(),this.groceriesPageSize));this.groceriesTotalPages=H(()=>Math.ceil(this.filteredGroceries().length/this.groceriesPageSize));this.cigarBrands=H(()=>[...new Set(this.allCigarCosts().map(e=>e.brand))].sort());this.filteredCigars=H(()=>this.filterAndSort(this.allCigarCosts(),this.cigarSearchTerm(),{brand:this.cigarSelectedBrand()},["productName","brand"],this.cigarSortColumn(),this.cigarSortDirection()));this.paginatedCigars=H(()=>this.paginate(this.filteredCigars(),this.cigarCurrentPage(),this.cigarPageSize));this.cigarTotalPages=H(()=>Math.ceil(this.filteredCigars().length/this.cigarPageSize));this.wineVendors=H(()=>[...new Set(this.allWineCosts().map(e=>e.vendor))].sort());this.wineTypes=H(()=>[...new Set(this.allWineCosts().map(e=>e.type))].sort());this.filteredWines=H(()=>this.filterAndSort(this.allWineCosts(),this.wineSearchTerm(),{vendor:this.wineSelectedVendor(),type:this.wineSelectedType()},["productName","vendor","type"],this.wineSortColumn(),this.wineSortDirection()));this.paginatedWines=H(()=>this.paginate(this.filteredWines(),this.wineCurrentPage(),this.winePageSize));this.wineTotalPages=H(()=>Math.ceil(this.filteredWines().length/this.winePageSize));this.loadData()}loadData(){this.allProductCosts.set(this.dataService.getProductCosts()),this.allCigarCosts.set(this.dataService.getCigarCosts()),this.allWineCosts.set(this.dataService.getWineCosts()),this.allVendors.set(this.dataService.getVendors())}changeView(e){this.activeView.set(e)}filterAndSort(e,t,i,r,o,s){let a=t.toLowerCase(),c=e.filter(d=>Object.entries(i).every(([y,v])=>!v||d[y]===v)?a?r.some(y=>String(d[y]).toLowerCase().includes(a)):!0:!1);return o&&(c=[...c].sort((d,g)=>{let y=d[o],v=g[o];return y<v?s==="asc"?-1:1:y>v?s==="asc"?1:-1:0})),c}paginate(e,t,i){let r=(t-1)*i;return e.slice(r,r+i)}openModal(e=null){let t=this.activeView();t==="groceries"?(this.editingProductCost.set(e),this.productCostForm.reset(),e&&this.productCostForm.patchValue(e)):t==="cigars"?(this.editingCigarCost.set(e),this.cigarCostForm.reset(),e&&this.cigarCostForm.patchValue(e)):t==="wines"&&(this.editingWineCost.set(e),this.wineCostForm.reset(),e&&this.wineCostForm.patchValue(e)),this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1)}handleFormSubmit(){let e=this.activeView();e==="groceries"?this.handleGroceriesSubmit():e==="cigars"?this.handleCigarSubmit():e==="wines"&&this.handleWineSubmit(),this.loadData(),this.closeModal()}handleGroceriesSubmit(){if(this.productCostForm.invalid)return;let e=this.productCostForm.value;this.editingProductCost()?this.dataService.updateProductCost(q(k({},e),{id:this.editingProductCost().id})):this.dataService.addProductCost(e)}handleCigarSubmit(){if(this.cigarCostForm.invalid)return;let e=this.cigarCostForm.value;this.editingCigarCost()?this.dataService.updateCigarCost(q(k({},e),{id:this.editingCigarCost().id})):this.dataService.addCigarCost(e)}handleWineSubmit(){if(this.wineCostForm.invalid)return;let e=this.wineCostForm.value;this.editingWineCost()?this.dataService.updateWineCost(q(k({},e),{id:this.editingWineCost().id})):this.dataService.addWineCost(e)}deleteItem(e){if(!confirm("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u6B64\u9805\u5546\u54C1\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"))return;let t=this.activeView();t==="groceries"?this.dataService.deleteProductCost(e):t==="cigars"?this.dataService.deleteCigarCost(e):t==="wines"&&this.dataService.deleteWineCost(e),this.loadData()}sortData(e){let t=this.activeView(),i=t==="groceries"?this.groceriesSortColumn:t==="cigars"?this.cigarSortColumn:this.wineSortColumn,r=t==="groceries"?this.groceriesSortDirection:t==="cigars"?this.cigarSortDirection:this.wineSortDirection;i()===e?r.update(o=>o==="asc"?"desc":"asc"):(i.set(e),r.set("asc"))}resetFilters(e){e==="groceries"?(this.groceriesSearchTerm.set(""),this.groceriesSelectedVendor.set(""),this.groceriesSelectedCategory.set("")):e==="cigars"?(this.cigarSearchTerm.set(""),this.cigarSelectedBrand.set("")):e==="wines"&&(this.wineSearchTerm.set(""),this.wineSelectedVendor.set(""),this.wineSelectedType.set("")),this.goToPage(1,e)}applyFilters(e){this.goToPage(1,e)}goToPage(e,t){let i=t==="groceries"?this.groceriesCurrentPage:t==="cigars"?this.cigarCurrentPage:this.wineCurrentPage,r=t==="groceries"?this.groceriesTotalPages():t==="cigars"?this.cigarTotalPages():this.wineTotalPages();e>=1&&e<=r&&i.set(e)}getVendorName(e){return this.allVendors().find(t=>t.id===e)?.name||"N/A"}calculateItemCost(e,t){return!e||!t?0:e/t}calculateMargin(e,t){return!e||!t?0:(t-e)/t*100}formatCurrency(e){return e?.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})||""}};$s.\u0275fac=function(t){return new(t||$s)},$s.\u0275cmp=ee({type:$s,selectors:[["app-product-cost"]],decls:22,vars:8,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","add-outline"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"border-b","border-gray-200"],["aria-label","Tabs",1,"-mb-px","flex","space-x-6"],[1,"whitespace-nowrap","py-4","px-1","border-b-2","font-medium","text-sm",3,"click"],[1,"pt-6"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","p-4","bg-gray-50","rounded-lg","mb-6"],[1,"md:col-span-2"],["type","text","placeholder","\u641C\u5C0B\u5546\u54C1\u540D\u7A31\u6216\u7DE8\u865F...",1,"w-full","border-gray-300","rounded-lg","shadow-sm","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"w-full","border-gray-300","rounded-lg","shadow-sm","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"flex","items-center","gap-2","md:col-span-4","justify-end"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-4","py-3","cursor-pointer",3,"click"],[1,"px-4","py-3","cursor-pointer","text-right",3,"click"],[1,"px-4","py-3","text-right"],[1,"px-4","py-3"],[1,"border-b","hover:bg-gray-50"],[1,"flex","justify-between","items-center","pt-4","border-t","mt-4"],[1,"px-4","py-2"],[1,"px-4","py-2","font-medium"],[1,"px-4","py-2","text-right"],[1,"px-4","py-2","text-right","font-semibold","bg-green-50"],[1,"px-4","py-2","truncate","max-w-xs"],[1,"flex","items-center","gap-2"],["title","\u7DE8\u8F2F",1,"text-indigo-600","hover:text-indigo-800","p-1",3,"click"],["name","create-outline",1,"text-lg"],["title","\u522A\u9664",1,"text-red-500","hover:text-red-700","p-1",3,"click"],["name","trash-outline",1,"text-lg"],["colspan","11",1,"text-center","py-8","text-gray-500"],[1,"text-sm","text-gray-600"],[1,"px-3","py-1","border","rounded-md","disabled:opacity-50",3,"click","disabled"],["name","chevron-back-outline"],[1,"text-sm"],["name","chevron-forward-outline"],["type","text","placeholder","\u641C\u5C0B\u5546\u54C1\u3001\u5EE0\u5546\u3001\u985E\u578B...",1,"w-full","border-gray-300","rounded-lg","shadow-sm","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["colspan","7",1,"text-center","py-8","text-gray-500"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","p-4","bg-gray-50","rounded-lg","mb-6"],["type","text","placeholder","\u641C\u5C0B\u54C1\u724C\u6216\u5546\u54C1\u540D\u7A31...",1,"w-full","border-gray-300","rounded-lg","shadow-sm","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"flex","items-center","gap-2","md:col-span-3","justify-end"],["colspan","9",1,"text-center","py-8","text-gray-500"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-2xl","max-h-[90vh]","flex","flex-col"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],["novalidate","",1,"space-y-4",3,"ngSubmit"],[1,"space-y-4",3,"formGroup"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"block"],[1,"text-gray-700"],["formControlName","productId",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","productName",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","category","list","productCategoriesList","placeholder","\u9078\u64C7\u6216\u8F38\u5165\u65B0\u54C1\u9805",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["id","productCategoriesList"],["formControlName","vendorId",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["value","","disabled",""],["type","number","formControlName","itemQuantity",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","itemUnit","placeholder","\u4F8B\u5982: ml, g, \u9846",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","totalUnit","placeholder","\u4F8B\u5982: \u74F6, \u5305, \u7F50",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["type","number","formControlName","price",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","notes","rows","3",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","vendor",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","type",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["type","number","formControlName","cost",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"block","md:col-span-2"],["type","number","formControlName","sellingPrice",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","brand",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","size",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["type","number","formControlName","quantityPerBox",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["type","number","formControlName","lishengCost",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["type","number","formControlName","baijiaCost",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),m(3,"\u5546\u54C1\u6210\u672C\u7BA1\u7406"),u(),l(4,"button",3),S("click",function(){return i.openModal()}),x(5,"ion-icon",4),l(6,"span"),m(7,"\u65B0\u589E\u9805\u76EE"),u()()(),l(8,"div",5)(9,"div",6)(10,"nav",7)(11,"button",8),S("click",function(){return i.changeView("groceries")}),m(12,"\u9910\u98F2&\u96DC\u8CA8"),u(),l(13,"button",8),S("click",function(){return i.changeView("wines")}),m(14,"\u5A01&\u7D05\u767D\u9152"),u(),l(15,"button",8),S("click",function(){return i.changeView("cigars")}),m(16,"\u96EA\u8304"),u()()(),l(17,"div",9),P(18,TL,49,5)(19,PL,41,5)(20,LL,39,4),u()()(),P(21,zL,19,2,"div",10)),t&2){let r;h(11),De(i.activeView()==="groceries"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),h(2),De(i.activeView()==="wines"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),h(2),De(i.activeView()==="cigars"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),h(3),F((r=i.activeView())==="groceries"?18:r==="wines"?19:r==="cigars"?20:-1),h(3),F(i.isModalOpen()?21:-1)}},dependencies:[oe,$e,je,Fe,ke,xe,$t,Ae,ge,Be,Ue,qe,Ee,we,kl],encapsulation:2,changeDetection:0});var rm=$s;var YL=(n,e)=>e.vendor_id||e.id;function JL(n,e){n&1&&(l(0,"div",1),x(1,"ion-icon",29),l(2,"span",30),m(3,"\u6B63\u5728\u52A0\u8F09\u6578\u64DA..."),u()())}function KL(n,e){if(n&1&&(l(0,"div",2),x(1,"ion-icon",31),l(2,"span",32),m(3),u()()),n&2){let t=C();h(3),E(t.errorMessage())}}function QL(n,e){if(n&1&&(l(0,"option",14),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),E(t)}}function ZL(n,e){if(n&1&&m(0),n&2){let t=C().$implicit;L(" ",t.rest_days.join(", ")," ")}}function XL(n,e){if(n&1&&m(0),n&2){let t=C().$implicit;L(" ",t.restDays||"-"," ")}}function e7(n,e){if(n&1){let t=U();l(0,"tr",33),S("click",function(){let r=w(t).$implicit,o=C();return T(o.openModal(r))}),l(1,"td",34),m(2),u(),l(3,"td",35),m(4),u(),l(5,"td",34),m(6),u(),l(7,"td",34),P(8,ZL,1,1)(9,XL,1,1),u()()}if(n&2){let t=e.$implicit;h(2),E(t.category),h(2),E(t.vendor_name||t.name),h(2),E(t.contact_info||t.contactInfo),h(2),F(t.rest_days&&t.rest_days.length>0?8:9)}}function t7(n,e){n&1&&(l(0,"tr")(1,"td",36),m(2,"\u7121\u7B26\u5408\u689D\u4EF6\u7684\u5EE0\u5546\u8CC7\u6599\u3002"),u()())}function n7(n,e){if(n&1&&(l(0,"div",52),x(1,"ion-icon",56),l(2,"span",57),m(3),u()()),n&2){let t=C(2);h(3),E(t.errorMessage())}}function i7(n,e){n&1&&(x(0,"ion-icon",58),l(1,"span"),m(2,"\u5132\u5B58\u4E2D..."),u())}function r7(n,e){n&1&&(l(0,"span"),m(1,"\u5132\u5B58"),u())}function o7(n,e){if(n&1){let t=U();l(0,"div",28)(1,"div",37)(2,"div",38)(3,"h3",39),m(4),u(),l(5,"button",40),S("click",function(){w(t);let r=C();return T(r.closeModal())}),x(6,"ion-icon",41),u()(),l(7,"div",42)(8,"form",43),S("ngSubmit",function(){w(t);let r=C();return T(r.handleVendorSubmit())}),x(9,"input",44),l(10,"label",45)(11,"span",46),m(12,"\u985E\u5225*"),u(),x(13,"input",47),u(),l(14,"label",45)(15,"span",46),m(16,"\u5EE0\u5546\u540D\u7A31*"),u(),x(17,"input",48),u(),l(18,"label",45)(19,"span",46),m(20,"\u7D71\u4E00\u7DE8\u865F"),u(),x(21,"input",49),u(),l(22,"label",45)(23,"span",46),m(24,"\u806F\u7D61\u65B9\u5F0F"),u(),x(25,"input",50),u(),l(26,"label",45)(27,"span",46),m(28,"\u4F11\u606F\u6642\u9593"),u(),x(29,"input",51),u(),P(30,n7,4,1,"div",52),l(31,"div",53)(32,"button",54),S("click",function(){w(t);let r=C();return T(r.closeModal())}),m(33,"\u53D6\u6D88"),u(),l(34,"button",55),P(35,i7,3,0)(36,r7,2,0,"span"),u()()()()()()}if(n&2){let t=C();h(4),E(t.editingVendor()?"\u7DE8\u8F2F\u5EE0\u5546":"\u65B0\u589E\u5EE0\u5546"),h(4),N("formGroup",t.vendorForm),h(22),F(t.errorMessage()?30:-1),h(2),N("disabled",t.isLoading()),h(2),N("disabled",t.isLoading()),h(),F(t.isLoading()?35:36)}}var Hs=class Hs{constructor(){this.apiService=R(wt);this.fb=R(ze);this.isModalOpen=D(!1);this.isLoading=D(!1);this.errorMessage=D(null);this.allVendors=D([]);this.editingVendor=D(null);this.vendorForm=this.fb.group({vendor_id:[""],category:["",$.required],vendor_name:["",$.required],tax_id:[""],contact_info:[""],rest_days:[""]});this.vendorSearchTerm=D("");this.selectedVendorCategory=D("");this.vendorTaxIdFilter=D("");this.pageSize=20;this.currentPage=D(1);this.vendorCategories=H(()=>{let e=this.allVendors();return[...new Set(e.map(i=>i.category))].sort()});this.filteredVendors=H(()=>{let e=this.vendorSearchTerm().toLowerCase(),t=this.selectedVendorCategory(),i=this.vendorTaxIdFilter(),r=this.allVendors();return t&&(r=r.filter(o=>o.category===t)),i&&(r=r.filter(o=>(o.tax_id||o.taxId||"").includes(i))),e&&(r=r.filter(o=>(o.vendor_name||o.name||"").toLowerCase().includes(e)||(o.category||"").toLowerCase().includes(e)||(o.contact_info||o.contactInfo||"").toLowerCase().includes(e))),r});this.pagedVendors=H(()=>{let e=this.filteredVendors(),t=(this.currentPage()-1)*this.pageSize;return e.slice(t,t+this.pageSize)});this.totalPages=H(()=>{let e=this.filteredVendors().length;return Math.max(1,Math.ceil(e/this.pageSize))});this.totalRecords=H(()=>this.filteredVendors().length);this.loadData()}async loadData(){this.isLoading.set(!0),this.errorMessage.set(null);try{let e=await this.apiService.getVendors();e.success&&e.data?this.allVendors.set(e.data):this.errorMessage.set(e.error||"\u7121\u6CD5\u53D6\u5F97\u5EE0\u5546\u8CC7\u6599")}catch(e){console.error("Error loading vendors:",e),this.errorMessage.set("\u53D6\u5F97\u5EE0\u5546\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoading.set(!1)}}resetVendorFilters(){this.vendorSearchTerm.set(""),this.selectedVendorCategory.set(""),this.vendorTaxIdFilter.set(""),this.currentPage.set(1)}goToPage(e){let t=this.totalPages(),i=Math.min(Math.max(e,1),t);i!==this.currentPage()&&this.currentPage.set(i)}goToPrevPage(){this.goToPage(this.currentPage()-1)}goToNextPage(){this.goToPage(this.currentPage()+1)}onTaxIdInput(e){let t=e.target,i=t.value.replace(/\D/g,"").slice(0,8);this.vendorTaxIdFilter.set(i),t.value=i,this.currentPage.set(1)}openModal(e=null){this.editingVendor.set(e),this.vendorForm.reset(),e&&this.vendorForm.patchValue(e),this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1),this.editingVendor.set(null)}async handleVendorSubmit(){if(this.vendorForm.invalid){this.errorMessage.set("\u8ACB\u586B\u5BEB\u6240\u6709\u5FC5\u586B\u6B04\u4F4D");return}this.isLoading.set(!0),this.errorMessage.set(null);try{let e=this.vendorForm.value,t={vendor_id:e.vendor_id?Number(e.vendor_id):void 0,category:e.category||"",vendor_name:e.vendor_name||"",tax_id:e.tax_id||void 0,contact_info:e.contact_info||"",rest_days:e.rest_days?e.rest_days.split(",").map(i=>i.trim()).filter(i=>i):[]};if(this.editingVendor()&&t.vendor_id){let i=await this.apiService.updateVendor(t);if(!i.success){this.errorMessage.set(i.error||"\u66F4\u65B0\u5EE0\u5546\u5931\u6557");return}let o=this.allVendors().map(s=>(s.vendor_id||s.id)==t.vendor_id?k(q(k({},s),{vendor_id:t.vendor_id,category:t.category,vendor_name:t.vendor_name,tax_id:t.tax_id,contact_info:t.contact_info,rest_days:t.rest_days}),i.data||{}):s);this.allVendors.set(o),alert("\u5EE0\u5546\u8CC7\u6599\u5DF2\u6210\u529F\u66F4\u65B0"),this.closeModal()}else this.errorMessage.set("\u65B0\u589E\u5EE0\u5546\u529F\u80FD\u5C1A\u672A\u5BE6\u4F5C"),console.warn("\u65B0\u589E\u5EE0\u5546\u529F\u80FD\u9700\u8981\u5F8C\u7AEF\u652F\u6301")}catch(e){console.error("Error submitting vendor:",e),this.errorMessage.set("\u63D0\u4EA4\u5EE0\u5546\u8CC7\u6599\u5931\u6557\uFF1A"+(e instanceof Error?e.message:"\u672A\u77E5\u932F\u8AA4"))}finally{this.isLoading.set(!1)}}async deleteVendor(e){let t=e.vendor_name||e.name||"\u672A\u77E5\u5EE0\u5546";if(!confirm(`\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u5EE0\u5546 "${t}" \u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002`))return;let i=e.vendor_id||e.id;if(!i){this.errorMessage.set("\u5EE0\u5546 ID \u4E0D\u5B58\u5728\uFF0C\u7121\u6CD5\u522A\u9664");return}this.isLoading.set(!0),this.errorMessage.set(null);try{let r=await this.apiService.deleteVendor(i);r.success?await this.loadData():this.errorMessage.set(r.error||"\u522A\u9664\u5EE0\u5546\u5931\u6557")}catch(r){console.error("Error deleting vendor:",r),this.errorMessage.set("\u522A\u9664\u5EE0\u5546\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoading.set(!1)}}formatCurrency(e){return e==null?"":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}};Hs.\u0275fac=function(t){return new(t||Hs)},Hs.\u0275cmp=ee({type:Hs,selectors:[["app-vendors"]],decls:51,vars:13,consts:[[1,"space-y-6"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-4","flex","items-center","gap-3"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4","flex","items-center","gap-3"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["name","add-outline"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"space-y-4"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4","p-4","bg-gray-50","rounded-lg"],[1,"lg:col-span-2"],["type","text","placeholder","\u641C\u5C0B\u5EE0\u5546\u540D\u7A31\u3001\u985E\u5225\u6216\u806F\u7D61\u65B9\u5F0F...",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["value",""],[3,"value"],["type","text","placeholder","\u7D71\u4E00\u7DE8\u865F (8\u78BC)","maxlength","8","pattern","\\d*",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"input","value"],[1,"flex","items-center","gap-2","lg:col-span-4","justify-end"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-4","py-3"],[1,"border-b","hover:bg-gray-50","cursor-pointer","transition-colors"],[1,"flex","flex-col","sm:flex-row","items-center","justify-between","gap-3","pt-4"],[1,"text-sm","text-gray-600"],[1,"flex","items-center","gap-2"],["type","button",1,"px-3","py-1.5","text-sm","border","rounded-md","disabled:opacity-50","disabled:cursor-not-allowed","hover:bg-gray-50",3,"click","disabled"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],["name","hourglass-outline",1,"text-blue-600","text-xl","animate-spin"],[1,"text-blue-700"],["name","alert-circle-outline",1,"text-red-600","text-xl"],[1,"text-red-700"],[1,"border-b","hover:bg-gray-50","cursor-pointer","transition-colors",3,"click"],[1,"px-4","py-2"],[1,"px-4","py-2","font-medium"],["colspan","4",1,"text-center","py-8","text-gray-500"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-lg","max-h-[90vh]","flex","flex-col"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],[1,"space-y-4",3,"ngSubmit","formGroup"],["type","hidden","formControlName","vendor_id"],[1,"block"],[1,"text-gray-700"],["formControlName","category",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","vendor_name",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","tax_id","type","text","maxlength","8","pattern","\\d*","placeholder","8\u4F4D\u6578\u5B57",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","contact_info",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","rest_days","placeholder","\u4F8B\uFF1A\u5468\u4E00,\u5468\u4E8C",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-3","flex","items-center","gap-2"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md","disabled:opacity-50","disabled:cursor-not-allowed","hover:bg-gray-50",3,"click","disabled"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","hover:bg-indigo-700","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","gap-2",3,"disabled"],["name","alert-circle-outline",1,"text-red-600","text-lg"],[1,"text-red-700","text-sm"],["name","hourglass-outline",1,"animate-spin"]],template:function(t,i){t&1&&(l(0,"div",0),P(1,JL,4,0,"div",1),P(2,KL,4,1,"div",2),l(3,"div",3)(4,"h1",4),m(5,"\u5EE0\u5546\u7BA1\u7406"),u(),l(6,"button",5),S("click",function(){return i.openModal()}),x(7,"ion-icon",6),l(8,"span"),m(9,"\u65B0\u589E\u5EE0\u5546"),u()()(),l(10,"div",7)(11,"div",8)(12,"div",9)(13,"div",10)(14,"input",11),S("ngModelChange",function(o){return i.vendorSearchTerm.set(o),i.currentPage.set(1)}),u()(),l(15,"div")(16,"select",12),S("ngModelChange",function(o){return i.selectedVendorCategory.set(o),i.currentPage.set(1)}),l(17,"option",13),m(18,"\u6240\u6709\u985E\u5225"),u(),O(19,QL,2,2,"option",14,W),u()(),l(21,"div")(22,"input",15),S("input",function(o){return i.onTaxIdInput(o)}),u()(),l(23,"div",16)(24,"button",17),S("click",function(){return i.resetVendorFilters()}),x(25,"ion-icon",18),u()()(),l(26,"div",19)(27,"table",20)(28,"thead",21)(29,"tr")(30,"th",22),m(31,"\u985E\u5225"),u(),l(32,"th",22),m(33,"\u5EE0\u5546"),u(),l(34,"th",22),m(35,"\u806F\u7D61\u65B9\u5F0F"),u(),l(36,"th",22),m(37,"\u4F11\u606F\u6642\u9593"),u()()(),l(38,"tbody"),O(39,e7,10,4,"tr",23,YL,!1,t7,3,0,"tr"),u()()(),l(42,"div",24)(43,"div",25),m(44),u(),l(45,"div",26)(46,"button",27),S("click",function(){return i.goToPrevPage()}),m(47," \u4E0A\u4E00\u9801 "),u(),l(48,"button",27),S("click",function(){return i.goToNextPage()}),m(49," \u4E0B\u4E00\u9801 "),u()()()()()(),P(50,o7,37,6,"div",28)),t&2&&(h(),F(i.isLoading()?1:-1),h(),F(i.errorMessage()?2:-1),h(4),N("disabled",i.isLoading()),h(8),N("ngModel",i.vendorSearchTerm()),h(2),N("ngModel",i.selectedVendorCategory()),h(3),V(i.vendorCategories()),h(3),N("value",i.vendorTaxIdFilter()),h(17),V(i.pagedVendors()),h(5),Pt(" \u7B2C ",i.currentPage()," / ",i.totalPages()," \u9801\uFF0C\u5171 ",i.totalRecords()," \u7B46 "),h(2),N("disabled",i.currentPage()===1),h(2),N("disabled",i.currentPage()===i.totalPages()),h(2),F(i.isModalOpen()?50:-1))},dependencies:[oe,$e,je,Fe,ke,xe,Ae,ge,Be,Ol,Vl,Ue,qe,Ee,we],encapsulation:2,changeDetection:0});var om=Hs;var kb=(n,e)=>e.id,Jy=(n,e)=>e.name;function s7(n,e){if(n&1&&(l(0,"option",20),m(1),u()),n&2){let t=e.$implicit;N("value",t.id),h(),E(t.name)}}function a7(n,e){n&1&&(l(0,"div",28),x(1,"ion-icon",36),l(2,"span"),m(3,"\u8F09\u5165\u9032\u8CA8\u55AE\u8CC7\u6599\u4E2D..."),u()())}function l7(n,e){if(n&1&&(l(0,"div",29)(1,"div",12),x(2,"ion-icon",37),l(3,"span"),m(4),u()()()),n&2){let t=C(2);h(4),E(t.shipmentError())}}function u7(n,e){if(n&1&&(m(0),nn(1,"number")),n&2){let t=C().$implicit;L(" ",xn(1,1,t.qty,"1.2-2")," ")}}function c7(n,e){n&1&&m(0," - ")}function d7(n,e){if(n&1&&m(0),n&2){let t=C().$implicit,i=C(2);L(" ",i.formatCurrency(t.unitPrice)," ")}}function f7(n,e){n&1&&m(0," - ")}function m7(n,e){if(n&1&&m(0),n&2){let t=C().$implicit,i=C(2);L(" ",i.formatCurrency(t.lineAmount)," ")}}function p7(n,e){n&1&&m(0," - ")}function g7(n,e){if(n&1){let t=U();l(0,"tr",38),S("click",function(){let r=w(t).$implicit,o=C(2);return T(o.openShipmentEditModal(r))}),l(1,"td",39),m(2),u(),l(3,"td",40),m(4),u(),l(5,"td",39),m(6),u(),l(7,"td",41),P(8,u7,2,4)(9,c7,1,0),u(),l(10,"td",41),m(11),u(),l(12,"td",41),P(13,d7,1,1)(14,f7,1,0),u(),l(15,"td",42),P(16,m7,1,1)(17,p7,1,0),u(),l(18,"td",43),m(19),u()()}if(n&2){let t=e.$implicit,i=C(2);h(2),E(i.formatDate(t.issueDate)),h(2),E(t.vendorName),h(2),E(t.itemName),h(2),F(t.qty!==null?8:9),h(3),E(t.unit||"-"),h(2),F(t.unitPrice!==null?13:14),h(3),F(t.lineAmount!==null?16:17),h(3),E(t.remark||"-")}}function h7(n,e){n&1&&(l(0,"tr")(1,"td",44),m(2,"\u672A\u627E\u5230\u9032\u8CA8\u55AE\u8CC7\u6599\u3002"),u()())}function y7(n,e){if(n&1&&(l(0,"div",6),P(1,a7,4,0,"div",28),P(2,l7,5,1,"div",29),l(3,"div",30)(4,"table",31)(5,"thead",32)(6,"tr")(7,"th",33),m(8,"\u958B\u7ACB\u65E5\u671F"),u(),l(9,"th",33),m(10,"\u5EE0\u5546"),u(),l(11,"th",33),m(12,"\u54C1\u9805\u540D\u7A31"),u(),l(13,"th",34),m(14,"\u6578\u91CF"),u(),l(15,"th",34),m(16,"\u55AE\u4F4D"),u(),l(17,"th",34),m(18,"\u55AE\u50F9"),u(),l(19,"th",34),m(20,"\u5C0F\u8A08"),u(),l(21,"th",33),m(22,"\u5099\u8A3B"),u()()(),l(23,"tbody"),O(24,g7,20,8,"tr",35,_n,!1,h7,3,0,"tr"),u()()()()),n&2){let t=C();h(),F(t.isLoadingShipments()?1:-1),h(),F(!t.isLoadingShipments()&&t.shipmentError()?2:-1),h(22),V(t.pagedShipments())}}function v7(n,e){if(n&1){let t=U();Fi(),l(0,"g",61),S("mouseenter",function(){w(t);let r=C().$implicit,o=C(4);return T(o.hoveredVendor.set(r.name))})("mouseleave",function(){w(t);let r=C(5);return T(r.hoveredVendor.set(null))}),x(1,"path",62),u()}if(n&2){let t=C(),i=t.$implicit,r=t.$index,o=C(4);h(),ft("d",o.getPieSlicePath(r,o.pieChartData()))("fill",o.getPieColor(r,o.pieChartData().length))("opacity",o.hoveredVendor()===i.name?"1":"0.8")("stroke",o.hoveredVendor()===i.name?"#000":"none")}}function _7(n,e){if(n&1&&P(0,v7,2,4,":svg:g"),n&2){let t=e.$implicit;F(t.percentage>0?0:-1)}}function C7(n,e){if(n&1&&(l(0,"div",63)(1,"div",64),m(2),u(),l(3,"div",65),m(4),u(),l(5,"div",66),m(6),nn(7,"number"),u()()),n&2){let t=C().$implicit,i=C(5);h(2),E(t.name),h(2),E(i.formatCurrency(t.amount)),h(2),L("",xn(7,3,t.percentage,"1.1-1"),"%")}}function x7(n,e){if(n&1&&P(0,C7,8,6,"div",63),n&2){let t=e.$implicit,i=C(5);F(t.name===i.hoveredVendor()?0:-1)}}function E7(n,e){if(n&1&&O(0,x7,1,1,null,null,Jy),n&2){let t=C(4);V(t.pieChartData())}}function b7(n,e){n&1&&(l(0,"div",59),m(1,"\u6ED1\u9F20\u79FB\u5230\u5713\u9905\u5716\u5207\u7247\u4EE5\u67E5\u770B\u660E\u7D30"),u())}function S7(n,e){if(n&1&&(l(0,"div",12),x(1,"div",67),l(2,"div",68)(3,"div",69),m(4),u(),l(5,"div",70),m(6),u()()()),n&2){let t=e.$implicit,i=C(4);h(),dn("background-color",i.getVendorColor(t.name)),h(3),E(t.name),h(2),E(i.formatCurrency(t.amount))}}function D7(n,e){if(n&1&&(l(0,"div",53)(1,"div",54),m(2,"\u5EE0\u5546\u9032\u8CA8\u91D1\u984D\u5206\u4F48"),u(),l(3,"div",55)(4,"div",56),Fi(),l(5,"svg",57),O(6,_7,1,1,null,null,Jy),u()(),Vr(),l(8,"div",58),P(9,E7,2,0)(10,b7,2,0,"div",59),u()(),l(11,"div",60),O(12,S7,7,4,"div",12,Jy),u()()),n&2){let t=C(3);h(6),V(t.pieChartData()),h(3),F(t.hoveredVendor()?9:10),h(3),V(t.vendorAmountEntries())}}function w7(n,e){if(n&1&&(l(0,"div",46)(1,"div",47)(2,"div",48),m(3,"\u9032\u8CA8\u9805\u76EE\u6578"),u(),l(4,"div",49),m(5),u()(),l(6,"div",50)(7,"div",51),m(8,"\u9032\u8CA8\u7E3D\u91D1\u984D"),u(),l(9,"div",52),m(10),u()()(),P(11,D7,14,1,"div",53)),n&2){let t=C(2);h(5),E(t.shipmentStats().totalItems),h(5),E(t.formatCurrency(t.shipmentStats().totalAmount)),h(),F(t.vendorAmountEntries().length>0&&t.shipmentStats().totalAmount>0?11:-1)}}function T7(n,e){n&1&&(l(0,"div",45),m(1,"\u5C1A\u7121\u53EF\u5206\u6790\u7684\u9032\u8CA8\u55AE\u8CC7\u6599\u3002"),u())}function I7(n,e){if(n&1&&(l(0,"div",6),P(1,w7,12,3)(2,T7,2,0,"div",45),u()),n&2){let t=C();h(),F(!t.isLoadingShipments()&&!t.shipmentError()&&t.filteredShipments().length>0?1:2)}}function M7(n,e){if(n&1){let t=U();l(0,"div",26)(1,"div",66),m(2),u(),l(3,"div",12)(4,"button",72),S("click",function(){w(t);let r=C(2);return T(r.setShipmentPage(r.shipmentPage()-1))}),m(5,"\u4E0A\u4E00\u9801"),u(),l(6,"button",72),S("click",function(){w(t);let r=C(2);return T(r.setShipmentPage(r.shipmentPage()+1))}),m(7,"\u4E0B\u4E00\u9801"),u()()()}if(n&2){let t=C(2);h(2),Pt(" \u7B2C ",t.shipmentPage()," / ",t.shipmentTotalPages()," \u9801\uFF0C\u5171 ",t.filteredShipments().length," \u7B46 "),h(2),Q("text-gray-400",t.shipmentPage()===1),N("disabled",t.shipmentPage()===1),h(2),Q("text-gray-400",t.shipmentPage()===t.shipmentTotalPages()),N("disabled",t.shipmentPage()===t.shipmentTotalPages())}}function A7(n,e){if(n&1&&Qn(0,M7,8,9,"div",71),n&2){let t=C();N("ngIf",t.shipmentTotalPages()>1)}}function N7(n,e){if(n&1&&(l(0,"option",20),m(1),u()),n&2){let t=e.$implicit;N("value",t.id),h(),E(t.name)}}function R7(n,e){if(n&1){let t=U();l(0,"div",93),x(1,"input",99)(2,"input",100)(3,"input",101),l(4,"span",90),m(5),u(),l(6,"button",102),S("click",function(){let r=w(t).$index,o=C(2);return T(o.removeItem(r))}),x(7,"ion-icon",103),u()()}if(n&2){let t,i=e.$implicit,r=e.$index,o=C(2);N("formGroupName",r),h(5),E(o.formatCurrency((t=i.get("total"))==null?null:t.value))}}function P7(n,e){if(n&1){let t=U();l(0,"div",27)(1,"div",73)(2,"div",74)(3,"h3",75),m(4),u(),l(5,"button",76),S("click",function(){w(t);let r=C();return T(r.closeModal())}),x(6,"ion-icon",77),u()(),l(7,"div",78)(8,"form",79),S("ngSubmit",function(){w(t);let r=C();return T(r.handlePOSubmit())}),l(9,"div",80)(10,"label",81)(11,"span",82),m(12,"\u9032\u8CA8\u55AE\u865F*"),u(),x(13,"input",83),u(),l(14,"label",81)(15,"span",82),m(16,"\u65E5\u671F*"),u(),x(17,"input",84),u()(),l(18,"label",81)(19,"span",82),m(20,"\u5EE0\u5546*"),u(),l(21,"select",85)(22,"option",86),m(23,"\u9078\u64C7\u5EE0\u5546"),u(),O(24,N7,2,2,"option",20,kb),u()(),l(26,"h4",87),m(27,"\u54C1\u9805"),u(),l(28,"div",88)(29,"div",89),m(30,"\u54C1\u9805\u540D\u7A31"),u(),l(31,"div",90),m(32,"\u6578\u91CF"),u(),l(33,"div",90),m(34,"\u55AE\u50F9"),u(),l(35,"div",90),m(36,"\u5C0F\u8A08"),u(),x(37,"div",91),u(),l(38,"div",92),O(39,R7,8,2,"div",93,_n),u(),l(41,"button",94),S("click",function(){w(t);let r=C();return T(r.addItem())}),m(42,"+ \u65B0\u589E\u54C1\u9805"),u(),l(43,"div",95),m(44),u(),l(45,"div",96)(46,"button",97),S("click",function(){w(t);let r=C();return T(r.closeModal())}),m(47,"\u53D6\u6D88"),u(),l(48,"button",98),m(49,"\u5132\u5B58"),u()()()()()()}if(n&2){let t,i=C();h(4),E(i.editingPO()?"\u7DE8\u8F2F\u9032\u8CA8\u55AE":"\u65B0\u589E\u9032\u8CA8\u55AE"),h(4),N("formGroup",i.poForm),h(16),V(i.allVendors()),h(15),V(i.poItems.controls),h(5),L("\u7E3D\u8A08: ",i.formatCurrency((t=i.poForm.get("totalAmount"))==null?null:t.value))}}function F7(n,e){if(n&1){let t=U();l(0,"div",6)(1,"div",80)(2,"label",81)(3,"span",104),m(4,"\u958B\u7ACB\u65E5\u671F*"),u(),l(5,"input",105),ne("ngModelChange",function(r){w(t);let o=C(2);return re(o.editingShipmentItem().issueDate,r)||(o.editingShipmentItem().issueDate=r),T(r)}),u()(),l(6,"label",81)(7,"span",104),m(8,"\u5EE0\u5546*"),u(),l(9,"input",106),ne("ngModelChange",function(r){w(t);let o=C(2);return re(o.editingShipmentItem().vendorName,r)||(o.editingShipmentItem().vendorName=r),T(r)}),u()()(),l(10,"label",81)(11,"span",104),m(12,"\u54C1\u9805\u540D\u7A31*"),u(),l(13,"input",107),ne("ngModelChange",function(r){w(t);let o=C(2);return re(o.editingShipmentItem().itemName,r)||(o.editingShipmentItem().itemName=r),T(r)}),u()(),l(14,"div",108)(15,"label",81)(16,"span",104),m(17,"\u6578\u91CF"),u(),l(18,"input",109),ne("ngModelChange",function(r){w(t);let o=C(2);return re(o.editingShipmentItem().qty,r)||(o.editingShipmentItem().qty=r),T(r)}),u()(),l(19,"label",81)(20,"span",104),m(21,"\u55AE\u4F4D"),u(),l(22,"input",107),ne("ngModelChange",function(r){w(t);let o=C(2);return re(o.editingShipmentItem().unit,r)||(o.editingShipmentItem().unit=r),T(r)}),u()(),l(23,"label",81)(24,"span",104),m(25,"\u55AE\u50F9"),u(),l(26,"input",109),ne("ngModelChange",function(r){w(t);let o=C(2);return re(o.editingShipmentItem().unitPrice,r)||(o.editingShipmentItem().unitPrice=r),T(r)}),u()()(),l(27,"label",81)(28,"span",104),m(29,"\u5C0F\u8A08"),u(),l(30,"input",110),ne("ngModelChange",function(r){w(t);let o=C(2);return re(o.editingShipmentItem().lineAmount,r)||(o.editingShipmentItem().lineAmount=r),T(r)}),u()(),l(31,"label",81)(32,"span",104),m(33,"\u5099\u8A3B"),u(),l(34,"textarea",111),ne("ngModelChange",function(r){w(t);let o=C(2);return re(o.editingShipmentItem().remark,r)||(o.editingShipmentItem().remark=r),T(r)}),u()()(),l(35,"div",96)(36,"button",112),S("click",function(){w(t);let r=C(2);return T(r.closeShipmentEditModal())}),m(37," \u53D6\u6D88 "),u(),l(38,"button",113),S("click",function(){w(t);let r=C(2);return T(r.saveShipmentEdit())}),m(39),u()()}if(n&2){let t=C(2);h(5),te("ngModel",t.editingShipmentItem().issueDate),h(4),te("ngModel",t.editingShipmentItem().vendorName),h(4),te("ngModel",t.editingShipmentItem().itemName),h(5),te("ngModel",t.editingShipmentItem().qty),h(4),te("ngModel",t.editingShipmentItem().unit),h(4),te("ngModel",t.editingShipmentItem().unitPrice),h(4),te("ngModel",t.editingShipmentItem().lineAmount),h(4),te("ngModel",t.editingShipmentItem().remark),h(4),N("disabled",t.isLoadingShipments()),h(),L(" ",t.isLoadingShipments()?"\u4FDD\u5B58\u4E2D...":"\u4FDD\u5B58"," ")}}function k7(n,e){if(n&1){let t=U();l(0,"div",27)(1,"div",73)(2,"div",74)(3,"h3",75),m(4,"\u7DE8\u8F2F\u9032\u8CA8\u55AE\u9805\u76EE"),u(),l(5,"button",76),S("click",function(){w(t);let r=C();return T(r.closeShipmentEditModal())}),x(6,"ion-icon",77),u()(),l(7,"div",78),P(8,F7,40,10),u()()()}if(n&2){let t=C();h(8),F(t.editingShipmentItem()?8:-1)}}var Gs=class Gs{constructor(){this.dataService=R(mt);this.apiService=R(wt);this.fb=R(ze);this.isModalOpen=D(!1);this.isEditModalOpen=D(!1);this.editingShipmentItem=D(null);this.allVendors=D([]);this.allPOs=D([]);this.editingPO=D(null);this.shipmentItems=D([]);this.isLoadingShipments=D(!1);this.shipmentError=D(null);this.poForm=this.fb.group({id:[""],poNumber:["",$.required],vendorId:["",$.required],date:["",$.required],items:this.fb.array([]),totalAmount:[0]});this.poSearchTerm=D("");this.selectedPOVendor=D("");this.today=new Date;this.firstDayOfMonth=new Date(this.today.getFullYear(),this.today.getMonth(),1);this.poStartDate=D(this.formatDateToISO(this.firstDayOfMonth));this.poEndDate=D(this.formatDateToISO(this.today));this.currentTab=D("api");this.shipmentPage=D(1);this.pageSize=20;this.pagedShipments=H(()=>{let e=this.filteredShipments(),t=(this.shipmentPage()-1)*this.pageSize;return e.slice(t,t+this.pageSize)});this.shipmentTotalPages=H(()=>{let e=this.filteredShipments().length;return Math.max(1,Math.ceil(e/this.pageSize))});this.filteredPOs=H(()=>{let e=this.poSearchTerm().toLowerCase(),t=this.selectedPOVendor(),i=this.poStartDate(),r=this.poEndDate(),o=this.allPOs();return t&&(o=o.filter(s=>s.vendorId===t)),i&&(o=o.filter(s=>s.date>=i)),r&&(o=o.filter(s=>s.date<=r)),e&&(o=o.filter(s=>s.poNumber.toLowerCase().includes(e)||this.getVendorName(s.vendorId).toLowerCase().includes(e))),o});this.filteredShipments=H(()=>{let e=this.poSearchTerm().toLowerCase(),t=this.selectedPOVendor(),i=this.poStartDate(),r=this.poEndDate(),o=this.shipmentItems();return t&&(o=o.filter(s=>s.vendorId.toString()===t)),i&&(o=o.filter(s=>s.issueDate>=i)),r&&(o=o.filter(s=>s.issueDate<=r)),e&&(o=o.filter(s=>(s.documentNo?.toLowerCase().includes(e)??!1)||s.itemName.toLowerCase().includes(e)||s.vendorName.toLowerCase().includes(e))),o});this.shipmentStats=H(()=>{let e=this.filteredShipments(),t=e.reduce((r,o)=>r+Number(o.lineAmount||0),0),i={};return e.forEach(r=>{let o=r.vendorName;i[o]=(i[o]||0)+Number(r.lineAmount||0)}),{totalAmount:t,totalItems:e.length,vendorAmounts:i}});this.pieChartData=H(()=>{let e=this.shipmentStats(),t=Object.keys(e.vendorAmounts).sort(),i=e.totalAmount;return t.map(r=>({name:r,amount:e.vendorAmounts[r],percentage:i>0?e.vendorAmounts[r]/i*100:0}))});this.hoveredVendor=D(null);this.vendorAmountEntries=H(()=>{let e=this.shipmentStats();return Object.entries(e.vendorAmounts).map(([t,i])=>({name:t,amount:i})).sort((t,i)=>i.amount-t.amount)});this.loadData(),this.loadShipments(),this.poItems.valueChanges.subscribe(e=>{let t=e.reduce((i,r)=>i+(r.quantity||0)*(r.unitPrice||0),0);this.poForm.get("totalAmount")?.setValue(t,{emitEvent:!1})})}setShipmentPage(e){e<1||e>this.shipmentTotalPages()||this.shipmentPage.set(e)}setTab(e){this.currentTab.set(e)}loadData(){this.allVendors.set(this.dataService.getVendors()),this.allPOs.set(this.dataService.getPurchaseOrders())}async loadShipments(){this.isLoadingShipments.set(!0),this.shipmentError.set(null);try{let e={limit:1e3,offset:0};this.poStartDate()&&(e.startDate=this.poStartDate()),this.poEndDate()&&(e.endDate=this.poEndDate());let t=await this.apiService.getShipmentItems(e);t.success&&t.data?this.shipmentItems.set(t.data):this.shipmentError.set(t.error||"\u7121\u6CD5\u7372\u53D6\u9032\u8CA8\u55AE\u8CC7\u6599")}catch(e){console.error("Error loading shipments:",e),this.shipmentError.set("\u8F09\u5165\u9032\u8CA8\u55AE\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoadingShipments.set(!1)}}async applyShipmentFilter(){await this.loadShipments(),this.shipmentPage.set(1)}resetPOFilters(){this.poSearchTerm.set(""),this.selectedPOVendor.set(""),this.poStartDate.set(""),this.poEndDate.set("")}openModal(e=null){this.editingPO.set(e),this.poForm.reset({totalAmount:0}),this.poItems.clear(),e&&(this.poForm.patchValue(e),e.items.forEach(t=>this.addItem(t.productName,t.quantity,t.unitPrice))),this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1),this.editingPO.set(null)}openShipmentEditModal(e){this.editingShipmentItem.set(e),this.isEditModalOpen.set(!0)}closeShipmentEditModal(){this.isEditModalOpen.set(!1),this.editingShipmentItem.set(null)}async saveShipmentEdit(){let e=this.editingShipmentItem();if(e)try{this.isLoadingShipments.set(!0);let t=await this.apiService.updateShipmentItem(e.shipment_id,{itemName:e.itemName,qty:e.qty||void 0,unitPrice:e.unitPrice||void 0,unit:e.unit||void 0,remark:e.remark||void 0});if(t.success&&t.data){let i=this.shipmentItems().map(r=>r.shipment_id===e.shipment_id?t.data:r);this.shipmentItems.set(i),this.shipmentPage.set(1),this.closeShipmentEditModal(),alert("\u9032\u8CA8\u55AE\u9805\u76EE\u5DF2\u6210\u529F\u66F4\u65B0")}else throw new Error(t.error||"\u66F4\u65B0\u5931\u6557")}catch(t){console.error("Error saving shipment item:",t),alert("\u4FDD\u5B58\u9032\u8CA8\u55AE\u9805\u76EE\u5931\u6557\uFF1A"+(t instanceof Error?t.message:"\u672A\u77E5\u932F\u8AA4"))}finally{this.isLoadingShipments.set(!1)}}createItem(e="",t=1,i=0){let r=this.fb.group({productName:[e,$.required],quantity:[t,[$.required,$.min(1)]],unitPrice:[i,[$.required,$.min(0)]],total:[t*i]});return r.get("quantity")?.valueChanges.subscribe(()=>this.updateItemTotal(r)),r.get("unitPrice")?.valueChanges.subscribe(()=>this.updateItemTotal(r)),r}updateItemTotal(e){let t=e.get("quantity")?.value||0,i=e.get("unitPrice")?.value||0;e.get("total")?.setValue(t*i,{emitEvent:!1})}addItem(e="",t=1,i=0){this.poItems.push(this.createItem(e,t,i))}removeItem(e){this.poItems.removeAt(e)}handlePOSubmit(){if(this.poForm.invalid)return;let e=this.poForm.getRawValue(),t={poNumber:e.poNumber,vendorId:e.vendorId,date:e.date,items:e.items,totalAmount:e.totalAmount};this.editingPO()?this.dataService.updatePurchaseOrder(q(k({},t),{id:this.editingPO().id})):this.dataService.addPurchaseOrder(t),this.loadData(),this.closeModal()}deletePurchaseOrder(e){confirm("\u78BA\u5B9A\u8981\u522A\u9664\u6B64\u9032\u8CA8\u55AE\u55CE\uFF1F")&&(this.dataService.deletePurchaseOrder(e),this.loadData())}getVendorName(e){let t=e.toString();return this.allVendors().find(i=>i.id===t)?.name||"N/A"}formatCurrency(e){return e==null?"":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}formatDate(e){if(!e)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;let t=new Date(e);return Number.isNaN(t.getTime())?"":this.formatDateToISO(t)}formatDateToISO(e){let t=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return`${t}-${i}-${r}`}get poItems(){return this.poForm.get("items")}getPieColor(e,t){let i=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#EC4899","#14B8A6","#F97316","#6366F1","#06B6D4","#84CC16","#D946EF"];return i[e%i.length]}getVendorColor(e){let t=this.pieChartData(),i=t.findIndex(r=>r.name===e);return i<0?"#9CA3AF":this.getPieColor(i,t.length)}getPieSlicePath(e,t){let s=0;for(let M=0;M<e;M++)s+=t[M].percentage*360/100;let a=t[e].percentage*360/100,c=s+a,d=s*Math.PI/180,g=c*Math.PI/180,y=200+120*Math.cos(d),v=200+120*Math.sin(d),_=200+120*Math.cos(g),b=200+120*Math.sin(g),I=a>180?1:0;return`M 200 200 L ${y} ${v} A 120 120 0 ${I} 1 ${_} ${b} Z`}};Gs.\u0275fac=function(t){return new(t||Gs)},Gs.\u0275cmp=ee({type:Gs,selectors:[["app-purchase-orders"]],decls:43,vars:17,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","add-outline"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"space-y-4"],[1,"flex","border-b","border-gray-200","gap-2","mb-4"],["type","button",1,"pb-2","px-4","font-medium","border-b-2","border-transparent","hover:text-indigo-600",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4","p-4","bg-gray-50","rounded-lg"],[1,"lg:col-span-4"],["type","text","placeholder","\u641C\u5C0B\u9032\u8CA8\u55AE\u865F\u3001\u54C1\u9805\u6216\u5EE0\u5546...",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"flex","items-center","gap-2"],["for","poStartDate",1,"text-sm","font-medium","text-gray-600","shrink-0"],["type","date","id","poStartDate",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["for","poEndDate",1,"text-sm","font-medium","text-gray-600","shrink-0"],["type","date","id","poEndDate",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"lg:col-span-2"],[1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"flex","items-center","gap-2","lg:col-span-4","justify-end","gap-2"],["title","\u5957\u7528\u7BE9\u9078",1,"bg-indigo-600","text-white","px-3","py-1","rounded","text-sm","hover:bg-indigo-700","transition-colors","flex","items-center","gap-1",3,"click"],["name","checkmark-outline"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"flex","flex-col","sm:flex-row","justify-between","items-center","gap-3","mt-4"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"flex","items-center","justify-center","py-12","text-gray-500"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4","text-red-700"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-4","py-3"],[1,"px-4","py-3","text-right"],[1,"border-b","hover:bg-gray-50","cursor-pointer"],["name","refresh-outline",1,"text-3xl","animate-spin","mr-2"],["name","alert-circle-outline",1,"text-xl"],[1,"border-b","hover:bg-gray-50","cursor-pointer",3,"click"],[1,"px-4","py-2"],[1,"px-4","py-2","font-medium"],[1,"px-4","py-2","text-right"],[1,"px-4","py-2","text-right","font-semibold"],[1,"px-4","py-2","text-gray-600","text-xs"],["colspan","8",1,"text-center","py-8","text-gray-500"],[1,"text-center","py-8","text-gray-500"],[1,"grid","grid-cols-2","gap-4","mb-4"],[1,"bg-blue-50","p-3","rounded-lg"],[1,"text-xs","text-blue-600","font-medium"],[1,"text-xl","font-bold","text-blue-900"],[1,"bg-purple-50","p-3","rounded-lg"],[1,"text-xs","text-purple-600","font-medium"],[1,"text-xl","font-bold","text-purple-900"],[1,"bg-gray-50","p-4","rounded-lg"],[1,"text-xs","text-gray-600","font-medium","mb-4"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-4","items-center"],[1,"flex","items-center","justify-center","lg:col-span-2"],["viewBox","0 0 400 400",1,"w-64","h-64"],[1,"lg:col-span-1"],[1,"text-sm","text-gray-500"],[1,"mt-4","grid","grid-cols-2","md:grid-cols-3","gap-2","text-xs"],[3,"mouseenter","mouseleave"],["stroke-width","2",1,"cursor-pointer","transition-opacity"],[1,"bg-white","border","border-gray-200","rounded-lg","p-3","shadow-sm"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-lg","font-bold","text-blue-600"],[1,"text-sm","text-gray-600"],[1,"w-3","h-3","rounded-full"],[1,"truncate"],[1,"font-medium"],[1,"text-gray-600"],["class","flex flex-col sm:flex-row justify-between items-center gap-3 mt-4",4,"ngIf"],[1,"px-2","py-1","rounded","border","text-sm",3,"click","disabled"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-2xl","max-h-[90vh]","flex","flex-col"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"block"],[1,"text-gray-700"],["formControlName","poNumber",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["type","date","formControlName","date",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","vendorId",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["value","","disabled",""],[1,"font-semibold","pt-4","border-t"],[1,"grid","grid-cols-12","gap-2","px-2","pb-1","text-xs","font-medium","text-gray-500"],[1,"col-span-5"],[1,"col-span-2","text-right"],[1,"col-span-1"],["formArrayName","items",1,"space-y-2"],[1,"grid","grid-cols-12","gap-2","items-center","p-2","rounded-md","bg-gray-50",3,"formGroupName"],["type","button",1,"text-indigo-600","text-sm",3,"click"],[1,"text-right","font-bold","text-lg"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md"],["formControlName","productName","placeholder","\u54C1\u9805\u540D\u7A31",1,"col-span-5","p-1","border","border-gray-300","bg-white","rounded-md","shadow-sm"],["type","number","formControlName","quantity","placeholder","\u6578\u91CF",1,"col-span-2","p-1","border","border-gray-300","bg-white","rounded-md","shadow-sm","text-right"],["type","number","formControlName","unitPrice","placeholder","\u55AE\u50F9",1,"col-span-2","p-1","border","border-gray-300","bg-white","rounded-md","shadow-sm","text-right"],["type","button",1,"col-span-1","text-red-500",3,"click"],["name","remove-circle-outline"],[1,"text-gray-700","text-sm"],["type","date","disabled","",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","bg-gray-100","p-2","cursor-not-allowed","text-gray-600",3,"ngModelChange","ngModel"],["type","text","disabled","",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","bg-gray-100","p-2","cursor-not-allowed","text-gray-600",3,"ngModelChange","ngModel"],["type","text",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","bg-white","p-2",3,"ngModelChange","ngModel"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],["type","number",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","bg-white","p-2","text-right",3,"ngModelChange","ngModel"],["type","number","disabled","",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","bg-gray-100","p-2","text-right","cursor-not-allowed","text-gray-600",3,"ngModelChange","ngModel"],["rows","3",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","bg-white","p-2",3,"ngModelChange","ngModel"],["type","button",1,"px-4","py-2","border","border-gray-300","rounded-md","hover:bg-gray-50",3,"click"],["type","button",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","hover:bg-indigo-700","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"]],template:function(t,i){t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),m(3,"\u9032\u8CA8\u55AE\u7BA1\u7406"),u(),l(4,"button",3),S("click",function(){return i.openModal()}),x(5,"ion-icon",4),l(6,"span"),m(7,"\u65B0\u589E\u9032\u8CA8\u55AE"),u()()(),l(8,"div",5)(9,"div",6)(10,"div",7)(11,"button",8),S("click",function(){return i.setTab("api")}),m(12," \u9032\u8CA8\u55AE\u8CC7\u6599 "),u(),l(13,"button",8),S("click",function(){return i.setTab("analysis")}),m(14," \u9032\u8CA8\u5206\u6790 "),u()(),l(15,"div",9)(16,"div",10)(17,"input",11),S("ngModelChange",function(o){return i.poSearchTerm.set(o)}),u()(),l(18,"div",12)(19,"label",13),m(20,"\u5F9E:"),u(),l(21,"input",14),S("ngModelChange",function(o){return i.poStartDate.set(o)}),u()(),l(22,"div",12)(23,"label",15),m(24,"\u81F3:"),u(),l(25,"input",16),S("ngModelChange",function(o){return i.poEndDate.set(o)}),u()(),l(26,"div",17)(27,"select",18),S("ngModelChange",function(o){return i.selectedPOVendor.set(o)}),l(28,"option",19),m(29,"\u6240\u6709\u5EE0\u5546"),u(),O(30,s7,2,2,"option",20,kb),u()(),l(32,"div",21)(33,"button",22),S("click",function(){return i.applyShipmentFilter()}),x(34,"ion-icon",23),m(35," \u5957\u7528 "),u(),l(36,"button",24),S("click",function(){return i.resetPOFilters()}),x(37,"ion-icon",25),u()()(),P(38,y7,27,3,"div",6),P(39,I7,3,1,"div",6),P(40,A7,1,1,"div",26),u()()(),P(41,P7,50,3,"div",27),P(42,k7,9,1,"div",27)),t&2&&(h(11),Q("border-indigo-600",i.currentTab()==="api")("text-indigo-600",i.currentTab()==="api"),h(2),Q("border-indigo-600",i.currentTab()==="analysis")("text-indigo-600",i.currentTab()==="analysis"),h(4),N("ngModel",i.poSearchTerm()),h(4),N("ngModel",i.poStartDate()),h(4),N("ngModel",i.poEndDate()),h(2),N("ngModel",i.selectedPOVendor()),h(3),V(i.allVendors()),h(8),F(i.currentTab()==="api"?38:-1),h(),F(i.currentTab()==="analysis"?39:-1),h(),F(i.currentTab()==="api"?40:-1),h(),F(i.isModalOpen()?41:-1),h(),F(i.isEditModalOpen()?42:-1))},dependencies:[oe,Kr,$e,je,Fe,ke,xe,$t,Ae,ge,Be,Ue,qe,Ei,bi,Ee,we,Qa],encapsulation:2,changeDetection:0});var sm=Gs;var O7=(n,e)=>e.name,V7=(n,e)=>e.month,L7=(n,e)=>e.id;function B7(n,e){if(n&1&&(l(0,"option",7),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),L("",t,"\u5E74")}}function U7(n,e){if(n&1&&(l(0,"option",7),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),L("",t,"\u6708")}}function $7(n,e){if(n&1){let t=U();l(0,"tr",36),S("click",function(){let r=w(t).$implicit,o=C();return T(o.openHistoryModal(r))}),l(1,"td",37),m(2),u(),l(3,"td",33),m(4),u(),l(5,"td",33),m(6),u(),l(7,"td",33),m(8),u()()}if(n&2){let t=e.$implicit,i=C();h(2),E(t.name),h(2),E(i.formatCurrency(t.currentMonthRebate)),h(2),E(i.formatCurrency(t.unpaidRebate)),h(2),E(i.formatCurrency(t.cumulativeRebate))}}function H7(n,e){n&1&&(l(0,"tr")(1,"td",38),m(2," \u76EE\u524D\u6C92\u6709\u80A1\u6771\u56DE\u994B\u91D1\u8CC7\u6599\u3002 "),u()())}function G7(n,e){if(n&1){let t=U();l(0,"tr",36),S("click",function(){let r=w(t).$implicit,o=C(2);return T(o.openDetailModal(r))}),l(1,"td",50),m(2),u(),l(3,"td",49),m(4),u(),l(5,"td",49),m(6),u()()}if(n&2){let t=e.$implicit,i=C(2);h(2),yt("",t.year,"/",t.month),h(2),E(i.formatCurrency(t.totalRebate)),h(2),E(i.formatCurrency(t.unpaidRebate))}}function q7(n,e){n&1&&(l(0,"tr")(1,"td",51),m(2,"\u7121\u6B77\u53F2\u7D00\u9304"),u()())}function W7(n,e){if(n&1){let t=U();l(0,"div",39),S("click",function(){w(t);let r=C();return T(r.closeHistoryModal())}),l(1,"div",40),S("click",function(r){return w(t),T(r.stopPropagation())}),l(2,"div",41)(3,"h3",42),m(4),u(),l(5,"button",43),S("click",function(){w(t);let r=C();return T(r.closeHistoryModal())}),x(6,"ion-icon",44),u()(),l(7,"div",45)(8,"table",46)(9,"thead",47)(10,"tr")(11,"th",48),m(12,"\u6708\u4EFD"),u(),l(13,"th",49),m(14,"\u56DE\u994B\u91D1\u7E3D\u984D"),u(),l(15,"th",49),m(16,"\u672A\u4ED8\u91D1\u984D"),u()()(),l(17,"tbody"),O(18,G7,7,4,"tr",29,V7,!1,q7,3,0,"tr"),u()()()()()}if(n&2){let t=C();h(4),L("\u56DE\u994B\u91D1\u7D00\u9304 - ",e.name),h(14),V(t.monthlyHistory())}}function j7(n,e){n&1&&x(0,"ion-icon",66)}function z7(n,e){n&1&&x(0,"input",67)}function Y7(n,e){if(n&1&&m(0),n&2){let t=C().$implicit,i=C(2);L(" ",i.formatCurrency(t.invoiceAmount)," ")}}function J7(n,e){n&1&&x(0,"input",68)}function K7(n,e){if(n&1&&m(0),n&2){let t=C().$implicit;L(" ",t.rebatePercentage,"% ")}}function Q7(n,e){if(n&1){let t=U();l(0,"div",70)(1,"button",72),S("click",function(){w(t);let r=C(3);return T(r.saveEditing())}),x(2,"ion-icon",73),u(),l(3,"button",74),S("click",function(){w(t);let r=C(3);return T(r.cancelEditing())}),x(4,"ion-icon",75),u()()}}function Z7(n,e){if(n&1){let t=U();l(0,"button",76),S("click",function(){w(t);let r=C().$implicit,o=C(2);return T(o.startEditing(r))}),x(1,"ion-icon",77),u()}}function X7(n,e){if(n&1&&(l(0,"tr",65)(1,"td",58),P(2,j7,1,0,"ion-icon",66),u(),l(3,"td",56),m(4),u(),l(5,"td",56),m(6),u(),l(7,"td",57),P(8,z7,1,0,"input",67)(9,Y7,1,1),u(),l(10,"td",58),P(11,J7,1,0,"input",68)(12,K7,1,1),u(),l(13,"td",69),m(14),u(),l(15,"td",56),m(16),u(),l(17,"td",58),P(18,Q7,5,0,"div",70)(19,Z7,2,0,"button",71),u()()),n&2){let t=e.$implicit,i=C(2);Q("bg-yellow-50",t.isEdited),h(2),F(t.isEdited?2:-1),h(2),E(t.checkoutTime),h(2),E(t.discountDetails),h(2),F(i.editingTxId()===t.id?8:9),h(3),F(i.editingTxId()===t.id?11:12),h(3),E(i.formatCurrency(t.rebateAmount)),h(2),E(t.discountUsed),h(2),F(i.editingTxId()===t.id?18:19)}}function e9(n,e){n&1&&(l(0,"tr")(1,"td",78),m(2,"\u6B64\u6708\u4EFD\u7121\u56DE\u994B\u91D1\u660E\u7D30"),u()())}function t9(n,e){if(n&1){let t=U();l(0,"div",52),S("click",function(){w(t);let r=C();return T(r.closeDetailModal())}),l(1,"div",53),S("click",function(r){return w(t),T(r.stopPropagation())}),l(2,"div",41)(3,"h3",42),m(4),u(),l(5,"button",43),S("click",function(){w(t);let r=C();return T(r.closeDetailModal())}),x(6,"ion-icon",44),u()(),l(7,"div",54)(8,"table",25)(9,"thead",26)(10,"tr"),x(11,"th",55),l(12,"th",56),m(13,"\u7D50\u5E33\u6642\u9593"),u(),l(14,"th",56),m(15,"\u6298\u6263\u91D1\u984D\u7D30\u9805"),u(),l(16,"th",57),m(17,"\u767C\u7968\u91D1\u984D"),u(),l(18,"th",58),m(19,"\u56DE\u994B%"),u(),l(20,"th",57),m(21,"\u56DE\u994B\u91D1"),u(),l(22,"th",56),m(23,"\u4F7F\u7528\u6298\u6263"),u(),l(24,"th",59),m(25,"\u64CD\u4F5C"),u()()(),l(26,"tbody"),O(27,X7,20,10,"tr",60,L7,!1,e9,3,0,"tr"),u(),l(30,"tfoot",61)(31,"tr")(32,"td",62),m(33,"\u7E3D\u56DE\u994B\u91D1:"),u(),l(34,"td",63),m(35),u(),x(36,"td",64),u()()()()()()}if(n&2){let t,i=e,r=C();h(4),Pt("\u56DE\u994B\u91D1\u660E\u7D30 - ",(t=r.selectedShareholder())==null?null:t.name," (",i.year,"/",i.month,")"),h(3),N("formGroup",r.editForm),h(20),V(r.rebateTransactions()),h(8),E(r.formatCurrency(r.detailModalTotal()))}}var qs=class qs{constructor(){this.dataService=R(mt);this.fb=R(ze);this.rebates=D([]);this.availableYears=D([2024,2025,2026]);this.availableMonths=D(Array.from({length:12},(e,t)=>t+1));this.selectedYear=D(2024);this.selectedMonth=D(8);this.selectedShareholder=D(null);this.isHistoryModalOpen=D(!1);this.monthlyHistory=D([]);this.selectedHistoryEntry=D(null);this.isDetailModalOpen=D(!1);this.rebateTransactions=D([]);this.editingTxId=D(null);this.editForm=this.fb.group({invoiceAmount:[0,[$.required,$.min(0)]],rebatePercentage:[0,[$.required,$.min(0),$.max(100)]]});this.totals=H(()=>{let e=this.rebates();return{currentMonth:e.reduce((t,i)=>t+i.currentMonthRebate,0),unpaid:e.reduce((t,i)=>t+i.unpaidRebate,0),cumulative:e.reduce((t,i)=>t+i.cumulativeRebate,0)}});this.detailModalTotal=H(()=>this.rebateTransactions().reduce((e,t)=>e+t.rebateAmount,0));this.applyFilter()}applyFilter(){this.rebates.set(this.dataService.getShareholderRebates(this.selectedYear(),this.selectedMonth()))}resetFilter(){this.selectedYear.set(2024),this.selectedMonth.set(8),this.applyFilter()}openHistoryModal(e){this.selectedShareholder.set(e),this.monthlyHistory.set(this.dataService.getMonthlyRebateHistory(e.name)),this.isHistoryModalOpen.set(!0)}closeHistoryModal(){this.isHistoryModalOpen.set(!1),this.selectedShareholder.set(null),this.monthlyHistory.set([])}openDetailModal(e){let t=this.selectedShareholder()?.name;t&&(this.selectedHistoryEntry.set(e),this.rebateTransactions.set(this.dataService.getRebateTransactions(t,e.year,e.month)),this.isDetailModalOpen.set(!0))}closeDetailModal(){this.isDetailModalOpen.set(!1),this.selectedHistoryEntry.set(null),this.rebateTransactions.set([]),this.editingTxId.set(null)}startEditing(e){this.editingTxId.set(e.id),this.editForm.setValue({invoiceAmount:e.invoiceAmount,rebatePercentage:e.rebatePercentage})}cancelEditing(){this.editingTxId.set(null)}saveEditing(){let e=this.editingTxId(),t=this.rebateTransactions().find(s=>s.id===e);if(!e||!t||this.editForm.invalid)return;let i=this.editForm.value,r=Math.round(i.invoiceAmount*i.rebatePercentage/100),o=q(k({},t),{invoiceAmount:i.invoiceAmount,rebatePercentage:i.rebatePercentage,rebateAmount:r});this.dataService.updateRebateTransaction(o),this.refreshModalData(),this.editingTxId.set(null)}refreshModalData(){let e=this.selectedHistoryEntry(),t=this.selectedShareholder();e&&t&&this.rebateTransactions.set(this.dataService.getRebateTransactions(t.name,e.year,e.month)),t&&this.monthlyHistory.set(this.dataService.getMonthlyRebateHistory(t.name))}formatCurrency(e){return e==null?"":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}};qs.\u0275fac=function(t){return new(t||qs)},qs.\u0275cmp=ee({type:qs,selectors:[["app-shareholder-rebates"]],decls:75,vars:11,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"flex","flex-col","sm:flex-row","items-center","gap-2","bg-white","p-3","rounded-xl","shadow-md","border","border-gray-200"],[1,"flex","items-center","gap-2"],[1,"text-sm","font-medium","text-gray-600"],[1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100","pr-8",3,"ngModelChange","ngModel"],[3,"value"],[1,"flex","items-center","gap-2","mt-2","sm:mt-0"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","filter-outline"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],[1,"bg-white","p-6","rounded-xl","shadow-md","flex","items-center","space-x-4"],[1,"bg-green-100","p-3","rounded-full"],["name","cash-outline",1,"text-2xl","text-green-600"],[1,"text-sm","text-gray-500"],[1,"text-2xl","font-semibold","text-gray-900"],[1,"bg-yellow-100","p-3","rounded-full"],["name","wallet-outline",1,"text-2xl","text-yellow-600"],[1,"bg-indigo-100","p-3","rounded-full"],["name","server-outline",1,"text-2xl","text-indigo-600"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-6","py-3"],[1,"px-6","py-3","text-right"],[1,"border-b","hover:bg-gray-50","cursor-pointer"],[1,"font-bold","bg-gray-100","text-base"],[1,"border-t-2"],[1,"px-6","py-4"],[1,"px-6","py-4","text-right"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-40"],[1,"fixed","inset-0","bg-black","bg-opacity-60","flex","items-center","justify-center","z-50"],[1,"border-b","hover:bg-gray-50","cursor-pointer",3,"click"],[1,"px-6","py-4","font-medium","text-gray-900"],["colspan","4",1,"text-center","py-8","text-gray-500"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-40",3,"click"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-2xl","max-h-[90vh]","flex","flex-col","m-4",3,"click"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],[1,"w-full","text-sm","text-left"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50"],[1,"px-4","py-2"],[1,"px-4","py-2","text-right"],[1,"px-4","py-2","font-medium"],["colspan","3",1,"text-center","py-6","text-gray-500"],[1,"fixed","inset-0","bg-black","bg-opacity-60","flex","items-center","justify-center","z-50",3,"click"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-5xl","max-h-[90vh]","flex","flex-col","m-4",3,"click"],[1,"p-6","overflow-y-auto",3,"formGroup"],[1,"px-2","py-2","w-12"],[1,"px-2","py-2"],[1,"px-2","py-2","text-right"],[1,"px-2","py-2","text-center"],[1,"px-2","py-2","w-24","text-center"],[1,"border-b",3,"bg-yellow-50"],[1,"font-bold","bg-gray-100"],["colspan","5",1,"px-2","py-3","text-right"],[1,"px-2","py-3","text-right"],["colspan","2"],[1,"border-b"],["name","pencil-outline","title","\u5DF2\u7DE8\u8F2F",1,"text-yellow-600"],["type","number","formControlName","invoiceAmount",1,"w-24","p-1","text-right","border","rounded-md","bg-white"],["type","number","formControlName","rebatePercentage",1,"w-16","p-1","text-right","border","rounded-md","bg-white"],[1,"px-2","py-2","text-right","font-semibold"],[1,"flex","items-center","justify-center","gap-1"],["title","\u7DE8\u8F2F",1,"text-indigo-600","p-1","hover:bg-indigo-100","rounded-full"],["title","\u5132\u5B58",1,"text-green-600","p-1","hover:bg-green-100","rounded-full",3,"click"],["name","checkmark-circle-outline",1,"text-xl"],["title","\u53D6\u6D88",1,"text-gray-500","p-1","hover:bg-gray-100","rounded-full",3,"click"],["name","close-circle-outline",1,"text-xl"],["title","\u7DE8\u8F2F",1,"text-indigo-600","p-1","hover:bg-indigo-100","rounded-full",3,"click"],["name","create-outline",1,"text-xl"],["colspan","8",1,"text-center","py-6","text-gray-500"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),m(3,"\u80A1\u6771\u56DE\u994B\u91D1"),u(),l(4,"div",3)(5,"div",4)(6,"label",5),m(7,"\u6642\u9593:"),u(),l(8,"select",6),ne("ngModelChange",function(o){return re(i.selectedYear,o)||(i.selectedYear=o),o}),O(9,B7,2,2,"option",7,W),u(),l(11,"select",6),ne("ngModelChange",function(o){return re(i.selectedMonth,o)||(i.selectedMonth=o),o}),O(12,U7,2,2,"option",7,W),u()(),l(14,"div",8)(15,"button",9),S("click",function(){return i.applyFilter()}),x(16,"ion-icon",10),l(17,"span"),m(18,"\u5957\u7528"),u()(),l(19,"button",11),S("click",function(){return i.resetFilter()}),x(20,"ion-icon",12),u()()()(),l(21,"div",13)(22,"div",14)(23,"div",15),x(24,"ion-icon",16),u(),l(25,"div")(26,"p",17),m(27,"\u7576\u6708\u56DE\u994B\u91D1 \u7E3D\u8A08"),u(),l(28,"p",18),m(29),u()()(),l(30,"div",14)(31,"div",19),x(32,"ion-icon",20),u(),l(33,"div")(34,"p",17),m(35,"\u7D2F\u8A08\u672A\u4ED8\u56DE\u994B\u91D1 \u7E3D\u8A08"),u(),l(36,"p",18),m(37),u()()(),l(38,"div",14)(39,"div",21),x(40,"ion-icon",22),u(),l(41,"div")(42,"p",17),m(43,"\u7D2F\u8A08\u7E3D\u56DE\u994B\u91D1 \u7E3D\u8A08"),u(),l(44,"p",18),m(45),u()()()(),l(46,"div",23)(47,"div",24)(48,"table",25)(49,"thead",26)(50,"tr")(51,"th",27),m(52,"\u540D\u7A31"),u(),l(53,"th",28),m(54,"\u7576\u6708\u56DE\u994B\u91D1"),u(),l(55,"th",28),m(56,"\u672A\u4ED8\u56DE\u994B\u91D1"),u(),l(57,"th",28),m(58,"\u7D2F\u8A08\u7E3D\u56DE\u994B\u91D1"),u()()(),l(59,"tbody"),O(60,$7,9,4,"tr",29,O7,!1,H7,3,0,"tr"),u(),l(63,"tfoot",30)(64,"tr",31)(65,"td",32),m(66,"\u7E3D\u8A08"),u(),l(67,"td",33),m(68),u(),l(69,"td",33),m(70),u(),l(71,"td",33),m(72),u()()()()()()(),P(73,W7,21,2,"div",34),P(74,t9,37,6,"div",35)),t&2){let r,o;h(8),te("ngModel",i.selectedYear),h(),V(i.availableYears()),h(2),te("ngModel",i.selectedMonth),h(),V(i.availableMonths()),h(17),E(i.formatCurrency(i.totals().currentMonth)),h(8),E(i.formatCurrency(i.totals().unpaid)),h(8),E(i.formatCurrency(i.totals().cumulative)),h(15),V(i.rebates()),h(8),E(i.formatCurrency(i.totals().currentMonth)),h(2),E(i.formatCurrency(i.totals().unpaid)),h(2),E(i.formatCurrency(i.totals().cumulative)),h(),F((r=i.isHistoryModalOpen()&&i.selectedShareholder())?73:-1,r),h(),F((o=i.isDetailModalOpen()&&i.selectedHistoryEntry())?74:-1,o)}},dependencies:[oe,Ee,Fe,ke,xe,$t,Ae,ge,Be,we,$e,Ue,qe],encapsulation:2,changeDetection:0});var am=qs;var n9=(n,e)=>e.id;function i9(n,e){if(n&1&&(l(0,"li"),m(1),u()),n&2){let t=C().$implicit;h(),E(t)}}function r9(n,e){if(n&1&&P(0,i9,2,1,"li"),n&2){let t=e.$implicit;F(t.trim()?0:-1)}}function o9(n,e){if(n&1&&(l(0,"div",28)(1,"h4",31),x(2,"ion-icon",32),m(3,"\u884C\u52D5\u4E8B\u9805"),u(),l(4,"ul",33),O(5,r9,1,1,null,null,W),u()()),n&2){let t=C(2).$implicit;h(5),V(t.actionItems.split(`
`))}}function s9(n,e){if(n&1&&(l(0,"li"),m(1),u()),n&2){let t=C().$implicit;h(),E(t)}}function a9(n,e){if(n&1&&P(0,s9,2,1,"li"),n&2){let t=e.$implicit;F(t.trim()?0:-1)}}function l9(n,e){if(n&1&&(l(0,"div",22)(1,"div",23)(2,"div",24)(3,"h4",25),x(4,"ion-icon",26),m(5,"\u8207\u6703\u4EBA\u54E1"),u(),l(6,"p",27),m(7),u()(),P(8,o9,7,0,"div",28),l(9,"div",24)(10,"h4",25),x(11,"ion-icon",29),m(12,"\u6703\u8B70\u8A18\u9304"),u(),l(13,"ul",30),O(14,a9,1,1,null,null,W),u()()()()),n&2){let t=C().$implicit;h(7),E(t.attendees),h(),F(t.actionItems?8:-1),h(6),V(t.notes.split(`
`))}}function u9(n,e){if(n&1){let t=U();l(0,"div",6)(1,"div",9),S("click",function(){let r=w(t).$implicit,o=C();return T(o.toggleMeeting(r.id))}),l(2,"div",10)(3,"div",11)(4,"p",12),m(5),nn(6,"date"),u(),l(7,"p",13),m(8),nn(9,"date"),u()(),l(10,"div")(11,"p",14),m(12),nn(13,"date"),u(),l(14,"h3",15),m(15),u()()(),l(16,"div",16)(17,"button",17),S("click",function(r){let o=w(t).$implicit,s=C();return r.stopPropagation(),T(s.openModal(o))}),x(18,"ion-icon",18),u(),l(19,"button",19),S("click",function(r){let o=w(t).$implicit,s=C();return r.stopPropagation(),T(s.requestDelete(o))}),x(20,"ion-icon",20),u(),x(21,"ion-icon",21),u()(),P(22,l9,16,2,"div",22),u()}if(n&2){let t=e.$implicit,i=C();h(5),E(xn(6,7,t.date,"MMM")),h(3),E(xn(9,10,t.date,"dd")),h(4),E(xn(13,13,t.date,"fullDate")),h(3),E(t.title),h(6),Q("rotate-180",i.openMeetingId()===t.id),h(),F(i.openMeetingId()===t.id?22:-1)}}function c9(n,e){n&1&&(l(0,"div",7),m(1," \u5C1A\u7121\u6703\u8B70\u7D00\u9304\uFF0C\u9EDE\u64CA\u300C\u65B0\u589E\u6BCF\u5468\u6703\u8B70\u300D\u4F86\u5EFA\u7ACB\u7B2C\u4E00\u7B46\u7D00\u9304\u3002 "),u())}function d9(n,e){if(n&1){let t=U();l(0,"div",8)(1,"div",34)(2,"div",35)(3,"h3",36),m(4),u(),l(5,"button",37),S("click",function(){w(t);let r=C();return T(r.closeModal())}),x(6,"ion-icon",38),u()(),l(7,"div",39)(8,"form",40),S("ngSubmit",function(){w(t);let r=C();return T(r.handleFormSubmit())}),l(9,"div",23)(10,"div")(11,"label",41),m(12,"\u65E5\u671F*"),u(),x(13,"input",42),u(),l(14,"div",43)(15,"label",44),m(16,"\u6A19\u984C*"),u(),x(17,"input",45),u()(),l(18,"div")(19,"label",46),m(20,"\u8207\u6703\u4EBA\u54E1*"),u(),x(21,"input",47),u(),l(22,"div")(23,"label",48),m(24,"\u6703\u8B70\u8A18\u9304*"),u(),x(25,"textarea",49),u(),l(26,"div")(27,"label",50),m(28,"\u884C\u52D5\u4E8B\u9805"),u(),x(29,"textarea",51),u(),l(30,"div",52)(31,"button",53),S("click",function(){w(t);let r=C();return T(r.closeModal())}),m(32,"\u53D6\u6D88"),u(),l(33,"button",54),m(34,"\u5132\u5B58"),u()()()()()()}if(n&2){let t=C();h(4),E(t.editingMeeting()?"\u7DE8\u8F2F\u6BCF\u5468\u6703\u8B70":"\u65B0\u589E\u6BCF\u5468\u6703\u8B70"),h(4),N("formGroup",t.meetingForm),h(25),N("disabled",t.meetingForm.invalid)}}function f9(n,e){if(n&1){let t=U();l(0,"div",8)(1,"div",55)(2,"div",56)(3,"div",57),x(4,"ion-icon",58),u(),l(5,"h3",59),m(6,"\u78BA\u5B9A\u8981\u522A\u9664\u55CE\uFF1F"),u(),l(7,"p",60),m(8),u()(),l(9,"div",61)(10,"button",53),S("click",function(){w(t);let r=C();return T(r.cancelDelete())}),m(11,"\u53D6\u6D88"),u(),l(12,"button",62),S("click",function(){w(t);let r=C();return T(r.confirmDelete())}),m(13,"\u78BA\u8A8D\u522A\u9664"),u()()()()}n&2&&(h(8),L("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u6BCF\u5468\u6703\u8B70\u7D00\u9304\u300C",e.title,"\u300D\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"))}var Ws=class Ws{constructor(){this.fb=R(ze);this.isModalOpen=D(!1);this.editingMeeting=D(null);this.openMeetingId=D(null);this.meetingToDelete=D(null);this.meetings=D([{id:"MEET001",date:"2024-07-30",title:"\u7B2C\u4E09\u5B63\u8CA1\u52D9\u6AA2\u8A0E",attendees:"\u80A1\u6771 A, \u80A1\u6771 B, \u8CA1\u52D9\u9577",notes:`1. \u8A0E\u8AD6\u7B2C\u4E09\u5B63\u5EA6\u7684\u71DF\u6536\u72C0\u6CC1\uFF0C\u6574\u9AD4\u8868\u73FE\u512A\u65BC\u9810\u671F\u3002
2. \u5206\u6790\u5404\u7522\u54C1\u7DDA\u7684\u5229\u6F64\u7387\uFF0C\u767C\u73FE\u96EA\u8304\u7522\u54C1\u7684\u6210\u672C\u6709\u4E0A\u5347\u8DA8\u52E2\u3002`,actionItems:`1. \u8CA1\u52D9\u90E8\u9700\u5728\u4E00\u9031\u5167\u63D0\u4EA4\u96EA\u8304\u6210\u672C\u4E0A\u5347\u7684\u8A73\u7D30\u5206\u6790\u5831\u544A\u3002
2. \u80A1\u6771 B \u8CA0\u8CAC\u7814\u7A76\u65B0\u7684\u4F9B\u61C9\u5546\u4EE5\u964D\u4F4E\u6210\u672C\u3002`},{id:"MEET002",date:"2024-07-25",title:"\u884C\u92B7\u6D3B\u52D5 brainstorm",attendees:"\u80A1\u6771 C, \u884C\u92B7\u5718\u968A",notes:"\u8A0E\u8AD6\u4E0B\u534A\u5E74\u5EA6\u7684\u884C\u92B7\u7B56\u7565\uFF0C\u4E3B\u8981\u96C6\u4E2D\u5728 VIP \u5BA2\u6236\u7684\u7DAD\u7E6B\u3002",actionItems:`1. \u884C\u92B7\u5718\u968A\u63D0\u51FA\u5169\u500B VIP \u5C08\u5C6C\u6D3B\u52D5\u65B9\u6848\u3002
2. \u9810\u7B97\u521D\u4F30\u9700\u5728\u4E0B\u9031\u4E09\u524D\u5B8C\u6210\u3002`}]);this.sortedMeetings=H(()=>this.meetings().sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()));this.meetingForm=this.fb.group({date:["",$.required],title:["",$.required],attendees:["",$.required],notes:["",$.required],actionItems:[""]})}toggleMeeting(e){this.openMeetingId.update(t=>t===e?null:e)}openModal(e=null){this.editingMeeting.set(e),e?this.meetingForm.patchValue(e):this.meetingForm.reset({date:new Date().toISOString().split("T")[0]}),this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1),this.editingMeeting.set(null)}handleFormSubmit(){if(this.meetingForm.invalid)return;let e=this.meetingForm.value,t=this.editingMeeting(),i={date:e.date,title:e.title,attendees:e.attendees,notes:e.notes,actionItems:e.actionItems||""};t?this.meetings.update(r=>r.map(o=>o.id===t.id?k(k({},o),i):o)):this.meetings.update(r=>[...r,k({id:`MEET${Date.now()}`},i)]),this.closeModal()}requestDelete(e){this.meetingToDelete.set(e)}confirmDelete(){if(!this.meetingToDelete())return;let e=this.meetingToDelete().id;this.meetings.update(t=>t.filter(i=>i.id!==e)),this.cancelDelete()}cancelDelete(){this.meetingToDelete.set(null)}};Ws.\u0275fac=function(t){return new(t||Ws)},Ws.\u0275cmp=ee({type:Ws,selectors:[["app-meeting"]],decls:14,vars:3,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","add-outline"],[1,"space-y-4"],[1,"bg-white","rounded-xl","shadow-md","overflow-hidden","transition-shadow","hover:shadow-lg"],[1,"bg-white","p-6","rounded-xl","shadow-md","text-center","text-gray-500"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"p-4","flex","justify-between","items-center","cursor-pointer","hover:bg-gray-50",3,"click"],[1,"flex","items-center","gap-4"],[1,"text-center","w-12"],[1,"text-sm","font-semibold","text-red-600"],[1,"text-2xl","font-bold","text-gray-800"],[1,"font-semibold","text-gray-500","text-sm"],[1,"text-lg","font-bold","text-gray-800"],[1,"flex","items-center","gap-2"],["title","\u7DE8\u8F2F",1,"text-gray-500","hover:text-indigo-600","p-2","rounded-full","hover:bg-gray-100",3,"click"],["name","create-outline"],["title","\u522A\u9664",1,"text-gray-500","hover:text-red-600","p-2","rounded-full","hover:bg-gray-100",3,"click"],["name","trash-outline"],["name","chevron-down-outline",1,"text-gray-500","transition-transform"],[1,"p-6","border-t","bg-slate-50","space-y-4","text-sm"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"bg-white","p-4","rounded-lg","border"],[1,"font-semibold","text-gray-600","mb-2","flex","items-center","gap-2"],["name","people-outline"],[1,"text-gray-800","pl-8"],[1,"bg-yellow-50","p-4","rounded-lg","border","border-yellow-200","md:row-span-2"],["name","document-text-outline"],[1,"text-gray-800","whitespace-pre-wrap","pl-8","list-disc","list-outside","space-y-1"],[1,"font-semibold","text-yellow-800","mb-2","flex","items-center","gap-2"],["name","checkbox-outline"],[1,"text-yellow-900","whitespace-pre-wrap","pl-8","list-disc","list-outside","space-y-1"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-2xl","max-h-[90vh]","flex","flex-col","m-4"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],[1,"space-y-4",3,"ngSubmit","formGroup"],["for","date",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","date","formControlName","date",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"md:col-span-2"],["for","title",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","title","formControlName","title",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","attendees",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","attendees","formControlName","attendees","placeholder","\u8ACB\u7528\u9017\u865F\u5206\u9694",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","notes",1,"block","text-sm","font-medium","text-gray-700"],["id","notes","formControlName","notes","rows","5",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","actionItems",1,"block","text-sm","font-medium","text-gray-700"],["id","actionItems","formControlName","actionItems","rows","3",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","disabled:bg-indigo-300",3,"disabled"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","m-4"],[1,"p-6","text-center"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100"],["name","warning-outline",1,"h-6","w-6","text-red-600"],[1,"mt-4","text-lg","font-semibold","text-gray-900"],[1,"mt-2","text-sm","text-gray-500"],[1,"flex","justify-center","gap-4","bg-gray-50","px-6","py-4","rounded-b-xl"],["type","button",1,"px-4","py-2","bg-red-600","text-white","rounded-md","hover:bg-red-700",3,"click"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),m(3,"\u6BCF\u5468\u6703\u8B70\u7D00\u9304"),u(),l(4,"button",3),S("click",function(){return i.openModal(null)}),x(5,"ion-icon",4),l(6,"span"),m(7,"\u65B0\u589E\u6BCF\u5468\u6703\u8B70"),u()()(),l(8,"div",5),O(9,u9,23,16,"div",6,n9,!1,c9,2,0,"div",7),u()(),P(12,d9,35,3,"div",8),P(13,f9,14,1,"div",8)),t&2){let r;h(9),V(i.sortedMeetings()),h(3),F(i.isModalOpen()?12:-1),h(),F((r=i.meetingToDelete())?13:-1,r)}},dependencies:[oe,$e,je,xe,ge,Be,Ue,qe,Ka],encapsulation:2,changeDetection:0});var lm=Ws;var um=(n,e)=>e.id;function m9(n,e){if(n&1&&(l(0,"option",13),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),E(t)}}function p9(n,e){if(n&1&&(l(0,"option",13),m(1),u()),n&2){let t=e.$implicit;N("value",t.id),h(),E(t.name)}}function g9(n,e){if(n&1){let t=U();l(0,"div",34)(1,"div",36)(2,"span",37),m(3),u(),l(4,"div",38)(5,"button",39),S("click",function(){let r=w(t).$implicit,o=C(2).$implicit,s=C();return T(s.openRecordModal(o.id,r))}),x(6,"ion-icon",28),u(),l(7,"button",40),S("click",function(){let r=w(t).$implicit,o=C(2).$implicit,s=C();return T(s.requestDeleteRecord(o.id,r))}),x(8,"ion-icon",30),u()()(),l(9,"div",41)(10,"div",42),x(11,"ion-icon",43),l(12,"p",44),m(13),u()(),l(14,"div",45),x(15,"ion-icon",46),l(16,"p",47),m(17),u()()(),l(18,"div",48)(19,"div",3),x(20,"img",49),l(21,"span",50),m(22),u()(),l(23,"span",51),m(24),u()()()}if(n&2){let t=e.$implicit,i=C(3);h(2),De(i.getCategoryClass(t.category)),h(),E(t.category),h(10),E(t.goal),h(4),E(t.progress),h(3),N("src",i.getShareholderAvatarUrl(t.assigneeId),On),h(2),E(i.getShareholderName(t.assigneeId)),h(2),E(t.lastUpdated.split(" ")[0])}}function h9(n,e){n&1&&(l(0,"div",35),m(1,"\u6B64\u65E5\u671F\u5C1A\u7121\u9032\u5EA6\u5831\u544A\uFF0C\u9EDE\u64CA\u300C\u65B0\u589E\u9032\u5EA6\u300D\u4F86\u5EFA\u7ACB\u7B2C\u4E00\u7B46\u3002"),u())}function y9(n,e){if(n&1&&(l(0,"div",32)(1,"div",33),O(2,g9,25,8,"div",34,um,!1,h9,2,0,"div",35),u()()),n&2){let t=C().$implicit;h(2),V(t.records)}}function v9(n,e){if(n&1){let t=U();l(0,"div",20)(1,"div",23),S("click",function(){let r=w(t).$implicit,o=C();return T(o.toggleMeeting(r.id))}),l(2,"h3",24),m(3),u(),l(4,"div",3)(5,"button",25),S("click",function(r){let o=w(t).$implicit,s=C();return r.stopPropagation(),T(s.openRecordModal(o.id,null))}),x(6,"ion-icon",26),l(7,"span"),m(8,"\u65B0\u589E\u9032\u5EA6"),u()(),l(9,"button",27),S("click",function(r){let o=w(t).$implicit,s=C();return r.stopPropagation(),T(s.openMeetingModal(o))}),x(10,"ion-icon",28),u(),l(11,"button",29),S("click",function(r){let o=w(t).$implicit,s=C();return r.stopPropagation(),T(s.requestDeleteMeeting(o))}),x(12,"ion-icon",30),u(),x(13,"ion-icon",31),u()(),P(14,y9,5,1,"div",32),u()}if(n&2){let t=e.$implicit,i=C();h(3),E(t.date),h(10),Q("rotate-180",i.openMeetingId()===t.id),h(),F(i.openMeetingId()===t.id?14:-1)}}function _9(n,e){n&1&&(l(0,"div",21),m(1,"\u7121\u7B26\u5408\u7BE9\u9078\u689D\u4EF6\u7684\u6703\u8B70\u7D00\u9304\u3002"),u())}function C9(n,e){if(n&1){let t=U();l(0,"div",22)(1,"div",52)(2,"div",53)(3,"h3",54),m(4),u(),l(5,"button",55),S("click",function(){w(t);let r=C();return T(r.closeMeetingModal())}),x(6,"ion-icon",56),u()(),l(7,"div",57)(8,"form",58),S("ngSubmit",function(){w(t);let r=C();return T(r.handleMeetingSubmit())}),l(9,"div")(10,"label",59),m(11,"\u65E5\u671F*"),u(),x(12,"input",60),u(),l(13,"div",61)(14,"button",62),S("click",function(){w(t);let r=C();return T(r.closeMeetingModal())}),m(15,"\u53D6\u6D88"),u(),l(16,"button",63),m(17,"\u5132\u5B58"),u()()()()()()}if(n&2){let t=C();h(4),E(t.editingMeeting()?"\u7DE8\u8F2F\u7D00\u9304\u65E5\u671F":"\u65B0\u589E\u7D00\u9304\u65E5\u671F"),h(4),N("formGroup",t.meetingForm),h(8),N("disabled",t.meetingForm.invalid)}}function x9(n,e){if(n&1&&x(0,"option",13),n&2){let t=e.$implicit;N("value",t)}}function E9(n,e){if(n&1&&(l(0,"option",13),m(1),u()),n&2){let t=e.$implicit;N("value",t.id),h(),E(t.name)}}function b9(n,e){if(n&1){let t=U();l(0,"div",22)(1,"div",64)(2,"div",53)(3,"h3",54),m(4),u(),l(5,"button",55),S("click",function(){w(t);let r=C();return T(r.closeRecordModal())}),x(6,"ion-icon",56),u()(),l(7,"div",65)(8,"form",58),S("ngSubmit",function(){w(t);let r=C();return T(r.handleRecordFormSubmit())}),l(9,"div")(10,"label",66),m(11,"\u5206\u985E*"),u(),x(12,"input",67),l(13,"datalist",68),O(14,x9,1,1,"option",13,W),u()(),l(16,"div")(17,"label",69),m(18,"\u76EE\u6A19*"),u(),x(19,"textarea",70),u(),l(20,"div")(21,"label",71),m(22,"\u9032\u5EA6*"),u(),x(23,"textarea",72),u(),l(24,"div")(25,"label",73),m(26,"\u8CA0\u8CAC\u4EBA*"),u(),l(27,"select",74)(28,"option",75),m(29,"\u8ACB\u9078\u64C7"),u(),O(30,E9,2,2,"option",13,um),u()(),l(32,"div",61)(33,"button",62),S("click",function(){w(t);let r=C();return T(r.closeRecordModal())}),m(34,"\u53D6\u6D88"),u(),l(35,"button",63),m(36,"\u5132\u5B58"),u()()()()()()}if(n&2){let t,i=C();h(4),E((t=i.editingRecord())!=null&&t.record?"\u7DE8\u8F2F\u9032\u5EA6":"\u65B0\u589E\u9032\u5EA6"),h(4),N("formGroup",i.recordForm),h(6),V(i.categories()),h(16),V(i.shareholders()),h(5),N("disabled",i.recordForm.invalid)}}function S9(n,e){if(n&1){let t=U();l(0,"div",79),x(1,"input",82),l(2,"button",83),S("click",function(){let r=w(t).$index,o=C(2);return T(o.removeShareholder(r))}),x(3,"ion-icon",84),u()()}if(n&2){let t=e.$index;N("formGroupName",t)}}function D9(n,e){if(n&1){let t=U();l(0,"div",22)(1,"div",76)(2,"div",53)(3,"h3",54),m(4,"\u7BA1\u7406\u4EBA\u54E1"),u(),l(5,"button",55),S("click",function(){w(t);let r=C();return T(r.closeShareholderModal())}),x(6,"ion-icon",56),u()(),l(7,"div",65)(8,"form",77),S("ngSubmit",function(){w(t);let r=C();return T(r.saveShareholders())}),l(9,"div",78),O(10,S9,4,1,"div",79,_n),u(),l(12,"button",80),S("click",function(){w(t);let r=C();return T(r.addShareholder())}),m(13,"+ \u65B0\u589E\u4EBA\u54E1"),u(),l(14,"div",81)(15,"button",62),S("click",function(){w(t);let r=C();return T(r.closeShareholderModal())}),m(16,"\u53D6\u6D88"),u(),l(17,"button",63),m(18,"\u5132\u5B58\u8B8A\u66F4"),u()()()()()()}if(n&2){let t=C();h(8),N("formGroup",t.shareholderForm),h(2),V(t.shareholderControls),h(7),N("disabled",t.shareholderForm.invalid)}}function w9(n,e){if(n&1){let t=U();l(0,"div",22)(1,"div",85)(2,"div",86)(3,"div",87),x(4,"ion-icon",88),u(),l(5,"h3",89),m(6,"\u78BA\u5B9A\u8981\u522A\u9664\u55CE\uFF1F"),u(),l(7,"p",90),m(8),u()(),l(9,"div",91)(10,"button",62),S("click",function(){w(t);let r=C();return T(r.cancelDeleteMeeting())}),m(11,"\u53D6\u6D88"),u(),l(12,"button",92),S("click",function(){w(t);let r=C();return T(r.confirmDeleteMeeting())}),m(13,"\u78BA\u8A8D\u522A\u9664"),u()()()()}n&2&&(h(8),L("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u65E5\u671F\u70BA\u300C",e.date,"\u300D\u7684\u7D00\u9304\u53CA\u5176\u6240\u6709\u9032\u5EA6\u5831\u544A\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"))}function T9(n,e){if(n&1){let t=U();l(0,"div",22)(1,"div",85)(2,"div",86)(3,"div",87),x(4,"ion-icon",88),u(),l(5,"h3",89),m(6,"\u78BA\u5B9A\u8981\u522A\u9664\u55CE\uFF1F"),u(),l(7,"p",90),m(8),u()(),l(9,"div",91)(10,"button",62),S("click",function(){w(t);let r=C();return T(r.cancelDeleteRecord())}),m(11,"\u53D6\u6D88"),u(),l(12,"button",92),S("click",function(){w(t);let r=C();return T(r.confirmDeleteRecord())}),m(13,"\u78BA\u8A8D\u522A\u9664"),u()()()()}n&2&&(h(8),L("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u76EE\u6A19\u70BA\u300C",e.record.goal,"\u300D\u7684\u9019\u7B46\u9032\u5EA6\u5831\u544A\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"))}var js=class js{constructor(){this.fb=R(ze);this.isRecordModalOpen=D(!1);this.isShareholderModalOpen=D(!1);this.isMeetingModalOpen=D(!1);this.editingRecord=D(null);this.editingMeeting=D(null);this.openMeetingId=D(null);this.categoryFilter=D("");this.assigneeFilter=D("");this.shareholders=D([{id:"sh1",name:"\u80A1\u6771 A"},{id:"sh2",name:"\u80A1\u6771 B"},{id:"sh3",name:"\u80A1\u6771 C"}]);this.meetingProgresses=D([{id:"MP001",date:"2024-07-29",records:[{id:"REC001",category:"\u8CA1\u52D9",goal:"\u5F59\u6574\u5167\u5916\u8CA1\u5831",progress:"\u6574\u7406\u51FA\u5167\u5916\u5E33\u7684\u5831\u8868",assigneeId:"sh1",lastUpdated:"2024-07-29 11:00:00"},{id:"REC003",category:"\u516C\u95DC",goal:"2026/1/10 \u78BA\u8A8D\u4E00\u6708\u6D3B\u52D5\u5834\u6B21",progress:"\u798F\u59D4\u6703\u806F\u7D6145\u500B (1/5)",assigneeId:"sh2",lastUpdated:"2024-07-29 09:45:00"},{id:"REC005",category:"\u71DF\u904B",goal:"\u627E\u5230\u6709\u6548\u80A1\u6771",progress:"\u5206\u6F64\u6A5F\u5236\u8A0E\u8AD6\u4E2D",assigneeId:"sh2",lastUpdated:"2024-07-29 14:00:00"}]},{id:"MP002",date:"2024-07-22",records:[{id:"REC002",category:"\u8CA1\u52D9",goal:"\u62C9\u878D\u8CC7",progress:"\u88D5\u878D\u878D\u8CC7",assigneeId:"sh1",lastUpdated:"2024-07-28 15:30:00"},{id:"REC004",category:"\u6D3B\u52D5",goal:"\u5361\u724C\u805A\u9910 1/15",progress:"1/15\u5361\u724C\u805A\u6703*10\u4EBA (\u91CD\u9EDE\u4EBA\u7269) 5000\u9910\u8CBB \u4E2D\u9910",assigneeId:"sh3",lastUpdated:"2024-07-27 18:20:00"}]}]);this.categories=H(()=>{let e=this.meetingProgresses().flatMap(t=>t.records);return[...new Set(e.map(t=>t.category))].sort()});this.sortedMeetings=H(()=>this.meetingProgresses().slice().sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()));this.filteredMeetings=H(()=>{let e=this.categoryFilter(),t=this.assigneeFilter(),i=this.sortedMeetings();return!e&&!t?i:i.map(r=>q(k({},r),{records:r.records.filter(o=>!e||o.category===e).filter(o=>!t||o.assigneeId===t)})).filter(r=>r.records.length>0)});this.meetingForm=this.fb.group({date:["",$.required]});this.recordForm=this.fb.group({category:["",$.required],goal:["",$.required],progress:["",$.required],assigneeId:["",$.required]});this.meetingToDelete=D(null);this.recordToDelete=D(null);this.shareholderForm=this.fb.group({shareholders:this.fb.array([])})}getShareholderName(e){return this.shareholders().find(t=>t.id===e)?.name||"\u672A\u77E5"}getShareholderAvatarUrl(e){let t=this.getShareholderName(e);return`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=random&color=fff&font-size=0.5`}getCategoryClass(e){return{\u8CA1\u52D9:"bg-blue-100 text-blue-800",\u516C\u95DC:"bg-purple-100 text-purple-800",\u71DF\u904B:"bg-green-100 text-green-800",\u6D3B\u52D5:"bg-yellow-100 text-yellow-800"}[e]||"bg-gray-100 text-gray-800"}toggleMeeting(e){this.openMeetingId.update(t=>t===e?null:e)}openMeetingModal(e=null){this.editingMeeting.set(e),e?this.meetingForm.setValue({date:e.date}):this.meetingForm.reset({date:new Date().toISOString().split("T")[0]}),this.isMeetingModalOpen.set(!0)}closeMeetingModal(){this.isMeetingModalOpen.set(!1)}handleMeetingSubmit(){if(this.meetingForm.invalid)return;let e=this.meetingForm.value,t=this.editingMeeting();if(t)this.meetingProgresses.update(i=>i.map(r=>r.id===t.id?q(k({},r),{date:e.date}):r));else{let i={id:`MP${Date.now()}`,date:e.date,records:[]};this.meetingProgresses.update(r=>[...r,i])}this.closeMeetingModal()}openRecordModal(e,t=null){t?(this.editingRecord.set({record:t,meetingId:e}),this.recordForm.patchValue(t)):(this.editingRecord.set({record:null,meetingId:e}),this.recordForm.reset({assigneeId:""})),this.isRecordModalOpen.set(!0)}closeRecordModal(){this.isRecordModalOpen.set(!1),this.editingRecord.set(null)}handleRecordFormSubmit(){if(this.recordForm.invalid)return;let e=this.editingRecord();if(!e)return;let{record:t,meetingId:i}=e,r=this.recordForm.value,o={category:r.category,goal:r.goal,progress:r.progress,assigneeId:r.assigneeId,lastUpdated:new Date().toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replace(/\//g,"-")};this.meetingProgresses.update(s=>s.map(a=>{if(a.id===i){let c;return t?c=a.records.map(d=>d.id===t.id?k(k({},d),o):d):c=[...a.records,k({id:`REC${Date.now()}`},o)],q(k({},a),{records:c})}return a})),this.closeRecordModal()}resetFilters(){this.categoryFilter.set(""),this.assigneeFilter.set("")}requestDeleteMeeting(e){this.meetingToDelete.set(e)}confirmDeleteMeeting(){if(!this.meetingToDelete())return;let e=this.meetingToDelete().id;this.meetingProgresses.update(t=>t.filter(i=>i.id!==e)),this.cancelDeleteMeeting()}cancelDeleteMeeting(){this.meetingToDelete.set(null)}requestDeleteRecord(e,t){this.recordToDelete.set({meetingId:e,record:t})}confirmDeleteRecord(){if(!this.recordToDelete())return;let{meetingId:e,record:t}=this.recordToDelete();this.meetingProgresses.update(i=>i.map(r=>r.id===e?q(k({},r),{records:r.records.filter(o=>o.id!==t.id)}):r)),this.cancelDeleteRecord()}cancelDeleteRecord(){this.recordToDelete.set(null)}get shareholderControls(){return this.shareholderForm.get("shareholders").controls}openShareholderModal(){let e=this.shareholderForm.get("shareholders");e.clear(),this.shareholders().map(i=>this.fb.group({id:[i.id],name:[i.name,$.required]})).forEach(i=>e.push(i)),this.isShareholderModalOpen.set(!0)}closeShareholderModal(){this.isShareholderModalOpen.set(!1)}addShareholder(){this.shareholderForm.get("shareholders").push(this.fb.group({id:[`sh${Date.now()}`],name:["",$.required]}))}removeShareholder(e){this.shareholderForm.get("shareholders").removeAt(e)}saveShareholders(){this.shareholderForm.invalid||(this.shareholders.set(this.shareholderForm.value.shareholders),this.closeShareholderModal())}};js.\u0275fac=function(t){return new(t||js)},js.\u0275cmp=ee({type:js,selectors:[["app-shareholder-records"]],decls:43,vars:8,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"flex","items-center","gap-2"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","calendar-outline"],[1,"bg-gray-700","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-gray-800","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","people-outline"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","p-4","bg-gray-50","rounded-lg","mb-6"],["for","categoryFilter",1,"text-sm","font-medium","text-gray-600"],["id","categoryFilter",1,"w-full","mt-1","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["value",""],[3,"value"],["for","assigneeFilter",1,"text-sm","font-medium","text-gray-600"],["id","assigneeFilter",1,"w-full","mt-1","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"flex","items-end","justify-end"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"space-y-4"],[1,"bg-white","rounded-xl","border","border-gray-200","overflow-hidden","transition-shadow","hover:shadow-md"],[1,"text-center","py-8","text-gray-500"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"p-4","flex","justify-between","items-center","cursor-pointer","hover:bg-gray-50",3,"click"],[1,"text-lg","font-bold","text-gray-800"],[1,"bg-indigo-500","text-white","px-3","py-1","rounded-md","font-medium","hover:bg-indigo-600","flex","items-center","gap-1","text-xs",3,"click"],["name","add-outline"],["title","\u7DE8\u8F2F\u65E5\u671F",1,"text-gray-500","hover:text-indigo-600","p-2","rounded-full","hover:bg-gray-200",3,"click"],["name","create-outline"],["title","\u522A\u9664\u6B64\u65E5\u671F\u6240\u6709\u7D00\u9304",1,"text-gray-500","hover:text-red-600","p-2","rounded-full","hover:bg-gray-200",3,"click"],["name","trash-outline"],["name","chevron-down-outline",1,"text-gray-500","transition-transform"],[1,"p-4","bg-slate-50","border-t"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-4"],[1,"bg-white","rounded-lg","border","p-4","flex","flex-col","group","relative","hover:border-indigo-300","transition-colors","duration-200"],[1,"md:col-span-2","lg:col-span-3","text-center","py-6","text-gray-500"],[1,"flex","justify-between","items-start"],[1,"px-2","py-1","text-xs","font-semibold","rounded-full"],[1,"flex","items-center","gap-1","opacity-0","group-hover:opacity-100","transition-opacity"],["title","\u7DE8\u8F2F",1,"text-gray-400","hover:text-indigo-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],["title","\u522A\u9664",1,"text-gray-400","hover:text-red-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],[1,"mt-3","flex-grow"],[1,"flex","items-start","gap-2"],["name","golf-outline",1,"text-indigo-500","mt-1"],[1,"font-semibold","text-gray-800"],[1,"flex","items-start","gap-2","mt-2"],["name","analytics-outline",1,"text-gray-500","mt-1"],[1,"text-gray-600","text-sm","flex-grow"],[1,"flex","justify-between","items-center","mt-4","pt-3","border-t"],["alt","avatar",1,"w-6","h-6","rounded-full",3,"src"],[1,"text-xs","font-medium","text-gray-700"],[1,"text-xs","text-gray-400"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-sm","m-4"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6"],[1,"space-y-4",3,"ngSubmit","formGroup"],["for","date",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","date","formControlName","date",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","disabled:bg-indigo-300",3,"disabled"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-lg","max-h-[90vh]","flex","flex-col","m-4"],[1,"p-6","overflow-y-auto"],["for","category",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","category","formControlName","category","list","category-options","placeholder","\u9078\u64C7\u6216\u8F38\u5165\u65B0\u5206\u985E",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["id","category-options"],["for","goal",1,"block","text-sm","font-medium","text-gray-700"],["id","goal","formControlName","goal","rows","2",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","progress",1,"block","text-sm","font-medium","text-gray-700"],["id","progress","formControlName","progress","rows","3",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","assigneeId",1,"block","text-sm","font-medium","text-gray-700"],["id","assigneeId","formControlName","assigneeId",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["value","","disabled",""],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","max-h-[90vh]","flex","flex-col","m-4"],[3,"ngSubmit","formGroup"],["formArrayName","shareholders",1,"space-y-3"],[1,"flex","items-center","gap-2",3,"formGroupName"],["type","button",1,"mt-4","text-sm","text-indigo-600","font-medium",3,"click"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-6"],["formControlName","name",1,"flex-grow","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["type","button","title","\u522A\u9664",1,"text-red-500","p-1","hover:bg-red-100","rounded-full",3,"click"],["name","trash-outline",1,"text-lg"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","m-4"],[1,"p-6","text-center"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100"],["name","warning-outline",1,"h-6","w-6","text-red-600"],[1,"mt-4","text-lg","font-semibold","text-gray-900"],[1,"mt-2","text-sm","text-gray-500"],[1,"flex","justify-center","gap-4","bg-gray-50","px-6","py-4","rounded-b-xl"],["type","button",1,"px-4","py-2","bg-red-600","text-white","rounded-md","hover:bg-red-700",3,"click"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),m(3,"\u500B\u4EBA\u6BCF\u5468\u9032\u5EA6\u7D00\u9304"),u(),l(4,"div",3)(5,"button",4),S("click",function(){return i.openMeetingModal(null)}),x(6,"ion-icon",5),l(7,"span"),m(8,"\u65B0\u589E\u7D00\u9304\u65E5\u671F"),u()(),l(9,"button",6),S("click",function(){return i.openShareholderModal()}),x(10,"ion-icon",7),l(11,"span"),m(12,"\u7BA1\u7406\u4EBA\u54E1"),u()()()(),l(13,"div",8)(14,"div",9)(15,"div")(16,"label",10),m(17,"\u9032\u5EA6\u5206\u985E"),u(),l(18,"select",11),ne("ngModelChange",function(o){return re(i.categoryFilter,o)||(i.categoryFilter=o),o}),l(19,"option",12),m(20,"\u6240\u6709\u5206\u985E"),u(),O(21,m9,2,2,"option",13,W),u()(),l(23,"div")(24,"label",14),m(25,"\u8CA0\u8CAC\u4EBA"),u(),l(26,"select",15),ne("ngModelChange",function(o){return re(i.assigneeFilter,o)||(i.assigneeFilter=o),o}),l(27,"option",12),m(28,"\u6240\u6709\u8CA0\u8CAC\u4EBA"),u(),O(29,p9,2,2,"option",13,um),u()(),l(31,"div",16)(32,"button",17),S("click",function(){return i.resetFilters()}),x(33,"ion-icon",18),u()()(),l(34,"div",19),O(35,v9,15,4,"div",20,um,!1,_9,2,0,"div",21),u()()(),P(38,C9,18,3,"div",22),P(39,b9,37,3,"div",22),P(40,D9,19,2,"div",22),P(41,w9,14,1,"div",22),P(42,T9,14,1,"div",22)),t&2){let r,o;h(18),te("ngModel",i.categoryFilter),h(3),V(i.categories()),h(5),te("ngModel",i.assigneeFilter),h(3),V(i.shareholders()),h(6),V(i.filteredMeetings()),h(3),F(i.isMeetingModalOpen()?38:-1),h(),F(i.isRecordModalOpen()?39:-1),h(),F(i.isShareholderModalOpen()?40:-1),h(),F((r=i.meetingToDelete())?41:-1,r),h(),F((o=i.recordToDelete())?42:-1,o)}},dependencies:[oe,$e,je,Fe,ke,xe,Ae,ge,Be,Ue,qe,Ei,bi,Ee,we],encapsulation:2,changeDetection:0});var cm=js;var I9=(n,e)=>e.id;function M9(n,e){if(n&1){let t=U();l(0,"div",10)(1,"div",11),x(2,"ion-icon",12),u(),l(3,"div",13)(4,"div",14)(5,"div",15)(6,"div")(7,"p",16),m(8),u(),l(9,"h3",17),m(10),u()(),l(11,"div",18)(12,"button",19),S("click",function(){let r=w(t).$implicit,o=C(2);return T(o.openModal(r))}),x(13,"ion-icon",20),u(),l(14,"button",21),S("click",function(){let r=w(t).$implicit,o=C(2);return T(o.requestDelete(r))}),x(15,"ion-icon",22),u()()(),l(16,"div",23)(17,"div",24)(18,"div",25)(19,"h4",26),x(20,"ion-icon",27),m(21,"\u76F8\u95DC\u4EBA\u54E1"),u(),l(22,"p",28),m(23),u()(),l(24,"div",29)(25,"h4",26),x(26,"ion-icon",30),m(27,"\u80CC\u666F"),u(),l(28,"p",31),m(29),u()(),l(30,"div",25)(31,"h4",26),x(32,"ion-icon",32),m(33,"\u7406\u7531"),u(),l(34,"p",31),m(35),u()()(),l(36,"div",33)(37,"h4",34),x(38,"ion-icon",35),m(39,"\u6700\u7D42\u6C7A\u5B9A"),u(),l(40,"p",36),m(41),u()()()()()()}if(n&2){let t=e.$implicit;h(8),E(t.date),h(2),E(t.title),h(13),E(t.stakeholders),h(6),E(t.background),h(6),E(t.rationale),h(6),E(t.decision)}}function A9(n,e){if(n&1&&(l(0,"div",6),x(1,"div",9),O(2,M9,42,6,"div",10,I9),u()),n&2){let t=C();h(2),V(t.sortedDecisions())}}function N9(n,e){n&1&&(l(0,"div",7),m(1," \u5C1A\u7121\u4F48\u9054\u4E8B\u9805\uFF0C\u9EDE\u64CA\u6309\u9215\u4F86\u5EFA\u7ACB\u7B2C\u4E00\u7B46\u7D00\u9304\u3002 "),u())}function R9(n,e){if(n&1){let t=U();l(0,"div",8)(1,"div",37)(2,"div",38)(3,"h3",39),m(4),u(),l(5,"button",40),S("click",function(){w(t);let r=C();return T(r.closeModal())}),x(6,"ion-icon",41),u()(),l(7,"div",42)(8,"form",43),S("ngSubmit",function(){w(t);let r=C();return T(r.handleFormSubmit())}),l(9,"div",44)(10,"div")(11,"label",45),m(12,"\u65E5\u671F*"),u(),x(13,"input",46),u(),l(14,"div")(15,"label",47),m(16,"\u6A19\u984C*"),u(),x(17,"input",48),u()(),l(18,"div")(19,"label",49),m(20,"\u76F8\u95DC\u4EBA\u54E1*"),u(),x(21,"input",50),u(),l(22,"div")(23,"label",51),m(24,"\u80CC\u666F*"),u(),x(25,"textarea",52),u(),l(26,"div")(27,"label",53),m(28,"\u5167\u5BB9*"),u(),x(29,"textarea",54),u(),l(30,"div")(31,"label",55),m(32,"\u7406\u7531*"),u(),x(33,"textarea",56),u(),l(34,"div",57)(35,"button",58),S("click",function(){w(t);let r=C();return T(r.closeModal())}),m(36,"\u53D6\u6D88"),u(),l(37,"button",59),m(38,"\u5132\u5B58"),u()()()()()()}if(n&2){let t=C();h(4),E(t.editingDecision()?"\u7DE8\u8F2F\u4F48\u9054":"\u65B0\u589E\u4F48\u9054"),h(4),N("formGroup",t.decisionForm),h(29),N("disabled",t.decisionForm.invalid)}}function P9(n,e){if(n&1){let t=U();l(0,"div",8)(1,"div",60)(2,"div",61)(3,"div",62),x(4,"ion-icon",63),u(),l(5,"h3",64),m(6,"\u78BA\u5B9A\u8981\u522A\u9664\u55CE\uFF1F"),u(),l(7,"p",65),m(8),u()(),l(9,"div",66)(10,"button",58),S("click",function(){w(t);let r=C();return T(r.cancelDelete())}),m(11,"\u53D6\u6D88"),u(),l(12,"button",67),S("click",function(){w(t);let r=C();return T(r.confirmDelete())}),m(13,"\u78BA\u8A8D\u522A\u9664"),u()()()()}n&2&&(h(8),L("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u4F48\u9054\u4E8B\u9805\u300C",e.title,"\u300D\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"))}var zs=class zs{constructor(){this.fb=R(ze);this.isModalOpen=D(!1);this.editingDecision=D(null);this.decisionToDelete=D(null);this.decisions=D([{id:"DEC001",date:"2024-07-28",title:"\u63A1\u8CFC\u65B0\u7684 POS \u7CFB\u7D71",background:"\u76EE\u524D\u7684 POS \u7CFB\u7D71\u8001\u820A\uFF0C\u7D93\u5E38\u51FA\u932F\uFF0C\u4E14\u7121\u6CD5\u8207\u65B0\u7684\u5EAB\u5B58\u7BA1\u7406\u8EDF\u9AD4\u6574\u5408\u3002",decision:"\u6C7A\u5B9A\u63A1\u8CFC\u300CFuture POS\u300D\u7CFB\u7D71\uFF0C\u4E26\u9810\u8A08\u5728\u7B2C\u56DB\u5B63\u5B8C\u6210\u5C0E\u5165\u3002",rationale:"\u8A72\u7CFB\u7D71\u8A55\u50F9\u826F\u597D\uFF0C\u5177\u5099\u6211\u5011\u9700\u8981\u7684\u6240\u6709\u529F\u80FD\uFF0C\u4E14\u50F9\u683C\u5728\u9810\u7B97\u5167\u3002\u9577\u9060\u4F86\u770B\u80FD\u63D0\u5347\u71DF\u904B\u6548\u7387\u3002",stakeholders:"\u5168\u9AD4\u80A1\u6771, \u71DF\u904B\u7D93\u7406"},{id:"DEC002",date:"2024-07-15",title:"\u8ABF\u6574 VIP \u6703\u54E1\u798F\u5229",background:"VIP \u6703\u54E1\u7684\u6D88\u8CBB\u8A98\u56E0\u4E0D\u8DB3\uFF0C\u7E8C\u6703\u7387\u6709\u4E0B\u964D\u8DA8\u52E2\u3002",decision:"\u65B0\u589E VIP \u6703\u54E1\u751F\u65E5\u7576\u6708\u4EAB\u6709\u7528\u9910 8 \u6298\u512A\u60E0\uFF0C\u4E26\u63D0\u9AD8\u6D88\u8CBB\u7D2F\u7A4D\u9EDE\u6578\u7684\u56DE\u994B\u7387\u3002",rationale:"\u589E\u52A0\u5C0A\u69AE\u611F\u8207\u5BE6\u8CEA\u512A\u60E0\uFF0C\u5E0C\u671B\u80FD\u6709\u6548\u63D0\u5347\u9867\u5BA2\u5FE0\u8AA0\u5EA6\u8207\u6D88\u8CBB\u983B\u7387\u3002",stakeholders:"\u884C\u92B7\u5718\u968A, \u80A1\u6771 C"}]);this.sortedDecisions=H(()=>this.decisions().sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()));this.decisionForm=this.fb.group({date:["",$.required],title:["",$.required],stakeholders:["",$.required],background:["",$.required],decision:["",$.required],rationale:["",$.required]})}openModal(e=null){this.editingDecision.set(e),e?this.decisionForm.patchValue(e):this.decisionForm.reset({date:new Date().toISOString().split("T")[0]}),this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1),this.editingDecision.set(null)}handleFormSubmit(){if(this.decisionForm.invalid)return;let e=this.decisionForm.value,t=this.editingDecision(),i={date:e.date,title:e.title,stakeholders:e.stakeholders,background:e.background,decision:e.decision,rationale:e.rationale};t?this.decisions.update(r=>r.map(o=>o.id===t.id?k(k({},o),i):o)):this.decisions.update(r=>[...r,k({id:`DEC${Date.now()}`},i)]),this.closeModal()}requestDelete(e){this.decisionToDelete.set(e)}confirmDelete(){if(!this.decisionToDelete())return;let e=this.decisionToDelete().id;this.decisions.update(t=>t.filter(i=>i.id!==e)),this.cancelDelete()}cancelDelete(){this.decisionToDelete.set(null)}};zs.\u0275fac=function(t){return new(t||zs)},zs.\u0275cmp=ee({type:zs,selectors:[["app-decision-log"]],decls:13,vars:3,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","add-outline"],[1,"max-w-4xl","mx-auto"],[1,"relative","pl-8"],[1,"bg-white","p-6","rounded-xl","shadow-md","text-center","text-gray-500"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"absolute","left-3","top-2","h-full","w-0.5","bg-gray-200"],[1,"relative","mb-8","group"],[1,"absolute","-left-0.5","top-2.5","w-7","h-7","bg-white","border-4","border-indigo-600","rounded-full","flex","items-center","justify-center","transition-transform","group-hover:scale-110"],["name","flag-outline",1,"text-indigo-600"],[1,"ml-12","bg-white","rounded-xl","shadow-md","overflow-hidden","transition-shadow","hover:shadow-lg"],[1,"p-5"],[1,"flex","justify-between","items-start"],[1,"font-semibold","text-indigo-700"],[1,"text-lg","font-bold","text-gray-800"],[1,"flex","items-center","gap-1","opacity-0","group-hover:opacity-100","transition-opacity"],["title","\u7DE8\u8F2F",1,"text-gray-400","hover:text-indigo-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],["name","create-outline"],["title","\u522A\u9664",1,"text-gray-400","hover:text-red-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],["name","trash-outline"],[1,"mt-4","space-y-4","text-sm"],[1,"grid","grid-cols-1","xl:grid-cols-2","gap-4"],[1,"bg-slate-50","p-3","rounded-lg","border"],[1,"font-semibold","text-slate-600","mb-1","flex","items-center","gap-2"],["name","people-outline"],[1,"text-slate-800","pl-8"],[1,"bg-slate-50","p-3","rounded-lg","border","xl:row-span-2"],["name","information-circle-outline"],[1,"text-slate-800","whitespace-pre-wrap","pl-8"],["name","bulb-outline"],[1,"bg-indigo-50","p-4","rounded-lg","border","border-indigo-200"],[1,"font-semibold","text-indigo-800","mb-1","flex","items-center","gap-2"],["name","checkmark-done-circle-outline"],[1,"text-indigo-900","whitespace-pre-wrap","pl-8","font-medium","text-base"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-2xl","max-h-[90vh]","flex","flex-col","m-4"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["for","date",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","date","formControlName","date",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","title",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","title","formControlName","title",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","stakeholders",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","stakeholders","formControlName","stakeholders","placeholder","\u8ACB\u7528\u9017\u865F\u5206\u9694",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","background",1,"block","text-sm","font-medium","text-gray-700"],["id","background","formControlName","background","rows","3",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","decision",1,"block","text-sm","font-medium","text-gray-700"],["id","decision","formControlName","decision","rows","4",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","rationale",1,"block","text-sm","font-medium","text-gray-700"],["id","rationale","formControlName","rationale","rows","3",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","disabled:bg-indigo-300",3,"disabled"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","m-4"],[1,"p-6","text-center"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100"],["name","warning-outline",1,"h-6","w-6","text-red-600"],[1,"mt-4","text-lg","font-semibold","text-gray-900"],[1,"mt-2","text-sm","text-gray-500"],[1,"flex","justify-center","gap-4","bg-gray-50","px-6","py-4","rounded-b-xl"],["type","button",1,"px-4","py-2","bg-red-600","text-white","rounded-md","hover:bg-red-700",3,"click"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),m(3,"\u91CD\u5927\u4E8B\u9805\u4F48\u9054"),u(),l(4,"button",3),S("click",function(){return i.openModal(null)}),x(5,"ion-icon",4),l(6,"span"),m(7,"\u65B0\u589E\u4F48\u9054"),u()()(),l(8,"div",5),P(9,A9,4,0,"div",6)(10,N9,2,0,"div",7),u()(),P(11,R9,39,3,"div",8),P(12,P9,14,1,"div",8)),t&2){let r;h(9),F(i.sortedDecisions().length>0?9:10),h(2),F(i.isModalOpen()?11:-1),h(),F((r=i.decisionToDelete())?12:-1,r)}},dependencies:[oe,$e,je,xe,ge,Be,Ue,qe],encapsulation:2,changeDetection:0});var dm=zs;var Js=(n,e)=>e.id;function F9(n,e){if(n&1&&(l(0,"option",15),m(1),u()),n&2){let t=e.$implicit;N("value",t.id),h(),E(t.name)}}function k9(n,e){if(n&1&&x(0,"div",51),n&2){let t=C().$implicit;dn("width",t.progress,"%")}}function O9(n,e){if(n&1&&x(0,"div",52),n&2){let t=C().$implicit;dn("width",t.progress,"%")}}function V9(n,e){if(n&1){let t=U();l(0,"label",49)(1,"input",53),S("change",function(r){let o=w(t).$index,s=C().$implicit,a=C();return T(a.updateProgress(s,o,r))}),u(),l(2,"span",54),m(3),u()()}if(n&2){let t=e.$implicit;h(),N("checked",t.isCompleted),h(),Q("line-through",t.isCompleted)("text-gray-400",t.isCompleted),h(),E(t.description)}}function L9(n,e){n&1&&(l(0,"p",50),m(1,"\u5C1A\u7121\u95DC\u9375\u6210\u679C"),u())}function B9(n,e){if(n&1){let t=U();l(0,"div",23)(1,"div",28)(2,"div",29)(3,"div",30),x(4,"img",31),l(5,"div")(6,"p",32),m(7),u(),l(8,"p",33),m(9),u()()(),l(10,"div",34)(11,"button",35),S("click",function(){let r=w(t).$implicit,o=C();return T(o.openModal(r))}),x(12,"ion-icon",36),u(),l(13,"button",37),S("click",function(){let r=w(t).$implicit,o=C();return T(o.requestDelete(r))}),x(14,"ion-icon",38),u()()(),l(15,"h3",39),m(16),u()(),l(17,"div",40)(18,"div",41)(19,"span",42),m(20),u(),l(21,"span",43),m(22),u()(),l(23,"div",44),P(24,k9,1,2,"div",45)(25,O9,1,2,"div",46),u(),l(26,"div",47)(27,"h4",48),m(28,"\u95DC\u9375\u6210\u679C"),u(),O(29,V9,4,6,"label",49,Js,!1,L9,2,0,"p",50),u()()()}if(n&2){let t=e.$implicit,i=C();h(4),N("src",i.getOwnerAvatarUrl(t.ownerId),On),h(3),E(i.getOwnerName(t.ownerId)),h(2),L("\u622A\u6B62\u65BC ",t.dueDate),h(7),E(t.title),h(3),N("ngClass",i.getStatusClass(t.status)),h(),E(t.status),h(2),L("",t.progress,"%"),h(2),F(t.progress<100?24:25),h(5),V(t.keyResults)}}function U9(n,e){n&1&&(l(0,"div",24),x(1,"ion-icon",55),l(2,"p",56),m(3,"\u7121\u7B26\u5408\u689D\u4EF6\u7684\u6BCF\u9031\u76EE\u6A19\u3002"),u()())}function $9(n,e){if(n&1&&x(0,"div",58),n&2){let t=C().$implicit;dn("width",t.progress,"%")}}function H9(n,e){if(n&1&&x(0,"div",52),n&2){let t=C().$implicit;dn("width",t.progress,"%")}}function G9(n,e){if(n&1){let t=U();l(0,"label",49)(1,"input",59),S("change",function(r){let o=w(t).$index,s=C().$implicit,a=C();return T(a.updateProgress(s,o,r))}),u(),l(2,"span",54),m(3),u()()}if(n&2){let t=e.$implicit;h(),N("checked",t.isCompleted),h(),Q("line-through",t.isCompleted)("text-gray-400",t.isCompleted),h(),E(t.description)}}function q9(n,e){n&1&&(l(0,"p",50),m(1,"\u5C1A\u7121\u95DC\u9375\u6210\u679C"),u())}function W9(n,e){if(n&1){let t=U();l(0,"div",23)(1,"div",28)(2,"div",29)(3,"div",30),x(4,"img",31),l(5,"div")(6,"p",32),m(7),u(),l(8,"p",33),m(9),u()()(),l(10,"div",34)(11,"button",35),S("click",function(){let r=w(t).$implicit,o=C();return T(o.openModal(r))}),x(12,"ion-icon",36),u(),l(13,"button",37),S("click",function(){let r=w(t).$implicit,o=C();return T(o.requestDelete(r))}),x(14,"ion-icon",38),u()()(),l(15,"h3",39),m(16),u()(),l(17,"div",40)(18,"div",41)(19,"span",42),m(20),u(),l(21,"span",43),m(22),u()(),l(23,"div",44),P(24,$9,1,2,"div",57)(25,H9,1,2,"div",46),u(),l(26,"div",47)(27,"h4",48),m(28,"\u95DC\u9375\u6210\u679C"),u(),O(29,G9,4,6,"label",49,Js,!1,q9,2,0,"p",50),u()()()}if(n&2){let t=e.$implicit,i=C();h(4),N("src",i.getOwnerAvatarUrl(t.ownerId),On),h(3),E(i.getOwnerName(t.ownerId)),h(2),L("\u622A\u6B62\u65BC ",t.dueDate),h(7),E(t.title),h(3),N("ngClass",i.getStatusClass(t.status)),h(),E(t.status),h(2),L("",t.progress,"%"),h(2),F(t.progress<100?24:25),h(5),V(t.keyResults)}}function j9(n,e){n&1&&(l(0,"div",24),x(1,"ion-icon",55),l(2,"p",56),m(3,"\u7121\u7B26\u5408\u689D\u4EF6\u7684\u6708\u5EA6\u76EE\u6A19\u3002"),u()())}function z9(n,e){if(n&1&&(l(0,"option",15),m(1),u()),n&2){let t=e.$implicit;N("value",t.id),h(),E(t.name)}}function Y9(n,e){if(n&1){let t=U();l(0,"div",84),x(1,"input",89),l(2,"button",90),S("click",function(){let r=w(t).$index,o=C(2);return T(o.removeKeyResult(r))}),x(3,"ion-icon",38),u()()}if(n&2){let t=e.$index;N("formGroupName",t)}}function J9(n,e){if(n&1){let t=U();l(0,"div",27)(1,"div",60)(2,"div",61)(3,"h3",62),m(4),u(),l(5,"button",63),S("click",function(){w(t);let r=C();return T(r.closeModal())}),x(6,"ion-icon",64),u()(),l(7,"div",65)(8,"form",66),S("ngSubmit",function(){w(t);let r=C();return T(r.handleFormSubmit())}),l(9,"div")(10,"label",67),m(11,"\u76EE\u6A19*"),u(),x(12,"input",68),u(),l(13,"div",69)(14,"div")(15,"label",70),m(16,"\u8CA0\u8CAC\u4EBA*"),u(),l(17,"select",71)(18,"option",72),m(19,"\u8ACB\u9078\u64C7"),u(),O(20,z9,2,2,"option",15,Js),u()(),l(22,"div")(23,"label",73),m(24,"\u622A\u6B62\u65E5\u671F*"),u(),x(25,"input",74),u()(),l(26,"div",69)(27,"div")(28,"label",75),m(29,"\u9031\u671F*"),u(),l(30,"select",76)(31,"option",77),m(32,"\u6708\u5EA6"),u(),l(33,"option",78),m(34,"\u6BCF\u9031"),u()()(),l(35,"div")(36,"label",79),m(37,"\u72C0\u614B*"),u(),l(38,"select",80)(39,"option",9),m(40,"\u9032\u884C\u4E2D"),u(),l(41,"option",10),m(42,"\u5DF2\u5B8C\u6210"),u(),l(43,"option",11),m(44,"\u843D\u5F8C"),u(),l(45,"option",12),m(46,"\u5DF2\u64F1\u7F6E"),u()()()(),l(47,"div",81)(48,"h4",82),m(49,"\u95DC\u9375\u6210\u679C"),u(),l(50,"div",83),O(51,Y9,4,1,"div",84,_n),u(),l(53,"button",85),S("click",function(){w(t);let r=C();return T(r.addKeyResult())}),m(54,"+ \u65B0\u589E\u95DC\u9375\u6210\u679C"),u()(),l(55,"div",86)(56,"button",87),S("click",function(){w(t);let r=C();return T(r.closeModal())}),m(57,"\u53D6\u6D88"),u(),l(58,"button",88),m(59,"\u5132\u5B58"),u()()()()()()}if(n&2){let t=C();h(4),E(t.editingGoal()?"\u7DE8\u8F2F\u500B\u4EBA\u76EE\u6A19":"\u65B0\u589E\u500B\u4EBA\u76EE\u6A19"),h(4),N("formGroup",t.goalForm),h(12),V(t.shareholders()),h(31),V(t.keyResults.controls),h(7),N("disabled",t.goalForm.invalid)}}function K9(n,e){if(n&1){let t=U();l(0,"div",27)(1,"div",91)(2,"div",92)(3,"div",93),x(4,"ion-icon",94),u(),l(5,"h3",95),m(6,"\u78BA\u5B9A\u8981\u522A\u9664\u76EE\u6A19\u55CE\uFF1F"),u(),l(7,"p",96),m(8),u()(),l(9,"div",97)(10,"button",87),S("click",function(){w(t);let r=C();return T(r.cancelDelete())}),m(11,"\u53D6\u6D88"),u(),l(12,"button",98),S("click",function(){w(t);let r=C();return T(r.confirmDelete())}),m(13,"\u78BA\u8A8D\u522A\u9664"),u()()()()}n&2&&(h(8),L("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u76EE\u6A19\u300C",e.title,"\u300D\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"))}var Ys=class Ys{constructor(){this.fb=R(ze);this.isModalOpen=D(!1);this.editingGoal=D(null);this.goalToDelete=D(null);this.statusFilter=D("");this.ownerFilter=D("");this.shareholders=D([{id:"sh1",name:"\u80A1\u6771 A"},{id:"sh2",name:"\u80A1\u6771 B"},{id:"sh3",name:"\u80A1\u6771 C"},{id:"sh4",name:"\u71DF\u904B\u7D93\u7406"}]);this.goals=D([{id:"GOAL001",title:"\u63D0\u5347 2026 \u5E74 Q3 \u71DF\u6536 20%",ownerId:"sh1",dueDate:"2026-09-30",status:"\u9032\u884C\u4E2D",progress:33,period:"monthly",keyResults:[{id:"KR1-1",description:"\u63A8\u51FA\u4E09\u6B3E\u590F\u5B63\u7279\u8ABF\u98F2\u54C1",isCompleted:!0},{id:"KR1-2",description:"\u8209\u8FA6\u5169\u5834 VIP \u54C1\u9152\u6703",isCompleted:!1},{id:"KR1-3",description:"\u8207\u9644\u8FD1\u5546\u8FA6\u7C3D\u8A02\u4E0B\u5348\u8336\u5408\u4F5C",isCompleted:!1}]},{id:"GOAL002",title:"\u512A\u5316\u96EA\u8304\u5EAB\u5B58\u6210\u672C 15%",ownerId:"sh2",dueDate:"2026-08-31",status:"\u843D\u5F8C",progress:0,period:"monthly",keyResults:[{id:"KR2-1",description:"\u5C0E\u5165\u65B0\u7684\u5EAB\u5B58\u7BA1\u7406\u7CFB\u7D71",isCompleted:!1},{id:"KR2-2",description:"\u958B\u767C\u81F3\u5C11\u5169\u5BB6\u65B0\u7684\u96EA\u8304\u4F9B\u61C9\u5546",isCompleted:!1}]},{id:"GOAL003",title:"\u5B8C\u6210\u7DB2\u7AD9\u6539\u7248\u4E26\u4E0A\u7DDA",ownerId:"sh4",dueDate:"2026-07-31",status:"\u5DF2\u5B8C\u6210",progress:100,period:"monthly",keyResults:[{id:"KR3-1",description:"\u78BA\u8A8D\u65B0\u7DB2\u7AD9 UI/UX \u8A2D\u8A08",isCompleted:!0},{id:"KR3-2",description:"\u5B8C\u6210\u524D\u7AEF\u8207\u5F8C\u7AEF\u958B\u767C",isCompleted:!0},{id:"KR3-3",description:"\u5B8C\u6210\u4F7F\u7528\u8005\u6E2C\u8A66\u4E26\u4FEE\u5FA9 Bug",isCompleted:!0}]},{id:"GOAL004",title:"\u672C\u5468\u5B8C\u6210\u4F9B\u61C9\u5546\u806F\u7E6B",ownerId:"sh2",dueDate:"2024-08-04",status:"\u9032\u884C\u4E2D",progress:50,period:"weekly",keyResults:[{id:"KR4-1",description:"\u806F\u7E6B A \u4F9B\u61C9\u5546",isCompleted:!0},{id:"KR4-2",description:"\u806F\u7E6B B \u4F9B\u61C9\u5546",isCompleted:!1}]},{id:"GOAL005",title:"\u672C\u5468\u5B8C\u6210\u5468\u5831",ownerId:"sh1",dueDate:"2024-08-02",status:"\u5DF2\u5B8C\u6210",progress:100,period:"weekly",keyResults:[{id:"KR5-1",description:"\u6574\u7406\u672C\u5468\u6578\u64DA",isCompleted:!0},{id:"KR5-2",description:"\u64B0\u5BEB\u5831\u544A",isCompleted:!0}]}]);this.baseFilteredGoals=H(()=>{let e=this.statusFilter(),t=this.ownerFilter();return this.goals().filter(i=>!e||i.status===e).filter(i=>!t||i.ownerId===t).sort((i,r)=>new Date(r.dueDate).getTime()-new Date(i.dueDate).getTime())});this.monthlyGoals=H(()=>this.baseFilteredGoals().filter(e=>e.period==="monthly"));this.weeklyGoals=H(()=>this.baseFilteredGoals().filter(e=>e.period==="weekly"));this.goalForm=this.fb.group({title:["",$.required],ownerId:["",$.required],dueDate:["",$.required],period:["monthly",$.required],status:["\u9032\u884C\u4E2D",$.required],keyResults:this.fb.array([])})}get keyResults(){return this.goalForm.get("keyResults")}getOwnerName(e){return this.shareholders().find(t=>t.id===e)?.name||"\u672A\u77E5"}getOwnerAvatarUrl(e){let t=this.getOwnerName(e);return`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=random&color=fff&font-size=0.5`}getStatusClass(e){return{"bg-blue-100 text-blue-800":e==="\u9032\u884C\u4E2D","bg-green-100 text-green-800":e==="\u5DF2\u5B8C\u6210","bg-yellow-100 text-yellow-800":e==="\u843D\u5F8C","bg-gray-100 text-gray-800":e==="\u5DF2\u64F1\u7F6E"}}resetFilters(){this.statusFilter.set(""),this.ownerFilter.set("")}openModal(e=null){this.editingGoal.set(e),this.goalForm.reset({status:"\u9032\u884C\u4E2D",period:"monthly"}),this.keyResults.clear(),e?(this.goalForm.patchValue(e),e.keyResults.forEach(t=>this.addKeyResult(t.description,t.isCompleted))):this.goalForm.patchValue({dueDate:new Date().toISOString().split("T")[0]}),this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1)}addKeyResult(e="",t=!1){let i=this.fb.group({description:[e,$.required],isCompleted:[t]});this.keyResults.push(i)}removeKeyResult(e){this.keyResults.removeAt(e)}handleFormSubmit(){if(this.goalForm.invalid)return;let e=this.goalForm.value,t=this.editingGoal(),i=e.keyResults.map(s=>({id:`KR${Date.now()}-${Math.random()}`,description:s.description,isCompleted:s.isCompleted})),r=i.length>0?i.filter(s=>s.isCompleted).length/i.length*100:0,o={title:e.title,ownerId:e.ownerId,dueDate:e.dueDate,status:e.status,period:e.period,keyResults:i,progress:Math.round(r)};t?this.goals.update(s=>s.map(a=>a.id===t.id?k(k({},a),o):a)):this.goals.update(s=>[...s,k({id:`GOAL${Date.now()}`},o)]),this.closeModal()}updateProgress(e,t,i){let r=i.target.checked;this.goals.update(o=>o.map(s=>{if(s.id===e.id){let a=[...s.keyResults];a[t]=q(k({},a[t]),{isCompleted:r});let c=a.length>0?a.filter(d=>d.isCompleted).length/a.length*100:0;return q(k({},s),{keyResults:a,progress:Math.round(c)})}return s}))}requestDelete(e){this.goalToDelete.set(e)}confirmDelete(){this.goalToDelete()&&(this.goals.update(e=>e.filter(t=>t.id!==this.goalToDelete().id)),this.cancelDelete())}cancelDelete(){this.goalToDelete.set(null)}};Ys.\u0275fac=function(t){return new(t||Ys)},Ys.\u0275cmp=ee({type:Ys,selectors:[["app-goal-progress"]],decls:53,vars:6,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","add-outline"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","p-4","bg-white","rounded-xl","shadow-md"],["for","statusFilter",1,"text-sm","font-medium","text-gray-600"],["id","statusFilter",1,"w-full","mt-1","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-50",3,"ngModelChange","ngModel"],["value",""],["value","\u9032\u884C\u4E2D"],["value","\u5DF2\u5B8C\u6210"],["value","\u843D\u5F8C"],["value","\u5DF2\u64F1\u7F6E"],["for","ownerFilter",1,"text-sm","font-medium","text-gray-600"],["id","ownerFilter",1,"w-full","mt-1","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-50",3,"ngModelChange","ngModel"],[3,"value"],[1,"flex","items-end","justify-end"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-8","pt-4"],[1,"text-2xl","font-bold","text-gray-800","mb-4","pb-2","border-b-2","border-teal-500","flex","items-center","gap-2"],["name","today-outline"],[1,"space-y-4"],[1,"bg-white","rounded-xl","shadow-md","border","flex","flex-col","group","transition-all","duration-300","hover:shadow-lg","hover:-translate-y-1"],[1,"bg-white","p-6","rounded-xl","border","text-center","text-gray-500"],[1,"text-2xl","font-bold","text-gray-800","mb-4","pb-2","border-b-2","border-indigo-500","flex","items-center","gap-2"],["name","calendar-outline"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"p-4"],[1,"flex","justify-between","items-start"],[1,"flex","items-center","gap-3"],["alt","avatar",1,"w-10","h-10","rounded-full",3,"src"],[1,"font-semibold","text-gray-800"],[1,"text-xs","text-gray-500"],[1,"flex","items-center","gap-1","shrink-0","opacity-0","group-hover:opacity-100","transition-opacity"],["title","\u7DE8\u8F2F",1,"text-gray-400","hover:text-indigo-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],["name","create-outline"],["title","\u522A\u9664",1,"text-gray-400","hover:text-red-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],["name","trash-outline"],[1,"text-base","font-bold","text-gray-800","mt-3"],[1,"p-4","flex-grow","flex","flex-col","justify-end"],[1,"flex","items-center","justify-between","mb-1"],[1,"text-xs","font-semibold","px-2","py-1","rounded-full",3,"ngClass"],[1,"text-sm","font-semibold"],[1,"w-full","bg-slate-100","rounded-full","h-3.5"],[1,"bg-teal-600","h-3.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #5eead4, #0d9488)",3,"width"],[1,"bg-green-500","h-3.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #4ade80, #16a34a)",3,"width"],[1,"mt-4","space-y-1","border-t","pt-4"],[1,"text-xs","font-semibold","text-gray-500","uppercase","px-2"],[1,"flex","items-start","gap-3","text-sm","text-gray-700","cursor-pointer","p-2","rounded-lg","hover:bg-slate-50"],[1,"text-xs","text-gray-400","px-2"],[1,"bg-teal-600","h-3.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #5eead4, #0d9488)"],[1,"bg-green-500","h-3.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #4ade80, #16a34a)"],["type","checkbox",1,"mt-1","h-4","w-4","rounded","border-gray-300","text-teal-600","focus:ring-teal-500","shrink-0",3,"change","checked"],[1,"transition-colors","flex-1"],["name","flag-outline",1,"text-4xl","text-gray-400"],[1,"mt-2"],[1,"bg-indigo-600","h-3.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #818cf8, #4f46e5)",3,"width"],[1,"bg-indigo-600","h-3.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #818cf8, #4f46e5)"],["type","checkbox",1,"mt-1","h-4","w-4","rounded","border-gray-300","text-indigo-600","focus:ring-indigo-500","shrink-0",3,"change","checked"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-2xl","max-h-[90vh]","flex","flex-col","m-4"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],[1,"space-y-4",3,"ngSubmit","formGroup"],["for","title",1,"block","text-sm","font-medium","text-gray-700"],["id","title","formControlName","title",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["for","ownerId",1,"block","text-sm","font-medium","text-gray-700"],["id","ownerId","formControlName","ownerId",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["value","","disabled",""],["for","dueDate",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","dueDate","formControlName","dueDate",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","period",1,"block","text-sm","font-medium","text-gray-700"],["id","period","formControlName","period",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["value","monthly"],["value","weekly"],["for","status",1,"block","text-sm","font-medium","text-gray-700"],["id","status","formControlName","status",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"space-y-2","pt-2"],[1,"text-sm","font-medium","text-gray-700"],["formArrayName","keyResults",1,"space-y-2"],[1,"flex","items-center","gap-2",3,"formGroupName"],["type","button",1,"text-sm","font-medium","text-indigo-600","hover:text-indigo-800",3,"click"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","disabled:bg-indigo-300",3,"disabled"],["formControlName","description","placeholder","\u8F38\u5165\u95DC\u9375\u6210\u679C\u63CF\u8FF0...",1,"flex-grow","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2","text-sm"],["type","button","title","\u522A\u9664",1,"text-red-500","hover:text-red-700","p-1.5","rounded-full","hover:bg-red-100",3,"click"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","m-4"],[1,"p-6","text-center"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100"],["name","warning-outline",1,"h-6","w-6","text-red-600"],[1,"mt-4","text-lg","font-semibold","text-gray-900"],[1,"mt-2","text-sm","text-gray-500"],[1,"flex","justify-center","gap-4","bg-gray-50","px-6","py-4","rounded-b-xl"],["type","button",1,"px-4","py-2","bg-red-600","text-white","rounded-md","hover:bg-red-700",3,"click"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),m(3,"\u500B\u4EBA\u76EE\u6A19\u9032\u5EA6"),u(),l(4,"button",3),S("click",function(){return i.openModal(null)}),x(5,"ion-icon",4),l(6,"span"),m(7,"\u65B0\u589E\u500B\u4EBA\u76EE\u6A19"),u()()(),l(8,"div",5)(9,"div")(10,"label",6),m(11,"\u72C0\u614B"),u(),l(12,"select",7),ne("ngModelChange",function(o){return re(i.statusFilter,o)||(i.statusFilter=o),o}),l(13,"option",8),m(14,"\u6240\u6709\u72C0\u614B"),u(),l(15,"option",9),m(16,"\u9032\u884C\u4E2D"),u(),l(17,"option",10),m(18,"\u5DF2\u5B8C\u6210"),u(),l(19,"option",11),m(20,"\u843D\u5F8C"),u(),l(21,"option",12),m(22,"\u5DF2\u64F1\u7F6E"),u()()(),l(23,"div")(24,"label",13),m(25,"\u8CA0\u8CAC\u4EBA"),u(),l(26,"select",14),ne("ngModelChange",function(o){return re(i.ownerFilter,o)||(i.ownerFilter=o),o}),l(27,"option",8),m(28,"\u6240\u6709\u8CA0\u8CAC\u4EBA"),u(),O(29,F9,2,2,"option",15,Js),u()(),l(31,"div",16)(32,"button",17),S("click",function(){return i.resetFilters()}),x(33,"ion-icon",18),u()()(),l(34,"div",19)(35,"div")(36,"h2",20),x(37,"ion-icon",21),m(38," \u6BCF\u9031\u76EE\u6A19 "),u(),l(39,"div",22),O(40,B9,32,9,"div",23,Js,!1,U9,4,0,"div",24),u()(),l(43,"div")(44,"h2",25),x(45,"ion-icon",26),m(46," \u6708\u5EA6\u76EE\u6A19 "),u(),l(47,"div",22),O(48,W9,32,9,"div",23,Js,!1,j9,4,0,"div",24),u()()()(),P(51,J9,60,3,"div",27),P(52,K9,14,1,"div",27)),t&2){let r;h(12),te("ngModel",i.statusFilter),h(14),te("ngModel",i.ownerFilter),h(3),V(i.shareholders()),h(11),V(i.weeklyGoals()),h(8),V(i.monthlyGoals()),h(3),F(i.isModalOpen()?51:-1),h(),F((r=i.goalToDelete())?52:-1,r)}},dependencies:[oe,Og,$e,je,Fe,ke,xe,Ae,ge,Be,Ue,qe,Ei,bi,Ee,we],encapsulation:2,changeDetection:0});var fm=Ys;var Q9=(n,e)=>e.id;function Z9(n,e){if(n&1&&(l(0,"option",11),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),E(t)}}function X9(n,e){if(n&1&&(l(0,"option",11),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),E(t)}}function eB(n,e){if(n&1){let t=U();l(0,"tr",19)(1,"td",21),m(2),u(),l(3,"td",22),m(4),u(),l(5,"td",22)(6,"span",23),m(7),u()(),l(8,"td",22)(9,"span",23),m(10),u()(),l(11,"td",24),m(12),u(),l(13,"td",22)(14,"div",25)(15,"button",26),S("click",function(){let r=w(t).$implicit,o=C();return T(o.openModal(r))}),x(16,"ion-icon",27),u(),l(17,"button",28),S("click",function(){let r=w(t).$implicit,o=C();return T(o.requestDelete(r))}),x(18,"ion-icon",29),u()()()()}if(n&2){let t=e.$implicit,i=C();h(2),E(t.name),h(2),E(t.email),h(2),De(i.getRoleClass(t.role)),h(),E(t.role),h(2),De(i.getStatusClass(t.status)),h(),E(t.status),h(2),E(t.lastLogin)}}function tB(n,e){n&1&&(l(0,"tr")(1,"td",30),m(2,"\u7121\u7B26\u5408\u689D\u4EF6\u7684\u4F7F\u7528\u8005\u3002"),u()())}function nB(n,e){if(n&1&&(l(0,"option",11),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),E(t)}}function iB(n,e){if(n&1&&(l(0,"option",11),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),E(t)}}function rB(n,e){if(n&1){let t=U();l(0,"div",20)(1,"div",31)(2,"div",32)(3,"h3",33),m(4),u(),l(5,"button",34),S("click",function(){w(t);let r=C();return T(r.closeModal())}),x(6,"ion-icon",35),u()(),l(7,"div",36)(8,"form",37),S("ngSubmit",function(){w(t);let r=C();return T(r.handleFormSubmit())}),l(9,"label",38)(10,"span",39),m(11,"\u540D\u7A31*"),u(),x(12,"input",40),u(),l(13,"label",38)(14,"span",39),m(15,"Email*"),u(),x(16,"input",41),u(),l(17,"div",42)(18,"label",38)(19,"span",39),m(20,"\u89D2\u8272*"),u(),l(21,"select",43),O(22,nB,2,2,"option",11,W),u()(),l(24,"label",38)(25,"span",39),m(26,"\u72C0\u614B*"),u(),l(27,"select",44),O(28,iB,2,2,"option",11,W),u()()(),l(30,"div",45)(31,"button",46),S("click",function(){w(t);let r=C();return T(r.closeModal())}),m(32,"\u53D6\u6D88"),u(),l(33,"button",47),m(34,"\u5132\u5B58"),u()()()()()()}if(n&2){let t=C();h(4),E(t.editingUser()?"\u7DE8\u8F2F\u4F7F\u7528\u8005":"\u65B0\u589E\u4F7F\u7528\u8005"),h(4),N("formGroup",t.userForm),h(14),V(t.roles()),h(6),V(t.statuses()),h(5),N("disabled",t.userForm.invalid)}}function oB(n,e){if(n&1){let t=U();l(0,"div",20)(1,"div",48)(2,"div",49)(3,"div",50),x(4,"ion-icon",51),u(),l(5,"h3",52),m(6,"\u78BA\u5B9A\u8981\u522A\u9664\u4F7F\u7528\u8005\u55CE\uFF1F"),u(),l(7,"p",53),m(8),u()(),l(9,"div",54)(10,"button",46),S("click",function(){w(t);let r=C();return T(r.cancelDelete())}),m(11,"\u53D6\u6D88"),u(),l(12,"button",55),S("click",function(){w(t);let r=C();return T(r.confirmDelete())}),m(13,"\u78BA\u8A8D\u522A\u9664"),u()()()()}n&2&&(h(8),L("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u300C",e.name,"\u300D\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"))}var Ks=class Ks{constructor(){this.baseUrl="/api/admin";this.authService=R(nt);this.fb=R(ze);this.http=R(zt);this.isModalOpen=D(!1);this.editingUser=D(null);this.userToDelete=D(null);this.searchTerm=D("");this.roleFilter=D("");this.statusFilter=D("");this.users=D([]);this.roleOptions=D([]);this.roles=D(["\u8D85\u7D1A\u7BA1\u7406\u54E1","\u7BA1\u7406\u54E1","\u8CA1\u52D9","\u71DF\u904B"]);this.statuses=D(["\u555F\u7528","\u505C\u7528"]);this.isLoading=D(!1);this.error=D(null);this.userForm=this.fb.group({name:["",$.required],email:["",[$.required,$.email]],role:["\u71DF\u904B",$.required],status:["\u555F\u7528",$.required]});this.filteredUsers=H(()=>{let e=this.searchTerm().toLowerCase(),t=this.roleFilter(),i=this.statusFilter();return this.users().filter(r=>!t||r.role===t).filter(r=>!i||r.status===i).filter(r=>!e||r.name.toLowerCase().includes(e)||r.email.toLowerCase().includes(e))})}resetFilters(){this.searchTerm.set(""),this.roleFilter.set(""),this.statusFilter.set("")}ngOnInit(){this.loadRoles(),this.loadUsers()}loadRoles(){let e=this.getAuthHeaders();e&&this.http.get(`${this.baseUrl}/roles?limit=100`,{headers:e}).subscribe({next:t=>{let i=t?.data||[];this.roleOptions.set(i),i.length>0&&this.roles.set(i.map(r=>r.display_name))},error:()=>{}})}loadUsers(){let e=this.getAuthHeaders();if(!e){this.error.set("\u5C1A\u672A\u767B\u5165");return}this.isLoading.set(!0),this.error.set(null);let t=[];this.searchTerm()&&t.push(`search=${encodeURIComponent(this.searchTerm())}`);let i=this.mapRoleToCode(this.roleFilter()||void 0);i&&t.push(`role=${encodeURIComponent(i)}`);let r=t.length?`?${t.join("&")}`:"";this.http.get(`${this.baseUrl}/users${r}`,{headers:e}).subscribe({next:o=>{let a=(o?.data||[]).map(c=>this.mapUser(c));this.users.set(a),this.isLoading.set(!1)},error:o=>{this.error.set(o.error?.error||"\u8F09\u5165\u4F7F\u7528\u8005\u5931\u6557"),this.isLoading.set(!1)}})}openModal(e=null){this.editingUser.set(e),this.userForm.reset({role:"\u71DF\u904B",status:"\u555F\u7528"}),e&&this.userForm.patchValue(e),this.userForm.updateValueAndValidity(),this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1)}handleFormSubmit(){if(this.userForm.invalid)return;let e=this.getAuthHeaders();if(!e){this.error.set("\u5C1A\u672A\u767B\u5165");return}let t=this.userForm.value,i=this.mapRoleToId(t.role),r={name:t.name,email:t.email,status:this.mapStatusToApi(t.status),roleIds:i?[i]:[]};if(this.editingUser()){let o=this.editingUser().id;this.http.put(`${this.baseUrl}/users/${o}`,r,{headers:e}).subscribe({next:()=>{this.closeModal(),this.loadUsers()},error:s=>{this.error.set(s.error?.error||"\u66F4\u65B0\u4F7F\u7528\u8005\u5931\u6557")}});return}this.http.post(`${this.baseUrl}/users`,r,{headers:e}).subscribe({next:()=>{this.closeModal(),this.loadUsers()},error:o=>{this.error.set(o.error?.error||"\u65B0\u589E\u4F7F\u7528\u8005\u5931\u6557")}})}requestDelete(e){this.userToDelete.set(e)}confirmDelete(){if(!this.userToDelete())return;let e=this.getAuthHeaders();if(!e){this.error.set("\u5C1A\u672A\u767B\u5165");return}let t=this.userToDelete().id;this.http.delete(`${this.baseUrl}/users/${t}`,{headers:e}).subscribe({next:()=>{this.cancelDelete(),this.loadUsers()},error:i=>{this.error.set(i.error?.error||"\u522A\u9664\u4F7F\u7528\u8005\u5931\u6557")}})}cancelDelete(){this.userToDelete.set(null)}getRoleClass(e){switch(e){case"\u7BA1\u7406\u54E1":return"bg-red-100 text-red-800";case"\u8CA1\u52D9":return"bg-blue-100 text-blue-800";case"\u71DF\u904B":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}}getStatusClass(e){return e==="\u555F\u7528"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}getAuthHeaders(){let e=this.authService.getToken();return e?new Ft({Authorization:`Bearer ${e}`,"Content-Type":"application/json"}):null}mapUser(e){let t=e.role_names&&e.role_names[0]||e.role_codes&&e.role_codes[0]||"\u71DF\u904B",i=this.normalizeRole(t),r=this.mapStatusFromApi(e.status);return{id:String(e.admin_id),name:e.name,email:e.email,role:i,status:r,lastLogin:this.formatDate(e.last_login_at)}}normalizeRole(e){return e==="super_admin"||e==="\u8D85\u7D1A\u7BA1\u7406\u54E1"?"\u8D85\u7D1A\u7BA1\u7406\u54E1":e==="admin"||e==="\u7BA1\u7406\u54E1"?"\u7BA1\u7406\u54E1":e==="finance"||e==="\u8CA1\u52D9"?"\u8CA1\u52D9":"\u71DF\u904B"}mapRoleToId(e){return e?this.roleOptions().find(i=>i.display_name===e||i.role_name===e)?.role_id??null:null}mapRoleToCode(e){return e?this.roleOptions().find(i=>i.display_name===e||i.role_name===e)?.role_name??null:null}mapStatusToApi(e){if(e)return e==="\u555F\u7528"?"active":"inactive"}mapStatusFromApi(e){return e==="active"?"\u555F\u7528":"\u505C\u7528"}formatDate(e){return e?new Date(e).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-"}};Ks.\u0275fac=function(t){return new(t||Ks)},Ks.\u0275cmp=ee({type:Ks,selectors:[["app-user-management"]],decls:49,vars:6,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","add-outline"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","p-4","bg-gray-50","rounded-lg","mb-6"],[1,"md:col-span-2"],["type","text","placeholder","\u641C\u5C0B\u540D\u7A31\u6216 Email...",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"flex","items-center","gap-2","md:col-span-4","justify-end"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-4","py-3"],[1,"border-b","hover:bg-gray-50"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"px-4","py-2","font-medium"],[1,"px-4","py-2"],[1,"px-2","py-1","text-xs","font-semibold","rounded-full"],[1,"px-4","py-2","text-gray-500"],[1,"flex","items-center","gap-2"],["title","\u7DE8\u8F2F",1,"text-indigo-600","hover:text-indigo-800","p-1",3,"click"],["name","create-outline",1,"text-lg"],["title","\u522A\u9664",1,"text-red-500","hover:text-red-700","p-1",3,"click"],["name","trash-outline",1,"text-lg"],["colspan","6",1,"text-center","py-8","text-gray-500"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-lg","m-4"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"block"],[1,"text-gray-700"],["formControlName","name",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["type","email","formControlName","email",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"grid","grid-cols-2","gap-4"],["formControlName","role",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","status",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","disabled:bg-indigo-300",3,"disabled"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","m-4"],[1,"p-6","text-center"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100"],["name","warning-outline",1,"h-6","w-6","text-red-600"],[1,"mt-4","text-lg","font-semibold","text-gray-900"],[1,"mt-2","text-sm","text-gray-500"],[1,"flex","justify-center","gap-4","bg-gray-50","px-6","py-4","rounded-b-xl"],["type","button",1,"px-4","py-2","bg-red-600","text-white","rounded-md","hover:bg-red-700",3,"click"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),m(3,"\u4F7F\u7528\u8005\u7BA1\u7406"),u(),l(4,"button",3),S("click",function(){return i.openModal(null)}),x(5,"ion-icon",4),l(6,"span"),m(7,"\u65B0\u589E\u4F7F\u7528\u8005"),u()()(),l(8,"div",5)(9,"div",6)(10,"div",7)(11,"input",8),S("ngModelChange",function(o){return i.searchTerm.set(o)}),u()(),l(12,"div")(13,"select",9),S("ngModelChange",function(o){return i.roleFilter.set(o)}),l(14,"option",10),m(15,"\u6240\u6709\u89D2\u8272"),u(),O(16,Z9,2,2,"option",11,W),u()(),l(18,"div")(19,"select",9),S("ngModelChange",function(o){return i.statusFilter.set(o)}),l(20,"option",10),m(21,"\u6240\u6709\u72C0\u614B"),u(),O(22,X9,2,2,"option",11,W),u()(),l(24,"div",12)(25,"button",13),S("click",function(){return i.resetFilters()}),x(26,"ion-icon",14),u()()(),l(27,"div",15)(28,"table",16)(29,"thead",17)(30,"tr")(31,"th",18),m(32,"\u540D\u7A31"),u(),l(33,"th",18),m(34,"Email"),u(),l(35,"th",18),m(36,"\u89D2\u8272"),u(),l(37,"th",18),m(38,"\u72C0\u614B"),u(),l(39,"th",18),m(40,"\u6700\u5F8C\u767B\u5165"),u(),l(41,"th",18),m(42,"\u64CD\u4F5C"),u()()(),l(43,"tbody"),O(44,eB,19,9,"tr",19,Q9,!1,tB,3,0,"tr"),u()()()()(),P(47,rB,35,3,"div",20),P(48,oB,14,1,"div",20)),t&2){let r;h(11),N("ngModel",i.searchTerm()),h(2),N("ngModel",i.roleFilter()),h(3),V(i.roles()),h(3),N("ngModel",i.statusFilter()),h(3),V(i.statuses()),h(22),V(i.filteredUsers()),h(3),F(i.isModalOpen()?47:-1),h(),F((r=i.userToDelete())?48:-1,r)}},dependencies:[oe,$e,je,Fe,ke,xe,Ae,ge,Be,Ue,qe,Ee,we],encapsulation:2,changeDetection:0});var mm=Ks;var pm=(n,e)=>e.id;function sB(n,e){if(n&1&&(l(0,"option",10),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),E(t)}}function aB(n,e){if(n&1&&(l(0,"option",10),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),E(t)}}function lB(n,e){if(n&1&&(l(0,"option",10),m(1),u()),n&2){let t=e.$implicit;N("value",t.id),h(),E(t.name)}}function uB(n,e){if(n&1&&(l(0,"div",45),x(1,"ion-icon",46),l(2,"span"),m(3),u()()),n&2){let t=e,i=C(2);De(i.getDaysLeftClass(t.days,t.label)),h(3),E(t.label==="\u5DF2\u903E\u671F"?t.label+" "+t.days+" \u5929":t.days+" "+t.label)}}function cB(n,e){if(n&1&&x(0,"img",34),n&2){let t=C().$implicit,i=C();N("src",i.getAssigneeAvatarUrl(t.assigneeId),On)}}function dB(n,e){n&1&&(l(0,"div",35),x(1,"ion-icon",47),u())}function fB(n,e){if(n&1){let t=U();l(0,"input",55),S("blur",function(r){w(t);let o=C(2).$implicit,s=C();return T(s.finishEditingProgress(o,r))})("keydown.enter",function(r){w(t);let o=C(2).$implicit,s=C();return T(s.finishEditingProgress(o,r))}),u()}if(n&2){let t=C(2).$implicit;N("value",t.currentValue)}}function mB(n,e){if(n&1&&(l(0,"span",51),m(1),u()),n&2){let t=C(2).$implicit,i=C();h(),E(i.formatNumber(t.currentValue))}}function pB(n,e){if(n&1&&x(0,"div",56),n&2){let t=C();dn("width",t,"%")}}function gB(n,e){if(n&1&&x(0,"div",57),n&2){let t=C();dn("width",t,"%")}}function hB(n,e){if(n&1){let t=U();l(0,"div",48)(1,"div",49,0),S("click",function(){w(t);let r=Hc(2),o=C().$implicit,s=C();return T(s.startEditingProgress(o.id,r))}),P(3,fB,1,1,"input",50)(4,mB,2,1,"span",51),m(5),u(),l(6,"span"),m(7),u()(),l(8,"div",52),P(9,pB,1,2,"div",53)(10,gB,1,2,"div",54),u()}if(n&2){let t=e,i=C().$implicit,r=C();h(3),F(r.editingProgressId()===i.id?3:4),h(2),yt(" / ",r.formatNumber(i.targetValue)," ",i.unit," "),h(),De(t<100?"text-indigo-600":"text-green-600"),h(),L("",t.toFixed(0),"%"),h(2),F(t<100?9:10)}}function yB(n,e){if(n&1){let t=U();l(0,"div",23)(1,"div",29)(2,"h3",30),m(3),u(),P(4,uB,4,3,"div",31),u(),l(5,"div",32)(6,"div",33),P(7,cB,1,1,"img",34)(8,dB,2,0,"div",35),l(9,"span",36),m(10),u()(),l(11,"span",37),m(12),u(),l(13,"span",38),m(14),u()(),l(15,"div",39),P(16,hB,11,7),u(),l(17,"div",40)(18,"button",41),S("click",function(){let r=w(t).$implicit,o=C();return T(o.openModal(r))}),x(19,"ion-icon",42),u(),l(20,"button",43),S("click",function(){let r=w(t).$implicit,o=C();return T(o.requestDelete(r))}),x(21,"ion-icon",44),u()()()}if(n&2){let t,i,r=e.$implicit,o=C();h(3),E(r.title),h(),F((t=o.getDaysLeft(r.endDate))?4:-1,t),h(3),F(r.assigneeId?7:8),h(3),E(o.getAssigneeName(r.assigneeId)),h(),De(o.getTypeClass(r.type)),h(),E(r.type),h(),De(o.getStatusClass(r.status)),h(),E(r.status),h(2),F((i=o.getProgressBarWidth(r))?16:-1,i)}}function vB(n,e){n&1&&(l(0,"div",24),x(1,"ion-icon",58),l(2,"p",59),m(3,"\u7121\u7B26\u5408\u689D\u4EF6\u7684\u6708\u5EA6\u76EE\u6A19\u3002"),u()())}function _B(n,e){if(n&1&&(l(0,"div",45),x(1,"ion-icon",46),l(2,"span"),m(3),u()()),n&2){let t=e,i=C(2);De(i.getDaysLeftClass(t.days,t.label)),h(3),E(t.label==="\u5DF2\u903E\u671F"?t.label+" "+t.days+" \u5929":t.days+" "+t.label)}}function CB(n,e){if(n&1&&x(0,"img",34),n&2){let t=C().$implicit,i=C();N("src",i.getAssigneeAvatarUrl(t.assigneeId),On)}}function xB(n,e){n&1&&(l(0,"div",35),x(1,"ion-icon",47),u())}function EB(n,e){if(n&1){let t=U();l(0,"input",65),S("blur",function(r){w(t);let o=C(2).$implicit,s=C();return T(s.finishEditingProgress(o,r))})("keydown.enter",function(r){w(t);let o=C(2).$implicit,s=C();return T(s.finishEditingProgress(o,r))}),u()}if(n&2){let t=C(2).$implicit;N("value",t.currentValue)}}function bB(n,e){if(n&1&&(l(0,"span",63),m(1),u()),n&2){let t=C(2).$implicit,i=C();h(),E(i.formatNumber(t.currentValue))}}function SB(n,e){if(n&1&&x(0,"div",66),n&2){let t=C();dn("width",t,"%")}}function DB(n,e){if(n&1&&x(0,"div",57),n&2){let t=C();dn("width",t,"%")}}function wB(n,e){if(n&1){let t=U();l(0,"div",48)(1,"div",49,0),S("click",function(){w(t);let r=Hc(2),o=C().$implicit,s=C();return T(s.startEditingProgress(o.id,r))}),P(3,EB,1,1,"input",62)(4,bB,2,1,"span",63),m(5),u(),l(6,"span"),m(7),u()(),l(8,"div",52),P(9,SB,1,2,"div",64)(10,DB,1,2,"div",54),u()}if(n&2){let t=e,i=C().$implicit,r=C();h(3),F(r.editingProgressId()===i.id?3:4),h(2),yt(" / ",r.formatNumber(i.targetValue)," ",i.unit," "),h(),De(t<100?"text-teal-600":"text-green-600"),h(),L("",t.toFixed(0),"%"),h(2),F(t<100?9:10)}}function TB(n,e){if(n&1){let t=U();l(0,"div",27)(1,"div",29)(2,"h3",60),m(3),u(),P(4,_B,4,3,"div",31),u(),l(5,"div",32)(6,"div",33),P(7,CB,1,1,"img",34)(8,xB,2,0,"div",35),l(9,"span",36),m(10),u()(),l(11,"span",37),m(12),u(),l(13,"span",38),m(14),u()(),l(15,"div",39),P(16,wB,11,7),u(),l(17,"div",40)(18,"button",61),S("click",function(){let r=w(t).$implicit,o=C();return T(o.openModal(r))}),x(19,"ion-icon",42),u(),l(20,"button",43),S("click",function(){let r=w(t).$implicit,o=C();return T(o.requestDelete(r))}),x(21,"ion-icon",44),u()()()}if(n&2){let t,i,r=e.$implicit,o=C();h(3),E(r.title),h(),F((t=o.getDaysLeft(r.endDate))?4:-1,t),h(3),F(r.assigneeId?7:8),h(3),E(o.getAssigneeName(r.assigneeId)),h(),De(o.getTypeClass(r.type)),h(),E(r.type),h(),De(o.getStatusClass(r.status)),h(),E(r.status),h(2),F((i=o.getProgressBarWidth(r))?16:-1,i)}}function IB(n,e){n&1&&(l(0,"div",24),x(1,"ion-icon",58),l(2,"p",59),m(3,"\u7121\u7B26\u5408\u689D\u4EF6\u7684\u5E74\u5EA6\u76EE\u6A19\u3002"),u()())}function MB(n,e){if(n&1&&(l(0,"option",10),m(1),u()),n&2){let t=e.$implicit;N("value",t),h(),E(t)}}function AB(n,e){if(n&1&&(l(0,"option",10),m(1),u()),n&2){let t=e.$implicit;N("value",t.id),h(),E(t.name)}}function NB(n,e){if(n&1){let t=U();l(0,"div",28)(1,"div",67)(2,"div",68)(3,"h3",69),m(4),u(),l(5,"button",70),S("click",function(){w(t);let r=C();return T(r.closeModal())}),x(6,"ion-icon",71),u()(),l(7,"div",72)(8,"form",73),S("ngSubmit",function(){w(t);let r=C();return T(r.handleFormSubmit())}),l(9,"div")(10,"label",74),m(11,"\u76EE\u6A19\u540D\u7A31*"),u(),x(12,"input",75),u(),l(13,"div",76)(14,"div")(15,"label",77),m(16,"\u985E\u578B*"),u(),l(17,"select",78),O(18,MB,2,2,"option",10,W),u()(),l(20,"div")(21,"label",79),m(22,"\u9031\u671F*"),u(),l(23,"select",80)(24,"option",81),m(25,"\u6708\u5EA6"),u(),l(26,"option",82),m(27,"\u5E74\u5EA6"),u()()(),l(28,"div")(29,"label",83),m(30,"\u55AE\u4F4D*"),u(),x(31,"input",84),u()(),l(32,"div",85)(33,"div")(34,"label",86),m(35,"\u76EE\u524D\u9032\u5EA6*"),u(),x(36,"input",87),u(),l(37,"div")(38,"label",88),m(39,"\u76EE\u6A19\u503C*"),u(),x(40,"input",89),u()(),l(41,"div",85)(42,"div")(43,"label",90),m(44,"\u958B\u59CB\u65E5\u671F*"),u(),x(45,"input",91),u(),l(46,"div")(47,"label",92),m(48,"\u7D50\u675F\u65E5\u671F*"),u(),x(49,"input",93),u()(),l(50,"div")(51,"label",94),m(52,"\u8CA0\u8CAC\u4EBA"),u(),l(53,"select",95)(54,"option",9),m(55,"\u5718\u968A\u76EE\u6A19 (\u7121\u6307\u5B9A\u8CA0\u8CAC\u4EBA)"),u(),O(56,AB,2,2,"option",10,pm),u()(),l(58,"div",96)(59,"button",97),S("click",function(){w(t);let r=C();return T(r.closeModal())}),m(60,"\u53D6\u6D88"),u(),l(61,"button",98),m(62,"\u5132\u5B58"),u()()()()()()}if(n&2){let t=C();h(4),E(t.editingGoal()?"\u7DE8\u8F2F\u5718\u968A\u76EE\u6A19":"\u65B0\u589E\u5718\u968A\u76EE\u6A19"),h(4),N("formGroup",t.goalForm),h(10),V(t.goalTypes),h(38),V(t.users()),h(5),N("disabled",t.goalForm.invalid)}}function RB(n,e){if(n&1){let t=U();l(0,"div",28)(1,"div",99)(2,"div",100)(3,"div",101),x(4,"ion-icon",102),u(),l(5,"h3",103),m(6,"\u78BA\u5B9A\u8981\u522A\u9664\u5718\u968A\u76EE\u6A19\u55CE\uFF1F"),u(),l(7,"p",104),m(8),u()(),l(9,"div",105)(10,"button",97),S("click",function(){w(t);let r=C();return T(r.cancelDelete())}),m(11,"\u53D6\u6D88"),u(),l(12,"button",106),S("click",function(){w(t);let r=C();return T(r.confirmDelete())}),m(13,"\u78BA\u8A8D\u522A\u9664"),u()()()()}n&2&&(h(8),L("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u5718\u968A\u76EE\u6A19\u300C",e.title,"\u300D\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"))}var Qs=class Qs{constructor(){this.dataService=R(mt);this.authService=R(nt);this.fb=R(ze);this.isModalOpen=D(!1);this.editingGoal=D(null);this.goalToDelete=D(null);this.editingProgressId=D(null);this.statusFilter=D("");this.typeFilter=D("");this.assigneeFilter=D("");this.allGoals=D([]);this.users=D([]);this.goalTypes=["\u71DF\u6536","\u6D3B\u52D5","\u9867\u5BA2","\u5176\u4ED6"];this.goalStatuses=["\u9032\u884C\u4E2D","\u5DF2\u9054\u6210","\u672A\u9054\u6210"];this.goalForm=this.fb.group({title:["",$.required],type:["\u71DF\u6536",$.required],period:["monthly",$.required],targetValue:[null,[$.required,$.min(1)]],currentValue:[0,[$.required,$.min(0)]],unit:["\u5143",$.required],startDate:["",$.required],endDate:["",$.required],assigneeId:[""]});this.baseFilteredGoals=H(()=>{let e=this.statusFilter(),t=this.typeFilter(),i=this.assigneeFilter();return this.allGoals().filter(r=>!e||r.status===e).filter(r=>!t||r.type===t).filter(r=>!i||i==="all"?!0:i==="team"?!r.assigneeId:r.assigneeId===i).sort((r,o)=>new Date(o.startDate).getTime()-new Date(r.startDate).getTime())});this.monthlyGoals=H(()=>this.baseFilteredGoals().filter(e=>e.period==="monthly"));this.yearlyGoals=H(()=>this.baseFilteredGoals().filter(e=>e.period==="yearly"));this.loadData()}loadData(){this.allGoals.set(this.dataService.getTargetGoals()),this.users.set([])}resetFilters(){this.statusFilter.set(""),this.typeFilter.set(""),this.assigneeFilter.set("")}openModal(e=null){if(this.editingGoal.set(e),e)this.goalForm.patchValue(e);else{let t=new Date,i=new Date(t.getFullYear(),t.getMonth(),1).toISOString().split("T")[0],r=new Date(t.getFullYear(),t.getMonth()+1,0).toISOString().split("T")[0];this.goalForm.reset({type:"\u71DF\u6536",period:"monthly",currentValue:0,unit:"\u5143",startDate:i,endDate:r,assigneeId:""})}this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1)}handleFormSubmit(){if(this.goalForm.invalid)return;let e=this.goalForm.value,t=this.editingGoal(),i={title:e.title,type:e.type,targetValue:e.targetValue,currentValue:e.currentValue,unit:e.unit,startDate:e.startDate,endDate:e.endDate,assigneeId:e.assigneeId||void 0,status:e.currentValue>=e.targetValue?"\u5DF2\u9054\u6210":"\u9032\u884C\u4E2D",period:e.period};t?this.dataService.updateTargetGoal(q(k({},i),{id:t.id})):this.dataService.addTargetGoal(i),this.loadData(),this.closeModal()}startEditingProgress(e,t){this.editingProgressId.set(e),setTimeout(()=>{t.querySelector("input")?.select()},0)}finishEditingProgress(e,t){let i=t.target,r=parseFloat(i.value);if(!isNaN(r)&&r!==e.currentValue){let o=q(k({},e),{currentValue:r});if(o.currentValue>=o.targetValue)o.status="\u5DF2\u9054\u6210";else{let s=new Date().toISOString().split("T")[0];o.status=s>o.endDate?"\u672A\u9054\u6210":"\u9032\u884C\u4E2D"}this.dataService.updateTargetGoal(o),this.loadData()}this.editingProgressId.set(null)}requestDelete(e){this.goalToDelete.set(e)}confirmDelete(){this.goalToDelete()&&(this.dataService.deleteTargetGoal(this.goalToDelete().id),this.loadData(),this.cancelDelete())}cancelDelete(){this.goalToDelete.set(null)}getProgressBarWidth(e){return e.targetValue===0?0:Math.min(e.currentValue/e.targetValue*100,100)}getAssigneeName(e){return e?this.users().find(t=>t.id===e)?.name||"\u672A\u77E5\u4F7F\u7528\u8005":"\u5718\u968A\u76EE\u6A19"}getAssigneeAvatarUrl(e){let t=this.getAssigneeName(e);return`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=random&color=fff&font-size=0.5`}getDaysLeft(e){let t=new Date(e),i=new Date;t.setHours(0,0,0,0),i.setHours(0,0,0,0);let r=t.getTime()-i.getTime(),o=Math.ceil(r/(1e3*60*60*24));return o<0?{days:Math.abs(o),label:"\u5DF2\u903E\u671F"}:{days:o,label:"\u5929\u5269\u9918"}}getDaysLeftClass(e,t){return t==="\u5DF2\u903E\u671F"?"text-red-500":e<=7?"text-yellow-600":"text-gray-500"}getGoalTypeIcon(e){switch(e){case"\u71DF\u6536":return"cash-outline";case"\u6D3B\u52D5":return"calendar-outline";case"\u9867\u5BA2":return"people-outline";default:return"trophy-outline"}}getTypeClass(e){switch(e){case"\u71DF\u6536":return"bg-green-100 text-green-800";case"\u6D3B\u52D5":return"bg-purple-100 text-purple-800";case"\u9867\u5BA2":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}}getStatusClass(e){switch(e){case"\u9032\u884C\u4E2D":return"bg-blue-100 text-blue-800";case"\u5DF2\u9054\u6210":return"bg-green-100 text-green-800";case"\u672A\u9054\u6210":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}formatNumber(e){return e.toLocaleString("en-US")}};Qs.\u0275fac=function(t){return new(t||Qs)},Qs.\u0275cmp=ee({type:Qs,selectors:[["app-goal-setting"]],decls:57,vars:7,consts:[["progressEditor",""],[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","add-outline"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","p-4","bg-white","rounded-xl","shadow-md"],["for","typeFilter",1,"text-sm","font-medium","text-gray-600"],["id","typeFilter",1,"w-full","mt-1","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-50",3,"ngModelChange","ngModel"],["value",""],[3,"value"],["for","statusFilter",1,"text-sm","font-medium","text-gray-600"],["id","statusFilter",1,"w-full","mt-1","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-50",3,"ngModelChange","ngModel"],["for","assigneeFilter",1,"text-sm","font-medium","text-gray-600"],["id","assigneeFilter",1,"w-full","mt-1","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-50",3,"ngModelChange","ngModel"],["value","team"],[1,"flex","items-end","justify-end"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-8","pt-4"],[1,"text-2xl","font-bold","text-gray-800","mb-4","pb-2","border-b-2","border-indigo-500","flex","items-center","gap-2"],["name","calendar-outline"],[1,"space-y-4"],[1,"bg-white","rounded-lg","shadow-sm","border","p-4","flex","flex-col","group","relative","transition-all","duration-300","hover:shadow-md","hover:border-indigo-300"],[1,"bg-white","p-6","rounded-xl","border","text-center","text-gray-500"],[1,"text-2xl","font-bold","text-gray-800","mb-4","pb-2","border-b-2","border-teal-500","flex","items-center","gap-2"],["name","podium-outline"],[1,"bg-white","rounded-lg","shadow-sm","border","p-4","flex","flex-col","group","relative","transition-all","duration-300","hover:shadow-md","hover:border-teal-300"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"flex","justify-between","items-start","gap-2"],[1,"font-bold","text-gray-800","group-hover:text-indigo-600","transition-colors"],[1,"flex","items-center","text-xs","font-medium","shrink-0",3,"class"],[1,"flex","items-center","gap-4","text-sm","text-gray-500","mt-2"],[1,"flex","items-center","gap-2"],["alt","avatar",1,"w-5","h-5","rounded-full",3,"src"],[1,"w-5","h-5","rounded-full","bg-gray-200","flex","items-center","justify-center"],[1,"font-medium","text-xs"],[1,"text-xs","font-semibold","px-2","py-0.5","rounded-full"],[1,"text-xs","font-semibold","px-2","py-1","rounded-full"],[1,"mt-3"],[1,"absolute","top-2","right-2","flex","items-center","gap-1","bg-white/50","backdrop-blur-sm","rounded-full","p-1","opacity-0","group-hover:opacity-100","transition-opacity","duration-300"],["title","\u7DE8\u8F2F",1,"text-gray-500","hover:text-indigo-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],["name","create-outline"],["title","\u522A\u9664",1,"text-gray-500","hover:text-red-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],["name","trash-outline"],[1,"flex","items-center","text-xs","font-medium","shrink-0"],["name","time-outline",1,"mr-1"],["name","people-outline",1,"text-gray-500","text-xs"],[1,"flex","justify-between","items-center","mb-1","text-xs","font-medium"],[1,"text-gray-600",3,"click"],["type","number",1,"w-20","p-0.5","text-center","border","border-indigo-500","rounded-md","bg-white","text-xs",3,"value"],[1,"font-semibold","text-indigo-600","p-1","cursor-pointer","hover:bg-gray-100","rounded-md"],[1,"w-full","bg-slate-100","rounded-full","h-1.5"],[1,"bg-indigo-600","h-1.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #818cf8, #4f46e5)",3,"width"],[1,"bg-green-500","h-1.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #4ade80, #16a34a)",3,"width"],["type","number",1,"w-20","p-0.5","text-center","border","border-indigo-500","rounded-md","bg-white","text-xs",3,"blur","keydown.enter","value"],[1,"bg-indigo-600","h-1.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #818cf8, #4f46e5)"],[1,"bg-green-500","h-1.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #4ade80, #16a34a)"],["name","trophy-outline",1,"text-4xl","text-gray-400"],[1,"mt-2"],[1,"font-bold","text-gray-800","group-hover:text-teal-600","transition-colors"],["title","\u7DE8\u8F2F",1,"text-gray-500","hover:text-teal-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],["type","number",1,"w-20","p-0.5","text-center","border","border-teal-500","rounded-md","bg-white","text-xs",3,"value"],[1,"font-semibold","text-teal-600","p-1","cursor-pointer","hover:bg-gray-100","rounded-md"],[1,"bg-teal-600","h-1.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #5eead4, #0d9488)",3,"width"],["type","number",1,"w-20","p-0.5","text-center","border","border-teal-500","rounded-md","bg-white","text-xs",3,"blur","keydown.enter","value"],[1,"bg-teal-600","h-1.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #5eead4, #0d9488)"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-lg","max-h-[90vh]","flex","flex-col","m-4"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],[1,"space-y-4",3,"ngSubmit","formGroup"],["for","title",1,"block","text-sm","font-medium","text-gray-700"],["id","title","formControlName","title",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],["for","type",1,"block","text-sm","font-medium","text-gray-700"],["id","type","formControlName","type",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","period",1,"block","text-sm","font-medium","text-gray-700"],["id","period","formControlName","period",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["value","monthly"],["value","yearly"],["for","unit",1,"block","text-sm","font-medium","text-gray-700"],["id","unit","formControlName","unit","placeholder","\u5143, \u5834, \u4EBA",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["for","currentValue",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","currentValue","formControlName","currentValue",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","targetValue",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","targetValue","formControlName","targetValue",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","startDate",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","startDate","formControlName","startDate",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","endDate",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","endDate","formControlName","endDate",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","assigneeId",1,"block","text-sm","font-medium","text-gray-700"],["id","assigneeId","formControlName","assigneeId",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","disabled:bg-indigo-300",3,"disabled"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","m-4"],[1,"p-6","text-center"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100"],["name","warning-outline",1,"h-6","w-6","text-red-600"],[1,"mt-4","text-lg","font-semibold","text-gray-900"],[1,"mt-2","text-sm","text-gray-500"],[1,"flex","justify-center","gap-4","bg-gray-50","px-6","py-4","rounded-b-xl"],["type","button",1,"px-4","py-2","bg-red-600","text-white","rounded-md","hover:bg-red-700",3,"click"]],template:function(t,i){if(t&1&&(l(0,"div",1)(1,"div",2)(2,"h1",3),m(3,"\u5718\u968A\u76EE\u6A19\u8A2D\u5B9A"),u(),l(4,"button",4),S("click",function(){return i.openModal(null)}),x(5,"ion-icon",5),l(6,"span"),m(7,"\u65B0\u589E\u5718\u968A\u76EE\u6A19"),u()()(),l(8,"div",6)(9,"div")(10,"label",7),m(11,"\u985E\u578B"),u(),l(12,"select",8),ne("ngModelChange",function(o){return re(i.typeFilter,o)||(i.typeFilter=o),o}),l(13,"option",9),m(14,"\u6240\u6709\u985E\u578B"),u(),O(15,sB,2,2,"option",10,W),u()(),l(17,"div")(18,"label",11),m(19,"\u72C0\u614B"),u(),l(20,"select",12),ne("ngModelChange",function(o){return re(i.statusFilter,o)||(i.statusFilter=o),o}),l(21,"option",9),m(22,"\u6240\u6709\u72C0\u614B"),u(),O(23,aB,2,2,"option",10,W),u()(),l(25,"div")(26,"label",13),m(27,"\u8CA0\u8CAC\u4EBA"),u(),l(28,"select",14),ne("ngModelChange",function(o){return re(i.assigneeFilter,o)||(i.assigneeFilter=o),o}),l(29,"option",9),m(30,"\u6240\u6709\u4EBA"),u(),l(31,"option",15),m(32,"\u5718\u968A\u76EE\u6A19"),u(),O(33,lB,2,2,"option",10,pm),u()(),l(35,"div",16)(36,"button",17),S("click",function(){return i.resetFilters()}),x(37,"ion-icon",18),u()()(),l(38,"div",19)(39,"div")(40,"h2",20),x(41,"ion-icon",21),m(42," \u6708\u5EA6\u76EE\u6A19 "),u(),l(43,"div",22),O(44,yB,22,11,"div",23,pm,!1,vB,4,0,"div",24),u()(),l(47,"div")(48,"h2",25),x(49,"ion-icon",26),m(50," \u5E74\u5EA6\u76EE\u6A19 "),u(),l(51,"div",22),O(52,TB,22,11,"div",27,pm,!1,IB,4,0,"div",24),u()()()(),P(55,NB,63,3,"div",28),P(56,RB,14,1,"div",28)),t&2){let r;h(12),te("ngModel",i.typeFilter),h(3),V(i.goalTypes),h(5),te("ngModel",i.statusFilter),h(3),V(i.goalStatuses),h(5),te("ngModel",i.assigneeFilter),h(5),V(i.users()),h(11),V(i.monthlyGoals()),h(8),V(i.yearlyGoals()),h(3),F(i.isModalOpen()?55:-1),h(),F((r=i.goalToDelete())?56:-1,r)}},dependencies:[oe,$e,je,Fe,ke,xe,$t,Ae,ge,Be,Ue,qe,Ee,we],encapsulation:2,changeDetection:0});var gm=Qs;var PB=(n,e)=>e.targetId;function FB(n,e){if(n&1&&(l(0,"div",5)(1,"div",12),x(2,"ion-icon",13),l(3,"p",14),m(4),u()()()),n&2){let t=C();h(4),E(t.successMessage())}}function kB(n,e){if(n&1&&(l(0,"div",6)(1,"div",12),x(2,"ion-icon",15),l(3,"p",16),m(4),u()()()),n&2){let t=C();h(4),E(t.error())}}function OB(n,e){n&1&&(l(0,"div",8)(1,"div",17),x(2,"div",18),l(3,"p",19),m(4,"\u8F09\u5165\u8CC7\u6599\u4E2D..."),u()()())}function VB(n,e){if(n&1){let t=U();l(0,"tr",25)(1,"td",26),m(2),u(),l(3,"td",23),m(4),u(),l(5,"td",23),m(6),u(),l(7,"td",27),m(8),u(),l(9,"td",28),m(10),u(),l(11,"td",29),m(12),u(),l(13,"td",22)(14,"div",30)(15,"button",31),S("click",function(){let r=w(t).$implicit,o=C(2);return T(o.openEditForm(r))}),x(16,"ion-icon",32),u(),l(17,"button",33),S("click",function(){let r=w(t).$implicit,o=C(2);return T(o.deleteTarget(r))}),x(18,"ion-icon",34),u()()()()}if(n&2){let t=e.$implicit,i=C(2);h(2),L(" ",i.formatMonth(t.targetMonth)," "),h(2),L(" ",i.formatCurrency(t.monthlyRevenueTarget)," "),h(2),L(" ",i.formatCurrency(t.eventRevenueTarget)," "),h(2),L(" ",i.formatCurrency(t.totalTarget)," "),h(2),L(" ",i.formatCurrency(t.dailyAvgTarget)," "),h(2),L(" ",t.remark||"-"," ")}}function LB(n,e){n&1&&(l(0,"tr")(1,"td",35),m(2," \u5C1A\u7121\u8CC7\u6599 "),u()())}function BB(n,e){if(n&1&&(l(0,"div",9)(1,"table",20)(2,"thead",21)(3,"tr")(4,"th",22),m(5,"\u6708\u4EFD"),u(),l(6,"th",23),m(7,"\u6708\u71DF\u696D\u76EE\u6A19"),u(),l(8,"th",23),m(9,"\u6D3B\u52D5\u71DF\u6536\u76EE\u6A19"),u(),l(10,"th",23),m(11,"\u7E3D\u76EE\u6A19"),u(),l(12,"th",23),m(13,"\u65E5\u5747\u76EE\u6A19"),u(),l(14,"th",22),m(15,"\u5099\u8A3B"),u(),l(16,"th",24),m(17,"\u64CD\u4F5C"),u()()(),l(18,"tbody"),O(19,VB,19,6,"tr",25,PB,!1,LB,3,0,"tr"),u()()()),n&2){let t=C();h(19),V(t.targets())}}function UB(n,e){n&1&&(l(0,"div",10),x(1,"ion-icon",36),l(2,"p",37),m(3,"\u5C1A\u7121\u71DF\u6536\u76EE\u6A19\u8CC7\u6599"),u(),l(4,"p",38),m(5,"\u9EDE\u64CA\u4E0A\u65B9\u300C\u65B0\u589E\u76EE\u6A19\u300D\u6309\u9215\u958B\u59CB\u8A2D\u5B9A"),u()())}function $B(n,e){if(n&1&&(l(0,"div",6)(1,"div",12),x(2,"ion-icon",57),l(3,"p",58),m(4),u()()()),n&2){let t=C(2);h(4),E(t.formError())}}function HB(n,e){n&1&&(l(0,"p",48),m(1,"\u6708\u4EFD\u4E0D\u53EF\u4FEE\u6539"),u())}function GB(n,e){n&1&&(x(0,"div",59),l(1,"span"),m(2,"\u8655\u7406\u4E2D..."),u())}function qB(n,e){if(n&1&&(x(0,"ion-icon",60),l(1,"span"),m(2),u()),n&2){let t=C(2);h(2),E(t.isEditing()?"\u66F4\u65B0":"\u65B0\u589E")}}function WB(n,e){if(n&1){let t=U();l(0,"div",11)(1,"div",39)(2,"div",40)(3,"h2",41),m(4),u(),l(5,"button",42),S("click",function(){w(t);let r=C();return T(r.closeForm())}),x(6,"ion-icon",43),u()(),l(7,"div",44),P(8,$B,5,1,"div",6),l(9,"div")(10,"label",45),m(11," \u6708\u4EFD "),l(12,"span",46),m(13,"*"),u()(),l(14,"input",47),S("ngModelChange",function(r){w(t);let o=C();return T(o.updateTargetMonth(r))}),u(),P(15,HB,2,0,"p",48),u(),l(16,"div")(17,"label",45),m(18," \u6708\u71DF\u696D\u76EE\u6A19 "),l(19,"span",46),m(20,"*"),u()(),l(21,"div",49)(22,"span",50),m(23,"NT$"),u(),l(24,"input",51),S("ngModelChange",function(r){w(t);let o=C();return T(o.updateMonthlyRevenueTarget(r))}),u()()(),l(25,"div")(26,"label",45),m(27," \u6D3B\u52D5\u71DF\u6536\u76EE\u6A19 "),u(),l(28,"div",49)(29,"span",50),m(30,"NT$"),u(),l(31,"input",52),S("ngModelChange",function(r){w(t);let o=C();return T(o.updateEventRevenueTarget(r))}),u()(),l(32,"p",48),m(33,"\u7279\u6B8A\u6D3B\u52D5\u6216\u4FC3\u92B7\u7684\u9810\u671F\u71DF\u6536\uFF08\u53EF\u9078\uFF09"),u()(),l(34,"div")(35,"label",45),m(36," \u5099\u8A3B "),u(),l(37,"textarea",53),S("ngModelChange",function(r){w(t);let o=C();return T(o.updateRemark(r))}),u()()(),l(38,"div",54)(39,"button",55),S("click",function(){w(t);let r=C();return T(r.closeForm())}),m(40," \u53D6\u6D88 "),u(),l(41,"button",56),S("click",function(){w(t);let r=C();return T(r.submitForm())}),P(42,GB,3,0)(43,qB,3,1),u()()()()}if(n&2){let t=C();h(4),L(" ",t.isEditing()?"\u7DE8\u8F2F\u71DF\u6536\u76EE\u6A19":"\u65B0\u589E\u71DF\u6536\u76EE\u6A19"," "),h(4),F(t.formError()?8:-1),h(6),N("ngModel",t.formData().targetMonth)("disabled",t.isEditing()),h(),F(t.isEditing()?15:-1),h(9),N("ngModel",t.formData().monthlyRevenueTarget),h(7),N("ngModel",t.formData().eventRevenueTarget),h(6),N("ngModel",t.formData().remark),h(2),N("disabled",t.isSaving()),h(2),N("disabled",t.isSaving()),h(),F(t.isSaving()?42:43)}}var Zs=class Zs{constructor(){this.apiService=R(wt);this.targets=D([]);this.isLoading=D(!1);this.error=D(null);this.showForm=D(!1);this.isEditing=D(!1);this.formData=D({targetId:null,targetMonth:"",monthlyRevenueTarget:0,eventRevenueTarget:0,remark:""});this.formError=D(null);this.isSaving=D(!1);this.successMessage=D(null)}ngOnInit(){this.loadTargets()}async loadTargets(){this.isLoading.set(!0),this.error.set(null);try{let e=await this.apiService.getMonthlyTargets();if(e.success)this.targets.set(e.data||[]),console.log("\u2713 \u8F09\u5165\u6708\u5EA6\u71DF\u6536\u76EE\u6A19\u6210\u529F:",e.data.length,"\u7B46\u8A18\u9304");else throw new Error(e.error||"\u8F09\u5165\u5931\u6557")}catch(e){console.error("\u274C \u8F09\u5165\u6708\u5EA6\u71DF\u6536\u76EE\u6A19\u5931\u6557:",e);let t=e instanceof Error?e.message:"\u8F09\u5165\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66";this.error.set(t)}finally{this.isLoading.set(!1)}}openAddForm(){this.isEditing.set(!1),this.formData.set({targetId:null,targetMonth:"",monthlyRevenueTarget:0,eventRevenueTarget:0,remark:""}),this.formError.set(null),this.showForm.set(!0)}openEditForm(e){this.isEditing.set(!0),this.formData.set({targetId:e.targetId,targetMonth:e.targetMonth.substring(0,7),monthlyRevenueTarget:e.monthlyRevenueTarget,eventRevenueTarget:e.eventRevenueTarget,remark:e.remark||""}),this.formError.set(null),this.showForm.set(!0)}closeForm(){this.showForm.set(!1),this.formError.set(null),this.formData.set({targetId:null,targetMonth:"",monthlyRevenueTarget:0,eventRevenueTarget:0,remark:""})}validateForm(){let e=this.formData();return e.targetMonth?e.monthlyRevenueTarget<0?"\u6708\u71DF\u696D\u76EE\u6A19\u4E0D\u53EF\u70BA\u8CA0\u6578":e.eventRevenueTarget<0?"\u6D3B\u52D5\u71DF\u6536\u76EE\u6A19\u4E0D\u53EF\u70BA\u8CA0\u6578":null:"\u8ACB\u9078\u64C7\u6708\u4EFD"}async submitForm(){let e=this.validateForm();if(e){this.formError.set(e);return}this.isSaving.set(!0),this.formError.set(null),this.successMessage.set(null);try{let t=this.formData(),i={targetMonth:`${t.targetMonth}-01`,monthlyRevenueTarget:t.monthlyRevenueTarget,eventRevenueTarget:t.eventRevenueTarget,remark:t.remark||null},r;if(this.isEditing()&&t.targetId?(r=await this.apiService.updateMonthlyTarget(k({targetId:t.targetId},i)),this.successMessage.set("\u66F4\u65B0\u6210\u529F\uFF01")):(r=await this.apiService.createMonthlyTarget(i),this.successMessage.set("\u65B0\u589E\u6210\u529F\uFF01")),r.success)await this.loadTargets(),this.closeForm(),setTimeout(()=>this.successMessage.set(null),3e3);else throw new Error(r.error||"\u64CD\u4F5C\u5931\u6557")}catch(t){console.error("\u274C \u63D0\u4EA4\u8868\u55AE\u5931\u6557:",t);let i=t instanceof Error?t.message:"\u64CD\u4F5C\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66";t.message?.includes("\u5DF2\u5B58\u5728")&&(i="\u8A72\u6708\u4EFD\u7684\u71DF\u6536\u76EE\u6A19\u5DF2\u5B58\u5728\uFF0C\u8ACB\u4F7F\u7528\u7DE8\u8F2F\u529F\u80FD\u9032\u884C\u4FEE\u6539"),this.formError.set(i)}finally{this.isSaving.set(!1)}}async deleteTarget(e){if(confirm(`\u78BA\u5B9A\u8981\u522A\u9664 ${this.formatMonth(e.targetMonth)} \u7684\u71DF\u6536\u76EE\u6A19\u55CE\uFF1F`)){this.isLoading.set(!0),this.error.set(null),this.successMessage.set(null);try{let i=await this.apiService.deleteMonthlyTarget(e.targetId);if(i.success)this.successMessage.set("\u522A\u9664\u6210\u529F\uFF01"),await this.loadTargets(),setTimeout(()=>this.successMessage.set(null),3e3);else throw new Error(i.error||"\u522A\u9664\u5931\u6557")}catch(i){console.error("\u274C \u522A\u9664\u5931\u6557:",i);let r=i instanceof Error?i.message:"\u522A\u9664\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66";this.error.set(r)}finally{this.isLoading.set(!1)}}}formatMonth(e){if(!e)return"";let t=new Date(e),i=t.getFullYear(),r=t.getMonth()+1;return`${i}\u5E74${r}\u6708`}formatCurrency(e){return e==null?"NT$0":`NT$${e.toLocaleString("zh-TW",{minimumFractionDigits:0,maximumFractionDigits:0})}`}updateTargetMonth(e){this.formData.update(t=>q(k({},t),{targetMonth:e}))}updateMonthlyRevenueTarget(e){this.formData.update(t=>q(k({},t),{monthlyRevenueTarget:+e}))}updateEventRevenueTarget(e){this.formData.update(t=>q(k({},t),{eventRevenueTarget:+e}))}updateRemark(e){this.formData.update(t=>q(k({},t),{remark:e}))}};Zs.\u0275fac=function(t){return new(t||Zs)},Zs.\u0275cmp=ee({type:Zs,selectors:[["app-monthly-targets"]],decls:15,vars:6,consts:[[1,"space-y-8"],[1,"flex","items-center","justify-between"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2",3,"click"],["name","add-outline",1,"text-xl"],[1,"bg-green-50","border-l-4","border-green-500","p-4","rounded-lg"],[1,"bg-red-50","border-l-4","border-red-500","p-4","rounded-lg"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"flex","items-center","justify-center","h-64"],[1,"overflow-x-auto"],[1,"flex","flex-col","items-center","justify-center","h-64","text-gray-500"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50","p-4"],[1,"flex","items-center","gap-3"],["name","checkmark-circle",1,"text-2xl","text-green-600"],[1,"text-green-900","font-medium"],["name","alert-circle-outline",1,"text-2xl","text-red-600"],[1,"text-red-900","font-medium"],[1,"flex","flex-col","items-center","space-y-2"],[1,"w-8","h-8","border-3","border-indigo-200","border-t-indigo-600","rounded-full","animate-spin"],[1,"text-sm","text-gray-500"],[1,"w-full","text-sm","text-left"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50"],[1,"py-3","px-4"],[1,"py-3","px-4","text-right"],[1,"py-3","px-4","text-center"],[1,"border-b","hover:bg-gray-50","transition-colors"],[1,"py-3","px-4","font-medium","text-gray-900"],[1,"py-3","px-4","text-right","font-semibold","text-indigo-600"],[1,"py-3","px-4","text-right","text-gray-600"],[1,"py-3","px-4","text-gray-600"],[1,"flex","items-center","justify-center","gap-2"],["title","\u7DE8\u8F2F",1,"text-indigo-600","hover:text-indigo-800","p-1","rounded","transition-colors",3,"click"],["name","create-outline",1,"text-xl"],["title","\u522A\u9664",1,"text-red-600","hover:text-red-800","p-1","rounded","transition-colors",3,"click"],["name","trash-outline",1,"text-xl"],["colspan","7",1,"py-8","text-center","text-gray-500"],["name","document-text-outline",1,"text-6xl","mb-4"],[1,"text-lg","font-medium"],[1,"text-sm","mt-2"],[1,"bg-white","rounded-xl","shadow-xl","max-w-2xl","w-full","max-h-[90vh]","overflow-y-auto"],[1,"flex","items-center","justify-between","p-6","border-b"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-400","hover:text-gray-600","transition-colors",3,"click"],["name","close-outline",1,"text-3xl"],[1,"p-6","space-y-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"text-red-500"],["type","month","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500","disabled:bg-gray-100","disabled:cursor-not-allowed",3,"ngModelChange","ngModel","disabled"],[1,"mt-1","text-xs","text-gray-500"],[1,"relative"],[1,"absolute","left-3","top-1/2","-translate-y-1/2","text-gray-500"],["type","number","min","0","step","1000","placeholder","0","required","",1,"w-full","pl-12","pr-3","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500",3,"ngModelChange","ngModel"],["type","number","min","0","step","1000","placeholder","0",1,"w-full","pl-12","pr-3","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500",3,"ngModelChange","ngModel"],["rows","3","placeholder","\u8F38\u5165\u5099\u8A3B\uFF08\u53EF\u9078\uFF09",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500","resize-none",3,"ngModelChange","ngModel"],[1,"flex","items-center","justify-end","gap-3","p-6","border-t","bg-gray-50"],[1,"px-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","hover:bg-gray-50","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"px-4","py-2","bg-indigo-600","text-white","rounded-lg","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["name","alert-circle-outline",1,"text-2xl","text-red-600","flex-shrink-0"],[1,"text-red-900","text-sm"],[1,"w-4","h-4","border-2","border-white","border-t-transparent","rounded-full","animate-spin"],["name","checkmark-outline",1,"text-xl"]],template:function(t,i){t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),m(3,"\u71DF\u6536\u76EE\u6A19"),u(),l(4,"button",3),S("click",function(){return i.openAddForm()}),x(5,"ion-icon",4),l(6,"span"),m(7,"\u65B0\u589E\u76EE\u6A19"),u()()(),P(8,FB,5,1,"div",5),P(9,kB,5,1,"div",6),l(10,"div",7),P(11,OB,5,0,"div",8),P(12,BB,22,1,"div",9),P(13,UB,6,0,"div",10),u(),P(14,WB,44,11,"div",11),u()),t&2&&(h(8),F(i.successMessage()?8:-1),h(),F(i.error()?9:-1),h(2),F(i.isLoading()?11:-1),h(),F(!i.isLoading()&&i.targets().length>0?12:-1),h(),F(!i.isLoading()&&i.targets().length===0&&!i.error()?13:-1),h(),F(i.showForm()?14:-1))},dependencies:[oe,Ee,xe,$t,ge,$h,Uh,we],encapsulation:2});var hm=Zs;function jB(n,e){if(n&1&&(Xe(0,"div",4),m(1),et()),n&2){let t=C();h(),L(" ",t.error()," ")}}var Xs=class Xs{constructor(e,t){this.authService=e;this.router=t;this.error=D(null)}ngOnInit(){this.authService.isAuthenticated()&&this.router.navigate(["/dashboard"]),this.loadGoogleSignInScript()}loadGoogleSignInScript(){if(window.google){this.initializeGoogleSignIn();return}let e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.onload=()=>this.initializeGoogleSignIn(),document.head.appendChild(e)}initializeGoogleSignIn(){let e="957974561982-c8gfted5logjoglj8hspaiad8q8jpl1g.apps.googleusercontent.com";if(!e||e.includes("YOUR_")){console.warn("Google Client ID not configured. Please set VITE_GOOGLE_CLIENT_ID environment variable."),this.error.set("\u7CFB\u7D71\u672A\u6B63\u78BA\u914D\u7F6E Google OAuth\u3002\u8ACB\u806F\u7D61\u7BA1\u7406\u54E1\u3002");return}try{window.google.accounts.id.initialize({client_id:e,callback:i=>this.handleGoogleLogin(i)});let t=document.getElementById("google-signin-button");t&&window.google.accounts.id.renderButton(t,{theme:"outline",size:"large",width:"100%"})}catch(t){console.error("Failed to initialize Google Sign-In:",t),this.error.set("\u7121\u6CD5\u521D\u59CB\u5316 Google \u767B\u5165")}}async handleGoogleLogin(e){try{e.credential&&(await this.authService.loginWithGoogle(e.credential)?this.router.navigate(["/dashboard"]):this.error.set(this.authService.error()||"Google \u767B\u5165\u5931\u6557"))}catch(t){console.error("Login error:",t),this.error.set("\u767B\u5165\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}}};Xs.\u0275fac=function(t){return new(t||Xs)(J(nt),J(Ne))},Xs.\u0275cmp=ee({type:Xs,selectors:[["app-login"]],decls:15,vars:1,consts:[[1,"login-container"],[1,"login-box"],[1,"login-header"],[1,"subtitle"],[1,"error-message"],[1,"login-method"],["id","google-signin-button",1,"google-button-container"],[1,"footer-info"]],template:function(t,i){t&1&&(Xe(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),m(4,"Galaxy House Finance"),et(),Xe(5,"p",3),m(6,"\u7BA1\u7406\u7CFB\u7D71\u767B\u5165"),et()(),P(7,jB,2,1,"div",4),Xe(8,"div",5),Ui(9,"div",6),et(),Xe(10,"div",7)(11,"p"),m(12,"\u6B64\u7CFB\u7D71\u9700\u8981\u4F7F\u7528 Google \u5E33\u865F\u767B\u5165"),et(),Xe(13,"p"),m(14,"\u5982\u6709\u554F\u984C\uFF0C\u8ACB\u806F\u7D61\u7BA1\u7406\u54E1"),et()()()()),t&2&&(h(7),F(i.error()?7:-1))},dependencies:[oe,Ee],styles:[".login-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background:linear-gradient(135deg,#8c4f28,#000);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;padding:20px}.login-box[_ngcontent-%COMP%]{background:#efd07f;padding:40px;border-radius:12px;box-shadow:0 10px 40px #0000001a;width:100%;max-width:400px}.login-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:30px}h1[_ngcontent-%COMP%]{color:#333;margin:0 0 8px;font-size:28px;font-weight:700}.subtitle[_ngcontent-%COMP%]{color:#666;margin:0;font-size:14px}.login-method[_ngcontent-%COMP%]{margin-bottom:20px}.google-button-container[_ngcontent-%COMP%]{margin-bottom:15px}.google-login-btn[_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid #ddd;border-radius:6px;background:#fff;color:#333;font-size:14px;font-weight:500;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:10px;transition:all .3s ease}.google-login-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#f8f8f8;border-color:#ccc;box-shadow:0 2px 8px #0000001a}.error-message[_ngcontent-%COMP%]{background-color:#fee;color:#c00;padding:12px;border-radius:6px;font-size:13px;margin-bottom:20px;border:1px solid #fcc}.footer-info[_ngcontent-%COMP%]{text-align:center;margin-top:30px;color:#999;font-size:12px;line-height:1.6}.footer-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0}"]});var ym=Xs;function zB(n,e){if(n&1&&(l(0,"div",29),m(1),u()),n&2){let t=C();h(),L(" ",t.successMessage()," ")}}function YB(n,e){if(n&1&&(l(0,"span",30),m(1),u()),n&2){let t=e.$implicit;h(),L(" ",t.display_name," ")}}function JB(n,e){if(n&1&&(l(0,"div",31)(1,"span",32),m(2),u()()),n&2){let t=e.$implicit;h(2),E(t)}}function KB(n,e){n&1&&(l(0,"div",33),m(1,"\u8F09\u5165\u4E2D..."),u())}function QB(n,e){if(n&1&&(l(0,"div",34),m(1),u()),n&2){let t=C();h(),E(t.error())}}var ea=class ea{constructor(e,t){this.http=e;this.authService=t;this.baseUrl="/api/admin";this.profileData=D(null);this.isLoading=D(!1);this.isUpdating=D(!1);this.error=D(null);this.successMessage=D(null);this.formData={name:"",avatarUrl:""}}ngOnInit(){this.loadProfile()}loadProfile(){this.isLoading.set(!0),this.error.set(null);let e=this.getAuthHeaders();if(!e){this.error.set("\u5C1A\u672A\u767B\u5165\uFF0C\u8ACB\u91CD\u65B0\u767B\u5165"),this.isLoading.set(!1);return}this.http.get(`${this.baseUrl}/profile`,{headers:e}).subscribe({next:t=>{this.profileData.set(t.data),this.formData={name:t.data.name,avatarUrl:t.data.avatarUrl||""},this.isLoading.set(!1)},error:t=>{console.error("Profile load error:",t);let i="\u8F09\u5165\u500B\u4EBA\u8CC7\u6599\u5931\u6557";t.status===401?i="\u8A8D\u8B49\u5931\u6557\uFF0C\u8ACB\u91CD\u65B0\u767B\u5165":t.status===404?i="\u627E\u4E0D\u5230\u5E33\u865F\u8CC7\u8A0A":t.error?.error&&(i=t.error.error),this.error.set(i),this.isLoading.set(!1)}})}updateProfile(){this.isUpdating.set(!0),this.successMessage.set(null);let e=this.getAuthHeaders();if(!e){this.error.set("\u5C1A\u672A\u767B\u5165"),this.isUpdating.set(!1);return}this.http.put(`${this.baseUrl}/profile`,this.formData,{headers:e}).subscribe({next:()=>{this.successMessage.set("\u500B\u4EBA\u8CC7\u6599\u5DF2\u6210\u529F\u66F4\u65B0"),this.isUpdating.set(!1),this.loadProfile(),setTimeout(()=>{this.successMessage.set(null)},3e3)},error:t=>{this.error.set(t.error?.error||"\u66F4\u65B0\u5931\u6557"),this.isUpdating.set(!1)}})}getStatusLabel(e){return{active:"\u555F\u7528",inactive:"\u505C\u7528",suspended:"\u66AB\u505C"}[e||""]||e||"-"}formatDate(e){return e?new Date(e).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-"}getAuthHeaders(){let e=this.authService.getToken();return e?new Ft({Authorization:`Bearer ${e}`,"Content-Type":"application/json"}):null}};ea.\u0275fac=function(t){return new(t||ea)(J(zt),J(nt))},ea.\u0275cmp=ee({type:ea,selectors:[["app-account"]],decls:69,vars:20,consts:[[1,"account-container"],[1,"account-layout"],[1,"profile-section"],[1,"profile-header"],[1,"profile-avatar"],["alt","Avatar",3,"src"],[1,"profile-info"],[1,"status"],[1,"profile-details"],[1,"detail-row"],[1,"value"],[1,"edit-section"],[3,"ngSubmit"],[1,"form-group"],["type","text","name","name","placeholder","\u8F38\u5165\u60A8\u7684\u59D3\u540D",3,"ngModelChange","ngModel"],["type","url","name","avatarUrl","placeholder","https://...",3,"ngModelChange","ngModel"],["type","submit",3,"disabled"],["class","success-message",4,"ngIf"],[1,"roles-section"],[1,"roles-container"],[1,"role-list"],["class","role-badge",4,"ngFor","ngForOf"],[1,"permissions-container"],[1,"permissions-grid"],["class","permission-item",4,"ngFor","ngForOf"],[1,"activity-section"],[1,"activity-info"],["class","loading",4,"ngIf"],["class","error-message",4,"ngIf"],[1,"success-message"],[1,"role-badge"],[1,"permission-item"],[1,"permission-code"],[1,"loading"],[1,"error-message"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"h2"),m(2,"\u6211\u7684\u5E33\u865F"),u(),l(3,"div",1)(4,"div",2)(5,"div",3)(6,"div",4),x(7,"img",5),u(),l(8,"div",6)(9,"h3"),m(10),u(),l(11,"p"),m(12),u(),l(13,"p",7),m(14),u()()(),l(15,"div",8)(16,"div",9)(17,"label"),m(18,"\u5E33\u865F\u72C0\u614B\uFF1A"),u(),l(19,"span",10),m(20),u()(),l(21,"div",9)(22,"label"),m(23,"\u5EFA\u7ACB\u6642\u9593\uFF1A"),u(),l(24,"span",10),m(25),u()(),l(26,"div",9)(27,"label"),m(28,"\u6700\u5F8C\u767B\u5165\uFF1A"),u(),l(29,"span",10),m(30),u()()()(),l(31,"div",11)(32,"h3"),m(33,"\u7DE8\u8F2F\u500B\u4EBA\u8CC7\u6599"),u(),l(34,"form",12),S("ngSubmit",function(){return i.updateProfile()}),l(35,"div",13)(36,"label"),m(37,"\u59D3\u540D"),u(),l(38,"input",14),ne("ngModelChange",function(o){return re(i.formData.name,o)||(i.formData.name=o),o}),u()(),l(39,"div",13)(40,"label"),m(41,"\u982D\u50CF URL"),u(),l(42,"input",15),ne("ngModelChange",function(o){return re(i.formData.avatarUrl,o)||(i.formData.avatarUrl=o),o}),u()(),l(43,"button",16),m(44),u(),Qn(45,zB,2,1,"div",17),u()(),l(46,"div",18)(47,"h3"),m(48,"\u89D2\u8272\u548C\u6B0A\u9650"),u(),l(49,"div",19)(50,"h4"),m(51,"\u6211\u7684\u89D2\u8272"),u(),l(52,"div",20),Qn(53,YB,2,1,"span",21),u()(),l(54,"div",22)(55,"h4"),m(56,"\u6211\u7684\u6B0A\u9650"),u(),l(57,"div",23),Qn(58,JB,3,1,"div",24),u()()(),l(59,"div",25)(60,"h3"),m(61,"\u6700\u8FD1\u6D3B\u52D5"),u(),l(62,"div",26)(63,"p"),m(64),u(),l(65,"p"),m(66),u()()()(),Qn(67,KB,2,0,"div",27)(68,QB,2,1,"div",28),u()),t&2){let r,o,s,a,c,d,g,y,v,_,b,I;h(7),N("src",((r=i.profileData())==null?null:r.avatarUrl)||"https://via.placeholder.com/100",On),h(3),E((o=i.profileData())==null?null:o.name),h(2),E((s=i.profileData())==null?null:s.email),h(),De("status-"+((a=i.profileData())==null?null:a.status)),h(),L(" ",i.getStatusLabel((c=i.profileData())==null?null:c.status)," "),h(6),E(i.getStatusLabel((d=i.profileData())==null?null:d.status)),h(5),E(i.formatDate((g=i.profileData())==null?null:g.createdAt)),h(5),E(i.formatDate((y=i.profileData())==null?null:y.lastLoginAt)),h(8),te("ngModel",i.formData.name),h(4),te("ngModel",i.formData.avatarUrl),h(),N("disabled",i.isUpdating()),h(),L(" ",i.isUpdating()?"\u4FDD\u5B58\u4E2D...":"\u4FDD\u5B58\u4FEE\u6539"," "),h(),N("ngIf",i.successMessage()),h(8),N("ngForOf",(v=i.profileData())==null?null:v.roles),h(5),N("ngForOf",(_=i.profileData())==null?null:_.permissions),h(6),L("\u6700\u5F8C\u767B\u5165\u6642\u9593\uFF1A",i.formatDate((b=i.profileData())==null?null:b.lastLoginAt)),h(2),L("\u5E33\u865F\u5EFA\u7ACB\u6642\u9593\uFF1A",i.formatDate((I=i.profileData())==null?null:I.createdAt)),h(),N("ngIf",i.isLoading()),h(),N("ngIf",i.error())}},dependencies:[oe,sd,Kr,Ee,je,xe,ge,Be,we,kl],styles:[".account-container[_ngcontent-%COMP%]{padding:20px;max-width:1000px;margin:0 auto}h2[_ngcontent-%COMP%]{margin-bottom:30px;color:#333}.account-layout[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:30px}.profile-section[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:8px;box-shadow:0 2px 8px #0000001a}.profile-header[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:20px;padding-bottom:20px;border-bottom:1px solid #eee}.profile-avatar[_ngcontent-%COMP%]{width:100px;height:100px;border-radius:50%;overflow:hidden;flex-shrink:0}.profile-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.profile-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 5px;color:#333}.profile-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#666;font-size:13px}.status[_ngcontent-%COMP%]{padding:4px 8px;border-radius:4px;font-size:12px;display:inline-block;margin-top:8px}.status-active[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724}.status-inactive[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24}.status-suspended[_ngcontent-%COMP%]{background-color:#fff3cd;color:#856404}.profile-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.detail-row[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#333}.detail-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#666}.edit-section[_ngcontent-%COMP%], .roles-section[_ngcontent-%COMP%], .activity-section[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:8px;box-shadow:0 2px 8px #0000001a}h3[_ngcontent-%COMP%]{margin-top:0;margin-bottom:15px;color:#333;font-size:16px}h4[_ngcontent-%COMP%]{margin-bottom:10px;color:#333;font-size:14px}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:5px;font-weight:600;color:#333;font-size:13px}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ddd;border-radius:4px;font-size:13px;box-sizing:border-box}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3f51b5;box-shadow:0 0 0 3px #3f51b51a}button[type=submit][_ngcontent-%COMP%]{background-color:#3f51b5;color:#fff;padding:10px 20px;border:none;border-radius:4px;cursor:pointer;font-size:13px;font-weight:600}button[type=submit][_ngcontent-%COMP%]:hover:not(:disabled){background-color:#303c7e}button[type=submit][_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.role-badge[_ngcontent-%COMP%]{display:inline-block;background-color:#e0e7ff;color:#3f51b5;padding:6px 12px;border-radius:4px;font-size:12px;margin-right:8px;margin-bottom:8px}.role-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.permissions-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:10px}.permission-item[_ngcontent-%COMP%]{background-color:#f5f5f5;padding:8px;border-radius:4px;border-left:3px solid #3f51b5;font-size:12px}.permission-code[_ngcontent-%COMP%]{font-family:Courier New,monospace;color:#333}.success-message[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724;padding:10px;border-radius:4px;font-size:12px;margin-top:10px;border:1px solid #c3e6cb}.error-message[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24;padding:10px;border-radius:4px;font-size:12px;margin-top:10px;border:1px solid #f5c6cb}.activity-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.activity-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#666;font-size:13px}.loading[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#666}@media (max-width: 768px){.account-layout[_ngcontent-%COMP%]{grid-template-columns:1fr}.profile-header[_ngcontent-%COMP%]{flex-direction:column;align-items:center;text-align:center}.permissions-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]});var vm=ea;var ZB=(n,e)=>e.role_id,XB=(n,e)=>e.permission_id;function eU(n,e){if(n&1&&(l(0,"div",4)(1,"p",23),m(2),u()()),n&2){let t=C();h(2),E(t.error())}}function tU(n,e){if(n&1&&(l(0,"div",5)(1,"p",24),m(2),u()()),n&2){let t=C();h(2),E(t.successMessage())}}function nU(n,e){n&1&&(l(0,"div",18),m(1,"\u8F09\u5165\u4E2D..."),u())}function iU(n,e){n&1&&(l(0,"div",18),m(1,"\u6C92\u6709\u53EF\u7DE8\u8F2F\u7684\u89D2\u8272"),u())}function rU(n,e){if(n&1){let t=U();l(0,"div",26)(1,"div",27)(2,"button",28),S("click",function(){let r=w(t).$implicit,o=C(2);return T(o.selectRole(r))}),l(3,"div",29),m(4),u(),l(5,"div",30),m(6),u(),l(7,"div",31),m(8),u()(),l(9,"div",32)(10,"button",33),S("click",function(){let r=w(t).$implicit,o=C(2);return T(o.openEditRoleDialog(r))}),Fi(),l(11,"svg",34),x(12,"path",35),u()(),Vr(),l(13,"button",36),S("click",function(){let r=w(t).$implicit,o=C(2);return T(o.openDeleteDialog(r))}),Fi(),l(14,"svg",34),x(15,"path",37),u()()()()()}if(n&2){let t,i,r,o=e.$implicit,s=C(2);Q("bg-blue-50",((t=s.selectedRole())==null?null:t.role_id)===o.role_id)("border-l-4",((i=s.selectedRole())==null?null:i.role_id)===o.role_id)("border-l-blue-500",((r=s.selectedRole())==null?null:r.role_id)===o.role_id),h(4),E(o.display_name),h(2),E(o.role_name),h(2),L(" ",o.permission_count||0," \u500B\u6B0A\u9650\u5DF2\u914D\u7F6E ")}}function oU(n,e){if(n&1&&O(0,rU,16,9,"div",25,ZB),n&2){let t=C();V(t.filteredRoles())}}function sU(n,e){n&1&&(l(0,"div",20)(1,"p",38),m(2,"\u8ACB\u9078\u64C7\u4E00\u500B\u89D2\u8272\u958B\u59CB\u914D\u7F6E\u6B0A\u9650"),u()())}function aU(n,e){n&1&&(l(0,"div",48),m(1,"\u8F09\u5165\u6B0A\u9650\u4E2D..."),u())}function lU(n,e){n&1&&(l(0,"div",48),m(1,"\u6C92\u6709\u53EF\u7528\u7684\u6B0A\u9650"),u())}function uU(n,e){if(n&1){let t=U();l(0,"div",60)(1,"input",61),S("change",function(){let r=w(t).$implicit,o=C(5);return T(o.togglePermission(r.permission_id,o.selectedPermissions().has(r.permission_id)))}),u(),l(2,"div",62)(3,"label",63),m(4),u(),l(5,"p",64),m(6),u(),l(7,"code",65),m(8),u()()()}if(n&2){let t=e.$implicit,i=C(5);h(),N("checked",i.selectedPermissions().has(t.permission_id))("disabled",i.isSaving()),h(3),L(" ",t.display_name," "),h(2),L(" ",t.description," "),h(2),L(" ",t.permission_code," ")}}function cU(n,e){if(n&1&&O(0,uU,9,5,"div",60,XB),n&2){let t=C().$implicit,i=C(3);V(i.permissionsByCategory()[t])}}function dU(n,e){n&1&&(l(0,"div",59),m(1,"\u6B64\u5206\u985E\u6C92\u6709\u6B0A\u9650"),u())}function fU(n,e){if(n&1){let t=U();l(0,"div",52)(1,"div",53)(2,"div",54)(3,"input",55),S("change",function(){let r=w(t).$implicit,o=C(3);return T(o.isCategoryFullySelected(r)?o.deselectAllInCategory(r):o.selectAllInCategory(r))}),u(),l(4,"div")(5,"h3",56),m(6),u(),l(7,"p",57),m(8),u()()()(),l(9,"div",58),P(10,cU,2,0)(11,dU,2,0,"div",59),u()()}if(n&2){let t=e.$implicit,i=C(3);h(3),N("checked",i.isCategoryFullySelected(t)),h(3),L(" ",t," "),h(2),yt(" ",i.getCategoryAssignedCount(t)," / ",i.permissionsByCategory()[t].length," "),h(2),F(i.permissionsByCategory()[t]&&i.permissionsByCategory()[t].length>0?10:11)}}function mU(n,e){if(n&1&&O(0,fU,12,5,"div",52,W),n&2){let t=C(2);V(t.categoryCount().categories)}}function pU(n,e){if(n&1){let t=U();l(0,"div",8)(1,"div",39)(2,"div",10)(3,"div")(4,"h2",40),m(5),u(),l(6,"p",12),m(7),u()(),l(8,"div",41)(9,"div",42),m(10),u()()()(),l(11,"div",43)(12,"button",44),S("click",function(){w(t);let r=C();return T(r.selectAllPermissions())}),m(13," \u5168\u9078\u6240\u6709 "),u(),l(14,"button",45),S("click",function(){w(t);let r=C();return T(r.clearAllPermissions())}),m(15," \u5168\u4E0D\u9078 "),u(),l(16,"button",46),S("click",function(){w(t);let r=C();return T(r.resetPermissions())}),m(17," \u91CD\u7F6E "),u()(),l(18,"div",47),P(19,aU,2,0,"div",48)(20,lU,2,0,"div",48)(21,mU,2,0),u(),l(22,"div",49)(23,"button",50),S("click",function(){w(t);let r=C();return T(r.resetPermissions())}),m(24," \u53D6\u6D88 "),u(),l(25,"button",51),S("click",function(){w(t);let r=C();return T(r.savePermissions())}),m(26),u()()()}if(n&2){let t=C();h(5),L(" ",t.selectedRole().display_name," "),h(2),yt(" \u5DF2\u914D\u7F6E ",t.assignedCount()," / ",t.categoryCount().total*5," \u500B\u6B0A\u9650 "),h(3),L(" ",(t.Object.keys(t.permissionsByCategory()).length>0?t.Math.round(t.assignedCount()/(t.Object.keys(t.permissionsByCategory()).length*5)*100):0)||0,"% "),h(6),N("disabled",t.isSaving()),h(3),F(t.isLoading()?19:t.Object.keys(t.permissionsByCategory()).length===0?20:21),h(4),N("disabled",t.isSaving()),h(2),N("disabled",t.isSaving()),h(),L(" ",t.isSaving()?"\u4FDD\u5B58\u4E2D...":"\u4FDD\u5B58\u6B0A\u9650"," ")}}function gU(n,e){if(n&1&&(l(0,"div",68)(1,"p",23),m(2),u()()),n&2){let t=C(2);h(2),E(t.error())}}function hU(n,e){if(n&1){let t=U();l(0,"div",21)(1,"div",66)(2,"div",39)(3,"h3",40),m(4),u()(),l(5,"div",67),P(6,gU,3,1,"div",68),l(7,"div")(8,"label",69),m(9," \u89D2\u8272\u540D\u7A31 "),l(10,"span",70),m(11,"*"),u()(),l(12,"input",71),S("input",function(r){w(t);let o=C();return T(o.updateRoleDisplayName(r.target.value))}),u()(),l(13,"div")(14,"label",69),m(15," \u8AAA\u660E "),u(),l(16,"textarea",72),S("input",function(r){w(t);let o=C();return T(o.updateRoleDescription(r.target.value))}),u()()(),l(17,"div",73)(18,"button",50),S("click",function(){w(t);let r=C();return T(r.closeRoleDialog())}),m(19," \u53D6\u6D88 "),u(),l(20,"button",74),S("click",function(){w(t);let r=C();return T(r.saveRole())}),m(21),u()()()()}if(n&2){let t=C();h(4),L(" ",t.editingRole()?"\u7DE8\u8F2F\u89D2\u8272":"\u65B0\u589E\u89D2\u8272"," "),h(2),F(t.error()?6:-1),h(6),N("value",t.roleFormData().displayName)("disabled",t.isSaving()),h(4),N("value",t.roleFormData().description)("disabled",t.isSaving()),h(2),N("disabled",t.isSaving()),h(2),N("disabled",t.isSaving()),h(),L(" ",t.isSaving()?"\u4FDD\u5B58\u4E2D...":"\u4FDD\u5B58"," ")}}function yU(n,e){if(n&1&&(l(0,"div",76)(1,"p",23),m(2),u()()),n&2){let t=C(2);h(2),E(t.error())}}function vU(n,e){if(n&1){let t=U();l(0,"div",21)(1,"div",66)(2,"div",39)(3,"h3",40),m(4,"\u522A\u9664\u89D2\u8272\u78BA\u8A8D"),u()(),l(5,"div",75),P(6,yU,3,1,"div",76),l(7,"p",77),m(8," \u78BA\u5B9A\u8981\u522A\u9664\u89D2\u8272 "),l(9,"strong",78),m(10),u(),m(11," \u55CE\uFF1F "),u(),l(12,"p",79),m(13," \u6CE8\u610F\uFF1A\u5982\u679C\u6B64\u89D2\u8272\u5DF2\u5206\u914D\u7D66\u4F7F\u7528\u8005\uFF0C\u5C07\u7121\u6CD5\u522A\u9664\u3002 "),u()(),l(14,"div",73)(15,"button",50),S("click",function(){w(t);let r=C();return T(r.closeDeleteDialog())}),m(16," \u53D6\u6D88 "),u(),l(17,"button",80),S("click",function(){w(t);let r=C();return T(r.deleteRole())}),m(18),u()()()()}if(n&2){let t,i=C();h(6),F(i.error()?6:-1),h(4),E((t=i.roleToDelete())==null?null:t.display_name),h(5),N("disabled",i.isSaving()),h(2),N("disabled",i.isSaving()),h(),L(" ",i.isSaving()?"\u522A\u9664\u4E2D...":"\u78BA\u5B9A\u522A\u9664"," ")}}function _U(n,e){if(n&1&&(Bc(0),m(1),Uc()),n&2){let t=C();h(),L(" ",t.Math,`
`)}}var ta=class ta{constructor(){this.baseUrl="/api/admin";this.authService=R(nt);this.http=R(zt);this.roles=D([]);this.selectedRole=D(null);this.permissions=D({});this.selectedPermissions=D(new Set);this.isLoading=D(!1);this.isSaving=D(!1);this.error=D(null);this.successMessage=D(null);this.showRoleDialog=D(!1);this.showDeleteDialog=D(!1);this.editingRole=D(null);this.roleToDelete=D(null);this.roleFormData=D({displayName:"",description:""});this.searchTerm=D("");this.Object=Object;this.Math=Math;this.filteredRoles=H(()=>{let e=this.searchTerm().toLowerCase();return this.roles().filter(t=>t.role_name!=="super_admin").filter(t=>t.display_name.toLowerCase().includes(e))});this.permissionsByCategory=H(()=>this.permissions());this.categoryCount=H(()=>{let e=Object.keys(this.permissionsByCategory());return{total:e.length,categories:e}});this.assignedCount=H(()=>this.selectedPermissions().size)}ngOnInit(){this.loadRoles()}getAuthHeaders(){let e=this.authService.getToken();return e?new Ft({Authorization:`Bearer ${e}`,"Content-Type":"application/json"}):(this.error.set("\u5C1A\u672A\u767B\u5165"),null)}loadRoles(){let e=this.getAuthHeaders();if(!e)return;this.isLoading.set(!0),this.error.set(null);let t=`${this.baseUrl}/roles?limit=100`;console.log("Loading roles from:",t),console.log("Headers:",e),this.http.get(t,{headers:e}).subscribe({next:i=>{console.log("Roles response:",i);let r=i?.data||[];console.log("Filtered roles:",r),console.log("Non-system roles:",r.filter(s=>!s.is_system)),this.roles.set(r),this.isLoading.set(!1);let o=r.find(s=>!s.is_system);o?(console.log("Auto-selecting role:",o),this.selectRole(o)):console.warn("No editable roles found")},error:i=>{console.error("Error loading roles:",i);let r=i.error?.error||i.message||"\u8F09\u5165\u89D2\u8272\u5931\u6557";this.error.set(r),this.isLoading.set(!1)}})}selectRole(e){this.selectedRole.set(e),this.selectedPermissions.set(new Set),this.error.set(null);let t=this.getAuthHeaders();t&&(this.isLoading.set(!0),this.http.get(`${this.baseUrl}/role-permissions?roleId=${e.role_id}`,{headers:t}).subscribe({next:i=>{console.log("Role permissions response:",i);let r=i?.permissions||{};console.log("Permissions data:",r);let o=new Set;Object.values(r).forEach(s=>{console.log("Category perms:",s),s.forEach(a=>{console.log("Permission:",a,"is_assigned:",a.is_assigned,"type:",typeof a.is_assigned),a.is_assigned&&o.add(a.permission_id)})}),console.log("Assigned permissions:",o),this.permissions.set(r),this.selectedPermissions.set(o),this.isLoading.set(!1)},error:i=>{console.error("Error loading permissions:",i),this.error.set(i.error?.error||"\u8F09\u5165\u6B0A\u9650\u5931\u6557"),this.isLoading.set(!1)}}))}togglePermission(e,t){let i=new Set(this.selectedPermissions());t?i.delete(e):i.add(e),this.selectedPermissions.set(i)}selectAllInCategory(e){let t=this.permissions()[e]||[],i=new Set(this.selectedPermissions());t.forEach(r=>{i.add(r.permission_id)}),this.selectedPermissions.set(i)}deselectAllInCategory(e){let t=this.permissions()[e]||[],i=new Set(this.selectedPermissions());t.forEach(r=>{i.delete(r.permission_id)}),this.selectedPermissions.set(i)}getCategoryAssignedCount(e){let t=this.permissions()[e]||[],i=0;return t.forEach(r=>{this.selectedPermissions().has(r.permission_id)&&i++}),i}isCategoryFullySelected(e){let t=this.permissions()[e]||[];return t.length===0?!1:t.every(i=>this.selectedPermissions().has(i.permission_id))}savePermissions(){let e=this.selectedRole();if(!e){this.error.set("\u672A\u9078\u64C7\u89D2\u8272");return}let t=this.getAuthHeaders();if(!t)return;this.isSaving.set(!0),this.error.set(null),this.successMessage.set(null);let i={roleId:e.role_id,permissionIds:Array.from(this.selectedPermissions())};this.http.post(`${this.baseUrl}/role-permissions`,i,{headers:t}).subscribe({next:r=>{this.isSaving.set(!1),this.successMessage.set(`\u6210\u529F\u66F4\u65B0\u89D2\u8272 "${e.display_name}" \u7684\u6B0A\u9650 (${this.assignedCount()} \u500B\u6B0A\u9650)`),setTimeout(()=>{this.loadRoles()},1500)},error:r=>{this.isSaving.set(!1),this.error.set(r.error?.error||"\u4FDD\u5B58\u6B0A\u9650\u5931\u6557")}})}resetPermissions(){let e=this.selectedRole();e&&this.selectRole(e)}selectAllPermissions(){let e=new Set;Object.values(this.permissions()).forEach(t=>{t.forEach(i=>{e.add(i.permission_id)})}),this.selectedPermissions.set(e)}clearAllPermissions(){this.selectedPermissions.set(new Set)}openCreateRoleDialog(){this.editingRole.set(null),this.roleFormData.set({displayName:"",description:""}),this.showRoleDialog.set(!0),this.error.set(null)}openEditRoleDialog(e){this.editingRole.set(e),this.roleFormData.set({displayName:e.display_name,description:e.description||""}),this.showRoleDialog.set(!0),this.error.set(null)}closeRoleDialog(){this.showRoleDialog.set(!1),this.editingRole.set(null),this.roleFormData.set({displayName:"",description:""}),this.error.set(null)}saveRole(){let e=this.roleFormData();if(!e.displayName.trim()){this.error.set("\u89D2\u8272\u540D\u7A31\u4E0D\u80FD\u70BA\u7A7A");return}let t=this.getAuthHeaders();if(!t)return;this.isSaving.set(!0),this.error.set(null);let i=this.editingRole();if(i)this.http.put(`${this.baseUrl}/roles/${i.role_id}`,{displayName:e.displayName.trim(),description:e.description.trim()||null},{headers:t}).subscribe({next:r=>{this.isSaving.set(!1),this.successMessage.set(`\u6210\u529F\u66F4\u65B0\u89D2\u8272 "${e.displayName}"`),this.closeRoleDialog(),this.loadRoles(),setTimeout(()=>{this.successMessage.set(null)},3e3)},error:r=>{this.isSaving.set(!1),this.error.set(r.error?.error||"\u66F4\u65B0\u89D2\u8272\u5931\u6557")}});else{let r=new Date,o=r.getFullYear().toString()+(r.getMonth()+1).toString().padStart(2,"0")+r.getDate().toString().padStart(2,"0")+r.getHours().toString().padStart(2,"0")+r.getMinutes().toString().padStart(2,"0")+r.getSeconds().toString().padStart(2,"0"),s=Math.floor(Math.random()*65536).toString(16).padStart(4,"0"),a=`role_${o}_${s}`;this.http.post(`${this.baseUrl}/roles`,{roleName:a,displayName:e.displayName.trim(),description:e.description.trim()||null},{headers:t}).subscribe({next:c=>{this.isSaving.set(!1),this.successMessage.set(`\u6210\u529F\u5275\u5EFA\u89D2\u8272 "${e.displayName}"`),this.closeRoleDialog(),this.loadRoles(),setTimeout(()=>{this.successMessage.set(null)},3e3)},error:c=>{this.isSaving.set(!1),this.error.set(c.error?.error||"\u5275\u5EFA\u89D2\u8272\u5931\u6557")}})}}openDeleteDialog(e){this.roleToDelete.set(e),this.showDeleteDialog.set(!0),this.error.set(null)}closeDeleteDialog(){this.showDeleteDialog.set(!1),this.roleToDelete.set(null),this.error.set(null)}deleteRole(){let e=this.roleToDelete();if(!e)return;let t=this.getAuthHeaders();t&&(this.isSaving.set(!0),this.error.set(null),this.http.delete(`${this.baseUrl}/roles/${e.role_id}`,{headers:t}).subscribe({next:i=>{this.isSaving.set(!1),this.successMessage.set(`\u6210\u529F\u522A\u9664\u89D2\u8272 "${e.display_name}"`),this.closeDeleteDialog(),this.selectedRole()?.role_id===e.role_id&&(this.selectedRole.set(null),this.permissions.set({}),this.selectedPermissions.set(new Set)),this.loadRoles(),setTimeout(()=>{this.successMessage.set(null)},3e3)},error:i=>{this.isSaving.set(!1),this.error.set(i.error?.error||"\u522A\u9664\u89D2\u8272\u5931\u6557")}}))}updateRoleDisplayName(e){let t=this.roleFormData();this.roleFormData.set({displayName:e,description:t.description})}updateRoleDescription(e){let t=this.roleFormData();this.roleFormData.set({displayName:t.displayName,description:e})}};ta.\u0275fac=function(t){return new(t||ta)},ta.\u0275cmp=ee({type:ta,selectors:[["app-role-permission-management"]],decls:33,vars:8,consts:[[1,"min-h-screen","bg-gray-50","p-6"],[1,"mb-8"],[1,"text-3xl","font-bold","text-gray-900"],[1,"mt-2","text-gray-600"],[1,"mb-6","rounded-md","bg-red-50","p-4","border","border-red-200"],[1,"mb-6","rounded-md","bg-green-50","p-4","border","border-green-200"],[1,"grid","grid-cols-1","gap-6","lg:grid-cols-3"],[1,"lg:col-span-1"],[1,"rounded-lg","bg-white","shadow"],[1,"border-b","border-gray-200","p-4"],[1,"flex","items-center","justify-between"],[1,"text-lg","font-semibold","text-gray-900"],[1,"mt-1","text-sm","text-gray-600"],["title","\u65B0\u589E\u89D2\u8272",1,"px-3","py-2","text-sm","font-medium","rounded-md","bg-blue-600","text-white","hover:bg-blue-700",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],["type","text","placeholder","\u641C\u5C0B\u89D2\u8272...",1,"block","w-full","rounded-md","border","border-gray-300","px-3","py-2","text-gray-900","placeholder-gray-500","focus:border-blue-500","focus:ring-blue-500",3,"input","value"],[1,"divide-y","divide-gray-200","max-h-96","overflow-y-auto"],[1,"p-4","text-center","text-gray-500"],[1,"lg:col-span-2"],[1,"rounded-lg","bg-white","shadow","p-12","text-center"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[4,"ngIf"],[1,"text-sm","font-medium","text-red-800"],[1,"text-sm","font-medium","text-green-800"],[1,"hover:bg-gray-50","transition",3,"bg-blue-50","border-l-4","border-l-blue-500"],[1,"hover:bg-gray-50","transition"],[1,"flex","items-center"],[1,"flex-1","text-left","p-4",3,"click"],[1,"font-semibold","text-gray-900"],[1,"text-sm","text-gray-600"],[1,"mt-1","text-xs","text-gray-500"],[1,"flex","gap-1","pr-2"],["title","\u7DE8\u8F2F\u89D2\u8272",1,"p-2","text-blue-600","hover:bg-blue-100","rounded",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["title","\u522A\u9664\u89D2\u8272",1,"p-2","text-red-600","hover:bg-red-100","rounded",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"text-gray-600"],[1,"border-b","border-gray-200","p-6"],[1,"text-xl","font-semibold","text-gray-900"],[1,"text-right"],[1,"text-3xl","font-bold","text-blue-600"],[1,"border-b","border-gray-200","p-4","bg-gray-50","flex","gap-2"],[1,"px-3","py-2","text-sm","font-medium","rounded-md","bg-blue-600","text-white","hover:bg-blue-700",3,"click"],[1,"px-3","py-2","text-sm","font-medium","rounded-md","bg-gray-400","text-white","hover:bg-gray-500",3,"click"],[1,"px-3","py-2","text-sm","font-medium","rounded-md","bg-gray-200","text-gray-900","hover:bg-gray-300","disabled:opacity-50",3,"click","disabled"],[1,"divide-y","divide-gray-200","max-h-screen","overflow-y-auto"],[1,"p-8","text-center","text-gray-500"],[1,"border-t","border-gray-200","p-6","bg-gray-50","flex","gap-3","justify-end"],[1,"px-4","py-2","text-sm","font-medium","rounded-md","bg-gray-200","text-gray-900","hover:bg-gray-300","disabled:opacity-50",3,"click","disabled"],[1,"px-4","py-2","text-sm","font-medium","rounded-md","bg-green-600","text-white","hover:bg-green-700","disabled:opacity-50",3,"click","disabled"],[1,"border-b","border-gray-200"],[1,"bg-gray-50","p-4","flex","items-center","justify-between"],[1,"flex","items-center","gap-3","flex-1"],["type","checkbox",1,"w-5","h-5","text-blue-600","rounded","cursor-pointer",3,"change","checked"],[1,"font-semibold","text-gray-900","capitalize"],[1,"text-xs","text-gray-600"],[1,"p-4","space-y-3"],[1,"text-sm","text-gray-500","py-2"],[1,"flex","items-start","gap-3"],["type","checkbox",1,"w-5","h-5","text-blue-600","rounded","cursor-pointer","mt-0.5",3,"change","checked","disabled"],[1,"flex-1"],[1,"block","text-sm","font-medium","text-gray-900","cursor-pointer"],[1,"text-xs","text-gray-600","mt-1"],[1,"text-xs","bg-gray-100","px-2","py-1","rounded","text-gray-700","inline-block","mt-1"],[1,"bg-white","rounded-lg","shadow-xl","max-w-md","w-full","m-4"],[1,"p-6","space-y-4"],[1,"rounded-md","bg-red-50","p-4","border","border-red-200"],[1,"block","text-sm","font-medium","text-gray-900","mb-2"],[1,"text-red-500"],["type","text","placeholder","\u8ACB\u8F38\u5165\u89D2\u8272\u540D\u7A31",1,"block","w-full","rounded-md","border","border-gray-300","px-3","py-2","text-gray-900","placeholder-gray-500","focus:border-blue-500","focus:ring-blue-500",3,"input","value","disabled"],["placeholder","\u8ACB\u8F38\u5165\u89D2\u8272\u8AAA\u660E\uFF08\u9078\u586B\uFF09","rows","3",1,"block","w-full","rounded-md","border","border-gray-300","px-3","py-2","text-gray-900","placeholder-gray-500","focus:border-blue-500","focus:ring-blue-500",3,"input","value","disabled"],[1,"border-t","border-gray-200","p-6","flex","gap-3","justify-end"],[1,"px-4","py-2","text-sm","font-medium","rounded-md","bg-blue-600","text-white","hover:bg-blue-700","disabled:opacity-50",3,"click","disabled"],[1,"p-6"],[1,"rounded-md","bg-red-50","p-4","border","border-red-200","mb-4"],[1,"text-gray-700"],[1,"text-gray-900"],[1,"text-sm","text-red-600","mt-2"],[1,"px-4","py-2","text-sm","font-medium","rounded-md","bg-red-600","text-white","hover:bg-red-700","disabled:opacity-50",3,"click","disabled"]],template:function(t,i){t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),m(3,"\u89D2\u8272\u6B0A\u9650\u63A7\u7BA1"),u(),l(4,"p",3),m(5,"\u8A2D\u5B9A\u6BCF\u500B\u89D2\u8272\u7684\u6B0A\u9650\uFF0C\u6C7A\u5B9A\u4ED6\u5011\u53EF\u4EE5\u57F7\u884C\u7684\u64CD\u4F5C"),u()(),P(6,eU,3,1,"div",4),P(7,tU,3,1,"div",5),l(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"div",10)(13,"div")(14,"h2",11),m(15,"\u53EF\u7DE8\u8F2F\u7684\u89D2\u8272"),u(),l(16,"p",12),m(17," \u8D85\u7D1A\u7BA1\u7406\u54E1\u89D2\u8272\u7121\u6CD5\u7DE8\u8F2F "),u()(),l(18,"button",13),S("click",function(){return i.openCreateRoleDialog()}),Fi(),l(19,"svg",14),x(20,"path",15),u()()()(),Vr(),l(21,"div",9)(22,"input",16),S("input",function(o){return i.searchTerm.set(o.target.value)}),u()(),l(23,"div",17),P(24,nU,2,0,"div",18)(25,iU,2,0,"div",18)(26,oU,2,0),u()()(),l(27,"div",19),P(28,sU,3,0,"div",20)(29,pU,27,9,"div",8),u()()(),P(30,hU,22,9,"div",21),P(31,vU,19,5,"div",21),Qn(32,_U,2,1,"ng-container",22)),t&2&&(h(6),F(i.error()?6:-1),h(),F(i.successMessage()?7:-1),h(15),N("value",i.searchTerm()),h(2),F(i.isLoading()?24:i.filteredRoles().length===0?25:26),h(4),F(i.selectedRole()?29:28),h(2),F(i.showRoleDialog()?30:-1),h(),F(i.showDeleteDialog()?31:-1),h(),N("ngIf",!1))},dependencies:[oe,Kr,$e,Ee],styles:["[_nghost-%COMP%]{--color-primary: #3b82f6;--color-success: #10b981;--color-danger: #ef4444;--color-warning: #f59e0b;--color-gray-50: #f9fafb;--color-gray-100: #f3f4f6;--color-gray-200: #e5e7eb;--color-gray-300: #d1d5db;--color-gray-600: #4b5563;--color-gray-900: #111827}[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:var(--color-gray-100)}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--color-gray-300);border-radius:4px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:var(--color-gray-400)}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}[class*=bg-green-50][_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideIn .3s ease-out}button[_ngcontent-%COMP%], input[type=checkbox][_ngcontent-%COMP%]{transition:all .2s ease-out}.role-item[_ngcontent-%COMP%]:hover{transform:translate(2px)}"],changeDetection:0});var _m=ta;var Qe=(n,e)=>{let t=R(nt),i=R(Ne);if(!t.isAuthenticated())return i.navigate(["/login"],{queryParams:{returnUrl:e.url}}),!1;let r=t.getTokenExpiry(),o=new Date().getTime();return r&&o>=r?(t.logout(),i.navigate(["/login"],{queryParams:{returnUrl:e.url,expired:!0}}),!1):!0};var po=class po{constructor(){this.baseUrl="/api/admin";this.authService=R(nt);this.http=R(zt);this.router=R(Ne)}async checkSuperAdmin(){try{let e=this.authService.getToken();if(!e)return!1;let t=new Ft({Authorization:`Bearer ${e}`,"Content-Type":"application/json"}),i=await Pe(this.http.get(`${this.baseUrl}/profile`,{headers:t}));return i?.data?.roles&&Array.isArray(i.data.roles)?i.data.roles.some(r=>r.role_name==="super_admin"):!1}catch(e){return console.error("Error checking super admin status:",e),!1}}};po.\u0275fac=function(t){return new(t||po)},po.\u0275prov=Y({token:po,factory:po.\u0275fac,providedIn:"root"});var Ky=po,Ob=async(n,e)=>{let t=R(Ky),i=R(Ne);return await t.checkSuperAdmin()?!0:(console.warn("Access denied: User is not a super admin"),i.navigate(["/dashboard"],{queryParams:{error:"insufficient-permissions"}}),!1)};var Vb=[{path:"login",component:ym,title:"\u767B\u5165"},{path:"dashboard",component:af,title:"Dashboard",canActivate:[Qe]},{path:"financial-statements",component:lf,title:"Financial Statements",canActivate:[Qe]},{path:"customer-analysis",component:Yf,title:"\u9867\u5BA2\u7BA1\u7406",canActivate:[Qe]},{path:"product-analysis",component:Jf,title:"Product Analysis",canActivate:[Qe]},{path:"product-cost",component:rm,title:"Product Cost",canActivate:[Qe]},{path:"ledger",component:Kf,title:"Ledger",canActivate:[Qe]},{path:"vendors",component:om,title:"\u5EE0\u5546\u7BA1\u7406",canActivate:[Qe]},{path:"purchase-orders",component:sm,title:"\u9032\u8CA8\u55AE\u7BA1\u7406",canActivate:[Qe]},{path:"events",component:Xf,title:"\u6D3B\u52D5\u7BA1\u7406",canActivate:[Qe]},{path:"events/new",component:Wl,title:"\u65B0\u589E\u6D3B\u52D5",canActivate:[Qe]},{path:"events/edit/:id",component:Wl,title:"\u7DE8\u8F2F\u6D3B\u52D5",canActivate:[Qe]},{path:"daily-revenue",component:em,title:"Daily Revenue",canActivate:[Qe]},{path:"daily-revenue/:date",component:tm,title:"Edit Daily Revenue",canActivate:[Qe]},{path:"payroll",component:nm,title:"Payroll",canActivate:[Qe]},{path:"payroll/:employeeId/:year/:month",component:im,title:"Payroll Details",canActivate:[Qe]},{path:"shareholder-rebates",component:am,title:"\u80A1\u6771\u56DE\u994B\u91D1",canActivate:[Qe]},{path:"meeting",component:lm,title:"\u6BCF\u5468\u6703\u8B70\u7D00\u9304",canActivate:[Qe]},{path:"shareholder-records",component:cm,title:"\u500B\u4EBA\u6BCF\u5468\u9032\u5EA6\u7D00\u9304",canActivate:[Qe]},{path:"goal-progress",component:fm,title:"\u500B\u4EBA\u76EE\u6A19\u9032\u5EA6",canActivate:[Qe]},{path:"goal-setting",component:gm,title:"\u5718\u968A\u76EE\u6A19\u8A2D\u5B9A",canActivate:[Qe]},{path:"monthly-targets",component:hm,title:"\u71DF\u6536\u76EE\u6A19",canActivate:[Qe]},{path:"decision-log",component:dm,title:"\u91CD\u5927\u4E8B\u9805\u4F48\u9054",canActivate:[Qe]},{path:"user-management",component:mm,title:"\u4F7F\u7528\u8005\u7BA1\u7406",canActivate:[Qe]},{path:"role-permissions",component:_m,title:"\u89D2\u8272\u6B0A\u9650\u63A7\u7BA1",canActivate:[Qe,Ob]},{path:"account",component:vm,title:"\u5E33\u865F\u8A2D\u5B9A",canActivate:[Qe]},{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"**",redirectTo:"login"}];var Lb=()=>{};var Bb=async(n,e)=>{if(!(typeof window>"u"))return await Lb(),Xy([["ion-icon",[[1,"ion-icon",{mode:[1025],color:[1],ios:[1],md:[1],flipRtl:[4,"flip-rtl"],name:[513],src:[1],icon:[8],size:[1],lazy:[4],sanitize:[4],svgContent:[32],isVisible:[32]},null,{name:["loadIcon"],src:["loadIcon"],icon:["loadIcon"],ios:["loadIcon"],md:["loadIcon"]}]]]],e)};var go=class go{constructor(e,t){this.authService=e;this.router=t}intercept(e,t){let i=this.authService.getToken();if(i){let r=this.authService.getTokenExpiry(),o=new Date().getTime();if(r&&o>=r)return console.warn("Token \u5DF2\u8FC7\u671F\uFF0C\u5F3A\u5236\u91CD\u65B0\u767B\u5165"),this.authService.logout(),this.router.navigate(["/login"],{queryParams:{expired:!0}}),Di(()=>new Error("Token expired"));e=this.addToken(e,i)}return t.handle(e).pipe(Hn(r=>(r.status===401&&(console.warn("\u6536\u5230 401 Unauthorized\uFF0CToken \u53EF\u80FD\u5DF2\u8FC7\u671F\u6216\u65E0\u6548"),this.authService.logout(),this.router.navigate(["/login"],{queryParams:{expired:!0,returnUrl:this.router.url}})),Di(()=>r))))}addToken(e,t){return e.clone({setHeaders:{Authorization:`Bearer ${t}`}})}};go.\u0275fac=function(t){return new(t||go)(ie(nt),ie(Ne))},go.\u0275prov=Y({token:go,factory:go.\u0275fac});var Cm=go;zg(Wd,{providers:[yg(),wh(Vb,Th()),Xg(eh()),{provide:hd,useClass:Cm,multi:!0}]}).catch(n=>console.error(n));Bb(window);
