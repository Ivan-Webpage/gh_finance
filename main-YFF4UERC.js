import{a as V,b as G,h as o_}from"./chunk-FU26YZD3.js";var Tp;function tu(){return Tp}function pi(n){let e=Tp;return Tp=n,e}var a_=Symbol("NotFound");function bo(n){return n===a_||n?.name==="\u0275NotFound"}var Wt=null,nu=!1,Ip=1,Z2=null,jt=Symbol("SIGNAL");function fe(n){let e=Wt;return Wt=n,e}function au(){return Wt}var Sr={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Eo(n){if(nu)throw new Error("");if(Wt===null)return;Wt.consumerOnSignalRead(n);let e=Wt.producersTail;if(e!==void 0&&e.producer===n)return;let t,i=Wt.recomputing;if(i&&(t=e!==void 0?e.nextProducer:Wt.producers,t!==void 0&&t.producer===n)){Wt.producersTail=t,t.lastReadVersion=n.version;return}let r=n.consumersTail;if(r!==void 0&&r.consumer===Wt&&(!i||eS(r,Wt)))return;let o=wo(Wt),a={producer:n,consumer:Wt,nextProducer:t,prevConsumer:r,lastReadVersion:n.version,nextConsumer:void 0};Wt.producersTail=a,e!==void 0?e.nextProducer=a:Wt.producers=a,o&&d_(n,a)}function s_(){Ip++}function su(n){if(!(wo(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===Ip)){if(!n.producerMustRecompute(n)&&!Do(n)){ou(n);return}n.producerRecomputeValue(n),ou(n)}}function Mp(n){if(n.consumers===void 0)return;let e=nu;nu=!0;try{for(let t=n.consumers;t!==void 0;t=t.nextConsumer){let i=t.consumer;i.dirty||X2(i)}}finally{nu=e}}function Ap(){return Wt?.consumerAllowSignalWrites!==!1}function X2(n){n.dirty=!0,Mp(n),n.consumerMarkedDirty?.(n)}function ou(n){n.dirty=!1,n.lastCleanEpoch=Ip}function Dr(n){return n&&l_(n),fe(n)}function l_(n){n.producersTail=void 0,n.recomputing=!0}function So(n,e){fe(e),n&&u_(n)}function u_(n){n.recomputing=!1;let e=n.producersTail,t=e!==void 0?e.nextProducer:n.producers;if(t!==void 0){if(wo(n))do t=Rp(t);while(t!==void 0);e!==void 0?e.nextProducer=void 0:n.producers=void 0}}function Do(n){for(let e=n.producers;e!==void 0;e=e.nextProducer){let t=e.producer,i=e.lastReadVersion;if(i!==t.version||(su(t),i!==t.version))return!0}return!1}function wr(n){if(wo(n)){let e=n.producers;for(;e!==void 0;)e=Rp(e)}n.producers=void 0,n.producersTail=void 0,n.consumers=void 0,n.consumersTail=void 0}function d_(n,e){let t=n.consumersTail,i=wo(n);if(t!==void 0?(e.nextConsumer=t.nextConsumer,t.nextConsumer=e):(e.nextConsumer=void 0,n.consumers=e),e.prevConsumer=t,n.consumersTail=e,!i)for(let r=n.producers;r!==void 0;r=r.nextProducer)d_(r.producer,r)}function Rp(n){let e=n.producer,t=n.nextProducer,i=n.nextConsumer,r=n.prevConsumer;if(n.nextConsumer=void 0,n.prevConsumer=void 0,i!==void 0?i.prevConsumer=r:e.consumersTail=r,r!==void 0)r.nextConsumer=i;else if(e.consumers=i,!wo(e)){let o=e.producers;for(;o!==void 0;)o=Rp(o)}return t}function wo(n){return n.consumerIsAlwaysLive||n.consumers!==void 0}function lu(n){Z2?.(n)}function eS(n,e){let t=e.producersTail;if(t!==void 0){let i=e.producers;do{if(i===n)return!0;if(i===t)break;i=i.nextProducer}while(i!==void 0)}return!1}function uu(n,e){return Object.is(n,e)}function du(n,e){let t=Object.create(tS);t.computation=n,e!==void 0&&(t.equal=e);let i=()=>{if(su(t),Eo(t),t.value===ds)throw t.error;return t.value};return i[jt]=t,lu(t),i}var iu=Symbol("UNSET"),ru=Symbol("COMPUTING"),ds=Symbol("ERRORED"),tS=G(V({},Sr),{value:iu,dirty:!0,error:null,equal:uu,kind:"computed",producerMustRecompute(n){return n.value===iu||n.value===ru},producerRecomputeValue(n){if(n.value===ru)throw new Error("");let e=n.value;n.value=ru;let t=Dr(n),i,r=!1;try{i=n.computation(),fe(null),r=e!==iu&&e!==ds&&i!==ds&&n.equal(e,i)}catch(o){i=ds,n.error=o}finally{So(n,t)}if(r){n.value=e;return}n.value=i,n.version++}});function nS(){throw new Error}var c_=nS;function m_(n){c_(n)}function Np(n){c_=n}var iS=null;function Fp(n,e){let t=Object.create(cu);t.value=n,e!==void 0&&(t.equal=e);let i=()=>p_(t);return i[jt]=t,lu(t),[i,a=>To(t,a),a=>Pp(t,a)]}function p_(n){return Eo(n),n.value}function To(n,e){Ap()||m_(n),n.equal(n.value,e)||(n.value=e,rS(n))}function Pp(n,e){Ap()||m_(n),To(n,e(n.value))}var cu=G(V({},Sr),{equal:uu,value:void 0,kind:"signal"});function rS(n){n.version++,s_(),Mp(n),iS?.(n)}function be(n){return typeof n=="function"}function Io(n){let t=n(i=>{Error.call(i),i.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var mu=Io(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((i,r)=>`${r+1}) ${i.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function cs(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var xt=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:i}=this;if(be(i))try{i()}catch(o){e=o instanceof mu?o.errors:[o]}let{_finalizers:r}=this;if(r){this._finalizers=null;for(let o of r)try{f_(o)}catch(a){e=e??[],a instanceof mu?e=[...e,...a.errors]:e.push(a)}}if(e)throw new mu(e)}}add(e){var t;if(e&&e!==this)if(this.closed)f_(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&cs(t,e)}remove(e){let{_finalizers:t}=this;t&&cs(t,e),e instanceof n&&e._removeParent(this)}};xt.EMPTY=(()=>{let n=new xt;return n.closed=!0,n})();var kp=xt.EMPTY;function pu(n){return n instanceof xt||n&&"closed"in n&&be(n.remove)&&be(n.add)&&be(n.unsubscribe)}function f_(n){be(n)?n():n.unsubscribe()}var Wn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Mo={setTimeout(n,e,...t){let{delegate:i}=Mo;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Mo;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function fu(n){Mo.setTimeout(()=>{let{onUnhandledError:e}=Wn;if(e)e(n);else throw n})}function ms(){}var g_=Vp("C",void 0,void 0);function h_(n){return Vp("E",void 0,n)}function y_(n){return Vp("N",n,void 0)}function Vp(n,e,t){return{kind:n,value:e,error:t}}var Tr=null;function Ao(n){if(Wn.useDeprecatedSynchronousErrorHandling){let e=!Tr;if(e&&(Tr={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:i}=Tr;if(Tr=null,t)throw i}}else n()}function __(n){Wn.useDeprecatedSynchronousErrorHandling&&Tr&&(Tr.errorThrown=!0,Tr.error=n)}var Ir=class extends xt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,pu(e)&&e.add(this)):this.destination=sS}static create(e,t,i){return new Zi(e,t,i)}next(e){this.isStopped?Lp(y_(e),this):this._next(e)}error(e){this.isStopped?Lp(h_(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Lp(g_,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},oS=Function.prototype.bind;function Op(n,e){return oS.call(n,e)}var Bp=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){gu(i)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){gu(i)}else gu(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){gu(t)}}},Zi=class extends Ir{constructor(e,t,i){super();let r;if(be(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let o;this&&Wn.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&Op(e.next,o),error:e.error&&Op(e.error,o),complete:e.complete&&Op(e.complete,o)}):r=e}this.destination=new Bp(r)}};function gu(n){Wn.useDeprecatedSynchronousErrorHandling?__(n):fu(n)}function aS(n){throw n}function Lp(n,e){let{onStoppedNotification:t}=Wn;t&&Mo.setTimeout(()=>t(n,e))}var sS={closed:!0,next:ms,error:aS,complete:ms};var Ro=typeof Symbol=="function"&&Symbol.observable||"@@observable";function xn(n){return n}function Up(...n){return $p(n)}function $p(n){return n.length===0?xn:n.length===1?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}var Te=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){let o=uS(t)?t:new Zi(t,i,r);return Ao(()=>{let{operator:a,source:u}=this;o.add(a?a.call(o,u):u?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return i=v_(i),new i((r,o)=>{let a=new Zi({next:u=>{try{t(u)}catch(c){o(c),a.unsubscribe()}},error:o,complete:r});this.subscribe(a)})}_subscribe(t){var i;return(i=this.source)===null||i===void 0?void 0:i.subscribe(t)}[Ro](){return this}pipe(...t){return $p(t)(this)}toPromise(t){return t=v_(t),new t((i,r)=>{let o;this.subscribe(a=>o=a,a=>r(a),()=>i(o))})}}return n.create=e=>new n(e),n})();function v_(n){var e;return(e=n??Wn.Promise)!==null&&e!==void 0?e:Promise}function lS(n){return n&&be(n.next)&&be(n.error)&&be(n.complete)}function uS(n){return n&&n instanceof Ir||lS(n)&&pu(n)}function Hp(n){return be(n?.lift)}function Ne(n){return e=>{if(Hp(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Me(n,e,t,i,r){return new Gp(n,e,t,i,r)}var Gp=class extends Ir{constructor(e,t,i,r,o,a){super(e),this.onFinalize=o,this.shouldUnsubscribe=a,this._next=t?function(u){try{t(u)}catch(c){e.error(c)}}:super._next,this._error=r?function(u){try{r(u)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function No(){return Ne((n,e)=>{let t=null;n._refCount++;let i=Me(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let r=n._connection,o=t;t=null,r&&(!o||r===o)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}var Fo=class extends Te{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Hp(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new xt;let t=this.getSubject();e.add(this.source.subscribe(Me(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=xt.EMPTY)}return e}refCount(){return No()(this)}};var C_=Io(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var gt=(()=>{class n extends Te{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let i=new hu(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new C_}next(t){Ao(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let i of this.currentObservers)i.next(t)}})}error(t){Ao(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Ao(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:i,isStopped:r,observers:o}=this;return i||r?kp:(this.currentObservers=null,o.push(t),new xt(()=>{this.currentObservers=null,cs(o,t)}))}_checkFinalizedStatuses(t){let{hasError:i,thrownError:r,isStopped:o}=this;i?t.error(r):o&&t.complete()}asObservable(){let t=new Te;return t.source=this,t}}return n.create=(e,t)=>new hu(e,t),n})(),hu=class extends gt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.next)===null||i===void 0||i.call(t,e)}error(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.error)===null||i===void 0||i.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,i;return(i=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&i!==void 0?i:kp}};var Ut=class extends gt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}};var mn=new Te(n=>n.complete());function x_(n){return n&&be(n.schedule)}function b_(n){return n[n.length-1]}function yu(n){return be(b_(n))?n.pop():void 0}function Xi(n){return x_(b_(n))?n.pop():void 0}function S_(n,e,t,i){function r(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function u(h){try{m(i.next(h))}catch(y){a(y)}}function c(h){try{m(i.throw(h))}catch(y){a(y)}}function m(h){h.done?o(h.value):r(h.value).then(u,c)}m((i=i.apply(n,e||[])).next())})}function E_(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Mr(n){return this instanceof Mr?(this.v=n,this):new Mr(n)}function D_(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,o=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",a),r[Symbol.asyncIterator]=function(){return this},r;function a(C){return function(T){return Promise.resolve(T).then(C,y)}}function u(C,T){i[C]&&(r[C]=function(R){return new Promise(function(N,F){o.push([C,R,N,F])>1||c(C,R)})},T&&(r[C]=T(r[C])))}function c(C,T){try{m(i[C](T))}catch(R){v(o[0][3],R)}}function m(C){C.value instanceof Mr?Promise.resolve(C.value.v).then(h,y):v(o[0][2],C)}function h(C){c("next",C)}function y(C){c("throw",C)}function v(C,T){C(T),o.shift(),o.length&&c(o[0][0],o[0][1])}}function w_(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof E_=="function"?E_(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=n[o]&&function(a){return new Promise(function(u,c){a=n[o](a),r(u,c,a.done,a.value)})}}function r(o,a,u,c){Promise.resolve(c).then(function(m){o({value:m,done:u})},a)}}var _u=n=>n&&typeof n.length=="number"&&typeof n!="function";function vu(n){return be(n?.then)}function Cu(n){return be(n[Ro])}function xu(n){return Symbol.asyncIterator&&be(n?.[Symbol.asyncIterator])}function bu(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function dS(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Eu=dS();function Su(n){return be(n?.[Eu])}function Du(n){return D_(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:i,done:r}=yield Mr(t.read());if(r)return yield Mr(void 0);yield yield Mr(i)}}finally{t.releaseLock()}})}function wu(n){return be(n?.getReader)}function bt(n){if(n instanceof Te)return n;if(n!=null){if(Cu(n))return cS(n);if(_u(n))return mS(n);if(vu(n))return pS(n);if(xu(n))return T_(n);if(Su(n))return fS(n);if(wu(n))return gS(n)}throw bu(n)}function cS(n){return new Te(e=>{let t=n[Ro]();if(be(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function mS(n){return new Te(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function pS(n){return new Te(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,fu)})}function fS(n){return new Te(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function T_(n){return new Te(e=>{hS(n,e).catch(t=>e.error(t))})}function gS(n){return T_(Du(n))}function hS(n,e){var t,i,r,o;return S_(this,void 0,void 0,function*(){try{for(t=w_(n);i=yield t.next(),!i.done;){let a=i.value;if(e.next(a),e.closed)return}}catch(a){r={error:a}}finally{try{i&&!i.done&&(o=t.return)&&(yield o.call(t))}finally{if(r)throw r.error}}e.complete()})}function pn(n,e,t,i=0,r=!1){let o=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(o),!r)return o}function Tu(n,e=0){return Ne((t,i)=>{t.subscribe(Me(i,r=>pn(i,n,()=>i.next(r),e),()=>pn(i,n,()=>i.complete(),e),r=>pn(i,n,()=>i.error(r),e)))})}function Iu(n,e=0){return Ne((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function I_(n,e){return bt(n).pipe(Iu(e),Tu(e))}function M_(n,e){return bt(n).pipe(Iu(e),Tu(e))}function A_(n,e){return new Te(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}function R_(n,e){return new Te(t=>{let i;return pn(t,e,()=>{i=n[Eu](),pn(t,e,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(a){t.error(a);return}o?t.complete():t.next(r)},0,!0)}),()=>be(i?.return)&&i.return()})}function Mu(n,e){if(!n)throw new Error("Iterable cannot be null");return new Te(t=>{pn(t,e,()=>{let i=n[Symbol.asyncIterator]();pn(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function N_(n,e){return Mu(Du(n),e)}function F_(n,e){if(n!=null){if(Cu(n))return I_(n,e);if(_u(n))return A_(n,e);if(vu(n))return M_(n,e);if(xu(n))return Mu(n,e);if(Su(n))return R_(n,e);if(wu(n))return N_(n,e)}throw bu(n)}function at(n,e){return e?F_(n,e):bt(n)}function ue(...n){let e=Xi(n);return at(n,e)}function Mi(n,e){let t=be(n)?n:()=>n,i=r=>r.error(t());return new Te(e?r=>e.schedule(i,0,r):i)}function qp(n){return!!n&&(n instanceof Te||be(n.lift)&&be(n.subscribe))}var jn=Io(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function te(n,e){let t=typeof e=="object";return new Promise((i,r)=>{let o=new Zi({next:a=>{i(a),o.unsubscribe()},error:r,complete:()=>{t?i(e.defaultValue):r(new jn)}});n.subscribe(o)})}function he(n,e){return Ne((t,i)=>{let r=0;t.subscribe(Me(i,o=>{i.next(n.call(e,o,r++))}))})}var{isArray:yS}=Array;function _S(n,e){return yS(e)?n(...e):n(e)}function Au(n){return he(e=>_S(n,e))}var{isArray:vS}=Array,{getPrototypeOf:CS,prototype:xS,keys:bS}=Object;function Ru(n){if(n.length===1){let e=n[0];if(vS(e))return{args:e,keys:null};if(ES(e)){let t=bS(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}function ES(n){return n&&typeof n=="object"&&CS(n)===xS}function Nu(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function Fu(...n){let e=Xi(n),t=yu(n),{args:i,keys:r}=Ru(n);if(i.length===0)return at([],e);let o=new Te(SS(i,e,r?a=>Nu(r,a):xn));return t?o.pipe(Au(t)):o}function SS(n,e,t=xn){return i=>{P_(e,()=>{let{length:r}=n,o=new Array(r),a=r,u=r;for(let c=0;c<r;c++)P_(e,()=>{let m=at(n[c],e),h=!1;m.subscribe(Me(i,y=>{o[c]=y,h||(h=!0,u--),u||i.next(t(o.slice()))},()=>{--a||i.complete()}))},i)},i)}}function P_(n,e,t){n?pn(t,n,e):e()}function k_(n,e,t,i,r,o,a,u){let c=[],m=0,h=0,y=!1,v=()=>{y&&!c.length&&!m&&e.complete()},C=R=>m<i?T(R):c.push(R),T=R=>{o&&e.next(R),m++;let N=!1;bt(t(R,h++)).subscribe(Me(e,F=>{r?.(F),o?C(F):e.next(F)},()=>{N=!0},void 0,()=>{if(N)try{for(m--;c.length&&m<i;){let F=c.shift();a?pn(e,a,()=>T(F)):T(F)}v()}catch(F){e.error(F)}}))};return n.subscribe(Me(e,C,()=>{y=!0,v()})),()=>{u?.()}}function Et(n,e,t=1/0){return be(e)?Et((i,r)=>he((o,a)=>e(i,o,r,a))(bt(n(i,r))),t):(typeof e=="number"&&(t=e),Ne((i,r)=>k_(i,r,n,t)))}function Po(n=1/0){return Et(xn,n)}function V_(){return Po(1)}function ko(...n){return V_()(at(n,Xi(n)))}function ps(n){return new Te(e=>{bt(n()).subscribe(e)})}function Wp(...n){let e=yu(n),{args:t,keys:i}=Ru(n),r=new Te(o=>{let{length:a}=t;if(!a){o.complete();return}let u=new Array(a),c=a,m=a;for(let h=0;h<a;h++){let y=!1;bt(t[h]).subscribe(Me(o,v=>{y||(y=!0,m--),u[h]=v},()=>c--,void 0,()=>{(!c||!y)&&(m||o.next(i?Nu(i,u):u),o.complete())}))}});return e?r.pipe(Au(e)):r}function Mt(n,e){return Ne((t,i)=>{let r=0;t.subscribe(Me(i,o=>n.call(e,o,r++)&&i.next(o)))})}function zn(n){return Ne((e,t)=>{let i=null,r=!1,o;i=e.subscribe(Me(t,void 0,void 0,a=>{o=bt(n(a,zn(n)(e))),i?(i.unsubscribe(),i=null,o.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,o.subscribe(t))})}function O_(n,e,t,i,r){return(o,a)=>{let u=t,c=e,m=0;o.subscribe(Me(a,h=>{let y=m++;c=u?n(c,h,y):(u=!0,h),i&&a.next(c)},r&&(()=>{u&&a.next(c),a.complete()})))}}function Ai(n,e){return be(e)?Et(n,e,1):Et(n,1)}function er(n){return Ne((e,t)=>{let i=!1;e.subscribe(Me(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function Ri(n){return n<=0?()=>mn:Ne((e,t)=>{let i=0;e.subscribe(Me(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function Pu(n=DS){return Ne((e,t)=>{let i=!1;e.subscribe(Me(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function DS(){return new jn}function tr(n){return Ne((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Ni(n,e){let t=arguments.length>=2;return i=>i.pipe(n?Mt((r,o)=>n(r,o,i)):xn,Ri(1),t?er(e):Pu(()=>new jn))}function Vo(n){return n<=0?()=>mn:Ne((e,t)=>{let i=[];e.subscribe(Me(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(let r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function jp(n,e){let t=arguments.length>=2;return i=>i.pipe(n?Mt((r,o)=>n(r,o,i)):xn,Vo(1),t?er(e):Pu(()=>new jn))}function zp(n,e){return Ne(O_(n,e,arguments.length>=2,!0))}function Yp(...n){let e=Xi(n);return Ne((t,i)=>{(e?ko(n,t,e):ko(n,t)).subscribe(i)})}function zt(n,e){return Ne((t,i)=>{let r=null,o=0,a=!1,u=()=>a&&!r&&i.complete();t.subscribe(Me(i,c=>{r?.unsubscribe();let m=0,h=o++;bt(n(c,h)).subscribe(r=Me(i,y=>i.next(e?e(c,y,h,m++):y),()=>{r=null,u()}))},()=>{a=!0,u()}))})}function ku(n){return Ne((e,t)=>{bt(n).subscribe(Me(t,()=>t.complete(),ms)),!t.closed&&e.subscribe(t)})}function et(n,e,t){let i=be(n)||e||t?{next:n,error:e,complete:t}:n;return i?Ne((r,o)=>{var a;(a=i.subscribe)===null||a===void 0||a.call(i);let u=!0;r.subscribe(Me(o,c=>{var m;(m=i.next)===null||m===void 0||m.call(i,c),o.next(c)},()=>{var c;u=!1,(c=i.complete)===null||c===void 0||c.call(i),o.complete()},c=>{var m;u=!1,(m=i.error)===null||m===void 0||m.call(i,c),o.error(c)},()=>{var c,m;u&&((c=i.unsubscribe)===null||c===void 0||c.call(i)),(m=i.finalize)===null||m===void 0||m.call(i)}))}):xn}function L_(n){let e=fe(null);try{return n()}finally{fe(e)}}var B_=G(V({},Sr),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!0,dirty:!0,kind:"effect"});function U_(n){if(n.dirty=!1,n.version>0&&!Do(n))return;n.version++;let e=Dr(n);try{n.cleanup(),n.fn()}finally{So(n,e)}}var Bu="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",z=class extends Error{code;constructor(e,t){super(rr(e,t)),this.code=e}};function wS(n){return`NG0${Math.abs(n)}`}function rr(n,e){return`${wS(n)}${e?": "+e:""}`}var ki=globalThis;function qe(n){for(let e in n)if(n[e]===qe)return e;throw Error("")}function G_(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Pi(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(Pi).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let i=t.indexOf(`
`);return i>=0?t.slice(0,i):t}function Uu(n,e){return n?e?`${n} ${e}`:n:e||""}var TS=qe({__forward_ref__:qe});function ht(n){return n.__forward_ref__=ht,n.toString=function(){return Pi(this())},n}function $t(n){return o0(n)?n():n}function o0(n){return typeof n=="function"&&n.hasOwnProperty(TS)&&n.__forward_ref__===ht}function Z(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Nn(n){return{providers:n.providers||[],imports:n.imports||[]}}function _s(n){return IS(n,$u)}function a0(n){return _s(n)!==null}function IS(n,e){return n.hasOwnProperty(e)&&n[e]||null}function MS(n){let e=n?.[$u]??null;return e||null}function Kp(n){return n&&n.hasOwnProperty(Ou)?n[Ou]:null}var $u=qe({\u0275prov:qe}),Ou=qe({\u0275inj:qe}),ne=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=Z({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function s0(n){return n&&!!n.\u0275providers}var l0=qe({\u0275cmp:qe}),u0=qe({\u0275dir:qe}),d0=qe({\u0275pipe:qe}),c0=qe({\u0275mod:qe}),gs=qe({\u0275fac:qe}),Pr=qe({__NG_ELEMENT_ID__:qe}),$_=qe({__NG_ENV_ID__:qe});function fi(n){return typeof n=="string"?n:n==null?"":String(n)}function q_(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():fi(n)}var W_=qe({ngErrorCode:qe}),AS=qe({ngErrorMessage:qe}),RS=qe({ngTokenPath:qe});function m0(n,e){return j_("",-200,e)}function Hu(n,e){throw new z(-201,!1)}function j_(n,e,t){let i=new z(e,n);return i[W_]=e,i[AS]=n,t&&(i[RS]=t),i}function NS(n){return n[W_]}var Qp;function z_(){return Qp}function en(n){let e=Qp;return Qp=n,e}function p0(n,e,t){let i=_s(n);if(i&&i.providedIn=="root")return i.value===void 0?i.value=i.factory():i.value;if(t&8)return null;if(e!==void 0)return e;Hu(n,"Injector")}var FS={},Ar=FS,PS="__NG_DI_FLAG__",Zp=class{injector;constructor(e){this.injector=e}retrieve(e,t){let i=Rr(t)||0;try{return this.injector.get(e,i&8?null:Ar,i)}catch(r){if(bo(r))return r;throw r}}};function kS(n,e=0){let t=tu();if(t===void 0)throw new z(-203,!1);if(t===null)return p0(n,void 0,e);{let i=VS(e),r=t.retrieve(n,i);if(bo(r)){if(i.optional)return null;throw r}return r}}function ae(n,e=0){return(z_()||kS)($t(n),e)}function P(n,e){return ae(n,Rr(e))}function Rr(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function VS(n){return{optional:!!(n&8),host:!!(n&1),self:!!(n&2),skipSelf:!!(n&4)}}function Xp(n){let e=[];for(let t=0;t<n.length;t++){let i=$t(n[t]);if(Array.isArray(i)){if(i.length===0)throw new z(900,!1);let r,o=0;for(let a=0;a<i.length;a++){let u=i[a],c=OS(u);typeof c=="number"?c===-1?r=u.token:o|=c:r=u}e.push(ae(r,o))}else e.push(ae(i))}return e}function OS(n){return n[PS]}function nr(n,e){let t=n.hasOwnProperty(gs);return t?n[gs]:null}function Y_(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],o=e[i];if(t&&(r=t(r),o=t(o)),o!==r)return!1}return!0}function J_(n){return n.flat(Number.POSITIVE_INFINITY)}function Gu(n,e){n.forEach(t=>Array.isArray(t)?Gu(t,e):e(t))}function f0(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function vs(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function K_(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(r===1)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;){let o=r-2;n[r]=n[o],r--}n[e]=t,n[e+1]=i}}function qu(n,e,t){let i=Lo(n,e);return i>=0?n[i|1]=t:(i=~i,K_(n,i,e,t)),i}function Wu(n,e){let t=Lo(n,e);if(t>=0)return n[t|1]}function Lo(n,e){return LS(n,e,1)}function LS(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){let o=i+(r-i>>1),a=n[o<<t];if(e===a)return o<<t;a>e?r=o:i=o+1}return~(r<<t)}var or={},tn=[],ar=new ne(""),g0=new ne("",-1),h0=new ne(""),hs=class{get(e,t=Ar){if(t===Ar){let r=j_("",-201);throw r.name="\u0275NotFound",r}return t}};function y0(n){return n[c0]||null}function sr(n){return n[l0]||null}function _0(n){return n[u0]||null}function Q_(n){return n[d0]||null}function kr(n){return{\u0275providers:n}}function Z_(...n){return{\u0275providers:v0(!0,n),\u0275fromNgModule:!0}}function v0(n,...e){let t=[],i=new Set,r,o=a=>{t.push(a)};return Gu(e,a=>{let u=a;Lu(u,o,[],i)&&(r||=[],r.push(u))}),r!==void 0&&X_(r,o),t}function X_(n,e){for(let t=0;t<n.length;t++){let{ngModule:i,providers:r}=n[t];C0(r,o=>{e(o,i)})}}function Lu(n,e,t,i){if(n=$t(n),!n)return!1;let r=null,o=Kp(n),a=!o&&sr(n);if(!o&&!a){let c=n.ngModule;if(o=Kp(c),o)r=c;else return!1}else{if(a&&!a.standalone)return!1;r=n}let u=i.has(r);if(a){if(u)return!1;if(i.add(r),a.dependencies){let c=typeof a.dependencies=="function"?a.dependencies():a.dependencies;for(let m of c)Lu(m,e,t,i)}}else if(o){if(o.imports!=null&&!u){i.add(r);let m;try{Gu(o.imports,h=>{Lu(h,e,t,i)&&(m||=[],m.push(h))})}finally{}m!==void 0&&X_(m,e)}if(!u){let m=nr(r)||(()=>new r);e({provide:r,useFactory:m,deps:tn},r),e({provide:h0,useValue:r,multi:!0},r),e({provide:ar,useValue:()=>ae(r),multi:!0},r)}let c=o.providers;if(c!=null&&!u){let m=n;C0(c,h=>{e(h,m)})}}else return!1;return r!==n&&n.providers!==void 0}function C0(n,e){for(let t of n)s0(t)&&(t=t.\u0275providers),Array.isArray(t)?C0(t,e):e(t)}var BS=qe({provide:String,useValue:qe});function e1(n){return n!==null&&typeof n=="object"&&BS in n}function US(n){return!!(n&&n.useExisting)}function $S(n){return!!(n&&n.useFactory)}function Nr(n){return typeof n=="function"}function t1(n){return!!n.useClass}var Cs=new ne(""),Vu={},H_={},Jp;function xs(){return Jp===void 0&&(Jp=new hs),Jp}var St=class{},Fr=class extends St{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,t0(e,a=>this.processProvider(a)),this.records.set(g0,Oo(void 0,this)),r.has("environment")&&this.records.set(St,Oo(void 0,this));let o=this.records.get(Cs);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(h0,tn,{self:!0}))}retrieve(e,t){let i=Rr(t)||0;try{return this.get(e,Ar,i)}catch(r){if(bo(r))return r;throw r}}destroy(){fs(this),this._destroyed=!0;let e=fe(null);try{for(let i of this._ngOnDestroyHooks)i.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let i of t)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),fe(e)}}onDestroy(e){return fs(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){fs(this);let t=pi(this),i=en(void 0),r;try{return e()}finally{pi(t),en(i)}}get(e,t=Ar,i){if(fs(this),e.hasOwnProperty($_))return e[$_](this);let r=Rr(i),o,a=pi(this),u=en(void 0);try{if(!(r&4)){let m=this.records.get(e);if(m===void 0){let h=jS(e)&&_s(e);h&&this.injectableDefInScope(h)?m=Oo(e0(e),Vu):m=null,this.records.set(e,m)}if(m!=null)return this.hydrate(e,m,r)}let c=r&2?xs():this.parent;return t=r&8&&t===Ar?null:t,c.get(e,t)}catch(c){let m=NS(c);throw m===-200||m===-201?new z(m,null):c}finally{en(u),pi(a)}}resolveInjectorInitializers(){let e=fe(null),t=pi(this),i=en(void 0),r;try{let o=this.get(ar,tn,{self:!0});for(let a of o)a()}finally{pi(t),en(i),fe(e)}}toString(){let e=[],t=this.records;for(let i of t.keys())e.push(Pi(i));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=$t(e);let t=Nr(e)?e:$t(e&&e.provide),i=GS(e);if(!Nr(e)&&e.multi===!0){let r=this.records.get(t);r||(r=Oo(void 0,Vu,!0),r.factory=()=>Xp(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t,i){let r=fe(null);try{if(t.value===H_)throw m0(Pi(e));return t.value===Vu&&(t.value=H_,t.value=t.factory(void 0,i)),typeof t.value=="object"&&t.value&&WS(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{fe(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=$t(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function e0(n){let e=_s(n),t=e!==null?e.factory:nr(n);if(t!==null)return t;if(n instanceof ne)throw new z(204,!1);if(n instanceof Function)return HS(n);throw new z(204,!1)}function HS(n){if(n.length>0)throw new z(204,!1);let t=MS(n);return t!==null?()=>t.factory(n):()=>new n}function GS(n){if(e1(n))return Oo(void 0,n.useValue);{let e=x0(n);return Oo(e,Vu)}}function x0(n,e,t){let i;if(Nr(n)){let r=$t(n);return nr(r)||e0(r)}else if(e1(n))i=()=>$t(n.useValue);else if($S(n))i=()=>n.useFactory(...Xp(n.deps||[]));else if(US(n))i=(r,o)=>ae($t(n.useExisting),o!==void 0&&o&8?8:void 0);else{let r=$t(n&&(n.useClass||n.provide));if(qS(n))i=()=>new r(...Xp(n.deps));else return nr(r)||e0(r)}return i}function fs(n){if(n.destroyed)throw new z(205,!1)}function Oo(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function qS(n){return!!n.deps}function WS(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function jS(n){return typeof n=="function"||typeof n=="object"&&n.ngMetadataName==="InjectionToken"}function t0(n,e){for(let t of n)Array.isArray(t)?t0(t,e):t&&s0(t)?t0(t.\u0275providers,e):e(t)}function Rt(n,e){let t;n instanceof Fr?(fs(n),t=n):t=new Zp(n);let i,r=pi(t),o=en(void 0);try{return e()}finally{pi(r),en(o)}}function n1(){return z_()!==void 0||tu()!=null}var Yn=0,se=1,ge=2,At=3,Fn=4,Pn=5,Bo=6,Uo=7,yt=8,Vi=9,gi=10,Je=11,$o=12,b0=13,Vr=14,bn=15,lr=16,Or=17,hi=18,bs=19,E0=20,Fi=21,ju=22,Oi=23,En=24,Lr=25,Br=26,st=27,i1=1,S0=6,ur=7,Es=8,Ur=9,ft=10;function yi(n){return Array.isArray(n)&&typeof n[i1]=="object"}function Jn(n){return Array.isArray(n)&&n[i1]===!0}function D0(n){return(n.flags&4)!==0}function dr(n){return n.componentOffset>-1}function Ho(n){return(n.flags&1)===1}function _i(n){return!!n.template}function Go(n){return(n[ge]&512)!==0}function $r(n){return(n[ge]&256)===256}var w0="svg",r1="math";function kn(n){for(;Array.isArray(n);)n=n[Yn];return n}function T0(n,e){return kn(e[n])}function Kn(n,e){return kn(e[n.index])}function Ss(n,e){return n.data[e]}function zu(n,e){return n[e]}function I0(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}function Vn(n,e){let t=e[n];return yi(t)?t:t[Yn]}function o1(n){return(n[ge]&4)===4}function Yu(n){return(n[ge]&128)===128}function a1(n){return Jn(n[At])}function On(n,e){return e==null?null:n[e]}function M0(n){n[Or]=0}function A0(n){n[ge]&1024||(n[ge]|=1024,Yu(n)&&cr(n))}function s1(n,e){for(;n>0;)e=e[Vr],n--;return e}function Ds(n){return!!(n[ge]&9216||n[En]?.dirty)}function Ju(n){n[gi].changeDetectionScheduler?.notify(8),n[ge]&64&&(n[ge]|=1024),Ds(n)&&cr(n)}function cr(n){n[gi].changeDetectionScheduler?.notify(0);let e=ir(n);for(;e!==null&&!(e[ge]&8192||(e[ge]|=8192,!Yu(e)));)e=ir(e)}function R0(n,e){if($r(n))throw new z(911,!1);n[Fi]===null&&(n[Fi]=[]),n[Fi].push(e)}function l1(n,e){if(n[Fi]===null)return;let t=n[Fi].indexOf(e);t!==-1&&n[Fi].splice(t,1)}function ir(n){let e=n[At];return Jn(e)?e[At]:e}function N0(n){return n[Uo]??=[]}function F0(n){return n.cleanup??=[]}function u1(n,e,t,i){let r=N0(e);r.push(t),n.firstCreatePass&&F0(n).push(i,r.length-1)}var Ee={lFrame:b1(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var n0=!1;function d1(){return Ee.lFrame.elementDepthCount}function c1(){Ee.lFrame.elementDepthCount++}function P0(){Ee.lFrame.elementDepthCount--}function Ku(){return Ee.bindingsEnabled}function m1(){return Ee.skipHydrationRootTNode!==null}function k0(n){return Ee.skipHydrationRootTNode===n}function V0(){Ee.skipHydrationRootTNode=null}function ce(){return Ee.lFrame.lView}function it(){return Ee.lFrame.tView}function D(n){return Ee.lFrame.contextLView=n,n[yt]}function w(n){return Ee.lFrame.contextLView=null,n}function Dt(){let n=O0();for(;n!==null&&n.type===64;)n=n.parent;return n}function O0(){return Ee.lFrame.currentTNode}function p1(){let n=Ee.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function qo(n,e){let t=Ee.lFrame;t.currentTNode=n,t.isParent=e}function L0(){return Ee.lFrame.isParent}function f1(){Ee.lFrame.isParent=!1}function g1(){return Ee.lFrame.contextLView}function B0(){return n0}function Wo(n){let e=n0;return n0=n,e}function Qu(){let n=Ee.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function U0(){return Ee.lFrame.bindingIndex}function h1(n){return Ee.lFrame.bindingIndex=n}function mr(){return Ee.lFrame.bindingIndex++}function ws(n){let e=Ee.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function y1(){return Ee.lFrame.inI18n}function _1(n,e){let t=Ee.lFrame;t.bindingIndex=t.bindingRootIndex=n,Zu(e)}function v1(){return Ee.lFrame.currentDirectiveIndex}function Zu(n){Ee.lFrame.currentDirectiveIndex=n}function C1(n){let e=Ee.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function $0(){return Ee.lFrame.currentQueryIndex}function Xu(n){Ee.lFrame.currentQueryIndex=n}function zS(n){let e=n[se];return e.type===2?e.declTNode:e.type===1?n[Pn]:null}function H0(n,e,t){if(t&4){let r=e,o=n;for(;r=r.parent,r===null&&!(t&1);)if(r=zS(o),r===null||(o=o[Vr],r.type&10))break;if(r===null)return!1;e=r,n=o}let i=Ee.lFrame=x1();return i.currentTNode=e,i.lView=n,!0}function ed(n){let e=x1(),t=n[se];Ee.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function x1(){let n=Ee.lFrame,e=n===null?null:n.child;return e===null?b1(n):e}function b1(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function E1(){let n=Ee.lFrame;return Ee.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var G0=E1;function td(){let n=E1();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function S1(n){return(Ee.lFrame.contextLView=s1(n,Ee.lFrame.contextLView))[yt]}function Qn(){return Ee.lFrame.selectedIndex}function pr(n){Ee.lFrame.selectedIndex=n}function Ts(){let n=Ee.lFrame;return Ss(n.tView,n.selectedIndex)}function Li(){Ee.lFrame.currentNamespace=w0}function Hr(){YS()}function YS(){Ee.lFrame.currentNamespace=null}function D1(){return Ee.lFrame.currentNamespace}var w1=!0;function nd(){return w1}function Is(n){w1=n}function i0(n,e=null,t=null,i){let r=q0(n,e,t,i);return r.resolveInjectorInitializers(),r}function q0(n,e=null,t=null,i,r=new Set){let o=[t||tn,Z_(n)];return i=i||(typeof n=="object"?void 0:Pi(n)),new Fr(o,e||xs(),i||null,r)}var Yt=class n{static THROW_IF_NOT_FOUND=Ar;static NULL=new hs;static create(e,t){if(Array.isArray(e))return i0({name:""},t,e,"");{let i=e.name??"";return i0({name:i},e.parent,e.providers,i)}}static \u0275prov=Z({token:n,providedIn:"any",factory:()=>ae(g0)});static __NG_ELEMENT_ID__=-1},Nt=new ne(""),Ln=(()=>{class n{static __NG_ELEMENT_ID__=JS;static __NG_ENV_ID__=t=>t}return n})(),ys=class extends Ln{_lView;constructor(e){super(),this._lView=e}get destroyed(){return $r(this._lView)}onDestroy(e){let t=this._lView;return R0(t,e),()=>l1(t,e)}};function JS(){return new ys(ce())}var An=class{_console=console;handleError(e){this._console.error("ERROR",e)}},fn=new ne("",{providedIn:"root",factory:()=>{let n=P(St),e;return t=>{n.destroyed&&!e?setTimeout(()=>{throw t}):(e??=n.get(An),e.handleError(t))}}}),T1={provide:ar,useValue:()=>void P(An),multi:!0};function W0(n){return typeof n=="function"&&n[jt]!==void 0}function S(n,e){let[t,i,r]=Fp(n,e?.equal),o=t,a=o[jt];return o.set=i,o.update=r,o.asReadonly=j0.bind(o),o}function j0(){let n=this[jt];if(n.readonlyFn===void 0){let e=()=>this();e[jt]=n,n.readonlyFn=e}return n.readonlyFn}function z0(n){return W0(n)&&typeof n.set=="function"}var jo=(()=>{class n{view;node;constructor(t,i){this.view=t,this.node=i}static __NG_ELEMENT_ID__=KS}return n})();function KS(){return new jo(ce(),Dt())}var Rn=class{},Ms=new ne("",{providedIn:"root",factory:()=>!1});var Y0=new ne(""),id=new ne(""),vi=(()=>{class n{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new Ut(!1);get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new Te(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=Z({token:n,providedIn:"root",factory:()=>new n})}return n})(),zo=(()=>{class n{internalPendingTasks=P(vi);scheduler=P(Rn);errorHandler=P(fn);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(t))}}run(t){let i=this.add();t().catch(this.errorHandler).finally(i)}static \u0275prov=Z({token:n,providedIn:"root",factory:()=>new n})}return n})();function Gr(...n){}var As=(()=>{class n{static \u0275prov=Z({token:n,providedIn:"root",factory:()=>new r0})}return n})(),r0=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let t=e.zone,i=this.queues.get(t);i.has(e)&&(i.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let i=this.queues.get(t);i.has(e)||i.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[t,i]of this.queues)t===null?e||=this.flushQueue(i):e||=t.run(()=>this.flushQueue(i));e||(this.dirtyEffectCount=0)}}flushQueue(e){let t=!1;for(let i of e)i.dirty&&(this.dirtyEffectCount--,t=!0,i.run());return t}};function $s(n){return{toString:n}.toString()}function nD(n){return typeof n=="function"}var md=class{previousValue;currentValue;firstChange;constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}};function rv(n,e,t,i){e!==null?e.applyValueToInputSignal(e,i):n[t]=i}var Un=(()=>{let n=()=>ov;return n.ngInherit=!0,n})();function ov(n){return n.type.prototype.ngOnChanges&&(n.setInput=rD),iD}function iD(){let n=sv(this),e=n?.current;if(e){let t=n.previous;if(t===or)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function rD(n,e,t,i,r){let o=this.declaredInputs[i],a=sv(n)||oD(n,{previous:or,current:null}),u=a.current||(a.current={}),c=a.previous,m=c[o];u[o]=new md(m&&m.currentValue,t,c===or),rv(n,e,r,t)}var av="__ngSimpleChanges__";function sv(n){return n[av]||null}function oD(n,e){return n[av]=e}var I1=[];var ze=function(n,e=null,t){for(let i=0;i<I1.length;i++){let r=I1[i];r(n,e,t)}};function aD(n,e,t){let{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=e.type.prototype;if(i){let a=ov(e);(t.preOrderHooks??=[]).push(n,a),(t.preOrderCheckHooks??=[]).push(n,a)}r&&(t.preOrderHooks??=[]).push(0-n,r),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function lv(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:a,ngAfterContentChecked:u,ngAfterViewInit:c,ngAfterViewChecked:m,ngOnDestroy:h}=o;a&&(n.contentHooks??=[]).push(-t,a),u&&((n.contentHooks??=[]).push(t,u),(n.contentCheckHooks??=[]).push(t,u)),c&&(n.viewHooks??=[]).push(-t,c),m&&((n.viewHooks??=[]).push(t,m),(n.viewCheckHooks??=[]).push(t,m)),h!=null&&(n.destroyHooks??=[]).push(t,h)}}function sd(n,e,t){uv(n,e,3,t)}function ld(n,e,t,i){(n[ge]&3)===t&&uv(n,e,t,i)}function J0(n,e){let t=n[ge];(t&3)===e&&(t&=16383,t+=1,n[ge]=t)}function uv(n,e,t,i){let r=i!==void 0?n[Or]&65535:0,o=i??-1,a=e.length-1,u=0;for(let c=r;c<a;c++)if(typeof e[c+1]=="number"){if(u=e[c],i!=null&&u>=i)break}else e[c]<0&&(n[Or]+=65536),(u<o||o==-1)&&(sD(n,t,e,c),n[Or]=(n[Or]&4294901760)+c+2),c++}function M1(n,e){ze(4,n,e);let t=fe(null);try{e.call(n)}finally{fe(t),ze(5,n,e)}}function sD(n,e,t,i){let r=t[i]<0,o=t[i+1],a=r?-t[i]:t[i],u=n[a];r?n[ge]>>14<n[Or]>>16&&(n[ge]&3)===e&&(n[ge]+=16384,M1(u,o)):M1(u,o)}var Jo=-1,Wr=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,i,r){this.factory=e,this.name=r,this.canSeeViewProviders=t,this.injectImpl=i}};function lD(n){return(n.flags&8)!==0}function uD(n){return(n.flags&16)!==0}function dD(n,e,t){let i=0;for(;i<t.length;){let r=t[i];if(typeof r=="number"){if(r!==0)break;i++;let o=t[i++],a=t[i++],u=t[i++];n.setAttribute(e,a,u,o)}else{let o=r,a=t[++i];cD(o)?n.setProperty(e,o,a):n.setAttribute(e,o,a),i++}}return i}function dv(n){return n===3||n===4||n===6}function cD(n){return n.charCodeAt(0)===64}function Ko(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){let r=e[i];typeof r=="number"?t=r:t===0||(t===-1||t===2?A1(n,t,r,null,e[++i]):A1(n,t,r,null,null))}}return n}function A1(n,e,t,i,r){let o=0,a=n.length;if(e===-1)a=-1;else for(;o<n.length;){let u=n[o++];if(typeof u=="number"){if(u===e){a=-1;break}else if(u>e){a=o-1;break}}}for(;o<n.length;){let u=n[o];if(typeof u=="number")break;if(u===t){r!==null&&(n[o+1]=r);return}o++,r!==null&&o++}a!==-1&&(n.splice(a,0,e),o=a+1),n.splice(o++,0,t),r!==null&&n.splice(o++,0,r)}function cv(n){return n!==Jo}function pd(n){return n&32767}function mD(n){return n>>16}function fd(n,e){let t=mD(n),i=e;for(;t>0;)i=i[Vr],t--;return i}var sf=!0;function gd(n){let e=sf;return sf=n,e}var pD=256,mv=pD-1,pv=5,fD=0,Ci={};function gD(n,e,t){let i;typeof t=="string"?i=t.charCodeAt(0)||0:t.hasOwnProperty(Pr)&&(i=t[Pr]),i==null&&(i=t[Pr]=fD++);let r=i&mv,o=1<<r;e.data[n+(r>>pv)]|=o}function hd(n,e){let t=fv(n,e);if(t!==-1)return t;let i=e[se];i.firstCreatePass&&(n.injectorIndex=e.length,K0(i.data,n),K0(e,null),K0(i.blueprint,null));let r=Lf(n,e),o=n.injectorIndex;if(cv(r)){let a=pd(r),u=fd(r,e),c=u[se].data;for(let m=0;m<8;m++)e[o+m]=u[a+m]|c[a+m]}return e[o+8]=r,o}function K0(n,e){n.push(0,0,0,0,0,0,0,0,e)}function fv(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function Lf(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;r!==null;){if(i=vv(r),i===null)return Jo;if(t++,r=r[Vr],i.injectorIndex!==-1)return i.injectorIndex|t<<16}return Jo}function lf(n,e,t){gD(n,e,t)}function hD(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let i=t.length,r=0;for(;r<i;){let o=t[r];if(dv(o))break;if(o===0)r=r+2;else if(typeof o=="number")for(r++;r<i&&typeof t[r]=="string";)r++;else{if(o===e)return t[r+1];r=r+2}}}return null}function gv(n,e,t){if(t&8||n!==void 0)return n;Hu(e,"NodeInjector")}function hv(n,e,t,i){if(t&8&&i===void 0&&(i=null),(t&3)===0){let r=n[Vi],o=en(void 0);try{return r?r.get(e,i,t&8):p0(e,i,t&8)}finally{en(o)}}return gv(i,e,t)}function yv(n,e,t,i=0,r){if(n!==null){if(e[ge]&2048&&!(i&2)){let a=CD(n,e,t,i,Ci);if(a!==Ci)return a}let o=_v(n,e,t,i,Ci);if(o!==Ci)return o}return hv(e,t,i,r)}function _v(n,e,t,i,r){let o=_D(t);if(typeof o=="function"){if(!H0(e,n,i))return i&1?gv(r,t,i):hv(e,t,i,r);try{let a;if(a=o(i),a==null&&!(i&8))Hu(t);else return a}finally{G0()}}else if(typeof o=="number"){let a=null,u=fv(n,e),c=Jo,m=i&1?e[bn][Pn]:null;for((u===-1||i&4)&&(c=u===-1?Lf(n,e):e[u+8],c===Jo||!N1(i,!1)?u=-1:(a=e[se],u=pd(c),e=fd(c,e)));u!==-1;){let h=e[se];if(R1(o,u,h.data)){let y=yD(u,e,t,a,i,m);if(y!==Ci)return y}c=e[u+8],c!==Jo&&N1(i,e[se].data[u+8]===m)&&R1(o,u,e)?(a=h,u=pd(c),e=fd(c,e)):u=-1}}return r}function yD(n,e,t,i,r,o){let a=e[se],u=a.data[n+8],c=i==null?dr(u)&&sf:i!=a&&(u.type&3)!==0,m=r&1&&o===u,h=ud(u,a,t,c,m);return h!==null?Fs(e,a,h,u,r):Ci}function ud(n,e,t,i,r){let o=n.providerIndexes,a=e.data,u=o&1048575,c=n.directiveStart,m=n.directiveEnd,h=o>>20,y=i?u:u+h,v=r?u+h:m;for(let C=y;C<v;C++){let T=a[C];if(C<c&&t===T||C>=c&&T.type===t)return C}if(r){let C=a[c];if(C&&_i(C)&&C.type===t)return c}return null}function Fs(n,e,t,i,r){let o=n[t],a=e.data;if(o instanceof Wr){let u=o;if(u.resolving){let C=q_(a[t]);throw m0(C)}let c=gd(u.canSeeViewProviders);u.resolving=!0;let m=a[t].type||a[t],h,y=u.injectImpl?en(u.injectImpl):null,v=H0(n,i,0);try{o=n[t]=u.factory(void 0,r,a,n,i),e.firstCreatePass&&t>=i.directiveStart&&aD(t,a[t],e)}finally{y!==null&&en(y),gd(c),u.resolving=!1,G0()}}return o}function _D(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(Pr)?n[Pr]:void 0;return typeof e=="number"?e>=0?e&mv:vD:e}function R1(n,e,t){let i=1<<n;return!!(t[e+(n>>pv)]&i)}function N1(n,e){return!(n&2)&&!(n&1&&e)}var qr=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return yv(this._tNode,this._lView,e,Rr(i),t)}};function vD(){return new qr(Dt(),ce())}function Jt(n){return $s(()=>{let e=n.prototype.constructor,t=e[gs]||uf(e),i=Object.prototype,r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){let o=r[gs]||uf(r);if(o&&o!==t)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function uf(n){return o0(n)?()=>{let e=uf($t(n));return e&&e()}:nr(n)}function CD(n,e,t,i,r){let o=n,a=e;for(;o!==null&&a!==null&&a[ge]&2048&&!Go(a);){let u=_v(o,a,t,i|2,Ci);if(u!==Ci)return u;let c=o.parent;if(!c){let m=a[E0];if(m){let h=m.get(t,Ci,i);if(h!==Ci)return h}c=vv(a),a=a[Vr]}o=c}return r}function vv(n){let e=n[se],t=e.type;return t===2?e.declTNode:t===1?n[Pn]:null}function Hs(n){return hD(Dt(),n)}function xD(){return ea(Dt(),ce())}function ea(n,e){return new nn(Kn(n,e))}var nn=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=xD}return n})();function bD(n){return n instanceof nn?n.nativeElement:n}function ED(){return this._results[Symbol.iterator]()}var yd=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new gt}constructor(e=!1){this._emitDistinctChangesOnly=e}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let i=J_(e);(this._changesDetected=!Y_(this._results,i,t))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=ED};function Cv(n){return(n.flags&128)===128}var Bf=(function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n})(Bf||{}),xv=new Map,SD=0;function DD(){return SD++}function wD(n){xv.set(n[bs],n)}function df(n){xv.delete(n[bs])}var F1="__ngContext__";function Qo(n,e){yi(e)?(n[F1]=e[bs],wD(e)):n[F1]=e}function bv(n){return Sv(n[$o])}function Ev(n){return Sv(n[Fn])}function Sv(n){for(;n!==null&&!Jn(n);)n=n[Fn];return n}var cf;function Uf(n){cf=n}function Dv(){if(cf!==void 0)return cf;if(typeof document<"u")return document;throw new z(210,!1)}var Fd=new ne("",{providedIn:"root",factory:()=>TD}),TD="ng",Pd=new ne(""),Gs=new ne("",{providedIn:"platform",factory:()=>"unknown"});var kd=new ne("",{providedIn:"root",factory:()=>Dv().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var ID="h",MD="b";var wv="r";var Tv="di";var Iv=!1,Mv=new ne("",{providedIn:"root",factory:()=>Iv});var AD=(n,e,t,i)=>{};function RD(n,e,t,i){AD(n,e,t,i)}function $f(n){return(n.flags&32)===32}var ND=()=>null;function Av(n,e,t=!1){return ND(n,e,t)}function Rv(n,e){let t=n.contentQueries;if(t!==null){let i=fe(null);try{for(let r=0;r<t.length;r+=2){let o=t[r],a=t[r+1];if(a!==-1){let u=n.data[a];Xu(o),u.contentQueries(2,e[a],a)}}}finally{fe(i)}}}function mf(n,e,t){Xu(0);let i=fe(null);try{e(n,t)}finally{fe(i)}}function Hf(n,e,t){if(D0(e)){let i=fe(null);try{let r=e.directiveStart,o=e.directiveEnd;for(let a=r;a<o;a++){let u=n.data[a];if(u.contentQueries){let c=t[a];u.contentQueries(1,c,a)}}}finally{fe(i)}}}var Bi=(function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n})(Bi||{});var rd;function FD(){if(rd===void 0&&(rd=null,ki.trustedTypes))try{rd=ki.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return rd}function P1(n){return FD()?.createScriptURL(n)||n}var _d=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Bu})`}};function qs(n){return n instanceof _d?n.changingThisBreaksApplicationSecurity:n}function Gf(n,e){let t=Nv(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${Bu})`)}return t===e}function Nv(n){return n instanceof _d&&n.getTypeName()||null}var PD=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Fv(n){return n=String(n),n.match(PD)?n:"unsafe:"+n}var kD=/^>|^->|<!--|-->|--!>|<!-$/g,VD=/(<|>)/g,OD="\u200B$1\u200B";function LD(n){return n.replace(kD,e=>e.replace(VD,OD))}function BD(n,e){return n.createText(e)}function UD(n,e,t){n.setValue(e,t)}function $D(n,e){return n.createComment(LD(e))}function Pv(n,e,t){return n.createElement(e,t)}function vd(n,e,t,i,r){n.insertBefore(e,t,i,r)}function kv(n,e,t){n.appendChild(e,t)}function k1(n,e,t,i,r){i!==null?vd(n,e,t,i,r):kv(n,e,t)}function Vv(n,e,t,i){n.removeChild(null,e,t,i)}function HD(n,e,t){n.setAttribute(e,"style",t)}function GD(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function Ov(n,e,t){let{mergedAttrs:i,classes:r,styles:o}=t;i!==null&&dD(n,e,i),r!==null&&GD(n,e,r),o!==null&&HD(n,e,o)}var Vd=(function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n})(Vd||{});function Ft(n){let e=Bv();return e?e.sanitize(Vd.URL,n)||"":Gf(n,"URL")?qs(n):Fv(fi(n))}function Lv(n){let e=Bv();if(e)return P1(e.sanitize(Vd.RESOURCE_URL,n)||"");if(Gf(n,"ResourceURL"))return P1(qs(n));throw new z(904,!1)}var qD=new Set(["embed","frame","iframe","media","script"]),WD=new Set(["base","link","script"]);function jD(n,e){return e==="src"&&qD.has(n)||e==="href"&&WD.has(n)||e==="xlink:href"&&n==="script"?Lv:Ft}function qf(n,e,t){return jD(e,t)(n)}function Bv(){let n=ce();return n&&n[gi].sanitizer}function Uv(n){return n instanceof Function?n():n}function zD(n,e,t){let i=n.length;for(;;){let r=n.indexOf(e,t);if(r===-1)return r;if(r===0||n.charCodeAt(r-1)<=32){let o=e.length;if(r+o===i||n.charCodeAt(r+o)<=32)return r}t=r+1}}var $v="ng-template";function YD(n,e,t,i){let r=0;if(i){for(;r<e.length&&typeof e[r]=="string";r+=2)if(e[r]==="class"&&zD(e[r+1].toLowerCase(),t,0)!==-1)return!0}else if(Wf(n))return!1;if(r=e.indexOf(1,r),r>-1){let o;for(;++r<e.length&&typeof(o=e[r])=="string";)if(o.toLowerCase()===t)return!0}return!1}function Wf(n){return n.type===4&&n.value!==$v}function JD(n,e,t){let i=n.type===4&&!t?$v:n.value;return e===i}function KD(n,e,t){let i=4,r=n.attrs,o=r!==null?XD(r):0,a=!1;for(let u=0;u<e.length;u++){let c=e[u];if(typeof c=="number"){if(!a&&!Zn(i)&&!Zn(c))return!1;if(a&&Zn(c))continue;a=!1,i=c|i&1;continue}if(!a)if(i&4){if(i=2|i&1,c!==""&&!JD(n,c,t)||c===""&&e.length===1){if(Zn(i))return!1;a=!0}}else if(i&8){if(r===null||!YD(n,r,c,t)){if(Zn(i))return!1;a=!0}}else{let m=e[++u],h=QD(c,r,Wf(n),t);if(h===-1){if(Zn(i))return!1;a=!0;continue}if(m!==""){let y;if(h>o?y="":y=r[h+1].toLowerCase(),i&2&&m!==y){if(Zn(i))return!1;a=!0}}}}return Zn(i)||a}function Zn(n){return(n&1)===0}function QD(n,e,t,i){if(e===null)return-1;let r=0;if(i||!t){let o=!1;for(;r<e.length;){let a=e[r];if(a===n)return r;if(a===3||a===6)o=!0;else if(a===1||a===2){let u=e[++r];for(;typeof u=="string";)u=e[++r];continue}else{if(a===4)break;if(a===0){r+=4;continue}}r+=o?1:2}return-1}else return ew(e,n)}function ZD(n,e,t=!1){for(let i=0;i<e.length;i++)if(KD(n,e[i],t))return!0;return!1}function XD(n){for(let e=0;e<n.length;e++){let t=n[e];if(dv(t))return e}return n.length}function ew(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let i=n[t];if(typeof i=="number")return-1;if(i===e)return t;t++}return-1}function V1(n,e){return n?":not("+e.trim()+")":e}function tw(n){let e=n[0],t=1,i=2,r="",o=!1;for(;t<n.length;){let a=n[t];if(typeof a=="string")if(i&2){let u=n[++t];r+="["+a+(u.length>0?'="'+u+'"':"")+"]"}else i&8?r+="."+a:i&4&&(r+=" "+a);else r!==""&&!Zn(a)&&(e+=V1(o,r),r=""),i=a,o=o||!Zn(i);t++}return r!==""&&(e+=V1(o,r)),e}function nw(n){return n.map(tw).join(",")}function iw(n){let e=[],t=[],i=1,r=2;for(;i<n.length;){let o=n[i];if(typeof o=="string")r===2?o!==""&&e.push(o,n[++i]):r===8&&t.push(o);else{if(!Zn(r))break;r=o}i++}return t.length&&e.push(1,...t),e}var Ht={};function jf(n,e,t,i,r,o,a,u,c,m,h){let y=st+i,v=y+r,C=rw(y,v),T=typeof m=="function"?m():m;return C[se]={type:n,blueprint:C,template:t,queries:null,viewQuery:u,declTNode:e,data:C.slice().fill(null,y),bindingStartIndex:y,expandoStartIndex:v,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof a=="function"?a():a,firstChild:null,schemas:c,consts:T,incompleteFirstPass:!1,ssrId:h}}function rw(n,e){let t=[];for(let i=0;i<e;i++)t.push(i<n?null:Ht);return t}function ow(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=jf(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function zf(n,e,t,i,r,o,a,u,c,m,h){let y=e.blueprint.slice();return y[Yn]=r,y[ge]=i|4|128|8|64|1024,(m!==null||n&&n[ge]&2048)&&(y[ge]|=2048),M0(y),y[At]=y[Vr]=n,y[yt]=t,y[gi]=a||n&&n[gi],y[Je]=u||n&&n[Je],y[Vi]=c||n&&n[Vi]||null,y[Pn]=o,y[bs]=DD(),y[Bo]=h,y[E0]=m,y[bn]=e.type==2?n[bn]:y,y}function aw(n,e,t){let i=Kn(e,n),r=ow(t),o=n[gi].rendererFactory,a=Yf(n,zf(n,r,null,Hv(t),i,e,null,o.createRenderer(i,t),null,null,null));return n[e.index]=a}function Hv(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function Gv(n,e,t,i){if(t===0)return-1;let r=e.length;for(let o=0;o<t;o++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function Yf(n,e){return n[$o]?n[b0][Fn]=e:n[$o]=e,n[b0]=e,e}function f(n=1){qv(it(),ce(),Qn()+n,!1)}function qv(n,e,t,i){if(!i)if((e[ge]&3)===3){let o=n.preOrderCheckHooks;o!==null&&sd(e,o,t)}else{let o=n.preOrderHooks;o!==null&&ld(e,o,0,t)}pr(t)}var Od=(function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n})(Od||{});function pf(n,e,t,i){let r=fe(null);try{let[o,a,u]=n.inputs[t],c=null;(a&Od.SignalBased)!==0&&(c=e[o][jt]),c!==null&&c.transformFn!==void 0?i=c.transformFn(i):u!==null&&(i=u.call(e,i)),n.setInput!==null?n.setInput(e,c,i,t,o):rv(e,c,o,i)}finally{fe(r)}}var xi=(function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n})(xi||{}),sw;function Jf(n,e){return sw(n,e)}var jr=new Set,Ld=(function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n})(Ld||{}),Kr=new ne(""),O1=new Set;function Ui(n){O1.has(n)||(O1.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var Wv=!1,ff=class extends gt{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,n1()&&(this.destroyRef=P(Ln,{optional:!0})??void 0,this.pendingTasks=P(vi,{optional:!0})??void 0)}emit(e){let t=fe(null);try{super.next(e)}finally{fe(t)}}subscribe(e,t,i){let r=e,o=t||(()=>null),a=i;if(e&&typeof e=="object"){let c=e;r=c.next?.bind(c),o=c.error?.bind(c),a=c.complete?.bind(c)}this.__isAsync&&(o=this.wrapInTimeout(o),r&&(r=this.wrapInTimeout(r)),a&&(a=this.wrapInTimeout(a)));let u=super.subscribe({next:r,error:o,complete:a});return e instanceof xt&&e.add(u),u}wrapInTimeout(e){return t=>{let i=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{i!==void 0&&this.pendingTasks?.remove(i)}})}}},lt=ff;function jv(n){let e,t;function i(){n=Gr;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),i()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),i()})),()=>i()}function L1(n){return queueMicrotask(()=>n()),()=>{n=Gr}}var Kf="isAngularZone",Cd=Kf+"_ID",lw=0,_t=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new lt(!1);onMicrotaskEmpty=new lt(!1);onStable=new lt(!1);onError=new lt(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:o=Wv}=e;if(typeof Zone>"u")throw new z(908,!1);Zone.assertZonePatched();let a=this;a._nesting=0,a._outer=a._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(a._inner=a._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(a._inner=a._inner.fork(Zone.longStackTraceZoneSpec)),a.shouldCoalesceEventChangeDetection=!r&&i,a.shouldCoalesceRunChangeDetection=r,a.callbackScheduled=!1,a.scheduleInRootZone=o,cw(a)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(Kf)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new z(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new z(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){let o=this._inner,a=o.scheduleEventTask("NgZoneEvent: "+r,e,uw,Gr,Gr);try{return o.runTask(a,t,i)}finally{o.cancelTask(a)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}},uw={};function Qf(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function dw(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){jv(()=>{n.callbackScheduled=!1,gf(n),n.isCheckStableRunning=!0,Qf(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),gf(n)}function cw(n){let e=()=>{dw(n)},t=lw++;n._inner=n._inner.fork({name:"angular",properties:{[Kf]:!0,[Cd]:t,[Cd+t]:!0},onInvokeTask:(i,r,o,a,u,c)=>{if(mw(c))return i.invokeTask(o,a,u,c);try{return B1(n),i.invokeTask(o,a,u,c)}finally{(n.shouldCoalesceEventChangeDetection&&a.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),U1(n)}},onInvoke:(i,r,o,a,u,c,m)=>{try{return B1(n),i.invoke(o,a,u,c,m)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!pw(c)&&e(),U1(n)}},onHasTask:(i,r,o,a)=>{i.hasTask(o,a),r===o&&(a.change=="microTask"?(n._hasPendingMicrotasks=a.microTask,gf(n),Qf(n)):a.change=="macroTask"&&(n.hasPendingMacrotasks=a.macroTask))},onHandleError:(i,r,o,a)=>(i.handleError(o,a),n.runOutsideAngular(()=>n.onError.emit(a)),!1)})}function gf(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function B1(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function U1(n){n._nesting--,Qf(n)}var Ps=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new lt;onMicrotaskEmpty=new lt;onStable=new lt;onError=new lt;run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}};function mw(n){return zv(n,"__ignore_ng_zone__")}function pw(n){return zv(n,"__scheduler_tick__")}function zv(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var Zf=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=Z({token:n,providedIn:"root",factory:()=>new n})}return n})(),Yv=[0,1,2,3],Jv=(()=>{class n{ngZone=P(_t);scheduler=P(Rn);errorHandler=P(An,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){P(Kr,{optional:!0})}execute(){let t=this.sequences.size>0;t&&ze(16),this.executing=!0;for(let i of Yv)for(let r of this.sequences)if(!(r.erroredOrDestroyed||!r.hooks[i]))try{r.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let o=r.hooks[i];return o(r.pipelinedValue)},r.snapshot))}catch(o){r.erroredOrDestroyed=!0,this.errorHandler?.handleError(o)}this.executing=!1;for(let i of this.sequences)i.afterRun(),i.once&&(this.sequences.delete(i),i.destroy());for(let i of this.deferredRegistrations)this.sequences.add(i);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),t&&ze(17)}register(t){let{view:i}=t;i!==void 0?((i[Lr]??=[]).push(t),cr(i),i[ge]|=8192):this.executing?this.deferredRegistrations.add(t):this.addSequence(t)}addSequence(t){this.sequences.add(t),this.scheduler.notify(7)}unregister(t){this.executing&&this.sequences.has(t)?(t.erroredOrDestroyed=!0,t.pipelinedValue=void 0,t.once=!0):(this.sequences.delete(t),this.deferredRegistrations.delete(t))}maybeTrace(t,i){return i?i.run(Ld.AFTER_NEXT_RENDER,t):t()}static \u0275prov=Z({token:n,providedIn:"root",factory:()=>new n})}return n})(),xd=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(e,t,i,r,o,a=null){this.impl=e,this.hooks=t,this.view=i,this.once=r,this.snapshot=a,this.unregisterOnDestroy=o?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let e=this.view?.[Lr];e&&(this.view[Lr]=e.filter(t=>t!==this))}};function $i(n,e){let t=e?.injector??P(Yt);return Ui("NgAfterNextRender"),gw(n,t,e,!0)}function fw(n){return n instanceof Function?[void 0,void 0,n,void 0]:[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function gw(n,e,t,i){let r=e.get(Zf);r.impl??=e.get(Jv);let o=e.get(Kr,null,{optional:!0}),a=t?.manualCleanup!==!0?e.get(Ln):null,u=e.get(jo,null,{optional:!0}),c=new xd(r.impl,fw(n),u?.view,i,a,o?.snapshot(null));return r.impl.register(c),c}var Kv=new ne("",{providedIn:"root",factory:()=>({queue:new Set,isScheduled:!1,scheduler:null})});function Qv(n,e,t){let i=n.get(Kv);if(Array.isArray(e))for(let r of e)i.queue.add(r),t?.detachedLeaveAnimationFns?.push(r);else i.queue.add(e),t?.detachedLeaveAnimationFns?.push(e);i.scheduler&&i.scheduler(n)}function hw(n,e){let t=n.get(Kv);if(e.detachedLeaveAnimationFns){for(let i of e.detachedLeaveAnimationFns)t.queue.delete(i);e.detachedLeaveAnimationFns=void 0}}function yw(n,e){for(let[t,i]of e)Qv(n,i.animateFns)}function $1(n,e,t,i){let r=n?.[Br]?.enter;e!==null&&r&&r.has(t.index)&&yw(i,r)}function Yo(n,e,t,i,r,o,a,u){if(r!=null){let c,m=!1;Jn(r)?c=r:yi(r)&&(m=!0,r=r[Yn]);let h=kn(r);n===0&&i!==null?($1(u,i,o,t),a==null?kv(e,i,h):vd(e,i,h,a||null,!0)):n===1&&i!==null?($1(u,i,o,t),vd(e,i,h,a||null,!0)):n===2?H1(u,o,t,y=>{Vv(e,h,m,y)}):n===3&&H1(u,o,t,()=>{e.destroyNode(h)}),c!=null&&Aw(e,n,t,c,o,i,a)}}function _w(n,e){Zv(n,e),e[Yn]=null,e[Pn]=null}function vw(n,e,t,i,r,o){i[Yn]=r,i[Pn]=e,Ud(n,i,t,1,r,o)}function Zv(n,e){e[gi].changeDetectionScheduler?.notify(9),Ud(n,e,e[Je],2,null,null)}function Cw(n){let e=n[$o];if(!e)return Q0(n[se],n);for(;e;){let t=null;if(yi(e))t=e[$o];else{let i=e[ft];i&&(t=i)}if(!t){for(;e&&!e[Fn]&&e!==n;)yi(e)&&Q0(e[se],e),e=e[At];e===null&&(e=n),yi(e)&&Q0(e[se],e),t=e&&e[Fn]}e=t}}function Xf(n,e){let t=n[Ur],i=t.indexOf(e);t.splice(i,1)}function Bd(n,e){if($r(e))return;let t=e[Je];t.destroyNode&&Ud(n,e,t,3,null,null),Cw(e)}function Q0(n,e){if($r(e))return;let t=fe(null);try{e[ge]&=-129,e[ge]|=256,e[En]&&wr(e[En]),Ew(n,e),bw(n,e),e[se].type===1&&e[Je].destroy();let i=e[lr];if(i!==null&&Jn(e[At])){i!==e[At]&&Xf(i,e);let r=e[hi];r!==null&&r.detachView(n)}df(e)}finally{fe(t)}}function H1(n,e,t,i){let r=n?.[Br];if(r==null||r.leave==null||!r.leave.has(e.index))return i(!1);n&&jr.add(n),Qv(t,()=>{if(r.leave&&r.leave.has(e.index)){let a=r.leave.get(e.index),u=[];if(a){for(let c=0;c<a.animateFns.length;c++){let m=a.animateFns[c],{promise:h}=m();u.push(h)}r.detachedLeaveAnimationFns=void 0}r.running=Promise.allSettled(u),xw(n,i)}else n&&jr.delete(n),i(!1)},r)}function xw(n,e){let t=n[Br]?.running;if(t){t.then(()=>{n[Br].running=void 0,jr.delete(n),e(!0)});return}e(!1)}function bw(n,e){let t=n.cleanup,i=e[Uo];if(t!==null)for(let a=0;a<t.length-1;a+=2)if(typeof t[a]=="string"){let u=t[a+3];u>=0?i[u]():i[-u].unsubscribe(),a+=2}else{let u=i[t[a+1]];t[a].call(u)}i!==null&&(e[Uo]=null);let r=e[Fi];if(r!==null){e[Fi]=null;for(let a=0;a<r.length;a++){let u=r[a];u()}}let o=e[Oi];if(o!==null){e[Oi]=null;for(let a of o)a.destroy()}}function Ew(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let i=0;i<t.length;i+=2){let r=e[t[i]];if(!(r instanceof Wr)){let o=t[i+1];if(Array.isArray(o))for(let a=0;a<o.length;a+=2){let u=r[o[a]],c=o[a+1];ze(4,u,c);try{c.call(u)}finally{ze(5,u,c)}}else{ze(4,r,o);try{o.call(r)}finally{ze(5,r,o)}}}}}function Sw(n,e,t){return Dw(n,e.parent,t)}function Dw(n,e,t){let i=e;for(;i!==null&&i.type&168;)e=i,i=e.parent;if(i===null)return t[Yn];if(dr(i)){let{encapsulation:r}=n.data[i.directiveStart+i.componentOffset];if(r===Bi.None||r===Bi.Emulated)return null}return Kn(i,t)}function ww(n,e,t){return Iw(n,e,t)}function Tw(n,e,t){return n.type&40?Kn(n,t):null}var Iw=Tw,G1;function eg(n,e,t,i){let r=Sw(n,i,e),o=e[Je],a=i.parent||e[Pn],u=ww(a,i,e);if(r!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)k1(o,r,t[c],u,!1);else k1(o,r,t,u,!1);G1!==void 0&&G1(o,i,e,t,r)}function Rs(n,e){if(e!==null){let t=e.type;if(t&3)return Kn(e,n);if(t&4)return hf(-1,n[e.index]);if(t&8){let i=e.child;if(i!==null)return Rs(n,i);{let r=n[e.index];return Jn(r)?hf(-1,r):kn(r)}}else{if(t&128)return Rs(n,e.next);if(t&32)return Jf(e,n)()||kn(n[e.index]);{let i=Xv(n,e);if(i!==null){if(Array.isArray(i))return i[0];let r=ir(n[bn]);return Rs(r,i)}else return Rs(n,e.next)}}}return null}function Xv(n,e){if(e!==null){let i=n[bn][Pn],r=e.projection;return i.projection[r]}return null}function hf(n,e){let t=ft+n+1;if(t<e.length){let i=e[t],r=i[se].firstChild;if(r!==null)return Rs(i,r)}return e[ur]}function tg(n,e,t,i,r,o,a){for(;t!=null;){let u=i[Vi];if(t.type===128){t=t.next;continue}let c=i[t.index],m=t.type;if(a&&e===0&&(c&&Qo(kn(c),i),t.flags|=2),!$f(t))if(m&8)tg(n,e,t.child,i,r,o,!1),Yo(e,n,u,r,c,t,o,i);else if(m&32){let h=Jf(t,i),y;for(;y=h();)Yo(e,n,u,r,y,t,o,i);Yo(e,n,u,r,c,t,o,i)}else m&16?Mw(n,e,i,t,r,o):Yo(e,n,u,r,c,t,o,i);t=a?t.projectionNext:t.next}}function Ud(n,e,t,i,r,o){tg(t,i,n.firstChild,e,r,o,!1)}function Mw(n,e,t,i,r,o){let a=t[bn],c=a[Pn].projection[i.projection];if(Array.isArray(c))for(let m=0;m<c.length;m++){let h=c[m];Yo(e,n,t[Vi],r,h,i,o,t)}else{let m=c,h=a[At];Cv(i)&&(m.flags|=128),tg(n,e,m,h,r,o,!0)}}function Aw(n,e,t,i,r,o,a){let u=i[ur],c=kn(i);u!==c&&Yo(e,n,t,o,u,r,a);for(let m=ft;m<i.length;m++){let h=i[m];Ud(h[se],h,n,e,o,u)}}function Rw(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let o=i.indexOf("-")===-1?void 0:xi.DashCase;r==null?n.removeStyle(t,i,o):(typeof r=="string"&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=xi.Important),n.setStyle(t,i,r,o))}}function eC(n,e,t,i,r){let o=Qn(),a=i&2;try{pr(-1),a&&e.length>st&&qv(n,e,st,!1),ze(a?2:0,r,t),t(i,r)}finally{pr(o),ze(a?3:1,r,t)}}function $d(n,e,t){Ow(n,e,t),(t.flags&64)===64&&Lw(n,e,t)}function Ws(n,e,t=Kn){let i=e.localNames;if(i!==null){let r=e.index+1;for(let o=0;o<i.length;o+=2){let a=i[o+1],u=a===-1?t(e,n):n[a];n[r++]=u}}}function Nw(n,e,t,i){let o=i.get(Mv,Iv)||t===Bi.ShadowDom,a=n.selectRootElement(e,o);return Fw(a),a}function Fw(n){Pw(n)}var Pw=()=>null;function kw(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function tC(n,e,t,i,r,o){let a=e[se];if(og(n,a,e,t,i)){dr(n)&&Vw(e,n.index);return}n.type&3&&(t=kw(t)),nC(n,e,t,i,r,o)}function nC(n,e,t,i,r,o){if(n.type&3){let a=Kn(n,e);i=o!=null?o(i,n.value||"",t):i,r.setProperty(a,t,i)}else n.type&12}function Vw(n,e){let t=Vn(e,n);t[ge]&16||(t[ge]|=64)}function Ow(n,e,t){let i=t.directiveStart,r=t.directiveEnd;dr(t)&&aw(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||hd(t,e);let o=t.initialInputs;for(let a=i;a<r;a++){let u=n.data[a],c=Fs(e,n,a,t);if(Qo(c,e),o!==null&&Hw(e,a-i,c,u,t,o),_i(u)){let m=Vn(t.index,e);m[yt]=Fs(e,n,a,t)}}}function Lw(n,e,t){let i=t.directiveStart,r=t.directiveEnd,o=t.index,a=v1();try{pr(o);for(let u=i;u<r;u++){let c=n.data[u],m=e[u];Zu(u),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&Bw(c,m)}}finally{pr(-1),Zu(a)}}function Bw(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function ng(n,e){let t=n.directiveRegistry,i=null;if(t)for(let r=0;r<t.length;r++){let o=t[r];ZD(e,o.selectors,!1)&&(i??=[],_i(o)?i.unshift(o):i.push(o))}return i}function Uw(n,e,t,i,r,o){let a=Kn(n,e);$w(e[Je],a,o,n.value,t,i,r)}function $w(n,e,t,i,r,o,a){if(o==null)n.removeAttribute(e,r,t);else{let u=a==null?fi(o):a(o,i||"",r);n.setAttribute(e,r,u,t)}}function Hw(n,e,t,i,r,o){let a=o[e];if(a!==null)for(let u=0;u<a.length;u+=2){let c=a[u],m=a[u+1];pf(i,t,c,m)}}function ig(n,e,t,i,r){let o=st+t,a=e[se],u=r(a,e,n,i,t);e[o]=u,qo(n,!0);let c=n.type===2;return c?(Ov(e[Je],u,n),(d1()===0||Ho(n))&&Qo(u,e),c1()):Qo(u,e),nd()&&(!c||!$f(n))&&eg(a,e,u,n),n}function rg(n){let e=n;return L0()?f1():(e=e.parent,qo(e,!1)),e}function Gw(n,e){let t=n[Vi];if(!t)return;let i;try{i=t.get(fn,null)}catch{i=null}i?.(e)}function og(n,e,t,i,r){let o=n.inputs?.[i],a=n.hostDirectiveInputs?.[i],u=!1;if(a)for(let c=0;c<a.length;c+=2){let m=a[c],h=a[c+1],y=e.data[m];pf(y,t[m],h,r),u=!0}if(o)for(let c of o){let m=t[c],h=e.data[c];pf(h,m,i,r),u=!0}return u}function qw(n,e){let t=Vn(e,n),i=t[se];Ww(i,t);let r=t[Yn];r!==null&&t[Bo]===null&&(t[Bo]=Av(r,t[Vi])),ze(18),ag(i,t,t[yt]),ze(19,t[yt])}function Ww(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function ag(n,e,t){ed(e);try{let i=n.viewQuery;i!==null&&mf(1,i,t);let r=n.template;r!==null&&eC(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[hi]?.finishViewCreation(n),n.staticContentQueries&&Rv(n,e),n.staticViewQueries&&mf(2,n.viewQuery,t);let o=n.components;o!==null&&jw(e,o)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[ge]&=-5,td()}}function jw(n,e){for(let t=0;t<e.length;t++)qw(n,e[t])}function Hd(n,e,t,i){let r=fe(null);try{let o=e.tView,u=n[ge]&4096?4096:16,c=zf(n,o,t,u,null,e,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null),m=n[e.index];c[lr]=m;let h=n[hi];return h!==null&&(c[hi]=h.createEmbeddedView(o)),ag(o,c,t),c}finally{fe(r)}}function ks(n,e){return!e||e.firstChild===null||Cv(n)}function Vs(n,e,t,i,r=!1){for(;t!==null;){if(t.type===128){t=r?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&i.push(kn(o)),Jn(o)&&iC(o,i);let a=t.type;if(a&8)Vs(n,e,t.child,i);else if(a&32){let u=Jf(t,e),c;for(;c=u();)i.push(c)}else if(a&16){let u=Xv(e,t);if(Array.isArray(u))i.push(...u);else{let c=ir(e[bn]);Vs(c[se],c,u,i,!0)}}t=r?t.projectionNext:t.next}return i}function iC(n,e){for(let t=ft;t<n.length;t++){let i=n[t],r=i[se].firstChild;r!==null&&Vs(i[se],i,r,e)}n[ur]!==n[Yn]&&e.push(n[ur])}function rC(n){if(n[Lr]!==null){for(let e of n[Lr])e.impl.addSequence(e);n[Lr].length=0}}var oC=[];function zw(n){return n[En]??Yw(n)}function Yw(n){let e=oC.pop()??Object.create(Kw);return e.lView=n,e}function Jw(n){n.lView[En]!==n&&(n.lView=null,oC.push(n))}var Kw=G(V({},Sr),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{cr(n.lView)},consumerOnSignalRead(){this.lView[En]=this}});function Qw(n){let e=n[En]??Object.create(Zw);return e.lView=n,e}var Zw=G(V({},Sr),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=ir(n.lView);for(;e&&!aC(e[se]);)e=ir(e);e&&A0(e)},consumerOnSignalRead(){this.lView[En]=this}});function aC(n){return n.type!==2}function sC(n){if(n[Oi]===null)return;let e=!0;for(;e;){let t=!1;for(let i of n[Oi])i.dirty&&(t=!0,i.zone===null||Zone.current===i.zone?i.run():i.zone.run(()=>i.run()));e=t&&!!(n[ge]&8192)}}var Xw=100;function lC(n,e=0){let i=n[gi].rendererFactory,r=!1;r||i.begin?.();try{eT(n,e)}finally{r||i.end?.()}}function eT(n,e){let t=B0();try{Wo(!0),yf(n,e);let i=0;for(;Ds(n);){if(i===Xw)throw new z(103,!1);i++,yf(n,1)}}finally{Wo(t)}}function tT(n,e,t,i){if($r(e))return;let r=e[ge],o=!1,a=!1;ed(e);let u=!0,c=null,m=null;o||(aC(n)?(m=zw(e),c=Dr(m)):au()===null?(u=!1,m=Qw(e),c=Dr(m)):e[En]&&(wr(e[En]),e[En]=null));try{M0(e),h1(n.bindingStartIndex),t!==null&&eC(n,e,t,2,i);let h=(r&3)===3;if(!o)if(h){let C=n.preOrderCheckHooks;C!==null&&sd(e,C,null)}else{let C=n.preOrderHooks;C!==null&&ld(e,C,0,null),J0(e,0)}if(a||nT(e),sC(e),uC(e,0),n.contentQueries!==null&&Rv(n,e),!o)if(h){let C=n.contentCheckHooks;C!==null&&sd(e,C)}else{let C=n.contentHooks;C!==null&&ld(e,C,1),J0(e,1)}rT(n,e);let y=n.components;y!==null&&cC(e,y,0);let v=n.viewQuery;if(v!==null&&mf(2,v,i),!o)if(h){let C=n.viewCheckHooks;C!==null&&sd(e,C)}else{let C=n.viewHooks;C!==null&&ld(e,C,2),J0(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[ju]){for(let C of e[ju])C();e[ju]=null}o||(rC(e),e[ge]&=-73)}catch(h){throw o||cr(e),h}finally{m!==null&&(So(m,c),u&&Jw(m)),td()}}function uC(n,e){for(let t=bv(n);t!==null;t=Ev(t))for(let i=ft;i<t.length;i++){let r=t[i];dC(r,e)}}function nT(n){for(let e=bv(n);e!==null;e=Ev(e)){if(!(e[ge]&2))continue;let t=e[Ur];for(let i=0;i<t.length;i++){let r=t[i];A0(r)}}}function iT(n,e,t){ze(18);let i=Vn(e,n);dC(i,t),ze(19,i[yt])}function dC(n,e){Yu(n)&&yf(n,e)}function yf(n,e){let i=n[se],r=n[ge],o=n[En],a=!!(e===0&&r&16);if(a||=!!(r&64&&e===0),a||=!!(r&1024),a||=!!(o?.dirty&&Do(o)),a||=!1,o&&(o.dirty=!1),n[ge]&=-9217,a)tT(i,n,i.template,n[yt]);else if(r&8192){let u=fe(null);try{sC(n),uC(n,1);let c=i.components;c!==null&&cC(n,c,1),rC(n)}finally{fe(u)}}}function cC(n,e,t){for(let i=0;i<e.length;i++)iT(n,e[i],t)}function rT(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let i=0;i<t.length;i++){let r=t[i];if(r<0)pr(~r);else{let o=r,a=t[++i],u=t[++i];_1(a,o);let c=e[o];ze(24,c),u(2,c),ze(25,c)}}}finally{pr(-1)}}function sg(n,e){let t=B0()?64:1088;for(n[gi].changeDetectionScheduler?.notify(e);n;){n[ge]|=t;let i=ir(n);if(Go(n)&&!i)return n;n=i}return null}function mC(n,e,t,i){return[n,!0,0,e,null,i,null,t,null,null]}function pC(n,e){let t=ft+e;if(t<n.length)return n[t]}function Gd(n,e,t,i=!0){let r=e[se];if(oT(r,e,n,t),i){let a=hf(t,n),u=e[Je],c=u.parentNode(n[ur]);c!==null&&vw(r,n[Pn],u,e,c,a)}let o=e[Bo];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function fC(n,e){let t=Os(n,e);return t!==void 0&&Bd(t[se],t),t}function Os(n,e){if(n.length<=ft)return;let t=ft+e,i=n[t];if(i){let r=i[lr];r!==null&&r!==n&&Xf(r,i),e>0&&(n[t-1][Fn]=i[Fn]);let o=vs(n,ft+e);_w(i[se],i);let a=o[hi];a!==null&&a.detachView(o[se]),i[At]=null,i[Fn]=null,i[ge]&=-129}return i}function oT(n,e,t,i){let r=ft+i,o=t.length;i>0&&(t[r-1][Fn]=e),i<o-ft?(e[Fn]=t[r],f0(t,ft+i,e)):(t.push(e),e[Fn]=null),e[At]=t;let a=e[lr];a!==null&&t!==a&&gC(a,e);let u=e[hi];u!==null&&u.insertView(n),Ju(e),e[ge]|=128}function gC(n,e){let t=n[Ur],i=e[At];if(yi(i))n[ge]|=2;else{let r=i[At][bn];e[bn]!==r&&(n[ge]|=2)}t===null?n[Ur]=[e]:t.push(e)}var fr=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,t=e[se];return Vs(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t}get context(){return this._lView[yt]}set context(e){this._lView[yt]=e}get destroyed(){return $r(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[At];if(Jn(e)){let t=e[Es],i=t?t.indexOf(this):-1;i>-1&&(Os(e,i),vs(t,i))}this._attachedToViewContainer=!1}Bd(this._lView[se],this._lView)}onDestroy(e){R0(this._lView,e)}markForCheck(){sg(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[ge]&=-129}reattach(){Ju(this._lView),this._lView[ge]|=128}detectChanges(){this._lView[ge]|=1024,lC(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new z(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=Go(this._lView),t=this._lView[lr];t!==null&&!e&&Xf(t,this._lView),Zv(this._lView[se],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new z(902,!1);this._appRef=e;let t=Go(this._lView),i=this._lView[lr];i!==null&&!t&&gC(i,this._lView),Ju(this._lView)}};var gr=(()=>{class n{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=aT;constructor(t,i,r){this._declarationLView=t,this._declarationTContainer=i,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,i){return this.createEmbeddedViewImpl(t,i)}createEmbeddedViewImpl(t,i,r){let o=Hd(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:i,dehydratedView:r});return new fr(o)}}return n})();function aT(){return lg(Dt(),ce())}function lg(n,e){return n.type&4?new gr(e,n,ea(n,e)):null}function js(n,e,t,i,r){let o=n.data[e];if(o===null)o=sT(n,e,t,i,r),y1()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=i,o.attrs=r;let a=p1();o.injectorIndex=a===null?-1:a.injectorIndex}return qo(o,!0),o}function sT(n,e,t,i,r){let o=O0(),a=L0(),u=a?o:o&&o.parent,c=n.data[e]=uT(n,u,t,e,i,r);return lT(n,c,o,a),c}function lT(n,e,t,i){n.firstChild===null&&(n.firstChild=e),t!==null&&(i?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function uT(n,e,t,i,r,o){let a=e?e.injectorIndex:-1,u=0;return m1()&&(u|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:a,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:u,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var qK=new RegExp(`^(\\d+)*(${MD}|${ID})*(.*)`);function dT(n){let e=n[S0]??[],i=n[At][Je],r=[];for(let o of e)o.data[Tv]!==void 0?r.push(o):cT(o,i);n[S0]=r}function cT(n,e){let t=0,i=n.firstChild;if(i){let r=n.data[wv];for(;t<r;){let o=i.nextSibling;Vv(e,i,!1),i=o,t++}}}var mT=()=>null,pT=()=>null;function _f(n,e){return mT(n,e)}function hC(n,e,t){return pT(n,e,t)}var yC=class{},qd=class{},vf=class{resolveComponentFactory(e){throw new z(917,!1)}},zs=class{static NULL=new vf},zr=class{},ei=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>fT()}return n})();function fT(){let n=ce(),e=Dt(),t=Vn(e.index,n);return(yi(t)?t:n)[Je]}var _C=(()=>{class n{static \u0275prov=Z({token:n,providedIn:"root",factory:()=>null})}return n})();var dd={},Cf=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){let r=this.injector.get(e,dd,i);return r!==dd||t===dd?r:this.parentInjector.get(e,t,i)}};function bd(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,o=0;if(e!==null)for(let a=0;a<e.length;a++){let u=e[a];if(typeof u=="number")o=u;else if(o==1)r=Uu(r,u);else if(o==2){let c=u,m=e[++a];i=Uu(i,c+": "+m+";")}}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function X(n,e=0){let t=ce();if(t===null)return ae(n,e);let i=Dt();return yv(i,t,$t(n),e)}function vC(n,e,t,i,r){let o=i===null?null:{"":-1},a=r(n,t);if(a!==null){let u=a,c=null,m=null;for(let h of a)if(h.resolveHostDirectives!==null){[u,c,m]=h.resolveHostDirectives(a);break}yT(n,e,t,u,o,c,m)}o!==null&&i!==null&&gT(t,i,o)}function gT(n,e,t){let i=n.localNames=[];for(let r=0;r<e.length;r+=2){let o=t[e[r+1]];if(o==null)throw new z(-301,!1);i.push(e[r],o)}}function hT(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function yT(n,e,t,i,r,o,a){let u=i.length,c=!1;for(let v=0;v<u;v++){let C=i[v];!c&&_i(C)&&(c=!0,hT(n,t,v)),lf(hd(t,e),n,C.type)}ET(t,n.data.length,u);for(let v=0;v<u;v++){let C=i[v];C.providersResolver&&C.providersResolver(C)}let m=!1,h=!1,y=Gv(n,e,u,null);u>0&&(t.directiveToIndex=new Map);for(let v=0;v<u;v++){let C=i[v];if(t.mergedAttrs=Ko(t.mergedAttrs,C.hostAttrs),vT(n,t,e,y,C),bT(y,C,r),a!==null&&a.has(C)){let[R,N]=a.get(C);t.directiveToIndex.set(C.type,[y,R+t.directiveStart,N+t.directiveStart])}else(o===null||!o.has(C))&&t.directiveToIndex.set(C.type,y);C.contentQueries!==null&&(t.flags|=4),(C.hostBindings!==null||C.hostAttrs!==null||C.hostVars!==0)&&(t.flags|=64);let T=C.type.prototype;!m&&(T.ngOnChanges||T.ngOnInit||T.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),m=!0),!h&&(T.ngOnChanges||T.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),h=!0),y++}_T(n,t,o)}function _T(n,e,t){for(let i=e.directiveStart;i<e.directiveEnd;i++){let r=n.data[i];if(t===null||!t.has(r))q1(0,e,r,i),q1(1,e,r,i),j1(e,i,!1);else{let o=t.get(r);W1(0,e,o,i),W1(1,e,o,i),j1(e,i,!0)}}}function q1(n,e,t,i){let r=n===0?t.inputs:t.outputs;for(let o in r)if(r.hasOwnProperty(o)){let a;n===0?a=e.inputs??={}:a=e.outputs??={},a[o]??=[],a[o].push(i),CC(e,o)}}function W1(n,e,t,i){let r=n===0?t.inputs:t.outputs;for(let o in r)if(r.hasOwnProperty(o)){let a=r[o],u;n===0?u=e.hostDirectiveInputs??={}:u=e.hostDirectiveOutputs??={},u[a]??=[],u[a].push(i,o),CC(e,a)}}function CC(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function j1(n,e,t){let{attrs:i,inputs:r,hostDirectiveInputs:o}=n;if(i===null||!t&&r===null||t&&o===null||Wf(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let a=null,u=0;for(;u<i.length;){let c=i[u];if(c===0){u+=4;continue}else if(c===5){u+=2;continue}else if(typeof c=="number")break;if(!t&&r.hasOwnProperty(c)){let m=r[c];for(let h of m)if(h===e){a??=[],a.push(c,i[u+1]);break}}else if(t&&o.hasOwnProperty(c)){let m=o[c];for(let h=0;h<m.length;h+=2)if(m[h]===e){a??=[],a.push(m[h+1],i[u+1]);break}}u+=2}n.initialInputs??=[],n.initialInputs.push(a)}function vT(n,e,t,i,r){n.data[i]=r;let o=r.factory||(r.factory=nr(r.type,!0)),a=new Wr(o,_i(r),X,null);n.blueprint[i]=a,t[i]=a,CT(n,e,i,Gv(n,t,r.hostVars,Ht),r)}function CT(n,e,t,i,r){let o=r.hostBindings;if(o){let a=n.hostBindingOpCodes;a===null&&(a=n.hostBindingOpCodes=[]);let u=~e.index;xT(a)!=u&&a.push(u),a.push(t,i,o)}}function xT(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function bT(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;_i(e)&&(t[""]=n)}}function ET(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function ug(n,e,t,i,r,o,a,u){let c=e[se],m=c.consts,h=On(m,a),y=js(c,n,t,i,h);return o&&vC(c,e,y,On(m,u),r),y.mergedAttrs=Ko(y.mergedAttrs,y.attrs),y.attrs!==null&&bd(y,y.attrs,!1),y.mergedAttrs!==null&&bd(y,y.mergedAttrs,!0),c.queries!==null&&c.queries.elementStart(c,y),y}function dg(n,e){lv(n,e),D0(e)&&n.queries.elementEnd(e)}function ST(n,e,t,i,r,o){let a=e.consts,u=On(a,r),c=js(e,n,t,i,u);if(c.mergedAttrs=Ko(c.mergedAttrs,c.attrs),o!=null){let m=On(a,o);c.localNames=[];for(let h=0;h<m.length;h+=2)c.localNames.push(m[h],-1)}return c.attrs!==null&&bd(c,c.attrs,!1),c.mergedAttrs!==null&&bd(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function cg(n){return bC(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function xC(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),i;for(;!(i=t.next()).done;)e(i.value)}}function bC(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function mg(n,e,t){return n[e]=t}function DT(n,e){return n[e]}function Bn(n,e,t){if(t===Ht)return!1;let i=n[e];return Object.is(i,t)?!1:(n[e]=t,!0)}function Ls(n,e,t,i){let r=Bn(n,e,t);return Bn(n,e+1,i)||r}function wT(n,e,t,i,r){let o=Ls(n,e,t,i);return Bn(n,e+2,r)||o}function TT(n,e,t,i,r,o){let a=Ls(n,e,t,i);return Ls(n,e+2,r,o)||a}function cd(n,e,t){return function i(r){let o=dr(n)?Vn(n.index,e):e;sg(o,5);let a=e[yt],u=z1(e,a,t,r),c=i.__ngNextListenerFn__;for(;c;)u=z1(e,a,c,r)&&u,c=c.__ngNextListenerFn__;return u}}function z1(n,e,t,i){let r=fe(null);try{return ze(6,e,t),t(i)!==!1}catch(o){return Gw(n,o),!1}finally{ze(7,e,t),fe(r)}}function EC(n,e,t,i,r,o,a,u){let c=Ho(n),m=!1,h=null;if(!i&&c&&(h=MT(e,t,o,n.index)),h!==null){let y=h.__ngLastListenerFn__||h;y.__ngNextListenerFn__=a,h.__ngLastListenerFn__=a,m=!0}else{let y=Kn(n,t),v=i?i(y):y;RD(t,v,o,u);let C=r.listen(v,o,u);if(!IT(o)){let T=i?R=>i(kn(R[n.index])):n.index;SC(T,e,t,o,u,C,!1)}}return m}function IT(n){return n.startsWith("animation")||n.startsWith("transition")}function MT(n,e,t,i){let r=n.cleanup;if(r!=null)for(let o=0;o<r.length-1;o+=2){let a=r[o];if(a===t&&r[o+1]===i){let u=e[Uo],c=r[o+2];return u&&u.length>c?u[c]:null}typeof a=="string"&&(o+=2)}return null}function SC(n,e,t,i,r,o,a){let u=e.firstCreatePass?F0(e):null,c=N0(t),m=c.length;c.push(r,o),u&&u.push(i,n,m,(m+1)*(a?-1:1))}function Y1(n,e,t,i,r,o){let a=e[t],u=e[se],m=u.data[t].outputs[i],y=a[m].subscribe(o);SC(n.index,u,e,r,o,y,!0)}var xf=Symbol("BINDING");var Ed=class extends zs{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=sr(e);return new Zo(t,this.ngModule)}};function AT(n){return Object.keys(n).map(e=>{let[t,i,r]=n[e],o={propName:t,templateName:e,isSignal:(i&Od.SignalBased)!==0};return r&&(o.transform=r),o})}function RT(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function NT(n,e,t){let i=e instanceof St?e:e?.injector;return i&&n.getStandaloneInjector!==null&&(i=n.getStandaloneInjector(i)||i),i?new Cf(t,i):t}function FT(n){let e=n.get(zr,null);if(e===null)throw new z(407,!1);let t=n.get(_C,null),i=n.get(Rn,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:i,ngReflect:!1}}function PT(n,e){let t=DC(n);return Pv(e,t,t==="svg"?w0:t==="math"?r1:null)}function DC(n){return(n.selectors[0][0]||"div").toLowerCase()}var Zo=class extends qd{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=AT(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=RT(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=nw(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,i,r,o,a){ze(22);let u=fe(null);try{let c=this.componentDef,m=kT(i,c,a,o),h=NT(c,r||this.ngModule,e),y=FT(h),v=y.rendererFactory.createRenderer(null,c),C=i?Nw(v,i,c.encapsulation,h):PT(c,v),T=a?.some(J1)||o?.some(F=>typeof F!="function"&&F.bindings.some(J1)),R=zf(null,m,null,512|Hv(c),null,null,y,v,h,null,Av(C,h,!0));R[st]=C,ed(R);let N=null;try{let F=ug(st,R,2,"#host",()=>m.directiveRegistry,!0,0);Ov(v,C,F),Qo(C,R),$d(m,R,F),Hf(m,F,R),dg(m,F),t!==void 0&&OT(F,this.ngContentSelectors,t),N=Vn(F.index,R),R[yt]=N[yt],ag(m,R,null)}catch(F){throw N!==null&&df(N),df(R),F}finally{ze(23),td()}return new Sd(this.componentType,R,!!T)}finally{fe(u)}}};function kT(n,e,t,i){let r=n?["ng-version","20.3.16"]:iw(e.selectors[0]),o=null,a=null,u=0;if(t)for(let h of t)u+=h[xf].requiredVars,h.create&&(h.targetIdx=0,(o??=[]).push(h)),h.update&&(h.targetIdx=0,(a??=[]).push(h));if(i)for(let h=0;h<i.length;h++){let y=i[h];if(typeof y!="function")for(let v of y.bindings){u+=v[xf].requiredVars;let C=h+1;v.create&&(v.targetIdx=C,(o??=[]).push(v)),v.update&&(v.targetIdx=C,(a??=[]).push(v))}}let c=[e];if(i)for(let h of i){let y=typeof h=="function"?h:h.type,v=_0(y);c.push(v)}return jf(0,null,VT(o,a),1,u,c,null,null,null,[r],null)}function VT(n,e){return!n&&!e?null:t=>{if(t&1&&n)for(let i of n)i.create();if(t&2&&e)for(let i of e)i.update()}}function J1(n){let e=n[xf].kind;return e==="input"||e==="twoWay"}var Sd=class extends yC{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t,i){super(),this._rootLView=t,this._hasInputBindings=i,this._tNode=Ss(t[se],st),this.location=ea(this._tNode,t),this.instance=Vn(this._tNode.index,t)[yt],this.hostView=this.changeDetectorRef=new fr(t,void 0),this.componentType=e}setInput(e,t){this._hasInputBindings;let i=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let r=this._rootLView,o=og(i,r[se],r,e,t);this.previousInputValues.set(e,t);let a=Vn(i.index,r);sg(a,1)}get injector(){return new qr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function OT(n,e,t){let i=n.projection=[];for(let r=0;r<e.length;r++){let o=t[r];i.push(o!=null&&o.length?Array.from(o):null)}}var Hi=(()=>{class n{static __NG_ELEMENT_ID__=LT}return n})();function LT(){let n=Dt();return TC(n,ce())}var BT=Hi,wC=class extends BT{_lContainer;_hostTNode;_hostLView;constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return ea(this._hostTNode,this._hostLView)}get injector(){return new qr(this._hostTNode,this._hostLView)}get parentInjector(){let e=Lf(this._hostTNode,this._hostLView);if(cv(e)){let t=fd(e,this._hostLView),i=pd(e),r=t[se].data[i+8];return new qr(r,t)}else return new qr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=K1(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-ft}createEmbeddedView(e,t,i){let r,o;typeof i=="number"?r=i:i!=null&&(r=i.index,o=i.injector);let a=_f(this._lContainer,e.ssrId),u=e.createEmbeddedViewImpl(t||{},o,a);return this.insertImpl(u,r,ks(this._hostTNode,a)),u}createComponent(e,t,i,r,o,a,u){let c=e&&!nD(e),m;if(c)m=t;else{let N=t||{};m=N.index,i=N.injector,r=N.projectableNodes,o=N.environmentInjector||N.ngModuleRef,a=N.directives,u=N.bindings}let h=c?e:new Zo(sr(e)),y=i||this.parentInjector;if(!o&&h.ngModule==null){let F=(c?y:this.parentInjector).get(St,null);F&&(o=F)}let v=sr(h.componentType??{}),C=_f(this._lContainer,v?.id??null),T=C?.firstChild??null,R=h.create(y,r,T,o,a,u);return this.insertImpl(R.hostView,m,ks(this._hostTNode,C)),R}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){let r=e._lView;if(a1(r)){let u=this.indexOf(e);if(u!==-1)this.detach(u);else{let c=r[At],m=new wC(c,c[Pn],c[At]);m.detach(m.indexOf(e))}}let o=this._adjustIndex(t),a=this._lContainer;return Gd(a,r,o,i),e.attachToViewContainerRef(),f0(Z0(a),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=K1(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),i=Os(this._lContainer,t);i&&(vs(Z0(this._lContainer),t),Bd(i[se],i))}detach(e){let t=this._adjustIndex(e,-1),i=Os(this._lContainer,t);return i&&vs(Z0(this._lContainer),t)!=null?new fr(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function K1(n){return n[Es]}function Z0(n){return n[Es]||(n[Es]=[])}function TC(n,e){let t,i=e[n.index];return Jn(i)?t=i:(t=mC(i,e,null,n),e[n.index]=t,Yf(e,t)),$T(t,e,n,i),new wC(t,n,e)}function UT(n,e){let t=n[Je],i=t.createComment(""),r=Kn(e,n),o=t.parentNode(r);return vd(t,o,i,t.nextSibling(r),!1),i}var $T=qT,HT=()=>!1;function GT(n,e,t){return HT(n,e,t)}function qT(n,e,t,i){if(n[ur])return;let r;t.type&8?r=kn(i):r=UT(e,t),n[ur]=r}var bf=class n{queryList;matches=null;constructor(e){this.queryList=e}clone(){return new n(this.queryList)}setDirty(){this.queryList.setDirty()}},Ef=class n{queries;constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let i=e.contentQueries!==null?e.contentQueries[0]:t.length,r=[];for(let o=0;o<i;o++){let a=t.getByIndex(o),u=this.queries[a.indexInDeclarationView];r.push(u.clone())}return new n(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)pg(e,t).matches!==null&&this.queries[t].setDirty()}},Dd=class{flags;read;predicate;constructor(e,t,i=null){this.flags=t,this.read=i,typeof e=="string"?this.predicate=ZT(e):this.predicate=e}},Sf=class n{queries;constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){let r=t!==null?t.length:0,o=this.getByIndex(i).embeddedTView(e,r);o&&(o.indexInDeclarationView=i,t!==null?t.push(o):t=[o])}return t!==null?new n(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},Df=class n{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(e,t=-1){this.metadata=e,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new n(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,i=e.parent;for(;i!==null&&i.type&8&&i.index!==t;)i=i.parent;return t===(i!==null?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){let o=i[r];this.matchTNodeWithReadOption(e,t,WT(t,o)),this.matchTNodeWithReadOption(e,t,ud(t,e,o,!1,!1))}else i===gr?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,ud(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(i!==null){let r=this.metadata.read;if(r!==null)if(r===nn||r===Hi||r===gr&&t.type&4)this.addMatch(t.index,-2);else{let o=ud(t,e,r,!1,!1);o!==null&&this.addMatch(t.index,o)}else this.addMatch(t.index,i)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function WT(n,e){let t=n.localNames;if(t!==null){for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1]}return null}function jT(n,e){return n.type&11?ea(n,e):n.type&4?lg(n,e):null}function zT(n,e,t,i){return t===-1?jT(e,n):t===-2?YT(n,e,i):Fs(n,n[se],t,e)}function YT(n,e,t){if(t===nn)return ea(e,n);if(t===gr)return lg(e,n);if(t===Hi)return TC(e,n)}function IC(n,e,t,i){let r=e[hi].queries[i];if(r.matches===null){let o=n.data,a=t.matches,u=[];for(let c=0;a!==null&&c<a.length;c+=2){let m=a[c];if(m<0)u.push(null);else{let h=o[m];u.push(zT(e,h,a[c+1],t.metadata.read))}}r.matches=u}return r.matches}function wf(n,e,t,i){let r=n.queries.getByIndex(t),o=r.matches;if(o!==null){let a=IC(n,e,r,t);for(let u=0;u<o.length;u+=2){let c=o[u];if(c>0)i.push(a[u/2]);else{let m=o[u+1],h=e[-c];for(let y=ft;y<h.length;y++){let v=h[y];v[lr]===v[At]&&wf(v[se],v,m,i)}if(h[Ur]!==null){let y=h[Ur];for(let v=0;v<y.length;v++){let C=y[v];wf(C[se],C,m,i)}}}}}return i}function JT(n,e){return n[hi].queries[e].queryList}function MC(n,e,t){let i=new yd((t&4)===4);return u1(n,e,i,i.destroy),(e[hi]??=new Ef).queries.push(new bf(i))-1}function KT(n,e,t){let i=it();return i.firstCreatePass&&(AC(i,new Dd(n,e,t),-1),(e&2)===2&&(i.staticViewQueries=!0)),MC(i,ce(),e)}function QT(n,e,t,i){let r=it();if(r.firstCreatePass){let o=Dt();AC(r,new Dd(e,t,i),o.index),XT(r,n),(t&2)===2&&(r.staticContentQueries=!0)}return MC(r,ce(),t)}function ZT(n){return n.split(",").map(e=>e.trim())}function AC(n,e,t){n.queries===null&&(n.queries=new Sf),n.queries.track(new Df(e,t))}function XT(n,e){let t=n.contentQueries||(n.contentQueries=[]),i=t.length?t[t.length-1]:-1;e!==i&&t.push(n.queries.length-1,e)}function pg(n,e){return n.queries.getByIndex(e)}function eI(n,e){let t=n[se],i=pg(t,e);return i.crossesNgTemplate?wf(t,n,e,[]):IC(t,n,i,e)}var Yr=class{},Wd=class{};var wd=class extends Yr{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new Ed(this);constructor(e,t,i,r=!0){super(),this.ngModuleType=e,this._parent=t;let o=y0(e);this._bootstrapComponents=Uv(o.bootstrap),this._r3Injector=q0(e,t,[{provide:Yr,useValue:this},{provide:zs,useValue:this.componentFactoryResolver},...i],Pi(e),new Set(["environment"])),r&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Td=class extends Wd{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new wd(this.moduleType,e,[])}};var Bs=class extends Yr{injector;componentFactoryResolver=new Ed(this);instance=null;constructor(e){super();let t=new Fr([...e.providers,{provide:Yr,useValue:this},{provide:zs,useValue:this.componentFactoryResolver}],e.parent||xs(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Ys(n,e,t=null){return new Bs({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var tI=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let i=v0(!1,t.type),r=i.length>0?Ys([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=Z({token:n,providedIn:"environment",factory:()=>new n(ae(St))})}return n})();function re(n){return $s(()=>{let e=RC(n),t=G(V({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===Bf.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?r=>r.get(tI).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Bi.Emulated,styles:n.styles||tn,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&Ui("NgStandalone"),NC(t);let i=n.dependencies;return t.directiveDefs=Q1(i,nI),t.pipeDefs=Q1(i,Q_),t.id=oI(t),t})}function nI(n){return sr(n)||_0(n)}function ti(n){return $s(()=>({type:n.type,bootstrap:n.bootstrap||tn,declarations:n.declarations||tn,imports:n.imports||tn,exports:n.exports||tn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function iI(n,e){if(n==null)return or;let t={};for(let i in n)if(n.hasOwnProperty(i)){let r=n[i],o,a,u,c;Array.isArray(r)?(u=r[0],o=r[1],a=r[2]??o,c=r[3]||null):(o=r,a=r,u=Od.None,c=null),t[o]=[i,u,c],e[o]=a}return t}function rI(n){if(n==null)return or;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function Ae(n){return $s(()=>{let e=RC(n);return NC(e),e})}function Js(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function RC(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||or,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||tn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:iI(n.inputs,e),outputs:rI(n.outputs),debugInfo:null}}function NC(n){n.features?.forEach(e=>e(n))}function Q1(n,e){return n?()=>{let t=typeof n=="function"?n():n,i=[];for(let r of t){let o=e(r);o!==null&&i.push(o)}return i}:null}function oI(n){let e=0,t=typeof n.consts=="function"?"":n.consts,i=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of i.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function aI(n){return Object.getPrototypeOf(n.prototype).constructor}function ut(n){let e=aI(n.type),t=!0,i=[n];for(;e;){let r;if(_i(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new z(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);let a=n;a.inputs=X0(n.inputs),a.declaredInputs=X0(n.declaredInputs),a.outputs=X0(n.outputs);let u=r.hostBindings;u&&cI(n,u);let c=r.viewQuery,m=r.contentQueries;if(c&&uI(n,c),m&&dI(n,m),sI(n,r),G_(n.outputs,r.outputs),_i(r)&&r.data.animation){let h=n.data;h.animation=(h.animation||[]).concat(r.data.animation)}}let o=r.features;if(o)for(let a=0;a<o.length;a++){let u=o[a];u&&u.ngInherit&&u(n),u===ut&&(t=!1)}}e=Object.getPrototypeOf(e)}lI(i)}function sI(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let i=e.inputs[t];i!==void 0&&(n.inputs[t]=i,n.declaredInputs[t]=e.declaredInputs[t])}}function lI(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){let r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Ko(r.hostAttrs,t=Ko(t,r.hostAttrs))}}function X0(n){return n===or?{}:n===tn?[]:n}function uI(n,e){let t=n.viewQuery;t?n.viewQuery=(i,r)=>{e(i,r),t(i,r)}:n.viewQuery=e}function dI(n,e){let t=n.contentQueries;t?n.contentQueries=(i,r,o)=>{e(i,r,o),t(i,r,o)}:n.contentQueries=e}function cI(n,e){let t=n.hostBindings;t?n.hostBindings=(i,r)=>{e(i,r),t(i,r)}:n.hostBindings=e}function FC(n,e,t,i,r,o,a,u){if(t.firstCreatePass){n.mergedAttrs=Ko(n.mergedAttrs,n.attrs);let h=n.tView=jf(2,n,r,o,a,t.directiveRegistry,t.pipeRegistry,null,t.schemas,t.consts,null);t.queries!==null&&(t.queries.template(t,n),h.queries=t.queries.embeddedTView(n))}u&&(n.flags|=u),qo(n,!1);let c=pI(t,e,n,i);nd()&&eg(t,e,c,n),Qo(c,e);let m=mC(c,e,c,n);e[i+st]=m,Yf(e,m),GT(m,n,e)}function mI(n,e,t,i,r,o,a,u,c,m,h){let y=t+st,v;return e.firstCreatePass?(v=js(e,y,4,a||null,u||null),Ku()&&vC(e,n,v,On(e.consts,m),ng),lv(e,v)):v=e.data[y],FC(v,n,e,t,i,r,o,c),Ho(v)&&$d(e,n,v),m!=null&&Ws(n,v,h),v}function Id(n,e,t,i,r,o,a,u,c,m,h){let y=t+st,v;if(e.firstCreatePass){if(v=js(e,y,4,a||null,u||null),m!=null){let C=On(e.consts,m);v.localNames=[];for(let T=0;T<C.length;T+=2)v.localNames.push(C[T],-1)}}else v=e.data[y];return FC(v,n,e,t,i,r,o,c),m!=null&&Ws(n,v,h),v}function vt(n,e,t,i,r,o,a,u){let c=ce(),m=it(),h=On(m.consts,o);return mI(c,m,n,e,t,i,r,h,void 0,a,u),vt}var pI=fI;function fI(n,e,t,i){return Is(!0),e[Je].createComment("")}var fg=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var gg=new ne("");function hr(n){return!!n&&typeof n.then=="function"}function hg(n){return!!n&&typeof n.subscribe=="function"}var PC=new ne("");var yg=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i});appInits=P(PC,{optional:!0})??[];injector=P(Yt);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let r of this.appInits){let o=Rt(this.injector,r);if(hr(o))t.push(o);else if(hg(o)){let a=new Promise((u,c)=>{o.subscribe({complete:u,error:c})});t.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),t.length===0&&i(),this.initialized=!0}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),jd=new ne("");function kC(){Np(()=>{let n="";throw new z(600,n)})}function VC(n){return n.isBoundToModule}var gI=10;var Gi=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=P(fn);afterRenderManager=P(Zf);zonelessEnabled=P(Ms);rootEffectScheduler=P(As);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new gt;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=P(vi);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(he(t=>!t))}constructor(){P(Kr,{optional:!0})}whenStable(){let t;return new Promise(i=>{t=this.isStable.subscribe({next:r=>{r&&i()}})}).finally(()=>{t.unsubscribe()})}_injector=P(St);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,i){return this.bootstrapImpl(t,i)}bootstrapImpl(t,i,r=Yt.NULL){return this._injector.get(_t).run(()=>{ze(10);let a=t instanceof qd;if(!this._injector.get(yg).done){let T="";throw new z(405,T)}let c;a?c=t:c=this._injector.get(zs).resolveComponentFactory(t),this.componentTypes.push(c.componentType);let m=VC(c)?void 0:this._injector.get(Yr),h=i||c.selector,y=c.create(r,[],h,m),v=y.location.nativeElement,C=y.injector.get(gg,null);return C?.registerApplication(v),y.onDestroy(()=>{this.detachView(y.hostView),Ns(this.components,y),C?.unregisterApplication(v)}),this._loadComponent(y),ze(11,y),y})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){ze(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(Ld.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new z(101,!1);let t=fe(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,fe(t),this.afterTick.next(),ze(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(zr,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<gI;)ze(14),this.synchronizeOnce(),ze(15)}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let i=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r}of this.allViews){if(!i&&!Ds(r))continue;let o=i&&!this.zonelessEnabled?0:1;lC(r,o),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>Ds(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){let i=t;Ns(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(r){this.internalErrorHandler(r)}this.components.push(t),this._injector.get(jd,[]).forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Ns(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new z(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Ns(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function dt(n,e,t,i){let r=ce(),o=mr();if(Bn(r,o,e)){let a=it(),u=Ts();Uw(u,r,n,e,t,i)}return dt}var QK=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";var Tf=class{destroy(e){}updateValue(e,t){}swap(e,t){let i=Math.min(e,t),r=Math.max(e,t),o=this.detach(r);if(r-i>1){let a=this.detach(i);this.attach(i,o),this.attach(r,a)}else this.attach(i,o)}move(e,t){this.attach(t,this.detach(e))}};function ef(n,e,t,i,r){return n===t&&Object.is(e,i)?1:Object.is(r(n,e),r(t,i))?-1:0}function hI(n,e,t){let i,r,o=0,a=n.length-1,u=void 0;if(Array.isArray(e)){let c=e.length-1;for(;o<=a&&o<=c;){let m=n.at(o),h=e[o],y=ef(o,m,o,h,t);if(y!==0){y<0&&n.updateValue(o,h),o++;continue}let v=n.at(a),C=e[c],T=ef(a,v,c,C,t);if(T!==0){T<0&&n.updateValue(a,C),a--,c--;continue}let R=t(o,m),N=t(a,v),F=t(o,h);if(Object.is(F,N)){let $=t(c,C);Object.is($,R)?(n.swap(o,a),n.updateValue(a,C),c--,a--):n.move(a,o),n.updateValue(o,h),o++;continue}if(i??=new Md,r??=X1(n,o,a,t),If(n,i,o,F))n.updateValue(o,h),o++,a++;else if(r.has(F))i.set(R,n.detach(o)),a--;else{let $=n.create(o,e[o]);n.attach(o,$),o++,a++}}for(;o<=c;)Z1(n,i,t,o,e[o]),o++}else if(e!=null){let c=e[Symbol.iterator](),m=c.next();for(;!m.done&&o<=a;){let h=n.at(o),y=m.value,v=ef(o,h,o,y,t);if(v!==0)v<0&&n.updateValue(o,y),o++,m=c.next();else{i??=new Md,r??=X1(n,o,a,t);let C=t(o,y);if(If(n,i,o,C))n.updateValue(o,y),o++,a++,m=c.next();else if(!r.has(C))n.attach(o,n.create(o,y)),o++,a++,m=c.next();else{let T=t(o,h);i.set(T,n.detach(o)),a--}}}for(;!m.done;)Z1(n,i,t,n.length,m.value),m=c.next()}for(;o<=a;)n.destroy(n.detach(a--));i?.forEach(c=>{n.destroy(c)})}function If(n,e,t,i){return e!==void 0&&e.has(i)?(n.attach(t,e.get(i)),e.delete(i),!0):!1}function Z1(n,e,t,i,r){if(If(n,e,i,t(i,r)))n.updateValue(i,r);else{let o=n.create(i,r);n.attach(i,o)}}function X1(n,e,t,i){let r=new Set;for(let o=e;o<=t;o++)r.add(i(o,n.at(o)));return r}var Md=class{kvMap=new Map;_vMap=void 0;has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let t=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let i=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let r=this._vMap;for(;r.has(i);)i=r.get(i);r.set(i,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,i]of this.kvMap)if(e(i,t),this._vMap!==void 0){let r=this._vMap;for(;r.has(i);)i=r.get(i),e(i,t)}}};function M(n,e,t,i,r,o,a,u){Ui("NgControlFlow");let c=ce(),m=it(),h=On(m.consts,o);return Id(c,m,n,e,t,i,r,h,256,a,u),_g}function _g(n,e,t,i,r,o,a,u){Ui("NgControlFlow");let c=ce(),m=it(),h=On(m.consts,o);return Id(c,m,n,e,t,i,r,h,512,a,u),_g}function A(n,e){Ui("NgControlFlow");let t=ce(),i=mr(),r=t[i]!==Ht?t[i]:-1,o=r!==-1?Ad(t,st+r):void 0,a=0;if(Bn(t,i,n)){let u=fe(null);try{if(o!==void 0&&fC(o,a),n!==-1){let c=st+n,m=Ad(t,c),h=Nf(t[se],c),y=hC(m,h,t),v=Hd(t,h,e,{dehydratedView:y});Gd(m,v,a,ks(h,y))}}finally{fe(u)}}else if(o!==void 0){let u=pC(o,a);u!==void 0&&(u[yt]=e)}}var Mf=class{lContainer;$implicit;$index;constructor(e,t,i){this.lContainer=e,this.$implicit=t,this.$index=i}get $count(){return this.lContainer.length-ft}};function Sn(n){return n}function j(n,e){return e}var Af=class{hasEmptyBlock;trackByFn;liveCollection;constructor(e,t,i){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=i}};function O(n,e,t,i,r,o,a,u,c,m,h,y,v){Ui("NgControlFlow");let C=ce(),T=it(),R=c!==void 0,N=ce(),F=u?a.bind(N[bn][yt]):a,$=new Af(R,F);N[st+n]=$,Id(C,T,n+1,e,t,i,r,On(T.consts,o),256),R&&Id(C,T,n+2,c,m,h,y,On(T.consts,v),512)}var Rf=class extends Tf{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(e,t,i){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=i}get length(){return this.lContainer.length-ft}at(e){return this.getLView(e)[yt].$implicit}attach(e,t){let i=t[Bo];this.needsIndexUpdate||=e!==this.length,Gd(this.lContainer,t,e,ks(this.templateTNode,i)),yI(this.lContainer,e)}detach(e){return this.needsIndexUpdate||=e!==this.length-1,_I(this.lContainer,e),vI(this.lContainer,e)}create(e,t){let i=_f(this.lContainer,this.templateTNode.tView.ssrId),r=Hd(this.hostLView,this.templateTNode,new Mf(this.lContainer,t,e),{dehydratedView:i});return this.operationsCounter?.recordCreate(),r}destroy(e){Bd(e[se],e),this.operationsCounter?.recordDestroy()}updateValue(e,t){this.getLView(e)[yt].$implicit=t}reset(){this.needsIndexUpdate=!1,this.operationsCounter?.reset()}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[yt].$index=e}getLView(e){return CI(this.lContainer,e)}};function L(n){let e=fe(null),t=Qn();try{let i=ce(),r=i[se],o=i[t],a=t+1,u=Ad(i,a);if(o.liveCollection===void 0){let m=Nf(r,a);o.liveCollection=new Rf(u,i,m)}else o.liveCollection.reset();let c=o.liveCollection;if(hI(c,n,o.trackByFn),c.updateIndexes(),o.hasEmptyBlock){let m=mr(),h=c.length===0;if(Bn(i,m,h)){let y=t+2,v=Ad(i,y);if(h){let C=Nf(r,y),T=hC(v,C,i),R=Hd(i,C,void 0,{dehydratedView:T});Gd(v,R,0,ks(C,T))}else r.firstUpdatePass&&dT(v),fC(v,0)}}}finally{fe(e)}}function Ad(n,e){return n[e]}function yI(n,e){if(n.length<=ft)return;let t=ft+e,i=n[t],r=i?i[Br]:void 0;if(i&&r&&r.detachedLeaveAnimationFns&&r.detachedLeaveAnimationFns.length>0){let o=i[Vi];hw(o,r),jr.delete(i),r.detachedLeaveAnimationFns=void 0}}function _I(n,e){if(n.length<=ft)return;let t=ft+e,i=n[t],r=i?i[Br]:void 0;r&&r.leave&&r.leave.size>0&&(r.detachedLeaveAnimationFns=[])}function vI(n,e){return Os(n,e)}function CI(n,e){return pC(n,e)}function Nf(n,e){return Ss(n,e)}function I(n,e,t){let i=ce(),r=mr();if(Bn(i,r,e)){let o=it(),a=Ts();tC(a,i,n,e,i[Je],t)}return I}function Ff(n,e,t,i,r){og(e,n,t,r?"class":"style",i)}function l(n,e,t,i){let r=ce(),o=r[se],a=n+st,u=o.firstCreatePass?ug(a,r,2,e,ng,Ku(),t,i):o.data[a];if(ig(u,r,n,e,OC),Ho(u)){let c=r[se];$d(c,r,u),Hf(c,u,r)}return i!=null&&Ws(r,u),l}function s(){let n=it(),e=Dt(),t=rg(e);return n.firstCreatePass&&dg(n,t),k0(t)&&V0(),P0(),t.classesWithoutHost!=null&&lD(t)&&Ff(n,t,ce(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&uD(t)&&Ff(n,t,ce(),t.stylesWithoutHost,!1),s}function x(n,e,t,i){return l(n,e,t,i),s(),x}function tt(n,e,t,i){let r=ce(),o=r[se],a=n+st,u=o.firstCreatePass?ST(a,o,2,e,t,i):o.data[a];return ig(u,r,n,e,OC),i!=null&&Ws(r,u),tt}function nt(){let n=Dt(),e=rg(n);return k0(e)&&V0(),P0(),nt}function qi(n,e,t,i){return tt(n,e,t,i),nt(),qi}var OC=(n,e,t,i,r)=>(Is(!0),Pv(e[Je],i,D1()));function zd(n,e,t){let i=ce(),r=i[se],o=n+st,a=r.firstCreatePass?ug(o,i,8,"ng-container",ng,Ku(),e,t):r.data[o];if(ig(a,i,n,"ng-container",xI),Ho(a)){let u=i[se];$d(u,i,a),Hf(u,a,i)}return t!=null&&Ws(i,a),zd}function Yd(){let n=it(),e=Dt(),t=rg(e);return n.firstCreatePass&&dg(n,t),Yd}var xI=(n,e,t,i,r)=>(Is(!0),$D(e[Je],""));function B(){return ce()}function Jd(n,e,t){let i=ce(),r=mr();if(Bn(i,r,e)){let o=it(),a=Ts();nC(a,i,n,e,i[Je],t)}return Jd}var od=void 0;function bI(n){let e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return e===1&&t===0?1:5}var EI=["en",[["a","p"],["AM","PM"]],[["AM","PM"]],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],od,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],od,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",od,"{1} 'at' {0}",od],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",bI],tf={};function rn(n){let e=SI(n),t=ev(e);if(t)return t;let i=e.split("-")[0];if(t=ev(i),t)return t;if(i==="en")return EI;throw new z(701,!1)}function ev(n){return n in tf||(tf[n]=ki.ng&&ki.ng.common&&ki.ng.common.locales&&ki.ng.common.locales[n]),tf[n]}var ct=(function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n})(ct||{});function SI(n){return n.toLowerCase().replace(/_/g,"-")}var Ks="en-US",DI="USD";var wI=Ks;function LC(n){typeof n=="string"&&(wI=n.toLowerCase().replace(/_/g,"-"))}function b(n,e,t){let i=ce(),r=it(),o=Dt();return BC(r,i,i[Je],o,n,e,t),b}function ta(n,e,t){let i=ce(),r=it(),o=Dt();return(o.type&3||t)&&EC(o,r,i,t,i[Je],n,e,cd(o,i,e)),ta}function BC(n,e,t,i,r,o,a){let u=!0,c=null;if((i.type&3||a)&&(c??=cd(i,e,o),EC(i,n,e,a,t,r,o,c)&&(u=!1)),u){let m=i.outputs?.[r],h=i.hostDirectiveOutputs?.[r];if(h&&h.length)for(let y=0;y<h.length;y+=2){let v=h[y],C=h[y+1];c??=cd(i,e,o),Y1(i,e,v,C,r,c)}if(m&&m.length)for(let y of m)c??=cd(i,e,o),Y1(i,e,y,r,r,c)}}function _(n=1){return S1(n)}function vg(n,e,t,i){QT(n,e,t,i)}function Dn(n,e,t){KT(n,e,t)}function on(n){let e=ce(),t=it(),i=$0();Xu(i+1);let r=pg(t,i);if(n.dirty&&o1(e)===((r.metadata.flags&2)===2)){if(r.matches===null)n.reset([]);else{let o=eI(e,i);n.reset(o,bD),n.notifyOnChanges()}return!0}return!1}function an(){return JT(ce(),$0())}function wn(n){let e=g1();return zu(e,st+n)}function ad(n,e){return n<<17|e<<2}function Jr(n){return n>>17&32767}function TI(n){return(n&2)==2}function II(n,e){return n&131071|e<<17}function Pf(n){return n|2}function Xo(n){return(n&131068)>>2}function nf(n,e){return n&-131069|e<<2}function MI(n){return(n&1)===1}function kf(n){return n|1}function AI(n,e,t,i,r,o){let a=o?e.classBindings:e.styleBindings,u=Jr(a),c=Xo(a);n[i]=t;let m=!1,h;if(Array.isArray(t)){let y=t;h=y[1],(h===null||Lo(y,h)>0)&&(m=!0)}else h=t;if(r)if(c!==0){let v=Jr(n[u+1]);n[i+1]=ad(v,u),v!==0&&(n[v+1]=nf(n[v+1],i)),n[u+1]=II(n[u+1],i)}else n[i+1]=ad(u,0),u!==0&&(n[u+1]=nf(n[u+1],i)),u=i;else n[i+1]=ad(c,0),u===0?u=i:n[c+1]=nf(n[c+1],i),c=i;m&&(n[i+1]=Pf(n[i+1])),tv(n,h,i,!0),tv(n,h,i,!1),RI(e,h,n,i,o),a=ad(u,c),o?e.classBindings=a:e.styleBindings=a}function RI(n,e,t,i,r){let o=r?n.residualClasses:n.residualStyles;o!=null&&typeof e=="string"&&Lo(o,e)>=0&&(t[i+1]=kf(t[i+1]))}function tv(n,e,t,i){let r=n[t+1],o=e===null,a=i?Jr(r):Xo(r),u=!1;for(;a!==0&&(u===!1||o);){let c=n[a],m=n[a+1];NI(c,e)&&(u=!0,n[a+1]=i?kf(m):Pf(m)),a=i?Jr(m):Xo(m)}u&&(n[t+1]=i?Pf(r):kf(r))}function NI(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?Lo(n,e)>=0:!1}var Xn={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function FI(n){return n.substring(Xn.key,Xn.keyEnd)}function PI(n){return kI(n),UC(n,$C(n,0,Xn.textEnd))}function UC(n,e){let t=Xn.textEnd;return t===e?-1:(e=Xn.keyEnd=VI(n,Xn.key=e,t),$C(n,e,t))}function kI(n){Xn.key=0,Xn.keyEnd=0,Xn.value=0,Xn.valueEnd=0,Xn.textEnd=n.length}function $C(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function VI(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}function gn(n,e,t){return HC(n,e,t,!1),gn}function W(n,e){return HC(n,e,null,!0),W}function De(n){LI(qI,OI,n,!0)}function OI(n,e){for(let t=PI(e);t>=0;t=UC(e,t))qu(n,FI(e),!0)}function HC(n,e,t,i){let r=ce(),o=it(),a=ws(2);if(o.firstUpdatePass&&qC(o,n,a,i),e!==Ht&&Bn(r,a,e)){let u=o.data[Qn()];WC(o,u,r,r[Je],n,r[a+1]=jI(e,t),i,a)}}function LI(n,e,t,i){let r=it(),o=ws(2);r.firstUpdatePass&&qC(r,null,o,i);let a=ce();if(t!==Ht&&Bn(a,o,t)){let u=r.data[Qn()];if(jC(u,i)&&!GC(r,o)){let c=i?u.classesWithoutHost:u.stylesWithoutHost;c!==null&&(t=Uu(c,t||"")),Ff(r,u,a,t,i)}else WI(r,u,a,a[Je],a[o+1],a[o+1]=GI(n,e,t),i,o)}}function GC(n,e){return e>=n.expandoStartIndex}function qC(n,e,t,i){let r=n.data;if(r[t+1]===null){let o=r[Qn()],a=GC(n,t);jC(o,i)&&e===null&&!a&&(e=!1),e=BI(r,o,e,i),AI(r,o,e,t,a,i)}}function BI(n,e,t,i){let r=C1(n),o=i?e.residualClasses:e.residualStyles;if(r===null)(i?e.classBindings:e.styleBindings)===0&&(t=rf(null,n,e,t,i),t=Us(t,e.attrs,i),o=null);else{let a=e.directiveStylingLast;if(a===-1||n[a]!==r)if(t=rf(r,n,e,t,i),o===null){let c=UI(n,e,i);c!==void 0&&Array.isArray(c)&&(c=rf(null,n,e,c[1],i),c=Us(c,e.attrs,i),$I(n,e,i,c))}else o=HI(n,e,i)}return o!==void 0&&(i?e.residualClasses=o:e.residualStyles=o),t}function UI(n,e,t){let i=t?e.classBindings:e.styleBindings;if(Xo(i)!==0)return n[Jr(i)]}function $I(n,e,t,i){let r=t?e.classBindings:e.styleBindings;n[Jr(r)]=i}function HI(n,e,t){let i,r=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<r;o++){let a=n[o].hostAttrs;i=Us(i,a,t)}return Us(i,e.attrs,t)}function rf(n,e,t,i,r){let o=null,a=t.directiveEnd,u=t.directiveStylingLast;for(u===-1?u=t.directiveStart:u++;u<a&&(o=e[u],i=Us(i,o.hostAttrs,r),o!==n);)u++;return n!==null&&(t.directiveStylingLast=u),i}function Us(n,e,t){let i=t?1:2,r=-1;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];typeof a=="number"?r=a:r===i&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),qu(n,a,t?!0:e[++o]))}return n===void 0?null:n}function GI(n,e,t){if(t==null||t==="")return tn;let i=[],r=qs(t);if(Array.isArray(r))for(let o=0;o<r.length;o++)n(i,r[o],!0);else if(typeof r=="object")for(let o in r)r.hasOwnProperty(o)&&n(i,o,r[o]);else typeof r=="string"&&e(i,r);return i}function qI(n,e,t){let i=String(e);i!==""&&!i.includes(" ")&&qu(n,i,t)}function WI(n,e,t,i,r,o,a,u){r===Ht&&(r=tn);let c=0,m=0,h=0<r.length?r[0]:null,y=0<o.length?o[0]:null;for(;h!==null||y!==null;){let v=c<r.length?r[c+1]:void 0,C=m<o.length?o[m+1]:void 0,T=null,R;h===y?(c+=2,m+=2,v!==C&&(T=y,R=C)):y===null||h!==null&&h<y?(c+=2,T=h):(m+=2,T=y,R=C),T!==null&&WC(n,e,t,i,T,R,a,u),h=c<r.length?r[c]:null,y=m<o.length?o[m]:null}}function WC(n,e,t,i,r,o,a,u){if(!(e.type&3))return;let c=n.data,m=c[u+1],h=MI(m)?nv(c,e,t,r,Xo(m),a):void 0;if(!Rd(h)){Rd(o)||TI(m)&&(o=nv(c,null,t,r,u,a));let y=T0(Qn(),t);Rw(i,a,y,r,o)}}function nv(n,e,t,i,r,o){let a=e===null,u;for(;r>0;){let c=n[r],m=Array.isArray(c),h=m?c[1]:c,y=h===null,v=t[r+1];v===Ht&&(v=y?tn:void 0);let C=y?Wu(v,i):h===i?v:void 0;if(m&&!Rd(C)&&(C=Wu(c,i)),Rd(C)&&(u=C,a))return u;let T=n[r+1];r=a?Jr(T):Xo(T)}if(e!==null){let c=o?e.residualClasses:e.residualStyles;c!=null&&(u=Wu(c,i))}return u}function Rd(n){return n!==void 0}function jI(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=Pi(qs(n)))),n}function jC(n,e){return(n.flags&(e?8:16))!==0}function d(n,e=""){let t=ce(),i=it(),r=n+st,o=i.firstCreatePass?js(i,r,1,e,null):i.data[r],a=zI(i,t,o,e,n);t[r]=a,nd()&&eg(i,t,a,o),qo(o,!1)}var zI=(n,e,t,i,r)=>(Is(!0),BD(e[Je],i));function zC(n,e,t,i=""){return Bn(n,mr(),t)?e+fi(t)+i:Ht}function YI(n,e,t,i,r,o=""){let a=U0(),u=Ls(n,a,t,r);return ws(2),u?e+fi(t)+i+fi(r)+o:Ht}function JI(n,e,t,i,r,o,a,u=""){let c=U0(),m=wT(n,c,t,r,a);return ws(3),m?e+fi(t)+i+fi(r)+o+fi(a)+u:Ht}function E(n){return k("",n),E}function k(n,e,t){let i=ce(),r=zC(i,n,e,t);return r!==Ht&&Cg(i,Qn(),r),k}function Ke(n,e,t,i,r){let o=ce(),a=YI(o,n,e,t,i,r);return a!==Ht&&Cg(o,Qn(),a),Ke}function Kt(n,e,t,i,r,o,a){let u=ce(),c=JI(u,n,e,t,i,r,o,a);return c!==Ht&&Cg(u,Qn(),c),Kt}function Cg(n,e,t){let i=T0(e,n);UD(n[Je],i,t)}function Y(n,e,t){z0(e)&&(e=e());let i=ce(),r=mr();if(Bn(i,r,e)){let o=it(),a=Ts();tC(a,i,n,e,i[Je],t)}return Y}function K(n,e){let t=z0(n);return t&&n.set(e),t}function J(n,e){let t=ce(),i=it(),r=Dt();return BC(i,t,t[Je],r,n,e),J}function hn(n,e,t=""){return zC(ce(),n,e,t)}function KI(n,e,t){let i=it();if(i.firstCreatePass){let r=_i(n);Vf(t,i.data,i.blueprint,r,!0),Vf(e,i.data,i.blueprint,r,!1)}}function Vf(n,e,t,i,r){if(n=$t(n),Array.isArray(n))for(let o=0;o<n.length;o++)Vf(n[o],e,t,i,r);else{let o=it(),a=ce(),u=Dt(),c=Nr(n)?n:$t(n.provide),m=x0(n),h=u.providerIndexes&1048575,y=u.directiveStart,v=u.providerIndexes>>20;if(Nr(n)||!n.multi){let C=new Wr(m,r,X,null),T=af(c,e,r?h:h+v,y);T===-1?(lf(hd(u,a),o,c),of(o,n,e.length),e.push(c),u.directiveStart++,u.directiveEnd++,r&&(u.providerIndexes+=1048576),t.push(C),a.push(C)):(t[T]=C,a[T]=C)}else{let C=af(c,e,h+v,y),T=af(c,e,h,h+v),R=C>=0&&t[C],N=T>=0&&t[T];if(r&&!N||!r&&!R){lf(hd(u,a),o,c);let F=XI(r?ZI:QI,t.length,r,i,m,n);!r&&N&&(t[T].providerFactory=F),of(o,n,e.length,0),e.push(c),u.directiveStart++,u.directiveEnd++,r&&(u.providerIndexes+=1048576),t.push(F),a.push(F)}else{let F=YC(t[r?T:C],m,!r&&i);of(o,n,C>-1?C:T,F)}!r&&i&&N&&t[T].componentProviders++}}}function of(n,e,t,i){let r=Nr(e),o=t1(e);if(r||o){let c=(o?$t(e.useClass):e).prototype.ngOnDestroy;if(c){let m=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){let h=m.indexOf(t);h===-1?m.push(t,[i,c]):m[h+1].push(i,c)}else m.push(t,c)}}}function YC(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function af(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function QI(n,e,t,i,r){return Of(this.multi,[])}function ZI(n,e,t,i,r){let o=this.multi,a;if(this.providerFactory){let u=this.providerFactory.componentProviders,c=Fs(i,i[se],this.providerFactory.index,r);a=c.slice(0,u),Of(o,a);for(let m=u;m<c.length;m++)a.push(c[m])}else a=[],Of(o,a);return a}function Of(n,e){for(let t=0;t<n.length;t++){let i=n[t];e.push(i())}return e}function XI(n,e,t,i,r,o){let a=new Wr(n,t,X,null);return a.multi=[],a.index=e,a.componentProviders=0,YC(a,r,i&&!t),a}function Vt(n,e=[]){return t=>{t.providersResolver=(i,r)=>KI(i,r?r(n):n,e)}}function wt(n,e,t){let i=Qu()+n,r=ce();return r[i]===Ht?mg(r,i,t?e.call(t):e()):DT(r,i)}function JC(n,e){let t=n[e];return t===Ht?void 0:t}function eM(n,e,t,i,r,o,a){let u=e+t;return Ls(n,u,r,o)?mg(n,u+2,a?i.call(a,r,o):i(r,o)):JC(n,u+2)}function tM(n,e,t,i,r,o,a,u,c){let m=e+t;return TT(n,m,r,o,a,u)?mg(n,m+4,c?i.call(c,r,o,a,u):i(r,o,a,u)):JC(n,m+4)}function Gt(n,e){let t=it(),i,r=n+st;t.firstCreatePass?(i=nM(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??=[]).push(r,i.onDestroy)):i=t.data[r];let o=i.factory||(i.factory=nr(i.type,!0)),a,u=en(X);try{let c=gd(!1),m=o();return gd(c),I0(t,ce(),r,m),m}finally{en(u)}}function nM(n,e){if(e)for(let t=e.length-1;t>=0;t--){let i=e[t];if(n===i.name)return i}}function sn(n,e,t,i){let r=n+st,o=ce(),a=zu(o,r);return KC(o,r)?eM(o,Qu(),e,a.transform,t,i,a):a.transform(t,i)}function Kd(n,e,t,i,r,o){let a=n+st,u=ce(),c=zu(u,a);return KC(u,a)?tM(u,Qu(),e,c.transform,t,i,r,o,c):c.transform(t,i,r,o)}function KC(n,e){return n[se].data[e].pure}var Nd=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},xg=(()=>{class n{compileModuleSync(t){return new Td(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let i=this.compileModuleSync(t),r=y0(t),o=Uv(r.declarations).reduce((a,u)=>{let c=sr(u);return c&&a.push(new Zo(c)),a},[]);return new Nd(i,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var iM=(()=>{class n{zone=P(_t);changeDetectionScheduler=P(Rn);applicationRef=P(Gi);applicationErrorHandler=P(fn);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{try{this.applicationRef.dirtyFlags|=1,this.applicationRef._tick()}catch(t){this.applicationErrorHandler(t)}})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function QC({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new _t(G(V({},ZC()),{scheduleInRootZone:t})),[{provide:_t,useFactory:n},{provide:ar,multi:!0,useFactory:()=>{let i=P(iM,{optional:!0});return()=>i.initialize()}},{provide:ar,multi:!0,useFactory:()=>{let i=P(rM);return()=>{i.initialize()}}},e===!0?{provide:Y0,useValue:!0}:[],{provide:id,useValue:t??Wv},{provide:fn,useFactory:()=>{let i=P(_t),r=P(St),o;return a=>{i.runOutsideAngular(()=>{r.destroyed&&!o?setTimeout(()=>{throw a}):(o??=r.get(An),o.handleError(a))})}}}]}function ZC(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var rM=(()=>{class n{subscription=new xt;initialized=!1;zone=P(_t);pendingTasks=P(vi);initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{_t.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{_t.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var bg=(()=>{class n{applicationErrorHandler=P(fn);appRef=P(Gi);taskService=P(vi);ngZone=P(_t);zonelessEnabled=P(Ms);tracing=P(Kr,{optional:!0});disableScheduling=P(Y0,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new xt;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Cd):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(P(id,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Ps||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;let i=!1;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2,i=!0;break}case 12:{this.appRef.dirtyFlags|=16,i=!0;break}case 13:{this.appRef.dirtyFlags|=2,i=!0;break}case 11:{i=!0;break}case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(i))return;let r=this.useMicrotaskScheduler?L1:jv;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(t){return!(this.disableScheduling&&!t||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Cd+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(i){this.taskService.remove(t),this.applicationErrorHandler(i)}finally{this.cleanup()}this.useMicrotaskScheduler=!0,L1(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Eg(){return Ui("NgZoneless"),kr([{provide:Rn,useExisting:bg},{provide:_t,useClass:Ps},{provide:Ms,useValue:!0},{provide:id,useValue:!1},[]])}function oM(){return typeof $localize<"u"&&$localize.locale||Ks}var Qr=new ne("",{providedIn:"root",factory:()=>P(Qr,{optional:!0,skipSelf:!0})||oM()}),Sg=new ne("",{providedIn:"root",factory:()=>DI});function Pt(n){return L_(n)}function H(n,e){return du(n,e?.equal)}var Dg=class{[jt];constructor(e){this[jt]=e}destroy(){this[jt].destroy()}};function $n(n,e){let t=e?.injector??P(Yt),i=e?.manualCleanup!==!0?t.get(Ln):null,r,o=t.get(jo,null,{optional:!0}),a=t.get(Rn);return o!==null?(r=lM(o.view,a,n),i instanceof ys&&i._lView===o.view&&(i=null)):r=uM(n,t.get(As),a),r.injector=t,i!==null&&(r.onDestroyFn=i.onDestroy(()=>r.destroy())),new Dg(r)}var XC=G(V({},B_),{cleanupFns:void 0,zone:null,onDestroyFn:Gr,run(){let n=Wo(!1);try{U_(this)}finally{Wo(n)}},cleanup(){if(!this.cleanupFns?.length)return;let n=fe(null);try{for(;this.cleanupFns.length;)this.cleanupFns.pop()()}finally{this.cleanupFns=[],fe(n)}}}),aM=G(V({},XC),{consumerMarkedDirty(){this.scheduler.schedule(this),this.notifier.notify(12)},destroy(){wr(this),this.onDestroyFn(),this.cleanup(),this.scheduler.remove(this)}}),sM=G(V({},XC),{consumerMarkedDirty(){this.view[ge]|=8192,cr(this.view),this.notifier.notify(13)},destroy(){wr(this),this.onDestroyFn(),this.cleanup(),this.view[Oi]?.delete(this)}});function lM(n,e,t){let i=Object.create(sM);return i.view=n,i.zone=typeof Zone<"u"?Zone.current:null,i.notifier=e,i.fn=ex(i,t),n[Oi]??=new Set,n[Oi].add(i),i.consumerMarkedDirty(i),i}function uM(n,e,t){let i=Object.create(aM);return i.fn=ex(i,n),i.scheduler=e,i.notifier=t,i.zone=typeof Zone<"u"?Zone.current:null,i.scheduler.add(i),i.notifier.notify(12),i}function ex(n,e){return()=>{e(t=>(n.cleanupFns??=[]).push(t))}}var rx=Symbol("InputSignalNode#UNSET"),EM=G(V({},cu),{transformFn:void 0,applyValueToInputSignal(n,e){To(n,e)}});function ox(n,e){let t=Object.create(EM);t.value=n,t.transformFn=e?.transform;function i(){if(Eo(t),t.value===rx){let r=null;throw new z(-950,r)}return t.value}return i[jt]=t,i}var Zd=class{attributeName;constructor(e){this.attributeName=e}__NG_ELEMENT_ID__=()=>Hs(this.attributeName);toString(){return`HostAttributeToken ${this.attributeName}`}},SM=new ne("");SM.__NG_ELEMENT_ID__=n=>{let e=Dt();if(e===null)throw new z(204,!1);if(e.type&2)return e.value;if(n&8)return null;throw new z(204,!1)};function tx(n,e){return ox(n,e)}function DM(n){return ox(rx,n)}var ec=(tx.required=DM,tx);var wg=new ne(""),wM=new ne("");function Qs(n){return!n.moduleRef}function TM(n){let e=Qs(n)?n.r3Injector:n.moduleRef.injector,t=e.get(_t);return t.run(()=>{Qs(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let i=e.get(fn),r;if(t.runOutsideAngular(()=>{r=t.onError.subscribe({next:i})}),Qs(n)){let o=()=>e.destroy(),a=n.platformInjector.get(wg);a.add(o),e.onDestroy(()=>{r.unsubscribe(),a.delete(o)})}else{let o=()=>n.moduleRef.destroy(),a=n.platformInjector.get(wg);a.add(o),n.moduleRef.onDestroy(()=>{Ns(n.allPlatformModules,n.moduleRef),r.unsubscribe(),a.delete(o)})}return MM(i,t,()=>{let o=e.get(vi),a=o.add(),u=e.get(yg);return u.runInitializers(),u.donePromise.then(()=>{let c=e.get(Qr,Ks);if(LC(c||Ks),!e.get(wM,!0))return Qs(n)?e.get(Gi):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(Qs(n)){let h=e.get(Gi);return n.rootComponent!==void 0&&h.bootstrap(n.rootComponent),h}else return IM?.(n.moduleRef,n.allPlatformModules),n.moduleRef}).finally(()=>void o.remove(a))})})}var IM;function MM(n,e,t){try{let i=t();return hr(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n(i)),i}}var Qd=null;function AM(n=[],e){return Yt.create({name:e,providers:[{provide:Cs,useValue:"platform"},{provide:wg,useValue:new Set([()=>Qd=null])},...n]})}function RM(n=[]){if(Qd)return Qd;let e=AM(n);return Qd=e,kC(),NM(e),e}function NM(n){let e=n.get(Pd,null);Rt(n,()=>{e?.forEach(t=>t())})}var yr=(()=>{class n{static __NG_ELEMENT_ID__=FM}return n})();function FM(n){return PM(Dt(),ce(),(n&16)===16)}function PM(n,e,t){if(dr(n)&&!t){let i=Vn(n.index,e);return new fr(i,i)}else if(n.type&175){let i=e[bn];return new fr(i,e)}return null}var Tg=class{constructor(){}supports(e){return cg(e)}create(e){return new Ig(e)}},kM=(n,e)=>e,Ig=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||kM}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,o=null;for(;t||i;){let a=!i||t&&t.currentIndex<nx(i,r,o)?t:i,u=nx(a,r,o),c=a.currentIndex;if(a===i)r--,i=i._nextRemoved;else if(t=t._next,a.previousIndex==null)r++;else{o||(o=[]);let m=u-r,h=c-r;if(m!=h){for(let v=0;v<m;v++){let C=v<o.length?o[v]:o[v]=0,T=C+v;h<=T&&T<m&&(o[v]=C+1)}let y=a.previousIndex;o[y]=h-m}}u!==c&&e(a,u,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!cg(e))throw new z(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,i=!1,r,o,a;if(Array.isArray(e)){this.length=e.length;for(let u=0;u<this.length;u++)o=e[u],a=this._trackByFn(u,o),t===null||!Object.is(t.trackById,a)?(t=this._mismatch(t,o,a,u),i=!0):(i&&(t=this._verifyReinsertion(t,o,a,u)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else r=0,xC(e,u=>{a=this._trackByFn(r,u),t===null||!Object.is(t.trackById,a)?(t=this._mismatch(t,u,a,r),i=!0):(i&&(t=this._verifyReinsertion(t,u,a,r)),Object.is(t.item,u)||this._addIdentityChange(t,u)),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,r)):(e=this._linkedRecords===null?null:this._linkedRecords.get(i,r),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,r)):e=this._addAfter(new Mg(t,i),o,r)),e}_verifyReinsertion(e,t,i,r){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null);return o!==null?e=this._reinsertAfter(o,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let r=e._prevRemoved,o=e._nextRemoved;return r===null?this._removalsHead=o:r._nextRemoved=o,o===null?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){let r=t===null?this._itHead:t._next;return e._next=r,e._prev=t,r===null?this._itTail=e:r._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new Xd),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,i=e._next;return t===null?this._itHead=i:t._next=i,i===null?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Xd),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},Mg=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},Ag=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;i!==null;i=i._nextDup)if((t===null||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){let t=e._prevDup,i=e._nextDup;return t===null?this._head=i:t._nextDup=i,i===null?this._tail=t:i._prevDup=t,this._head===null}},Xd=class{map=new Map;put(e){let t=e.trackById,i=this.map.get(t);i||(i=new Ag,this.map.set(t,i)),i.add(e)}get(e,t){let i=e,r=this.map.get(i);return r?r.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function nx(n,e,t){let i=n.previousIndex;if(i===null)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}function ix(){return new Rg([new Tg])}var Rg=(()=>{class n{factories;static \u0275prov=Z({token:n,providedIn:"root",factory:ix});constructor(t){this.factories=t}static create(t,i){if(i!=null){let r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:()=>{let i=P(n,{optional:!0,skipSelf:!0});return n.create(t,i||ix())}}}find(t){let i=this.factories.find(r=>r.supports(t));if(i!=null)return i;throw new z(901,!1)}}return n})();function ax(n){let{rootComponent:e,appProviders:t,platformProviders:i,platformRef:r}=n;ze(8);try{let o=r?.injector??RM(i),a=[QC({}),{provide:Rn,useExisting:bg},T1,...t||[]],u=new Bs({providers:a,parent:o,debugName:"",runEnvironmentInitializers:!1});return TM({r3Injector:u.injector,platformInjector:o,rootComponent:e})}catch(o){return Promise.reject(o)}finally{ze(9)}}function Zr(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}var ux=null;function Hn(){return ux}function Ng(n){ux??=n}var Zs=class{},Xs=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Z({token:n,factory:()=>P(dx),providedIn:"platform"})}return n})();var dx=(()=>{class n extends Xs{_location;_history;_doc=P(Nt);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Hn().getBaseHref(this._doc)}onPopState(t){let i=Hn().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){let i=Hn().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Z({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function tc(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function sx(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function ni(n){return n&&n[0]!=="?"?`?${n}`:n}var bi=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Z({token:n,factory:()=>P(Fg),providedIn:"root"})}return n})(),nc=new ne(""),Fg=(()=>{class n extends bi{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,i){super(),this._platformLocation=t,this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??P(Nt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return tc(this._baseHref,t)}path(t=!1){let i=this._platformLocation.pathname+ni(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,o){let a=this.prepareExternalUrl(r+ni(o));this._platformLocation.pushState(t,i,a)}replaceState(t,i,r,o){let a=this.prepareExternalUrl(r+ni(o));this._platformLocation.replaceState(t,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(i){return new(i||n)(ae(Xs),ae(nc,8))};static \u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Xr=(()=>{class n{_subject=new gt;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let i=this._locationStrategy.getBaseHref();this._basePath=LM(sx(lx(i))),this._locationStrategy.onPopState(r=>{this._subject.next({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+ni(i))}normalize(t){return n.stripTrailingSlash(OM(this._basePath,lx(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ni(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ni(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i??void 0,complete:r??void 0})}static normalizeQueryParams=ni;static joinWithSlash=tc;static stripTrailingSlash=sx;static \u0275fac=function(i){return new(i||n)(ae(bi))};static \u0275prov=Z({token:n,factory:()=>VM(),providedIn:"root"})}return n})();function VM(){return new Xr(ae(bi))}function OM(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function lx(n){return n.replace(/\/index.html$/,"")}function LM(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var Ug=(()=>{class n extends bi{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(t,i){super(),this._platformLocation=t,i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(t){let i=tc(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,o){let a=this.prepareExternalUrl(r+ni(o))||this._platformLocation.pathname;this._platformLocation.pushState(t,i,a)}replaceState(t,i,r,o){let a=this.prepareExternalUrl(r+ni(o))||this._platformLocation.pathname;this._platformLocation.replaceState(t,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(i){return new(i||n)(ae(Xs),ae(nc,8))};static \u0275prov=Z({token:n,factory:n.\u0275fac})}return n})(),yx={ADP:[void 0,void 0,0],AFN:[void 0,"\u060B",0],ALL:[void 0,void 0,0],AMD:[void 0,"\u058F",2],AOA:[void 0,"Kz"],ARS:[void 0,"$"],AUD:["A$","$"],AZN:[void 0,"\u20BC"],BAM:[void 0,"KM"],BBD:[void 0,"$"],BDT:[void 0,"\u09F3"],BHD:[void 0,void 0,3],BIF:[void 0,void 0,0],BMD:[void 0,"$"],BND:[void 0,"$"],BOB:[void 0,"Bs"],BRL:["R$"],BSD:[void 0,"$"],BWP:[void 0,"P"],BYN:[void 0,void 0,2],BYR:[void 0,void 0,0],BZD:[void 0,"$"],CAD:["CA$","$",2],CHF:[void 0,void 0,2],CLF:[void 0,void 0,4],CLP:[void 0,"$",0],CNY:["CN\xA5","\xA5"],COP:[void 0,"$",2],CRC:[void 0,"\u20A1",2],CUC:[void 0,"$"],CUP:[void 0,"$"],CZK:[void 0,"K\u010D",2],DJF:[void 0,void 0,0],DKK:[void 0,"kr",2],DOP:[void 0,"$"],EGP:[void 0,"E\xA3"],ESP:[void 0,"\u20A7",0],EUR:["\u20AC"],FJD:[void 0,"$"],FKP:[void 0,"\xA3"],GBP:["\xA3"],GEL:[void 0,"\u20BE"],GHS:[void 0,"GH\u20B5"],GIP:[void 0,"\xA3"],GNF:[void 0,"FG",0],GTQ:[void 0,"Q"],GYD:[void 0,"$",2],HKD:["HK$","$"],HNL:[void 0,"L"],HRK:[void 0,"kn"],HUF:[void 0,"Ft",2],IDR:[void 0,"Rp",2],ILS:["\u20AA"],INR:["\u20B9"],IQD:[void 0,void 0,0],IRR:[void 0,void 0,0],ISK:[void 0,"kr",0],ITL:[void 0,void 0,0],JMD:[void 0,"$"],JOD:[void 0,void 0,3],JPY:["\xA5",void 0,0],KHR:[void 0,"\u17DB"],KMF:[void 0,"CF",0],KPW:[void 0,"\u20A9",0],KRW:["\u20A9",void 0,0],KWD:[void 0,void 0,3],KYD:[void 0,"$"],KZT:[void 0,"\u20B8"],LAK:[void 0,"\u20AD",0],LBP:[void 0,"L\xA3",0],LKR:[void 0,"Rs"],LRD:[void 0,"$"],LTL:[void 0,"Lt"],LUF:[void 0,void 0,0],LVL:[void 0,"Ls"],LYD:[void 0,void 0,3],MGA:[void 0,"Ar",0],MGF:[void 0,void 0,0],MMK:[void 0,"K",0],MNT:[void 0,"\u20AE",2],MRO:[void 0,void 0,0],MUR:[void 0,"Rs",2],MXN:["MX$","$"],MYR:[void 0,"RM"],NAD:[void 0,"$"],NGN:[void 0,"\u20A6"],NIO:[void 0,"C$"],NOK:[void 0,"kr",2],NPR:[void 0,"Rs"],NZD:["NZ$","$"],OMR:[void 0,void 0,3],PHP:["\u20B1"],PKR:[void 0,"Rs",2],PLN:[void 0,"z\u0142"],PYG:[void 0,"\u20B2",0],RON:[void 0,"lei"],RSD:[void 0,void 0,0],RUB:[void 0,"\u20BD"],RWF:[void 0,"RF",0],SBD:[void 0,"$"],SEK:[void 0,"kr",2],SGD:[void 0,"$"],SHP:[void 0,"\xA3"],SLE:[void 0,void 0,2],SLL:[void 0,void 0,0],SOS:[void 0,void 0,0],SRD:[void 0,"$"],SSP:[void 0,"\xA3"],STD:[void 0,void 0,0],STN:[void 0,"Db"],SYP:[void 0,"\xA3",0],THB:[void 0,"\u0E3F"],TMM:[void 0,void 0,0],TND:[void 0,void 0,3],TOP:[void 0,"T$"],TRL:[void 0,void 0,0],TRY:[void 0,"\u20BA"],TTD:[void 0,"$"],TWD:["NT$","$",2],TZS:[void 0,void 0,2],UAH:[void 0,"\u20B4"],UGX:[void 0,void 0,0],USD:["$"],UYI:[void 0,void 0,0],UYU:[void 0,"$"],UYW:[void 0,void 0,4],UZS:[void 0,void 0,2],VEF:[void 0,"Bs",2],VND:["\u20AB",void 0,0],VUV:[void 0,void 0,0],XAF:["FCFA",void 0,0],XCD:["EC$","$"],XOF:["F\u202FCFA",void 0,0],XPF:["CFPF",void 0,0],XXX:["\xA4"],YER:[void 0,void 0,0],ZAR:[void 0,"R"],ZMK:[void 0,void 0,0],ZMW:[void 0,"ZK"],ZWD:[void 0,void 0,0]},mc=(function(n){return n[n.Decimal=0]="Decimal",n[n.Percent=1]="Percent",n[n.Currency=2]="Currency",n[n.Scientific=3]="Scientific",n})(mc||{});var Qt=(function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n})(Qt||{}),Ye=(function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n})(Ye||{}),yn=(function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n})(yn||{}),qt={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function _x(n){return rn(n)[ct.LocaleId]}function vx(n,e,t){let i=rn(n),r=[i[ct.DayPeriodsFormat],i[ct.DayPeriodsStandalone]],o=Gn(r,e);return Gn(o,t)}function Cx(n,e,t){let i=rn(n),r=[i[ct.DaysFormat],i[ct.DaysStandalone]],o=Gn(r,e);return Gn(o,t)}function xx(n,e,t){let i=rn(n),r=[i[ct.MonthsFormat],i[ct.MonthsStandalone]],o=Gn(r,e);return Gn(o,t)}function bx(n,e){let i=rn(n)[ct.Eras];return Gn(i,e)}function el(n,e){let t=rn(n);return Gn(t[ct.DateFormat],e)}function tl(n,e){let t=rn(n);return Gn(t[ct.TimeFormat],e)}function nl(n,e){let i=rn(n)[ct.DateTimeFormat];return Gn(i,e)}function ri(n,e){let t=rn(n),i=t[ct.NumberSymbols][e];if(typeof i>"u"){if(e===qt.CurrencyDecimal)return t[ct.NumberSymbols][qt.Decimal];if(e===qt.CurrencyGroup)return t[ct.NumberSymbols][qt.Group]}return i}function $g(n,e){return rn(n)[ct.NumberFormats][e]}function BM(n){return rn(n)[ct.Currencies]}function Ex(n){if(!n[ct.ExtraData])throw new z(2303,!1)}function Sx(n){let e=rn(n);return Ex(e),(e[ct.ExtraData][2]||[]).map(i=>typeof i=="string"?Pg(i):[Pg(i[0]),Pg(i[1])])}function Dx(n,e,t){let i=rn(n);Ex(i);let r=[i[ct.ExtraData][0],i[ct.ExtraData][1]],o=Gn(r,e)||[];return Gn(o,t)||[]}function Gn(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new z(2304,!1)}function Pg(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}function wx(n,e,t="en"){let i=BM(t)[n]||yx[n]||[],r=i[1];return e==="narrow"&&typeof r=="string"?r:i[0]||n}var UM=2;function Tx(n){let e,t=yx[n];return t&&(e=t[2]),typeof e=="number"?e:UM}var $M=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,ic={},HM=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function Ix(n,e,t,i){let r=QM(n);e=Wi(t,e)||e;let a=[],u;for(;e;)if(u=HM.exec(e),u){a=a.concat(u.slice(1));let h=a.pop();if(!h)break;e=h}else{a.push(e);break}let c=r.getTimezoneOffset();i&&(c=Ax(i,c),r=KM(r,i));let m="";return a.forEach(h=>{let y=YM(h);m+=y?y(r,t,c):h==="''"?"'":h.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),m}function lc(n,e,t){let i=new Date(0);return i.setFullYear(n,e,t),i.setHours(0,0,0),i}function Wi(n,e){let t=_x(n);if(ic[t]??={},ic[t][e])return ic[t][e];let i="";switch(e){case"shortDate":i=el(n,yn.Short);break;case"mediumDate":i=el(n,yn.Medium);break;case"longDate":i=el(n,yn.Long);break;case"fullDate":i=el(n,yn.Full);break;case"shortTime":i=tl(n,yn.Short);break;case"mediumTime":i=tl(n,yn.Medium);break;case"longTime":i=tl(n,yn.Long);break;case"fullTime":i=tl(n,yn.Full);break;case"short":let r=Wi(n,"shortTime"),o=Wi(n,"shortDate");i=rc(nl(n,yn.Short),[r,o]);break;case"medium":let a=Wi(n,"mediumTime"),u=Wi(n,"mediumDate");i=rc(nl(n,yn.Medium),[a,u]);break;case"long":let c=Wi(n,"longTime"),m=Wi(n,"longDate");i=rc(nl(n,yn.Long),[c,m]);break;case"full":let h=Wi(n,"fullTime"),y=Wi(n,"fullDate");i=rc(nl(n,yn.Full),[h,y]);break}return i&&(ic[t][e]=i),i}function rc(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,i){return e!=null&&i in e?e[i]:t})),n}function ii(n,e,t="-",i,r){let o="";(n<0||r&&n<=0)&&(r?n=-n+1:(n=-n,o=t));let a=String(n);for(;a.length<e;)a="0"+a;return i&&(a=a.slice(a.length-e)),o+a}function GM(n,e){return ii(n,3).substring(0,e)}function Tt(n,e,t=0,i=!1,r=!1){return function(o,a){let u=qM(n,o);if((t>0||u>-t)&&(u+=t),n===3)u===0&&t===-12&&(u=12);else if(n===6)return GM(u,e);let c=ri(a,qt.MinusSign);return ii(u,e,c,i,r)}}function qM(n,e){switch(n){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();case 3:return e.getHours();case 4:return e.getMinutes();case 5:return e.getSeconds();case 6:return e.getMilliseconds();case 7:return e.getDay();default:throw new z(2301,!1)}}function Ze(n,e,t=Qt.Format,i=!1){return function(r,o){return WM(r,o,n,e,t,i)}}function WM(n,e,t,i,r,o){switch(t){case 2:return xx(e,r,i)[n.getMonth()];case 1:return Cx(e,r,i)[n.getDay()];case 0:let a=n.getHours(),u=n.getMinutes();if(o){let m=Sx(e),h=Dx(e,r,i),y=m.findIndex(v=>{if(Array.isArray(v)){let[C,T]=v,R=a>=C.hours&&u>=C.minutes,N=a<T.hours||a===T.hours&&u<T.minutes;if(C.hours<T.hours){if(R&&N)return!0}else if(R||N)return!0}else if(v.hours===a&&v.minutes===u)return!0;return!1});if(y!==-1)return h[y]}return vx(e,r,i)[a<12?0:1];case 3:return bx(e,i)[n.getFullYear()<=0?0:1];default:let c=t;throw new z(2302,!1)}}function oc(n){return function(e,t,i){let r=-1*i,o=ri(t,qt.MinusSign),a=r>0?Math.floor(r/60):Math.ceil(r/60);switch(n){case 0:return(r>=0?"+":"")+ii(a,2,o)+ii(Math.abs(r%60),2,o);case 1:return"GMT"+(r>=0?"+":"")+ii(a,1,o);case 2:return"GMT"+(r>=0?"+":"")+ii(a,2,o)+":"+ii(Math.abs(r%60),2,o);case 3:return i===0?"Z":(r>=0?"+":"")+ii(a,2,o)+":"+ii(Math.abs(r%60),2,o);default:throw new z(2310,!1)}}}var jM=0,sc=4;function zM(n){let e=lc(n,jM,1).getDay();return lc(n,0,1+(e<=sc?sc:sc+7)-e)}function Mx(n){let e=n.getDay(),t=e===0?-3:sc-e;return lc(n.getFullYear(),n.getMonth(),n.getDate()+t)}function kg(n,e=!1){return function(t,i){let r;if(e){let o=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,a=t.getDate();r=1+Math.floor((a+o)/7)}else{let o=Mx(t),a=zM(o.getFullYear()),u=o.getTime()-a.getTime();r=1+Math.round(u/6048e5)}return ii(r,n,ri(i,qt.MinusSign))}}function ac(n,e=!1){return function(t,i){let o=Mx(t).getFullYear();return ii(o,n,ri(i,qt.MinusSign),e)}}var Vg={};function YM(n){if(Vg[n])return Vg[n];let e;switch(n){case"G":case"GG":case"GGG":e=Ze(3,Ye.Abbreviated);break;case"GGGG":e=Ze(3,Ye.Wide);break;case"GGGGG":e=Ze(3,Ye.Narrow);break;case"y":e=Tt(0,1,0,!1,!0);break;case"yy":e=Tt(0,2,0,!0,!0);break;case"yyy":e=Tt(0,3,0,!1,!0);break;case"yyyy":e=Tt(0,4,0,!1,!0);break;case"Y":e=ac(1);break;case"YY":e=ac(2,!0);break;case"YYY":e=ac(3);break;case"YYYY":e=ac(4);break;case"M":case"L":e=Tt(1,1,1);break;case"MM":case"LL":e=Tt(1,2,1);break;case"MMM":e=Ze(2,Ye.Abbreviated);break;case"MMMM":e=Ze(2,Ye.Wide);break;case"MMMMM":e=Ze(2,Ye.Narrow);break;case"LLL":e=Ze(2,Ye.Abbreviated,Qt.Standalone);break;case"LLLL":e=Ze(2,Ye.Wide,Qt.Standalone);break;case"LLLLL":e=Ze(2,Ye.Narrow,Qt.Standalone);break;case"w":e=kg(1);break;case"ww":e=kg(2);break;case"W":e=kg(1,!0);break;case"d":e=Tt(2,1);break;case"dd":e=Tt(2,2);break;case"c":case"cc":e=Tt(7,1);break;case"ccc":e=Ze(1,Ye.Abbreviated,Qt.Standalone);break;case"cccc":e=Ze(1,Ye.Wide,Qt.Standalone);break;case"ccccc":e=Ze(1,Ye.Narrow,Qt.Standalone);break;case"cccccc":e=Ze(1,Ye.Short,Qt.Standalone);break;case"E":case"EE":case"EEE":e=Ze(1,Ye.Abbreviated);break;case"EEEE":e=Ze(1,Ye.Wide);break;case"EEEEE":e=Ze(1,Ye.Narrow);break;case"EEEEEE":e=Ze(1,Ye.Short);break;case"a":case"aa":case"aaa":e=Ze(0,Ye.Abbreviated);break;case"aaaa":e=Ze(0,Ye.Wide);break;case"aaaaa":e=Ze(0,Ye.Narrow);break;case"b":case"bb":case"bbb":e=Ze(0,Ye.Abbreviated,Qt.Standalone,!0);break;case"bbbb":e=Ze(0,Ye.Wide,Qt.Standalone,!0);break;case"bbbbb":e=Ze(0,Ye.Narrow,Qt.Standalone,!0);break;case"B":case"BB":case"BBB":e=Ze(0,Ye.Abbreviated,Qt.Format,!0);break;case"BBBB":e=Ze(0,Ye.Wide,Qt.Format,!0);break;case"BBBBB":e=Ze(0,Ye.Narrow,Qt.Format,!0);break;case"h":e=Tt(3,1,-12);break;case"hh":e=Tt(3,2,-12);break;case"H":e=Tt(3,1);break;case"HH":e=Tt(3,2);break;case"m":e=Tt(4,1);break;case"mm":e=Tt(4,2);break;case"s":e=Tt(5,1);break;case"ss":e=Tt(5,2);break;case"S":e=Tt(6,1);break;case"SS":e=Tt(6,2);break;case"SSS":e=Tt(6,3);break;case"Z":case"ZZ":case"ZZZ":e=oc(0);break;case"ZZZZZ":e=oc(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=oc(1);break;case"OOOO":case"ZZZZ":case"zzzz":e=oc(2);break;default:return null}return Vg[n]=e,e}function Ax(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function JM(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function KM(n,e,t){let r=n.getTimezoneOffset(),o=Ax(e,r);return JM(n,-1*(o-r))}function QM(n){if(cx(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[r,o=1,a=1]=n.split("-").map(u=>+u);return lc(r,o-1,a)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let i;if(i=n.match($M))return ZM(i)}let e=new Date(n);if(!cx(e))throw new z(2311,!1);return e}function ZM(n){let e=new Date(0),t=0,i=0,r=n[8]?e.setUTCFullYear:e.setFullYear,o=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),i=Number(n[9]+n[11])),r.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let a=Number(n[4]||0)-t,u=Number(n[5]||0)-i,c=Number(n[6]||0),m=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return o.call(e,a,u,c,m),e}function cx(n){return n instanceof Date&&!isNaN(n.valueOf())}var XM=/^(\d+)?\.((\d+)(-(\d+))?)?$/,mx=22,uc=".",il="0",eA=";",tA=",",Og="#",px="\xA4";function Rx(n,e,t,i,r,o,a=!1){let u="",c=!1;if(!isFinite(n))u=ri(t,qt.Infinity);else{let m=iA(n);a&&(m=nA(m));let h=e.minInt,y=e.minFrac,v=e.maxFrac;if(o){let $=o.match(XM);if($===null)throw new z(2306,!1);let q=$[1],Q=$[3],ie=$[5];q!=null&&(h=Lg(q)),Q!=null&&(y=Lg(Q)),ie!=null?v=Lg(ie):Q!=null&&y>v&&(v=y)}rA(m,y,v);let C=m.digits,T=m.integerLen,R=m.exponent,N=[];for(c=C.every($=>!$);T<h;T++)C.unshift(0);for(;T<0;T++)C.unshift(0);T>0?N=C.splice(T,C.length):(N=C,C=[0]);let F=[];for(C.length>=e.lgSize&&F.unshift(C.splice(-e.lgSize,C.length).join(""));C.length>e.gSize;)F.unshift(C.splice(-e.gSize,C.length).join(""));C.length&&F.unshift(C.join("")),u=F.join(ri(t,i)),N.length&&(u+=ri(t,r)+N.join("")),R&&(u+=ri(t,qt.Exponential)+"+"+R)}return n<0&&!c?u=e.negPre+u+e.negSuf:u=e.posPre+u+e.posSuf,u}function Nx(n,e,t,i,r){let o=$g(e,mc.Currency),a=Px(o,ri(e,qt.MinusSign));return a.minFrac=Tx(i),a.maxFrac=a.minFrac,Rx(n,a,e,qt.CurrencyGroup,qt.CurrencyDecimal,r).replace(px,t).replace(px,"").trim()}function Fx(n,e,t){let i=$g(e,mc.Decimal),r=Px(i,ri(e,qt.MinusSign));return Rx(n,r,e,qt.Group,qt.Decimal,t)}function Px(n,e="-"){let t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},i=n.split(eA),r=i[0],o=i[1],a=r.indexOf(uc)!==-1?r.split(uc):[r.substring(0,r.lastIndexOf(il)+1),r.substring(r.lastIndexOf(il)+1)],u=a[0],c=a[1]||"";t.posPre=u.substring(0,u.indexOf(Og));for(let h=0;h<c.length;h++){let y=c.charAt(h);y===il?t.minFrac=t.maxFrac=h+1:y===Og?t.maxFrac=h+1:t.posSuf+=y}let m=u.split(tA);if(t.gSize=m[1]?m[1].length:0,t.lgSize=m[2]||m[1]?(m[2]||m[1]).length:0,o){let h=r.length-t.posPre.length-t.posSuf.length,y=o.indexOf(Og);t.negPre=o.substring(0,y).replace(/'/g,""),t.negSuf=o.slice(y+h).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}function nA(n){if(n.digits[0]===0)return n;let e=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(e===0?n.digits.push(0,0):e===1&&n.digits.push(0),n.integerLen+=2),n}function iA(n){let e=Math.abs(n)+"",t=0,i,r,o,a,u;for((r=e.indexOf(uc))>-1&&(e=e.replace(uc,"")),(o=e.search(/e/i))>0?(r<0&&(r=o),r+=+e.slice(o+1),e=e.substring(0,o)):r<0&&(r=e.length),o=0;e.charAt(o)===il;o++);if(o===(u=e.length))i=[0],r=1;else{for(u--;e.charAt(u)===il;)u--;for(r-=o,i=[],a=0;o<=u;o++,a++)i[a]=Number(e.charAt(o))}return r>mx&&(i=i.splice(0,mx-1),t=r-1,r=1),{digits:i,exponent:t,integerLen:r}}function rA(n,e,t){if(e>t)throw new z(2307,!1);let i=n.digits,r=i.length-n.integerLen,o=Math.min(Math.max(e,r),t),a=o+n.integerLen,u=i[a];if(a>0){i.splice(Math.max(n.integerLen,a));for(let y=a;y<i.length;y++)i[y]=0}else{r=Math.max(0,r),n.integerLen=1,i.length=Math.max(1,a=o+1),i[0]=0;for(let y=1;y<a;y++)i[y]=0}if(u>=5)if(a-1<0){for(let y=0;y>a;y--)i.unshift(0),n.integerLen++;i.unshift(1),n.integerLen++}else i[a-1]++;for(;r<Math.max(0,o);r++)i.push(0);let c=o!==0,m=e+n.integerLen,h=i.reduceRight(function(y,v,C,T){return v=v+y,T[C]=v<10?v:v-10,c&&(T[C]===0&&C>=m?T.pop():c=!1),v>=10?1:0},0);h&&(i.unshift(h),n.integerLen++)}function Lg(n){let e=parseInt(n);if(isNaN(e))throw new z(2305,!1);return e}var Bg=/\s+/,fx=[],Hg=(()=>{class n{_ngEl;_renderer;initialClasses=fx;rawClass;stateMap=new Map;constructor(t,i){this._ngEl=t,this._renderer=i}set klass(t){this.initialClasses=t!=null?t.trim().split(Bg):fx}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(Bg):t}ngDoCheck(){for(let i of this.initialClasses)this._updateState(i,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let i of t)this._updateState(i,!0);else if(t!=null)for(let i of Object.keys(t))this._updateState(i,!!t[i]);this._applyStateDiff()}_updateState(t,i){let r=this.stateMap.get(t);r!==void 0?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){t=t.trim(),t.length>0&&t.split(Bg).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static \u0275fac=function(i){return new(i||n)(X(nn),X(ei))};static \u0275dir=Ae({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return n})();var dc=class{$implicit;ngForOf;index;count;constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},na=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let i=this._viewContainer;t.forEachOperation((r,o,a)=>{if(r.previousIndex==null)i.createEmbeddedView(this._template,new dc(r.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let u=i.get(o);i.move(u,a),gx(u,r)}});for(let r=0,o=i.length;r<o;r++){let u=i.get(r).context;u.index=r,u.count=o,u.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{let o=i.get(r.currentIndex);gx(o,r)})}static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(X(Hi),X(gr),X(Rg))};static \u0275dir=Ae({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function gx(n,e){n.context.$implicit=e.item}var ji=(()=>{class n{_viewContainer;_context=new cc;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,i){this._viewContainer=t,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){hx(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){hx(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(X(Hi),X(gr))};static \u0275dir=Ae({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),cc=class{$implicit=null;ngIf=null};function hx(n,e){if(n&&!n.createEmbeddedView)throw new z(2020,!1)}function Gg(n,e){return new z(2100,!1)}var oA="mediumDate",kx=new ne(""),Vx=new ne(""),eo=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(t,i,r){this.locale=t,this.defaultTimezone=i,this.defaultOptions=r}transform(t,i,r,o){if(t==null||t===""||t!==t)return null;try{let a=i??this.defaultOptions?.dateFormat??oA,u=r??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return Ix(t,a,o||this.locale,u)}catch(a){throw Gg(n,a.message)}}static \u0275fac=function(i){return new(i||n)(X(Qr,16),X(kx,24),X(Vx,24))};static \u0275pipe=Js({name:"date",type:n,pure:!0})}return n})();var rl=(()=>{class n{_locale;constructor(t){this._locale=t}transform(t,i,r){if(!Ox(t))return null;r||=this._locale;try{let o=Lx(t);return Fx(o,r,i)}catch(o){throw Gg(n,o.message)}}static \u0275fac=function(i){return new(i||n)(X(Qr,16))};static \u0275pipe=Js({name:"number",type:n,pure:!0})}return n})();var qg=(()=>{class n{_locale;_defaultCurrencyCode;constructor(t,i="USD"){this._locale=t,this._defaultCurrencyCode=i}transform(t,i=this._defaultCurrencyCode,r="symbol",o,a){if(!Ox(t))return null;a||=this._locale,typeof r=="boolean"&&(r=r?"symbol":"code");let u=i||this._defaultCurrencyCode;r!=="code"&&(r==="symbol"||r==="symbol-narrow"?u=wx(u,r==="symbol"?"wide":"narrow",a):u=r);try{let c=Lx(t);return Nx(c,a,u,i,o)}catch(c){throw Gg(n,c.message)}}static \u0275fac=function(i){return new(i||n)(X(Qr,16),X(Sg,16))};static \u0275pipe=Js({name:"currency",type:n,pure:!0})}return n})();function Ox(n){return!(n==null||n===""||n!==n)}function Lx(n){if(typeof n=="string"&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if(typeof n!="number")throw new z(2309,!1);return n}var oe=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=ti({type:n});static \u0275inj=Nn({})}return n})();function ol(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let i=t.indexOf("="),[r,o]=i==-1?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(o)}return null}var to=class{};var Bx="browser";var al=class{_doc;constructor(e){this._doc=e}manager},pc=(()=>{class n extends al{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r,o){return t.addEventListener(i,r,o),()=>this.removeEventListener(t,i,r,o)}removeEventListener(t,i,r,o){return t.removeEventListener(i,r,o)}static \u0275fac=function(i){return new(i||n)(ae(Nt))};static \u0275prov=Z({token:n,factory:n.\u0275fac})}return n})(),gc=new ne(""),Jg=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,i){this._zone=i,t.forEach(a=>{a.manager=this});let r=t.filter(a=>!(a instanceof pc));this._plugins=r.slice().reverse();let o=t.find(a=>a instanceof pc);o&&this._plugins.push(o)}addEventListener(t,i,r,o){return this._findPluginFor(i).addEventListener(t,i,r,o)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(o=>o.supports(t)),!i)throw new z(5101,!1);return this._eventNameToPlugin.set(t,i),i}static \u0275fac=function(i){return new(i||n)(ae(gc),ae(_t))};static \u0275prov=Z({token:n,factory:n.\u0275fac})}return n})(),Wg="ng-app-id";function Ux(n){for(let e of n)e.remove()}function $x(n,e){let t=e.createElement("style");return t.textContent=n,t}function sA(n,e,t,i){let r=n.head?.querySelectorAll(`style[${Wg}="${e}"],link[${Wg}="${e}"]`);if(r)for(let o of r)o.removeAttribute(Wg),o instanceof HTMLLinkElement?i.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function zg(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var Kg=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,i,r,o={}){this.doc=t,this.appId=i,this.nonce=r,sA(t,i,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,i){for(let r of t)this.addUsage(r,this.inline,$x);i?.forEach(r=>this.addUsage(r,this.external,zg))}removeStyles(t,i){for(let r of t)this.removeUsage(r,this.inline);i?.forEach(r=>this.removeUsage(r,this.external))}addUsage(t,i,r){let o=i.get(t);o?o.usage++:i.set(t,{usage:1,elements:[...this.hosts].map(a=>this.addElement(a,r(t,this.doc)))})}removeUsage(t,i){let r=i.get(t);r&&(r.usage--,r.usage<=0&&(Ux(r.elements),i.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])Ux(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[i,{elements:r}]of this.inline)r.push(this.addElement(t,$x(i,this.doc)));for(let[i,{elements:r}]of this.external)r.push(this.addElement(t,zg(i,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,i){return this.nonce&&i.setAttribute("nonce",this.nonce),t.appendChild(i)}static \u0275fac=function(i){return new(i||n)(ae(Nt),ae(Fd),ae(kd,8),ae(Gs))};static \u0275prov=Z({token:n,factory:n.\u0275fac})}return n})(),jg={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Qg=/%COMP%/g;var Gx="%COMP%",lA=`_nghost-${Gx}`,uA=`_ngcontent-${Gx}`,dA=!0,cA=new ne("",{providedIn:"root",factory:()=>dA});function mA(n){return uA.replace(Qg,n)}function pA(n){return lA.replace(Qg,n)}function qx(n,e){return e.map(t=>t.replace(Qg,n))}var Zg=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,i,r,o,a,u,c=null,m=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=o,this.doc=a,this.ngZone=u,this.nonce=c,this.tracingService=m,this.platformIsServer=!1,this.defaultRenderer=new sl(t,a,u,this.platformIsServer,this.tracingService)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;let r=this.getOrCreateRenderer(t,i);return r instanceof fc?r.applyToHost(t):r instanceof ll&&r.applyStyles(),r}getOrCreateRenderer(t,i){let r=this.rendererByCompId,o=r.get(i.id);if(!o){let a=this.doc,u=this.ngZone,c=this.eventManager,m=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,y=this.platformIsServer,v=this.tracingService;switch(i.encapsulation){case Bi.Emulated:o=new fc(c,m,i,this.appId,h,a,u,y,v);break;case Bi.ShadowDom:return new Yg(c,m,t,i,a,u,this.nonce,y,v);default:o=new ll(c,m,i,h,a,u,y,v);break}r.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(i){return new(i||n)(ae(Jg),ae(Kg),ae(Fd),ae(cA),ae(Nt),ae(_t),ae(kd),ae(Kr,8))};static \u0275prov=Z({token:n,factory:n.\u0275fac})}return n})(),sl=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,i,r,o){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.tracingService=o}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(jg[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(Hx(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(Hx(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){t.remove()}selectRootElement(e,t){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new z(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;let o=jg[r];o?e.setAttributeNS(o,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){let r=jg[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(xi.DashCase|xi.Important)?e.style.setProperty(t,i,r&xi.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&xi.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e!=null&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i,r){if(typeof e=="string"&&(e=Hn().getGlobalEventTarget(this.doc,e),!e))throw new z(5102,!1);let o=this.decoratePreventDefault(i);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,r)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function Hx(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Yg=class extends sl{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,i,r,o,a,u,c,m){super(e,o,a,c,m),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let h=r.styles;h=qx(r.id,h);for(let v of h){let C=document.createElement("style");u&&C.setAttribute("nonce",u),C.textContent=v,this.shadowRoot.appendChild(C)}let y=r.getExternalStyles?.();if(y)for(let v of y){let C=zg(v,o);u&&C.setAttribute("nonce",u),this.shadowRoot.appendChild(C)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},ll=class extends sl{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,i,r,o,a,u,c,m){super(e,o,a,u,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r;let h=i.styles;this.styles=m?qx(m,h):h,this.styleUrls=i.getExternalStyles?.(m)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&jr.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},fc=class extends ll{contentAttr;hostAttr;constructor(e,t,i,r,o,a,u,c,m){let h=r+"-"+i.id;super(e,t,i,o,a,u,c,m,h),this.contentAttr=mA(h),this.hostAttr=pA(h)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}};var hc=class n extends Zs{supportsDOMEvents=!0;static makeCurrent(){Ng(new n)}onAndCancel(e,t,i,r){return e.addEventListener(t,i,r),()=>{e.removeEventListener(t,i,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=fA();return t==null?null:gA(t)}resetBaseElement(){ul=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return ol(document.cookie,e)}},ul=null;function fA(){return ul=ul||document.head.querySelector("base"),ul?ul.getAttribute("href"):null}function gA(n){return new URL(n,document.baseURI).pathname}var hA=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Z({token:n,factory:n.\u0275fac})}return n})(),Wx=["alt","control","meta","shift"],yA={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},_A={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},jx=(()=>{class n extends al{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,i,r,o){let a=n.parseEventName(i),u=n.eventCallback(a.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Hn().onAndCancel(t,a.domEventName,u,o))}static parseEventName(t){let i=t.toLowerCase().split("."),r=i.shift();if(i.length===0||!(r==="keydown"||r==="keyup"))return null;let o=n._normalizeKey(i.pop()),a="",u=i.indexOf("code");if(u>-1&&(i.splice(u,1),a="code."),Wx.forEach(m=>{let h=i.indexOf(m);h>-1&&(i.splice(h,1),a+=m+".")}),a+=o,i.length!=0||o.length===0)return null;let c={};return c.domEventName=r,c.fullKey=a,c}static matchEventFullKeyCode(t,i){let r=yA[t.key]||t.key,o="";return i.indexOf("code.")>-1&&(r=t.code,o="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),Wx.forEach(a=>{if(a!==r){let u=_A[a];u(t)&&(o+=a+".")}}),o+=r,o===i)}static eventCallback(t,i,r){return o=>{n.matchEventFullKeyCode(o,t)&&r.runGuarded(()=>i(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(i){return new(i||n)(ae(Nt))};static \u0275prov=Z({token:n,factory:n.\u0275fac})}return n})();function Xg(n,e,t){let i=V({rootComponent:n,platformRef:t?.platformRef},vA(e));return ax(i)}function vA(n){return{appProviders:[...SA,...n?.providers??[]],platformProviders:EA}}function CA(){hc.makeCurrent()}function xA(){return new An}function bA(){return Uf(document),document}var EA=[{provide:Gs,useValue:Bx},{provide:Pd,useValue:CA,multi:!0},{provide:Nt,useFactory:bA}];var SA=[{provide:Cs,useValue:"root"},{provide:An,useFactory:xA},{provide:gc,useClass:pc,multi:!0,deps:[Nt]},{provide:gc,useClass:jx,multi:!0,deps:[Nt]},Zg,Kg,Jg,{provide:zr,useExisting:Zg},{provide:to,useClass:hA},[]];var oa=class{},dl=class{},Ot=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let i=t.indexOf(":");if(i>0){let r=t.slice(0,i),o=t.slice(i+1).trim();this.addHeaderEntry(r,o)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.addHeaderEntry(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if(typeof i=="string"&&(i=[i]),i.length===0)return;this.maybeSetNormalizedName(e.name,t);let r=(e.op==="a"?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":let o=e.value;if(!o)this.headers.delete(t),this.normalizedNames.delete(t);else{let a=this.headers.get(t);if(!a)return;a=a.filter(u=>o.indexOf(u)===-1),a.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,a)}break}}addHeaderEntry(e,t){let i=e.toLowerCase();this.maybeSetNormalizedName(e,i),this.headers.has(i)?this.headers.get(i).push(t):this.headers.set(i,[t])}setHeaderEntries(e,t){let i=(Array.isArray(t)?t:[t]).map(o=>o.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var _c=class{encodeKey(e){return zx(e)}encodeValue(e){return zx(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function DA(n,e){let t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{let o=r.indexOf("="),[a,u]=o==-1?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,o)),e.decodeValue(r.slice(o+1))],c=t.get(a)||[];c.push(u),t.set(a,c)}),t}var wA=/%(\d[a-f0-9])/gi,TA={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function zx(n){return encodeURIComponent(n).replace(wA,(e,t)=>TA[t]??e)}function yc(n){return`${n}`}var _e=class n{map;encoder;updates=null;cloneFrom=null;constructor(e={}){if(this.encoder=e.encoder||new _c,e.fromString){if(e.fromObject)throw new z(2805,!1);this.map=DA(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let i=e.fromObject[t],r=Array.isArray(i)?i.map(yc):[yc(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(i=>{let r=e[i];Array.isArray(r)?r.forEach(o=>{t.push({param:i,value:o,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new n({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(yc(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let i=this.map.get(e.param)||[],r=i.indexOf(yc(e.value));r!==-1&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var vc=class{map=new Map;set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function IA(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function Yx(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function Jx(n){return typeof Blob<"u"&&n instanceof Blob}function Kx(n){return typeof FormData<"u"&&n instanceof FormData}function MA(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var Qx="Content-Type",Zx="Accept",eb="X-Request-URL",tb="text/plain",nb="application/json",AA=`${nb}, ${tb}, */*`,ia=class n{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;credentials;keepalive=!1;cache;priority;mode;redirect;referrer;integrity;responseType="json";method;params;urlWithParams;transferCache;timeout;constructor(e,t,i,r){this.url=t,this.method=e.toUpperCase();let o;if(IA(this.method)||r?(this.body=i!==void 0?i:null,o=r):o=i,o){if(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,this.keepalive=!!o.keepalive,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params),o.priority&&(this.priority=o.priority),o.cache&&(this.cache=o.cache),o.credentials&&(this.credentials=o.credentials),typeof o.timeout=="number"){if(o.timeout<1||!Number.isInteger(o.timeout))throw new z(2822,"");this.timeout=o.timeout}o.mode&&(this.mode=o.mode),o.redirect&&(this.redirect=o.redirect),o.integrity&&(this.integrity=o.integrity),o.referrer&&(this.referrer=o.referrer),this.transferCache=o.transferCache}if(this.headers??=new Ot,this.context??=new vc,!this.params)this.params=new _e,this.urlWithParams=t;else{let a=this.params.toString();if(a.length===0)this.urlWithParams=t;else{let u=t.indexOf("?"),c=u===-1?"?":u<t.length-1?"&":"";this.urlWithParams=t+c+a}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||Yx(this.body)||Jx(this.body)||Kx(this.body)||MA(this.body)?this.body:this.body instanceof _e?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||Kx(this.body)?null:Jx(this.body)?this.body.type||null:Yx(this.body)?null:typeof this.body=="string"?tb:this.body instanceof _e?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?nb:null}clone(e={}){let t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,o=e.keepalive??this.keepalive,a=e.priority||this.priority,u=e.cache||this.cache,c=e.mode||this.mode,m=e.redirect||this.redirect,h=e.credentials||this.credentials,y=e.referrer||this.referrer,v=e.integrity||this.integrity,C=e.transferCache??this.transferCache,T=e.timeout??this.timeout,R=e.body!==void 0?e.body:this.body,N=e.withCredentials??this.withCredentials,F=e.reportProgress??this.reportProgress,$=e.headers||this.headers,q=e.params||this.params,Q=e.context??this.context;return e.setHeaders!==void 0&&($=Object.keys(e.setHeaders).reduce((ie,de)=>ie.set(de,e.setHeaders[de]),$)),e.setParams&&(q=Object.keys(e.setParams).reduce((ie,de)=>ie.set(de,e.setParams[de]),q)),new n(t,i,R,{params:q,headers:$,context:Q,reportProgress:F,responseType:r,withCredentials:N,transferCache:C,keepalive:o,cache:u,priority:a,timeout:T,mode:c,redirect:m,credentials:h,referrer:y,integrity:v})}},no=(function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n})(no||{}),aa=class{headers;status;statusText;url;ok;type;redirected;constructor(e,t=200,i="OK"){this.headers=e.headers||new Ot,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.redirected=e.redirected,this.ok=this.status>=200&&this.status<300}},Cc=class n extends aa{constructor(e={}){super(e)}type=no.ResponseHeader;clone(e={}){return new n({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},cl=class n extends aa{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=no.Response;clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0,redirected:e.redirected??this.redirected})}},ra=class extends aa{name="HttpErrorResponse";message;error;ok=!1;constructor(e){super(e,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},RA=200,NA=204;function eh(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,credentials:n.credentials,transferCache:n.transferCache,timeout:n.timeout,keepalive:n.keepalive,priority:n.priority,cache:n.cache,mode:n.mode,redirect:n.redirect,integrity:n.integrity,referrer:n.referrer}}var Zt=(()=>{class n{handler;constructor(t){this.handler=t}request(t,i,r={}){let o;if(t instanceof ia)o=t;else{let c;r.headers instanceof Ot?c=r.headers:c=new Ot(r.headers);let m;r.params&&(r.params instanceof _e?m=r.params:m=new _e({fromObject:r.params})),o=new ia(t,i,r.body!==void 0?r.body:null,{headers:c,context:r.context,params:m,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials,transferCache:r.transferCache,keepalive:r.keepalive,priority:r.priority,cache:r.cache,mode:r.mode,redirect:r.redirect,credentials:r.credentials,referrer:r.referrer,integrity:r.integrity,timeout:r.timeout})}let a=ue(o).pipe(Ai(c=>this.handler.handle(c)));if(t instanceof ia||r.observe==="events")return a;let u=a.pipe(Mt(c=>c instanceof cl));switch(r.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return u.pipe(he(c=>{if(c.body!==null&&!(c.body instanceof ArrayBuffer))throw new z(2806,!1);return c.body}));case"blob":return u.pipe(he(c=>{if(c.body!==null&&!(c.body instanceof Blob))throw new z(2807,!1);return c.body}));case"text":return u.pipe(he(c=>{if(c.body!==null&&typeof c.body!="string")throw new z(2808,!1);return c.body}));case"json":default:return u.pipe(he(c=>c.body))}case"response":return u;default:throw new z(2809,!1)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:new _e().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,eh(r,i))}post(t,i,r={}){return this.request("POST",t,eh(r,i))}put(t,i,r={}){return this.request("PUT",t,eh(r,i))}static \u0275fac=function(i){return new(i||n)(ae(oa))};static \u0275prov=Z({token:n,factory:n.\u0275fac})}return n})();var FA=new ne("");function ib(n,e){return e(n)}function PA(n,e){return(t,i)=>e.intercept(t,{handle:r=>n(r,i)})}function kA(n,e,t){return(i,r)=>Rt(t,()=>e(i,o=>n(o,r)))}var bc=new ne(""),nh=new ne(""),rb=new ne(""),ih=new ne("",{providedIn:"root",factory:()=>!0});function VA(){let n=null;return(e,t)=>{n===null&&(n=(P(bc,{optional:!0})??[]).reduceRight(PA,ib));let i=P(zo);if(P(ih)){let o=i.add();return n(e,t).pipe(tr(o))}else return n(e,t)}}var xc=(()=>{class n extends oa{backend;injector;chain=null;pendingTasks=P(zo);contributeToStability=P(ih);constructor(t,i){super(),this.backend=t,this.injector=i}handle(t){if(this.chain===null){let i=Array.from(new Set([...this.injector.get(nh),...this.injector.get(rb,[])]));this.chain=i.reduceRight((r,o)=>kA(r,o,this.injector),ib)}if(this.contributeToStability){let i=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(tr(i))}else return this.chain(t,i=>this.backend.handle(i))}static \u0275fac=function(i){return new(i||n)(ae(dl),ae(St))};static \u0275prov=Z({token:n,factory:n.\u0275fac})}return n})();var OA=/^\)\]\}',?\n/,LA=RegExp(`^${eb}:`,"m");function BA(n){return"responseURL"in n&&n.responseURL?n.responseURL:LA.test(n.getAllResponseHeaders())?n.getResponseHeader(eb):null}var th=(()=>{class n{xhrFactory;constructor(t){this.xhrFactory=t}handle(t){if(t.method==="JSONP")throw new z(-2800,!1);let i=this.xhrFactory;return ue(null).pipe(zt(()=>new Te(o=>{let a=i.build();if(a.open(t.method,t.urlWithParams),t.withCredentials&&(a.withCredentials=!0),t.headers.forEach((N,F)=>a.setRequestHeader(N,F.join(","))),t.headers.has(Zx)||a.setRequestHeader(Zx,AA),!t.headers.has(Qx)){let N=t.detectContentTypeHeader();N!==null&&a.setRequestHeader(Qx,N)}if(t.timeout&&(a.timeout=t.timeout),t.responseType){let N=t.responseType.toLowerCase();a.responseType=N!=="json"?N:"text"}let u=t.serializeBody(),c=null,m=()=>{if(c!==null)return c;let N=a.statusText||"OK",F=new Ot(a.getAllResponseHeaders()),$=BA(a)||t.url;return c=new Cc({headers:F,status:a.status,statusText:N,url:$}),c},h=()=>{let{headers:N,status:F,statusText:$,url:q}=m(),Q=null;F!==NA&&(Q=typeof a.response>"u"?a.responseText:a.response),F===0&&(F=Q?RA:0);let ie=F>=200&&F<300;if(t.responseType==="json"&&typeof Q=="string"){let de=Q;Q=Q.replace(OA,"");try{Q=Q!==""?JSON.parse(Q):null}catch(le){Q=de,ie&&(ie=!1,Q={error:le,text:Q})}}ie?(o.next(new cl({body:Q,headers:N,status:F,statusText:$,url:q||void 0})),o.complete()):o.error(new ra({error:Q,headers:N,status:F,statusText:$,url:q||void 0}))},y=N=>{let{url:F}=m(),$=new ra({error:N,status:a.status||0,statusText:a.statusText||"Unknown Error",url:F||void 0});o.error($)},v=y;t.timeout&&(v=N=>{let{url:F}=m(),$=new ra({error:new DOMException("Request timed out","TimeoutError"),status:a.status||0,statusText:a.statusText||"Request timeout",url:F||void 0});o.error($)});let C=!1,T=N=>{C||(o.next(m()),C=!0);let F={type:no.DownloadProgress,loaded:N.loaded};N.lengthComputable&&(F.total=N.total),t.responseType==="text"&&a.responseText&&(F.partialText=a.responseText),o.next(F)},R=N=>{let F={type:no.UploadProgress,loaded:N.loaded};N.lengthComputable&&(F.total=N.total),o.next(F)};return a.addEventListener("load",h),a.addEventListener("error",y),a.addEventListener("timeout",v),a.addEventListener("abort",y),t.reportProgress&&(a.addEventListener("progress",T),u!==null&&a.upload&&a.upload.addEventListener("progress",R)),a.send(u),o.next({type:no.Sent}),()=>{a.removeEventListener("error",y),a.removeEventListener("abort",y),a.removeEventListener("load",h),a.removeEventListener("timeout",v),t.reportProgress&&(a.removeEventListener("progress",T),u!==null&&a.upload&&a.upload.removeEventListener("progress",R)),a.readyState!==a.DONE&&a.abort()}})))}static \u0275fac=function(i){return new(i||n)(ae(to))};static \u0275prov=Z({token:n,factory:n.\u0275fac})}return n})(),ob=new ne(""),UA="XSRF-TOKEN",$A=new ne("",{providedIn:"root",factory:()=>UA}),HA="X-XSRF-TOKEN",GA=new ne("",{providedIn:"root",factory:()=>HA}),ml=class{},qA=(()=>{class n{doc;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(t,i){this.doc=t,this.cookieName=i}getToken(){let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=ol(t,this.cookieName),this.lastCookieString=t),this.lastToken}static \u0275fac=function(i){return new(i||n)(ae(Nt),ae($A))};static \u0275prov=Z({token:n,factory:n.\u0275fac})}return n})(),WA=/^(?:https?:)?\/\//i;function jA(n,e){if(!P(ob)||n.method==="GET"||n.method==="HEAD"||WA.test(n.url))return e(n);let t=P(ml).getToken(),i=P(GA);return t!=null&&!n.headers.has(i)&&(n=n.clone({headers:n.headers.set(i,t)})),e(n)}var rh=(function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n})(rh||{});function zA(n,e){return{\u0275kind:n,\u0275providers:e}}function oh(...n){let e=[Zt,th,xc,{provide:oa,useExisting:xc},{provide:dl,useFactory:()=>P(FA,{optional:!0})??P(th)},{provide:nh,useValue:jA,multi:!0},{provide:ob,useValue:!0},{provide:ml,useClass:qA}];for(let t of n)e.push(...t.\u0275providers);return kr(e)}var Xx=new ne("");function ah(){return zA(rh.LegacyInterceptors,[{provide:Xx,useFactory:VA},{provide:nh,useExisting:Xx,multi:!0}])}var ab=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(i){return new(i||n)(ae(Nt))};static \u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Ce="primary",Tl=Symbol("RouteTitle"),mh=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function oo(n){return new mh(n)}function fb(n,e,t){let i=t.path.split("/");if(i.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||i.length<n.length))return null;let r={};for(let o=0;o<i.length;o++){let a=i[o],u=n[o];if(a[0]===":")r[a.substring(1)]=u;else if(a!==u.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function JA(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Ei(n[t],e[t]))return!1;return!0}function Ei(n,e){let t=n?ph(n):void 0,i=e?ph(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let o=0;o<t.length;o++)if(r=t[o],!gb(n[r],e[r]))return!1;return!0}function ph(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function gb(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),i=[...e].sort();return t.every((r,o)=>i[o]===r)}else return n===e}function hb(n){return n.length>0?n[n.length-1]:null}function Ji(n){return qp(n)?n:hr(n)?at(Promise.resolve(n)):ue(n)}var KA={exact:_b,subset:vb},yb={exact:QA,subset:ZA,ignored:()=>!0};function sb(n,e,t){return KA[t.paths](n.root,e.root,t.matrixParams)&&yb[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function QA(n,e){return Ei(n,e)}function _b(n,e,t){if(!io(n.segments,e.segments)||!Dc(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let i in e.children)if(!n.children[i]||!_b(n.children[i],e.children[i],t))return!1;return!0}function ZA(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>gb(n[t],e[t]))}function vb(n,e,t){return Cb(n,e,e.segments,t)}function Cb(n,e,t,i){if(n.segments.length>t.length){let r=n.segments.slice(0,t.length);return!(!io(r,t)||e.hasChildren()||!Dc(r,t,i))}else if(n.segments.length===t.length){if(!io(n.segments,t)||!Dc(n.segments,t,i))return!1;for(let r in e.children)if(!n.children[r]||!vb(n.children[r],e.children[r],i))return!1;return!0}else{let r=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!io(n.segments,r)||!Dc(n.segments,r,i)||!n.children[Ce]?!1:Cb(n.children[Ce],e,o,i)}}function Dc(n,e,t){return e.every((i,r)=>yb[t](n[r].parameters,i.parameters))}var Di=class{root;queryParams;fragment;_queryParamMap;constructor(e=new He([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=oo(this.queryParams),this._queryParamMap}toString(){return t5.serialize(this)}},He=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return wc(this)}},_r=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=oo(this.parameters),this._parameterMap}toString(){return bb(this)}};function XA(n,e){return io(n,e)&&n.every((t,i)=>Ei(t.parameters,e[i].parameters))}function io(n,e){return n.length!==e.length?!1:n.every((t,i)=>t.path===e[i].path)}function e5(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===Ce&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==Ce&&(t=t.concat(e(r,i)))}),t}var Il=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=Z({token:n,factory:()=>new ao,providedIn:"root"})}return n})(),ao=class{parse(e){let t=new gh(e);return new Di(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${pl(e.root,!0)}`,i=r5(e.queryParams),r=typeof e.fragment=="string"?`#${n5(e.fragment)}`:"";return`${t}${i}${r}`}},t5=new ao;function wc(n){return n.segments.map(e=>bb(e)).join("/")}function pl(n,e){if(!n.hasChildren())return wc(n);if(e){let t=n.children[Ce]?pl(n.children[Ce],!1):"",i=[];return Object.entries(n.children).forEach(([r,o])=>{r!==Ce&&i.push(`${r}:${pl(o,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}else{let t=e5(n,(i,r)=>r===Ce?[pl(n.children[Ce],!1)]:[`${r}:${pl(i,!1)}`]);return Object.keys(n.children).length===1&&n.children[Ce]!=null?`${wc(n)}/${t[0]}`:`${wc(n)}/(${t.join("//")})`}}function xb(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Ec(n){return xb(n).replace(/%3B/gi,";")}function n5(n){return encodeURI(n)}function fh(n){return xb(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Tc(n){return decodeURIComponent(n)}function lb(n){return Tc(n.replace(/\+/g,"%20"))}function bb(n){return`${fh(n.path)}${i5(n.parameters)}`}function i5(n){return Object.entries(n).map(([e,t])=>`;${fh(e)}=${fh(t)}`).join("")}function r5(n){let e=Object.entries(n).map(([t,i])=>Array.isArray(i)?i.map(r=>`${Ec(t)}=${Ec(r)}`).join("&"):`${Ec(t)}=${Ec(i)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var o5=/^[^\/()?;#]+/;function lh(n){let e=n.match(o5);return e?e[0]:""}var a5=/^[^\/()?;=#]+/;function s5(n){let e=n.match(a5);return e?e[0]:""}var l5=/^[^=?&#]+/;function u5(n){let e=n.match(l5);return e?e[0]:""}var d5=/^[^&#]+/;function c5(n){let e=n.match(d5);return e?e[0]:""}var gh=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new He([],{}):new He([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Ce]=new He(e,t)),i}parseSegment(){let e=lh(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new z(4009,!1);return this.capture(e),new _r(Tc(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=s5(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let r=lh(this.remaining);r&&(i=r,this.capture(i))}e[Tc(t)]=Tc(i)}parseQueryParam(e){let t=u5(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let a=c5(this.remaining);a&&(i=a,this.capture(i))}let r=lb(t),o=lb(i);if(e.hasOwnProperty(r)){let a=e[r];Array.isArray(a)||(a=[a],e[r]=a),a.push(o)}else e[r]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=lh(this.remaining),r=this.remaining[i.length];if(r!=="/"&&r!==")"&&r!==";")throw new z(4010,!1);let o;i.indexOf(":")>-1?(o=i.slice(0,i.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=Ce);let a=this.parseChildren();t[o??Ce]=Object.keys(a).length===1&&a[Ce]?a[Ce]:new He([],a),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new z(4011,!1)}};function Eb(n){return n.segments.length>0?new He([],{[Ce]:n}):n}function Sb(n){let e={};for(let[i,r]of Object.entries(n.children)){let o=Sb(r);if(i===Ce&&o.segments.length===0&&o.hasChildren())for(let[a,u]of Object.entries(o.children))e[a]=u;else(o.segments.length>0||o.hasChildren())&&(e[i]=o)}let t=new He(n.segments,e);return m5(t)}function m5(n){if(n.numberOfChildren===1&&n.children[Ce]){let e=n.children[Ce];return new He(n.segments.concat(e.segments),e.children)}return n}function vr(n){return n instanceof Di}function Db(n,e,t=null,i=null){let r=wb(n);return Tb(r,e,t,i)}function wb(n){let e;function t(o){let a={};for(let c of o.children){let m=t(c);a[c.outlet]=m}let u=new He(o.url,a);return o===n&&(e=u),u}let i=t(n.root),r=Eb(i);return e??r}function Tb(n,e,t,i){let r=n;for(;r.parent;)r=r.parent;if(e.length===0)return uh(r,r,r,t,i);let o=p5(e);if(o.toRoot())return uh(r,r,new He([],{}),t,i);let a=f5(o,r,n),u=a.processChildren?gl(a.segmentGroup,a.index,o.commands):Mb(a.segmentGroup,a.index,o.commands);return uh(r,a.segmentGroup,u,t,i)}function Ic(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function _l(n){return typeof n=="object"&&n!=null&&n.outlets}function uh(n,e,t,i,r){let o={};i&&Object.entries(i).forEach(([c,m])=>{o[c]=Array.isArray(m)?m.map(h=>`${h}`):`${m}`});let a;n===e?a=t:a=Ib(n,e,t);let u=Eb(Sb(a));return new Di(u,o,r)}function Ib(n,e,t){let i={};return Object.entries(n.children).forEach(([r,o])=>{o===e?i[r]=t:i[r]=Ib(o,e,t)}),new He(n.segments,i)}var Mc=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Ic(i[0]))throw new z(4003,!1);let r=i.find(_l);if(r&&r!==hb(i))throw new z(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function p5(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Mc(!0,0,n);let e=0,t=!1,i=n.reduce((r,o,a)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let u={};return Object.entries(o.outlets).forEach(([c,m])=>{u[c]=typeof m=="string"?m.split("/"):m}),[...r,{outlets:u}]}if(o.segmentPath)return[...r,o.segmentPath]}return typeof o!="string"?[...r,o]:a===0?(o.split("/").forEach((u,c)=>{c==0&&u==="."||(c==0&&u===""?t=!0:u===".."?e++:u!=""&&r.push(u))}),r):[...r,o]},[]);return new Mc(t,e,i)}var ua=class{segmentGroup;processChildren;index;constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}};function f5(n,e,t){if(n.isAbsolute)return new ua(e,!0,0);if(!t)return new ua(e,!1,NaN);if(t.parent===null)return new ua(t,!0,0);let i=Ic(n.commands[0])?0:1,r=t.segments.length-1+i;return g5(t,r,n.numberOfDoubleDots)}function g5(n,e,t){let i=n,r=e,o=t;for(;o>r;){if(o-=r,i=i.parent,!i)throw new z(4005,!1);r=i.segments.length}return new ua(i,!1,r-o)}function h5(n){return _l(n[0])?n[0].outlets:{[Ce]:n}}function Mb(n,e,t){if(n??=new He([],{}),n.segments.length===0&&n.hasChildren())return gl(n,e,t);let i=y5(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){let o=new He(n.segments.slice(0,i.pathIndex),{});return o.children[Ce]=new He(n.segments.slice(i.pathIndex),n.children),gl(o,0,r)}else return i.match&&r.length===0?new He(n.segments,{}):i.match&&!n.hasChildren()?hh(n,e,t):i.match?gl(n,0,r):hh(n,e,t)}function gl(n,e,t){if(t.length===0)return new He(n.segments,{});{let i=h5(t),r={};if(Object.keys(i).some(o=>o!==Ce)&&n.children[Ce]&&n.numberOfChildren===1&&n.children[Ce].segments.length===0){let o=gl(n.children[Ce],e,t);return new He(n.segments,o.children)}return Object.entries(i).forEach(([o,a])=>{typeof a=="string"&&(a=[a]),a!==null&&(r[o]=Mb(n.children[o],e,a))}),Object.entries(n.children).forEach(([o,a])=>{i[o]===void 0&&(r[o]=a)}),new He(n.segments,r)}}function y5(n,e,t){let i=0,r=e,o={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return o;let a=n.segments[r],u=t[i];if(_l(u))break;let c=`${u}`,m=i<t.length-1?t[i+1]:null;if(r>0&&c===void 0)break;if(c&&m&&typeof m=="object"&&m.outlets===void 0){if(!db(c,m,a))return o;i+=2}else{if(!db(c,{},a))return o;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}function hh(n,e,t){let i=n.segments.slice(0,e),r=0;for(;r<t.length;){let o=t[r];if(_l(o)){let c=_5(o.outlets);return new He(i,c)}if(r===0&&Ic(t[0])){let c=n.segments[e];i.push(new _r(c.path,ub(t[0]))),r++;continue}let a=_l(o)?o.outlets[Ce]:`${o}`,u=r<t.length-1?t[r+1]:null;a&&u&&Ic(u)?(i.push(new _r(a,ub(u))),r+=2):(i.push(new _r(a,{})),r++)}return new He(i,{})}function _5(n){let e={};return Object.entries(n).forEach(([t,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(e[t]=hh(new He([],{}),0,i))}),e}function ub(n){let e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function db(n,e,t){return n==t.path&&Ei(e,t.parameters)}var hl="imperative",Lt=(function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n})(Lt||{}),In=class{id;url;constructor(e,t){this.id=e,this.url=t}},so=class extends In{type=Lt.NavigationStart;navigationTrigger;restoredState;constructor(e,t,i="imperative",r=null){super(e,t),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Mn=class extends In{urlAfterRedirects;type=Lt.NavigationEnd;constructor(e,t,i){super(e,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},ln=(function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n[n.Aborted=4]="Aborted",n})(ln||{}),vl=(function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n})(vl||{}),Si=class extends In{reason;code;type=Lt.NavigationCancel;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Yi=class extends In{reason;code;type=Lt.NavigationSkipped;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}},ca=class extends In{error;target;type=Lt.NavigationError;constructor(e,t,i,r){super(e,t),this.error=i,this.target=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Cl=class extends In{urlAfterRedirects;state;type=Lt.RoutesRecognized;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ac=class extends In{urlAfterRedirects;state;type=Lt.GuardsCheckStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Rc=class extends In{urlAfterRedirects;state;shouldActivate;type=Lt.GuardsCheckEnd;constructor(e,t,i,r,o){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Nc=class extends In{urlAfterRedirects;state;type=Lt.ResolveStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Fc=class extends In{urlAfterRedirects;state;type=Lt.ResolveEnd;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Pc=class{route;type=Lt.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},kc=class{route;type=Lt.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Vc=class{snapshot;type=Lt.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Oc=class{snapshot;type=Lt.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Lc=class{snapshot;type=Lt.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Bc=class{snapshot;type=Lt.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var xl=class{},ma=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function v5(n){return!(n instanceof xl)&&!(n instanceof ma)}function C5(n,e){return n.providers&&!n._injector&&(n._injector=Ys(n.providers,e,`Route: ${n.path}`)),n._injector??e}function oi(n){return n.outlet||Ce}function x5(n,e){let t=n.filter(i=>oi(i)===e);return t.push(...n.filter(i=>oi(i)!==e)),t}function ga(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Uc=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return ga(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new ha(this.rootInjector)}},ha=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,i){let r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){let i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new Uc(this.rootInjector),this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(i){return new(i||n)(ae(St))};static \u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),$c=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=yh(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){let t=yh(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=_h(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return _h(e,this._root).map(t=>t.value)}};function yh(n,e){if(n===e.value)return e;for(let t of e.children){let i=yh(n,t);if(i)return i}return null}function _h(n,e){if(n===e.value)return[e];for(let t of e.children){let i=_h(n,t);if(i.length)return i.unshift(e),i}return[]}var Tn=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function la(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var bl=class extends $c{snapshot;constructor(e,t){super(e),this.snapshot=t,wh(this,e)}toString(){return this.snapshot.toString()}};function Ab(n){let e=b5(n),t=new Ut([new _r("",{})]),i=new Ut({}),r=new Ut({}),o=new Ut({}),a=new Ut(""),u=new un(t,i,o,a,r,Ce,n,e.root);return u.snapshot=e.root,new bl(new Tn(u,[]),e)}function b5(n){let e={},t={},i={},o=new ro([],e,i,"",t,Ce,n,null,{});return new El("",new Tn(o,[]))}var un=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,i,r,o,a,u,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=o,this.outlet=a,this.component=u,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(he(m=>m[Tl]))??ue(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(he(e=>oo(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(he(e=>oo(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Hc(n,e,t="emptyOnly"){let i,{routeConfig:r}=n;return e!==null&&(t==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?i={params:V(V({},e.params),n.params),data:V(V({},e.data),n.data),resolve:V(V(V(V({},n.data),e.data),r?.data),n._resolvedData)}:i={params:V({},n.params),data:V({},n.data),resolve:V(V({},n.data),n._resolvedData??{})},r&&Nb(r)&&(i.resolve[Tl]=r.title),i}var ro=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Tl]}constructor(e,t,i,r,o,a,u,c,m){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o,this.outlet=a,this.component=u,this.routeConfig=c,this._resolve=m}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=oo(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=oo(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(i=>i.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},El=class extends $c{url;constructor(e,t){super(t),this.url=e,wh(this,t)}toString(){return Rb(this._root)}};function wh(n,e){e.value._routerState=n,e.children.forEach(t=>wh(n,t))}function Rb(n){let e=n.children.length>0?` { ${n.children.map(Rb).join(", ")} } `:"";return`${n.value}${e}`}function dh(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Ei(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Ei(e.params,t.params)||n.paramsSubject.next(t.params),JA(e.url,t.url)||n.urlSubject.next(t.url),Ei(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function vh(n,e){let t=Ei(n.params,e.params)&&XA(n.url,e.url),i=!n.parent!=!e.parent;return t&&!i&&(!n.parent||vh(n.parent,e.parent))}function Nb(n){return typeof n.title=="string"||n.title===null}var Fb=new ne(""),Ml=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=Ce;activateEvents=new lt;deactivateEvents=new lt;attachEvents=new lt;detachEvents=new lt;routerOutletData=ec();parentContexts=P(ha);location=P(Hi);changeDetector=P(yr);inputBinder=P(jc,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new z(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new z(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new z(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new z(4013,!1);this._activatedRoute=t;let r=this.location,a=t.snapshot.component,u=this.parentContexts.getOrCreateContext(this.name).children,c=new Ch(t,u,r.injector,this.routerOutletData);this.activated=r.createComponent(a,{index:r.length,injector:c,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(i){return new(i||n)};static \u0275dir=Ae({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Un]})}return n})(),Ch=class{route;childContexts;parent;outletData;constructor(e,t,i,r){this.route=e,this.childContexts=t,this.parent=i,this.outletData=r}get(e,t){return e===un?this.route:e===ha?this.childContexts:e===Fb?this.outletData:this.parent.get(e,t)}},jc=new ne("");var Th=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=re({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(i,r){i&1&&x(0,"router-outlet")},dependencies:[Ml],encapsulation:2})}return n})();function Ih(n){let e=n.children&&n.children.map(Ih),t=e?G(V({},n),{children:e}):V({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Ce&&(t.component=Th),t}function E5(n,e,t){let i=Sl(n,e._root,t?t._root:void 0);return new bl(i,e)}function Sl(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let i=t.value;i._futureSnapshot=e.value;let r=S5(n,e,t);return new Tn(i,r)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let a=o.route;return a.value._futureSnapshot=e.value,a.children=e.children.map(u=>Sl(n,u)),a}}let i=D5(e.value),r=e.children.map(o=>Sl(n,o));return new Tn(i,r)}}function S5(n,e,t){return e.children.map(i=>{for(let r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return Sl(n,i,r);return Sl(n,i)})}function D5(n){return new un(new Ut(n.url),new Ut(n.params),new Ut(n.queryParams),new Ut(n.fragment),new Ut(n.data),n.outlet,n.component,n)}var pa=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},Pb="ngNavigationCancelingError";function Gc(n,e){let{redirectTo:t,navigationBehaviorOptions:i}=vr(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=kb(!1,ln.Redirect);return r.url=t,r.navigationBehaviorOptions=i,r}function kb(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[Pb]=!0,t.cancellationCode=e,t}function w5(n){return Vb(n)&&vr(n.url)}function Vb(n){return!!n&&n[Pb]}var T5=(n,e,t,i)=>he(r=>(new xh(e,r.targetRouterState,r.currentRouterState,t,i).activate(n),r)),xh=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,i,r,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),dh(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){let r=la(t);e.children.forEach(o=>{let a=o.value.outlet;this.deactivateRoutes(o,r[a],i),delete r[a]}),Object.values(r).forEach(o=>{this.deactivateRouteAndItsChildren(o,i)})}deactivateRoutes(e,t,i){let r=e.value,o=t?t.value:null;if(r===o)if(r.component){let a=i.getContext(r.outlet);a&&this.deactivateChildRoutes(e,t,a.children)}else this.deactivateChildRoutes(e,t,i);else o&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=la(e);for(let a of Object.values(o))this.deactivateRouteAndItsChildren(a,r);if(i&&i.outlet){let a=i.outlet.detach(),u=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:a,route:e,contexts:u})}}deactivateRouteAndOutlet(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=la(e);for(let a of Object.values(o))this.deactivateRouteAndItsChildren(a,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){let r=la(t);e.children.forEach(o=>{this.activateRoutes(o,r[o.value.outlet],i),this.forwardEvent(new Bc(o.value.snapshot))}),e.children.length&&this.forwardEvent(new Oc(e.value.snapshot))}activateRoutes(e,t,i){let r=e.value,o=t?t.value:null;if(dh(r),r===o)if(r.component){let a=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,a.children)}else this.activateChildRoutes(e,t,i);else if(r.component){let a=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let u=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),a.children.onOutletReAttached(u.contexts),a.attachRef=u.componentRef,a.route=u.route.value,a.outlet&&a.outlet.attach(u.componentRef,u.route.value),dh(u.route.value),this.activateChildRoutes(e,null,a.children)}else a.attachRef=null,a.route=r,a.outlet&&a.outlet.activateWith(r,a.injector),this.activateChildRoutes(e,null,a.children)}else this.activateChildRoutes(e,null,i)}},qc=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},da=class{component;route;constructor(e,t){this.component=e,this.route=t}};function I5(n,e,t){let i=n._root,r=e?e._root:null;return fl(i,r,t,[i.value])}function M5(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function ya(n,e){let t=Symbol(),i=e.get(n,t);return i===t?typeof n=="function"&&!a0(n)?n:e.get(n):i}function fl(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=la(e);return n.children.forEach(a=>{A5(a,o[a.value.outlet],t,i.concat([a.value]),r),delete o[a.value.outlet]}),Object.entries(o).forEach(([a,u])=>yl(u,t.getContext(a),r)),r}function A5(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,a=e?e.value:null,u=t?t.getContext(n.value.outlet):null;if(a&&o.routeConfig===a.routeConfig){let c=R5(a,o,o.routeConfig.runGuardsAndResolvers);c?r.canActivateChecks.push(new qc(i)):(o.data=a.data,o._resolvedData=a._resolvedData),o.component?fl(n,e,u?u.children:null,i,r):fl(n,e,t,i,r),c&&u&&u.outlet&&u.outlet.isActivated&&r.canDeactivateChecks.push(new da(u.outlet.component,a))}else a&&yl(e,u,r),r.canActivateChecks.push(new qc(i)),o.component?fl(n,null,u?u.children:null,i,r):fl(n,null,t,i,r);return r}function R5(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!io(n.url,e.url);case"pathParamsOrQueryParamsChange":return!io(n.url,e.url)||!Ei(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!vh(n,e)||!Ei(n.queryParams,e.queryParams);case"paramsChange":default:return!vh(n,e)}}function yl(n,e,t){let i=la(n),r=n.value;Object.entries(i).forEach(([o,a])=>{r.component?e?yl(a,e.children.getContext(o),t):yl(a,null,t):yl(a,e,t)}),r.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new da(e.outlet.component,r)):t.canDeactivateChecks.push(new da(null,r)):t.canDeactivateChecks.push(new da(null,r))}function Al(n){return typeof n=="function"}function N5(n){return typeof n=="boolean"}function F5(n){return n&&Al(n.canLoad)}function P5(n){return n&&Al(n.canActivate)}function k5(n){return n&&Al(n.canActivateChild)}function V5(n){return n&&Al(n.canDeactivate)}function O5(n){return n&&Al(n.canMatch)}function Ob(n){return n instanceof jn||n?.name==="EmptyError"}var Sc=Symbol("INITIAL_VALUE");function fa(){return zt(n=>Fu(n.map(e=>e.pipe(Ri(1),Yp(Sc)))).pipe(he(e=>{for(let t of e)if(t!==!0){if(t===Sc)return Sc;if(t===!1||L5(t))return t}return!0}),Mt(e=>e!==Sc),Ri(1)))}function L5(n){return vr(n)||n instanceof pa}function B5(n,e){return Et(t=>{let{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:o,canDeactivateChecks:a}}=t;return a.length===0&&o.length===0?ue(G(V({},t),{guardsResult:!0})):U5(a,i,r,n).pipe(Et(u=>u&&N5(u)?$5(i,o,n,e):ue(u)),he(u=>G(V({},t),{guardsResult:u})))})}function U5(n,e,t,i){return at(n).pipe(Et(r=>j5(r.component,r.route,t,e,i)),Ni(r=>r!==!0,!0))}function $5(n,e,t,i){return at(e).pipe(Ai(r=>ko(G5(r.route.parent,i),H5(r.route,i),W5(n,r.path,t),q5(n,r.route,t))),Ni(r=>r!==!0,!0))}function H5(n,e){return n!==null&&e&&e(new Lc(n)),ue(!0)}function G5(n,e){return n!==null&&e&&e(new Vc(n)),ue(!0)}function q5(n,e,t){let i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||i.length===0)return ue(!0);let r=i.map(o=>ps(()=>{let a=ga(e)??t,u=ya(o,a),c=P5(u)?u.canActivate(e,n):Rt(a,()=>u(e,n));return Ji(c).pipe(Ni())}));return ue(r).pipe(fa())}function W5(n,e,t){let i=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(a=>M5(a)).filter(a=>a!==null).map(a=>ps(()=>{let u=a.guards.map(c=>{let m=ga(a.node)??t,h=ya(c,m),y=k5(h)?h.canActivateChild(i,n):Rt(m,()=>h(i,n));return Ji(y).pipe(Ni())});return ue(u).pipe(fa())}));return ue(o).pipe(fa())}function j5(n,e,t,i,r){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return ue(!0);let a=o.map(u=>{let c=ga(e)??r,m=ya(u,c),h=V5(m)?m.canDeactivate(n,e,t,i):Rt(c,()=>m(n,e,t,i));return Ji(h).pipe(Ni())});return ue(a).pipe(fa())}function z5(n,e,t,i){let r=e.canLoad;if(r===void 0||r.length===0)return ue(!0);let o=r.map(a=>{let u=ya(a,n),c=F5(u)?u.canLoad(e,t):Rt(n,()=>u(e,t));return Ji(c)});return ue(o).pipe(fa(),Lb(i))}function Lb(n){return Up(et(e=>{if(typeof e!="boolean")throw Gc(n,e)}),he(e=>e===!0))}function Y5(n,e,t,i){let r=e.canMatch;if(!r||r.length===0)return ue(!0);let o=r.map(a=>{let u=ya(a,n),c=O5(u)?u.canMatch(e,t):Rt(n,()=>u(e,t));return Ji(c)});return ue(o).pipe(fa(),Lb(i))}var Dl=class{segmentGroup;constructor(e){this.segmentGroup=e||null}},wl=class extends Error{urlTree;constructor(e){super(),this.urlTree=e}};function sa(n){return Mi(new Dl(n))}function J5(n){return Mi(new z(4e3,!1))}function K5(n){return Mi(kb(!1,ln.GuardRejected))}var bh=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),r.numberOfChildren===0)return ue(i);if(r.numberOfChildren>1||!r.children[Ce])return J5(`${e.redirectTo}`);r=r.children[Ce]}}applyRedirectCommands(e,t,i,r,o){return Q5(t,r,o).pipe(he(a=>{if(a instanceof Di)throw new wl(a);let u=this.applyRedirectCreateUrlTree(a,this.urlSerializer.parse(a),e,i);if(a[0]==="/")throw new wl(u);return u}))}applyRedirectCreateUrlTree(e,t,i,r){let o=this.createSegmentGroup(e,t.root,i,r);return new Di(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let i={};return Object.entries(e).forEach(([r,o])=>{if(typeof o=="string"&&o[0]===":"){let u=o.substring(1);i[r]=t[u]}else i[r]=o}),i}createSegmentGroup(e,t,i,r){let o=this.createSegments(e,t.segments,i,r),a={};return Object.entries(t.children).forEach(([u,c])=>{a[u]=this.createSegmentGroup(e,c,i,r)}),new He(o,a)}createSegments(e,t,i,r){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,r):this.findOrReturn(o,i))}findPosParam(e,t,i){let r=i[t.path.substring(1)];if(!r)throw new z(4001,!1);return r}findOrReturn(e,t){let i=0;for(let r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}};function Q5(n,e,t){if(typeof n=="string")return ue(n);let i=n,{queryParams:r,fragment:o,routeConfig:a,url:u,outlet:c,params:m,data:h,title:y}=e;return Ji(Rt(t,()=>i({params:m,data:h,queryParams:r,fragment:o,routeConfig:a,url:u,outlet:c,title:y})))}var Eh={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Z5(n,e,t,i,r){let o=Bb(n,e,t);return o.matched?(i=C5(e,i),Y5(i,e,t,r).pipe(he(a=>a===!0?o:V({},Eh)))):ue(o)}function Bb(n,e,t){if(e.path==="**")return X5(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?V({},Eh):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let r=(e.matcher||fb)(t,n,e);if(!r)return V({},Eh);let o={};Object.entries(r.posParams??{}).forEach(([u,c])=>{o[u]=c.path});let a=r.consumed.length>0?V(V({},o),r.consumed[r.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:a,positionalParamSegments:r.posParams??{}}}function X5(n){return{matched:!0,parameters:n.length>0?hb(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function cb(n,e,t,i){return t.length>0&&n3(n,t,i)?{segmentGroup:new He(e,t3(i,new He(t,n.children))),slicedSegments:[]}:t.length===0&&i3(n,t,i)?{segmentGroup:new He(n.segments,e3(n,t,i,n.children)),slicedSegments:t}:{segmentGroup:new He(n.segments,n.children),slicedSegments:t}}function e3(n,e,t,i){let r={};for(let o of t)if(zc(n,e,o)&&!i[oi(o)]){let a=new He([],{});r[oi(o)]=a}return V(V({},i),r)}function t3(n,e){let t={};t[Ce]=e;for(let i of n)if(i.path===""&&oi(i)!==Ce){let r=new He([],{});t[oi(i)]=r}return t}function n3(n,e,t){return t.some(i=>zc(n,e,i)&&oi(i)!==Ce)}function i3(n,e,t){return t.some(i=>zc(n,e,i))}function zc(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function r3(n,e,t){return e.length===0&&!n.children[t]}var Sh=class{};function o3(n,e,t,i,r,o,a="emptyOnly"){return new Dh(n,e,t,i,r,a,o).recognize()}var a3=31,Dh=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,i,r,o,a,u){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=o,this.paramsInheritanceStrategy=a,this.urlSerializer=u,this.applyRedirects=new bh(this.urlSerializer,this.urlTree)}noMatchError(e){return new z(4002,`'${e.segmentGroup}'`)}recognize(){let e=cb(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(he(({children:t,rootSnapshot:i})=>{let r=new Tn(i,t),o=new El("",r),a=Db(i,[],this.urlTree.queryParams,this.urlTree.fragment);return a.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(a),{state:o,tree:a}}))}match(e){let t=new ro([],Object.freeze({}),Object.freeze(V({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Ce,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,Ce,t).pipe(he(i=>({children:i,rootSnapshot:t})),zn(i=>{if(i instanceof wl)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof Dl?this.noMatchError(i):i}))}processSegmentGroup(e,t,i,r,o){return i.segments.length===0&&i.hasChildren()?this.processChildren(e,t,i,o):this.processSegment(e,t,i,i.segments,r,!0,o).pipe(he(a=>a instanceof Tn?[a]:[]))}processChildren(e,t,i,r){let o=[];for(let a of Object.keys(i.children))a==="primary"?o.unshift(a):o.push(a);return at(o).pipe(Ai(a=>{let u=i.children[a],c=x5(t,a);return this.processSegmentGroup(e,c,u,a,r)}),zp((a,u)=>(a.push(...u),a)),er(null),jp(),Et(a=>{if(a===null)return sa(i);let u=Ub(a);return s3(u),ue(u)}))}processSegment(e,t,i,r,o,a,u){return at(t).pipe(Ai(c=>this.processSegmentAgainstRoute(c._injector??e,t,c,i,r,o,a,u).pipe(zn(m=>{if(m instanceof Dl)return ue(null);throw m}))),Ni(c=>!!c),zn(c=>{if(Ob(c))return r3(i,r,o)?ue(new Sh):sa(i);throw c}))}processSegmentAgainstRoute(e,t,i,r,o,a,u,c){return oi(i)!==a&&(a===Ce||!zc(r,o,i))?sa(r):i.redirectTo===void 0?this.matchSegmentAgainstRoute(e,r,i,o,a,c):this.allowRedirects&&u?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,o,a,c):sa(r)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,o,a,u){let{matched:c,parameters:m,consumedSegments:h,positionalParamSegments:y,remainingSegments:v}=Bb(t,r,o);if(!c)return sa(t);typeof r.redirectTo=="string"&&r.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>a3&&(this.allowRedirects=!1));let C=new ro(o,m,Object.freeze(V({},this.urlTree.queryParams)),this.urlTree.fragment,mb(r),oi(r),r.component??r._loadedComponent??null,r,pb(r)),T=Hc(C,u,this.paramsInheritanceStrategy);return C.params=Object.freeze(T.params),C.data=Object.freeze(T.data),this.applyRedirects.applyRedirectCommands(h,r.redirectTo,y,C,e).pipe(zt(N=>this.applyRedirects.lineralizeSegments(r,N)),Et(N=>this.processSegment(e,i,t,N.concat(v),a,!1,u)))}matchSegmentAgainstRoute(e,t,i,r,o,a){let u=Z5(t,i,r,e,this.urlSerializer);return i.path==="**"&&(t.children={}),u.pipe(zt(c=>c.matched?(e=i._injector??e,this.getChildConfig(e,i,r).pipe(zt(({routes:m})=>{let h=i._loadedInjector??e,{parameters:y,consumedSegments:v,remainingSegments:C}=c,T=new ro(v,y,Object.freeze(V({},this.urlTree.queryParams)),this.urlTree.fragment,mb(i),oi(i),i.component??i._loadedComponent??null,i,pb(i)),R=Hc(T,a,this.paramsInheritanceStrategy);T.params=Object.freeze(R.params),T.data=Object.freeze(R.data);let{segmentGroup:N,slicedSegments:F}=cb(t,v,C,m);if(F.length===0&&N.hasChildren())return this.processChildren(h,m,N,T).pipe(he(q=>new Tn(T,q)));if(m.length===0&&F.length===0)return ue(new Tn(T,[]));let $=oi(i)===o;return this.processSegment(h,m,N,F,$?Ce:o,!0,T).pipe(he(q=>new Tn(T,q instanceof Tn?[q]:[])))}))):sa(t)))}getChildConfig(e,t,i){return t.children?ue({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?ue({routes:t._loadedRoutes,injector:t._loadedInjector}):z5(e,t,i,this.urlSerializer).pipe(Et(r=>r?this.configLoader.loadChildren(e,t).pipe(et(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):K5(t))):ue({routes:[],injector:e})}};function s3(n){n.sort((e,t)=>e.value.outlet===Ce?-1:t.value.outlet===Ce?1:e.value.outlet.localeCompare(t.value.outlet))}function l3(n){let e=n.value.routeConfig;return e&&e.path===""}function Ub(n){let e=[],t=new Set;for(let i of n){if(!l3(i)){e.push(i);continue}let r=e.find(o=>i.value.routeConfig===o.value.routeConfig);r!==void 0?(r.children.push(...i.children),t.add(r)):e.push(i)}for(let i of t){let r=Ub(i.children);e.push(new Tn(i.value,r))}return e.filter(i=>!t.has(i))}function mb(n){return n.data||{}}function pb(n){return n.resolve||{}}function u3(n,e,t,i,r,o){return Et(a=>o3(n,e,t,i,a.extractedUrl,r,o).pipe(he(({state:u,tree:c})=>G(V({},a),{targetSnapshot:u,urlAfterRedirects:c}))))}function d3(n,e){return Et(t=>{let{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return ue(t);let o=new Set(r.map(c=>c.route)),a=new Set;for(let c of o)if(!a.has(c))for(let m of $b(c))a.add(m);let u=0;return at(a).pipe(Ai(c=>o.has(c)?c3(c,i,n,e):(c.data=Hc(c,c.parent,n).resolve,ue(void 0))),et(()=>u++),Vo(1),Et(c=>u===a.size?ue(t):mn))})}function $b(n){let e=n.children.map(t=>$b(t)).flat();return[n,...e]}function c3(n,e,t,i){let r=n.routeConfig,o=n._resolve;return r?.title!==void 0&&!Nb(r)&&(o[Tl]=r.title),ps(()=>(n.data=Hc(n,n.parent,t).resolve,m3(o,n,e,i).pipe(he(a=>(n._resolvedData=a,n.data=V(V({},n.data),a),null)))))}function m3(n,e,t,i){let r=ph(n);if(r.length===0)return ue({});let o={};return at(r).pipe(Et(a=>p3(n[a],e,t,i).pipe(Ni(),et(u=>{if(u instanceof pa)throw Gc(new ao,u);o[a]=u}))),Vo(1),he(()=>o),zn(a=>Ob(a)?mn:Mi(a)))}function p3(n,e,t,i){let r=ga(e)??i,o=ya(n,r),a=o.resolve?o.resolve(e,t):Rt(r,()=>o(e,t));return Ji(a)}function ch(n){return zt(e=>{let t=n(e);return t?at(t).pipe(he(()=>e)):ue(e)})}var Mh=(()=>{class n{buildTitle(t){let i,r=t.root;for(;r!==void 0;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(o=>o.outlet===Ce);return i}getResolvedTitleForRoute(t){return t.data[Tl]}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Z({token:n,factory:()=>P(Hb),providedIn:"root"})}return n})(),Hb=(()=>{class n extends Mh{title;constructor(t){super(),this.title=t}updateTitle(t){let i=this.buildTitle(t);i!==void 0&&this.title.setTitle(i)}static \u0275fac=function(i){return new(i||n)(ae(ab))};static \u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),_a=new ne("",{providedIn:"root",factory:()=>({})}),Rl=new ne(""),Gb=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=P(xg);loadComponent(t,i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return ue(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);let r=Ji(Rt(t,()=>i.loadComponent())).pipe(he(Wb),zt(jb),et(a=>{this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=a}),tr(()=>{this.componentLoaders.delete(i)})),o=new Fo(r,()=>new gt).pipe(No());return this.componentLoaders.set(i,o),o}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return ue({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=qb(i,this.compiler,t,this.onLoadEndListener).pipe(tr(()=>{this.childrenLoaders.delete(i)})),a=new Fo(o,()=>new gt).pipe(No());return this.childrenLoaders.set(i,a),a}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function qb(n,e,t,i){return Ji(Rt(t,()=>n.loadChildren())).pipe(he(Wb),zt(jb),Et(r=>r instanceof Wd||Array.isArray(r)?ue(r):at(e.compileModuleAsync(r))),he(r=>{i&&i(n);let o,a,u=!1;return Array.isArray(r)?(a=r,u=!0):(o=r.create(t).injector,a=o.get(Rl,[],{optional:!0,self:!0}).flat()),{routes:a.map(Ih),injector:o}}))}function f3(n){return n&&typeof n=="object"&&"default"in n}function Wb(n){return f3(n)?n.default:n}function jb(n){return ue(n)}var Yc=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=Z({token:n,factory:()=>P(g3),providedIn:"root"})}return n})(),g3=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),zb=new ne("");var Yb=new ne(""),Jb=(()=>{class n{currentNavigation=S(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=null;events=new gt;transitionAbortWithErrorSubject=new gt;configLoader=P(Gb);environmentInjector=P(St);destroyRef=P(Ln);urlSerializer=P(Il);rootContexts=P(ha);location=P(Xr);inputBindingEnabled=P(jc,{optional:!0})!==null;titleStrategy=P(Mh);options=P(_a,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=P(Yc);createViewTransition=P(zb,{optional:!0});navigationErrorHandler=P(Yb,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>ue(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=r=>this.events.next(new Pc(r)),i=r=>this.events.next(new kc(r));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let i=++this.navigationId;Pt(()=>{this.transitions?.next(G(V({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,abortController:new AbortController,id:i}))})}setupNavigations(t){return this.transitions=new Ut(null),this.transitions.pipe(Mt(i=>i!==null),zt(i=>{let r=!1;return ue(i).pipe(zt(o=>{if(this.navigationId>i.id)return this.cancelNavigationTransition(i,"",ln.SupersededByNewNavigation),mn;this.currentTransition=i,this.currentNavigation.set({id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,targetBrowserUrl:typeof o.extras.browserUrl=="string"?this.urlSerializer.parse(o.extras.browserUrl):o.extras.browserUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?G(V({},this.lastSuccessfulNavigation),{previousNavigation:null}):null,abort:()=>o.abortController.abort()});let a=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),u=o.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!a&&u!=="reload")return this.events.next(new Yi(o.id,this.urlSerializer.serialize(o.rawUrl),"",vl.IgnoredSameUrlNavigation)),o.resolve(!1),mn;if(this.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return ue(o).pipe(zt(c=>(this.events.next(new so(c.id,this.urlSerializer.serialize(c.extractedUrl),c.source,c.restoredState)),c.id!==this.navigationId?mn:Promise.resolve(c))),u3(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),et(c=>{i.targetSnapshot=c.targetSnapshot,i.urlAfterRedirects=c.urlAfterRedirects,this.currentNavigation.update(h=>(h.finalUrl=c.urlAfterRedirects,h));let m=new Cl(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(m)}));if(a&&this.urlHandlingStrategy.shouldProcessUrl(o.currentRawUrl)){let{id:c,extractedUrl:m,source:h,restoredState:y,extras:v}=o,C=new so(c,this.urlSerializer.serialize(m),h,y);this.events.next(C);let T=Ab(this.rootComponentType).snapshot;return this.currentTransition=i=G(V({},o),{targetSnapshot:T,urlAfterRedirects:m,extras:G(V({},v),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(R=>(R.finalUrl=m,R)),ue(i)}else return this.events.next(new Yi(o.id,this.urlSerializer.serialize(o.extractedUrl),"",vl.IgnoredByUrlHandlingStrategy)),o.resolve(!1),mn}),et(o=>{let a=new Ac(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(a)}),he(o=>(this.currentTransition=i=G(V({},o),{guards:I5(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),i)),B5(this.environmentInjector,o=>this.events.next(o)),et(o=>{if(i.guardsResult=o.guardsResult,o.guardsResult&&typeof o.guardsResult!="boolean")throw Gc(this.urlSerializer,o.guardsResult);let a=new Rc(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(a)}),Mt(o=>o.guardsResult?!0:(this.cancelNavigationTransition(o,"",ln.GuardRejected),!1)),ch(o=>{if(o.guards.canActivateChecks.length!==0)return ue(o).pipe(et(a=>{let u=new Nc(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(u)}),zt(a=>{let u=!1;return ue(a).pipe(d3(this.paramsInheritanceStrategy,this.environmentInjector),et({next:()=>u=!0,complete:()=>{u||this.cancelNavigationTransition(a,"",ln.NoDataFromResolver)}}))}),et(a=>{let u=new Fc(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(u)}))}),ch(o=>{let a=u=>{let c=[];if(u.routeConfig?.loadComponent){let m=ga(u)??this.environmentInjector;c.push(this.configLoader.loadComponent(m,u.routeConfig).pipe(et(h=>{u.component=h}),he(()=>{})))}for(let m of u.children)c.push(...a(m));return c};return Fu(a(o.targetSnapshot.root)).pipe(er(null),Ri(1))}),ch(()=>this.afterPreactivation()),zt(()=>{let{currentSnapshot:o,targetSnapshot:a}=i,u=this.createViewTransition?.(this.environmentInjector,o.root,a.root);return u?at(u).pipe(he(()=>i)):ue(i)}),he(o=>{let a=E5(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return this.currentTransition=i=G(V({},o),{targetRouterState:a}),this.currentNavigation.update(u=>(u.targetRouterState=a,u)),i}),et(()=>{this.events.next(new xl)}),T5(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o),this.inputBindingEnabled),Ri(1),ku(new Te(o=>{let a=i.abortController.signal,u=()=>o.next();return a.addEventListener("abort",u),()=>a.removeEventListener("abort",u)}).pipe(Mt(()=>!r&&!i.targetRouterState),et(()=>{this.cancelNavigationTransition(i,i.abortController.signal.reason+"",ln.Aborted)}))),et({next:o=>{r=!0,this.lastSuccessfulNavigation=Pt(this.currentNavigation),this.events.next(new Mn(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects))),this.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{r=!0}}),ku(this.transitionAbortWithErrorSubject.pipe(et(o=>{throw o}))),tr(()=>{r||this.cancelNavigationTransition(i,"",ln.SupersededByNewNavigation),this.currentTransition?.id===i.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),zn(o=>{if(this.destroyed)return i.resolve(!1),mn;if(r=!0,Vb(o))this.events.next(new Si(i.id,this.urlSerializer.serialize(i.extractedUrl),o.message,o.cancellationCode)),w5(o)?this.events.next(new ma(o.url,o.navigationBehaviorOptions)):i.resolve(!1);else{let a=new ca(i.id,this.urlSerializer.serialize(i.extractedUrl),o,i.targetSnapshot??void 0);try{let u=Rt(this.environmentInjector,()=>this.navigationErrorHandler?.(a));if(u instanceof pa){let{message:c,cancellationCode:m}=Gc(this.urlSerializer,u);this.events.next(new Si(i.id,this.urlSerializer.serialize(i.extractedUrl),c,m)),this.events.next(new ma(u.redirectTo,u.navigationBehaviorOptions))}else throw this.events.next(a),o}catch(u){this.options.resolveNavigationPromiseOnError?i.resolve(!1):i.reject(u)}}return mn}))}))}cancelNavigationTransition(t,i,r){let o=new Si(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=Pt(this.currentNavigation),r=i?.targetBrowserUrl??i?.extractedUrl;return t.toString()!==r?.toString()&&!i?.extras.skipLocationChange}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function h3(n){return n!==hl}var Kb=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=Z({token:n,factory:()=>P(y3),providedIn:"root"})}return n})(),Wc=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},y3=(()=>{class n extends Wc{static \u0275fac=(()=>{let t;return function(r){return(t||(t=Jt(n)))(r||n)}})();static \u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Qb=(()=>{class n{urlSerializer=P(Il);options=P(_a,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=P(Xr);urlHandlingStrategy=P(Yc);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new Di;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:i,targetBrowserUrl:r}){let o=t!==void 0?this.urlHandlingStrategy.merge(t,i):i,a=r??o;return a instanceof Di?this.urlSerializer.serialize(a):a}commitTransition({targetRouterState:t,finalUrl:i,initialUrl:r}){i&&t?(this.currentUrlTree=i,this.rawUrlTree=this.urlHandlingStrategy.merge(i,r),this.routerState=t):this.rawUrlTree=r}routerState=Ab(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Z({token:n,factory:()=>P(_3),providedIn:"root"})}return n})(),_3=(()=>{class n extends Qb{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{i.type==="popstate"&&setTimeout(()=>{t(i.url,i.state,"popstate")})})}handleRouterEvent(t,i){t instanceof so?this.updateStateMemento():t instanceof Yi?this.commitTransition(i):t instanceof Cl?this.urlUpdateStrategy==="eager"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof xl?(this.commitTransition(i),this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof Si&&t.code!==ln.SupersededByNewNavigation&&t.code!==ln.Redirect?this.restoreHistory(i):t instanceof ca?this.restoreHistory(i,!0):t instanceof Mn&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:i,id:r}){let{replaceUrl:o,state:a}=i;if(this.location.isCurrentPathEqualTo(t)||o){let u=this.browserPageId,c=V(V({},a),this.generateNgRouterState(r,u));this.location.replaceState(t,"",c)}else{let u=V(V({},a),this.generateNgRouterState(r,this.browserPageId+1));this.location.go(t,"",u)}}restoreHistory(t,i=!1){if(this.canceledNavigationResolution==="computed"){let r=this.browserPageId,o=this.currentPageId-r;o!==0?this.location.historyGo(o):this.getCurrentUrlTree()===t.finalUrl&&o===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Jt(n)))(r||n)}})();static \u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Ah(n,e){n.events.pipe(Mt(t=>t instanceof Mn||t instanceof Si||t instanceof ca||t instanceof Yi),he(t=>t instanceof Mn||t instanceof Yi?0:(t instanceof Si?t.code===ln.Redirect||t.code===ln.SupersededByNewNavigation:!1)?2:1),Mt(t=>t!==2),Ri(1)).subscribe(()=>{e()})}var v3={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},C3={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Ve=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=P(fg);stateManager=P(Qb);options=P(_a,{optional:!0})||{};pendingTasks=P(vi);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=P(Jb);urlSerializer=P(Il);location=P(Xr);urlHandlingStrategy=P(Yc);injector=P(St);_events=new gt;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=P(Kb);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=P(Rl,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!P(jc,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new xt;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(i=>{try{let r=this.navigationTransitions.currentTransition,o=Pt(this.navigationTransitions.currentNavigation);if(r!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Si&&i.code!==ln.Redirect&&i.code!==ln.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Mn)this.navigated=!0;else if(i instanceof ma){let a=i.navigationBehaviorOptions,u=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),c=V({browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||this.urlUpdateStrategy==="eager"||h3(r.source)},a);this.scheduleNavigation(u,hl,null,c,{resolve:r.resolve,reject:r.reject,promise:r.promise})}}v5(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortWithErrorSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),hl,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i,r)=>{this.navigateToSyncWithBrowser(t,r,i)})}navigateToSyncWithBrowser(t,i,r){let o={replaceUrl:!0},a=r?.navigationId?r:null;if(r){let c=V({},r);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let u=this.parseUrl(t);this.scheduleNavigation(u,i,a,o).catch(c=>{this.disposed||this.injector.get(fn)(c)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return Pt(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Ih),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){let{relativeTo:r,queryParams:o,fragment:a,queryParamsHandling:u,preserveFragment:c}=i,m=c?this.currentUrlTree.fragment:a,h=null;switch(u??this.options.defaultQueryParamsHandling){case"merge":h=V(V({},this.currentUrlTree.queryParams),o);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=o||null}h!==null&&(h=this.removeEmptyProps(h));let y;try{let v=r?r.snapshot:this.routerState.snapshot.root;y=wb(v)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),y=this.currentUrlTree.root}return Tb(y,t,h,m??null)}navigateByUrl(t,i={skipLocationChange:!1}){let r=vr(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(o,hl,null,i)}navigate(t,i={skipLocationChange:!1}){return x3(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.console.warn(rr(4018,!1)),this.urlSerializer.parse("/")}}isActive(t,i){let r;if(i===!0?r=V({},v3):i===!1?r=V({},C3):r=i,vr(t))return sb(this.currentUrlTree,t,r);let o=this.parseUrl(t);return sb(this.currentUrlTree,o,r)}removeEmptyProps(t){return Object.entries(t).reduce((i,[r,o])=>(o!=null&&(i[r]=o),i),{})}scheduleNavigation(t,i,r,o,a){if(this.disposed)return Promise.resolve(!1);let u,c,m;a?(u=a.resolve,c=a.reject,m=a.promise):m=new Promise((y,v)=>{u=y,c=v});let h=this.pendingTasks.add();return Ah(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:u,reject:c,promise:m,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),m.catch(y=>Promise.reject(y))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function x3(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new z(4008,!1)}var Cr=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;reactiveHref=S(null);get href(){return Pt(this.reactiveHref)}set href(t){this.reactiveHref.set(t)}target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new gt;applicationErrorHandler=P(fn);options=P(_a,{optional:!0});constructor(t,i,r,o,a,u){this.router=t,this.route=i,this.tabIndexAttribute=r,this.renderer=o,this.el=a,this.locationStrategy=u,this.reactiveHref.set(P(new Zd("href"),{optional:!0}));let c=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=c==="a"||c==="area"||!!(typeof customElements=="object"&&customElements.get(c)?.observedAttributes?.includes?.("href")),this.isAnchorElement?this.setTabIndexIfNotOnNativeEl("0"):this.subscribeToNavigationEventsIfNecessary()}subscribeToNavigationEventsIfNecessary(){if(this.subscription!==void 0||!this.isAnchorElement)return;let t=this.preserveFragment,i=r=>r==="merge"||r==="preserve";t||=i(this.queryParamsHandling),t||=!this.queryParamsHandling&&!i(this.options?.defaultQueryParamsHandling),t&&(this.subscription=this.router.events.subscribe(r=>{r instanceof Mn&&this.updateHref()}))}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&(this.updateHref(),this.subscribeToNavigationEventsIfNecessary()),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(vr(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,i,r,o,a){let u=this.urlTree;if(u===null||this.isAnchorElement&&(t!==0||i||r||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let c={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(u,c)?.catch(m=>{this.applicationErrorHandler(m)}),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.reactiveHref.set(t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t))??"":null)}applyAttributeValue(t,i){let r=this.renderer,o=this.el.nativeElement;i!==null?r.setAttribute(o,t,i):r.removeAttribute(o,t)}get urlTree(){return this.routerLinkInput===null?null:vr(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(i){return new(i||n)(X(Ve),X(un),Hs("tabindex"),X(ei),X(nn),X(bi))};static \u0275dir=Ae({type:n,selectors:[["","routerLink",""]],hostVars:2,hostBindings:function(i,r){i&1&&b("click",function(a){return r.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&dt("href",r.reactiveHref(),qf)("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",Zr],skipLocationChange:[2,"skipLocationChange","skipLocationChange",Zr],replaceUrl:[2,"replaceUrl","replaceUrl",Zr],routerLink:"routerLink"},features:[Un]})}return n})(),Rh=(()=>{class n{router;element;renderer;cdr;link;links;classes=[];routerEventsSubscription;linkInputChangesSubscription;_isActive=!1;get isActive(){return this._isActive}routerLinkActiveOptions={exact:!1};ariaCurrentWhenActive;isActiveChange=new lt;constructor(t,i,r,o,a){this.router=t,this.element=i,this.renderer=r,this.cdr=o,this.link=a,this.routerEventsSubscription=t.events.subscribe(u=>{u instanceof Mn&&this.update()})}ngAfterContentInit(){ue(this.links.changes,ue(null)).pipe(Po()).subscribe(t=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();let t=[...this.links.toArray(),this.link].filter(i=>!!i).map(i=>i.onChanges);this.linkInputChangesSubscription=at(t).pipe(Po()).subscribe(i=>{this._isActive!==this.isLinkActive(this.router)(i)&&this.update()})}set routerLinkActive(t){let i=Array.isArray(t)?t:t.split(" ");this.classes=i.filter(r=>!!r)}ngOnChanges(t){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{let t=this.hasActiveLinks();this.classes.forEach(i=>{t?this.renderer.addClass(this.element.nativeElement,i):this.renderer.removeClass(this.element.nativeElement,i)}),t&&this.ariaCurrentWhenActive!==void 0?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this._isActive!==t&&(this._isActive=t,this.cdr.markForCheck(),this.isActiveChange.emit(t))})}isLinkActive(t){let i=E3(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return r=>{let o=r.urlTree;return o?t.isActive(o,i):!1}}hasActiveLinks(){let t=this.isLinkActive(this.router);return this.link&&t(this.link)||this.links.some(t)}static \u0275fac=function(i){return new(i||n)(X(Ve),X(nn),X(ei),X(yr),X(Cr,8))};static \u0275dir=Ae({type:n,selectors:[["","routerLinkActive",""]],contentQueries:function(i,r,o){if(i&1&&vg(o,Cr,5),i&2){let a;on(a=an())&&(r.links=a)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],features:[Un]})}return n})();function E3(n){return!!n.paths}var S3=new ne("");function Nh(n,...e){return kr([{provide:Rl,multi:!0,useValue:n},[],{provide:un,useFactory:D3,deps:[Ve]},{provide:jd,multi:!0,useFactory:T3},e.map(t=>t.\u0275providers)])}function D3(n){return n.routerState.root}function w3(n,e){return{\u0275kind:n,\u0275providers:e}}function T3(){let n=P(Yt);return e=>{let t=n.get(Gi);if(e!==t.components[0])return;let i=n.get(Ve),r=n.get(I3);n.get(M3)===1&&i.initialNavigation(),n.get(A3,null,{optional:!0})?.setUpPreloading(),n.get(S3,null,{optional:!0})?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var I3=new ne("",{factory:()=>new gt}),M3=new ne("",{providedIn:"root",factory:()=>1});var A3=new ne("");function Fh(){return w3(6,[{provide:bi,useClass:Ug}])}var _n={production:!1,apiUrl:"https://galaxyhouse-finance.zeabur.app/api"};var lo=class lo{constructor(e,t){this.http=e;this.router=t;this.baseUrl=`${_n.apiUrl}/admin`;this.tokenKey="gh_finance_auth_token";this.adminKey="gh_finance_admin_data";this.expiryKey="gh_finance_token_expiry";this.currentAdmin=S(null);this.isAuthenticated=S(!1);this.isLoading=S(!1);this.error=S(null);this.isSuperAdmin=H(()=>this.currentAdmin()?.roles.some(t=>t.role_name==="super_admin")??!1);this.isManagedAdmin=H(()=>this.currentAdmin()?.roles.some(t=>["super_admin","user_manager"].includes(t.role_name))??!1);this.initializeAuth()}initializeAuth(){let e=this.getToken(),t=this.getTokenExpiry();if(e&&t)if(new Date().getTime()<t){let i=localStorage.getItem(this.adminKey);i&&(this.currentAdmin.set(JSON.parse(i)),this.isAuthenticated.set(!0))}else this.clearAuth()}async loginWithGoogle(e){try{this.isLoading.set(!0),this.error.set(null);let t=await te(this.http.post(`${this.baseUrl}/auth/google`,{idToken:e}));if(t.success&&t.data){let{token:i,admin:r}=t.data;return this.saveToken(i),this.saveAdmin(r),this.currentAdmin.set(r),this.isAuthenticated.set(!0),!0}else return this.error.set(t.error||"Login failed"),!1}catch(t){let i=t.error?.error||"Authentication failed";return this.error.set(i),!1}finally{this.isLoading.set(!1)}}logout(){this.clearAuth(),this.router.navigate(["/login"])}hasPermission(e){return this.currentAdmin()?.permissions.includes(e)??!1}hasRole(e){return this.currentAdmin()?.roles.some(i=>i.role_name===e)??!1}hasAnyRole(e){return this.currentAdmin()?.roles.some(i=>e.includes(i.role_name))??!1}getToken(){return localStorage.getItem(this.tokenKey)}getTokenExpiry(){let e=localStorage.getItem(this.expiryKey);return e?parseInt(e):null}saveToken(e){let t=new Date().getTime()+6048e5;localStorage.setItem(this.tokenKey,e),localStorage.setItem(this.expiryKey,t.toString())}saveAdmin(e){localStorage.setItem(this.adminKey,JSON.stringify(e))}clearAuth(){localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.adminKey),localStorage.removeItem(this.expiryKey),this.currentAdmin.set(null),this.isAuthenticated.set(!1)}refreshTokenExpiry(){let e=this.getToken();e&&this.saveToken(e)}getCurrentAdmin(){return this.currentAdmin()}isTokenExpiringSoon(){let e=this.getTokenExpiry();if(!e)return!0;let t=new Date().getTime(),i=3600*1e3;return e-t<i}};lo.\u0275fac=function(t){return new(t||lo)(ae(Zt),ae(Ve))},lo.\u0275prov=Z({token:lo,factory:lo.\u0275fac,providedIn:"root"});var rt=lo;var Zb=()=>({exact:!0}),R3=(n,e)=>e.name,N3=(n,e)=>e.path;function F3(n,e){if(n&1&&(l(0,"a",18),x(1,"ion-icon",19),l(2,"span",20),d(3),s()()),n&2){let t=e.$implicit;I("routerLink",t.path)("routerLinkActiveOptions",wt(4,Zb)),f(),I("name",t.icon),f(2),E(t.name)}}function P3(n,e){if(n&1&&(l(0,"div",17),O(1,F3,4,5,"a",18,N3),s()),n&2){let t=_(2).$implicit;f(),L(t.children)}}function k3(n,e){if(n&1){let t=B();l(0,"div")(1,"button",12),b("click",function(){D(t);let r=_().$implicit,o=_();return w(o.toggleMenu(r.name))}),l(2,"div",13),x(3,"ion-icon",14),l(4,"span",15),d(5),s()(),x(6,"ion-icon",16),s(),M(7,P3,3,0,"div",17),s()}if(n&2){let t=_().$implicit,i=_();f(),W("text-indigo-600",i.isMenuActive(t.children))("font-semibold",i.isMenuActive(t.children)),I("title",i.isCollapsed()?t.name:""),f(2),I("name",t.icon),f(),W("hidden",i.isCollapsed()),f(),E(t.name),f(),W("rotate-180",i.openMenu()===t.name)("hidden",i.isCollapsed()),f(),A(i.openMenu()===t.name&&!i.isCollapsed()?7:-1)}}function V3(n,e){if(n&1&&(l(0,"a",11),x(1,"ion-icon",14),l(2,"span",15),d(3),s()()),n&2){let t=_().$implicit,i=_();I("routerLink",t.path)("title",i.isCollapsed()?t.name:"")("routerLinkActiveOptions",wt(7,Zb)),f(),I("name",t.icon),f(),W("hidden",i.isCollapsed()),f(),E(t.name)}}function O3(n,e){if(n&1&&M(0,k3,8,14,"div")(1,V3,4,8,"a",11),n&2){let t=e.$implicit;A(t.children&&t.children.length>0?0:1)}}var va=class va{constructor(){this.router=P(Ve);this.authService=P(rt);this.http=P(Zt);this.openMenu=S(null);this.isSuperAdmin=S(!1);this.isCollapsed=S(!1);this.allNavLinks=[{path:"/dashboard",icon:"grid-outline",name:"\u5100\u8868\u677F"},{name:"\u8CA1\u52D9\u8207\u5206\u6790",icon:"analytics-outline",children:[{path:"/daily-revenue",icon:"stats-chart-outline",name:"\u7576\u65E5\u71DF\u6536"},{path:"/financial-statements",icon:"document-text-outline",name:"\u8CA1\u52D9\u5831\u8868"},{path:"/customer-analysis",icon:"people-outline",name:"\u9867\u5BA2\u7BA1\u7406"},{path:"/product-analysis",icon:"cube-outline",name:"\u5546\u54C1\u5206\u6790"},{path:"/monthly-targets",icon:"trending-up-outline",name:"\u71DF\u6536\u76EE\u6A19"}]},{name:"\u6210\u672C\u8207\u5EE0\u5546",icon:"wallet-outline",children:[{path:"/product-cost",icon:"pricetags-outline",name:"\u5546\u54C1\u6210\u672C"},{path:"/purchase-orders",icon:"receipt-outline",name:"\u9032\u8CA8\u55AE\u7BA1\u7406"},{path:"/vendors",icon:"briefcase-outline",name:"\u5EE0\u5546\u7BA1\u7406"}]},{name:"\u4EA4\u6613\u8207\u5E33\u52D9",icon:"reader-outline",children:[{path:"/ledger",icon:"reader-outline",name:"\u6D41\u6C34\u5E33"}]},{name:"\u884C\u92B7\u8207\u6D3B\u52D5",icon:"megaphone-outline",children:[{path:"/events",icon:"calendar-outline",name:"\u6D3B\u52D5\u7BA1\u7406"}]},{name:"\u80A1\u6771\u8207\u85AA\u8CC7",icon:"people-circle-outline",children:[{path:"/payroll",icon:"card-outline",name:"\u6253\u5361\u85AA\u8CC7"},{path:"/company-profile",icon:"person-outline",name:"\u516C\u53F8\u500B\u4EBA\u8CC7\u6599"},{path:"/shareholder-rebates",icon:"diamond-outline",name:"\u80A1\u6771\u56DE\u994B\u91D1"}]},{name:"\u5354\u4F5C\u7A7A\u9593",icon:"people-outline",children:[{path:"/goal-setting",icon:"trophy-outline",name:"\u5718\u968A\u76EE\u6A19\u8A2D\u5B9A"},{path:"/goal-progress",icon:"flag-outline",name:"\u500B\u4EBA\u76EE\u6A19\u9032\u5EA6"},{path:"/shareholder-records",icon:"document-text-outline",name:"\u500B\u4EBA\u6BCF\u5468\u9032\u5EA6\u7D00\u9304"},{path:"/meeting",icon:"chatbubbles-outline",name:"\u6BCF\u5468\u6703\u8B70\u7D00\u9304"},{path:"/decision-log",icon:"key-outline",name:"\u91CD\u5927\u4E8B\u9805\u4F48\u9054"}]},{name:"\u5E33\u865F\u7BA1\u7406",icon:"person-circle-outline",children:[{path:"/account",icon:"settings-outline",name:"\u5E33\u865F\u8A2D\u5B9A"},{path:"/user-management",icon:"shield-checkmark-outline",name:"\u4F7F\u7528\u8005\u7BA1\u7406"}]}];this.navLinks=H(()=>{if(!this.authService.isAuthenticated())return[];let e=this.allNavLinks;return this.isSuperAdmin()&&(e=[...e.slice(0,e.length-1),{name:"\u5E33\u865F\u7BA1\u7406",icon:"person-circle-outline",children:[{path:"/account",icon:"settings-outline",name:"\u5E33\u865F\u8A2D\u5B9A"},{path:"/user-management",icon:"shield-checkmark-outline",name:"\u4F7F\u7528\u8005\u7BA1\u7406"},{path:"/role-permissions",icon:"lock-closed-outline",name:"\u89D2\u8272\u6B0A\u9650\u63A7\u7BA1"}]}]),e})}ngOnInit(){this.checkSuperAdminStatus(),this.router.events.pipe(Mt(e=>e instanceof Mn)).subscribe(()=>{let e=this.navLinks().find(t=>this.isMenuActive(t.children));e&&this.openMenu.set(e.name)})}checkSuperAdminStatus(){try{let e=this.authService.getToken();if(!e){this.isSuperAdmin.set(!1);return}let t=new Ot({Authorization:`Bearer ${e}`,"Content-Type":"application/json"});this.http.get(`${_n.apiUrl}/admin/profile`,{headers:t}).subscribe({next:i=>{if(i?.data?.roles&&Array.isArray(i.data.roles)){let r=i.data.roles.some(o=>o.role_name==="super_admin");this.isSuperAdmin.set(r)}},error:()=>{this.isSuperAdmin.set(!1)}})}catch{this.isSuperAdmin.set(!1)}}toggleMenu(e){this.openMenu.update(t=>t===e?null:e)}toggleCollapse(){this.isCollapsed.update(e=>!e)}isMenuActive(e){return e?e.some(t=>t.path&&this.router.isActive(t.path,{paths:"exact",queryParams:"subset",fragment:"ignored",matrixParams:"ignored"})):!1}};va.\u0275fac=function(t){return new(t||va)},va.\u0275cmp=re({type:va,selectors:[["app-sidebar"]],decls:15,vars:11,consts:[[1,"flex-shrink-0","bg-white","border-r","border-gray-200","flex","flex-col","transition-all","duration-300","ease-in-out","overflow-hidden"],[1,"h-16","flex","items-center","justify-between","px-4","border-b","border-gray-200","flex-shrink-0"],[1,"flex","items-center","space-x-2"],["name","pulse-outline",1,"text-3xl","text-indigo-600"],[1,"text-xl","font-semibold","text-gray-800","whitespace-nowrap"],[1,"p-2","rounded-lg","hover:bg-gray-100","transition-colors","duration-200","flex-shrink-0",3,"click"],[1,"text-xl","text-gray-600",3,"name"],[1,"flex-1","flex","flex-col","overflow-y-auto"],[1,"flex-1","px-2","py-6","space-y-1"],[1,"px-4","py-6","border-t","border-gray-200","flex-shrink-0"],[1,"text-xs","text-center","text-gray-500"],["routerLinkActive","bg-indigo-50 text-indigo-600",1,"flex","items-center","px-4","py-2.5","text-gray-600","transition-colors","duration-200","transform","rounded-lg","hover:bg-gray-100","hover:text-gray-800",3,"routerLink","title","routerLinkActiveOptions"],[1,"w-full","flex","items-center","justify-between","px-4","py-2.5","text-gray-600","transition-colors","duration-200","transform","rounded-lg","hover:bg-gray-100","hover:text-gray-800",3,"click","title"],[1,"flex","items-center","flex-1"],[1,"text-xl","flex-shrink-0",3,"name"],[1,"mx-4","font-medium","whitespace-nowrap"],["name","chevron-down-outline",1,"text-sm","transition-transform","duration-300","flex-shrink-0"],[1,"mt-1","ml-4","pl-2","space-y-1","border-l","border-gray-200"],["routerLinkActive","bg-indigo-50 text-indigo-600 font-semibold",1,"flex","items-center","w-full","px-4","py-2","text-sm","text-gray-600","transition-colors","duration-200","transform","rounded-lg","hover:bg-gray-100","hover:text-gray-800",3,"routerLink","routerLinkActiveOptions"],[1,"text-lg","flex-shrink-0",3,"name"],[1,"mx-4","font-normal","whitespace-nowrap"]],template:function(t,i){t&1&&(l(0,"aside",0)(1,"div",1)(2,"div",2),x(3,"ion-icon",3),l(4,"h1",4),d(5,"\u8CA1\u52D9 AI"),s()(),l(6,"button",5),b("click",function(){return i.toggleCollapse()}),x(7,"ion-icon",6),s()(),l(8,"div",7)(9,"nav",8),O(10,O3,2,1,null,null,R3),s()(),l(12,"div",9)(13,"p",10),d(14,"\xA9 2024 \u5167\u90E8\u7CFB\u7D71"),s()()()),t&2&&(W("w-64",!i.isCollapsed())("w-20",i.isCollapsed()),f(2),W("opacity-0",i.isCollapsed())("w-0",i.isCollapsed()),f(5),I("name",i.isCollapsed()?"chevron-forward-outline":"chevron-back-outline"),f(3),L(i.navLinks()),f(3),W("hidden",i.isCollapsed()))},dependencies:[Cr,Rh],encapsulation:2,changeDetection:0});var Jc=va;function L3(n,e){if(n&1&&(tt(0,"div",1)(1,"div",2)(2,"p",3),d(3),nt(),tt(4,"p",4),d(5),nt()(),tt(6,"div",5),qi(7,"ion-icon",6),nt()()),n&2){let t=e,i=_();f(3),E(t.name),f(),De(i.getRoleClass((t.roles[0]==null?null:t.roles[0].role_name)||"")),f(),k(" ",(t.roles[0]==null?null:t.roles[0].display_name)||"User"," ")}}var Ca=class Ca{constructor(){this.authService=P(rt)}getRoleClass(e){switch(e){case"super_admin":return"bg-red-100 text-red-800";case"user_manager":return"bg-blue-100 text-blue-800";case"finance_manager":return"bg-green-100 text-green-800";case"operation_manager":return"bg-yellow-100 text-yellow-800";case"viewer":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}}};Ca.\u0275fac=function(t){return new(t||Ca)},Ca.\u0275cmp=re({type:Ca,selectors:[["app-header"]],decls:2,vars:1,consts:[[1,"h-16","flex-shrink-0","bg-white","border-b","border-gray-200","flex","items-center","justify-end","px-6"],[1,"flex","items-center","gap-4"],[1,"text-right"],[1,"text-sm","font-semibold","text-gray-800"],[1,"text-xs","font-medium","px-2","py-0.5","rounded-full","inline-block"],[1,"flex","items-center","gap-2"],["name","person-circle-outline",1,"text-3xl","text-gray-500"]],template:function(t,i){if(t&1&&(tt(0,"header",0),M(1,L3,8,4,"div",1),nt()),t&2){let r;f(),A((r=i.authService.currentAdmin())?1:-1,r)}},dependencies:[oe],encapsulation:2,changeDetection:0});var Kc=Ca;function B3(n,e){n&1&&(l(0,"div",0),x(1,"app-sidebar"),l(2,"div",1),x(3,"app-header"),l(4,"main",2)(5,"div",3),x(6,"router-outlet"),s()()()())}function U3(n,e){n&1&&x(0,"router-outlet")}var xa=class xa{constructor(){this.authService=P(rt)}};xa.\u0275fac=function(t){return new(t||xa)},xa.\u0275cmp=re({type:xa,selectors:[["app-root"]],decls:2,vars:1,consts:[[1,"flex","h-screen","bg-gray-100"],[1,"flex-1","flex","flex-col","overflow-hidden"],[1,"flex-1","overflow-x-hidden","overflow-y-auto","bg-gray-50"],[1,"container","mx-auto","px-6","py-8"]],template:function(t,i){t&1&&M(0,B3,7,0,"div",0)(1,U3,1,0,"router-outlet"),t&2&&A(i.authService.isAuthenticated()?0:1)},dependencies:[Ml,Jc,Kc,oe],encapsulation:2,changeDetection:0});var Qc=xa;var lE=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,i){this._renderer=t,this._elementRef=i}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(i){return new(i||n)(X(ei),X(nn))};static \u0275dir=Ae({type:n})}return n})(),Bl=(()=>{class n extends lE{static \u0275fac=(()=>{let t;return function(r){return(t||(t=Jt(n)))(r||n)}})();static \u0275dir=Ae({type:n,features:[ut]})}return n})(),co=new ne(""),$3={provide:co,useExisting:ht(()=>mo),multi:!0},mo=(()=>{class n extends Bl{writeValue(t){this.setProperty("checked",t)}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Jt(n)))(r||n)}})();static \u0275dir=Ae({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(i,r){i&1&&b("change",function(a){return r.onChange(a.target.checked)})("blur",function(){return r.onTouched()})},standalone:!1,features:[Vt([$3]),ut]})}return n})(),H3={provide:co,useExisting:ht(()=>xe),multi:!0};function G3(){let n=Hn()?Hn().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var q3=new ne(""),xe=(()=>{class n extends lE{_compositionMode;_composing=!1;constructor(t,i,r){super(t,i),this._compositionMode=r,this._compositionMode==null&&(this._compositionMode=!G3())}writeValue(t){let i=t??"";this.setProperty("value",i)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(i){return new(i||n)(X(ei),X(nn),X(q3,8))};static \u0275dir=Ae({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){i&1&&b("input",function(a){return r._handleInput(a.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(a){return r._compositionEnd(a.target.value)})},standalone:!1,features:[Vt([H3]),ut]})}return n})();function Bh(n){return n==null||Uh(n)===0}function Uh(n){return n==null?null:Array.isArray(n)||typeof n=="string"?n.length:n instanceof Set?n.size:null}var ai=new ne(""),wa=new ne(""),W3=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,U=class{static min(e){return uE(e)}static max(e){return dE(e)}static required(e){return cE(e)}static requiredTrue(e){return j3(e)}static email(e){return z3(e)}static minLength(e){return Y3(e)}static maxLength(e){return mE(e)}static pattern(e){return pE(e)}static nullValidator(e){return Xc()}static compose(e){return vE(e)}static composeAsync(e){return CE(e)}};function uE(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function dE(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function cE(n){return Bh(n.value)?{required:!0}:null}function j3(n){return n.value===!0?null:{required:!0}}function z3(n){return Bh(n.value)||W3.test(n.value)?null:{email:!0}}function Y3(n){return e=>{let t=e.value?.length??Uh(e.value);return t===null||t===0?null:t<n?{minlength:{requiredLength:n,actualLength:t}}:null}}function mE(n){return e=>{let t=e.value?.length??Uh(e.value);return t!==null&&t>n?{maxlength:{requiredLength:n,actualLength:t}}:null}}function pE(n){if(!n)return Xc;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),i=>{if(Bh(i.value))return null;let r=i.value;return e.test(r)?null:{pattern:{requiredPattern:t,actualValue:r}}}}function Xc(n){return null}function fE(n){return n!=null}function gE(n){return hr(n)?at(n):n}function hE(n){let e={};return n.forEach(t=>{e=t!=null?V(V({},e),t):e}),Object.keys(e).length===0?null:e}function yE(n,e){return e.map(t=>t(n))}function J3(n){return!n.validate}function _E(n){return n.map(e=>J3(e)?e:t=>e.validate(t))}function vE(n){if(!n)return null;let e=n.filter(fE);return e.length==0?null:function(t){return hE(yE(t,e))}}function $h(n){return n!=null?vE(_E(n)):null}function CE(n){if(!n)return null;let e=n.filter(fE);return e.length==0?null:function(t){let i=yE(t,e).map(gE);return Wp(i).pipe(he(hE))}}function Hh(n){return n!=null?CE(_E(n)):null}function Xb(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function xE(n){return n._rawValidators}function bE(n){return n._rawAsyncValidators}function Vh(n){return n?Array.isArray(n)?n:[n]:[]}function em(n,e){return Array.isArray(n)?n.includes(e):n===e}function eE(n,e){let t=Vh(e);return Vh(n).forEach(r=>{em(t,r)||t.push(r)}),t}function tE(n,e){return Vh(e).filter(t=>!em(n,t))}var tm=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=$h(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Hh(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},dn=class extends tm{name;get formDirective(){return null}get path(){return null}},uo=class extends tm{_parent=null;name=null;valueAccessor=null},nm=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},K3={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},use=G(V({},K3),{"[class.ng-submitted]":"isSubmitted"}),me=(()=>{class n extends nm{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(X(uo,2))};static \u0275dir=Ae({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){i&2&&W("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},standalone:!1,features:[ut]})}return n})(),Le=(()=>{class n extends nm{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(X(dn,10))};static \u0275dir=Ae({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,r){i&2&&W("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},standalone:!1,features:[ut]})}return n})();var Nl="VALID",Zc="INVALID",ba="PENDING",Fl="DISABLED",xr=class{},im=class extends xr{value;source;constructor(e,t){super(),this.value=e,this.source=t}},kl=class extends xr{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},Vl=class extends xr{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},Ea=class extends xr{status;source;constructor(e,t){super(),this.status=e,this.source=t}},rm=class extends xr{source;constructor(e){super(),this.source=e}},Ll=class extends xr{source;constructor(e){super(),this.source=e}};function Gh(n){return(lm(n)?n.validators:n)||null}function Q3(n){return Array.isArray(n)?$h(n):n||null}function qh(n,e){return(lm(e)?e.asyncValidators:n)||null}function Z3(n){return Array.isArray(n)?Hh(n):n||null}function lm(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function EE(n,e,t){let i=n.controls;if(!(e?Object.keys(i):i).length)throw new z(1e3,"");if(!i[t])throw new z(1001,"")}function SE(n,e,t){n._forEachChild((i,r)=>{if(t[r]===void 0)throw new z(1002,"")})}var Sa=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return Pt(this.statusReactive)}set status(e){Pt(()=>this.statusReactive.set(e))}_status=H(()=>this.statusReactive());statusReactive=S(void 0);get valid(){return this.status===Nl}get invalid(){return this.status===Zc}get pending(){return this.status==ba}get disabled(){return this.status===Fl}get enabled(){return this.status!==Fl}errors;get pristine(){return Pt(this.pristineReactive)}set pristine(e){Pt(()=>this.pristineReactive.set(e))}_pristine=H(()=>this.pristineReactive());pristineReactive=S(!0);get dirty(){return!this.pristine}get touched(){return Pt(this.touchedReactive)}set touched(e){Pt(()=>this.touchedReactive.set(e))}_touched=H(()=>this.touchedReactive());touchedReactive=S(!1);get untouched(){return!this.touched}_events=new gt;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(eE(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(eE(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(tE(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(tE(e,this._rawAsyncValidators))}hasValidator(e){return em(this._rawValidators,e)}hasAsyncValidator(e){return em(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(G(V({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new Vl(!0,i))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:i})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,i),t&&e.emitEvent!==!1&&this._events.next(new Vl(!1,i))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(G(V({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new kl(!1,i))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,i),t&&e.emitEvent!==!1&&this._events.next(new kl(!0,i))}markAsPending(e={}){this.status=ba;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Ea(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(G(V({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Fl,this.errors=null,this._forEachChild(r=>{r.disable(G(V({},e),{onlySelf:!0}))}),this._updateValue();let i=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new im(this.value,i)),this._events.next(new Ea(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(G(V({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Nl,this._forEachChild(i=>{i.enable(G(V({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(G(V({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Nl||this.status===ba)&&this._runAsyncValidator(i,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new im(this.value,t)),this._events.next(new Ea(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(G(V({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Fl:Nl}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=ba,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:e!==!1};let i=gE(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){let i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,i){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||i)&&this._events.next(new Ea(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,i)}_initObservables(){this.valueChanges=new lt,this.statusChanges=new lt}_calculateStatus(){return this._allControlsDisabled()?Fl:this.errors?Zc:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(ba)?ba:this._anyControlsHaveStatus(Zc)?Zc:Nl}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let i=!this._anyControlsDirty(),r=this.pristine!==i;this.pristine=i,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),r&&this._events.next(new kl(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new Vl(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){lm(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=Q3(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=Z3(this._rawAsyncValidators)}},Da=class extends Sa{constructor(e,t,i){super(Gh(t),qh(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,i={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){SE(this,!0,e),Object.keys(e).forEach(i=>{EE(this,!0,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(i=>{let r=this.controls[i];r&&r.patchValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((i,r)=>{i.reset(e?e[r]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new Ll(this))}getRawValue(){return this._reduceChildren({},(e,t,i)=>(e[i]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,i)=>i._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let i=this.controls[t];i&&e(i,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,i]of Object.entries(this.controls))if(this.contains(t)&&e(i))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,i,r)=>((i.enabled||this.disabled)&&(t[r]=i.value),t))}_reduceChildren(e,t){let i=e;return this._forEachChild((r,o)=>{i=t(i,r,o)}),i}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var Oh=class extends Da{};var Ul=new ne("",{providedIn:"root",factory:()=>um}),um="always";function dm(n,e){return[...e.path,n]}function om(n,e,t=um){Wh(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),e6(n,e),n6(n,e),t6(n,e),X3(n,e)}function nE(n,e,t=!0){let i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),sm(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function am(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function X3(n,e){if(e.valueAccessor.setDisabledState){let t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function Wh(n,e){let t=xE(n);e.validator!==null?n.setValidators(Xb(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let i=bE(n);e.asyncValidator!==null?n.setAsyncValidators(Xb(i,e.asyncValidator)):typeof i=="function"&&n.setAsyncValidators([i]);let r=()=>n.updateValueAndValidity();am(e._rawValidators,r),am(e._rawAsyncValidators,r)}function sm(n,e){let t=!1;if(n!==null){if(e.validator!==null){let r=xE(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(a=>a!==e.validator);o.length!==r.length&&(t=!0,n.setValidators(o))}}if(e.asyncValidator!==null){let r=bE(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(a=>a!==e.asyncValidator);o.length!==r.length&&(t=!0,n.setAsyncValidators(o))}}}let i=()=>{};return am(e._rawValidators,i),am(e._rawAsyncValidators,i),t}function e6(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&DE(n,e)})}function t6(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&DE(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function DE(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function n6(n,e){let t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function wE(n,e){n==null,Wh(n,e)}function i6(n,e){return sm(n,e)}function TE(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function r6(n){return Object.getPrototypeOf(n.constructor)===Bl}function IE(n,e){n._syncPendingControls(),e.forEach(t=>{let i=t.control;i.updateOn==="submit"&&i._pendingChange&&(t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}function ME(n,e){if(!e)return null;Array.isArray(e);let t,i,r;return e.forEach(o=>{o.constructor===xe?t=o:r6(o)?i=o:r=o}),r||i||t||null}function o6(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}var a6={provide:dn,useExisting:ht(()=>$l)},Pl=Promise.resolve(),$l=(()=>{class n extends dn{callSetDisabledState;get submitted(){return Pt(this.submittedReactive)}_submitted=H(()=>this.submittedReactive());submittedReactive=S(!1);_directives=new Set;form;ngSubmit=new lt;options;constructor(t,i,r){super(),this.callSetDisabledState=r,this.form=new Da({},$h(t),Hh(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){Pl.then(()=>{let i=this._findContainer(t.path);t.control=i.registerControl(t.name,t.control),om(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){Pl.then(()=>{let i=this._findContainer(t.path);i&&i.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){Pl.then(()=>{let i=this._findContainer(t.path),r=new Da({});wE(r,t),i.registerControl(t.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){Pl.then(()=>{let i=this._findContainer(t.path);i&&i.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,i){Pl.then(()=>{this.form.get(t.path).setValue(i)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submittedReactive.set(!0),IE(this.form,this._directives),this.ngSubmit.emit(t),this.form._events.next(new rm(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static \u0275fac=function(i){return new(i||n)(X(ai,10),X(wa,10),X(Ul,8))};static \u0275dir=Ae({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,r){i&1&&b("submit",function(a){return r.onSubmit(a)})("reset",function(){return r.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Vt([a6]),ut]})}return n})();function iE(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function rE(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var Ol=class extends Sa{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,i){super(Gh(t),qh(i,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),lm(t)&&(t.nonNullable||t.initialValueIsDefault)&&(rE(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1,t?.emitEvent!==!1&&this._events.next(new Ll(this))}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){iE(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){iE(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){rE(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var s6=n=>n instanceof Ol,l6=(()=>{class n extends dn{_parent;ngOnInit(){this._checkParentType(),this.formDirective.addFormGroup(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormGroup(this)}get control(){return this.formDirective.getFormGroup(this)}get path(){return dm(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Jt(n)))(r||n)}})();static \u0275dir=Ae({type:n,standalone:!1,features:[ut]})}return n})();var u6={provide:uo,useExisting:ht(()=>Ie)},oE=Promise.resolve(),Ie=(()=>{class n extends uo{_changeDetectorRef;callSetDisabledState;control=new Ol;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new lt;constructor(t,i,r,o,a,u){super(),this._changeDetectorRef=a,this.callSetDisabledState=u,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=ME(this,o)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),TE(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){om(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){oE.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let i=t.isDisabled.currentValue,r=i!==0&&Zr(i);oE.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?dm(t,this._parent):[t]}static \u0275fac=function(i){return new(i||n)(X(dn,9),X(ai,10),X(wa,10),X(co,10),X(yr,8),X(Ul,8))};static \u0275dir=Ae({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Vt([u6]),ut,Un]})}return n})();var Be=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275dir=Ae({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})(),d6={provide:co,useExisting:ht(()=>kt),multi:!0},kt=(()=>{class n extends Bl{writeValue(t){let i=t??"";this.setProperty("value",i)}registerOnChange(t){this.onChange=i=>{t(i==""?null:parseFloat(i))}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Jt(n)))(r||n)}})();static \u0275dir=Ae({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,r){i&1&&b("input",function(a){return r.onChange(a.target.value)})("blur",function(){return r.onTouched()})},standalone:!1,features:[Vt([d6]),ut]})}return n})();var AE=new ne("");var c6={provide:dn,useExisting:ht(()=>Ue)},Ue=(()=>{class n extends dn{callSetDisabledState;get submitted(){return Pt(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}_submitted=H(()=>this._submittedReactive());_submittedReactive=S(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];form=null;ngSubmit=new lt;constructor(t,i,r){super(),this.callSetDisabledState=r,this._setValidators(t),this._setAsyncValidators(i)}ngOnChanges(t){t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(sm(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){let i=this.form.get(t.path);return om(i,t,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),i}getControl(t){return this.form.get(t.path)}removeControl(t){nE(t.control||null,t,!1),o6(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,i){this.form.get(t.path).setValue(i)}onSubmit(t){return this._submittedReactive.set(!0),IE(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new rm(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0,i={}){this.form.reset(t,i),this._submittedReactive.set(!1)}_updateDomValue(){this.directives.forEach(t=>{let i=t.control,r=this.form.get(t.path);i!==r&&(nE(i||null,t),s6(r)&&(om(r,t,this.callSetDisabledState),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let i=this.form.get(t.path);wE(i,t),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let i=this.form.get(t.path);i&&i6(i,t)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Wh(this.form,this),this._oldForm&&sm(this._oldForm,this)}static \u0275fac=function(i){return new(i||n)(X(ai,10),X(wa,10),X(Ul,8))};static \u0275dir=Ae({type:n,selectors:[["","formGroup",""]],hostBindings:function(i,r){i&1&&b("submit",function(a){return r.onSubmit(a)})("reset",function(){return r.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Vt([c6]),ut,Un]})}return n})(),m6={provide:dn,useExisting:ht(()=>wi)},wi=(()=>{class n extends l6{name=null;constructor(t,i,r){super(),this._parent=t,this._setValidators(i),this._setAsyncValidators(r)}_checkParentType(){RE(this._parent)}static \u0275fac=function(i){return new(i||n)(X(dn,13),X(ai,10),X(wa,10))};static \u0275dir=Ae({type:n,selectors:[["","formGroupName",""]],inputs:{name:[0,"formGroupName","name"]},standalone:!1,features:[Vt([m6]),ut]})}return n})(),p6={provide:dn,useExisting:ht(()=>Ti)},Ti=(()=>{class n extends dn{_parent;name=null;constructor(t,i,r){super(),this._parent=t,this._setValidators(i),this._setAsyncValidators(r)}ngOnInit(){RE(this._parent),this.formDirective.addFormArray(this)}ngOnDestroy(){this.formDirective?.removeFormArray(this)}get control(){return this.formDirective.getFormArray(this)}get formDirective(){return this._parent?this._parent.formDirective:null}get path(){return dm(this.name==null?this.name:this.name.toString(),this._parent)}static \u0275fac=function(i){return new(i||n)(X(dn,13),X(ai,10),X(wa,10))};static \u0275dir=Ae({type:n,selectors:[["","formArrayName",""]],inputs:{name:[0,"formArrayName","name"]},standalone:!1,features:[Vt([p6]),ut]})}return n})();function RE(n){return!(n instanceof wi)&&!(n instanceof Ue)&&!(n instanceof Ti)}var f6={provide:uo,useExisting:ht(()=>Ge)},Ge=(()=>{class n extends uo{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(t){}model;update=new lt;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(t,i,r,o,a){super(),this._ngModelWarningConfig=a,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=ME(this,o)}ngOnChanges(t){this._added||this._setUpControl(),TE(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return dm(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(i){return new(i||n)(X(dn,13),X(ai,10),X(wa,10),X(co,10),X(AE,8))};static \u0275dir=Ae({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Vt([f6]),ut,Un]})}return n})();var g6={provide:co,useExisting:ht(()=>Re),multi:!0};function NE(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function h6(n){return n.split(":")[0]}var Re=(()=>{class n extends Bl{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;appRefInjector=P(Gi).injector;destroyRef=P(Ln);cdr=P(yr);_queuedWrite=!1;_writeValueAfterRender(){this._queuedWrite||this.appRefInjector.destroyed||(this._queuedWrite=!0,$i({write:()=>{this.destroyRef.destroyed||(this._queuedWrite=!1,this.writeValue(this.value))}},{injector:this.appRefInjector}))}writeValue(t){this.cdr.markForCheck(),this.value=t;let i=this._getOptionId(t),r=NE(i,t);this.setProperty("value",r)}registerOnChange(t){this.onChange=i=>{this.value=this._getOptionValue(i),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),t))return i;return null}_getOptionValue(t){let i=h6(t);return this._optionMap.has(i)?this._optionMap.get(i):t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Jt(n)))(r||n)}})();static \u0275dir=Ae({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,r){i&1&&b("change",function(a){return r.onChange(a.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Vt([g6]),ut]})}return n})(),Fe=(()=>{class n{_element;_renderer;_select;id;constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(NE(this.id,t)),this._select._writeValueAfterRender())}set value(t){this._setElementValue(t),this._select&&this._select._writeValueAfterRender()}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select._writeValueAfterRender())}static \u0275fac=function(i){return new(i||n)(X(nn),X(ei),X(Re,9))};static \u0275dir=Ae({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})(),y6={provide:co,useExisting:ht(()=>FE),multi:!0};function aE(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function _6(n){return n.split(":")[0]}var FE=(()=>{class n extends Bl{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let i;if(Array.isArray(t)){let r=t.map(o=>this._getOptionId(o));i=(o,a)=>{o._setSelected(r.indexOf(a.toString())>-1)}}else i=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(t){this.onChange=i=>{let r=[],o=i.selectedOptions;if(o!==void 0){let a=o;for(let u=0;u<a.length;u++){let c=a[u],m=this._getOptionValue(c.value);r.push(m)}}else{let a=i.options;for(let u=0;u<a.length;u++){let c=a[u];if(c.selected){let m=this._getOptionValue(c.value);r.push(m)}}}this.value=r,t(r)}}_registerOption(t){let i=(this._idCounter++).toString();return this._optionMap.set(i,t),i}_getOptionId(t){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,t))return i;return null}_getOptionValue(t){let i=_6(t);return this._optionMap.has(i)?this._optionMap.get(i)._value:t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Jt(n)))(r||n)}})();static \u0275dir=Ae({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,r){i&1&&b("change",function(a){return r.onChange(a.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Vt([y6]),ut]})}return n})(),Pe=(()=>{class n{_element;_renderer;_select;id;_value;constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(aE(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(aE(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(i){return new(i||n)(X(nn),X(ei),X(FE,9))};static \u0275dir=Ae({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})();function v6(n){return typeof n=="number"?n:parseInt(n,10)}function PE(n){return typeof n=="number"?n:parseFloat(n)}var Hl=(()=>{class n{_validator=Xc;_onChange;_enabled;ngOnChanges(t){if(this.inputName in t){let i=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):Xc,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static \u0275fac=function(i){return new(i||n)};static \u0275dir=Ae({type:n,features:[Un]})}return n})(),C6={provide:ai,useExisting:ht(()=>Gl),multi:!0},Gl=(()=>{class n extends Hl{max;inputName="max";normalizeInput=t=>PE(t);createValidator=t=>dE(t);static \u0275fac=(()=>{let t;return function(r){return(t||(t=Jt(n)))(r||n)}})();static \u0275dir=Ae({type:n,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(i,r){i&2&&dt("max",r._enabled?r.max:null)},inputs:{max:"max"},standalone:!1,features:[Vt([C6]),ut]})}return n})(),x6={provide:ai,useExisting:ht(()=>po),multi:!0},po=(()=>{class n extends Hl{min;inputName="min";normalizeInput=t=>PE(t);createValidator=t=>uE(t);static \u0275fac=(()=>{let t;return function(r){return(t||(t=Jt(n)))(r||n)}})();static \u0275dir=Ae({type:n,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(i,r){i&2&&dt("min",r._enabled?r.min:null)},inputs:{min:"min"},standalone:!1,features:[Vt([x6]),ut]})}return n})(),b6={provide:ai,useExisting:ht(()=>jh),multi:!0};var jh=(()=>{class n extends Hl{required;inputName="required";normalizeInput=Zr;createValidator=t=>cE;enabled(t){return t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=Jt(n)))(r||n)}})();static \u0275dir=Ae({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,r){i&2&&dt("required",r._enabled?"":null)},inputs:{required:"required"},standalone:!1,features:[Vt([b6]),ut]})}return n})();var E6={provide:ai,useExisting:ht(()=>ql),multi:!0},ql=(()=>{class n extends Hl{maxlength;inputName="maxlength";normalizeInput=t=>v6(t);createValidator=t=>mE(t);static \u0275fac=(()=>{let t;return function(r){return(t||(t=Jt(n)))(r||n)}})();static \u0275dir=Ae({type:n,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(i,r){i&2&&dt("maxlength",r._enabled?r.maxlength:null)},inputs:{maxlength:"maxlength"},standalone:!1,features:[Vt([E6]),ut]})}return n})(),S6={provide:ai,useExisting:ht(()=>Wl),multi:!0},Wl=(()=>{class n extends Hl{pattern;inputName="pattern";normalizeInput=t=>t;createValidator=t=>pE(t);static \u0275fac=(()=>{let t;return function(r){return(t||(t=Jt(n)))(r||n)}})();static \u0275dir=Ae({type:n,selectors:[["","pattern","","formControlName",""],["","pattern","","formControl",""],["","pattern","","ngModel",""]],hostVars:1,hostBindings:function(i,r){i&2&&dt("pattern",r._enabled?r.pattern:null)},inputs:{pattern:"pattern"},standalone:!1,features:[Vt([S6]),ut]})}return n})();var kE=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=ti({type:n});static \u0275inj=Nn({})}return n})(),Lh=class extends Sa{constructor(e,t,i){super(Gh(t),qh(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){Array.isArray(e)?e.forEach(i=>{this.controls.push(i),this._registerControl(i)}):(this.controls.push(e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,i={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(e,t={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,i={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),t&&(this.controls.splice(r,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){SE(this,!1,e),e.forEach((i,r)=>{EE(this,!1,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((i,r)=>{i.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new Ll(this))}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,i)=>i._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,i)=>{e(t,i)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function sE(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var je=(()=>{class n{useNonNullable=!1;get nonNullable(){let t=new n;return t.useNonNullable=!0,t}group(t,i=null){let r=this._reduceControls(t),o={};return sE(i)?o=i:i!==null&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new Da(r,o)}record(t,i=null){let r=this._reduceControls(t);return new Oh(r,i)}control(t,i,r){let o={};return this.useNonNullable?(sE(i)?o=i:(o.validators=i,o.asyncValidators=r),new Ol(t,G(V({},o),{nonNullable:!0}))):new Ol(t,i,r)}array(t,i,r){let o=t.map(a=>this._createControl(a));return new Lh(o,i,r)}_reduceControls(t){let i={};return Object.keys(t).forEach(r=>{i[r]=this._createControl(t[r])}),i}_createControl(t){if(t instanceof Ol)return t;if(t instanceof Sa)return t;if(Array.isArray(t)){let i=t[0],r=t.length>1?t[1]:null,o=t.length>2?t[2]:null;return this.control(i,r,o)}else return this.control(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Se=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Ul,useValue:t.callSetDisabledState??um}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=ti({type:n});static \u0275inj=Nn({imports:[kE]})}return n})(),ke=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:AE,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:Ul,useValue:t.callSetDisabledState??um}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=ti({type:n});static \u0275inj=Nn({imports:[kE]})}return n})();var fo=class fo{constructor(e){this.http=e;this.baseUrl=_n.apiUrl}getLedgerEntries(e){let t=new _e;return e&&Object.entries(e).forEach(([i,r])=>{r!=null&&r!==""&&(t=t.set(i,r.toString()))}),te(this.http.get(`${this.baseUrl}/ledger`,{params:t}))}createLedgerEntry(e){return te(this.http.post(`${this.baseUrl}/ledger`,e))}updateLedgerEntry(e){return te(this.http.put(`${this.baseUrl}/ledger`,e))}deleteLedgerEntry(e){let t=new _e().set("id",e.toString());return te(this.http.delete(`${this.baseUrl}/ledger`,{params:t}))}checkLedgerShipmentItems(e){let t=new _e().set("id",e.toString());return te(this.http.get(`${this.baseUrl}/ledger/check-shipment`,{params:t}))}getVendors(){return te(this.http.get(`${this.baseUrl}/vendors`))}updateVendor(e){return te(this.http.put(`${this.baseUrl}/vendors`,e))}deleteVendor(e){let t=new _e().set("id",e.toString());return te(this.http.delete(`${this.baseUrl}/vendors`,{params:t}))}getVendorByTaxId(e){let t=new _e().set("tax_id",e);return te(this.http.get(`${this.baseUrl}/vendors`,{params:t}))}getGLAccounts(e){let t=new _e;return e&&Object.entries(e).forEach(([i,r])=>{r!=null&&(t=t.set(i,r.toString()))}),te(this.http.get(`${this.baseUrl}/gl-accounts`,{params:t}))}resolveGLAccount(e,t){let i=new _e().set("itemGroup",e).set("subjectName",t);return te(this.http.get(`${this.baseUrl}/gl-accounts/resolve`,{params:i}))}async getAnnualSummary(e,t){let i=new _e().set("type","summary").set("startYear",e.toString()).set("endYear",t.toString()),r=await te(this.http.get(`${this.baseUrl}/financial-statements`,{params:i}));return r.success&&r.data&&(r.data=this.normalizeAnnualSummary(r.data)),r}getIncomeStatement(e,t){let i=new _e().set("type","income").set("year",e.toString()).set("quarter",t.toString());return te(this.http.get(`${this.baseUrl}/financial-statements`,{params:i}))}getBalanceSheet(e,t){let i=new _e().set("type","balance").set("year",e.toString()).set("quarter",t.toString());return te(this.http.get(`${this.baseUrl}/financial-statements`,{params:i}))}async getFinancialStatementsDetails(e,t){let i=new _e().set("year",e.toString()).set("type",t),r=await te(this.http.get(`${this.baseUrl}/financial-statements/details`,{params:i}));return r.success&&r.data&&(r.data=this.normalizeMonthlyDetail(r.data)),r}parseNumeric(e){if(e==null)return 0;let t=typeof e=="string"?parseFloat(e):e;return isNaN(t)?0:t}convertYearTotalsToNumbers(e){let t={};return Object.entries(e).forEach(([i,r])=>{if(i==="total")t.total=this.parseNumeric(r);else{let o=parseInt(i);isNaN(o)||(t[o]=this.parseNumeric(r))}}),t}normalizeAnnualSummary(e){return{years:e.years||[],revenue:this.convertYearTotalsToNumbers(e.revenue||{total:0}),expense:this.convertYearTotalsToNumbers(e.expense||{total:0}),net:this.convertYearTotalsToNumbers(e.net||{total:0}),unpaid:this.convertYearTotalsToNumbers(e.unpaid||{total:0})}}normalizeMonthlyDetail(e){let t=(e.data||[]).map(i=>({month:i.month,total:this.parseNumeric(i.total),items:(i.items||[]).map(r=>({name:r.name,amount:this.parseNumeric(r.amount)}))}));return{year:e.year,type:e.type,data:t}}createCustomer(e){return te(this.http.post(`${this.baseUrl}/customers`,e))}updateCustomer(e){return te(this.http.put(`${this.baseUrl}/customers`,e))}deleteCustomer(e){let t=new _e().set("id",e);return te(this.http.delete(`${this.baseUrl}/customers`,{params:t}))}getDailyRevenue(e){let t=new _e().set("date",e);return te(this.http.get(`${this.baseUrl}/daily-revenue`,{params:t}))}getMonthlyRevenue(e,t){let i=new _e().set("year",e.toString()).set("month",t.toString());return te(this.http.get(`${this.baseUrl}/daily-revenue`,{params:i}))}getCustomers(e){let t=new _e;return e?.search&&(t=t.set("search",e.search)),e?.limit&&(t=t.set("limit",e.limit.toString())),e?.offset&&(t=t.set("offset",e.offset.toString())),te(this.http.get(`${this.baseUrl}/customers`,{params:t}))}getProductSales(e){let t=new _e().set("startMonth",e.startMonth).set("endMonth",e.endMonth);return e.category&&(t=t.set("category",e.category)),e.limit&&(t=t.set("limit",e.limit.toString())),e.offset&&(t=t.set("offset",e.offset.toString())),te(this.http.get(`${this.baseUrl}/product-sales`,{params:t}))}getPurchaseCosts(e){let t=new _e().set("startMonth",e.startMonth).set("endMonth",e.endMonth);return te(this.http.get(`${this.baseUrl}/purchase-costs`,{params:t}))}getShipmentItems(e){let t=new _e;return e?.startDate&&(t=t.set("startDate",e.startDate)),e?.endDate&&(t=t.set("endDate",e.endDate)),e?.vendorId&&(t=t.set("vendorId",e.vendorId.toString())),e?.entryId&&(t=t.set("entryId",e.entryId.toString())),e?.documentNo&&(t=t.set("documentNo",e.documentNo)),e?.itemName&&(t=t.set("itemName",e.itemName)),e?.limit&&(t=t.set("limit",e.limit.toString())),e?.offset&&(t=t.set("offset",e.offset.toString())),te(this.http.get(`${this.baseUrl}/shipment-items`,{params:t}))}updateShipmentItem(e,t){let i=V({shipmentId:e},t);return te(this.http.put(`${this.baseUrl}/shipment-items`,i))}createShipmentItem(e){return te(this.http.post(`${this.baseUrl}/shipment-items`,e))}deleteShipmentItem(e){let t=new _e().set("id",e.toString());return te(this.http.delete(`${this.baseUrl}/shipment-items`,{params:t}))}getMonthlyTargets(e){let t=new _e;return e?.startMonth&&(t=t.set("startMonth",e.startMonth)),e?.endMonth&&(t=t.set("endMonth",e.endMonth)),te(this.http.get(`${this.baseUrl}/monthly-targets`,{params:t}))}createMonthlyTarget(e){return te(this.http.post(`${this.baseUrl}/monthly-targets`,e))}updateMonthlyTarget(e){return te(this.http.put(`${this.baseUrl}/monthly-targets`,e))}deleteMonthlyTarget(e){let t=new _e().set("targetId",e.toString());return te(this.http.delete(`${this.baseUrl}/monthly-targets`,{params:t}))}getDailySummaries(e){let t=new _e;return e&&Object.entries(e).forEach(([i,r])=>{r!=null&&(t=t.set(i,r.toString()))}),te(this.http.get(`${this.baseUrl}/payroll/daily-summaries`,{params:t}))}createDailySummary(e){return te(this.http.post(`${this.baseUrl}/payroll/daily-summaries`,e))}updateDailySummary(e,t){return te(this.http.put(`${this.baseUrl}/payroll/daily-summaries`,V({id:e},t)))}getMonthlySummaries(e){let t=new _e().set("year",e.year.toString()).set("month",e.month.toString());return e.user_id!==void 0&&(t=t.set("user_id",e.user_id.toString())),te(this.http.get(`${this.baseUrl}/payroll/monthly-summaries`,{params:t}))}updateMonthlySummary(e){return te(this.http.put(`${this.baseUrl}/payroll/monthly-summaries`,e))}batchReleasePayroll(e){return te(this.http.post(`${this.baseUrl}/payroll/batch-release`,{daily_summary_ids:e}))}verifyMonthlySalarySummary(e){return te(this.http.post(`${this.baseUrl}/payroll/verify-monthly-salary`,e))}releaseMonthlySalarySummary(e){return te(this.http.post(`${this.baseUrl}/payroll/release-monthly-salary`,e))}deleteDailySummary(e){let t=new _e().set("id",e.toString());return te(this.http.delete(`${this.baseUrl}/payroll/daily-summaries`,{params:t}))}getEmployeeWages(e){let t=new _e;return e&&Object.entries(e).forEach(([i,r])=>{r!=null&&(t=t.set(i,r.toString()))}),te(this.http.get(`${this.baseUrl}/payroll/employee-wages`,{params:t}))}createEmployeeWage(e){return te(this.http.post(`${this.baseUrl}/payroll/employee-wages`,e))}updateEmployeeWage(e,t){return te(this.http.put(`${this.baseUrl}/payroll/employee-wages`,V({id:e},t)))}deleteEmployeeWage(e){let t=new _e().set("id",e.toString());return te(this.http.delete(`${this.baseUrl}/payroll/employee-wages`,{params:t}))}getSpecialDates(e){let t=new _e;return e&&Object.entries(e).forEach(([i,r])=>{r!=null&&(t=t.set(i,r.toString()))}),te(this.http.get(`${this.baseUrl}/payroll/special-dates`,{params:t}))}createSpecialDate(e){return te(this.http.post(`${this.baseUrl}/payroll/special-dates`,e))}updateSpecialDate(e,t){return te(this.http.put(`${this.baseUrl}/payroll/special-dates`,V({id:e},t)))}deleteSpecialDate(e){let t=new _e().set("id",e.toString());return te(this.http.delete(`${this.baseUrl}/payroll/special-dates`,{params:t}))}async downloadLaborReport(e,t){let i=new _e().set("user_id",e.toString()).set("year_month",t);return te(this.http.get(`${this.baseUrl}/payroll/labor-report`,{params:i,responseType:"blob",observe:"response"}))}async downloadLaborReportByEmployeeId(e,t){let i=new _e().set("employee_id",e.toString()).set("year_month",t);return te(this.http.get(`${this.baseUrl}/payroll/labor-report`,{params:i,responseType:"blob",observe:"response"}))}getEmployeeInfo(){return te(this.http.get(`${this.baseUrl}/payroll/employee-info`))}createEmployeeInfo(e){return te(this.http.post(`${this.baseUrl}/payroll/employee-info`,e))}updateEmployeeInfo(e,t){let i=new _e().set("employee_number",e.toString());return te(this.http.put(`${this.baseUrl}/payroll/employee-info`,t,{params:i}))}uploadIdCardImage(e,t,i){let r=new FormData;return r.append("file",e),r.append("employee_id",t.toString()),r.append("card_side",i),te(this.http.post(`${this.baseUrl}/payroll/upload-id-card`,r))}updateEmployeeIdCardPath(e,t,i){let r=t==="front"?"id_card_front":"id_card_back",o=new _e().set("employee_number",e.toString());return te(this.http.put(`${this.baseUrl}/payroll/employee-info`,{[r]:i},{params:o}))}verifyMonthlySalary(e,t,i){return this.verifyMonthlySalarySummary({user_id:e,year:t,month:i})}releaseMonthlySalary(e,t,i,r,o,a,u){return this.releaseMonthlySalarySummary({user_id:e,year:t,month:i,display_name:a,total_wage:r,total_work_hours:o,release_amount:u})}getPayrollPayablesSummary(){return te(this.http.get(`${this.baseUrl}/payroll/payables-summary`))}getPayrollPayablesDetails(e){let t=new _e().set("employee_id",e.toString());return te(this.http.get(`${this.baseUrl}/payroll/payables-details`,{params:t}))}getShareholderMonthlySummary(e){let t=new _e().set("year",e.year.toString()).set("month",e.month.toString());return te(this.http.get(`${this.baseUrl}/shareholder-rebates/monthly-summary`,{params:t}))}getShareholderMonthlyStats(e){let t=new _e().set("year",e.year.toString()).set("month",e.month.toString());return te(this.http.get(`${this.baseUrl}/shareholder-rebates/monthly-stats`,{params:t}))}getShareholderMonthlyDetail(e,t){let i=new _e().set("year",t.year.toString()).set("month",t.month.toString());return te(this.http.get(`${this.baseUrl}/shareholder-rebates/monthly-detail/${e}`,{params:i}))}updateShareholderRebateRecord(e,t){return te(this.http.patch(`${this.baseUrl}/shareholder-rebates/record/${e}`,t))}createShareholderRebateRecord(e){return te(this.http.post(`${this.baseUrl}/shareholder-rebates/record`,e))}deleteShareholderRebateRecord(e){return te(this.http.delete(`${this.baseUrl}/shareholder-rebates/record/${e}`))}releaseShareholderRebate(e){return te(this.http.post(`${this.baseUrl}/shareholder-rebates/release`,e))}getShareholderPayablesSummary(){return te(this.http.get(`${this.baseUrl}/shareholder-rebates/payables-summary`))}getShareholderPayablesDetail(e){return te(this.http.get(`${this.baseUrl}/shareholder-rebates/payables-detail/${e}`))}};fo.\u0275fac=function(t){return new(t||fo)(ae(Zt))},fo.\u0275prov=Z({token:fo,factory:fo.\u0275fac,providedIn:"root"});var Xe=fo;var D6=["monthlyChart"],w6=["purchaseChart"],Ta=()=>({style:"currency",currency:"TWD",minimumFractionDigits:0});function T6(n,e){if(n&1&&(l(0,"div",16)(1,"div",23)(2,"div",24),x(3,"ion-icon",25),s(),l(4,"div")(5,"p",26),d(6,"\u6536\u5165"),s(),l(7,"p",27),d(8),s()()(),l(9,"div",23)(10,"div",28),x(11,"ion-icon",29),s(),l(12,"div")(13,"p",26),d(14,"\u5E73\u5747\u6BCF\u65E5\u6536\u5165"),s(),l(15,"p",27),d(16),s()()(),l(17,"div",23)(18,"div",30),x(19,"ion-icon",31),s(),l(20,"div")(21,"p",26),d(22,"\u8CBB\u7528"),s(),l(23,"p",27),d(24),s()()(),l(25,"div",23)(26,"div",32),x(27,"ion-icon",33),s(),l(28,"div")(29,"p",26),d(30,"\u6298\u8B93"),s(),l(31,"p",27),d(32),s()()(),l(33,"div",23)(34,"div",34),x(35,"ion-icon",35),s(),l(36,"div")(37,"p",26),d(38,"\u9032\u8CA8"),s(),l(39,"p",27),d(40),s()()(),l(41,"div",23)(42,"div",36),x(43,"ion-icon",37),s(),l(44,"div")(45,"p",26),d(46,"\u6BDB\u5229"),s(),l(47,"p",27),d(48),s()()()()),n&2){let t=e,i=_();f(8),E(t.revenue.toLocaleString("zh-TW",wt(6,Ta))),f(8),E(i.averageDailyRevenue().toLocaleString("zh-TW",wt(7,Ta))),f(8),E(t.expenses.toLocaleString("zh-TW",wt(8,Ta))),f(8),E(t.allowance.toLocaleString("zh-TW",wt(9,Ta))),f(8),E(t.purchases.toLocaleString("zh-TW",wt(10,Ta))),f(8),E(i.grossProfit().toLocaleString("zh-TW",wt(11,Ta)))}}function I6(n,e){n&1&&(l(0,"div",17),d(1,"\u5728\u6B64\u65E5\u671F\u7BC4\u570D\u5167\u6C92\u6709\u6578\u64DA\u3002"),s())}var Ia=class Ia{constructor(){this.apiService=P(Xe);this.formatDate=e=>{let t=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return`${t}-${i}-${r}`};this.today=new Date;this.firstDayOfMonth=new Date(this.today.getFullYear(),this.today.getMonth(),1);this.startDate=S(this.formatDate(this.firstDayOfMonth));this.endDate=S(this.formatDate(this.today));this.filterStartDate=this.formatDate(this.firstDayOfMonth);this.filterEndDate=this.formatDate(this.today);this.dashboardData=S(null);this.monthlyPerformance=S([]);this.isLoading=S(!1);this.errorMessage=S(null);this.averageDailyRevenue=H(()=>{let e=this.dashboardData();if(!e||!this.startDate()||!this.endDate())return 0;let t=new Date(this.startDate()),i=new Date(this.endDate());if(isNaN(t.getTime())||isNaN(i.getTime())||t>i)return 0;let r=i.getTime()-t.getTime(),o=Math.round(r/(1e3*60*60*24))+1;return o<=0?e.revenue:e.revenue/o});this.grossProfit=H(()=>{let e=this.dashboardData();return e?e.revenue-e.purchases-e.allowance-e.expenses:0});this.purchaseChartData=H(()=>{let e=this.dashboardData();return e?[{category:"\u9152\u6C34",amount:e.beveragePurchase},{category:"\u9910\u98F2",amount:e.foodPurchase},{category:"\u96EA\u8304(\u542B\u61C9\u4ED8)",amount:e.cigarPurchase}]:[]});this.loadData(this.startDate(),this.endDate()),$n(()=>{let e=this.monthlyPerformance(),t=this.purchaseChartData();this.monthlyChart&&this.purchaseChart&&this.updateCharts(e,t)}),$i(()=>{this.createCharts()})}async loadData(e,t){this.isLoading.set(!0),this.errorMessage.set(null);try{let i=e||this.startDate(),r=t||this.endDate(),[o,a]=await Promise.all([this.apiService.getLedgerEntries({startDate:i,endDate:r,limit:1e4}),this.apiService.getLedgerEntries({startDate:this.calculateMonthsBack(12),endDate:r,limit:1e4})]);o.success&&o.data&&this.dashboardData.set(this.calculateDashboardMetrics(o.data)),a.success&&a.data&&this.monthlyPerformance.set(this.calculateMonthlyPerformance(a.data))}catch(i){console.error("\u8F09\u5165\u5100\u8868\u677F\u6578\u64DA\u6642\u767C\u751F\u932F\u8AA4:",i);let r=i instanceof Error?i.message:"\u7121\u6CD5\u8F09\u5165\u6578\u64DA\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66";this.errorMessage.set(r)}finally{this.isLoading.set(!1)}}calculateMonthsBack(e){let t=new Date(this.endDate()),i=new Date(t.getFullYear(),t.getMonth()-e,1);return this.formatDate(i)}calculateDashboardMetrics(e){let t={revenue:0,expenses:0,allowance:0,purchases:0,beveragePurchase:0,foodPurchase:0,cigarPurchase:0};console.log("=== \u8A08\u7B97\u5100\u8868\u677F\u6307\u6A19 ==="),console.log("\u6D41\u6C34\u5E33\u7B46\u6578:",e.length),console.log("\u6D41\u6C34\u5E33\u6A23\u672C\u524D3\u7B46:"),e.slice(0,3).forEach((y,v)=>{console.log(`  [${v}]`,{amount:y.amount,item_group:y.item_group,subject_name:y.subject_name})});let i=0,r=0,o=0,a=0,u=0,c=0,m=0,h=0;return e.forEach((y,v)=>{let C=Math.abs(Number(y.amount)||0),T=y.item_group||"",R=y.subject_name||"";h+=C,R==="\u92B7\u8CA8\u6536\u5165"&&(t.revenue+=C,i++,i<=3&&console.log(`\u6536\u5165[${i}]: amount=${C}, subject=${R}`)),T==="\u71DF\u696D\u8CBB\u7528"&&(t.expenses+=C,r++,r<=3&&console.log(`\u8CBB\u7528[${r}]: amount=${C}, itemGroup=${T}`)),R==="-\u92B7\u6216\u6298\u8B93"&&(t.allowance+=C,o++,o<=3&&console.log(`\u6298\u8B93[${o}]: amount=${C}, subject=${R}`)),R==="\u5B58\u8CA8-\u9910\u98F2"?(t.foodPurchase+=C,t.purchases+=C,c++):R==="\u5B58\u8CA8-\u9152\u6C34"?(t.beveragePurchase+=C,t.purchases+=C,u++):(R==="\u5B58\u8CA8-\u96EA\u8304"||R==="\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8")&&(t.cigarPurchase+=C,t.purchases+=C,m++)}),console.log("=== \u6700\u7D42\u8A08\u7B97\u7D50\u679C ==="),console.log("\u6536\u5165\u8A08\u6578:",i,"\u7E3D\u984D:",t.revenue),console.log("\u8CBB\u7528\u8A08\u6578:",r,"\u7E3D\u984D:",t.expenses),console.log("\u6298\u8B93\u8A08\u6578:",o,"\u7E3D\u984D:",t.allowance),console.log("\u9032\u8CA8\u8A08\u6578 - \u98DF\u54C1:",c,"\u9152\u6C34:",u,"\u96EA\u8304:",m),console.log("\u9032\u8CA8\u7E3D\u984D:",t.purchases),console.log("\u6BDB\u5229:",t.revenue-t.purchases-t.allowance-t.expenses),console.log("\u9A57\u8B49 - \u7E3D\u8655\u7406\u91D1\u984D:",h),console.log("\u6700\u7D42\u6307\u6A19:",t),t}calculateMonthlyPerformance(e){let t=new Map;for(let i=11;i>=0;i--){let r=new Date(new Date(this.endDate()).getFullYear(),new Date(this.endDate()).getMonth()-i,1),o=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`;t.set(o,{revenue:0,expenses:0,allowance:0,purchases:0,beveragePurchase:0,foodPurchase:0,cigarPurchase:0})}return e.forEach(i=>{if(!i.entry_date)return;let r=new Date(i.entry_date),o=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`;if(!t.has(o))return;let a=Math.abs(Number(i.amount)||0),u=i.item_group||"",c=i.subject_name||"",m=t.get(o);c==="\u92B7\u8CA8\u6536\u5165"&&(m.revenue+=a),u==="\u71DF\u696D\u8CBB\u7528"&&(m.expenses+=a),c==="-\u92B7\u6216\u6298\u8B93"&&(m.allowance+=a),(c==="\u5B58\u8CA8-\u9910\u98F2"||c==="\u5B58\u8CA8-\u9152\u6C34"||c==="\u5B58\u8CA8-\u96EA\u8304"||c==="\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8")&&(m.purchases+=a)}),Array.from(t.entries()).map(([i,r])=>({month:i,revenue:r.revenue,expenses:r.expenses,allowance:r.allowance,purchases:r.purchases}))}applyFilter(){let e=this.filterStartDate,t=this.filterEndDate;if(e&&t&&e>t){alert("\u8D77\u59CB\u65E5\u671F\u4E0D\u80FD\u665A\u65BC\u7D50\u675F\u65E5\u671F\u3002");return}this.startDate.set(e),this.endDate.set(t),this.loadData(e,t)}resetFilter(){let e=this.formatDate(this.firstDayOfMonth),t=this.formatDate(this.today);this.filterStartDate=e,this.filterEndDate=t,this.startDate.set(e),this.endDate.set(t),this.loadData(e,t)}formatCurrency(e){return e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}createCharts(){let e=this.monthlyChartRef.nativeElement.getContext("2d"),t=this.monthlyPerformance();this.monthlyChart=new Chart(e,{type:"line",data:{labels:t.map(o=>o.month),datasets:[{label:"\u92B7\u8CA8\u6536\u5165",data:t.map(o=>o.revenue),borderColor:"#4f46e5",backgroundColor:"rgba(79, 70, 229, 0.1)",fill:!0,tension:.4},{label:"\u8CBB\u7528",data:t.map(o=>o.expenses),borderColor:"#f43f5e",backgroundColor:"rgba(244, 63, 94, 0.1)",fill:!0,tension:.4},{label:"\u6298\u8B93",data:t.map(o=>o.allowance),borderColor:"#f59e0b",backgroundColor:"rgba(245, 158, 11, 0.1)",fill:!0,tension:.4},{label:"\u9032\u8CA8",data:t.map(o=>o.purchases),borderColor:"#8b5cf6",backgroundColor:"rgba(139, 92, 246, 0.1)",fill:!0,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{callback:o=>this.formatCurrency(o)}}}}});let i=this.purchaseChartRef.nativeElement.getContext("2d"),r=this.purchaseChartData();this.purchaseChart=new Chart(i,{type:"doughnut",data:{labels:r.map(o=>o.category),datasets:[{label:"\u9032\u8CA8\u5206\u985E",data:r.map(o=>o.amount),backgroundColor:["#3b82f6","#10b981","#f59e0b"],hoverOffset:4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{tooltip:{callbacks:{label:o=>{let a=o.label||"",u=o.raw||0,c=r.reduce((h,y)=>h+y.amount,0);if(c===0)return`${a}: ${this.formatCurrency(u)} (0.00%)`;let m=(u/c*100).toFixed(2);return`${a}: ${this.formatCurrency(u)} (${m}%)`}}}}}})}updateCharts(e,t){this.monthlyChart&&(this.monthlyChart.data.labels=e.map(i=>i.month),this.monthlyChart.data.datasets[0].data=e.map(i=>i.revenue),this.monthlyChart.data.datasets[1].data=e.map(i=>i.expenses),this.monthlyChart.data.datasets[2].data=e.map(i=>i.allowance),this.monthlyChart.data.datasets[3].data=e.map(i=>i.purchases),this.monthlyChart.update()),this.purchaseChart&&(this.purchaseChart.data.labels=t.map(i=>i.category),this.purchaseChart.data.datasets[0].data=t.map(i=>i.amount),this.purchaseChart.update())}};Ia.\u0275fac=function(t){return new(t||Ia)},Ia.\u0275cmp=re({type:Ia,selectors:[["app-dashboard"]],viewQuery:function(t,i){if(t&1&&(Dn(D6,5),Dn(w6,5)),t&2){let r;on(r=an())&&(i.monthlyChartRef=r.first),on(r=an())&&(i.purchaseChartRef=r.first)}},decls:35,vars:3,consts:[["monthlyChart",""],["purchaseChart",""],[1,"space-y-8"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"flex","flex-col","sm:flex-row","items-center","gap-2","bg-white","p-3","rounded-xl","shadow-md","border","border-gray-200"],[1,"flex","items-center","gap-2"],["for","startDate",1,"text-sm","font-medium","text-gray-600"],["type","date","id","startDate",1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100",3,"ngModelChange","ngModel"],["for","endDate",1,"text-sm","font-medium","text-gray-600"],["type","date","id","endDate",1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100",3,"ngModelChange","ngModel"],[1,"flex","items-center","gap-2","mt-2","sm:mt-0"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","filter-outline"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-3","gap-6"],[1,"text-center","py-8","text-gray-500"],[1,"grid","grid-cols-1","lg:grid-cols-5","gap-6"],[1,"lg:col-span-3","bg-white","p-6","rounded-xl","shadow-md"],[1,"text-lg","font-semibold","text-gray-800","mb-4"],[1,"h-80"],[1,"lg:col-span-2","bg-white","p-6","rounded-xl","shadow-md"],[1,"bg-white","p-6","rounded-xl","shadow-md","flex","items-center","space-x-4"],[1,"bg-green-100","p-3","rounded-full"],["name","cash-outline",1,"text-2xl","text-green-600"],[1,"text-sm","text-gray-500"],[1,"text-2xl","font-semibold","text-gray-900"],[1,"bg-blue-100","p-3","rounded-full"],["name","calendar-outline",1,"text-2xl","text-blue-600"],[1,"bg-red-100","p-3","rounded-full"],["name","trending-down-outline",1,"text-2xl","text-red-600"],[1,"bg-yellow-100","p-3","rounded-full"],["name","pricetag-outline",1,"text-2xl","text-yellow-600"],[1,"bg-purple-100","p-3","rounded-full"],["name","cart-outline",1,"text-2xl","text-purple-600"],[1,"bg-indigo-100","p-3","rounded-full"],["name","pie-chart-outline",1,"text-2xl","text-indigo-600"]],template:function(t,i){if(t&1){let r=B();l(0,"div",2)(1,"div",3)(2,"h1",4),d(3,"\u5100\u8868\u677F"),s(),l(4,"div",5)(5,"div",6)(6,"label",7),d(7,"\u5F9E:"),s(),l(8,"input",8),J("ngModelChange",function(a){return D(r),K(i.filterStartDate,a)||(i.filterStartDate=a),w(a)}),s()(),l(9,"div",6)(10,"label",9),d(11,"\u81F3:"),s(),l(12,"input",10),J("ngModelChange",function(a){return D(r),K(i.filterEndDate,a)||(i.filterEndDate=a),w(a)}),s()(),l(13,"div",11)(14,"button",12),b("click",function(){return D(r),w(i.applyFilter())}),x(15,"ion-icon",13),l(16,"span"),d(17,"\u5957\u7528"),s()(),l(18,"button",14),b("click",function(){return D(r),w(i.resetFilter())}),x(19,"ion-icon",15),s()()()(),M(20,T6,49,12,"div",16)(21,I6,2,0,"div",17),l(22,"div",18)(23,"div",19)(24,"h3",20),d(25,"\u6708\u5EA6\u8868\u73FE"),s(),l(26,"div",21),x(27,"canvas",null,0),s()(),l(29,"div",22)(30,"h3",20),d(31,"\u7E3D\u9032\u8CA8\u5206\u6790"),s(),l(32,"div",21),x(33,"canvas",null,1),s()()()()}if(t&2){let r;f(8),Y("ngModel",i.filterStartDate),f(4),Y("ngModel",i.filterEndDate),f(8),A((r=i.dashboardData())?20:21,r)}},dependencies:[oe,Se,xe,me,Ie],encapsulation:2,changeDetection:0});var cm=Ia;var M6=["detailChart"],A6=(n,e)=>e.value,jl=(n,e)=>e.account,zh=(n,e)=>e.name,pm=(n,e)=>e.month;function R6(n,e){n&1&&(l(0,"div",2),x(1,"ion-icon",13),l(2,"span",14),d(3,"\u6B63\u5728\u52A0\u8F09\u6578\u64DA..."),s()())}function N6(n,e){if(n&1&&(l(0,"div",3),x(1,"ion-icon",15),l(2,"span",16),d(3),s()()),n&2){let t=_();f(3),E(t.errorMessage())}}function F6(n,e){if(n&1&&(l(0,"option",20),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),k("",t,"\u5E74")}}function P6(n,e){if(n&1&&(l(0,"option",20),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),k("",t,"\u5E74")}}function k6(n,e){n&1&&(x(0,"ion-icon",27),l(1,"span"),d(2,"\u5957\u7528\u4E2D..."),s())}function V6(n,e){n&1&&(x(0,"ion-icon",28),l(1,"span"),d(2,"\u5957\u7528"),s())}function O6(n,e){if(n&1){let t=B();l(0,"div",6)(1,"div",17)(2,"label",18),d(3,"\u5F9E:"),s(),l(4,"select",19),J("ngModelChange",function(r){D(t);let o=_();return K(o.selectedStartYearSummary,r)||(o.selectedStartYearSummary=r),w(r)}),O(5,F6,2,2,"option",20,j),s()(),l(7,"div",17)(8,"label",21),d(9,"\u81F3:"),s(),l(10,"select",22),J("ngModelChange",function(r){D(t);let o=_();return K(o.selectedEndYearSummary,r)||(o.selectedEndYearSummary=r),w(r)}),O(11,P6,2,2,"option",20,j),s()(),l(13,"div",23)(14,"button",24),b("click",function(){D(t);let r=_();return w(r.applySummaryFilter())}),M(15,k6,3,0)(16,V6,3,0),s(),l(17,"button",25),b("click",function(){D(t);let r=_();return w(r.resetSummaryFilter())}),x(18,"ion-icon",26),s()()()}if(n&2){let t=_();f(4),Y("ngModel",t.selectedStartYearSummary),f(),L(t.years()),f(5),Y("ngModel",t.selectedEndYearSummary),f(),L(t.years()),f(3),I("disabled",t.isLoading()),f(),A(t.isLoading()?15:16)}}function L6(n,e){if(n&1&&(l(0,"option",20),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),E(t)}}function B6(n,e){if(n&1&&(l(0,"option",20),d(1),s()),n&2){let t=e.$implicit;I("value",t.value),f(),E(t.label)}}function U6(n,e){n&1&&(x(0,"ion-icon",27),l(1,"span"),d(2,"\u5957\u7528\u4E2D..."),s())}function $6(n,e){n&1&&(x(0,"ion-icon",28),l(1,"span"),d(2,"\u5957\u7528"),s())}function H6(n,e){if(n&1){let t=B();l(0,"div",6)(1,"div",17)(2,"label",29),d(3,"\u5E74\u5EA6:"),s(),l(4,"select",30),J("ngModelChange",function(r){D(t);let o=_();return K(o.selectedYear,r)||(o.selectedYear=r),w(r)}),O(5,L6,2,2,"option",20,j),s()(),l(7,"div",17)(8,"label",31),d(9,"\u5B63\u5EA6:"),s(),l(10,"select",32),J("ngModelChange",function(r){D(t);let o=_();return K(o.selectedQuarter,r)||(o.selectedQuarter=r),w(r)}),O(11,B6,2,2,"option",20,A6),s()(),l(13,"div",23)(14,"button",24),b("click",function(){D(t);let r=_();return w(r.applyFilter())}),M(15,U6,3,0)(16,$6,3,0),s(),l(17,"button",25),b("click",function(){D(t);let r=_();return w(r.resetFilter())}),x(18,"ion-icon",26),s()()()}if(n&2){let t=_();f(4),Y("ngModel",t.selectedYear),f(),L(t.years()),f(5),Y("ngModel",t.selectedQuarter),f(),L(t.quarters()),f(3),I("disabled",t.isLoading()),f(),A(t.isLoading()?15:16)}}function G6(n,e){if(n&1&&(l(0,"th",37),d(1),s()),n&2){let t=e.$implicit;f(),k("",t,"\u5E74")}}function q6(n,e){if(n&1){let t=B();l(0,"td",51),b("click",function(){let r=D(t).$implicit,o=_(3);return w(o.openDetailModal(r,"revenue"))}),d(1),s()}if(n&2){let t=e.$implicit,i=_(),r=_(2);f(),E(r.formatCurrency(i.revenue[t]))}}function W6(n,e){if(n&1&&(l(0,"td",54),d(1),s()),n&2){let t=e.$implicit,i=_(2),r=_(2);f(),k(" (",r.formatCurrency(i.salesDiscount[t]),") ")}}function j6(n,e){if(n&1&&(l(0,"tr",43)(1,"td",52),x(2,"ion-icon",53),d(3,"-\u92B7\u8CA8\u6298\u8B93 "),s(),O(4,W6,2,1,"td",54,j),l(6,"td",55),d(7),s()()),n&2){let t=_(),i=_(2);f(4),L(t.years),f(3),k(" (",i.formatCurrency(t.salesDiscount.total),") ")}}function z6(n,e){if(n&1){let t=B();l(0,"td",56),b("click",function(){let r=D(t).$implicit,o=_(3);return w(o.openDetailModal(r,"expense"))}),d(1),s()}if(n&2){let t=e.$implicit,i=_(),r=_(2);f(),E(r.formatCurrency(i.expense[t]))}}function Y6(n,e){if(n&1&&(l(0,"td",37),d(1),s()),n&2){let t=e.$implicit,i=_(),r=_(2);W("text-red-600",i.net[t]<0),f(),E(r.formatCurrency(i.net[t]))}}function J6(n,e){if(n&1){let t=B();l(0,"td",57),b("click",function(){let r=D(t).$implicit,o=_(3);return w(o.openDetailModal(r,"unpaid"))}),d(1),s()}if(n&2){let t=e.$implicit,i=_(),r=_(2);f(),E(r.formatCurrency(i.unpaid[t]))}}function K6(n,e){if(n&1&&(l(0,"table",33)(1,"thead",35)(2,"tr")(3,"th",36),d(4,"\u9805\u76EE"),s(),O(5,G6,2,1,"th",37,j),l(7,"th",37),d(8,"\u7E3D\u8A08"),s()()(),l(9,"tbody")(10,"tr",38)(11,"td",39),x(12,"ion-icon",40),d(13,"\u6536\u5165 "),s(),O(14,q6,2,1,"td",41,j),l(16,"td",42),d(17),s()(),M(18,j6,8,1,"tr",43),l(19,"tr",44)(20,"td",39),x(21,"ion-icon",40),d(22,"\u652F\u51FA "),s(),O(23,z6,2,1,"td",45,j),l(25,"td",42),d(26),s()(),l(27,"tr",46)(28,"td",36),d(29,"\u7E3D\u8A08"),s(),O(30,Y6,2,3,"td",47,j),l(32,"td",37),d(33),s()(),l(34,"tr",48)(35,"td",39),x(36,"ion-icon",40),d(37,"\u672A\u4ED8 "),s(),O(38,J6,2,1,"td",49,j),l(40,"td",50),d(41),s()()()()),n&2){let t=e,i=_(2);f(5),L(t.years),f(9),L(t.years),f(3),E(i.formatCurrency(t.revenue.total)),f(),A(t.salesDiscount?18:-1),f(5),L(t.years),f(3),E(i.formatCurrency(t.expense.total)),f(4),L(t.years),f(2),W("text-red-600",t.net.total<0),f(),E(i.formatCurrency(t.net.total)),f(5),L(t.years),f(3),E(i.formatCurrency(t.unpaid.total))}}function Q6(n,e){n&1&&(l(0,"div",34),d(1,"\u7121\u6CD5\u8F09\u5165\u7E3D\u8868\u6578\u64DA\u3002"),s())}function Z6(n,e){if(n&1&&M(0,K6,42,7,"table",33)(1,Q6,2,0,"div",34),n&2){let t,i=_();A((t=i.annualSummary())?0:1,t)}}function X6(n,e){if(n&1&&(l(0,"th",63),d(1),s()),n&2){let t=e.$implicit,i=_(3);f(),E(i.formatMonth(t))}}function eR(n,e){if(n&1&&(l(0,"td",82),d(1),s()),n&2){let t=e.$implicit,i=_().$implicit,r=_(3);f(),E(r.formatCurrency(i.monthlyAmounts[t]||0))}}function tR(n,e){if(n&1&&(l(0,"tr",66),x(1,"td",78),l(2,"td",79),d(3),s(),l(4,"td",80),d(5),s(),l(6,"td",81),d(7),s(),O(8,eR,2,1,"td",82,j),s()),n&2){let t=e.$implicit,i=_(),r=_(2);f(3),E(t.account),f(2),E(r.formatCurrency(t.total)),f(2),k("",t.percentage==null?null:t.percentage.toFixed(2),"%"),f(),L(i.months)}}function nR(n,e){if(n&1&&(l(0,"td",71),d(1),s()),n&2){let t=e.$implicit,i=_(),r=_(2);f(),E(r.formatCurrency(i.operatingRevenue.monthlyTotals[t]||0))}}function iR(n,e){if(n&1&&(l(0,"td",82),d(1),s()),n&2){let t=e.$implicit,i=_().$implicit,r=_(3);f(),E(r.formatCurrency(i.monthlyAmounts[t]||0))}}function rR(n,e){if(n&1&&(l(0,"tr",66),x(1,"td",78),l(2,"td",79),d(3),s(),l(4,"td",80),d(5),s(),l(6,"td",81),d(7),s(),O(8,iR,2,1,"td",82,j),s()),n&2){let t=e.$implicit,i=_(),r=_(2);f(3),E(t.account),f(2),E(r.formatCurrency(t.total)),f(2),k("",t.percentage==null?null:t.percentage.toFixed(2),"%"),f(),L(i.months)}}function oR(n,e){if(n&1&&(l(0,"td",71),d(1),s()),n&2){let t=e.$implicit,i=_(),r=_(2);f(),E(r.formatCurrency(i.operatingExpenses.monthlyTotals[t]||0))}}function aR(n,e){if(n&1&&(l(0,"td",77),d(1),s()),n&2){let t=e.$implicit,i=_(),r=_(2);f(),E(r.formatCurrency(i.netIncome.monthlyTotals[t]||0))}}function sR(n,e){if(n&1&&(l(0,"div",58)(1,"table",33)(2,"thead",35)(3,"tr")(4,"th",59),d(5,"\u9805\u76EE"),s(),l(6,"th",60),d(7,"\u79D1\u76EE"),s(),l(8,"th",61),d(9,"\u7E3D\u8A08"),s(),l(10,"th",62),d(11,"%"),s(),O(12,X6,2,1,"th",63,j),s()(),l(14,"tbody")(15,"tr",64)(16,"td",65),d(17,"\u71DF\u696D\u6536\u5165"),s(),x(18,"td"),s(),O(19,tR,10,3,"tr",66,jl),l(21,"tr",67)(22,"td",68),d(23,"\u71DF\u696D\u6536\u5165\u5C0F\u8A08"),s(),l(24,"td",69),d(25),s(),l(26,"td",70),d(27,"100.00%"),s(),O(28,nR,2,1,"td",71,j),s(),l(30,"tr"),x(31,"td",72),s(),l(32,"tr",64)(33,"td",65),d(34,"\u71DF\u696D\u8CBB\u7528"),s(),x(35,"td"),s(),O(36,rR,10,3,"tr",66,jl),l(38,"tr",67)(39,"td",68),d(40,"\u71DF\u696D\u8CBB\u7528\u5C0F\u8A08"),s(),l(41,"td",69),d(42),s(),l(43,"td",70),d(44,"100.00%"),s(),O(45,oR,2,1,"td",71,j),s(),l(47,"tr"),x(48,"td",72),s(),l(49,"tr",73)(50,"td",74),d(51,"\u7E3D\u8A08 (\u672C\u671F\u640D\u76CA)"),s(),l(52,"td",75),d(53),s(),x(54,"td",76),O(55,aR,2,1,"td",77,j),s()()()()),n&2){let t=e,i=_(2);f(12),L(t.months),f(6),dt("colspan",t.months.length+1),f(),L(t.operatingRevenue.items),f(6),E(i.formatCurrency(t.operatingRevenue.grandTotal)),f(3),L(t.months),f(3),dt("colspan",t.months.length+4),f(4),dt("colspan",t.months.length+1),f(),L(t.operatingExpenses.items),f(6),E(i.formatCurrency(t.operatingExpenses.grandTotal)),f(3),L(t.months),f(3),dt("colspan",t.months.length+4),f(5),E(i.formatCurrency(t.netIncome.grandTotal)),f(2),L(t.months)}}function lR(n,e){n&1&&(l(0,"div",34),d(1,"\u7121\u6CD5\u8F09\u5165\u640D\u76CA\u8868\u6578\u64DA\u3002"),s())}function uR(n,e){if(n&1&&M(0,sR,57,7,"div",58)(1,lR,2,0,"div",34),n&2){let t,i=_();A((t=i.monthlyIncomeStatement())?0:1,t)}}function dR(n,e){if(n&1&&(l(0,"th",63),d(1),s()),n&2){let t=e.$implicit,i=_(3);f(),E(i.formatMonth(t))}}function cR(n,e){if(n&1&&(l(0,"td",82),d(1),s()),n&2){let t=e.$implicit,i=_().$implicit,r=_(3);f(),E(r.formatCurrency(i.monthlyAmounts[t]||0))}}function mR(n,e){if(n&1&&(l(0,"tr",66),x(1,"td",78),l(2,"td",79),d(3),s(),l(4,"td",80),d(5),s(),l(6,"td",81),d(7),s(),O(8,cR,2,1,"td",82,j),s()),n&2){let t=e.$implicit,i=_(),r=_(2);f(3),E(t.account),f(2),E(r.formatCurrency(t.total)),f(2),k("",t.percentage==null?null:t.percentage.toFixed(2),"%"),f(),L(i.months)}}function pR(n,e){if(n&1&&(l(0,"td",71),d(1),s()),n&2){let t=e.$implicit,i=_(),r=_(2);f(),E(r.formatCurrency(i.assets.monthlyTotals[t]||0))}}function fR(n,e){if(n&1&&(l(0,"td",82),d(1),s()),n&2){let t=e.$implicit,i=_().$implicit,r=_(3);f(),E(r.formatCurrency(i.monthlyAmounts[t]||0))}}function gR(n,e){if(n&1&&(l(0,"tr",66),x(1,"td",78),l(2,"td",79),d(3),s(),l(4,"td",80),d(5),s(),l(6,"td",81),d(7),s(),O(8,fR,2,1,"td",82,j),s()),n&2){let t=e.$implicit,i=_(),r=_(2);f(3),E(t.account),f(2),E(r.formatCurrency(t.total)),f(2),k("",t.percentage==null?null:t.percentage.toFixed(2),"%"),f(),L(i.months)}}function hR(n,e){if(n&1&&(l(0,"td",71),d(1),s()),n&2){let t=e.$implicit,i=_(),r=_(2);f(),E(r.formatCurrency(i.liabilities.monthlyTotals[t]||0))}}function yR(n,e){if(n&1&&(l(0,"td",82),d(1),s()),n&2){let t=e.$implicit,i=_().$implicit,r=_(3);f(),E(r.formatCurrency(i.monthlyAmounts[t]||0))}}function _R(n,e){if(n&1&&(l(0,"tr",66),x(1,"td",78),l(2,"td",79),d(3),s(),l(4,"td",80),d(5),s(),l(6,"td",81),d(7),s(),O(8,yR,2,1,"td",82,j),s()),n&2){let t=e.$implicit,i=_(),r=_(2);f(3),E(t.account),f(2),E(r.formatCurrency(t.total)),f(2),k("",t.percentage==null?null:t.percentage.toFixed(2),"%"),f(),L(i.months)}}function vR(n,e){if(n&1&&(l(0,"td",71),d(1),s()),n&2){let t=e.$implicit,i=_(),r=_(2);f(),E(r.formatCurrency(i.equity.monthlyTotals[t]||0))}}function CR(n,e){if(n&1&&(l(0,"td",88),d(1),s()),n&2){let t=e.$implicit,i=_(),r=_(2);f(),E(r.formatCurrency(i.totalLiabilitiesAndEquity.monthlyTotals[t]||0))}}function xR(n,e){if(n&1&&(l(0,"div",58)(1,"table",33)(2,"thead",35)(3,"tr")(4,"th",59),d(5,"\u9805\u76EE"),s(),l(6,"th",60),d(7,"\u79D1\u76EE"),s(),l(8,"th",61),d(9,"\u7E3D\u8A08"),s(),l(10,"th",62),d(11,"%"),s(),O(12,dR,2,1,"th",63,j),s()(),l(14,"tbody")(15,"tr",64)(16,"td",65),d(17,"\u8CC7\u7522"),s(),x(18,"td"),s(),O(19,mR,10,3,"tr",66,jl),l(21,"tr",67)(22,"td",68),d(23,"\u8CC7\u7522\u5C0F\u8A08"),s(),l(24,"td",83),d(25),s(),l(26,"td",70),d(27,"100.00%"),s(),O(28,pR,2,1,"td",71,j),s(),l(30,"tr"),x(31,"td",72),s(),l(32,"tr",64)(33,"td",65),d(34,"\u8CA0\u50B5"),s(),x(35,"td"),s(),O(36,gR,10,3,"tr",66,jl),l(38,"tr",84)(39,"td",85),d(40,"\u8CA0\u50B5\u5C0F\u8A08"),s(),l(41,"td",86),d(42),s(),x(43,"td",87),O(44,hR,2,1,"td",71,j),s(),l(46,"tr"),x(47,"td",72),s(),l(48,"tr",64)(49,"td",65),d(50,"\u696D\u4E3B\u6B0A\u76CA"),s(),x(51,"td"),s(),O(52,_R,10,3,"tr",66,jl),l(54,"tr",84)(55,"td",85),d(56,"\u696D\u4E3B\u6B0A\u76CA\u5C0F\u8A08"),s(),l(57,"td",86),d(58),s(),x(59,"td",87),O(60,vR,2,1,"td",71,j),s(),l(62,"tr"),x(63,"td",72),s(),l(64,"tr",67)(65,"td",68),d(66,"\u8CA0\u50B5\u53CA\u696D\u4E3B\u6B0A\u76CA\u7E3D\u8A08"),s(),l(67,"td",83),d(68),s(),x(69,"td",70),O(70,CR,2,1,"td",88,j),s()()()()),n&2){let t=e,i=_(2);f(12),L(t.months),f(6),dt("colspan",t.months.length+1),f(),L(t.assets.items),f(6),E(i.formatCurrency(t.assets.grandTotal)),f(3),L(t.months),f(3),dt("colspan",t.months.length+4),f(4),dt("colspan",t.months.length+1),f(),L(t.liabilities.items),f(6),E(i.formatCurrency(t.liabilities.grandTotal)),f(2),L(t.months),f(3),dt("colspan",t.months.length+4),f(4),dt("colspan",t.months.length+1),f(),L(t.equity.items),f(6),E(i.formatCurrency(t.equity.grandTotal)),f(2),L(t.months),f(3),dt("colspan",t.months.length+4),f(5),E(i.formatCurrency(t.totalLiabilitiesAndEquity.grandTotal)),f(2),L(t.months)}}function bR(n,e){n&1&&(l(0,"div",34),d(1,"\u7121\u6CD5\u8F09\u5165\u8CC7\u7522\u8CA0\u50B5\u8868\u6578\u64DA\u3002"),s())}function ER(n,e){if(n&1&&M(0,xR,72,10,"div",58)(1,bR,2,0,"div",34),n&2){let t,i=_();A((t=i.monthlyBalanceSheet())?0:1,t)}}function SR(n,e){n&1&&(l(0,"tr")(1,"th",100),d(2,"\u6708\u4EFD"),s(),l(3,"th",101),d(4,"\u7E3D\u8A08\u91D1\u984D"),s(),l(5,"th",101),d(6,"\u92B7\u8CA8\u6536\u5165"),s(),l(7,"th",101),d(8,"\u5176\u4ED6\u6536\u5165"),s(),l(9,"th",101),d(10,"-\u92B7\u8CA8\u6298\u8B93"),s()())}function DR(n,e){n&1&&(l(0,"tr")(1,"th",100),d(2,"\u6708\u4EFD"),s(),l(3,"th",101),d(4,"\u7E3D\u8A08\u91D1\u984D"),s(),l(5,"th",101),d(6,"\u5546\u54C1"),s(),l(7,"th",101),d(8,"\u96DC\u9805\u8B8A\u52D5"),s()())}function wR(n,e){n&1&&(l(0,"tr")(1,"th",100),d(2,"\u6708\u4EFD"),s(),l(3,"th",101),d(4,"\u7E3D\u8A08\u91D1\u984D"),s(),l(5,"th",101),d(6,"\u61C9\u4ED8\u5E33\u6B3E"),s(),l(7,"th",101),d(8,"\u61C9\u4ED8\u88DD\u6F62\u6B3E"),s(),l(9,"th",101),d(10,"\u61C9\u4ED8\u85AA\u8CC7"),s(),l(11,"th",101),d(12,"\u61C9\u4ED8\u80A1\u6771\u56DE\u994B\u91D1"),s(),l(13,"th",101),d(14,"\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8"),s()())}function TR(n,e){if(n&1&&(l(0,"th",100),d(1),s(),l(2,"th",101),d(3,"\u91D1\u984D"),s()),n&2){let t=e.$implicit;f(),E(t.name)}}function IR(n,e){if(n&1&&(l(0,"tr")(1,"th",100),d(2,"\u6708\u4EFD"),s(),l(3,"th",101),d(4,"\u91D1\u984D"),s(),O(5,TR,4,1,null,null,zh),s()),n&2){let t=_();f(5),L(t.data[0].items)}}function MR(n,e){if(n&1&&(l(0,"tr",102)(1,"td",103),d(2),s(),l(3,"td",104),d(4),s(),l(5,"td",101),d(6),s(),l(7,"td",101),d(8),s(),l(9,"td",105),d(10),s()()),n&2){let t=e.$implicit,i=_(4);f(2),k("",t.month,"\u6708"),f(2),E(i.formatCurrency(t.total)),f(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u92B7\u8CA8\u6536\u5165"))),f(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u5176\u4ED6\u6536\u5165"))),f(2),k(" (",i.formatCurrency(i.getDetailItemAmount(t,"-\u92B7\u8CA8\u6298\u8B93")),") ")}}function AR(n,e){if(n&1&&O(0,MR,11,5,"tr",102,pm),n&2){let t=_();L(t.data)}}function RR(n,e){if(n&1&&(l(0,"tr",102)(1,"td",103),d(2),s(),l(3,"td",104),d(4),s(),l(5,"td",101),d(6),s(),l(7,"td",101),d(8),s()()),n&2){let t=e.$implicit,i=_(4);f(2),k("",t.month,"\u6708"),f(2),E(i.formatCurrency(t.total)),f(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u5546\u54C1"))),f(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u96DC\u9805\u8B8A\u52D5")))}}function NR(n,e){if(n&1&&O(0,RR,9,4,"tr",102,pm),n&2){let t=_();L(t.data)}}function FR(n,e){if(n&1&&(l(0,"tr",102)(1,"td",103),d(2),s(),l(3,"td",104),d(4),s(),l(5,"td",101),d(6),s(),l(7,"td",101),d(8),s(),l(9,"td",101),d(10),s(),l(11,"td",101),d(12),s(),l(13,"td",101),d(14),s()()),n&2){let t=e.$implicit,i=_(4);f(2),k("",t.month,"\u6708"),f(2),E(i.formatCurrency(t.total)),f(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u61C9\u4ED8\u5E33\u6B3E"))),f(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u61C9\u4ED8\u88DD\u6F62\u6B3E"))),f(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u61C9\u4ED8\u85AA\u8CC7"))),f(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u61C9\u4ED8\u80A1\u6771\u56DE\u994B\u91D1"))),f(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8")))}}function PR(n,e){if(n&1&&O(0,FR,15,7,"tr",102,pm),n&2){let t=_();L(t.data)}}function kR(n,e){if(n&1&&(l(0,"td",100),d(1),s(),l(2,"td",101),d(3),s()),n&2){let t=e.$implicit,i=_(5);f(),E(t.name),f(2),E(i.formatCurrency(t.amount))}}function VR(n,e){if(n&1&&(l(0,"tr",102)(1,"td",103),d(2),s(),l(3,"td",104),d(4),s(),O(5,kR,4,2,null,null,zh),s()),n&2){let t=e.$implicit,i=_(4);f(2),k("",t.month,"\u6708"),f(2),E(i.formatCurrency(t.total)),f(),L(t.items)}}function OR(n,e){if(n&1&&O(0,VR,7,2,"tr",102,pm),n&2){let t=_();L(t.data)}}function LR(n,e){if(n&1&&(l(0,"tr",99)(1,"td",106),d(2,"\u5C0F\u8A08"),s(),l(3,"td",107),d(4),s(),l(5,"td",107),d(6),s(),l(7,"td",107),d(8),s(),l(9,"td",108),d(10),s()()),n&2){let t=_(3);f(4),E(t.formatCurrency(t.detailModalTotal())),f(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u92B7\u8CA8\u6536\u5165"))),f(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u5176\u4ED6\u6536\u5165"))),f(2),k(" (",t.formatCurrency(t.calculateMonthlyItemTotal("-\u92B7\u8CA8\u6298\u8B93")),") ")}}function BR(n,e){if(n&1&&(l(0,"tr",99)(1,"td",106),d(2,"\u5C0F\u8A08"),s(),l(3,"td",107),d(4),s(),l(5,"td",107),d(6),s(),l(7,"td",107),d(8),s()()),n&2){let t=_(3);f(4),E(t.formatCurrency(t.detailModalTotal())),f(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u5546\u54C1"))),f(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u96DC\u9805\u8B8A\u52D5")))}}function UR(n,e){if(n&1&&(l(0,"tr",99)(1,"td",106),d(2,"\u5C0F\u8A08"),s(),l(3,"td",107),d(4),s(),l(5,"td",107),d(6),s(),l(7,"td",107),d(8),s(),l(9,"td",107),d(10),s(),l(11,"td",107),d(12),s(),l(13,"td",107),d(14),s()()),n&2){let t=_(3);f(4),E(t.formatCurrency(t.detailModalTotal())),f(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u61C9\u4ED8\u5E33\u6B3E"))),f(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u61C9\u4ED8\u88DD\u6F62\u6B3E"))),f(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u61C9\u4ED8\u85AA\u8CC7"))),f(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u61C9\u4ED8\u80A1\u6771\u56DE\u994B\u91D1"))),f(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8")))}}function $R(n,e){if(n&1&&(l(0,"td",106),d(1),s(),l(2,"td",107),d(3),s()),n&2){let t=e.$implicit,i=_(4);f(),E(t.name),f(2),E(i.formatCurrency(i.calculateMonthlyItemTotal(t.name)))}}function HR(n,e){if(n&1&&(l(0,"tr",99)(1,"td",106),d(2,"\u5C0F\u8A08"),s(),l(3,"td",107),d(4),s(),O(5,$R,4,2,null,null,zh),s()),n&2){let t=_(),i=_(2);f(4),E(i.formatCurrency(i.detailModalTotal())),f(),L(t.data[0].items)}}function GR(n,e){if(n&1){let t=B();l(0,"div",89)(1,"div",90)(2,"h3",91),d(3),s(),l(4,"button",92),b("click",function(){D(t);let r=_(2);return w(r.closeDetailModal())}),x(5,"ion-icon",93),s()(),l(6,"div",94)(7,"div",95),x(8,"canvas",null,0),s(),l(10,"div",96)(11,"table",33)(12,"thead",97),M(13,SR,11,0,"tr")(14,DR,9,0,"tr")(15,wR,15,0,"tr")(16,IR,7,0,"tr"),s(),l(17,"tbody"),M(18,AR,2,0)(19,NR,2,0)(20,PR,2,0)(21,OR,2,0),s(),l(22,"tfoot",98),M(23,LR,11,4,"tr",99)(24,BR,9,3,"tr",99)(25,UR,15,6,"tr",99)(26,HR,7,1,"tr",99),s()()()()()}if(n&2){let t=e,i=_(2);f(3),Kt("",t.year," \u5E74 ",t.type,"\u660E\u7D30 (\u7E3D\u8A08: ",i.formatCurrency(i.detailModalTotal()),")"),f(10),A(t.type==="\u6536\u5165"?13:t.type==="\u652F\u51FA"?14:t.type==="\u672A\u4ED8"?15:16),f(5),A(t.type==="\u6536\u5165"?18:t.type==="\u652F\u51FA"?19:t.type==="\u672A\u4ED8"?20:21),f(5),A(t.type==="\u6536\u5165"?23:t.type==="\u652F\u51FA"?24:t.type==="\u672A\u4ED8"?25:26)}}function qR(n,e){if(n&1&&(l(0,"div",12),M(1,GR,27,6,"div",89),s()),n&2){let t,i=_();f(),A((t=i.detailModalData())?1:-1,t)}}var Ma=class Ma{constructor(){this.apiService=P(Xe);this.activeStatement=S("summary");this.annualSummary=S(null);this.monthlyIncomeStatement=S(null);this.monthlyBalanceSheet=S(null);this.isLoading=S(!1);this.errorMessage=S(null);this.isDetailModalOpen=S(!1);this.detailModalData=S(null);this.years=S([2026,2025,2024]);this.quarters=S([{value:"all",label:"\u5168\u5E74"},{value:1,label:"\u7B2C\u4E00\u5B63"},{value:2,label:"\u7B2C\u4E8C\u5B63"},{value:3,label:"\u7B2C\u4E09\u5B63"},{value:4,label:"\u7B2C\u56DB\u5B63"}]);this.selectedYear=S(2026);this.selectedQuarter=S("all");this.selectedStartYearSummary=S(2024);this.selectedEndYearSummary=S(2026);this.selectedYearForDetail=S(2026);this.detailModalTotal=H(()=>{let e=this.detailModalData();return e?e.data.reduce((t,i)=>t+i.total,0):0});this.applySummaryFilter(),this.applyFilter()}set detailChartRef(e){this.destroyDetailChart(),e&&this.detailModalData()&&this.createDetailChart(e)}setActiveStatement(e){this.activeStatement.set(e)}convertToNumber(e){if(e==null)return 0;if(typeof e=="number")return e;if(typeof e=="string"){let t=parseFloat(e.replace(/[^0-9.-]/g,""));return isNaN(t)?0:t}return 0}normalizeIncomeStatement(e){if(!e)return e;let t=(i,r)=>{let o=i.items.map(h=>{let y={},v=0;return Object.entries(h.monthlyAmounts||{}).forEach(([C,T])=>{let R=this.convertToNumber(T);y[C]=R,v+=R}),G(V({},h),{monthlyAmounts:y,total:v})}),a=0,u={},c=o;if(r==="operatingRevenue"){o.some(T=>T.account?.includes("-\u92B7\u8CA8\u6298\u8B93"))&&(c=o.filter(T=>T.account!=="\u92B7\u8CA8\u6298\u8B93"));let y=c.find(T=>T.account.includes("\u92B7\u8CA8\u6536\u5165")),v=c.find(T=>T.account.includes("\u5176\u4ED6\u6536\u5165")),C=c.find(T=>T.account.includes("\u92B7\u8CA8\u6298\u8B93"));a=(y?.total||0)+(v?.total||0)-(C?.total||0),e.months&&e.months.forEach(T=>{let R=(y?.monthlyAmounts?.[T]||0)+(v?.monthlyAmounts?.[T]||0)-(C?.monthlyAmounts?.[T]||0);u[T]=Math.max(0,R)})}else r==="operatingExpenses"?(a=c.reduce((h,y)=>h+(y.total||0),0),e.months&&e.months.forEach(h=>{let y=c.reduce((v,C)=>v+(C.monthlyAmounts?.[h]||0),0);u[h]=y})):(a=c.reduce((h,y)=>h+(y.total||0),0),e.months&&e.months.forEach(h=>{let y=c.reduce((v,C)=>v+(C.monthlyAmounts?.[h]||0),0);u[h]=y}));let m=c.map(h=>{let y=a>0?h.total/a*100:0;return G(V({},h),{percentage:y})});return G(V({},i),{items:m,monthlyTotals:u,grandTotal:a})};return G(V({},e),{operatingRevenue:t(e.operatingRevenue,"operatingRevenue"),operatingExpenses:t(e.operatingExpenses,"operatingExpenses"),netIncome:{monthlyTotals:Object.entries(e.netIncome.monthlyTotals||{}).reduce((i,[r,o])=>(i[r]=this.convertToNumber(o),i),{}),grandTotal:this.convertToNumber(e.netIncome.grandTotal)}})}normalizeBalanceSheet(e){if(!e)return e;let t=i=>{let r=i.items.map(c=>{let m={},h=0;return Object.entries(c.monthlyAmounts||{}).forEach(([y,v])=>{let C=this.convertToNumber(v);m[y]=C,h+=C}),G(V({},c),{monthlyAmounts:m,total:h})}),o=r.reduce((c,m)=>c+(m.total||0),0),a=r.map(c=>{let m=o>0?c.total/o*100:0;return G(V({},c),{percentage:m})}),u={};return e.months&&e.months.forEach(c=>{let m=r.reduce((h,y)=>h+(y.monthlyAmounts?.[c]||0),0);u[c]=m}),G(V({},i),{items:a,monthlyTotals:u,grandTotal:o})};return G(V({},e),{assets:t(e.assets),liabilities:t(e.liabilities),equity:t(e.equity),totalLiabilitiesAndEquity:t(e.totalLiabilitiesAndEquity)})}async applyFilter(){let e=this.selectedYear(),t=this.selectedQuarter();this.isLoading.set(!0),this.errorMessage.set(null);try{let i=await this.apiService.getIncomeStatement(e,t);if(i.success&&i.data){let o=this.normalizeIncomeStatement(i.data);this.monthlyIncomeStatement.set(o)}else this.errorMessage.set(i.error||"\u7121\u6CD5\u53D6\u5F97\u640D\u76CA\u8868\u8CC7\u6599");let r=await this.apiService.getBalanceSheet(e,t);if(r.success&&r.data){let o=this.normalizeBalanceSheet(r.data);this.monthlyBalanceSheet.set(o)}else this.errorMessage.set(r.error||"\u7121\u6CD5\u53D6\u5F97\u8CC7\u7522\u8CA0\u50B5\u8868\u8CC7\u6599")}catch(i){console.error("Error loading financial statements:",i),this.errorMessage.set("\u53D6\u5F97\u8CA1\u52D9\u5831\u8868\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoading.set(!1)}}resetFilter(){this.selectedYear.set(2026),this.selectedQuarter.set("all"),this.applyFilter()}async applySummaryFilter(){let e=this.selectedStartYearSummary(),t=this.selectedEndYearSummary();e>t&&(this.selectedStartYearSummary.set(t),this.selectedEndYearSummary.set(e)),this.selectedYearForDetail.set(this.selectedEndYearSummary()),this.isLoading.set(!0),this.errorMessage.set(null);try{let i=await this.apiService.getAnnualSummary(this.selectedStartYearSummary(),this.selectedEndYearSummary());if(i.success&&i.data){let r=this.normalizeAnnualSummary(i.data);this.annualSummary.set(r)}else this.errorMessage.set(i.error||"\u7121\u6CD5\u53D6\u5F97\u5E74\u5EA6\u7E3D\u8868\u8CC7\u6599")}catch(i){console.error("Error loading annual summary:",i),this.errorMessage.set("\u53D6\u5F97\u5E74\u5EA6\u7E3D\u8868\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoading.set(!1)}}calculateRevenueBreakdown(e){let t={total:0},i={total:0};return Object.entries(e).forEach(([r,o])=>{if(r!=="total"){let a=parseInt(r,10);if(!isNaN(a)){let u=this.convertToNumber(o),c=Math.round(u*.9),m=u-c;t[a]=c,t.total+=c,i[a]=m,i.total+=m}}}),{salesRevenue:t,otherRevenue:i}}calculateExpenseBreakdown(e){let t={total:0},i={total:0};return Object.entries(e).forEach(([r,o])=>{if(r!=="total"){let a=parseInt(r,10);if(!isNaN(a)){let u=this.convertToNumber(o),c=Math.round(u*.35),m=u-c;t[a]=c,t.total+=c,i[a]=m,i.total+=m}}}),{merchandise:t,miscellaneous:i}}calculateUnpaidBreakdown(e){let t={total:0},i={total:0},r={total:0},o={total:0},a={total:0};return Object.entries(e).forEach(([u,c])=>{if(u!=="total"){let m=parseInt(u,10);if(!isNaN(m)){let h=this.convertToNumber(c),y=Math.round(h/5);t[m]=y,t.total+=y,i[m]=y,i.total+=y,r[m]=y,r.total+=y,o[m]=y,o.total+=y,a[m]=h-y*4,a.total+=h-y*4}}}),{accountsPayable:t,payableForRenovation:i,payableSalary:r,payableShareholderRebate:o,payableForGoods:a}}normalizeAnnualSummary(e){if(!e)return e;let t=G(V({},e),{revenue:Object.entries(e.revenue||{}).reduce((i,[r,o])=>{if(r==="total")i.total=this.convertToNumber(o);else{let a=parseInt(r,10);isNaN(a)||(i[a]=this.convertToNumber(o))}return i},{}),expense:Object.entries(e.expense||{}).reduce((i,[r,o])=>{if(r==="total")i.total=this.convertToNumber(o);else{let a=parseInt(r,10);isNaN(a)||(i[a]=this.convertToNumber(o))}return i},{}),net:Object.entries(e.net||{}).reduce((i,[r,o])=>{if(r==="total")i.total=this.convertToNumber(o);else{let a=parseInt(r,10);isNaN(a)||(i[a]=this.convertToNumber(o))}return i},{}),unpaid:Object.entries(e.unpaid||{}).reduce((i,[r,o])=>{if(r==="total")i.total=this.convertToNumber(o);else{let a=parseInt(r,10);isNaN(a)||(i[a]=this.convertToNumber(o))}return i},{})});return!t.revenueBreakdown&&t.revenue&&(t.revenueBreakdown=this.calculateRevenueBreakdown(t.revenue)),!t.expenseBreakdown&&t.expense&&(t.expenseBreakdown=this.calculateExpenseBreakdown(t.expense)),!t.unpaidBreakdown&&t.unpaid&&(t.unpaidBreakdown=this.calculateUnpaidBreakdown(t.unpaid)),t}resetSummaryFilter(){this.selectedStartYearSummary.set(2024),this.selectedEndYearSummary.set(2026),this.applySummaryFilter()}async openDetailModal(e,t){this.isLoading.set(!0),this.errorMessage.set(null);try{let i=await this.apiService.getFinancialStatementsDetails(e,t);i.success&&i.data?(this.detailModalData.set(i.data),this.isDetailModalOpen.set(!0)):(console.warn(`No detail data available for ${e} - ${t}`),this.errorMessage.set("\u7121\u6CD5\u53D6\u5F97\u660E\u7D30\u8CC7\u6599"))}catch(i){console.error("Error loading detail data:",i),this.errorMessage.set("\u53D6\u5F97\u660E\u7D30\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoading.set(!1)}}closeDetailModal(){this.isDetailModalOpen.set(!1),this.detailModalData.set(null),this.destroyDetailChart()}createDetailChart(e){let t=this.detailModalData();if(!e||!t||t.data.length===0)return;let i=t.data,r=i.map(m=>`${m.month}\u6708`),o=[];t.type==="\u6536\u5165"?o=["\u92B7\u8CA8\u6536\u5165","\u5176\u4ED6\u6536\u5165","-\u92B7\u8CA8\u6298\u8B93"]:t.type==="\u652F\u51FA"?o=["\u5546\u54C1","\u96DC\u9805\u8B8A\u52D5"]:t.type==="\u672A\u4ED8"?o=["\u61C9\u4ED8\u5E33\u6B3E","\u61C9\u4ED8\u88DD\u6F62\u6B3E","\u61C9\u4ED8\u85AA\u8CC7","\u61C9\u4ED8\u80A1\u6771\u56DE\u994B\u91D1","\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8"]:o=t.data[0]?.items.map(m=>m.name)||[];let a=["#4f46e5","#ef4444","#f59e0b","#10b981","#3b82f6","#8b5cf6"],u=[{label:"\u6708\u5EA6\u7E3D\u8A08",data:i.map(m=>m.total),borderColor:a[0],backgroundColor:"rgba(79, 70, 229, 0.1)",fill:!0,tension:.4,borderWidth:3,pointRadius:4}];o.forEach((m,h)=>{let y=i.map(v=>v.items.find(T=>T.name===m)?.amount||0);u.push({label:m,data:y,borderColor:a[(h+1)%a.length],backgroundColor:"transparent",fill:!1,tension:.4,borderDash:[5,5],borderWidth:2,pointRadius:3})});let c=e.nativeElement.getContext("2d");this.detailChart=new Chart(c,{type:"line",data:{labels:r,datasets:u},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!1,ticks:{callback:m=>this.formatCurrency(m)}}},plugins:{tooltip:{callbacks:{label:m=>`${m.dataset.label}: ${this.formatCurrency(m.raw)}`}}}}})}destroyDetailChart(){this.detailChart&&(this.detailChart.destroy(),this.detailChart=null)}calculateMonthlyItemTotal(e){let t=this.detailModalData();return t?t.data.reduce((i,r)=>{let o=r.items.find(a=>a.name===e);return i+(o?.amount||0)},0):0}getDetailItemAmount(e,t){let i=e.items.find(r=>r.name===t);return i?this.convertToNumber(i.amount):0}formatCurrency(e){return e==null?"NT$0":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}formatMonth(e){return`${parseInt(e.split("-")[1],10)}\u6708`}calculateColumnWidth(e){let i=this.formatCurrency(e).length;return`${Math.max(5.5,2+i*.5)}rem`}getMaxMonthColumnWidth(e){let t=6;return e.forEach(r=>{if(r!=null){let o=this.formatCurrency(r);t=Math.max(t,o.length)}}),`${Math.max(5.5,2+t*.5)}rem`}};Ma.\u0275fac=function(t){return new(t||Ma)},Ma.\u0275cmp=re({type:Ma,selectors:[["app-financial-statements"]],viewQuery:function(t,i){if(t&1&&Dn(M6,5),t&2){let r;on(r=an())&&(i.detailChartRef=r.first)}},decls:22,vars:12,consts:[["detailChart",""],[1,"space-y-6"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-4","flex","items-center","gap-3"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4","flex","items-center","gap-3"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"flex","flex-col","sm:flex-row","items-center","gap-2","bg-white","p-3","rounded-xl","shadow-md","border","border-gray-200"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"border-b","border-gray-200"],["aria-label","Tabs",1,"-mb-px","flex","space-x-6"],[1,"whitespace-nowrap","py-4","px-1","border-b-2","font-medium","text-sm",3,"click"],[1,"pt-6","overflow-x-auto"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50","transition-opacity"],["name","hourglass-outline",1,"text-blue-600","text-xl","animate-spin"],[1,"text-blue-700"],["name","alert-circle-outline",1,"text-red-600","text-xl"],[1,"text-red-700"],[1,"flex","items-center","gap-2"],["for","startYear",1,"text-sm","font-medium","text-gray-600"],["id","startYear",1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100","pr-8",3,"ngModelChange","ngModel"],[3,"value"],["for","endYear",1,"text-sm","font-medium","text-gray-600"],["id","endYear",1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100","pr-8",3,"ngModelChange","ngModel"],[1,"flex","items-center","gap-2","mt-2","sm:mt-0"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],["name","hourglass-outline",1,"animate-spin"],["name","filter-outline"],["for","year",1,"text-sm","font-medium","text-gray-600"],["id","year",1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100","pr-8",3,"ngModelChange","ngModel"],["for","quarter",1,"text-sm","font-medium","text-gray-600"],["id","quarter",1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100","pr-8",3,"ngModelChange","ngModel"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-center","py-8","text-gray-500"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50"],[1,"py-3","px-4"],[1,"py-3","px-4","text-right"],[1,"border-b","border-gray-100","bg-blue-50","font-semibold"],[1,"py-3","px-4","text-gray-800"],["name","folder-open-outline",1,"align-middle","mr-2"],[1,"py-3","px-4","text-right","font-medium","text-blue-600","cursor-pointer","hover:underline","hover:bg-blue-100"],[1,"py-3","px-4","text-right","font-bold"],[1,"border-b","border-gray-100","bg-red-50"],[1,"border-b","border-gray-100","bg-red-50","font-semibold"],[1,"py-3","px-4","text-right","font-medium","text-red-600","cursor-pointer","hover:underline","hover:bg-red-100"],[1,"border-b-2","border-gray-200","bg-gray-50","font-bold"],[1,"py-3","px-4","text-right",3,"text-red-600"],[1,"border-b","border-gray-100","bg-orange-50","font-semibold"],[1,"py-3","px-4","text-right","font-medium","text-orange-600","cursor-pointer","hover:underline","hover:bg-orange-100"],[1,"py-3","px-4","text-right","font-bold","hover:underline"],[1,"py-3","px-4","text-right","font-medium","text-blue-600","cursor-pointer","hover:underline","hover:bg-blue-100",3,"click"],[1,"py-3","px-4","text-gray-800","pl-8"],["name","remove-circle-outline",1,"align-middle","mr-2","text-red-500"],[1,"py-3","px-4","text-right","font-medium","text-red-600"],[1,"py-3","px-4","text-right","font-bold","text-red-600"],[1,"py-3","px-4","text-right","font-medium","text-red-600","cursor-pointer","hover:underline","hover:bg-red-100",3,"click"],[1,"py-3","px-4","text-right","font-medium","text-orange-600","cursor-pointer","hover:underline","hover:bg-orange-100",3,"click"],[1,"relative","overflow-x-auto"],[1,"py-3","px-2","w-16","sticky","left-0","bg-gray-50","z-20","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]"],[1,"py-3","px-2","w-24","sticky","bg-gray-50","z-20","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","4rem"],[1,"py-3","px-2","w-20","text-right","tabular-nums","sticky","bg-gray-50","z-20","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","10rem"],[1,"py-3","px-2","w-12","text-right","tabular-nums","sticky","bg-gray-50","z-20","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","16rem"],[1,"py-3","px-2","text-right","text-xs","w-fit"],[1,"font-semibold","text-gray-800","bg-gray-100"],["colspan","4",1,"py-2","px-2","sticky","left-0","bg-gray-100","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]"],[1,"border-b","border-gray-100","hover:bg-gray-50"],[1,"font-semibold","text-gray-900","bg-gray-50","border-t-2","border-gray-200"],["colspan","2",1,"py-2","px-2","sticky","left-0","bg-gray-50","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]"],[1,"py-2","px-2","text-right","tabular-nums","font-medium","sticky","bg-gray-50","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","10rem"],[1,"py-2","px-2","text-right","tabular-nums","sticky","bg-gray-50","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","16rem"],[1,"py-2","px-2","text-right","text-xs","font-semibold","w-fit"],[1,"py-2"],[1,"font-bold","text-base","text-white","bg-indigo-600"],["colspan","2",1,"py-3","px-2","sticky","left-0","bg-indigo-600","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.3)]"],[1,"py-3","px-2","text-right","tabular-nums","sticky","bg-indigo-600","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.3)]",2,"left","10rem"],[1,"py-3","px-2","sticky","bg-indigo-600","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.3)]",2,"left","16rem"],[1,"py-3","px-2","text-right","text-xs","font-bold","w-fit"],[1,"py-2","px-2","sticky","left-0","bg-white","hover:bg-gray-50","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]"],[1,"py-2","px-2","sticky","bg-white","hover:bg-gray-50","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","4rem"],[1,"py-2","px-2","text-right","tabular-nums","font-medium","sticky","bg-white","hover:bg-gray-50","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","10rem"],[1,"py-2","px-2","text-right","tabular-nums","sticky","bg-white","hover:bg-gray-50","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","16rem"],[1,"py-2","px-2","text-right","text-xs","w-fit"],[1,"py-2","px-2","text-right","tabular-nums","font-bold","text-indigo-600","sticky","bg-gray-50","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","10rem"],[1,"font-semibold","text-gray-900","border-t-2","border-gray-200"],["colspan","2",1,"py-2","px-2","sticky","left-0","bg-white","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]"],[1,"py-2","px-2","text-right","tabular-nums","font-medium","sticky","bg-white","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","10rem"],[1,"py-2","px-2","text-right","tabular-nums","sticky","bg-white","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","16rem"],[1,"py-2","px-2","text-right","text-xs","font-bold","w-fit"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-6xl","max-h-[90vh]","flex","flex-col","m-4"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600","p-1","rounded-full","hover:bg-gray-100",3,"click"],["name","close-outline",1,"text-2xl"],[1,"flex-1","flex","flex-col","p-6","overflow-hidden"],[1,"h-64","mb-6"],[1,"flex-1","overflow-y-auto"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50","sticky","top-0"],[1,"font-bold","bg-gray-100","sticky","bottom-0"],[1,"border-t-2"],[1,"px-4","py-2"],[1,"px-4","py-2","text-right"],[1,"border-b","hover:bg-gray-50"],[1,"px-4","py-2","font-medium"],[1,"px-4","py-2","text-right","font-semibold"],[1,"px-4","py-2","text-right","text-red-600"],[1,"px-4","py-3"],[1,"px-4","py-3","text-right"],[1,"px-4","py-3","text-right","text-red-600"]],template:function(t,i){if(t&1&&(l(0,"div",1),M(1,R6,4,0,"div",2),M(2,N6,4,1,"div",3),l(3,"div",4)(4,"h1",5),d(5,"\u8CA1\u52D9\u5831\u8868"),s(),M(6,O6,19,4,"div",6),M(7,H6,19,4,"div",6),s(),l(8,"div",7)(9,"div",8)(10,"nav",9)(11,"button",10),b("click",function(){return i.setActiveStatement("summary")}),d(12," \u7E3D\u8868 "),s(),l(13,"button",10),b("click",function(){return i.setActiveStatement("income")}),d(14," \u640D\u76CA\u8868 "),s(),l(15,"button",10),b("click",function(){return i.setActiveStatement("balance")}),d(16," \u8CC7\u7522\u8CA0\u50B5\u8868 "),s()()(),l(17,"div",11),M(18,Z6,2,1)(19,uR,2,1)(20,ER,2,1),s()()(),M(21,qR,2,1,"div",12)),t&2){let r;f(),A(i.isLoading()?1:-1),f(),A(i.errorMessage()?2:-1),f(4),A(i.activeStatement()==="summary"?6:-1),f(),A(i.activeStatement()==="income"||i.activeStatement()==="balance"?7:-1),f(4),De(i.activeStatement()==="summary"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),f(2),De(i.activeStatement()==="income"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),f(2),De(i.activeStatement()==="balance"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),f(3),A((r=i.activeStatement())==="summary"?18:r==="income"?19:r==="balance"?20:-1),f(3),A(i.isDetailModalOpen()?21:-1)}},dependencies:[oe,Se,Fe,Pe,Re,me,Ie],encapsulation:2,changeDetection:0});var mm=Ma;var WR,jR;function zR(){return{geminiUrl:WR,vertexUrl:jR}}function YR(n,e,t,i){var r,o;if(!n?.baseUrl){let a=zR();return e?(r=a.vertexUrl)!==null&&r!==void 0?r:t:(o=a.geminiUrl)!==null&&o!==void 0?o:i}return n.baseUrl}var ui=class{};function ee(n,e){let t=/\{([^}]+)\}/g;return n.replace(t,(i,r)=>{if(Object.prototype.hasOwnProperty.call(e,r)){let o=e[r];return o!=null?String(o):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function g(n,e,t){for(let o=0;o<e.length-1;o++){let a=e[o];if(a.endsWith("[]")){let u=a.slice(0,-2);if(!(u in n))if(Array.isArray(t))n[u]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${a}`);if(Array.isArray(n[u])){let c=n[u];if(Array.isArray(t))for(let m=0;m<c.length;m++){let h=c[m];g(h,e.slice(o+1),t[m])}else for(let m of c)g(m,e.slice(o+1),t)}return}else if(a.endsWith("[0]")){let u=a.slice(0,-3);u in n||(n[u]=[{}]);let c=n[u];g(c[0],e.slice(o+1),t);return}(!n[a]||typeof n[a]!="object")&&(n[a]={}),n=n[a]}let i=e[e.length-1],r=n[i];if(r!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===r)return;if(typeof r=="object"&&typeof t=="object"&&r!==null&&t!==null)Object.assign(r,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[i]=t}function p(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let i=0;i<e.length;i++){if(typeof n!="object"||n===null)return t;let r=e[i];if(r.endsWith("[]")){let o=r.slice(0,-2);if(o in n){let a=n[o];return Array.isArray(a)?a.map(u=>p(u,e.slice(i+1),t)):t}else return t}else n=n[r]}return n}catch(i){if(i instanceof TypeError)return t;throw i}}function JR(n,e){for(let[t,i]of Object.entries(e)){let r=t.split("."),o=i.split("."),a=new Set,u=-1;for(let c=0;c<r.length;c++)if(r[c]==="*"){u=c;break}if(u!==-1&&o.length>u)for(let c=u;c<o.length;c++){let m=o[c];m!=="*"&&!m.endsWith("[]")&&!m.endsWith("[0]")&&a.add(m)}Kh(n,r,o,0,a)}}function Kh(n,e,t,i,r){if(i>=e.length||typeof n!="object"||n===null)return;let o=e[i];if(o.endsWith("[]")){let a=o.slice(0,-2),u=n;if(a in u&&Array.isArray(u[a]))for(let c of u[a])Kh(c,e,t,i+1,r)}else if(o==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){let a=n,u=Object.keys(a).filter(m=>!m.startsWith("_")&&!r.has(m)),c={};for(let m of u)c[m]=a[m];for(let[m,h]of Object.entries(c)){let y=[];for(let v of t.slice(i))v==="*"?y.push(m):y.push(v);g(a,y,h)}for(let m of u)delete a[m]}}else{let a=n;o in a&&Kh(a[o],e,t,i+1,r)}}function Yy(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}function KR(n){let e={},t=p(n,["operationName"]);t!=null&&g(e,["operationName"],t);let i=p(n,["resourceName"]);return i!=null&&g(e,["_url","resourceName"],i),e}function QR(n){let e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);let i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);let r=p(n,["done"]);r!=null&&g(e,["done"],r);let o=p(n,["error"]);o!=null&&g(e,["error"],o);let a=p(n,["response","generateVideoResponse"]);return a!=null&&g(e,["response"],XR(a)),e}function ZR(n){let e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);let i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);let r=p(n,["done"]);r!=null&&g(e,["done"],r);let o=p(n,["error"]);o!=null&&g(e,["error"],o);let a=p(n,["response"]);return a!=null&&g(e,["response"],e4(a)),e}function XR(n){let e={},t=p(n,["generatedSamples"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(a=>t4(a))),g(e,["generatedVideos"],o)}let i=p(n,["raiMediaFilteredCount"]);i!=null&&g(e,["raiMediaFilteredCount"],i);let r=p(n,["raiMediaFilteredReasons"]);return r!=null&&g(e,["raiMediaFilteredReasons"],r),e}function e4(n){let e={},t=p(n,["videos"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(a=>n4(a))),g(e,["generatedVideos"],o)}let i=p(n,["raiMediaFilteredCount"]);i!=null&&g(e,["raiMediaFilteredCount"],i);let r=p(n,["raiMediaFilteredReasons"]);return r!=null&&g(e,["raiMediaFilteredReasons"],r),e}function t4(n){let e={},t=p(n,["video"]);return t!=null&&g(e,["video"],l4(t)),e}function n4(n){let e={},t=p(n,["_self"]);return t!=null&&g(e,["video"],u4(t)),e}function i4(n){let e={},t=p(n,["operationName"]);return t!=null&&g(e,["_url","operationName"],t),e}function r4(n){let e={},t=p(n,["operationName"]);return t!=null&&g(e,["_url","operationName"],t),e}function o4(n){let e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);let i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);let r=p(n,["done"]);r!=null&&g(e,["done"],r);let o=p(n,["error"]);o!=null&&g(e,["error"],o);let a=p(n,["response"]);return a!=null&&g(e,["response"],a4(a)),e}function a4(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["parent"]);i!=null&&g(e,["parent"],i);let r=p(n,["documentName"]);return r!=null&&g(e,["documentName"],r),e}function s2(n){let e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);let i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);let r=p(n,["done"]);r!=null&&g(e,["done"],r);let o=p(n,["error"]);o!=null&&g(e,["error"],o);let a=p(n,["response"]);return a!=null&&g(e,["response"],s4(a)),e}function s4(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["parent"]);i!=null&&g(e,["parent"],i);let r=p(n,["documentName"]);return r!=null&&g(e,["documentName"],r),e}function l4(n){let e={},t=p(n,["uri"]);t!=null&&g(e,["uri"],t);let i=p(n,["encodedVideo"]);i!=null&&g(e,["videoBytes"],Yy(i));let r=p(n,["encoding"]);return r!=null&&g(e,["mimeType"],r),e}function u4(n){let e={},t=p(n,["gcsUri"]);t!=null&&g(e,["uri"],t);let i=p(n,["bytesBase64Encoded"]);i!=null&&g(e,["videoBytes"],Yy(i));let r=p(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}var mt=(function(n){return n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL",n})(mt||{});var Qh=(function(n){return n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO",n})(Qh||{});var l2=(function(n){return n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED",n})(l2||{});var u2=(function(n){return n.COLLECTION="COLLECTION",n})(u2||{});var Yl=(function(n){return n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT",n})(Yl||{});var Kl=class{constructor(e){let t={};for(let i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}};var ho=class{get text(){var e,t,i,r,o,a,u,c;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let m="",h=!1,y=[];for(let v of(c=(u=(a=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)!==null&&c!==void 0?c:[]){for(let[C,T]of Object.entries(v))C!=="text"&&C!=="thought"&&C!=="thoughtSignature"&&(T!==null||T!==void 0)&&y.push(C);if(typeof v.text=="string"){if(typeof v.thought=="boolean"&&v.thought)continue;h=!0,m+=v.text}}return y.length>0&&console.warn(`there are non-text parts ${y} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),h?m:void 0}get data(){var e,t,i,r,o,a,u,c;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let m="",h=[];for(let y of(c=(u=(a=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)!==null&&c!==void 0?c:[]){for(let[v,C]of Object.entries(y))v!=="inlineData"&&(C!==null||C!==void 0)&&h.push(v);y.inlineData&&typeof y.inlineData.data=="string"&&(m+=atob(y.inlineData.data))}return h.length>0&&console.warn(`there are non-data parts ${h} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),m.length>0?btoa(m):void 0}get functionCalls(){var e,t,i,r,o,a,u,c;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");let m=(c=(u=(a=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(h=>h.functionCall).map(h=>h.functionCall).filter(h=>h!==void 0);if(m?.length!==0)return m}get executableCode(){var e,t,i,r,o,a,u,c,m;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");let h=(c=(u=(a=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(y=>y.executableCode).map(y=>y.executableCode).filter(y=>y!==void 0);if(h?.length!==0)return(m=h?.[0])===null||m===void 0?void 0:m.code}get codeExecutionResult(){var e,t,i,r,o,a,u,c,m;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");let h=(c=(u=(a=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(y=>y.codeExecutionResult).map(y=>y.codeExecutionResult).filter(y=>y!==void 0);if(h?.length!==0)return(m=h?.[0])===null||m===void 0?void 0:m.output}},xm=class{},bm=class{},Zh=class{},Xh=class{},ey=class{},ty=class{},Em=class{},Sm=class{},Dm=class{},ny=class{};var wm=class n{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){let i=new n,r,o=e;return t?r=ZR(o):r=QR(o),Object.assign(i,r),i}},Tm=class{},Im=class{},Mm=class{},Am=class{},iy=class{},ry=class{},oy=class{};var ay=class n{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){let i=new n,o=o4(e);return Object.assign(i,o),i}},sy=class{},ly=class{},uy=class{};var Rm=class{};var dy=class{get text(){var e,t,i;let r="",o=!1,a=[];for(let u of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(let[c,m]of Object.entries(u))c!=="text"&&c!=="thought"&&m!==null&&a.push(c);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;o=!0,r+=u.text}}return a.length>0&&console.warn(`there are non-text parts ${a} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?r:void 0}get data(){var e,t,i;let r="",o=[];for(let a of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(let[u,c]of Object.entries(a))u!=="inlineData"&&c!==null&&o.push(u);a.inlineData&&typeof a.inlineData.data=="string"&&(r+=atob(a.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),r.length>0?btoa(r):void 0}};var cy=class{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}};var my=class n{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){let i=new n,o=s2(e);return Object.assign(i,o),i}};function $e(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){let t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function d2(n,e){let t=$e(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function c2(n){return Array.isArray(n)?n.map(e=>Nm(e)):[Nm(n)]}function Nm(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function m2(n){let e=Nm(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function p2(n){let e=Nm(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function VE(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function f2(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>VE(e)):[VE(n)]}function py(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function OE(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function LE(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function Xt(n){if(n==null)throw new Error("ContentUnion is required");return py(n)?n:{role:"user",parts:f2(n)}}function Jy(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{let i=Xt(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){let t=Xt(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Xt(t)):[Xt(e)]}function qn(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(OE(n)||LE(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Xt(n)]}let e=[],t=[],i=py(n[0]);for(let r of n){let o=py(r);if(o!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)e.push(r);else{if(OE(r)||LE(r))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(r)}}return i||e.push({role:"user",parts:f2(t)}),e}function d4(n,e){n.includes("null")&&(e.nullable=!0);let t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(mt).includes(t[0].toUpperCase())?t[0].toUpperCase():mt.TYPE_UNSPECIFIED;else{e.anyOf=[];for(let i of t)e.anyOf.push({type:Object.values(mt).includes(i.toUpperCase())?i.toUpperCase():mt.TYPE_UNSPECIFIED})}}function Ra(n){let e={},t=["items"],i=["anyOf"],r=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");let o=n.anyOf;o!=null&&o.length==2&&(o[0].type==="null"?(e.nullable=!0,n=o[1]):o[1].type==="null"&&(e.nullable=!0,n=o[0])),n.type instanceof Array&&d4(n.type,e);for(let[a,u]of Object.entries(n))if(u!=null)if(a=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;e.type=Object.values(mt).includes(u.toUpperCase())?u.toUpperCase():mt.TYPE_UNSPECIFIED}else if(t.includes(a))e[a]=Ra(u);else if(i.includes(a)){let c=[];for(let m of u){if(m.type=="null"){e.nullable=!0;continue}c.push(Ra(m))}e[a]=c}else if(r.includes(a)){let c={};for(let[m,h]of Object.entries(u))c[m]=Ra(h);e[a]=c}else{if(a==="additionalProperties")continue;e[a]=u}return e}function Ky(n){return Ra(n)}function Qy(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Zy(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function ka(n){if(n.functionDeclarations)for(let e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Ra(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Ra(e.response));return n}function Va(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");let e=[];for(let t of n)e.push(t);return e}function c4(n,e,t,i=1){let r=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:r?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:r?`${t}/${e}`:e}function Qi(n,e){if(typeof e!="string")throw new Error("name must be a string");return c4(n,e,"cachedContents")}function g2(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function br(n){return Yy(n)}function m4(n){return n!=null&&typeof n=="object"&&"name"in n}function p4(n){return n!=null&&typeof n=="object"&&"video"in n}function f4(n){return n!=null&&typeof n=="object"&&"uri"in n}function h2(n){var e;let t;if(m4(n)&&(t=n.name),!(f4(n)&&(t=n.uri,t===void 0))&&!(p4(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){let r=t.split("files/")[1].match(/[a-z0-9]+/);if(r===null)throw new Error(`Could not extract file name from URI ${t}`);t=r[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function y2(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function _2(n){for(let e of["models","tunedModels","publisherModels"])if(g4(n,e))return n[e];return[]}function g4(n,e){return n!==null&&typeof n=="object"&&e in n}function h4(n,e={}){let t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(i.responseJsonSchema=t.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function y4(n,e={}){let t=[],i=new Set;for(let r of n){let o=r.name;if(i.has(o))throw new Error(`Duplicate function name ${o} found in MCP tools. Please ensure function names are unique.`);i.add(o);let a=h4(r,e);a.functionDeclarations&&t.push(...a.functionDeclarations)}return{functionDeclarations:t}}function v2(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;let i=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,r=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(r>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||r!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function _4(n){if(typeof n!="string")return n;let e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function C2(n){if(typeof n!="object"||n===null)return{};let e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;let r=t.inlinedResponses;if(!Array.isArray(r)||r.length===0)return n;let o=!1;for(let a of r){if(typeof a!="object"||a===null)continue;let c=a.response;if(typeof c!="object"||c===null)continue;if(c.embedding!==void 0){o=!0;break}}return o&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function Oa(n,e){let t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function x2(n){let e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}function v4(n){let e={},t=p(n,["responsesFile"]);t!=null&&g(e,["fileName"],t);let i=p(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>X4(a))),g(e,["inlinedResponses"],o)}let r=p(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>a)),g(e,["inlinedEmbedContentResponses"],o)}return e}function C4(n){let e={},t=p(n,["predictionsFormat"]);t!=null&&g(e,["format"],t);let i=p(n,["gcsDestination","outputUriPrefix"]);i!=null&&g(e,["gcsUri"],i);let r=p(n,["bigqueryDestination","outputUri"]);return r!=null&&g(e,["bigqueryUri"],r),e}function x4(n){let e={},t=p(n,["format"]);t!=null&&g(e,["predictionsFormat"],t);let i=p(n,["gcsUri"]);i!=null&&g(e,["gcsDestination","outputUriPrefix"],i);let r=p(n,["bigqueryUri"]);if(r!=null&&g(e,["bigqueryDestination","outputUri"],r),p(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(p(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(p(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function vm(n){let e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);let i=p(n,["metadata","displayName"]);i!=null&&g(e,["displayName"],i);let r=p(n,["metadata","state"]);r!=null&&g(e,["state"],x2(r));let o=p(n,["metadata","createTime"]);o!=null&&g(e,["createTime"],o);let a=p(n,["metadata","endTime"]);a!=null&&g(e,["endTime"],a);let u=p(n,["metadata","updateTime"]);u!=null&&g(e,["updateTime"],u);let c=p(n,["metadata","model"]);c!=null&&g(e,["model"],c);let m=p(n,["metadata","output"]);return m!=null&&g(e,["dest"],v4(C2(m))),e}function fy(n){let e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);let i=p(n,["displayName"]);i!=null&&g(e,["displayName"],i);let r=p(n,["state"]);r!=null&&g(e,["state"],x2(r));let o=p(n,["error"]);o!=null&&g(e,["error"],o);let a=p(n,["createTime"]);a!=null&&g(e,["createTime"],a);let u=p(n,["startTime"]);u!=null&&g(e,["startTime"],u);let c=p(n,["endTime"]);c!=null&&g(e,["endTime"],c);let m=p(n,["updateTime"]);m!=null&&g(e,["updateTime"],m);let h=p(n,["model"]);h!=null&&g(e,["model"],h);let y=p(n,["inputConfig"]);y!=null&&g(e,["src"],b4(y));let v=p(n,["outputConfig"]);v!=null&&g(e,["dest"],C4(C2(v)));let C=p(n,["completionStats"]);return C!=null&&g(e,["completionStats"],C),e}function b4(n){let e={},t=p(n,["instancesFormat"]);t!=null&&g(e,["format"],t);let i=p(n,["gcsSource","uris"]);i!=null&&g(e,["gcsUri"],i);let r=p(n,["bigquerySource","inputUri"]);return r!=null&&g(e,["bigqueryUri"],r),e}function E4(n,e){let t={};if(p(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(p(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(p(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");let i=p(e,["fileName"]);i!=null&&g(t,["fileName"],i);let r=p(e,["inlinedRequests"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>Z4(n,a))),g(t,["requests","requests"],o)}return t}function S4(n){let e={},t=p(n,["format"]);t!=null&&g(e,["instancesFormat"],t);let i=p(n,["gcsUri"]);i!=null&&g(e,["gcsSource","uris"],i);let r=p(n,["bigqueryUri"]);if(r!=null&&g(e,["bigquerySource","inputUri"],r),p(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(p(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function D4(n){let e={},t=p(n,["data"]);if(t!=null&&g(e,["data"],t),p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function w4(n,e){let t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],Oa(n,i)),t}function T4(n,e){let t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],Oa(n,i)),t}function I4(n){let e={},t=p(n,["content"]);t!=null&&g(e,["content"],t);let i=p(n,["citationMetadata"]);i!=null&&g(e,["citationMetadata"],M4(i));let r=p(n,["tokenCount"]);r!=null&&g(e,["tokenCount"],r);let o=p(n,["finishReason"]);o!=null&&g(e,["finishReason"],o);let a=p(n,["avgLogprobs"]);a!=null&&g(e,["avgLogprobs"],a);let u=p(n,["groundingMetadata"]);u!=null&&g(e,["groundingMetadata"],u);let c=p(n,["index"]);c!=null&&g(e,["index"],c);let m=p(n,["logprobsResult"]);m!=null&&g(e,["logprobsResult"],m);let h=p(n,["safetyRatings"]);if(h!=null){let v=h;Array.isArray(v)&&(v=v.map(C=>C)),g(e,["safetyRatings"],v)}let y=p(n,["urlContextMetadata"]);return y!=null&&g(e,["urlContextMetadata"],y),e}function M4(n){let e={},t=p(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),g(e,["citations"],i)}return e}function b2(n){let e={},t=p(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>aN(o))),g(e,["parts"],r)}let i=p(n,["role"]);return i!=null&&g(e,["role"],i),e}function A4(n,e){let t={},i=p(n,["displayName"]);if(e!==void 0&&i!=null&&g(e,["batch","displayName"],i),p(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function R4(n,e){let t={},i=p(n,["displayName"]);e!==void 0&&i!=null&&g(e,["displayName"],i);let r=p(n,["dest"]);return e!==void 0&&r!=null&&g(e,["outputConfig"],x4(_4(r))),t}function BE(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],$e(n,i));let r=p(e,["src"]);r!=null&&g(t,["batch","inputConfig"],E4(n,v2(n,r)));let o=p(e,["config"]);return o!=null&&A4(o,t),t}function N4(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["model"],$e(n,i));let r=p(e,["src"]);r!=null&&g(t,["inputConfig"],S4(v2(n,r)));let o=p(e,["config"]);return o!=null&&R4(o,t),t}function F4(n,e){let t={},i=p(n,["displayName"]);return e!==void 0&&i!=null&&g(e,["batch","displayName"],i),t}function P4(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],$e(n,i));let r=p(e,["src"]);r!=null&&g(t,["batch","inputConfig"],$4(n,r));let o=p(e,["config"]);return o!=null&&F4(o,t),t}function k4(n,e){let t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],Oa(n,i)),t}function V4(n,e){let t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],Oa(n,i)),t}function O4(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["name"]);i!=null&&g(e,["name"],i);let r=p(n,["done"]);r!=null&&g(e,["done"],r);let o=p(n,["error"]);return o!=null&&g(e,["error"],o),e}function L4(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["name"]);i!=null&&g(e,["name"],i);let r=p(n,["done"]);r!=null&&g(e,["done"],r);let o=p(n,["error"]);return o!=null&&g(e,["error"],o),e}function B4(n,e){let t={},i=p(e,["contents"]);if(i!=null){let o=Jy(n,i);Array.isArray(o)&&(o=o.map(a=>a)),g(t,["requests[]","request","content"],o)}let r=p(e,["config"]);return r!=null&&(g(t,["_self"],U4(r,t)),JR(t,{"requests[].*":"requests[].request.*"})),t}function U4(n,e){let t={},i=p(n,["taskType"]);e!==void 0&&i!=null&&g(e,["requests[]","taskType"],i);let r=p(n,["title"]);e!==void 0&&r!=null&&g(e,["requests[]","title"],r);let o=p(n,["outputDimensionality"]);if(e!==void 0&&o!=null&&g(e,["requests[]","outputDimensionality"],o),p(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(p(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function $4(n,e){let t={},i=p(e,["fileName"]);i!=null&&g(t,["file_name"],i);let r=p(e,["inlinedRequests"]);return r!=null&&g(t,["requests"],B4(n,r)),t}function H4(n){let e={};if(p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let t=p(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);let i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function G4(n){let e={},t=p(n,["id"]);t!=null&&g(e,["id"],t);let i=p(n,["args"]);i!=null&&g(e,["args"],i);let r=p(n,["name"]);if(r!=null&&g(e,["name"],r),p(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function q4(n){let e={},t=p(n,["allowedFunctionNames"]);t!=null&&g(e,["allowedFunctionNames"],t);let i=p(n,["mode"]);if(i!=null&&g(e,["mode"],i),p(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function W4(n,e,t){let i={},r=p(e,["systemInstruction"]);t!==void 0&&r!=null&&g(t,["systemInstruction"],b2(Xt(r)));let o=p(e,["temperature"]);o!=null&&g(i,["temperature"],o);let a=p(e,["topP"]);a!=null&&g(i,["topP"],a);let u=p(e,["topK"]);u!=null&&g(i,["topK"],u);let c=p(e,["candidateCount"]);c!=null&&g(i,["candidateCount"],c);let m=p(e,["maxOutputTokens"]);m!=null&&g(i,["maxOutputTokens"],m);let h=p(e,["stopSequences"]);h!=null&&g(i,["stopSequences"],h);let y=p(e,["responseLogprobs"]);y!=null&&g(i,["responseLogprobs"],y);let v=p(e,["logprobs"]);v!=null&&g(i,["logprobs"],v);let C=p(e,["presencePenalty"]);C!=null&&g(i,["presencePenalty"],C);let T=p(e,["frequencyPenalty"]);T!=null&&g(i,["frequencyPenalty"],T);let R=p(e,["seed"]);R!=null&&g(i,["seed"],R);let N=p(e,["responseMimeType"]);N!=null&&g(i,["responseMimeType"],N);let F=p(e,["responseSchema"]);F!=null&&g(i,["responseSchema"],Ky(F));let $=p(e,["responseJsonSchema"]);if($!=null&&g(i,["responseJsonSchema"],$),p(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(p(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");let q=p(e,["safetySettings"]);if(t!==void 0&&q!=null){let pt=q;Array.isArray(pt)&&(pt=pt.map(mi=>sN(mi))),g(t,["safetySettings"],pt)}let Q=p(e,["tools"]);if(t!==void 0&&Q!=null){let pt=Va(Q);Array.isArray(pt)&&(pt=pt.map(mi=>uN(ka(mi)))),g(t,["tools"],pt)}let ie=p(e,["toolConfig"]);if(t!==void 0&&ie!=null&&g(t,["toolConfig"],lN(ie)),p(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");let de=p(e,["cachedContent"]);t!==void 0&&de!=null&&g(t,["cachedContent"],Qi(n,de));let le=p(e,["responseModalities"]);le!=null&&g(i,["responseModalities"],le);let Oe=p(e,["mediaResolution"]);Oe!=null&&g(i,["mediaResolution"],Oe);let pe=p(e,["speechConfig"]);if(pe!=null&&g(i,["speechConfig"],Qy(pe)),p(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");let we=p(e,["thinkingConfig"]);we!=null&&g(i,["thinkingConfig"],we);let Ct=p(e,["imageConfig"]);Ct!=null&&g(i,["imageConfig"],Q4(Ct));let ci=p(e,["enableEnhancedCivicAnswers"]);if(ci!=null&&g(i,["enableEnhancedCivicAnswers"],ci),p(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return i}function j4(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["candidates"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(m=>I4(m))),g(e,["candidates"],c)}let r=p(n,["modelVersion"]);r!=null&&g(e,["modelVersion"],r);let o=p(n,["promptFeedback"]);o!=null&&g(e,["promptFeedback"],o);let a=p(n,["responseId"]);a!=null&&g(e,["responseId"],a);let u=p(n,["usageMetadata"]);return u!=null&&g(e,["usageMetadata"],u),e}function z4(n,e){let t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],Oa(n,i)),t}function Y4(n,e){let t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],Oa(n,i)),t}function J4(n){let e={};if(p(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");let t=p(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function K4(n){let e={};if(p(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");let t=p(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function Q4(n){let e={},t=p(n,["aspectRatio"]);t!=null&&g(e,["aspectRatio"],t);let i=p(n,["imageSize"]);if(i!=null&&g(e,["imageSize"],i),p(n,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(p(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(p(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function Z4(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["request","model"],$e(n,i));let r=p(e,["contents"]);if(r!=null){let u=qn(r);Array.isArray(u)&&(u=u.map(c=>b2(c))),g(t,["request","contents"],u)}let o=p(e,["metadata"]);o!=null&&g(t,["metadata"],o);let a=p(e,["config"]);return a!=null&&g(t,["request","generationConfig"],W4(n,a,p(t,["request"],{}))),t}function X4(n){let e={},t=p(n,["response"]);t!=null&&g(e,["response"],j4(t));let i=p(n,["error"]);return i!=null&&g(e,["error"],i),e}function eN(n,e){let t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);let r=p(n,["pageToken"]);if(e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),p(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function tN(n,e){let t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);let r=p(n,["pageToken"]);e!==void 0&&r!=null&&g(e,["_query","pageToken"],r);let o=p(n,["filter"]);return e!==void 0&&o!=null&&g(e,["_query","filter"],o),t}function nN(n){let e={},t=p(n,["config"]);return t!=null&&eN(t,e),e}function iN(n){let e={},t=p(n,["config"]);return t!=null&&tN(t,e),e}function rN(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);let r=p(n,["operations"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>vm(a))),g(e,["batchJobs"],o)}return e}function oN(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);let r=p(n,["batchPredictionJobs"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>fy(a))),g(e,["batchJobs"],o)}return e}function aN(n){let e={},t=p(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);let i=p(n,["codeExecutionResult"]);i!=null&&g(e,["codeExecutionResult"],i);let r=p(n,["executableCode"]);r!=null&&g(e,["executableCode"],r);let o=p(n,["fileData"]);o!=null&&g(e,["fileData"],H4(o));let a=p(n,["functionCall"]);a!=null&&g(e,["functionCall"],G4(a));let u=p(n,["functionResponse"]);u!=null&&g(e,["functionResponse"],u);let c=p(n,["inlineData"]);c!=null&&g(e,["inlineData"],D4(c));let m=p(n,["text"]);m!=null&&g(e,["text"],m);let h=p(n,["thought"]);h!=null&&g(e,["thought"],h);let y=p(n,["thoughtSignature"]);y!=null&&g(e,["thoughtSignature"],y);let v=p(n,["videoMetadata"]);return v!=null&&g(e,["videoMetadata"],v),e}function sN(n){let e={},t=p(n,["category"]);if(t!=null&&g(e,["category"],t),p(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");let i=p(n,["threshold"]);return i!=null&&g(e,["threshold"],i),e}function lN(n){let e={},t=p(n,["retrievalConfig"]);t!=null&&g(e,["retrievalConfig"],t);let i=p(n,["functionCallingConfig"]);return i!=null&&g(e,["functionCallingConfig"],q4(i)),e}function uN(n){let e={};if(p(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");let t=p(n,["computerUse"]);t!=null&&g(e,["computerUse"],t);let i=p(n,["fileSearch"]);i!=null&&g(e,["fileSearch"],i);let r=p(n,["codeExecution"]);if(r!=null&&g(e,["codeExecution"],r),p(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");let o=p(n,["functionDeclarations"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(y=>y)),g(e,["functionDeclarations"],h)}let a=p(n,["googleMaps"]);a!=null&&g(e,["googleMaps"],J4(a));let u=p(n,["googleSearch"]);u!=null&&g(e,["googleSearch"],K4(u));let c=p(n,["googleSearchRetrieval"]);c!=null&&g(e,["googleSearchRetrieval"],c);let m=p(n,["urlContext"]);return m!=null&&g(e,["urlContext"],m),e}var Er=(function(n){return n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents",n})(Er||{}),Ki=class{constructor(e,t,i,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,r)}init(e,t,i){var r,o;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t?.sdkHttpResponse,this.idxInternal=0;let a={config:{}};!i||Object.keys(i).length===0?a={config:{}}:typeof i=="object"?a=Object.assign({},i):a=i,a.config&&(a.config.pageToken=t.nextPageToken),this.paramsInternal=a,this.pageInternalSize=(o=(r=a.config)===null||r===void 0?void 0:r.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};let e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");let e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}};var gy=class extends ui{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Ki(Er.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)}}createInlinedGenerateContentRequest(e){let t=BE(this.apiClient,e),i=t._url,r=ee("{model}:batchGenerateContent",i),u=t.batch.inputConfig.requests,c=u.requests,m=[];for(let h of c){let y=Object.assign({},h);if(y.systemInstruction){let v=y.systemInstruction;delete y.systemInstruction;let C=y.request;C.systemInstruction=v,y.request=C}m.push(y)}return u.requests=m,delete t.config,delete t._url,delete t._query,{path:r,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){let i=t?Object.assign({},t):{},r=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${r}`),i.dest===void 0){let o=this.getGcsUri(e),a=this.getBigqueryUri(e);if(o)o.endsWith(".jsonl")?i.dest=`${o.slice(0,-6)}/dest`:i.dest=`${o}_dest_${r}`;else if(a)i.dest=`${a}_dest_${r}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var t,i,r,o;let a,u="",c={};if(this.apiClient.isVertexAI()){let m=N4(this.apiClient,e);return u=ee("batchPredictionJobs",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),a.then(h=>fy(h))}else{let m=BE(this.apiClient,e);return u=ee("{model}:batchGenerateContent",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),a.then(h=>vm(h))}}async createEmbeddingsInternal(e){var t,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=P4(this.apiClient,e);return o=ee("{model}:asyncBatchEmbedContent",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>vm(c))}}async get(e){var t,i,r,o;let a,u="",c={};if(this.apiClient.isVertexAI()){let m=Y4(this.apiClient,e);return u=ee("batchPredictionJobs/{name}",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),a.then(h=>fy(h))}else{let m=z4(this.apiClient,e);return u=ee("batches/{name}",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),a.then(h=>vm(h))}}async cancel(e){var t,i,r,o;let a="",u={};if(this.apiClient.isVertexAI()){let c=T4(this.apiClient,e);a=ee("batchPredictionJobs/{name}:cancel",c._url),u=c._query,delete c._url,delete c._query,await this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{let c=w4(this.apiClient,e);a=ee("batches/{name}:cancel",c._url),u=c._query,delete c._url,delete c._query,await this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var t,i,r,o;let a,u="",c={};if(this.apiClient.isVertexAI()){let m=iN(e);return u=ee("batchPredictionJobs",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>{let y=oN(h),v=new Rm;return Object.assign(v,y),v})}else{let m=nN(e);return u=ee("batches",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>{let y=rN(h),v=new Rm;return Object.assign(v,y),v})}}async delete(e){var t,i,r,o;let a,u="",c={};if(this.apiClient.isVertexAI()){let m=V4(this.apiClient,e);return u=ee("batchPredictionJobs/{name}",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>L4(h))}else{let m=k4(this.apiClient,e);return u=ee("batches/{name}",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>O4(h))}}};function dN(n){let e={},t=p(n,["data"]);if(t!=null&&g(e,["data"],t),p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function UE(n){let e={},t=p(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>FN(o))),g(e,["parts"],r)}let i=p(n,["role"]);return i!=null&&g(e,["role"],i),e}function cN(n,e){let t={},i=p(n,["ttl"]);e!==void 0&&i!=null&&g(e,["ttl"],i);let r=p(n,["expireTime"]);e!==void 0&&r!=null&&g(e,["expireTime"],r);let o=p(n,["displayName"]);e!==void 0&&o!=null&&g(e,["displayName"],o);let a=p(n,["contents"]);if(e!==void 0&&a!=null){let h=qn(a);Array.isArray(h)&&(h=h.map(y=>UE(y))),g(e,["contents"],h)}let u=p(n,["systemInstruction"]);e!==void 0&&u!=null&&g(e,["systemInstruction"],UE(Xt(u)));let c=p(n,["tools"]);if(e!==void 0&&c!=null){let h=c;Array.isArray(h)&&(h=h.map(y=>kN(y))),g(e,["tools"],h)}let m=p(n,["toolConfig"]);if(e!==void 0&&m!=null&&g(e,["toolConfig"],PN(m)),p(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function mN(n,e){let t={},i=p(n,["ttl"]);e!==void 0&&i!=null&&g(e,["ttl"],i);let r=p(n,["expireTime"]);e!==void 0&&r!=null&&g(e,["expireTime"],r);let o=p(n,["displayName"]);e!==void 0&&o!=null&&g(e,["displayName"],o);let a=p(n,["contents"]);if(e!==void 0&&a!=null){let y=qn(a);Array.isArray(y)&&(y=y.map(v=>v)),g(e,["contents"],y)}let u=p(n,["systemInstruction"]);e!==void 0&&u!=null&&g(e,["systemInstruction"],Xt(u));let c=p(n,["tools"]);if(e!==void 0&&c!=null){let y=c;Array.isArray(y)&&(y=y.map(v=>VN(v))),g(e,["tools"],y)}let m=p(n,["toolConfig"]);e!==void 0&&m!=null&&g(e,["toolConfig"],m);let h=p(n,["kmsKeyName"]);return e!==void 0&&h!=null&&g(e,["encryption_spec","kmsKeyName"],h),t}function pN(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["model"],d2(n,i));let r=p(e,["config"]);return r!=null&&cN(r,t),t}function fN(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["model"],d2(n,i));let r=p(e,["config"]);return r!=null&&mN(r,t),t}function gN(n,e){let t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],Qi(n,i)),t}function hN(n,e){let t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],Qi(n,i)),t}function yN(n){let e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function _N(n){let e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function vN(n){let e={};if(p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let t=p(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);let i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function CN(n){let e={},t=p(n,["id"]);t!=null&&g(e,["id"],t);let i=p(n,["args"]);i!=null&&g(e,["args"],i);let r=p(n,["name"]);if(r!=null&&g(e,["name"],r),p(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function xN(n){let e={},t=p(n,["allowedFunctionNames"]);t!=null&&g(e,["allowedFunctionNames"],t);let i=p(n,["mode"]);if(i!=null&&g(e,["mode"],i),p(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function bN(n){let e={},t=p(n,["description"]);t!=null&&g(e,["description"],t);let i=p(n,["name"]);i!=null&&g(e,["name"],i);let r=p(n,["parameters"]);r!=null&&g(e,["parameters"],r);let o=p(n,["parametersJsonSchema"]);o!=null&&g(e,["parametersJsonSchema"],o);let a=p(n,["response"]);a!=null&&g(e,["response"],a);let u=p(n,["responseJsonSchema"]);if(u!=null&&g(e,["responseJsonSchema"],u),p(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function EN(n,e){let t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],Qi(n,i)),t}function SN(n,e){let t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],Qi(n,i)),t}function DN(n){let e={};if(p(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");let t=p(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function wN(n){let e={};if(p(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");let t=p(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function TN(n,e){let t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);let r=p(n,["pageToken"]);return e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),t}function IN(n,e){let t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);let r=p(n,["pageToken"]);return e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),t}function MN(n){let e={},t=p(n,["config"]);return t!=null&&TN(t,e),e}function AN(n){let e={},t=p(n,["config"]);return t!=null&&IN(t,e),e}function RN(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);let r=p(n,["cachedContents"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>a)),g(e,["cachedContents"],o)}return e}function NN(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);let r=p(n,["cachedContents"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>a)),g(e,["cachedContents"],o)}return e}function FN(n){let e={},t=p(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);let i=p(n,["codeExecutionResult"]);i!=null&&g(e,["codeExecutionResult"],i);let r=p(n,["executableCode"]);r!=null&&g(e,["executableCode"],r);let o=p(n,["fileData"]);o!=null&&g(e,["fileData"],vN(o));let a=p(n,["functionCall"]);a!=null&&g(e,["functionCall"],CN(a));let u=p(n,["functionResponse"]);u!=null&&g(e,["functionResponse"],u);let c=p(n,["inlineData"]);c!=null&&g(e,["inlineData"],dN(c));let m=p(n,["text"]);m!=null&&g(e,["text"],m);let h=p(n,["thought"]);h!=null&&g(e,["thought"],h);let y=p(n,["thoughtSignature"]);y!=null&&g(e,["thoughtSignature"],y);let v=p(n,["videoMetadata"]);return v!=null&&g(e,["videoMetadata"],v),e}function PN(n){let e={},t=p(n,["retrievalConfig"]);t!=null&&g(e,["retrievalConfig"],t);let i=p(n,["functionCallingConfig"]);return i!=null&&g(e,["functionCallingConfig"],xN(i)),e}function kN(n){let e={};if(p(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");let t=p(n,["computerUse"]);t!=null&&g(e,["computerUse"],t);let i=p(n,["fileSearch"]);i!=null&&g(e,["fileSearch"],i);let r=p(n,["codeExecution"]);if(r!=null&&g(e,["codeExecution"],r),p(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");let o=p(n,["functionDeclarations"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(y=>y)),g(e,["functionDeclarations"],h)}let a=p(n,["googleMaps"]);a!=null&&g(e,["googleMaps"],DN(a));let u=p(n,["googleSearch"]);u!=null&&g(e,["googleSearch"],wN(u));let c=p(n,["googleSearchRetrieval"]);c!=null&&g(e,["googleSearchRetrieval"],c);let m=p(n,["urlContext"]);return m!=null&&g(e,["urlContext"],m),e}function VN(n){let e={},t=p(n,["retrieval"]);t!=null&&g(e,["retrieval"],t);let i=p(n,["computerUse"]);if(i!=null&&g(e,["computerUse"],i),p(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");let r=p(n,["codeExecution"]);r!=null&&g(e,["codeExecution"],r);let o=p(n,["enterpriseWebSearch"]);o!=null&&g(e,["enterpriseWebSearch"],o);let a=p(n,["functionDeclarations"]);if(a!=null){let y=a;Array.isArray(y)&&(y=y.map(v=>bN(v))),g(e,["functionDeclarations"],y)}let u=p(n,["googleMaps"]);u!=null&&g(e,["googleMaps"],u);let c=p(n,["googleSearch"]);c!=null&&g(e,["googleSearch"],c);let m=p(n,["googleSearchRetrieval"]);m!=null&&g(e,["googleSearchRetrieval"],m);let h=p(n,["urlContext"]);return h!=null&&g(e,["urlContext"],h),e}function ON(n,e){let t={},i=p(n,["ttl"]);e!==void 0&&i!=null&&g(e,["ttl"],i);let r=p(n,["expireTime"]);return e!==void 0&&r!=null&&g(e,["expireTime"],r),t}function LN(n,e){let t={},i=p(n,["ttl"]);e!==void 0&&i!=null&&g(e,["ttl"],i);let r=p(n,["expireTime"]);return e!==void 0&&r!=null&&g(e,["expireTime"],r),t}function BN(n,e){let t={},i=p(e,["name"]);i!=null&&g(t,["_url","name"],Qi(n,i));let r=p(e,["config"]);return r!=null&&ON(r,t),t}function UN(n,e){let t={},i=p(e,["name"]);i!=null&&g(t,["_url","name"],Qi(n,i));let r=p(e,["config"]);return r!=null&&LN(r,t),t}var hy=class extends ui{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Ki(Er.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,r,o;let a,u="",c={};if(this.apiClient.isVertexAI()){let m=fN(this.apiClient,e);return u=ee("cachedContents",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),a.then(h=>h)}else{let m=pN(this.apiClient,e);return u=ee("cachedContents",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),a.then(h=>h)}}async get(e){var t,i,r,o;let a,u="",c={};if(this.apiClient.isVertexAI()){let m=SN(this.apiClient,e);return u=ee("{name}",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),a.then(h=>h)}else{let m=EN(this.apiClient,e);return u=ee("{name}",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),a.then(h=>h)}}async delete(e){var t,i,r,o;let a,u="",c={};if(this.apiClient.isVertexAI()){let m=hN(this.apiClient,e);return u=ee("{name}",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>{let y=_N(h),v=new Mm;return Object.assign(v,y),v})}else{let m=gN(this.apiClient,e);return u=ee("{name}",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>{let y=yN(h),v=new Mm;return Object.assign(v,y),v})}}async update(e){var t,i,r,o;let a,u="",c={};if(this.apiClient.isVertexAI()){let m=UN(this.apiClient,e);return u=ee("{name}",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),a.then(h=>h)}else{let m=BN(this.apiClient,e);return u=ee("{name}",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),a.then(h=>h)}}async listInternal(e){var t,i,r,o;let a,u="",c={};if(this.apiClient.isVertexAI()){let m=AN(e);return u=ee("cachedContents",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>{let y=NN(h),v=new Am;return Object.assign(v,y),v})}else{let m=MN(e);return u=ee("cachedContents",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>{let y=RN(h),v=new Am;return Object.assign(v,y),v})}}};function Fm(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t}function $E(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ve(n){return this instanceof ve?(this.v=n,this):new ve(n)}function si(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,o=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",a),r[Symbol.asyncIterator]=function(){return this},r;function a(C){return function(T){return Promise.resolve(T).then(C,y)}}function u(C,T){i[C]&&(r[C]=function(R){return new Promise(function(N,F){o.push([C,R,N,F])>1||c(C,R)})},T&&(r[C]=T(r[C])))}function c(C,T){try{m(i[C](T))}catch(R){v(o[0][3],R)}}function m(C){C.value instanceof ve?Promise.resolve(C.value.v).then(h,y):v(o[0][2],C)}function h(C){c("next",C)}function y(C){c("throw",C)}function v(C,T){C(T),o.shift(),o.length&&c(o[0][0],o[0][1])}}function li(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof $E=="function"?$E(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=n[o]&&function(a){return new Promise(function(u,c){a=n[o](a),r(u,c,a.done,a.value)})}}function r(o,a,u,c){Promise.resolve(c).then(function(m){o({value:m,done:u})},a)}}function $N(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;let t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:E2(t)}function E2(n){if(n.parts===void 0||n.parts.length===0)return!1;for(let e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function HN(n){if(n.length!==0){for(let e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function HE(n){if(n===void 0||n.length===0)return[];let e=[],t=n.length,i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{let r=[],o=!0;for(;i<t&&n[i].role==="model";)r.push(n[i]),o&&!E2(n[i])&&(o=!1),i++;o?e.push(...r):e.pop()}return e}var yy=class{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new _y(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}},_y=class{constructor(e,t,i,r={},o=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=r,this.history=o,this.sendPromise=Promise.resolve(),HN(o)}async sendMessage(e){var t;await this.sendPromise;let i=Xt(e.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var o,a,u;let c=await r,m=(a=(o=c.candidates)===null||o===void 0?void 0:o[0])===null||a===void 0?void 0:a.content,h=c.automaticFunctionCallingHistory,y=this.getHistory(!0).length,v=[];h!=null&&(v=(u=h.slice(y))!==null&&u!==void 0?u:[]);let C=m?[m]:[];this.recordHistory(i,C,v)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),r}async sendMessageStream(e){var t;await this.sendPromise;let i=Xt(e.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=r.then(()=>{}).catch(()=>{});let o=await r;return this.processStreamResponse(o,i)}getHistory(e=!1){let t=e?HE(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return si(this,arguments,function*(){var r,o,a,u,c,m;let h=[];try{for(var y=!0,v=li(e),C;C=yield ve(v.next()),r=C.done,!r;y=!0){u=C.value,y=!1;let T=u;if($N(T)){let R=(m=(c=T.candidates)===null||c===void 0?void 0:c[0])===null||m===void 0?void 0:m.content;R!==void 0&&h.push(R)}yield yield ve(T)}}catch(T){o={error:T}}finally{try{!y&&!r&&(a=v.return)&&(yield ve(a.call(v)))}finally{if(o)throw o.error}}this.recordHistory(t,h)})}recordHistory(e,t,i){let r=[];t.length>0&&t.every(o=>o.role!==void 0)?r=t:r.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...HE(i)):this.history.push(e),this.history.push(...r)}};var Ql=class n extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,n.prototype)}};function GN(n){let e={},t=p(n,["file"]);return t!=null&&g(e,["file"],t),e}function qN(n){let e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function WN(n){let e={},t=p(n,["name"]);return t!=null&&g(e,["_url","file"],h2(t)),e}function jN(n){let e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function zN(n){let e={},t=p(n,["name"]);return t!=null&&g(e,["_url","file"],h2(t)),e}function YN(n,e){let t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);let r=p(n,["pageToken"]);return e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),t}function JN(n){let e={},t=p(n,["config"]);return t!=null&&YN(t,e),e}function KN(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);let r=p(n,["files"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>a)),g(e,["files"],o)}return e}var vy=class extends ui{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Ki(Er.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=JN(e);return o=ee("files",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(m=>{let h=m;return h.sdkHttpResponse={headers:c.headers},h})),r.then(c=>{let m=KN(c),h=new sy;return Object.assign(h,m),h})}}async createInternal(e){var t,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=GN(e);return o=ee("upload/v1beta/files",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{let m=qN(c),h=new ly;return Object.assign(h,m),h})}}async get(e){var t,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=zN(e);return o=ee("files/{file}",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>c)}}async delete(e){var t,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=WN(e);return o=ee("files/{file}",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(m=>{let h=m;return h.sdkHttpResponse={headers:c.headers},h})),r.then(c=>{let m=jN(c),h=new uy;return Object.assign(h,m),h})}}};function Cm(n){let e={},t=p(n,["data"]);if(t!=null&&g(e,["data"],t),p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function QN(n){let e={},t=p(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>pF(o))),g(e,["parts"],r)}let i=p(n,["role"]);return i!=null&&g(e,["role"],i),e}function ZN(n){let e={};if(p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let t=p(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);let i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function XN(n){let e={},t=p(n,["id"]);t!=null&&g(e,["id"],t);let i=p(n,["args"]);i!=null&&g(e,["args"],i);let r=p(n,["name"]);if(r!=null&&g(e,["name"],r),p(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function eF(n){let e={},t=p(n,["description"]);t!=null&&g(e,["description"],t);let i=p(n,["name"]);i!=null&&g(e,["name"],i);let r=p(n,["parameters"]);r!=null&&g(e,["parameters"],r);let o=p(n,["parametersJsonSchema"]);o!=null&&g(e,["parametersJsonSchema"],o);let a=p(n,["response"]);a!=null&&g(e,["response"],a);let u=p(n,["responseJsonSchema"]);if(u!=null&&g(e,["responseJsonSchema"],u),p(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function tF(n){let e={},t=p(n,["modelSelectionConfig"]);t!=null&&g(e,["modelConfig"],t);let i=p(n,["responseJsonSchema"]);i!=null&&g(e,["responseJsonSchema"],i);let r=p(n,["audioTimestamp"]);r!=null&&g(e,["audioTimestamp"],r);let o=p(n,["candidateCount"]);o!=null&&g(e,["candidateCount"],o);let a=p(n,["enableAffectiveDialog"]);a!=null&&g(e,["enableAffectiveDialog"],a);let u=p(n,["frequencyPenalty"]);u!=null&&g(e,["frequencyPenalty"],u);let c=p(n,["logprobs"]);c!=null&&g(e,["logprobs"],c);let m=p(n,["maxOutputTokens"]);m!=null&&g(e,["maxOutputTokens"],m);let h=p(n,["mediaResolution"]);h!=null&&g(e,["mediaResolution"],h);let y=p(n,["presencePenalty"]);y!=null&&g(e,["presencePenalty"],y);let v=p(n,["responseLogprobs"]);v!=null&&g(e,["responseLogprobs"],v);let C=p(n,["responseMimeType"]);C!=null&&g(e,["responseMimeType"],C);let T=p(n,["responseModalities"]);T!=null&&g(e,["responseModalities"],T);let R=p(n,["responseSchema"]);R!=null&&g(e,["responseSchema"],R);let N=p(n,["routingConfig"]);N!=null&&g(e,["routingConfig"],N);let F=p(n,["seed"]);F!=null&&g(e,["seed"],F);let $=p(n,["speechConfig"]);$!=null&&g(e,["speechConfig"],$);let q=p(n,["stopSequences"]);q!=null&&g(e,["stopSequences"],q);let Q=p(n,["temperature"]);Q!=null&&g(e,["temperature"],Q);let ie=p(n,["thinkingConfig"]);ie!=null&&g(e,["thinkingConfig"],ie);let de=p(n,["topK"]);de!=null&&g(e,["topK"],de);let le=p(n,["topP"]);if(le!=null&&g(e,["topP"],le),p(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function nF(n){let e={};if(p(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");let t=p(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function iF(n){let e={};if(p(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");let t=p(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function rF(n,e){let t={},i=p(n,["generationConfig"]);e!==void 0&&i!=null&&g(e,["setup","generationConfig"],i);let r=p(n,["responseModalities"]);e!==void 0&&r!=null&&g(e,["setup","generationConfig","responseModalities"],r);let o=p(n,["temperature"]);e!==void 0&&o!=null&&g(e,["setup","generationConfig","temperature"],o);let a=p(n,["topP"]);e!==void 0&&a!=null&&g(e,["setup","generationConfig","topP"],a);let u=p(n,["topK"]);e!==void 0&&u!=null&&g(e,["setup","generationConfig","topK"],u);let c=p(n,["maxOutputTokens"]);e!==void 0&&c!=null&&g(e,["setup","generationConfig","maxOutputTokens"],c);let m=p(n,["mediaResolution"]);e!==void 0&&m!=null&&g(e,["setup","generationConfig","mediaResolution"],m);let h=p(n,["seed"]);e!==void 0&&h!=null&&g(e,["setup","generationConfig","seed"],h);let y=p(n,["speechConfig"]);e!==void 0&&y!=null&&g(e,["setup","generationConfig","speechConfig"],Zy(y));let v=p(n,["thinkingConfig"]);e!==void 0&&v!=null&&g(e,["setup","generationConfig","thinkingConfig"],v);let C=p(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],C);let T=p(n,["systemInstruction"]);e!==void 0&&T!=null&&g(e,["setup","systemInstruction"],QN(Xt(T)));let R=p(n,["tools"]);if(e!==void 0&&R!=null){let de=Va(R);Array.isArray(de)&&(de=de.map(le=>gF(ka(le)))),g(e,["setup","tools"],de)}let N=p(n,["sessionResumption"]);e!==void 0&&N!=null&&g(e,["setup","sessionResumption"],fF(N));let F=p(n,["inputAudioTranscription"]);e!==void 0&&F!=null&&g(e,["setup","inputAudioTranscription"],F);let $=p(n,["outputAudioTranscription"]);e!==void 0&&$!=null&&g(e,["setup","outputAudioTranscription"],$);let q=p(n,["realtimeInputConfig"]);e!==void 0&&q!=null&&g(e,["setup","realtimeInputConfig"],q);let Q=p(n,["contextWindowCompression"]);e!==void 0&&Q!=null&&g(e,["setup","contextWindowCompression"],Q);let ie=p(n,["proactivity"]);if(e!==void 0&&ie!=null&&g(e,["setup","proactivity"],ie),p(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function oF(n,e){let t={},i=p(n,["generationConfig"]);e!==void 0&&i!=null&&g(e,["setup","generationConfig"],tF(i));let r=p(n,["responseModalities"]);e!==void 0&&r!=null&&g(e,["setup","generationConfig","responseModalities"],r);let o=p(n,["temperature"]);e!==void 0&&o!=null&&g(e,["setup","generationConfig","temperature"],o);let a=p(n,["topP"]);e!==void 0&&a!=null&&g(e,["setup","generationConfig","topP"],a);let u=p(n,["topK"]);e!==void 0&&u!=null&&g(e,["setup","generationConfig","topK"],u);let c=p(n,["maxOutputTokens"]);e!==void 0&&c!=null&&g(e,["setup","generationConfig","maxOutputTokens"],c);let m=p(n,["mediaResolution"]);e!==void 0&&m!=null&&g(e,["setup","generationConfig","mediaResolution"],m);let h=p(n,["seed"]);e!==void 0&&h!=null&&g(e,["setup","generationConfig","seed"],h);let y=p(n,["speechConfig"]);e!==void 0&&y!=null&&g(e,["setup","generationConfig","speechConfig"],Zy(y));let v=p(n,["thinkingConfig"]);e!==void 0&&v!=null&&g(e,["setup","generationConfig","thinkingConfig"],v);let C=p(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],C);let T=p(n,["systemInstruction"]);e!==void 0&&T!=null&&g(e,["setup","systemInstruction"],Xt(T));let R=p(n,["tools"]);if(e!==void 0&&R!=null){let le=Va(R);Array.isArray(le)&&(le=le.map(Oe=>hF(ka(Oe)))),g(e,["setup","tools"],le)}let N=p(n,["sessionResumption"]);e!==void 0&&N!=null&&g(e,["setup","sessionResumption"],N);let F=p(n,["inputAudioTranscription"]);e!==void 0&&F!=null&&g(e,["setup","inputAudioTranscription"],F);let $=p(n,["outputAudioTranscription"]);e!==void 0&&$!=null&&g(e,["setup","outputAudioTranscription"],$);let q=p(n,["realtimeInputConfig"]);e!==void 0&&q!=null&&g(e,["setup","realtimeInputConfig"],q);let Q=p(n,["contextWindowCompression"]);e!==void 0&&Q!=null&&g(e,["setup","contextWindowCompression"],Q);let ie=p(n,["proactivity"]);e!==void 0&&ie!=null&&g(e,["setup","proactivity"],ie);let de=p(n,["explicitVadSignal"]);return e!==void 0&&de!=null&&g(e,["setup","explicitVadSignal"],de),t}function aF(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["setup","model"],$e(n,i));let r=p(e,["config"]);return r!=null&&g(t,["config"],rF(r,t)),t}function sF(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["setup","model"],$e(n,i));let r=p(e,["config"]);return r!=null&&g(t,["config"],oF(r,t)),t}function lF(n){let e={},t=p(n,["musicGenerationConfig"]);return t!=null&&g(e,["musicGenerationConfig"],t),e}function uF(n){let e={},t=p(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),g(e,["weightedPrompts"],i)}return e}function dF(n){let e={},t=p(n,["media"]);if(t!=null){let m=c2(t);Array.isArray(m)&&(m=m.map(h=>Cm(h))),g(e,["mediaChunks"],m)}let i=p(n,["audio"]);i!=null&&g(e,["audio"],Cm(p2(i)));let r=p(n,["audioStreamEnd"]);r!=null&&g(e,["audioStreamEnd"],r);let o=p(n,["video"]);o!=null&&g(e,["video"],Cm(m2(o)));let a=p(n,["text"]);a!=null&&g(e,["text"],a);let u=p(n,["activityStart"]);u!=null&&g(e,["activityStart"],u);let c=p(n,["activityEnd"]);return c!=null&&g(e,["activityEnd"],c),e}function cF(n){let e={},t=p(n,["media"]);if(t!=null){let m=c2(t);Array.isArray(m)&&(m=m.map(h=>h)),g(e,["mediaChunks"],m)}let i=p(n,["audio"]);i!=null&&g(e,["audio"],p2(i));let r=p(n,["audioStreamEnd"]);r!=null&&g(e,["audioStreamEnd"],r);let o=p(n,["video"]);o!=null&&g(e,["video"],m2(o));let a=p(n,["text"]);a!=null&&g(e,["text"],a);let u=p(n,["activityStart"]);u!=null&&g(e,["activityStart"],u);let c=p(n,["activityEnd"]);return c!=null&&g(e,["activityEnd"],c),e}function mF(n){let e={},t=p(n,["setupComplete"]);t!=null&&g(e,["setupComplete"],t);let i=p(n,["serverContent"]);i!=null&&g(e,["serverContent"],i);let r=p(n,["toolCall"]);r!=null&&g(e,["toolCall"],r);let o=p(n,["toolCallCancellation"]);o!=null&&g(e,["toolCallCancellation"],o);let a=p(n,["usageMetadata"]);a!=null&&g(e,["usageMetadata"],yF(a));let u=p(n,["goAway"]);u!=null&&g(e,["goAway"],u);let c=p(n,["sessionResumptionUpdate"]);c!=null&&g(e,["sessionResumptionUpdate"],c);let m=p(n,["voiceActivityDetectionSignal"]);m!=null&&g(e,["voiceActivityDetectionSignal"],m);let h=p(n,["voiceActivity"]);return h!=null&&g(e,["voiceActivity"],_F(h)),e}function pF(n){let e={},t=p(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);let i=p(n,["codeExecutionResult"]);i!=null&&g(e,["codeExecutionResult"],i);let r=p(n,["executableCode"]);r!=null&&g(e,["executableCode"],r);let o=p(n,["fileData"]);o!=null&&g(e,["fileData"],ZN(o));let a=p(n,["functionCall"]);a!=null&&g(e,["functionCall"],XN(a));let u=p(n,["functionResponse"]);u!=null&&g(e,["functionResponse"],u);let c=p(n,["inlineData"]);c!=null&&g(e,["inlineData"],Cm(c));let m=p(n,["text"]);m!=null&&g(e,["text"],m);let h=p(n,["thought"]);h!=null&&g(e,["thought"],h);let y=p(n,["thoughtSignature"]);y!=null&&g(e,["thoughtSignature"],y);let v=p(n,["videoMetadata"]);return v!=null&&g(e,["videoMetadata"],v),e}function fF(n){let e={},t=p(n,["handle"]);if(t!=null&&g(e,["handle"],t),p(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function gF(n){let e={};if(p(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");let t=p(n,["computerUse"]);t!=null&&g(e,["computerUse"],t);let i=p(n,["fileSearch"]);i!=null&&g(e,["fileSearch"],i);let r=p(n,["codeExecution"]);if(r!=null&&g(e,["codeExecution"],r),p(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");let o=p(n,["functionDeclarations"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(y=>y)),g(e,["functionDeclarations"],h)}let a=p(n,["googleMaps"]);a!=null&&g(e,["googleMaps"],nF(a));let u=p(n,["googleSearch"]);u!=null&&g(e,["googleSearch"],iF(u));let c=p(n,["googleSearchRetrieval"]);c!=null&&g(e,["googleSearchRetrieval"],c);let m=p(n,["urlContext"]);return m!=null&&g(e,["urlContext"],m),e}function hF(n){let e={},t=p(n,["retrieval"]);t!=null&&g(e,["retrieval"],t);let i=p(n,["computerUse"]);if(i!=null&&g(e,["computerUse"],i),p(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");let r=p(n,["codeExecution"]);r!=null&&g(e,["codeExecution"],r);let o=p(n,["enterpriseWebSearch"]);o!=null&&g(e,["enterpriseWebSearch"],o);let a=p(n,["functionDeclarations"]);if(a!=null){let y=a;Array.isArray(y)&&(y=y.map(v=>eF(v))),g(e,["functionDeclarations"],y)}let u=p(n,["googleMaps"]);u!=null&&g(e,["googleMaps"],u);let c=p(n,["googleSearch"]);c!=null&&g(e,["googleSearch"],c);let m=p(n,["googleSearchRetrieval"]);m!=null&&g(e,["googleSearchRetrieval"],m);let h=p(n,["urlContext"]);return h!=null&&g(e,["urlContext"],h),e}function yF(n){let e={},t=p(n,["promptTokenCount"]);t!=null&&g(e,["promptTokenCount"],t);let i=p(n,["cachedContentTokenCount"]);i!=null&&g(e,["cachedContentTokenCount"],i);let r=p(n,["candidatesTokenCount"]);r!=null&&g(e,["responseTokenCount"],r);let o=p(n,["toolUsePromptTokenCount"]);o!=null&&g(e,["toolUsePromptTokenCount"],o);let a=p(n,["thoughtsTokenCount"]);a!=null&&g(e,["thoughtsTokenCount"],a);let u=p(n,["totalTokenCount"]);u!=null&&g(e,["totalTokenCount"],u);let c=p(n,["promptTokensDetails"]);if(c!=null){let C=c;Array.isArray(C)&&(C=C.map(T=>T)),g(e,["promptTokensDetails"],C)}let m=p(n,["cacheTokensDetails"]);if(m!=null){let C=m;Array.isArray(C)&&(C=C.map(T=>T)),g(e,["cacheTokensDetails"],C)}let h=p(n,["candidatesTokensDetails"]);if(h!=null){let C=h;Array.isArray(C)&&(C=C.map(T=>T)),g(e,["responseTokensDetails"],C)}let y=p(n,["toolUsePromptTokensDetails"]);if(y!=null){let C=y;Array.isArray(C)&&(C=C.map(T=>T)),g(e,["toolUsePromptTokensDetails"],C)}let v=p(n,["trafficType"]);return v!=null&&g(e,["trafficType"],v),e}function _F(n){let e={},t=p(n,["type"]);return t!=null&&g(e,["voiceActivityType"],t),e}function vF(n){let e={},t=p(n,["data"]);if(t!=null&&g(e,["data"],t),p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function CF(n){let e={},t=p(n,["content"]);t!=null&&g(e,["content"],t);let i=p(n,["citationMetadata"]);i!=null&&g(e,["citationMetadata"],xF(i));let r=p(n,["tokenCount"]);r!=null&&g(e,["tokenCount"],r);let o=p(n,["finishReason"]);o!=null&&g(e,["finishReason"],o);let a=p(n,["avgLogprobs"]);a!=null&&g(e,["avgLogprobs"],a);let u=p(n,["groundingMetadata"]);u!=null&&g(e,["groundingMetadata"],u);let c=p(n,["index"]);c!=null&&g(e,["index"],c);let m=p(n,["logprobsResult"]);m!=null&&g(e,["logprobsResult"],m);let h=p(n,["safetyRatings"]);if(h!=null){let v=h;Array.isArray(v)&&(v=v.map(C=>C)),g(e,["safetyRatings"],v)}let y=p(n,["urlContextMetadata"]);return y!=null&&g(e,["urlContextMetadata"],y),e}function xF(n){let e={},t=p(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),g(e,["citations"],i)}return e}function bF(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],$e(n,i));let r=p(e,["contents"]);if(r!=null){let o=qn(r);Array.isArray(o)&&(o=o.map(a=>a)),g(t,["contents"],o)}return t}function EF(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["tokensInfo"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>o)),g(e,["tokensInfo"],r)}return e}function SF(n){let e={},t=p(n,["values"]);t!=null&&g(e,["values"],t);let i=p(n,["statistics"]);return i!=null&&g(e,["statistics"],DF(i)),e}function DF(n){let e={},t=p(n,["truncated"]);t!=null&&g(e,["truncated"],t);let i=p(n,["token_count"]);return i!=null&&g(e,["tokenCount"],i),e}function Ym(n){let e={},t=p(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>PP(o))),g(e,["parts"],r)}let i=p(n,["role"]);return i!=null&&g(e,["role"],i),e}function wF(n){let e={},t=p(n,["controlType"]);t!=null&&g(e,["controlType"],t);let i=p(n,["enableControlImageComputation"]);return i!=null&&g(e,["computeControl"],i),e}function TF(n){let e={};if(p(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(p(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(p(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function IF(n,e){let t={},i=p(n,["systemInstruction"]);e!==void 0&&i!=null&&g(e,["systemInstruction"],Xt(i));let r=p(n,["tools"]);if(e!==void 0&&r!=null){let a=r;Array.isArray(a)&&(a=a.map(u=>T2(u))),g(e,["tools"],a)}let o=p(n,["generationConfig"]);return e!==void 0&&o!=null&&g(e,["generationConfig"],vP(o)),t}function MF(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],$e(n,i));let r=p(e,["contents"]);if(r!=null){let a=qn(r);Array.isArray(a)&&(a=a.map(u=>Ym(u))),g(t,["contents"],a)}let o=p(e,["config"]);return o!=null&&TF(o),t}function AF(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],$e(n,i));let r=p(e,["contents"]);if(r!=null){let a=qn(r);Array.isArray(a)&&(a=a.map(u=>u)),g(t,["contents"],a)}let o=p(e,["config"]);return o!=null&&IF(o,t),t}function RF(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["totalTokens"]);i!=null&&g(e,["totalTokens"],i);let r=p(n,["cachedContentTokenCount"]);return r!=null&&g(e,["cachedContentTokenCount"],r),e}function NF(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["totalTokens"]);return i!=null&&g(e,["totalTokens"],i),e}function FF(n,e){let t={},i=p(e,["model"]);return i!=null&&g(t,["_url","name"],$e(n,i)),t}function PF(n,e){let t={},i=p(e,["model"]);return i!=null&&g(t,["_url","name"],$e(n,i)),t}function kF(n){let e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function VF(n){let e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function OF(n,e){let t={},i=p(n,["outputGcsUri"]);e!==void 0&&i!=null&&g(e,["parameters","storageUri"],i);let r=p(n,["negativePrompt"]);e!==void 0&&r!=null&&g(e,["parameters","negativePrompt"],r);let o=p(n,["numberOfImages"]);e!==void 0&&o!=null&&g(e,["parameters","sampleCount"],o);let a=p(n,["aspectRatio"]);e!==void 0&&a!=null&&g(e,["parameters","aspectRatio"],a);let u=p(n,["guidanceScale"]);e!==void 0&&u!=null&&g(e,["parameters","guidanceScale"],u);let c=p(n,["seed"]);e!==void 0&&c!=null&&g(e,["parameters","seed"],c);let m=p(n,["safetyFilterLevel"]);e!==void 0&&m!=null&&g(e,["parameters","safetySetting"],m);let h=p(n,["personGeneration"]);e!==void 0&&h!=null&&g(e,["parameters","personGeneration"],h);let y=p(n,["includeSafetyAttributes"]);e!==void 0&&y!=null&&g(e,["parameters","includeSafetyAttributes"],y);let v=p(n,["includeRaiReason"]);e!==void 0&&v!=null&&g(e,["parameters","includeRaiReason"],v);let C=p(n,["language"]);e!==void 0&&C!=null&&g(e,["parameters","language"],C);let T=p(n,["outputMimeType"]);e!==void 0&&T!=null&&g(e,["parameters","outputOptions","mimeType"],T);let R=p(n,["outputCompressionQuality"]);e!==void 0&&R!=null&&g(e,["parameters","outputOptions","compressionQuality"],R);let N=p(n,["addWatermark"]);e!==void 0&&N!=null&&g(e,["parameters","addWatermark"],N);let F=p(n,["labels"]);e!==void 0&&F!=null&&g(e,["labels"],F);let $=p(n,["editMode"]);e!==void 0&&$!=null&&g(e,["parameters","editMode"],$);let q=p(n,["baseSteps"]);return e!==void 0&&q!=null&&g(e,["parameters","editConfig","baseSteps"],q),t}function LF(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],$e(n,i));let r=p(e,["prompt"]);r!=null&&g(t,["instances[0]","prompt"],r);let o=p(e,["referenceImages"]);if(o!=null){let u=o;Array.isArray(u)&&(u=u.map(c=>UP(c))),g(t,["instances[0]","referenceImages"],u)}let a=p(e,["config"]);return a!=null&&OF(a,t),t}function BF(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>Jm(o))),g(e,["generatedImages"],r)}return e}function UF(n,e){let t={},i=p(n,["taskType"]);e!==void 0&&i!=null&&g(e,["requests[]","taskType"],i);let r=p(n,["title"]);e!==void 0&&r!=null&&g(e,["requests[]","title"],r);let o=p(n,["outputDimensionality"]);if(e!==void 0&&o!=null&&g(e,["requests[]","outputDimensionality"],o),p(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(p(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function $F(n,e){let t={},i=p(n,["taskType"]);e!==void 0&&i!=null&&g(e,["instances[]","task_type"],i);let r=p(n,["title"]);e!==void 0&&r!=null&&g(e,["instances[]","title"],r);let o=p(n,["outputDimensionality"]);e!==void 0&&o!=null&&g(e,["parameters","outputDimensionality"],o);let a=p(n,["mimeType"]);e!==void 0&&a!=null&&g(e,["instances[]","mimeType"],a);let u=p(n,["autoTruncate"]);return e!==void 0&&u!=null&&g(e,["parameters","autoTruncate"],u),t}function HF(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],$e(n,i));let r=p(e,["contents"]);if(r!=null){let u=Jy(n,r);Array.isArray(u)&&(u=u.map(c=>c)),g(t,["requests[]","content"],u)}let o=p(e,["config"]);o!=null&&UF(o,t);let a=p(e,["model"]);return a!==void 0&&g(t,["requests[]","model"],$e(n,a)),t}function GF(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],$e(n,i));let r=p(e,["contents"]);if(r!=null){let a=Jy(n,r);Array.isArray(a)&&(a=a.map(u=>u)),g(t,["instances[]","content"],a)}let o=p(e,["config"]);return o!=null&&$F(o,t),t}function qF(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["embeddings"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>a)),g(e,["embeddings"],o)}let r=p(n,["metadata"]);return r!=null&&g(e,["metadata"],r),e}function WF(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["predictions[]","embeddings"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>SF(a))),g(e,["embeddings"],o)}let r=p(n,["metadata"]);return r!=null&&g(e,["metadata"],r),e}function jF(n){let e={},t=p(n,["endpoint"]);t!=null&&g(e,["name"],t);let i=p(n,["deployedModelId"]);return i!=null&&g(e,["deployedModelId"],i),e}function zF(n){let e={};if(p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let t=p(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);let i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function YF(n){let e={},t=p(n,["id"]);t!=null&&g(e,["id"],t);let i=p(n,["args"]);i!=null&&g(e,["args"],i);let r=p(n,["name"]);if(r!=null&&g(e,["name"],r),p(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function JF(n){let e={},t=p(n,["allowedFunctionNames"]);t!=null&&g(e,["allowedFunctionNames"],t);let i=p(n,["mode"]);if(i!=null&&g(e,["mode"],i),p(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function KF(n){let e={},t=p(n,["description"]);t!=null&&g(e,["description"],t);let i=p(n,["name"]);i!=null&&g(e,["name"],i);let r=p(n,["parameters"]);r!=null&&g(e,["parameters"],r);let o=p(n,["parametersJsonSchema"]);o!=null&&g(e,["parametersJsonSchema"],o);let a=p(n,["response"]);a!=null&&g(e,["response"],a);let u=p(n,["responseJsonSchema"]);if(u!=null&&g(e,["responseJsonSchema"],u),p(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function QF(n,e,t){let i={},r=p(e,["systemInstruction"]);t!==void 0&&r!=null&&g(t,["systemInstruction"],Ym(Xt(r)));let o=p(e,["temperature"]);o!=null&&g(i,["temperature"],o);let a=p(e,["topP"]);a!=null&&g(i,["topP"],a);let u=p(e,["topK"]);u!=null&&g(i,["topK"],u);let c=p(e,["candidateCount"]);c!=null&&g(i,["candidateCount"],c);let m=p(e,["maxOutputTokens"]);m!=null&&g(i,["maxOutputTokens"],m);let h=p(e,["stopSequences"]);h!=null&&g(i,["stopSequences"],h);let y=p(e,["responseLogprobs"]);y!=null&&g(i,["responseLogprobs"],y);let v=p(e,["logprobs"]);v!=null&&g(i,["logprobs"],v);let C=p(e,["presencePenalty"]);C!=null&&g(i,["presencePenalty"],C);let T=p(e,["frequencyPenalty"]);T!=null&&g(i,["frequencyPenalty"],T);let R=p(e,["seed"]);R!=null&&g(i,["seed"],R);let N=p(e,["responseMimeType"]);N!=null&&g(i,["responseMimeType"],N);let F=p(e,["responseSchema"]);F!=null&&g(i,["responseSchema"],Ky(F));let $=p(e,["responseJsonSchema"]);if($!=null&&g(i,["responseJsonSchema"],$),p(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(p(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");let q=p(e,["safetySettings"]);if(t!==void 0&&q!=null){let pt=q;Array.isArray(pt)&&(pt=pt.map(mi=>$P(mi))),g(t,["safetySettings"],pt)}let Q=p(e,["tools"]);if(t!==void 0&&Q!=null){let pt=Va(Q);Array.isArray(pt)&&(pt=pt.map(mi=>YP(ka(mi)))),g(t,["tools"],pt)}let ie=p(e,["toolConfig"]);if(t!==void 0&&ie!=null&&g(t,["toolConfig"],zP(ie)),p(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");let de=p(e,["cachedContent"]);t!==void 0&&de!=null&&g(t,["cachedContent"],Qi(n,de));let le=p(e,["responseModalities"]);le!=null&&g(i,["responseModalities"],le);let Oe=p(e,["mediaResolution"]);Oe!=null&&g(i,["mediaResolution"],Oe);let pe=p(e,["speechConfig"]);if(pe!=null&&g(i,["speechConfig"],Qy(pe)),p(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");let we=p(e,["thinkingConfig"]);we!=null&&g(i,["thinkingConfig"],we);let Ct=p(e,["imageConfig"]);Ct!=null&&g(i,["imageConfig"],SP(Ct));let ci=p(e,["enableEnhancedCivicAnswers"]);if(ci!=null&&g(i,["enableEnhancedCivicAnswers"],ci),p(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return i}function ZF(n,e,t){let i={},r=p(e,["systemInstruction"]);t!==void 0&&r!=null&&g(t,["systemInstruction"],Xt(r));let o=p(e,["temperature"]);o!=null&&g(i,["temperature"],o);let a=p(e,["topP"]);a!=null&&g(i,["topP"],a);let u=p(e,["topK"]);u!=null&&g(i,["topK"],u);let c=p(e,["candidateCount"]);c!=null&&g(i,["candidateCount"],c);let m=p(e,["maxOutputTokens"]);m!=null&&g(i,["maxOutputTokens"],m);let h=p(e,["stopSequences"]);h!=null&&g(i,["stopSequences"],h);let y=p(e,["responseLogprobs"]);y!=null&&g(i,["responseLogprobs"],y);let v=p(e,["logprobs"]);v!=null&&g(i,["logprobs"],v);let C=p(e,["presencePenalty"]);C!=null&&g(i,["presencePenalty"],C);let T=p(e,["frequencyPenalty"]);T!=null&&g(i,["frequencyPenalty"],T);let R=p(e,["seed"]);R!=null&&g(i,["seed"],R);let N=p(e,["responseMimeType"]);N!=null&&g(i,["responseMimeType"],N);let F=p(e,["responseSchema"]);F!=null&&g(i,["responseSchema"],Ky(F));let $=p(e,["responseJsonSchema"]);$!=null&&g(i,["responseJsonSchema"],$);let q=p(e,["routingConfig"]);q!=null&&g(i,["routingConfig"],q);let Q=p(e,["modelSelectionConfig"]);Q!=null&&g(i,["modelConfig"],Q);let ie=p(e,["safetySettings"]);if(t!==void 0&&ie!=null){let Ii=ie;Array.isArray(Ii)&&(Ii=Ii.map(wp=>wp)),g(t,["safetySettings"],Ii)}let de=p(e,["tools"]);if(t!==void 0&&de!=null){let Ii=Va(de);Array.isArray(Ii)&&(Ii=Ii.map(wp=>T2(ka(wp)))),g(t,["tools"],Ii)}let le=p(e,["toolConfig"]);t!==void 0&&le!=null&&g(t,["toolConfig"],le);let Oe=p(e,["labels"]);t!==void 0&&Oe!=null&&g(t,["labels"],Oe);let pe=p(e,["cachedContent"]);t!==void 0&&pe!=null&&g(t,["cachedContent"],Qi(n,pe));let we=p(e,["responseModalities"]);we!=null&&g(i,["responseModalities"],we);let Ct=p(e,["mediaResolution"]);Ct!=null&&g(i,["mediaResolution"],Ct);let ci=p(e,["speechConfig"]);ci!=null&&g(i,["speechConfig"],Qy(ci));let pt=p(e,["audioTimestamp"]);pt!=null&&g(i,["audioTimestamp"],pt);let mi=p(e,["thinkingConfig"]);mi!=null&&g(i,["thinkingConfig"],mi);let i_=p(e,["imageConfig"]);if(i_!=null&&g(i,["imageConfig"],DP(i_)),p(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");let r_=p(e,["modelArmorConfig"]);return t!==void 0&&r_!=null&&g(t,["modelArmorConfig"],r_),i}function GE(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],$e(n,i));let r=p(e,["contents"]);if(r!=null){let a=qn(r);Array.isArray(a)&&(a=a.map(u=>Ym(u))),g(t,["contents"],a)}let o=p(e,["config"]);return o!=null&&g(t,["generationConfig"],QF(n,o,t)),t}function qE(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],$e(n,i));let r=p(e,["contents"]);if(r!=null){let a=qn(r);Array.isArray(a)&&(a=a.map(u=>u)),g(t,["contents"],a)}let o=p(e,["config"]);return o!=null&&g(t,["generationConfig"],ZF(n,o,t)),t}function WE(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["candidates"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(m=>CF(m))),g(e,["candidates"],c)}let r=p(n,["modelVersion"]);r!=null&&g(e,["modelVersion"],r);let o=p(n,["promptFeedback"]);o!=null&&g(e,["promptFeedback"],o);let a=p(n,["responseId"]);a!=null&&g(e,["responseId"],a);let u=p(n,["usageMetadata"]);return u!=null&&g(e,["usageMetadata"],u),e}function jE(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["candidates"]);if(i!=null){let m=i;Array.isArray(m)&&(m=m.map(h=>h)),g(e,["candidates"],m)}let r=p(n,["createTime"]);r!=null&&g(e,["createTime"],r);let o=p(n,["modelVersion"]);o!=null&&g(e,["modelVersion"],o);let a=p(n,["promptFeedback"]);a!=null&&g(e,["promptFeedback"],a);let u=p(n,["responseId"]);u!=null&&g(e,["responseId"],u);let c=p(n,["usageMetadata"]);return c!=null&&g(e,["usageMetadata"],c),e}function XF(n,e){let t={};if(p(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(p(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");let i=p(n,["numberOfImages"]);e!==void 0&&i!=null&&g(e,["parameters","sampleCount"],i);let r=p(n,["aspectRatio"]);e!==void 0&&r!=null&&g(e,["parameters","aspectRatio"],r);let o=p(n,["guidanceScale"]);if(e!==void 0&&o!=null&&g(e,["parameters","guidanceScale"],o),p(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");let a=p(n,["safetyFilterLevel"]);e!==void 0&&a!=null&&g(e,["parameters","safetySetting"],a);let u=p(n,["personGeneration"]);e!==void 0&&u!=null&&g(e,["parameters","personGeneration"],u);let c=p(n,["includeSafetyAttributes"]);e!==void 0&&c!=null&&g(e,["parameters","includeSafetyAttributes"],c);let m=p(n,["includeRaiReason"]);e!==void 0&&m!=null&&g(e,["parameters","includeRaiReason"],m);let h=p(n,["language"]);e!==void 0&&h!=null&&g(e,["parameters","language"],h);let y=p(n,["outputMimeType"]);e!==void 0&&y!=null&&g(e,["parameters","outputOptions","mimeType"],y);let v=p(n,["outputCompressionQuality"]);if(e!==void 0&&v!=null&&g(e,["parameters","outputOptions","compressionQuality"],v),p(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(p(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");let C=p(n,["imageSize"]);if(e!==void 0&&C!=null&&g(e,["parameters","sampleImageSize"],C),p(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function eP(n,e){let t={},i=p(n,["outputGcsUri"]);e!==void 0&&i!=null&&g(e,["parameters","storageUri"],i);let r=p(n,["negativePrompt"]);e!==void 0&&r!=null&&g(e,["parameters","negativePrompt"],r);let o=p(n,["numberOfImages"]);e!==void 0&&o!=null&&g(e,["parameters","sampleCount"],o);let a=p(n,["aspectRatio"]);e!==void 0&&a!=null&&g(e,["parameters","aspectRatio"],a);let u=p(n,["guidanceScale"]);e!==void 0&&u!=null&&g(e,["parameters","guidanceScale"],u);let c=p(n,["seed"]);e!==void 0&&c!=null&&g(e,["parameters","seed"],c);let m=p(n,["safetyFilterLevel"]);e!==void 0&&m!=null&&g(e,["parameters","safetySetting"],m);let h=p(n,["personGeneration"]);e!==void 0&&h!=null&&g(e,["parameters","personGeneration"],h);let y=p(n,["includeSafetyAttributes"]);e!==void 0&&y!=null&&g(e,["parameters","includeSafetyAttributes"],y);let v=p(n,["includeRaiReason"]);e!==void 0&&v!=null&&g(e,["parameters","includeRaiReason"],v);let C=p(n,["language"]);e!==void 0&&C!=null&&g(e,["parameters","language"],C);let T=p(n,["outputMimeType"]);e!==void 0&&T!=null&&g(e,["parameters","outputOptions","mimeType"],T);let R=p(n,["outputCompressionQuality"]);e!==void 0&&R!=null&&g(e,["parameters","outputOptions","compressionQuality"],R);let N=p(n,["addWatermark"]);e!==void 0&&N!=null&&g(e,["parameters","addWatermark"],N);let F=p(n,["labels"]);e!==void 0&&F!=null&&g(e,["labels"],F);let $=p(n,["imageSize"]);e!==void 0&&$!=null&&g(e,["parameters","sampleImageSize"],$);let q=p(n,["enhancePrompt"]);return e!==void 0&&q!=null&&g(e,["parameters","enhancePrompt"],q),t}function tP(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],$e(n,i));let r=p(e,["prompt"]);r!=null&&g(t,["instances[0]","prompt"],r);let o=p(e,["config"]);return o!=null&&XF(o,t),t}function nP(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],$e(n,i));let r=p(e,["prompt"]);r!=null&&g(t,["instances[0]","prompt"],r);let o=p(e,["config"]);return o!=null&&eP(o,t),t}function iP(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>gP(a))),g(e,["generatedImages"],o)}let r=p(n,["positivePromptSafetyAttributes"]);return r!=null&&g(e,["positivePromptSafetyAttributes"],D2(r)),e}function rP(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>Jm(a))),g(e,["generatedImages"],o)}let r=p(n,["positivePromptSafetyAttributes"]);return r!=null&&g(e,["positivePromptSafetyAttributes"],w2(r)),e}function oP(n,e){let t={},i=p(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&g(e,["parameters","sampleCount"],i),p(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(p(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");let r=p(n,["durationSeconds"]);if(e!==void 0&&r!=null&&g(e,["parameters","durationSeconds"],r),p(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");let o=p(n,["aspectRatio"]);e!==void 0&&o!=null&&g(e,["parameters","aspectRatio"],o);let a=p(n,["resolution"]);e!==void 0&&a!=null&&g(e,["parameters","resolution"],a);let u=p(n,["personGeneration"]);if(e!==void 0&&u!=null&&g(e,["parameters","personGeneration"],u),p(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");let c=p(n,["negativePrompt"]);e!==void 0&&c!=null&&g(e,["parameters","negativePrompt"],c);let m=p(n,["enhancePrompt"]);if(e!==void 0&&m!=null&&g(e,["parameters","enhancePrompt"],m),p(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");let h=p(n,["lastFrame"]);e!==void 0&&h!=null&&g(e,["instances[0]","lastFrame"],Km(h));let y=p(n,["referenceImages"]);if(e!==void 0&&y!=null){let v=y;Array.isArray(v)&&(v=v.map(C=>sk(C))),g(e,["instances[0]","referenceImages"],v)}if(p(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(p(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function aP(n,e){let t={},i=p(n,["numberOfVideos"]);e!==void 0&&i!=null&&g(e,["parameters","sampleCount"],i);let r=p(n,["outputGcsUri"]);e!==void 0&&r!=null&&g(e,["parameters","storageUri"],r);let o=p(n,["fps"]);e!==void 0&&o!=null&&g(e,["parameters","fps"],o);let a=p(n,["durationSeconds"]);e!==void 0&&a!=null&&g(e,["parameters","durationSeconds"],a);let u=p(n,["seed"]);e!==void 0&&u!=null&&g(e,["parameters","seed"],u);let c=p(n,["aspectRatio"]);e!==void 0&&c!=null&&g(e,["parameters","aspectRatio"],c);let m=p(n,["resolution"]);e!==void 0&&m!=null&&g(e,["parameters","resolution"],m);let h=p(n,["personGeneration"]);e!==void 0&&h!=null&&g(e,["parameters","personGeneration"],h);let y=p(n,["pubsubTopic"]);e!==void 0&&y!=null&&g(e,["parameters","pubsubTopic"],y);let v=p(n,["negativePrompt"]);e!==void 0&&v!=null&&g(e,["parameters","negativePrompt"],v);let C=p(n,["enhancePrompt"]);e!==void 0&&C!=null&&g(e,["parameters","enhancePrompt"],C);let T=p(n,["generateAudio"]);e!==void 0&&T!=null&&g(e,["parameters","generateAudio"],T);let R=p(n,["lastFrame"]);e!==void 0&&R!=null&&g(e,["instances[0]","lastFrame"],di(R));let N=p(n,["referenceImages"]);if(e!==void 0&&N!=null){let q=N;Array.isArray(q)&&(q=q.map(Q=>lk(Q))),g(e,["instances[0]","referenceImages"],q)}let F=p(n,["mask"]);e!==void 0&&F!=null&&g(e,["instances[0]","mask"],ak(F));let $=p(n,["compressionQuality"]);return e!==void 0&&$!=null&&g(e,["parameters","compressionQuality"],$),t}function sP(n){let e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);let i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);let r=p(n,["done"]);r!=null&&g(e,["done"],r);let o=p(n,["error"]);o!=null&&g(e,["error"],o);let a=p(n,["response","generateVideoResponse"]);return a!=null&&g(e,["response"],cP(a)),e}function lP(n){let e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);let i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);let r=p(n,["done"]);r!=null&&g(e,["done"],r);let o=p(n,["error"]);o!=null&&g(e,["error"],o);let a=p(n,["response"]);return a!=null&&g(e,["response"],mP(a)),e}function uP(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],$e(n,i));let r=p(e,["prompt"]);r!=null&&g(t,["instances[0]","prompt"],r);let o=p(e,["image"]);o!=null&&g(t,["instances[0]","image"],Km(o));let a=p(e,["video"]);a!=null&&g(t,["instances[0]","video"],I2(a));let u=p(e,["source"]);u!=null&&pP(u,t);let c=p(e,["config"]);return c!=null&&oP(c,t),t}function dP(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],$e(n,i));let r=p(e,["prompt"]);r!=null&&g(t,["instances[0]","prompt"],r);let o=p(e,["image"]);o!=null&&g(t,["instances[0]","image"],di(o));let a=p(e,["video"]);a!=null&&g(t,["instances[0]","video"],M2(a));let u=p(e,["source"]);u!=null&&fP(u,t);let c=p(e,["config"]);return c!=null&&aP(c,t),t}function cP(n){let e={},t=p(n,["generatedSamples"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(a=>yP(a))),g(e,["generatedVideos"],o)}let i=p(n,["raiMediaFilteredCount"]);i!=null&&g(e,["raiMediaFilteredCount"],i);let r=p(n,["raiMediaFilteredReasons"]);return r!=null&&g(e,["raiMediaFilteredReasons"],r),e}function mP(n){let e={},t=p(n,["videos"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(a=>_P(a))),g(e,["generatedVideos"],o)}let i=p(n,["raiMediaFilteredCount"]);i!=null&&g(e,["raiMediaFilteredCount"],i);let r=p(n,["raiMediaFilteredReasons"]);return r!=null&&g(e,["raiMediaFilteredReasons"],r),e}function pP(n,e){let t={},i=p(n,["prompt"]);e!==void 0&&i!=null&&g(e,["instances[0]","prompt"],i);let r=p(n,["image"]);e!==void 0&&r!=null&&g(e,["instances[0]","image"],Km(r));let o=p(n,["video"]);return e!==void 0&&o!=null&&g(e,["instances[0]","video"],I2(o)),t}function fP(n,e){let t={},i=p(n,["prompt"]);e!==void 0&&i!=null&&g(e,["instances[0]","prompt"],i);let r=p(n,["image"]);e!==void 0&&r!=null&&g(e,["instances[0]","image"],di(r));let o=p(n,["video"]);return e!==void 0&&o!=null&&g(e,["instances[0]","video"],M2(o)),t}function gP(n){let e={},t=p(n,["_self"]);t!=null&&g(e,["image"],wP(t));let i=p(n,["raiFilteredReason"]);i!=null&&g(e,["raiFilteredReason"],i);let r=p(n,["_self"]);return r!=null&&g(e,["safetyAttributes"],D2(r)),e}function Jm(n){let e={},t=p(n,["_self"]);t!=null&&g(e,["image"],S2(t));let i=p(n,["raiFilteredReason"]);i!=null&&g(e,["raiFilteredReason"],i);let r=p(n,["_self"]);r!=null&&g(e,["safetyAttributes"],w2(r));let o=p(n,["prompt"]);return o!=null&&g(e,["enhancedPrompt"],o),e}function hP(n){let e={},t=p(n,["_self"]);t!=null&&g(e,["mask"],S2(t));let i=p(n,["labels"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>o)),g(e,["labels"],r)}return e}function yP(n){let e={},t=p(n,["video"]);return t!=null&&g(e,["video"],rk(t)),e}function _P(n){let e={},t=p(n,["_self"]);return t!=null&&g(e,["video"],ok(t)),e}function vP(n){let e={},t=p(n,["modelSelectionConfig"]);t!=null&&g(e,["modelConfig"],t);let i=p(n,["responseJsonSchema"]);i!=null&&g(e,["responseJsonSchema"],i);let r=p(n,["audioTimestamp"]);r!=null&&g(e,["audioTimestamp"],r);let o=p(n,["candidateCount"]);o!=null&&g(e,["candidateCount"],o);let a=p(n,["enableAffectiveDialog"]);a!=null&&g(e,["enableAffectiveDialog"],a);let u=p(n,["frequencyPenalty"]);u!=null&&g(e,["frequencyPenalty"],u);let c=p(n,["logprobs"]);c!=null&&g(e,["logprobs"],c);let m=p(n,["maxOutputTokens"]);m!=null&&g(e,["maxOutputTokens"],m);let h=p(n,["mediaResolution"]);h!=null&&g(e,["mediaResolution"],h);let y=p(n,["presencePenalty"]);y!=null&&g(e,["presencePenalty"],y);let v=p(n,["responseLogprobs"]);v!=null&&g(e,["responseLogprobs"],v);let C=p(n,["responseMimeType"]);C!=null&&g(e,["responseMimeType"],C);let T=p(n,["responseModalities"]);T!=null&&g(e,["responseModalities"],T);let R=p(n,["responseSchema"]);R!=null&&g(e,["responseSchema"],R);let N=p(n,["routingConfig"]);N!=null&&g(e,["routingConfig"],N);let F=p(n,["seed"]);F!=null&&g(e,["seed"],F);let $=p(n,["speechConfig"]);$!=null&&g(e,["speechConfig"],$);let q=p(n,["stopSequences"]);q!=null&&g(e,["stopSequences"],q);let Q=p(n,["temperature"]);Q!=null&&g(e,["temperature"],Q);let ie=p(n,["thinkingConfig"]);ie!=null&&g(e,["thinkingConfig"],ie);let de=p(n,["topK"]);de!=null&&g(e,["topK"],de);let le=p(n,["topP"]);if(le!=null&&g(e,["topP"],le),p(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function CP(n,e){let t={},i=p(e,["model"]);return i!=null&&g(t,["_url","name"],$e(n,i)),t}function xP(n,e){let t={},i=p(e,["model"]);return i!=null&&g(t,["_url","name"],$e(n,i)),t}function bP(n){let e={};if(p(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");let t=p(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function EP(n){let e={};if(p(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");let t=p(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function SP(n){let e={},t=p(n,["aspectRatio"]);t!=null&&g(e,["aspectRatio"],t);let i=p(n,["imageSize"]);if(i!=null&&g(e,["imageSize"],i),p(n,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(p(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(p(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function DP(n){let e={},t=p(n,["aspectRatio"]);t!=null&&g(e,["aspectRatio"],t);let i=p(n,["imageSize"]);i!=null&&g(e,["imageSize"],i);let r=p(n,["personGeneration"]);r!=null&&g(e,["personGeneration"],r);let o=p(n,["outputMimeType"]);o!=null&&g(e,["imageOutputOptions","mimeType"],o);let a=p(n,["outputCompressionQuality"]);return a!=null&&g(e,["imageOutputOptions","compressionQuality"],a),e}function wP(n){let e={},t=p(n,["bytesBase64Encoded"]);t!=null&&g(e,["imageBytes"],br(t));let i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function S2(n){let e={},t=p(n,["gcsUri"]);t!=null&&g(e,["gcsUri"],t);let i=p(n,["bytesBase64Encoded"]);i!=null&&g(e,["imageBytes"],br(i));let r=p(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function Km(n){let e={};if(p(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");let t=p(n,["imageBytes"]);t!=null&&g(e,["bytesBase64Encoded"],br(t));let i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function di(n){let e={},t=p(n,["gcsUri"]);t!=null&&g(e,["gcsUri"],t);let i=p(n,["imageBytes"]);i!=null&&g(e,["bytesBase64Encoded"],br(i));let r=p(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function TP(n,e,t){let i={},r=p(e,["pageSize"]);t!==void 0&&r!=null&&g(t,["_query","pageSize"],r);let o=p(e,["pageToken"]);t!==void 0&&o!=null&&g(t,["_query","pageToken"],o);let a=p(e,["filter"]);t!==void 0&&a!=null&&g(t,["_query","filter"],a);let u=p(e,["queryBase"]);return t!==void 0&&u!=null&&g(t,["_url","models_url"],y2(n,u)),i}function IP(n,e,t){let i={},r=p(e,["pageSize"]);t!==void 0&&r!=null&&g(t,["_query","pageSize"],r);let o=p(e,["pageToken"]);t!==void 0&&o!=null&&g(t,["_query","pageToken"],o);let a=p(e,["filter"]);t!==void 0&&a!=null&&g(t,["_query","filter"],a);let u=p(e,["queryBase"]);return t!==void 0&&u!=null&&g(t,["_url","models_url"],y2(n,u)),i}function MP(n,e){let t={},i=p(e,["config"]);return i!=null&&TP(n,i,t),t}function AP(n,e){let t={},i=p(e,["config"]);return i!=null&&IP(n,i,t),t}function RP(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);let r=p(n,["_self"]);if(r!=null){let o=_2(r);Array.isArray(o)&&(o=o.map(a=>Cy(a))),g(e,["models"],o)}return e}function NP(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);let r=p(n,["_self"]);if(r!=null){let o=_2(r);Array.isArray(o)&&(o=o.map(a=>xy(a))),g(e,["models"],o)}return e}function FP(n){let e={},t=p(n,["maskMode"]);t!=null&&g(e,["maskMode"],t);let i=p(n,["segmentationClasses"]);i!=null&&g(e,["maskClasses"],i);let r=p(n,["maskDilation"]);return r!=null&&g(e,["dilation"],r),e}function Cy(n){let e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);let i=p(n,["displayName"]);i!=null&&g(e,["displayName"],i);let r=p(n,["description"]);r!=null&&g(e,["description"],r);let o=p(n,["version"]);o!=null&&g(e,["version"],o);let a=p(n,["_self"]);a!=null&&g(e,["tunedModelInfo"],JP(a));let u=p(n,["inputTokenLimit"]);u!=null&&g(e,["inputTokenLimit"],u);let c=p(n,["outputTokenLimit"]);c!=null&&g(e,["outputTokenLimit"],c);let m=p(n,["supportedGenerationMethods"]);m!=null&&g(e,["supportedActions"],m);let h=p(n,["temperature"]);h!=null&&g(e,["temperature"],h);let y=p(n,["maxTemperature"]);y!=null&&g(e,["maxTemperature"],y);let v=p(n,["topP"]);v!=null&&g(e,["topP"],v);let C=p(n,["topK"]);C!=null&&g(e,["topK"],C);let T=p(n,["thinking"]);return T!=null&&g(e,["thinking"],T),e}function xy(n){let e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);let i=p(n,["displayName"]);i!=null&&g(e,["displayName"],i);let r=p(n,["description"]);r!=null&&g(e,["description"],r);let o=p(n,["versionId"]);o!=null&&g(e,["version"],o);let a=p(n,["deployedModels"]);if(a!=null){let y=a;Array.isArray(y)&&(y=y.map(v=>jF(v))),g(e,["endpoints"],y)}let u=p(n,["labels"]);u!=null&&g(e,["labels"],u);let c=p(n,["_self"]);c!=null&&g(e,["tunedModelInfo"],KP(c));let m=p(n,["defaultCheckpointId"]);m!=null&&g(e,["defaultCheckpointId"],m);let h=p(n,["checkpoints"]);if(h!=null){let y=h;Array.isArray(y)&&(y=y.map(v=>v)),g(e,["checkpoints"],y)}return e}function PP(n){let e={},t=p(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);let i=p(n,["codeExecutionResult"]);i!=null&&g(e,["codeExecutionResult"],i);let r=p(n,["executableCode"]);r!=null&&g(e,["executableCode"],r);let o=p(n,["fileData"]);o!=null&&g(e,["fileData"],zF(o));let a=p(n,["functionCall"]);a!=null&&g(e,["functionCall"],YF(a));let u=p(n,["functionResponse"]);u!=null&&g(e,["functionResponse"],u);let c=p(n,["inlineData"]);c!=null&&g(e,["inlineData"],vF(c));let m=p(n,["text"]);m!=null&&g(e,["text"],m);let h=p(n,["thought"]);h!=null&&g(e,["thought"],h);let y=p(n,["thoughtSignature"]);y!=null&&g(e,["thoughtSignature"],y);let v=p(n,["videoMetadata"]);return v!=null&&g(e,["videoMetadata"],v),e}function kP(n){let e={},t=p(n,["productImage"]);return t!=null&&g(e,["image"],di(t)),e}function VP(n,e){let t={},i=p(n,["numberOfImages"]);e!==void 0&&i!=null&&g(e,["parameters","sampleCount"],i);let r=p(n,["baseSteps"]);e!==void 0&&r!=null&&g(e,["parameters","baseSteps"],r);let o=p(n,["outputGcsUri"]);e!==void 0&&o!=null&&g(e,["parameters","storageUri"],o);let a=p(n,["seed"]);e!==void 0&&a!=null&&g(e,["parameters","seed"],a);let u=p(n,["safetyFilterLevel"]);e!==void 0&&u!=null&&g(e,["parameters","safetySetting"],u);let c=p(n,["personGeneration"]);e!==void 0&&c!=null&&g(e,["parameters","personGeneration"],c);let m=p(n,["addWatermark"]);e!==void 0&&m!=null&&g(e,["parameters","addWatermark"],m);let h=p(n,["outputMimeType"]);e!==void 0&&h!=null&&g(e,["parameters","outputOptions","mimeType"],h);let y=p(n,["outputCompressionQuality"]);e!==void 0&&y!=null&&g(e,["parameters","outputOptions","compressionQuality"],y);let v=p(n,["enhancePrompt"]);e!==void 0&&v!=null&&g(e,["parameters","enhancePrompt"],v);let C=p(n,["labels"]);return e!==void 0&&C!=null&&g(e,["labels"],C),t}function OP(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],$e(n,i));let r=p(e,["source"]);r!=null&&BP(r,t);let o=p(e,["config"]);return o!=null&&VP(o,t),t}function LP(n){let e={},t=p(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>Jm(r))),g(e,["generatedImages"],i)}return e}function BP(n,e){let t={},i=p(n,["prompt"]);e!==void 0&&i!=null&&g(e,["instances[0]","prompt"],i);let r=p(n,["personImage"]);e!==void 0&&r!=null&&g(e,["instances[0]","personImage","image"],di(r));let o=p(n,["productImages"]);if(e!==void 0&&o!=null){let a=o;Array.isArray(a)&&(a=a.map(u=>kP(u))),g(e,["instances[0]","productImages"],a)}return t}function UP(n){let e={},t=p(n,["referenceImage"]);t!=null&&g(e,["referenceImage"],di(t));let i=p(n,["referenceId"]);i!=null&&g(e,["referenceId"],i);let r=p(n,["referenceType"]);r!=null&&g(e,["referenceType"],r);let o=p(n,["maskImageConfig"]);o!=null&&g(e,["maskImageConfig"],FP(o));let a=p(n,["controlImageConfig"]);a!=null&&g(e,["controlImageConfig"],wF(a));let u=p(n,["styleImageConfig"]);u!=null&&g(e,["styleImageConfig"],u);let c=p(n,["subjectImageConfig"]);return c!=null&&g(e,["subjectImageConfig"],c),e}function D2(n){let e={},t=p(n,["safetyAttributes","categories"]);t!=null&&g(e,["categories"],t);let i=p(n,["safetyAttributes","scores"]);i!=null&&g(e,["scores"],i);let r=p(n,["contentType"]);return r!=null&&g(e,["contentType"],r),e}function w2(n){let e={},t=p(n,["safetyAttributes","categories"]);t!=null&&g(e,["categories"],t);let i=p(n,["safetyAttributes","scores"]);i!=null&&g(e,["scores"],i);let r=p(n,["contentType"]);return r!=null&&g(e,["contentType"],r),e}function $P(n){let e={},t=p(n,["category"]);if(t!=null&&g(e,["category"],t),p(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");let i=p(n,["threshold"]);return i!=null&&g(e,["threshold"],i),e}function HP(n){let e={},t=p(n,["image"]);return t!=null&&g(e,["image"],di(t)),e}function GP(n,e){let t={},i=p(n,["mode"]);e!==void 0&&i!=null&&g(e,["parameters","mode"],i);let r=p(n,["maxPredictions"]);e!==void 0&&r!=null&&g(e,["parameters","maxPredictions"],r);let o=p(n,["confidenceThreshold"]);e!==void 0&&o!=null&&g(e,["parameters","confidenceThreshold"],o);let a=p(n,["maskDilation"]);e!==void 0&&a!=null&&g(e,["parameters","maskDilation"],a);let u=p(n,["binaryColorThreshold"]);e!==void 0&&u!=null&&g(e,["parameters","binaryColorThreshold"],u);let c=p(n,["labels"]);return e!==void 0&&c!=null&&g(e,["labels"],c),t}function qP(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],$e(n,i));let r=p(e,["source"]);r!=null&&jP(r,t);let o=p(e,["config"]);return o!=null&&GP(o,t),t}function WP(n){let e={},t=p(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>hP(r))),g(e,["generatedMasks"],i)}return e}function jP(n,e){let t={},i=p(n,["prompt"]);e!==void 0&&i!=null&&g(e,["instances[0]","prompt"],i);let r=p(n,["image"]);e!==void 0&&r!=null&&g(e,["instances[0]","image"],di(r));let o=p(n,["scribbleImage"]);return e!==void 0&&o!=null&&g(e,["instances[0]","scribble"],HP(o)),t}function zP(n){let e={},t=p(n,["retrievalConfig"]);t!=null&&g(e,["retrievalConfig"],t);let i=p(n,["functionCallingConfig"]);return i!=null&&g(e,["functionCallingConfig"],JF(i)),e}function YP(n){let e={};if(p(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");let t=p(n,["computerUse"]);t!=null&&g(e,["computerUse"],t);let i=p(n,["fileSearch"]);i!=null&&g(e,["fileSearch"],i);let r=p(n,["codeExecution"]);if(r!=null&&g(e,["codeExecution"],r),p(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");let o=p(n,["functionDeclarations"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(y=>y)),g(e,["functionDeclarations"],h)}let a=p(n,["googleMaps"]);a!=null&&g(e,["googleMaps"],bP(a));let u=p(n,["googleSearch"]);u!=null&&g(e,["googleSearch"],EP(u));let c=p(n,["googleSearchRetrieval"]);c!=null&&g(e,["googleSearchRetrieval"],c);let m=p(n,["urlContext"]);return m!=null&&g(e,["urlContext"],m),e}function T2(n){let e={},t=p(n,["retrieval"]);t!=null&&g(e,["retrieval"],t);let i=p(n,["computerUse"]);if(i!=null&&g(e,["computerUse"],i),p(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");let r=p(n,["codeExecution"]);r!=null&&g(e,["codeExecution"],r);let o=p(n,["enterpriseWebSearch"]);o!=null&&g(e,["enterpriseWebSearch"],o);let a=p(n,["functionDeclarations"]);if(a!=null){let y=a;Array.isArray(y)&&(y=y.map(v=>KF(v))),g(e,["functionDeclarations"],y)}let u=p(n,["googleMaps"]);u!=null&&g(e,["googleMaps"],u);let c=p(n,["googleSearch"]);c!=null&&g(e,["googleSearch"],c);let m=p(n,["googleSearchRetrieval"]);m!=null&&g(e,["googleSearchRetrieval"],m);let h=p(n,["urlContext"]);return h!=null&&g(e,["urlContext"],h),e}function JP(n){let e={},t=p(n,["baseModel"]);t!=null&&g(e,["baseModel"],t);let i=p(n,["createTime"]);i!=null&&g(e,["createTime"],i);let r=p(n,["updateTime"]);return r!=null&&g(e,["updateTime"],r),e}function KP(n){let e={},t=p(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&g(e,["baseModel"],t);let i=p(n,["createTime"]);i!=null&&g(e,["createTime"],i);let r=p(n,["updateTime"]);return r!=null&&g(e,["updateTime"],r),e}function QP(n,e){let t={},i=p(n,["displayName"]);e!==void 0&&i!=null&&g(e,["displayName"],i);let r=p(n,["description"]);e!==void 0&&r!=null&&g(e,["description"],r);let o=p(n,["defaultCheckpointId"]);return e!==void 0&&o!=null&&g(e,["defaultCheckpointId"],o),t}function ZP(n,e){let t={},i=p(n,["displayName"]);e!==void 0&&i!=null&&g(e,["displayName"],i);let r=p(n,["description"]);e!==void 0&&r!=null&&g(e,["description"],r);let o=p(n,["defaultCheckpointId"]);return e!==void 0&&o!=null&&g(e,["defaultCheckpointId"],o),t}function XP(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","name"],$e(n,i));let r=p(e,["config"]);return r!=null&&QP(r,t),t}function ek(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],$e(n,i));let r=p(e,["config"]);return r!=null&&ZP(r,t),t}function tk(n,e){let t={},i=p(n,["outputGcsUri"]);e!==void 0&&i!=null&&g(e,["parameters","storageUri"],i);let r=p(n,["safetyFilterLevel"]);e!==void 0&&r!=null&&g(e,["parameters","safetySetting"],r);let o=p(n,["personGeneration"]);e!==void 0&&o!=null&&g(e,["parameters","personGeneration"],o);let a=p(n,["includeRaiReason"]);e!==void 0&&a!=null&&g(e,["parameters","includeRaiReason"],a);let u=p(n,["outputMimeType"]);e!==void 0&&u!=null&&g(e,["parameters","outputOptions","mimeType"],u);let c=p(n,["outputCompressionQuality"]);e!==void 0&&c!=null&&g(e,["parameters","outputOptions","compressionQuality"],c);let m=p(n,["enhanceInputImage"]);e!==void 0&&m!=null&&g(e,["parameters","upscaleConfig","enhanceInputImage"],m);let h=p(n,["imagePreservationFactor"]);e!==void 0&&h!=null&&g(e,["parameters","upscaleConfig","imagePreservationFactor"],h);let y=p(n,["labels"]);e!==void 0&&y!=null&&g(e,["labels"],y);let v=p(n,["numberOfImages"]);e!==void 0&&v!=null&&g(e,["parameters","sampleCount"],v);let C=p(n,["mode"]);return e!==void 0&&C!=null&&g(e,["parameters","mode"],C),t}function nk(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],$e(n,i));let r=p(e,["image"]);r!=null&&g(t,["instances[0]","image"],di(r));let o=p(e,["upscaleFactor"]);o!=null&&g(t,["parameters","upscaleConfig","upscaleFactor"],o);let a=p(e,["config"]);return a!=null&&tk(a,t),t}function ik(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>Jm(o))),g(e,["generatedImages"],r)}return e}function rk(n){let e={},t=p(n,["uri"]);t!=null&&g(e,["uri"],t);let i=p(n,["encodedVideo"]);i!=null&&g(e,["videoBytes"],br(i));let r=p(n,["encoding"]);return r!=null&&g(e,["mimeType"],r),e}function ok(n){let e={},t=p(n,["gcsUri"]);t!=null&&g(e,["uri"],t);let i=p(n,["bytesBase64Encoded"]);i!=null&&g(e,["videoBytes"],br(i));let r=p(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function ak(n){let e={},t=p(n,["image"]);t!=null&&g(e,["_self"],di(t));let i=p(n,["maskMode"]);return i!=null&&g(e,["maskMode"],i),e}function sk(n){let e={},t=p(n,["image"]);t!=null&&g(e,["image"],Km(t));let i=p(n,["referenceType"]);return i!=null&&g(e,["referenceType"],i),e}function lk(n){let e={},t=p(n,["image"]);t!=null&&g(e,["image"],di(t));let i=p(n,["referenceType"]);return i!=null&&g(e,["referenceType"],i),e}function I2(n){let e={},t=p(n,["uri"]);t!=null&&g(e,["uri"],t);let i=p(n,["videoBytes"]);i!=null&&g(e,["encodedVideo"],br(i));let r=p(n,["mimeType"]);return r!=null&&g(e,["encoding"],r),e}function M2(n){let e={},t=p(n,["uri"]);t!=null&&g(e,["gcsUri"],t);let i=p(n,["videoBytes"]);i!=null&&g(e,["bytesBase64Encoded"],br(i));let r=p(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function uk(n,e){let t={},i=p(n,["displayName"]);return e!==void 0&&i!=null&&g(e,["displayName"],i),t}function dk(n){let e={},t=p(n,["config"]);return t!=null&&uk(t,e),e}function ck(n,e){let t={},i=p(n,["force"]);return e!==void 0&&i!=null&&g(e,["_query","force"],i),t}function mk(n){let e={},t=p(n,["name"]);t!=null&&g(e,["_url","name"],t);let i=p(n,["config"]);return i!=null&&ck(i,e),e}function pk(n){let e={},t=p(n,["name"]);return t!=null&&g(e,["_url","name"],t),e}function fk(n,e){let t={},i=p(n,["customMetadata"]);if(e!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>a)),g(e,["customMetadata"],o)}let r=p(n,["chunkingConfig"]);return e!==void 0&&r!=null&&g(e,["chunkingConfig"],r),t}function gk(n){let e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);let i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);let r=p(n,["done"]);r!=null&&g(e,["done"],r);let o=p(n,["error"]);o!=null&&g(e,["error"],o);let a=p(n,["response"]);return a!=null&&g(e,["response"],yk(a)),e}function hk(n){let e={},t=p(n,["fileSearchStoreName"]);t!=null&&g(e,["_url","file_search_store_name"],t);let i=p(n,["fileName"]);i!=null&&g(e,["fileName"],i);let r=p(n,["config"]);return r!=null&&fk(r,e),e}function yk(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["parent"]);i!=null&&g(e,["parent"],i);let r=p(n,["documentName"]);return r!=null&&g(e,["documentName"],r),e}function _k(n,e){let t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);let r=p(n,["pageToken"]);return e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),t}function vk(n){let e={},t=p(n,["config"]);return t!=null&&_k(t,e),e}function Ck(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);let r=p(n,["fileSearchStores"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>a)),g(e,["fileSearchStores"],o)}return e}function A2(n,e){let t={},i=p(n,["mimeType"]);e!==void 0&&i!=null&&g(e,["mimeType"],i);let r=p(n,["displayName"]);e!==void 0&&r!=null&&g(e,["displayName"],r);let o=p(n,["customMetadata"]);if(e!==void 0&&o!=null){let u=o;Array.isArray(u)&&(u=u.map(c=>c)),g(e,["customMetadata"],u)}let a=p(n,["chunkingConfig"]);return e!==void 0&&a!=null&&g(e,["chunkingConfig"],a),t}function xk(n){let e={},t=p(n,["fileSearchStoreName"]);t!=null&&g(e,["_url","file_search_store_name"],t);let i=p(n,["config"]);return i!=null&&A2(i,e),e}function bk(n){let e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}var Ek="Content-Type",Sk="X-Server-Timeout",Dk="User-Agent",by="x-goog-api-client",wk="1.38.0",Tk=`google-genai-sdk/${wk}`,Ik="v1beta1",Mk="v1beta",Ey=class{constructor(e){var t,i,r;this.clientOptions=Object.assign({},e),this.customBaseUrl=(t=e.httpOptions)===null||t===void 0?void 0:t.baseUrl,this.clientOptions.vertexai&&(this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:this.clientOptions.apiKey&&(this.clientOptions.project=void 0,this.clientOptions.location=void 0));let o={};if(this.clientOptions.vertexai){if(!this.clientOptions.location&&!this.clientOptions.apiKey&&!this.customBaseUrl&&(this.clientOptions.location="global"),!(this.clientOptions.project&&this.clientOptions.location||this.clientOptions.apiKey)&&!this.customBaseUrl)throw new Error("Authentication is not set up. Please provide either a project and location, or an API key, or a custom base URL.");let u=e.project&&e.location||!!e.apiKey;this.customBaseUrl&&!u?(o.baseUrl=this.customBaseUrl,this.clientOptions.project=void 0,this.clientOptions.location=void 0):this.clientOptions.apiKey||this.clientOptions.location==="global"?o.baseUrl="https://aiplatform.googleapis.com/":this.clientOptions.project&&this.clientOptions.location&&(o.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`),o.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:Ik}else{if(!this.clientOptions.apiKey)throw new Ql({message:"API key must be set when using the Gemini API.",status:403});o.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:Mk,o.baseUrl="https://generativelanguage.googleapis.com/"}o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,e.httpOptions))}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getCustomBaseUrl(){return this.customBaseUrl}async getAuthHeaders(){let e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");let i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){let e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){let r=[this.getRequestUrlInternal(t)];return i&&r.push(this.getBaseResourcePath()),e!==""&&r.push(e),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(e,t){return!(t.baseUrl&&t.baseUrlResourceScope===u2.COLLECTION||this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let i=this.shouldPrependVertexProjectPath(e,t),r=this.constructUrl(e.path,t,i);if(e.queryParams)for(let[a,u]of Object.entries(e.queryParams))r.searchParams.append(a,String(u));let o={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=e.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,t,r.toString(),e.abortSignal),this.unaryApiCall(r,o,e.httpMethod)}patchHttpOptions(e,t){let i=JSON.parse(JSON.stringify(e));for(let[r,o]of Object.entries(t))typeof o=="object"?i[r]=Object.assign(Object.assign({},i[r]),o):o!==void 0&&(i[r]=o);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let i=this.shouldPrependVertexProjectPath(e,t),r=this.constructUrl(e.path,t,i);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let o={};return o.body=e.body,o=await this.includeExtraHttpOptionsToRequestInit(o,t,r.toString(),e.abortSignal),this.streamApiCall(r,o,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i,r){if(t&&t.timeout||r){let o=new AbortController,a=o.signal;if(t.timeout&&t?.timeout>0){let u=setTimeout(()=>o.abort(),t.timeout);u&&typeof u.unref=="function"&&u.unref()}r&&r.addEventListener("abort",()=>{o.abort()}),e.signal=a}return t&&t.extraBody!==null&&Ak(e,t.extraBody),e.headers=await this.getHeadersInternal(t,i),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await zE(r),new Kl(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await zE(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(e){return si(this,arguments,function*(){var i;let r=(i=e?.body)===null||i===void 0?void 0:i.getReader(),o=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let a="",u="data:",c=[`

`,"\r\r",`\r
\r
`];for(;;){let{done:m,value:h}=yield ve(r.read());if(m){if(a.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}let y=o.decode(h,{stream:!0});try{let T=JSON.parse(y);if("error"in T){let R=JSON.parse(JSON.stringify(T.error)),N=R.status,F=R.code,$=`got status: ${N}. ${JSON.stringify(T)}`;if(F>=400&&F<600)throw new Ql({message:$,status:F})}}catch(T){if(T.name==="ApiError")throw T}a+=y;let v=-1,C=0;for(;;){v=-1,C=0;for(let N of c){let F=a.indexOf(N);F!==-1&&(v===-1||F<v)&&(v=F,C=N.length)}if(v===-1)break;let T=a.substring(0,v);a=a.substring(v+C);let R=T.trim();if(R.startsWith(u)){let N=R.substring(u.length).trim();try{let F=new Response(N,{headers:e?.headers,status:e?.status,statusText:e?.statusText});yield yield ve(new Kl(F))}catch(F){throw new Error(`exception parsing stream chunk ${N}. ${F}`)}}}}}finally{r.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){let e={},t=Tk+" "+this.clientOptions.userAgentExtra;return e[Dk]=t,e[by]=t,e[Ek]="application/json",e}async getHeadersInternal(e,t){let i=new Headers;if(e&&e.headers){for(let[r,o]of Object.entries(e.headers))i.append(r,o);e.timeout&&e.timeout>0&&i.append(Sk,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(i,t),i}getFileName(e){var t;let i="";return typeof e=="string"&&(i=e.replace(/[/\\]+$/,""),i=(t=i.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),i}async uploadFile(e,t){var i;let r={};t!=null&&(r.mimeType=t.mimeType,r.name=t.name,r.displayName=t.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);let o=this.clientOptions.uploader,a=await o.stat(e);r.sizeBytes=String(a.size);let u=(i=t?.mimeType)!==null&&i!==void 0?i:a.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=u;let c={file:r},m=this.getFileName(e),h=ee("upload/v1beta/files",c._url),y=await this.fetchUploadUrl(h,r.sizeBytes,r.mimeType,m,c,t?.httpOptions);return o.upload(e,y,this)}async uploadFileToFileSearchStore(e,t,i){var r;let o=this.clientOptions.uploader,a=await o.stat(t),u=String(a.size),c=(r=i?.mimeType)!==null&&r!==void 0?r:a.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");let m=`upload/v1beta/${e}:uploadToFileSearchStore`,h=this.getFileName(t),y={};i!=null&&A2(i,y);let v=await this.fetchUploadUrl(m,u,c,h,y,i?.httpOptions);return o.uploadToFileSearchStore(t,v,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,i,r,o,a){var u;let c={};a?c=a:c={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${i}`},r?{"X-Goog-Upload-File-Name":r}:{})};let m=await this.request({path:e,body:JSON.stringify(o),httpMethod:"POST",httpOptions:c});if(!m||!m?.headers)throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");let h=(u=m?.headers)===null||u===void 0?void 0:u["x-goog-upload-url"];if(h===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return h}};async function zE(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){let t=n.status,i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};let r=JSON.stringify(i);throw t>=400&&t<600?new Ql({message:r,status:t}):new Error(r)}}function Ak(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{let o=JSON.parse(n.body);if(typeof o=="object"&&o!==null&&!Array.isArray(o))t=o;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(o,a){let u=Object.assign({},o);for(let c in a)if(Object.prototype.hasOwnProperty.call(a,c)){let m=a[c],h=u[c];m&&typeof m=="object"&&!Array.isArray(m)&&h&&typeof h=="object"&&!Array.isArray(h)?u[c]=i(h,m):(h&&m&&typeof h!=typeof m&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${c}". Original type: ${typeof h}, New type: ${typeof m}. Overwriting.`),u[c]=m)}return u}let r=i(t,e);n.body=JSON.stringify(r)}var Rk="mcp_used/unknown",Nk=!1;function R2(n){for(let e of n)if(Fk(e)||typeof e=="object"&&"inputSchema"in e)return!0;return Nk}function N2(n){var e;let t=(e=n[by])!==null&&e!==void 0?e:"";n[by]=(t+` ${Rk}`).trimStart()}function Fk(n){return n!==null&&typeof n=="object"&&n instanceof Sy}function Pk(n){return si(this,arguments,function*(t,i=100){let r,o=0;for(;o<i;){let a=yield ve(t.listTools({cursor:r}));for(let u of a.tools)yield yield ve(u),o++;if(!a.nextCursor)break;r=a.nextCursor}})}var Sy=class n{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new n(e,t)}async initialize(){var e,t,i,r;if(this.mcpTools.length>0)return;let o={},a=[];for(let h of this.mcpClients)try{for(var u=!0,c=(t=void 0,li(Pk(h))),m;m=await c.next(),e=m.done,!e;u=!0){r=m.value,u=!1;let y=r;a.push(y);let v=y.name;if(o[v])throw new Error(`Duplicate function name ${v} found in MCP tools. Please ensure function names are unique.`);o[v]=h}}catch(y){t={error:y}}finally{try{!u&&!e&&(i=c.return)&&await i.call(c)}finally{if(t)throw t.error}}this.mcpTools=a,this.functionNameToMcpClient=o}async tool(){return await this.initialize(),y4(this.mcpTools,this.config)}async callTool(e){await this.initialize();let t=[];for(let i of e)if(i.name in this.functionNameToMcpClient){let r=this.functionNameToMcpClient[i.name],o;this.config.timeout&&(o={timeout:this.config.timeout});let a=await r.callTool({name:i.name,arguments:i.args},void 0,o);t.push({functionResponse:{name:i.name,response:a.isError?{error:a}:a}})}return t}};async function kk(n,e,t){let i=new cy,r;t.data instanceof Blob?r=JSON.parse(await t.data.text()):r=JSON.parse(t.data),Object.assign(i,r),e(i)}var Dy=class{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");let r=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),a=Ok(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),c=`${r}/ws/google.ai.generativelanguage.${o}.GenerativeService.BidiGenerateMusic?key=${u}`,m=()=>{},h=new Promise(q=>{m=q}),y=e.callbacks,v=function(){m({})},C=this.apiClient,T={onopen:v,onmessage:q=>{kk(C,y.onmessage,q)},onerror:(t=y?.onerror)!==null&&t!==void 0?t:function(q){},onclose:(i=y?.onclose)!==null&&i!==void 0?i:function(q){}},R=this.webSocketFactory.create(c,Vk(a),T);R.connect(),await h;let $={setup:{model:$e(this.apiClient,e.model)}};return R.send(JSON.stringify($)),new wy(R,this.apiClient)}},wy=class{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");let t=uF(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});let t=lF(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){let t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Yl.PLAY)}pause(){this.sendPlaybackControl(Yl.PAUSE)}stop(){this.sendPlaybackControl(Yl.STOP)}resetContext(){this.sendPlaybackControl(Yl.RESET_CONTEXT)}close(){this.conn.close()}};function Vk(n){let e={};return n.forEach((t,i)=>{e[i]=t}),e}function Ok(n){let e=new Headers;for(let[t,i]of Object.entries(n))e.append(t,i);return e}var Lk="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Bk(n,e,t){let i=new dy,r;t.data instanceof Blob?r=await t.data.text():t.data instanceof ArrayBuffer?r=new TextDecoder().decode(t.data):r=t.data;let o=JSON.parse(r);if(n.isVertexAI()){let a=mF(o);Object.assign(i,a)}else Object.assign(i,o);e(i)}var Ty=class{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new Dy(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,r,o,a,u;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");let c=this.apiClient.getWebsocketBaseUrl(),m=this.apiClient.getApiVersion(),h,y=this.apiClient.getHeaders();e.config&&e.config.tools&&R2(e.config.tools)&&N2(y);let v=Hk(y);if(this.apiClient.isVertexAI()){let pe=this.apiClient.getProject(),we=this.apiClient.getLocation(),Ct=this.apiClient.getApiKey(),ci=!!pe&&!!we||!!Ct;this.apiClient.getCustomBaseUrl()&&!ci?h=c:(h=`${c}/ws/google.cloud.aiplatform.${m}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(v,h))}else{let pe=this.apiClient.getApiKey(),we="BidiGenerateContent",Ct="key";pe?.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),m!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),we="BidiGenerateContentConstrained",Ct="access_token"),h=`${c}/ws/google.ai.generativelanguage.${m}.GenerativeService.${we}?${Ct}=${pe}`}let C=()=>{},T=new Promise(pe=>{C=pe}),R=e.callbacks,N=function(){var pe;(pe=R?.onopen)===null||pe===void 0||pe.call(R),C({})},F=this.apiClient,$={onopen:N,onmessage:pe=>{Bk(F,R.onmessage,pe)},onerror:(t=R?.onerror)!==null&&t!==void 0?t:function(pe){},onclose:(i=R?.onclose)!==null&&i!==void 0?i:function(pe){}},q=this.webSocketFactory.create(h,$k(v),$);q.connect(),await T;let Q=$e(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&Q.startsWith("publishers/")){let pe=this.apiClient.getProject(),we=this.apiClient.getLocation();pe&&we&&(Q=`projects/${pe}/locations/${we}/`+Q)}let ie={};this.apiClient.isVertexAI()&&((r=e.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Qh.AUDIO]}:e.config.responseModalities=[Qh.AUDIO]),!((o=e.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");let de=(u=(a=e.config)===null||a===void 0?void 0:a.tools)!==null&&u!==void 0?u:[],le=[];for(let pe of de)if(this.isCallableTool(pe)){let we=pe;le.push(await we.tool())}else le.push(pe);le.length>0&&(e.config.tools=le);let Oe={model:Q,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?ie=sF(this.apiClient,Oe):ie=aF(this.apiClient,Oe),delete ie.config,q.send(JSON.stringify(ie)),new Iy(q,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}},Uk={turnComplete:!0},Iy=class{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=qn(t.turns),e.isVertexAI()||(i=i.map(r=>Ym(r)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(let o of i){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!e.isVertexAI()&&!("id"in o))throw new Error(Lk)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},Uk),e);let t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:cF(e)}:t={realtimeInput:dF(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");let t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}};function $k(n){let e={};return n.forEach((t,i)=>{e[i]=t}),e}function Hk(n){let e=new Headers;for(let[t,i]of Object.entries(n))e.append(t,i);return e}var YE=10;function JE(n){var e,t,i;if(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let r=!1;for(let a of(t=n?.tools)!==null&&t!==void 0?t:[])if(Na(a)){r=!0;break}if(!r)return!0;let o=(i=n?.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return o&&(o<0||!Number.isInteger(o))||o==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",o),!0):!1}function Na(n){return"callTool"in n&&typeof n.callTool=="function"}function Gk(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(r=>Na(r)))!==null&&i!==void 0?i:!1}function KE(n){var e;let t=[];return!((e=n?.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((i,r)=>{if(Na(i))return;let o=i;o.functionDeclarations&&o.functionDeclarations.length>0&&t.push(r)}),t}function QE(n){var e;return!(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}var My=class extends ui{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,r,o,a,u;let c=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!Gk(t)||JE(t.config))return await this.generateContentInternal(c);let m=KE(t);if(m.length>0){let R=m.map(N=>`tools[${N}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${R}.`)}let h,y,v=qn(c.contents),C=(o=(r=(i=c.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&o!==void 0?o:YE,T=0;for(;T<C&&(h=await this.generateContentInternal(c),!(!h.functionCalls||h.functionCalls.length===0));){let R=h.candidates[0].content,N=[];for(let F of(u=(a=t.config)===null||a===void 0?void 0:a.tools)!==null&&u!==void 0?u:[])if(Na(F)){let q=await F.callTool(h.functionCalls);N.push(...q)}T++,y={role:"user",parts:N},c.contents=qn(c.contents),c.contents.push(R),c.contents.push(y),QE(c.config)&&(v.push(R),v.push(y))}return QE(c.config)&&(h.automaticFunctionCallingHistory=v),h},this.generateContentStream=async t=>{var i,r,o,a,u;if(this.maybeMoveToResponseJsonSchem(t),JE(t.config)){let y=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(y)}let c=KE(t);if(c.length>0){let y=c.map(v=>`tools[${v}]`).join(", ");throw new Error(`Incompatible tools found at ${y}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}let m=(o=(r=(i=t?.config)===null||i===void 0?void 0:i.toolConfig)===null||r===void 0?void 0:r.functionCallingConfig)===null||o===void 0?void 0:o.streamFunctionCallArguments,h=(u=(a=t?.config)===null||a===void 0?void 0:a.automaticFunctionCalling)===null||u===void 0?void 0:u.disable;if(m&&!h)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var r;let o,a=[];if(i?.generatedImages)for(let c of i.generatedImages)c&&c?.safetyAttributes&&((r=c?.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?o=c?.safetyAttributes:a.push(c);let u;return o?u={generatedImages:a,positivePromptSafetyAttributes:o,sdkHttpResponse:i.sdkHttpResponse}:u={generatedImages:a,sdkHttpResponse:i.sdkHttpResponse},u}),this.list=async t=>{var i;let a={config:Object.assign(Object.assign({},{queryBase:!0}),t?.config)};if(this.apiClient.isVertexAI()&&!a.config.queryBase){if(!((i=a.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");a.config.filter="labels.tune-type:*"}return new Ki(Er.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(a),a)},this.editImage=async t=>{let i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(r=>r.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));let r={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(r)},this.generateVideos=async t=>{var i,r,o,a,u,c;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((i=t.video)===null||i===void 0)&&i.uri&&(!((r=t.video)===null||r===void 0)&&r.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((a=(o=t.source)===null||o===void 0?void 0:o.video)===null||a===void 0)&&a.uri&&(!((c=(u=t.source)===null||u===void 0?void 0:u.video)===null||c===void 0)&&c.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,r;let o=(t=e.config)===null||t===void 0?void 0:t.tools;if(!o)return e;let a=await Promise.all(o.map(async c=>Na(c)?await c.tool():c)),u={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:a})};if(u.config.tools=a,e.config&&e.config.tools&&R2(e.config.tools)){let c=(r=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&r!==void 0?r:{},m=Object.assign({},c);Object.keys(m).length===0&&(m=this.apiClient.getDefaultHeaders()),N2(m),u.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:m})}return u}async initAfcToolsMap(e){var t,i,r;let o=new Map;for(let a of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(Na(a)){let u=a,c=await u.tool();for(let m of(r=c.functionDeclarations)!==null&&r!==void 0?r:[]){if(!m.name)throw new Error("Function declaration name is required.");if(o.has(m.name))throw new Error(`Duplicate tool declaration name: ${m.name}`);o.set(m.name,u)}}return o}async processAfcStream(e){var t,i,r;let o=(r=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&r!==void 0?r:YE,a=!1,u=0,c=await this.initAfcToolsMap(e);return(function(m,h,y){return si(this,arguments,function*(){for(var v,C,T,R,N,F;u<o;){a&&(u++,a=!1);let ie=yield ve(m.processParamsMaybeAddMcpUsage(y)),de=yield ve(m.generateContentStreamInternal(ie)),le=[],Oe=[];try{for(var $=!0,q=(C=void 0,li(de)),Q;Q=yield ve(q.next()),v=Q.done,!v;$=!0){R=Q.value,$=!1;let pe=R;if(yield yield ve(pe),pe.candidates&&(!((N=pe.candidates[0])===null||N===void 0)&&N.content)){Oe.push(pe.candidates[0].content);for(let we of(F=pe.candidates[0].content.parts)!==null&&F!==void 0?F:[])if(u<o&&we.functionCall){if(!we.functionCall.name)throw new Error("Function call name was not returned by the model.");if(h.has(we.functionCall.name)){let Ct=yield ve(h.get(we.functionCall.name).callTool([we.functionCall]));le.push(...Ct)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${h.keys()}, mising tool: ${we.functionCall.name}`)}}}}catch(pe){C={error:pe}}finally{try{!$&&!v&&(T=q.return)&&(yield ve(T.call(q)))}finally{if(C)throw C.error}}if(le.length>0){a=!0;let pe=new ho;pe.candidates=[{content:{role:"user",parts:le}}],yield yield ve(pe);let we=[];we.push(...Oe),we.push({role:"user",parts:le});let Ct=qn(y.contents).concat(we);y.contents=Ct}else break}})})(this,c,e)}async generateContentInternal(e){var t,i,r,o;let a,u="",c={};if(this.apiClient.isVertexAI()){let m=qE(this.apiClient,e);return u=ee("{model}:generateContent",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>{let y=jE(h),v=new ho;return Object.assign(v,y),v})}else{let m=GE(this.apiClient,e);return u=ee("{model}:generateContent",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>{let y=WE(h),v=new ho;return Object.assign(v,y),v})}}async generateContentStreamInternal(e){var t,i,r,o;let a,u="",c={};if(this.apiClient.isVertexAI()){let m=qE(this.apiClient,e);return u=ee("{model}:streamGenerateContent?alt=sse",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.requestStream({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),a.then(function(y){return si(this,arguments,function*(){var v,C,T,R;try{for(var N=!0,F=li(y),$;$=yield ve(F.next()),v=$.done,!v;N=!0){R=$.value,N=!1;let q=R,Q=jE(yield ve(q.json()));Q.sdkHttpResponse={headers:q.headers};let ie=new ho;Object.assign(ie,Q),yield yield ve(ie)}}catch(q){C={error:q}}finally{try{!N&&!v&&(T=F.return)&&(yield ve(T.call(F)))}finally{if(C)throw C.error}}})})}else{let m=GE(this.apiClient,e);return u=ee("{model}:streamGenerateContent?alt=sse",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.requestStream({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),a.then(function(y){return si(this,arguments,function*(){var v,C,T,R;try{for(var N=!0,F=li(y),$;$=yield ve(F.next()),v=$.done,!v;N=!0){R=$.value,N=!1;let q=R,Q=WE(yield ve(q.json()));Q.sdkHttpResponse={headers:q.headers};let ie=new ho;Object.assign(ie,Q),yield yield ve(ie)}}catch(q){C={error:q}}finally{try{!N&&!v&&(T=F.return)&&(yield ve(T.call(F)))}finally{if(C)throw C.error}}})})}}async embedContent(e){var t,i,r,o;let a,u="",c={};if(this.apiClient.isVertexAI()){let m=GF(this.apiClient,e);return u=ee("{model}:predict",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>{let y=WF(h),v=new xm;return Object.assign(v,y),v})}else{let m=HF(this.apiClient,e);return u=ee("{model}:batchEmbedContents",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>{let y=qF(h),v=new xm;return Object.assign(v,y),v})}}async generateImagesInternal(e){var t,i,r,o;let a,u="",c={};if(this.apiClient.isVertexAI()){let m=nP(this.apiClient,e);return u=ee("{model}:predict",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>{let y=rP(h),v=new bm;return Object.assign(v,y),v})}else{let m=tP(this.apiClient,e);return u=ee("{model}:predict",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>{let y=iP(h),v=new bm;return Object.assign(v,y),v})}}async editImageInternal(e){var t,i;let r,o="",a={};if(this.apiClient.isVertexAI()){let u=LF(this.apiClient,e);return o=ee("{model}:predict",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(m=>{let h=m;return h.sdkHttpResponse={headers:c.headers},h})),r.then(c=>{let m=BF(c),h=new Zh;return Object.assign(h,m),h})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let r,o="",a={};if(this.apiClient.isVertexAI()){let u=nk(this.apiClient,e);return o=ee("{model}:predict",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(m=>{let h=m;return h.sdkHttpResponse={headers:c.headers},h})),r.then(c=>{let m=ik(c),h=new Xh;return Object.assign(h,m),h})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let r,o="",a={};if(this.apiClient.isVertexAI()){let u=OP(this.apiClient,e);return o=ee("{model}:predict",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{let m=LP(c),h=new ey;return Object.assign(h,m),h})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let r,o="",a={};if(this.apiClient.isVertexAI()){let u=qP(this.apiClient,e);return o=ee("{model}:predict",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{let m=WP(c),h=new ty;return Object.assign(h,m),h})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,r,o;let a,u="",c={};if(this.apiClient.isVertexAI()){let m=xP(this.apiClient,e);return u=ee("{name}",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),a.then(h=>xy(h))}else{let m=CP(this.apiClient,e);return u=ee("{name}",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),a.then(h=>Cy(h))}}async listInternal(e){var t,i,r,o;let a,u="",c={};if(this.apiClient.isVertexAI()){let m=AP(this.apiClient,e);return u=ee("{models_url}",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>{let y=NP(h),v=new Em;return Object.assign(v,y),v})}else{let m=MP(this.apiClient,e);return u=ee("{models_url}",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>{let y=RP(h),v=new Em;return Object.assign(v,y),v})}}async update(e){var t,i,r,o;let a,u="",c={};if(this.apiClient.isVertexAI()){let m=ek(this.apiClient,e);return u=ee("{model}",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),a.then(h=>xy(h))}else{let m=XP(this.apiClient,e);return u=ee("{name}",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),a.then(h=>Cy(h))}}async delete(e){var t,i,r,o;let a,u="",c={};if(this.apiClient.isVertexAI()){let m=PF(this.apiClient,e);return u=ee("{name}",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>{let y=VF(h),v=new Sm;return Object.assign(v,y),v})}else{let m=FF(this.apiClient,e);return u=ee("{name}",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>{let y=kF(h),v=new Sm;return Object.assign(v,y),v})}}async countTokens(e){var t,i,r,o;let a,u="",c={};if(this.apiClient.isVertexAI()){let m=AF(this.apiClient,e);return u=ee("{model}:countTokens",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>{let y=NF(h),v=new Dm;return Object.assign(v,y),v})}else{let m=MF(this.apiClient,e);return u=ee("{model}:countTokens",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>{let y=RF(h),v=new Dm;return Object.assign(v,y),v})}}async computeTokens(e){var t,i;let r,o="",a={};if(this.apiClient.isVertexAI()){let u=bF(this.apiClient,e);return o=ee("{model}:computeTokens",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(m=>{let h=m;return h.sdkHttpResponse={headers:c.headers},h})),r.then(c=>{let m=EF(c),h=new ny;return Object.assign(h,m),h})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,r,o;let a,u="",c={};if(this.apiClient.isVertexAI()){let m=dP(this.apiClient,e);return u=ee("{model}:predictLongRunning",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),a.then(h=>{let y=lP(h),v=new wm;return Object.assign(v,y),v})}else{let m=uP(this.apiClient,e);return u=ee("{model}:predictLongRunning",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),a.then(h=>{let y=sP(h),v=new wm;return Object.assign(v,y),v})}}};var Ay=class extends ui{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){let t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){let r=t.name.split("/operations/")[0],o;i&&"httpOptions"in i&&(o=i.httpOptions);let a=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:a,_isVertexAI:!0})}else{let r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async get(e){let t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){let r=t.name.split("/operations/")[0],o;i&&"httpOptions"in i&&(o=i.httpOptions);let a=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:a,_isVertexAI:!0})}else{let r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,r,o;let a,u="",c={};if(this.apiClient.isVertexAI()){let m=r4(e);return u=ee("{operationName}",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),a}else{let m=i4(e);return u=ee("{operationName}",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),a}}async fetchPredictVideosOperationInternal(e){var t,i;let r,o="",a={};if(this.apiClient.isVertexAI()){let u=KR(e);return o=ee("{resourceName}:fetchPredictOperation",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r}else throw new Error("This method is only supported by the Vertex AI.")}};function qk(n){let e={},t=p(n,["data"]);if(t!=null&&g(e,["data"],t),p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function Wk(n){let e={},t=p(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>e8(o))),g(e,["parts"],r)}let i=p(n,["role"]);return i!=null&&g(e,["role"],i),e}function jk(n,e,t){let i={},r=p(e,["expireTime"]);t!==void 0&&r!=null&&g(t,["expireTime"],r);let o=p(e,["newSessionExpireTime"]);t!==void 0&&o!=null&&g(t,["newSessionExpireTime"],o);let a=p(e,["uses"]);t!==void 0&&a!=null&&g(t,["uses"],a);let u=p(e,["liveConnectConstraints"]);t!==void 0&&u!=null&&g(t,["bidiGenerateContentSetup"],Xk(n,u));let c=p(e,["lockAdditionalFields"]);return t!==void 0&&c!=null&&g(t,["fieldMask"],c),i}function zk(n,e){let t={},i=p(e,["config"]);return i!=null&&g(t,["config"],jk(n,i,t)),t}function Yk(n){let e={};if(p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let t=p(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);let i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function Jk(n){let e={},t=p(n,["id"]);t!=null&&g(e,["id"],t);let i=p(n,["args"]);i!=null&&g(e,["args"],i);let r=p(n,["name"]);if(r!=null&&g(e,["name"],r),p(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Kk(n){let e={};if(p(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");let t=p(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function Qk(n){let e={};if(p(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");let t=p(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function Zk(n,e){let t={},i=p(n,["generationConfig"]);e!==void 0&&i!=null&&g(e,["setup","generationConfig"],i);let r=p(n,["responseModalities"]);e!==void 0&&r!=null&&g(e,["setup","generationConfig","responseModalities"],r);let o=p(n,["temperature"]);e!==void 0&&o!=null&&g(e,["setup","generationConfig","temperature"],o);let a=p(n,["topP"]);e!==void 0&&a!=null&&g(e,["setup","generationConfig","topP"],a);let u=p(n,["topK"]);e!==void 0&&u!=null&&g(e,["setup","generationConfig","topK"],u);let c=p(n,["maxOutputTokens"]);e!==void 0&&c!=null&&g(e,["setup","generationConfig","maxOutputTokens"],c);let m=p(n,["mediaResolution"]);e!==void 0&&m!=null&&g(e,["setup","generationConfig","mediaResolution"],m);let h=p(n,["seed"]);e!==void 0&&h!=null&&g(e,["setup","generationConfig","seed"],h);let y=p(n,["speechConfig"]);e!==void 0&&y!=null&&g(e,["setup","generationConfig","speechConfig"],Zy(y));let v=p(n,["thinkingConfig"]);e!==void 0&&v!=null&&g(e,["setup","generationConfig","thinkingConfig"],v);let C=p(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],C);let T=p(n,["systemInstruction"]);e!==void 0&&T!=null&&g(e,["setup","systemInstruction"],Wk(Xt(T)));let R=p(n,["tools"]);if(e!==void 0&&R!=null){let de=Va(R);Array.isArray(de)&&(de=de.map(le=>n8(ka(le)))),g(e,["setup","tools"],de)}let N=p(n,["sessionResumption"]);e!==void 0&&N!=null&&g(e,["setup","sessionResumption"],t8(N));let F=p(n,["inputAudioTranscription"]);e!==void 0&&F!=null&&g(e,["setup","inputAudioTranscription"],F);let $=p(n,["outputAudioTranscription"]);e!==void 0&&$!=null&&g(e,["setup","outputAudioTranscription"],$);let q=p(n,["realtimeInputConfig"]);e!==void 0&&q!=null&&g(e,["setup","realtimeInputConfig"],q);let Q=p(n,["contextWindowCompression"]);e!==void 0&&Q!=null&&g(e,["setup","contextWindowCompression"],Q);let ie=p(n,["proactivity"]);if(e!==void 0&&ie!=null&&g(e,["setup","proactivity"],ie),p(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function Xk(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["setup","model"],$e(n,i));let r=p(e,["config"]);return r!=null&&g(t,["config"],Zk(r,t)),t}function e8(n){let e={},t=p(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);let i=p(n,["codeExecutionResult"]);i!=null&&g(e,["codeExecutionResult"],i);let r=p(n,["executableCode"]);r!=null&&g(e,["executableCode"],r);let o=p(n,["fileData"]);o!=null&&g(e,["fileData"],Yk(o));let a=p(n,["functionCall"]);a!=null&&g(e,["functionCall"],Jk(a));let u=p(n,["functionResponse"]);u!=null&&g(e,["functionResponse"],u);let c=p(n,["inlineData"]);c!=null&&g(e,["inlineData"],qk(c));let m=p(n,["text"]);m!=null&&g(e,["text"],m);let h=p(n,["thought"]);h!=null&&g(e,["thought"],h);let y=p(n,["thoughtSignature"]);y!=null&&g(e,["thoughtSignature"],y);let v=p(n,["videoMetadata"]);return v!=null&&g(e,["videoMetadata"],v),e}function t8(n){let e={},t=p(n,["handle"]);if(t!=null&&g(e,["handle"],t),p(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function n8(n){let e={};if(p(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");let t=p(n,["computerUse"]);t!=null&&g(e,["computerUse"],t);let i=p(n,["fileSearch"]);i!=null&&g(e,["fileSearch"],i);let r=p(n,["codeExecution"]);if(r!=null&&g(e,["codeExecution"],r),p(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");let o=p(n,["functionDeclarations"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(y=>y)),g(e,["functionDeclarations"],h)}let a=p(n,["googleMaps"]);a!=null&&g(e,["googleMaps"],Kk(a));let u=p(n,["googleSearch"]);u!=null&&g(e,["googleSearch"],Qk(u));let c=p(n,["googleSearchRetrieval"]);c!=null&&g(e,["googleSearchRetrieval"],c);let m=p(n,["urlContext"]);return m!=null&&g(e,["urlContext"],m),e}function i8(n){let e=[];for(let t in n)if(Object.prototype.hasOwnProperty.call(n,t)){let i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){let r=Object.keys(i).map(o=>`${t}.${o}`);e.push(...r)}else e.push(t)}return e.join(",")}function r8(n,e){let t=null,i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){let o=i.setup;typeof o=="object"&&o!==null?(n.bidiGenerateContentSetup=o,t=o):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;let r=n.fieldMask;if(t){let o=i8(t);if(Array.isArray(e?.lockAdditionalFields)&&e?.lockAdditionalFields.length===0)o?n.fieldMask=o:delete n.fieldMask;else if(e?.lockAdditionalFields&&e.lockAdditionalFields.length>0&&r!==null&&Array.isArray(r)&&r.length>0){let a=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"],u=[];r.length>0&&(u=r.map(m=>a.includes(m)?`generationConfig.${m}`:m));let c=[];o&&c.push(o),u.length>0&&c.push(...u),c.length>0?n.fieldMask=c.join(","):delete n.fieldMask}else delete n.fieldMask}else r!==null&&Array.isArray(r)&&r.length>0?n.fieldMask=r.join(","):delete n.fieldMask;return n}var Ry=class extends ui{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{let u=zk(this.apiClient,e);o=ee("auth_tokens",u._url),a=u._query,delete u.config,delete u._url,delete u._query;let c=r8(u,e.config);return r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),r.then(m=>m)}}};function o8(n,e){let t={},i=p(n,["force"]);return e!==void 0&&i!=null&&g(e,["_query","force"],i),t}function a8(n){let e={},t=p(n,["name"]);t!=null&&g(e,["_url","name"],t);let i=p(n,["config"]);return i!=null&&o8(i,e),e}function s8(n){let e={},t=p(n,["name"]);return t!=null&&g(e,["_url","name"],t),e}function l8(n,e){let t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);let r=p(n,["pageToken"]);return e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),t}function u8(n){let e={},t=p(n,["parent"]);t!=null&&g(e,["_url","parent"],t);let i=p(n,["config"]);return i!=null&&l8(i,e),e}function d8(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);let r=p(n,["documents"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>a)),g(e,["documents"],o)}return e}var Ny=class extends ui{constructor(e){super(),this.apiClient=e,this.list=async t=>new Ki(Er.PAGED_ITEM_DOCUMENTS,i=>this.listInternal({parent:t.parent,config:i.config}),await this.listInternal(t),t)}async get(e){var t,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=s8(e);return o=ee("{name}",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>c)}}async delete(e){var t,i;let r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=a8(e);r=ee("{name}",a._url),o=a._query,delete a._url,delete a._query,await this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=u8(e);return o=ee("{parent}/documents",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{let m=d8(c),h=new iy;return Object.assign(h,m),h})}}};var Fy=class extends ui{constructor(e,t=new Ny(e)){super(),this.apiClient=e,this.documents=t,this.list=async(i={})=>new Ki(Er.PAGED_ITEM_FILE_SEARCH_STORES,r=>this.listInternal(r),await this.listInternal(i),i)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=dk(e);return o=ee("fileSearchStores",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>c)}}async get(e){var t,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=pk(e);return o=ee("{name}",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>c)}}async delete(e){var t,i;let r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let a=mk(e);r=ee("{name}",a._url),o=a._query,delete a._url,delete a._query,await this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=vk(e);return o=ee("fileSearchStores",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{let m=Ck(c),h=new ry;return Object.assign(h,m),h})}}async uploadToFileSearchStoreInternal(e){var t,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=xk(e);return o=ee("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{let m=bk(c),h=new oy;return Object.assign(h,m),h})}}async importFile(e){var t,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=hk(e);return o=ee("{file_search_store_name}:importFile",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json()),r.then(c=>{let m=gk(c),h=new ay;return Object.assign(h,m),h})}}};var F2=function(){let{crypto:n}=globalThis;if(n?.randomUUID)return F2=n.randomUUID.bind(n),n.randomUUID();let e=new Uint8Array(1),t=n?()=>n.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,i=>(+i^t()&15>>+i/4).toString(16))},c8=()=>F2();function Py(n){return typeof n=="object"&&n!==null&&("name"in n&&n.name==="AbortError"||"message"in n&&String(n.message).includes("FetchRequestCanceledException"))}var ky=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null){try{if(Object.prototype.toString.call(n)==="[object Error]"){let e=new Error(n.message,n.cause?{cause:n.cause}:{});return n.stack&&(e.stack=n.stack),n.cause&&!e.cause&&(e.cause=n.cause),n.name&&(e.name=n.name),e}}catch{}try{return new Error(JSON.stringify(n))}catch{}}return new Error(n)};var vn=class extends Error{},Cn=class n extends vn{constructor(e,t,i,r){super(`${n.makeMessage(e,t,i)}`),this.status=e,this.headers=r,this.error=t}static makeMessage(e,t,i){let r=t?.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):i;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,i,r){if(!e||!r)return new Fa({message:i,cause:ky(t)});let o=t;return e===400?new km(e,o,i,r):e===401?new Vm(e,o,i,r):e===403?new Om(e,o,i,r):e===404?new Lm(e,o,i,r):e===409?new Bm(e,o,i,r):e===422?new Um(e,o,i,r):e===429?new $m(e,o,i,r):e>=500?new Hm(e,o,i,r):new n(e,o,i,r)}},Zl=class extends Cn{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}},Fa=class extends Cn{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}},Pm=class extends Fa{constructor({message:e}={}){super({message:e??"Request timed out."})}},km=class extends Cn{},Vm=class extends Cn{},Om=class extends Cn{},Lm=class extends Cn{},Bm=class extends Cn{},Um=class extends Cn{},$m=class extends Cn{},Hm=class extends Cn{};var m8=/^[a-z][a-z0-9+.-]*:/i,p8=n=>m8.test(n),Vy=n=>(Vy=Array.isArray,Vy(n)),f8=Vy,g8=f8,ZE=g8;function h8(n){if(!n)return!0;for(let e in n)return!1;return!0}function y8(n,e){return Object.prototype.hasOwnProperty.call(n,e)}var _8=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new vn(`${n} must be an integer`);if(e<0)throw new vn(`${n} must be a positive integer`);return e},v8=n=>{try{return JSON.parse(n)}catch{return}};var C8=n=>new Promise(e=>setTimeout(e,n));var Aa="0.0.1";function x8(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}var b8=()=>{var n,e,t,i,r;let o=x8();if(o==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Aa,"X-Stainless-OS":e2(Deno.build.os),"X-Stainless-Arch":XE(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(n=Deno.version)===null||n===void 0?void 0:n.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Aa,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(o==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Aa,"X-Stainless-OS":e2((t=globalThis.process.platform)!==null&&t!==void 0?t:"unknown"),"X-Stainless-Arch":XE((i=globalThis.process.arch)!==null&&i!==void 0?i:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(r=globalThis.process.version)!==null&&r!==void 0?r:"unknown"};let a=E8();return a?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Aa,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${a.browser}`,"X-Stainless-Runtime-Version":a.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Aa,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function E8(){if(typeof navigator>"u"||!navigator)return null;let n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(let{key:e,pattern:t}of n){let i=t.exec(navigator.userAgent);if(i){let r=i[1]||0,o=i[2]||0,a=i[3]||0;return{browser:e,version:`${r}.${o}.${a}`}}}return null}var XE=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",e2=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown"),fm,S8=()=>fm??(fm=b8());function D8(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function P2(...n){let e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...n)}function w8(n){let e=Symbol.asyncIterator in n?n[Symbol.asyncIterator]():n[Symbol.iterator]();return P2({start(){},async pull(t){let{done:i,value:r}=await e.next();i?t.close():t.enqueue(r)},async cancel(){var t;await((t=e.return)===null||t===void 0?void 0:t.call(e))}})}function k2(n){if(n[Symbol.asyncIterator])return n;let e=n.getReader();return{async next(){try{let t=await e.read();return t?.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){let t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function T8(n){var e,t;if(n===null||typeof n!="object")return;if(n[Symbol.asyncIterator]){await((t=(e=n[Symbol.asyncIterator]()).return)===null||t===void 0?void 0:t.call(e));return}let i=n.getReader(),r=i.cancel();i.releaseLock(),await r}var I8=({headers:n,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});var V2=()=>{var n;if(typeof File>"u"){let{process:e}=globalThis,t=typeof((n=e?.versions)===null||n===void 0?void 0:n.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Yh(n,e,t){return V2(),new File(n,e??"unknown_file",t)}function M8(n){return(typeof n=="object"&&n!==null&&("name"in n&&n.name&&String(n.name)||"url"in n&&n.url&&String(n.url)||"filename"in n&&n.filename&&String(n.filename)||"path"in n&&n.path&&String(n.path))||"").split(/[\\/]/).pop()||void 0}var A8=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function";var O2=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",R8=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&O2(n),N8=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function";async function F8(n,e,t){if(V2(),n=await n,R8(n))return n instanceof File?n:Yh([await n.arrayBuffer()],n.name);if(N8(n)){let r=await n.blob();return e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()),Yh(await Oy(r),e,t)}let i=await Oy(n);if(e||(e=M8(n)),!t?.type){let r=i.find(o=>typeof o=="object"&&"type"in o&&o.type);typeof r=="string"&&(t=Object.assign(Object.assign({},t),{type:r}))}return Yh(i,e,t)}async function Oy(n){var e,t,i,r,o;let a=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)a.push(n);else if(O2(n))a.push(n instanceof Blob?n:await n.arrayBuffer());else if(A8(n))try{for(var u=!0,c=li(n),m;m=await c.next(),e=m.done,!e;u=!0){r=m.value,u=!1;let h=r;a.push(...await Oy(h))}}catch(h){t={error:h}}finally{try{!u&&!e&&(i=c.return)&&await i.call(c)}finally{if(t)throw t.error}}else{let h=(o=n?.constructor)===null||o===void 0?void 0:o.name;throw new Error(`Unexpected data type: ${typeof n}${h?`; constructor: ${h}`:""}${P8(n)}`)}return a}function P8(n){return typeof n!="object"||n===null?"":`; props: [${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}var k8=(()=>{class n{constructor(t){this._client=t}}n._key=[];return n})();function L2(n){return n.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}var t2=Object.freeze(Object.create(null)),V8=(n=L2)=>function(t,...i){if(t.length===1)return t[0];let r=!1,o=[],a=t.reduce((h,y,v)=>{var C,T,R;/[?#]/.test(y)&&(r=!0);let N=i[v],F=(r?encodeURIComponent:n)(""+N);return v!==i.length&&(N==null||typeof N=="object"&&N.toString===((R=Object.getPrototypeOf((T=Object.getPrototypeOf((C=N.hasOwnProperty)!==null&&C!==void 0?C:t2))!==null&&T!==void 0?T:t2))===null||R===void 0?void 0:R.toString))&&(F=N+"",o.push({start:h.length+y.length,length:F.length,error:`Value of type ${Object.prototype.toString.call(N).slice(8,-1)} is not a valid path parameter`})),h+y+(v===i.length?"":F)},""),u=a.split(/[?#]/,1)[0],c=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi"),m;for(;(m=c.exec(u))!==null;)o.push({start:m.index,length:m[0].length,error:`Value "${m[0]}" can't be safely passed as a path parameter`});if(o.sort((h,y)=>h.start-y.start),o.length>0){let h=0,y=o.reduce((v,C)=>{let T=" ".repeat(C.start-h),R="^".repeat(C.length);return h=C.start+C.length,v+T+R},"");throw new vn(`Path parameters result in path with invalid segments:
${o.map(v=>v.error).join(`
`)}
${a}
${y}`)}return a},gm=V8(L2);var Gm=class extends k8{create(e,t){var i;let{api_version:r=this._client.apiVersion}=e,o=Fm(e,["api_version"]);if("model"in o&&"agent_config"in o)throw new vn("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in o&&"generation_config"in o)throw new vn("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(gm`/${r}/interactions`,Object.assign(Object.assign({body:o},t),{stream:(i=e.stream)!==null&&i!==void 0?i:!1}))}delete(e,t={},i){let{api_version:r=this._client.apiVersion}=t??{};return this._client.delete(gm`/${r}/interactions/${e}`,i)}cancel(e,t={},i){let{api_version:r=this._client.apiVersion}=t??{};return this._client.post(gm`/${r}/interactions/${e}/cancel`,i)}get(e,t={},i){var r;let o=t??{},{api_version:a=this._client.apiVersion}=o,u=Fm(o,["api_version"]);return this._client.get(gm`/${a}/interactions/${e}`,Object.assign(Object.assign({query:u},i),{stream:(r=t?.stream)!==null&&r!==void 0?r:!1}))}};Gm._key=Object.freeze(["interactions"]);var qm=class extends Gm{};function O8(n){let e=0;for(let r of n)e+=r.length;let t=new Uint8Array(e),i=0;for(let r of n)t.set(r,i),i+=r.length;return t}var hm;function Xy(n){let e;return(hm??(e=new globalThis.TextEncoder,hm=e.encode.bind(e)))(n)}var ym;function n2(n){let e;return(ym??(e=new globalThis.TextDecoder,ym=e.decode.bind(e)))(n)}var Pa=class{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];let t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?Xy(e):e;this.buffer=O8([this.buffer,t]);let i=[],r;for(;(r=L8(this.buffer,this.carriageReturnIndex))!=null;){if(r.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=r.index;continue}if(this.carriageReturnIndex!=null&&(r.index!==this.carriageReturnIndex+1||r.carriage)){i.push(n2(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}let o=this.carriageReturnIndex!==null?r.preceding-1:r.preceding,a=n2(this.buffer.subarray(0,o));i.push(a),this.buffer=this.buffer.subarray(r.index),this.carriageReturnIndex=null}return i}flush(){return this.buffer.length?this.decode(`
`):[]}};Pa.NEWLINE_CHARS=new Set([`
`,"\r"]);Pa.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function L8(n,e){for(let r=e??0;r<n.length;r++){if(n[r]===10)return{preceding:r,index:r+1,carriage:!1};if(n[r]===13)return{preceding:r,index:r+1,carriage:!0}}return null}function B8(n){for(let i=0;i<n.length-1;i++){if(n[i]===10&&n[i+1]===10||n[i]===13&&n[i+1]===13)return i+2;if(n[i]===13&&n[i+1]===10&&i+3<n.length&&n[i+2]===13&&n[i+3]===10)return i+4}return-1}var Wm={off:0,error:200,warn:300,info:400,debug:500},i2=(n,e,t)=>{if(n){if(y8(Wm,n))return n;cn(t).warn(`${e} was set to ${JSON.stringify(n)}, expected one of ${JSON.stringify(Object.keys(Wm))}`)}};function Jl(){}function _m(n,e,t){return!e||Wm[n]>Wm[t]?Jl:e[n].bind(e)}var U8={error:Jl,warn:Jl,info:Jl,debug:Jl},r2=new WeakMap;function cn(n){var e;let t=n.logger,i=(e=n.logLevel)!==null&&e!==void 0?e:"off";if(!t)return U8;let r=r2.get(t);if(r&&r[0]===i)return r[1];let o={error:_m("error",t,i),warn:_m("warn",t,i),info:_m("info",t,i),debug:_m("debug",t,i)};return r2.set(t,[i,o]),o}var go=n=>(n.options&&(n.options=Object.assign({},n.options),delete n.options.headers),n.headers&&(n.headers=Object.fromEntries((n.headers instanceof Headers?[...n.headers]:Object.entries(n.headers)).map(([e,t])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in n&&(n.retryOfRequestLogID&&(n.retryOf=n.retryOfRequestLogID),delete n.retryOfRequestLogID),n);var Ly=class n{constructor(e,t,i){this.iterator=e,this.controller=t,this.client=i}static fromSSEResponse(e,t,i){let r=!1,o=i?cn(i):console;function a(){return si(this,arguments,function*(){var c,m,h,y;if(r)throw new vn("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let v=!1;try{try{for(var C=!0,T=li($8(e,t)),R;R=yield ve(T.next()),c=R.done,!c;C=!0){y=R.value,C=!1;let N=y;if(!v)if(N.data.startsWith("[DONE]")){v=!0;continue}else try{yield yield ve(JSON.parse(N.data))}catch(F){throw o.error("Could not parse message into JSON:",N.data),o.error("From chunk:",N.raw),F}}}catch(N){m={error:N}}finally{try{!C&&!c&&(h=T.return)&&(yield ve(h.call(T)))}finally{if(m)throw m.error}}v=!0}catch(N){if(Py(N))return yield ve(void 0);throw N}finally{v||t.abort()}})}return new n(a,t,i)}static fromReadableStream(e,t,i){let r=!1;function o(){return si(this,arguments,function*(){var c,m,h,y;let v=new Pa,C=k2(e);try{for(var T=!0,R=li(C),N;N=yield ve(R.next()),c=N.done,!c;T=!0){y=N.value,T=!1;let F=y;for(let $ of v.decode(F))yield yield ve($)}}catch(F){m={error:F}}finally{try{!T&&!c&&(h=R.return)&&(yield ve(h.call(R)))}finally{if(m)throw m.error}}for(let F of v.flush())yield yield ve(F)})}function a(){return si(this,arguments,function*(){var c,m,h,y;if(r)throw new vn("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let v=!1;try{try{for(var C=!0,T=li(o()),R;R=yield ve(T.next()),c=R.done,!c;C=!0){y=R.value,C=!1;let N=y;v||N&&(yield yield ve(JSON.parse(N)))}}catch(N){m={error:N}}finally{try{!C&&!c&&(h=T.return)&&(yield ve(h.call(T)))}finally{if(m)throw m.error}}v=!0}catch(N){if(Py(N))return yield ve(void 0);throw N}finally{v||t.abort()}})}return new n(a,t,i)}[Symbol.asyncIterator](){return this.iterator()}tee(){let e=[],t=[],i=this.iterator(),r=o=>({next:()=>{if(o.length===0){let a=i.next();e.push(a),t.push(a)}return o.shift()}});return[new n(()=>r(e),this.controller,this.client),new n(()=>r(t),this.controller,this.client)]}toReadableStream(){let e=this,t;return P2({async start(){t=e[Symbol.asyncIterator]()},async pull(i){try{let{value:r,done:o}=await t.next();if(o)return i.close();let a=Xy(JSON.stringify(r)+`
`);i.enqueue(a)}catch(r){i.error(r)}},async cancel(){var i;await((i=t.return)===null||i===void 0?void 0:i.call(t))}})}};function $8(n,e){return si(this,arguments,function*(){var i,r,o,a;if(!n.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new vn("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new vn("Attempted to iterate over a response with no body");let u=new By,c=new Pa,m=k2(n.body);try{for(var h=!0,y=li(H8(m)),v;v=yield ve(y.next()),i=v.done,!i;h=!0){a=v.value,h=!1;let C=a;for(let T of c.decode(C)){let R=u.decode(T);R&&(yield yield ve(R))}}}catch(C){r={error:C}}finally{try{!h&&!i&&(o=y.return)&&(yield ve(o.call(y)))}finally{if(r)throw r.error}}for(let C of c.flush()){let T=u.decode(C);T&&(yield yield ve(T))}})}function H8(n){return si(this,arguments,function*(){var t,i,r,o;let a=new Uint8Array;try{for(var u=!0,c=li(n),m;m=yield ve(c.next()),t=m.done,!t;u=!0){o=m.value,u=!1;let h=o;if(h==null)continue;let y=h instanceof ArrayBuffer?new Uint8Array(h):typeof h=="string"?Xy(h):h,v=new Uint8Array(a.length+y.length);v.set(a),v.set(y,a.length),a=v;let C;for(;(C=B8(a))!==-1;)yield yield ve(a.slice(0,C)),a=a.slice(C)}}catch(h){i={error:h}}finally{try{!u&&!t&&(r=c.return)&&(yield ve(r.call(c)))}finally{if(i)throw i.error}}a.length>0&&(yield yield ve(a))})}var By=class{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,i,r]=G8(e,":");return r.startsWith(" ")&&(r=r.substring(1)),t==="event"?this.event=r:t==="data"&&this.data.push(r),null}};function G8(n,e){let t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}async function q8(n,e){let{response:t,requestLogID:i,retryOfRequestLogID:r,startTime:o}=e,a=await(async()=>{var u;if(e.options.stream)return cn(n).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,n):Ly.fromSSEResponse(t,e.controller,n);if(t.status===204)return null;if(e.options.__binaryResponse)return t;let c=t.headers.get("content-type"),m=(u=c?.split(";")[0])===null||u===void 0?void 0:u.trim();return m?.includes("application/json")||m?.endsWith("+json")?await t.json():await t.text()})();return cn(n).debug(`[${i}] response parsed`,go({retryOfRequestLogID:r,url:t.url,status:t.status,body:a,durationMs:Date.now()-o})),a}var Uy=class n extends Promise{constructor(e,t,i=q8){super(r=>{r(null)}),this.responsePromise=t,this.parseResponse=i,this.client=e}_thenUnwrap(e){return new n(this.client,this.responsePromise,async(t,i)=>e(await this.parseResponse(t,i),i))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){let[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}};var B2=Symbol("brand.privateNullableHeaders");function*W8(n){if(!n)return;if(B2 in n){let{values:i,nulls:r}=n;yield*i.entries();for(let o of r)yield[o,null];return}let e=!1,t;n instanceof Headers?t=n.entries():ZE(n)?t=n:(e=!0,t=Object.entries(n??{}));for(let i of t){let r=i[0];if(typeof r!="string")throw new TypeError("expected header name to be a string");let o=ZE(i[1])?i[1]:[i[1]],a=!1;for(let u of o)u!==void 0&&(e&&!a&&(a=!0,yield[r,null]),yield[r,u])}}var zl=n=>{let e=new Headers,t=new Set;for(let i of n){let r=new Set;for(let[o,a]of W8(i)){let u=o.toLowerCase();r.has(u)||(e.delete(o),r.add(u)),a===null?(e.delete(o),t.add(u)):(e.append(o,a),t.delete(u))}}return{[B2]:!0,values:e,nulls:t}};var Jh=n=>{var e,t,i,r,o,a;if(typeof globalThis.process<"u")return(i=(t=(e=globalThis.process.env)===null||e===void 0?void 0:e[n])===null||t===void 0?void 0:t.trim())!==null&&i!==void 0?i:void 0;if(typeof globalThis.Deno<"u")return(a=(o=(r=globalThis.Deno.env)===null||r===void 0?void 0:r.get)===null||o===void 0?void 0:o.call(r,n))===null||a===void 0?void 0:a.trim()};var U2,j8=(()=>{class n{constructor(t){var i,r,o,a,u,c,m,{baseURL:h=Jh("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:y=(i=Jh("GEMINI_API_KEY"))!==null&&i!==void 0?i:null,apiVersion:v="v1beta"}=t,C=Fm(t,["baseURL","apiKey","apiVersion"]);let T=Object.assign(Object.assign({apiKey:y,apiVersion:v},C),{baseURL:h||"https://generativelanguage.googleapis.com"});this.baseURL=T.baseURL,this.timeout=(r=T.timeout)!==null&&r!==void 0?r:n.DEFAULT_TIMEOUT,this.logger=(o=T.logger)!==null&&o!==void 0?o:console;let R="warn";this.logLevel=R,this.logLevel=(u=(a=i2(T.logLevel,"ClientOptions.logLevel",this))!==null&&a!==void 0?a:i2(Jh("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&u!==void 0?u:R,this.fetchOptions=T.fetchOptions,this.maxRetries=(c=T.maxRetries)!==null&&c!==void 0?c:2,this.fetch=(m=T.fetch)!==null&&m!==void 0?m:D8(),this.encoder=I8,this._options=T,this.apiKey=y,this.apiVersion=v,this.clientAdapter=T.clientAdapter}withOptions(t){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),t))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:t,nulls:i}){if(!(t.has("authorization")||t.has("x-goog-api-key"))&&!(this.apiKey&&t.get("x-goog-api-key"))&&!i.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(t){let i=zl([t.headers]);if(!(i.values.has("authorization")||i.values.has("x-goog-api-key"))){if(this.apiKey)return zl([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return zl([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(t){return Object.entries(t).filter(([i,r])=>typeof r<"u").map(([i,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(i)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(i)}=`;throw new vn(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Aa}`}defaultIdempotencyKey(){return`stainless-node-retry-${c8()}`}makeStatusError(t,i,r,o){return Cn.generate(t,i,r,o)}buildURL(t,i,r){let o=!this.baseURLOverridden()&&r||this.baseURL,a=p8(t)?new URL(t):new URL(o+(o.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),u=this.defaultQuery();return h8(u)||(i=Object.assign(Object.assign({},u),i)),typeof i=="object"&&i&&!Array.isArray(i)&&(a.search=this.stringifyQuery(i)),a.toString()}async prepareOptions(t){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!t.path.startsWith(`/${this.apiVersion}/projects/`)){let i=t.path.slice(this.apiVersion.length+1);t.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${i}`}}async prepareRequest(t,{url:i,options:r}){}get(t,i){return this.methodRequest("get",t,i)}post(t,i){return this.methodRequest("post",t,i)}patch(t,i){return this.methodRequest("patch",t,i)}put(t,i){return this.methodRequest("put",t,i)}delete(t,i){return this.methodRequest("delete",t,i)}methodRequest(t,i,r){return this.request(Promise.resolve(r).then(o=>Object.assign({method:t,path:i},o)))}request(t,i=null){return new Uy(this,this.makeRequest(t,i,void 0))}async makeRequest(t,i,r){var o,a,u;let c=await t,m=(o=c.maxRetries)!==null&&o!==void 0?o:this.maxRetries;i==null&&(i=m),await this.prepareOptions(c);let{req:h,url:y,timeout:v}=await this.buildRequest(c,{retryCount:m-i});await this.prepareRequest(h,{url:y,options:c});let C="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),T=r===void 0?"":`, retryOf: ${r}`,R=Date.now();if(cn(this).debug(`[${C}] sending request`,go({retryOfRequestLogID:r,method:c.method,url:y,options:c,headers:h.headers})),!((a=c.signal)===null||a===void 0)&&a.aborted)throw new Zl;let N=new AbortController,F=await this.fetchWithTimeout(y,h,v,N).catch(ky),$=Date.now();if(F instanceof globalThis.Error){let Q=`retrying, ${i} attempts remaining`;if(!((u=c.signal)===null||u===void 0)&&u.aborted)throw new Zl;let ie=Py(F)||/timed? ?out/i.test(String(F)+("cause"in F?String(F.cause):""));if(i)return cn(this).info(`[${C}] connection ${ie?"timed out":"failed"} - ${Q}`),cn(this).debug(`[${C}] connection ${ie?"timed out":"failed"} (${Q})`,go({retryOfRequestLogID:r,url:y,durationMs:$-R,message:F.message})),this.retryRequest(c,i,r??C);throw cn(this).info(`[${C}] connection ${ie?"timed out":"failed"} - error; no more retries left`),cn(this).debug(`[${C}] connection ${ie?"timed out":"failed"} (error; no more retries left)`,go({retryOfRequestLogID:r,url:y,durationMs:$-R,message:F.message})),ie?new Pm:new Fa({cause:F})}let q=`[${C}${T}] ${h.method} ${y} ${F.ok?"succeeded":"failed"} with status ${F.status} in ${$-R}ms`;if(!F.ok){let Q=await this.shouldRetry(F);if(i&&Q){let we=`retrying, ${i} attempts remaining`;return await T8(F.body),cn(this).info(`${q} - ${we}`),cn(this).debug(`[${C}] response error (${we})`,go({retryOfRequestLogID:r,url:F.url,status:F.status,headers:F.headers,durationMs:$-R})),this.retryRequest(c,i,r??C,F.headers)}let ie=Q?"error; no more retries left":"error; not retryable";cn(this).info(`${q} - ${ie}`);let de=await F.text().catch(we=>ky(we).message),le=v8(de),Oe=le?void 0:de;throw cn(this).debug(`[${C}] response error (${ie})`,go({retryOfRequestLogID:r,url:F.url,status:F.status,headers:F.headers,message:Oe,durationMs:Date.now()-R})),this.makeStatusError(F.status,le,Oe,F.headers)}return cn(this).info(q),cn(this).debug(`[${C}] response start`,go({retryOfRequestLogID:r,url:F.url,status:F.status,headers:F.headers,durationMs:$-R})),{response:F,options:c,controller:N,requestLogID:C,retryOfRequestLogID:r,startTime:R}}async fetchWithTimeout(t,i,r,o){let a=i||{},{signal:u,method:c}=a,m=Fm(a,["signal","method"]);u&&u.addEventListener("abort",()=>o.abort());let h=setTimeout(()=>o.abort(),r),y=globalThis.ReadableStream&&m.body instanceof globalThis.ReadableStream||typeof m.body=="object"&&m.body!==null&&Symbol.asyncIterator in m.body,v=Object.assign(Object.assign(Object.assign({signal:o.signal},y?{duplex:"half"}:{}),{method:"GET"}),m);c&&(v.method=c.toUpperCase());try{return await this.fetch.call(void 0,t,v)}finally{clearTimeout(h)}}async shouldRetry(t){let i=t.headers.get("x-should-retry");return i==="true"?!0:i==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,i,r,o){var a;let u,c=o?.get("retry-after-ms");if(c){let h=parseFloat(c);Number.isNaN(h)||(u=h)}let m=o?.get("retry-after");if(m&&!u){let h=parseFloat(m);Number.isNaN(h)?u=Date.parse(m)-Date.now():u=h*1e3}if(!(u&&0<=u&&u<60*1e3)){let h=(a=t.maxRetries)!==null&&a!==void 0?a:this.maxRetries;u=this.calculateDefaultRetryTimeoutMillis(i,h)}return await C8(u),this.makeRequest(t,i-1,r)}calculateDefaultRetryTimeoutMillis(t,i){let a=i-t,u=Math.min(.5*Math.pow(2,a),8),c=1-Math.random()*.25;return u*c*1e3}async buildRequest(t,{retryCount:i=0}={}){var r,o,a;let u=Object.assign({},t),{method:c,path:m,query:h,defaultBaseURL:y}=u,v=this.buildURL(m,h,y);"timeout"in u&&_8("timeout",u.timeout),u.timeout=(r=u.timeout)!==null&&r!==void 0?r:this.timeout;let{bodyHeaders:C,body:T}=this.buildBody({options:u}),R=await this.buildHeaders({options:t,method:c,bodyHeaders:C,retryCount:i});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:c,headers:R},u.signal&&{signal:u.signal}),globalThis.ReadableStream&&T instanceof globalThis.ReadableStream&&{duplex:"half"}),T&&{body:T}),(o=this.fetchOptions)!==null&&o!==void 0?o:{}),(a=u.fetchOptions)!==null&&a!==void 0?a:{}),url:v,timeout:u.timeout}}async buildHeaders({options:t,method:i,bodyHeaders:r,retryCount:o}){let a={};this.idempotencyHeader&&i!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=t.idempotencyKey);let u=await this.authHeaders(t),c=zl([a,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(o)},t.timeout?{"X-Stainless-Timeout":String(Math.trunc(t.timeout/1e3))}:{}),S8()),this._options.defaultHeaders,r,t.headers,u]);return this.validateHeaders(c),c.values}buildBody({options:{body:t,headers:i}}){if(!t)return{bodyHeaders:void 0,body:void 0};let r=zl([i]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||typeof t=="string"&&r.values.has("content-type")||globalThis.Blob&&t instanceof globalThis.Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:typeof t=="object"&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&typeof t.next=="function")?{bodyHeaders:void 0,body:w8(t)}:this.encoder({body:t,headers:r})}}return n.DEFAULT_TIMEOUT=6e4,n})(),It=class extends j8{constructor(){super(...arguments),this.interactions=new qm(this)}};U2=It;It.GeminiNextGenAPIClient=U2;It.GeminiNextGenAPIClientError=vn;It.APIError=Cn;It.APIConnectionError=Fa;It.APIConnectionTimeoutError=Pm;It.APIUserAbortError=Zl;It.NotFoundError=Lm;It.ConflictError=Bm;It.RateLimitError=$m;It.BadRequestError=km;It.AuthenticationError=Vm;It.InternalServerError=Hm;It.PermissionDeniedError=Om;It.UnprocessableEntityError=Um;It.toFile=F8;It.Interactions=qm;function z8(n,e){let t={},i=p(n,["name"]);return i!=null&&g(t,["_url","name"],i),t}function Y8(n,e){let t={},i=p(n,["name"]);return i!=null&&g(t,["_url","name"],i),t}function J8(n,e){let t={},i=p(n,["sdkHttpResponse"]);return i!=null&&g(t,["sdkHttpResponse"],i),t}function K8(n,e){let t={},i=p(n,["sdkHttpResponse"]);return i!=null&&g(t,["sdkHttpResponse"],i),t}function Q8(n,e,t){let i={};if(p(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");let r=p(n,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&g(e,["displayName"],r),p(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");let o=p(n,["epochCount"]);e!==void 0&&o!=null&&g(e,["tuningTask","hyperparameters","epochCount"],o);let a=p(n,["learningRateMultiplier"]);if(a!=null&&g(i,["tuningTask","hyperparameters","learningRateMultiplier"],a),p(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(p(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(p(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");let u=p(n,["batchSize"]);e!==void 0&&u!=null&&g(e,["tuningTask","hyperparameters","batchSize"],u);let c=p(n,["learningRate"]);if(e!==void 0&&c!=null&&g(e,["tuningTask","hyperparameters","learningRate"],c),p(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(p(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return i}function Z8(n,e,t){let i={},r=p(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){let C=p(n,["validationDataset"]);e!==void 0&&C!=null&&g(e,["supervisedTuningSpec"],o2(C))}else if(r==="PREFERENCE_TUNING"){let C=p(n,["validationDataset"]);e!==void 0&&C!=null&&g(e,["preferenceOptimizationSpec"],o2(C))}let o=p(n,["tunedModelDisplayName"]);e!==void 0&&o!=null&&g(e,["tunedModelDisplayName"],o);let a=p(n,["description"]);e!==void 0&&a!=null&&g(e,["description"],a);let u=p(t,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){let C=p(n,["epochCount"]);e!==void 0&&C!=null&&g(e,["supervisedTuningSpec","hyperParameters","epochCount"],C)}else if(u==="PREFERENCE_TUNING"){let C=p(n,["epochCount"]);e!==void 0&&C!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],C)}let c=p(t,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){let C=p(n,["learningRateMultiplier"]);e!==void 0&&C!=null&&g(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],C)}else if(c==="PREFERENCE_TUNING"){let C=p(n,["learningRateMultiplier"]);e!==void 0&&C!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],C)}let m=p(t,["config","method"]);if(m===void 0&&(m="SUPERVISED_FINE_TUNING"),m==="SUPERVISED_FINE_TUNING"){let C=p(n,["exportLastCheckpointOnly"]);e!==void 0&&C!=null&&g(e,["supervisedTuningSpec","exportLastCheckpointOnly"],C)}else if(m==="PREFERENCE_TUNING"){let C=p(n,["exportLastCheckpointOnly"]);e!==void 0&&C!=null&&g(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],C)}let h=p(t,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){let C=p(n,["adapterSize"]);e!==void 0&&C!=null&&g(e,["supervisedTuningSpec","hyperParameters","adapterSize"],C)}else if(h==="PREFERENCE_TUNING"){let C=p(n,["adapterSize"]);e!==void 0&&C!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],C)}if(p(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(p(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");let y=p(n,["labels"]);e!==void 0&&y!=null&&g(e,["labels"],y);let v=p(n,["beta"]);return e!==void 0&&v!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","beta"],v),i}function X8(n,e){let t={},i=p(n,["baseModel"]);i!=null&&g(t,["baseModel"],i);let r=p(n,["preTunedModel"]);r!=null&&g(t,["preTunedModel"],r);let o=p(n,["trainingDataset"]);o!=null&&d7(o);let a=p(n,["config"]);return a!=null&&Q8(a,t),t}function e7(n,e){let t={},i=p(n,["baseModel"]);i!=null&&g(t,["baseModel"],i);let r=p(n,["preTunedModel"]);r!=null&&g(t,["preTunedModel"],r);let o=p(n,["trainingDataset"]);o!=null&&c7(o,t,e);let a=p(n,["config"]);return a!=null&&Z8(a,t,e),t}function t7(n,e){let t={},i=p(n,["name"]);return i!=null&&g(t,["_url","name"],i),t}function n7(n,e){let t={},i=p(n,["name"]);return i!=null&&g(t,["_url","name"],i),t}function i7(n,e,t){let i={},r=p(n,["pageSize"]);e!==void 0&&r!=null&&g(e,["_query","pageSize"],r);let o=p(n,["pageToken"]);e!==void 0&&o!=null&&g(e,["_query","pageToken"],o);let a=p(n,["filter"]);return e!==void 0&&a!=null&&g(e,["_query","filter"],a),i}function r7(n,e,t){let i={},r=p(n,["pageSize"]);e!==void 0&&r!=null&&g(e,["_query","pageSize"],r);let o=p(n,["pageToken"]);e!==void 0&&o!=null&&g(e,["_query","pageToken"],o);let a=p(n,["filter"]);return e!==void 0&&a!=null&&g(e,["_query","filter"],a),i}function o7(n,e){let t={},i=p(n,["config"]);return i!=null&&i7(i,t),t}function a7(n,e){let t={},i=p(n,["config"]);return i!=null&&r7(i,t),t}function s7(n,e){let t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);let r=p(n,["nextPageToken"]);r!=null&&g(t,["nextPageToken"],r);let o=p(n,["tunedModels"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(u=>$2(u))),g(t,["tuningJobs"],a)}return t}function l7(n,e){let t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);let r=p(n,["nextPageToken"]);r!=null&&g(t,["nextPageToken"],r);let o=p(n,["tuningJobs"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(u=>$y(u))),g(t,["tuningJobs"],a)}return t}function u7(n,e){let t={},i=p(n,["name"]);i!=null&&g(t,["model"],i);let r=p(n,["name"]);return r!=null&&g(t,["endpoint"],r),t}function d7(n,e){let t={};if(p(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(p(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");let i=p(n,["examples"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>o)),g(t,["examples","examples"],r)}return t}function c7(n,e,t){let i={},r=p(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){let a=p(n,["gcsUri"]);e!==void 0&&a!=null&&g(e,["supervisedTuningSpec","trainingDatasetUri"],a)}else if(r==="PREFERENCE_TUNING"){let a=p(n,["gcsUri"]);e!==void 0&&a!=null&&g(e,["preferenceOptimizationSpec","trainingDatasetUri"],a)}let o=p(t,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){let a=p(n,["vertexDatasetResource"]);e!==void 0&&a!=null&&g(e,["supervisedTuningSpec","trainingDatasetUri"],a)}else if(o==="PREFERENCE_TUNING"){let a=p(n,["vertexDatasetResource"]);e!==void 0&&a!=null&&g(e,["preferenceOptimizationSpec","trainingDatasetUri"],a)}if(p(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function $2(n,e){let t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);let r=p(n,["name"]);r!=null&&g(t,["name"],r);let o=p(n,["state"]);o!=null&&g(t,["state"],g2(o));let a=p(n,["createTime"]);a!=null&&g(t,["createTime"],a);let u=p(n,["tuningTask","startTime"]);u!=null&&g(t,["startTime"],u);let c=p(n,["tuningTask","completeTime"]);c!=null&&g(t,["endTime"],c);let m=p(n,["updateTime"]);m!=null&&g(t,["updateTime"],m);let h=p(n,["description"]);h!=null&&g(t,["description"],h);let y=p(n,["baseModel"]);y!=null&&g(t,["baseModel"],y);let v=p(n,["_self"]);return v!=null&&g(t,["tunedModel"],u7(v)),t}function $y(n,e){let t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);let r=p(n,["name"]);r!=null&&g(t,["name"],r);let o=p(n,["state"]);o!=null&&g(t,["state"],g2(o));let a=p(n,["createTime"]);a!=null&&g(t,["createTime"],a);let u=p(n,["startTime"]);u!=null&&g(t,["startTime"],u);let c=p(n,["endTime"]);c!=null&&g(t,["endTime"],c);let m=p(n,["updateTime"]);m!=null&&g(t,["updateTime"],m);let h=p(n,["error"]);h!=null&&g(t,["error"],h);let y=p(n,["description"]);y!=null&&g(t,["description"],y);let v=p(n,["baseModel"]);v!=null&&g(t,["baseModel"],v);let C=p(n,["tunedModel"]);C!=null&&g(t,["tunedModel"],C);let T=p(n,["preTunedModel"]);T!=null&&g(t,["preTunedModel"],T);let R=p(n,["supervisedTuningSpec"]);R!=null&&g(t,["supervisedTuningSpec"],R);let N=p(n,["preferenceOptimizationSpec"]);N!=null&&g(t,["preferenceOptimizationSpec"],N);let F=p(n,["tuningDataStats"]);F!=null&&g(t,["tuningDataStats"],F);let $=p(n,["encryptionSpec"]);$!=null&&g(t,["encryptionSpec"],$);let q=p(n,["partnerModelTuningSpec"]);q!=null&&g(t,["partnerModelTuningSpec"],q);let Q=p(n,["customBaseModel"]);Q!=null&&g(t,["customBaseModel"],Q);let ie=p(n,["experiment"]);ie!=null&&g(t,["experiment"],ie);let de=p(n,["labels"]);de!=null&&g(t,["labels"],de);let le=p(n,["outputUri"]);le!=null&&g(t,["outputUri"],le);let Oe=p(n,["pipelineJob"]);Oe!=null&&g(t,["pipelineJob"],Oe);let pe=p(n,["serviceAccount"]);pe!=null&&g(t,["serviceAccount"],pe);let we=p(n,["tunedModelDisplayName"]);we!=null&&g(t,["tunedModelDisplayName"],we);let Ct=p(n,["veoTuningSpec"]);return Ct!=null&&g(t,["veoTuningSpec"],Ct),t}function m7(n,e){let t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);let r=p(n,["name"]);r!=null&&g(t,["name"],r);let o=p(n,["metadata"]);o!=null&&g(t,["metadata"],o);let a=p(n,["done"]);a!=null&&g(t,["done"],a);let u=p(n,["error"]);return u!=null&&g(t,["error"],u),t}function o2(n,e){let t={},i=p(n,["gcsUri"]);i!=null&&g(t,["validationDatasetUri"],i);let r=p(n,["vertexDatasetResource"]);return r!=null&&g(t,["validationDatasetUri"],r),t}var Hy=class extends ui{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Ki(Er.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.get=async t=>await this.getInternal(t),this.tune=async t=>{var i;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){let r={tunedModelName:t.baseModel};!((i=t.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(r.checkpointId=t.config.preTunedModelCheckpointId);let o=Object.assign(Object.assign({},t),{preTunedModel:r});return o.baseModel=void 0,await this.tuneInternal(o)}else{let r=Object.assign({},t);return await this.tuneInternal(r)}else{let r=Object.assign({},t),o=await this.tuneMldevInternal(r),a="";return o.metadata!==void 0&&o.metadata.tunedModel!==void 0?a=o.metadata.tunedModel:o.name!==void 0&&o.name.includes("/operations/")&&(a=o.name.split("/operations/")[0]),{name:a,state:l2.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,r,o;let a,u="",c={};if(this.apiClient.isVertexAI()){let m=n7(e);return u=ee("{name}",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>$y(h))}else{let m=t7(e);return u=ee("{name}",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>$2(h))}}async listInternal(e){var t,i,r,o;let a,u="",c={};if(this.apiClient.isVertexAI()){let m=a7(e);return u=ee("tuningJobs",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>{let y=l7(h),v=new Tm;return Object.assign(v,y),v})}else{let m=o7(e);return u=ee("tunedModels",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>{let y=s7(h),v=new Tm;return Object.assign(v,y),v})}}async cancel(e){var t,i,r,o;let a,u="",c={};if(this.apiClient.isVertexAI()){let m=Y8(e);return u=ee("{name}:cancel",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>{let y=K8(h),v=new Im;return Object.assign(v,y),v})}else{let m=z8(e);return u=ee("{name}:cancel",m._url),c=m._query,delete m._url,delete m._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let v=y;return v.sdkHttpResponse={headers:h.headers},v})),a.then(h=>{let y=J8(h),v=new Im;return Object.assign(v,y),v})}}async tuneInternal(e){var t,i;let r,o="",a={};if(this.apiClient.isVertexAI()){let u=e7(e,e);return o=ee("tuningJobs",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(m=>{let h=m;return h.sdkHttpResponse={headers:c.headers},h})),r.then(c=>$y(c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let r,o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=X8(e);return o=ee("tunedModels",u._url),a=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(c=>c.json().then(m=>{let h=m;return h.sdkHttpResponse={headers:c.headers},h})),r.then(c=>m7(c))}}};var Gy=class{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}},p7=1024*1024*8,f7=3,g7=1e3,h7=2,jm="x-goog-upload-status";async function y7(n,e,t){var i;let r=await H2(n,e,t),o=await r?.json();if(((i=r?.headers)===null||i===void 0?void 0:i[jm])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return o.file}async function _7(n,e,t){var i;let r=await H2(n,e,t),o=await r?.json();if(((i=r?.headers)===null||i===void 0?void 0:i[jm])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");let a=s2(o),u=new my;return Object.assign(u,a),u}async function H2(n,e,t){var i,r;let o=0,a=0,u=new Kl(new Response),c="upload";for(o=n.size;a<o;){let m=Math.min(p7,o-a),h=n.slice(a,a+m);a+m>=o&&(c+=", finalize");let y=0,v=g7;for(;y<f7&&(u=await t.request({path:"",body:h,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":c,"X-Goog-Upload-Offset":String(a),"Content-Length":String(m)}}}),!(!((i=u?.headers)===null||i===void 0)&&i[jm]));)y++,await C7(v),v=v*h7;if(a+=m,((r=u?.headers)===null||r===void 0?void 0:r[jm])!=="active")break;if(o<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return u}async function v7(n){return{size:n.size,type:n.type}}function C7(n){return new Promise(e=>setTimeout(e,n))}var qy=class{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await y7(e,t,i)}async uploadToFileSearchStore(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await _7(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await v7(e)}};var Wy=class{create(e,t,i){return new jy(e,t,i)}},jy=class{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}};var a2="x-goog-api-key",zy=class{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(a2)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(a2,this.apiKey)}}};var x7="gl-node/",zm=class{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");let e=this.httpOptions;e?.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");let t=new It({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e?.timeout});return this._interactions=t.interactions,this._interactions}constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;let i=YR(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;let r=new zy(this.apiKey);this.apiClient=new Ey({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:x7+"web",uploader:new qy,downloader:new Gy}),this.models=new My(this.apiClient),this.live=new Ty(this.apiClient,r,new Wy),this.batches=new gy(this.apiClient),this.chats=new yy(this.models,this.apiClient),this.caches=new hy(this.apiClient),this.files=new vy(this.apiClient),this.operations=new Ay(this.apiClient),this.authTokens=new Ry(this.apiClient),this.tunings=new Hy(this.apiClient),this.fileSearchStores=new Fy(this.apiClient)}};var yo=class yo{constructor(){this.ai=null;this.financialInsightState=S("idle");this.financialInsight=S(null);this.financialInsightError=S(null);this.basketAnalysisState=S("idle");this.basketAnalysis=S(null);this.basketAnalysisError=S(null);let e=typeof process<"u"&&process.env?process.env.API_KEY:void 0;e?this.ai=new zm({apiKey:e}):console.error("API_KEY environment variable not set. AI features will not be available.")}async generateFinancialInsights(e,t){if(!this.ai){this.financialInsightError.set("Gemini AI \u5BA2\u6236\u7AEF\u672A\u521D\u59CB\u5316\u3002\u8ACB\u6AA2\u67E5 API \u91D1\u9470\u3002"),this.financialInsightState.set("error");return}this.financialInsightState.set("loading"),this.financialInsightError.set(null),this.financialInsight.set(null);let i=`
      Analyze the following financial data for a small business.
      IMPORTANT: All textual analysis and recommendations in the response must be in Traditional Chinese. The JSON keys must remain in English as specified in the schema.

      Financial Summary:
      - Total Revenue: ${e.totalRevenue.toFixed(2)}
      - Total Expenses: ${e.totalExpenses.toFixed(2)}
      - Net Income: ${e.netIncome.toFixed(2)}

      Monthly Performance (Revenue vs Expenses):
      ${t.map(r=>`- ${r.month}: Revenue ${r.revenue.toFixed(2)}, Expenses ${r.expenses.toFixed(2)}`).join(`
`)}

      Based on this data, provide:
      1. Two key positive trends.
      2. Two potential areas for improvement or concern.
      3. Two actionable strategic recommendations.
    `;try{let r=await this.ai.models.generateContent({model:"gemini-2.5-flash",contents:i,config:{responseMimeType:"application/json",responseSchema:{type:mt.OBJECT,properties:{positive_trends:{type:mt.ARRAY,items:{type:mt.STRING}},areas_for_improvement:{type:mt.ARRAY,items:{type:mt.STRING}},strategic_recommendations:{type:mt.ARRAY,items:{type:mt.STRING}}}}}}),o=JSON.parse(r.text);this.financialInsight.set(o),this.financialInsightState.set("success")}catch(r){console.error(r),this.financialInsightError.set("\u5F9E AI \u6A21\u578B\u751F\u6210\u8CA1\u52D9\u6D1E\u5BDF\u5931\u6557\u3002"),this.financialInsightState.set("error")}}async analyzeShoppingBaskets(e){if(!this.ai){this.basketAnalysisError.set("Gemini AI \u5BA2\u6236\u7AEF\u672A\u521D\u59CB\u5316\u3002\u8ACB\u6AA2\u67E5 API \u91D1\u9470\u3002"),this.basketAnalysisState.set("error");return}this.basketAnalysisState.set("loading"),this.basketAnalysisError.set(null),this.basketAnalysis.set(null);let t=e.map(r=>r.items.map(o=>o.name)),i=`
      Perform a market basket analysis on the following list of customer transactions. Each inner list represents one transaction.
      Transactions: ${JSON.stringify(t)}

      IMPORTANT: All textual analysis, suggestions, and insights in the response must be in Traditional Chinese. The JSON keys must remain in English as specified in the schema.

      Identify up to 3 sets of items that are frequently bought together. For each set, provide a marketing or upselling suggestion.
      Also, provide 2 general insights into customer purchasing behavior based on this data.
    `;try{let r=await this.ai.models.generateContent({model:"gemini-2.5-flash",contents:i,config:{responseMimeType:"application/json",responseSchema:{type:mt.OBJECT,properties:{frequently_bought_together:{type:mt.ARRAY,items:{type:mt.OBJECT,properties:{items:{type:mt.ARRAY,items:{type:mt.STRING}},suggestion:{type:mt.STRING}}}},customer_behavior_insights:{type:mt.ARRAY,items:{type:mt.STRING}}}}}}),o=JSON.parse(r.text);this.basketAnalysis.set(o),this.basketAnalysisState.set("success")}catch(r){console.error(r),this.basketAnalysisError.set("\u5F9E AI \u6A21\u578B\u751F\u6210\u8CFC\u7269\u7C43\u5206\u6790\u5931\u6557\u3002"),this.basketAnalysisState.set("error")}}};yo.\u0275fac=function(t){return new(t||yo)},yo.\u0275prov=Z({token:yo,factory:yo.\u0275fac,providedIn:"root"});var Qm=yo;var b7=(n,e)=>e.id,E7=(n,e)=>e.transactionId;function S7(n,e){n&1&&(l(0,"div",17)(1,"div",31),x(2,"div",32),l(3,"p",6),d(4,"\u52A0\u8F09\u9867\u5BA2\u5217\u8868\u4E2D..."),s()()())}function D7(n,e){if(n&1&&(l(0,"div",18)(1,"p",33),d(2,"\u52A0\u8F09\u5931\u6557"),s(),l(3,"p"),d(4),s()()),n&2){let t=_();f(4),E(t.errorMessage())}}function w7(n,e){if(n&1){let t=B();l(0,"div",47),b("click",function(){let r=D(t).$implicit,o=_(2);return w(o.selectCustomer(r))}),l(1,"div",48)(2,"p",49),d(3),s(),l(4,"span",50),d(5),s()(),l(6,"p",6),d(7),s()()}if(n&2){let t,i,r=e.$implicit,o=_(2);W("bg-indigo-100",((t=o.selectedCustomer())==null?null:t.id)===r.id)("hover:bg-gray-100",((i=o.selectedCustomer())==null?null:i.id)!==r.id),f(3),E(o.getCleanCustomerName(r)),f(),De(o.getCustomerTypeClass(r)),f(),E(o.getCustomerType(r)),f(2),E(r.phone)}}function T7(n,e){n&1&&(l(0,"p",46),d(1,"\u627E\u4E0D\u5230\u9867\u5BA2\u3002"),s())}function I7(n,e){if(n&1){let t=B();l(0,"div",34)(1,"select",35),J("ngModelChange",function(r){D(t);let o=_();return K(o.categoryFilter,r)||(o.categoryFilter=r),w(r)}),l(2,"option",36),d(3,"\u5168\u90E8\u9867\u5BA2"),s(),l(4,"option",37),d(5,"\u4E00\u822C\u9867\u5BA2"),s(),l(6,"option",38),d(7,"\u96EA\u8304\u6703\u54E1"),s(),l(8,"option",39),d(9,"\u80A1\u6771"),s()()(),l(10,"div",40)(11,"input",41),J("ngModelChange",function(r){D(t);let o=_();return K(o.searchTerm,r)||(o.searchTerm=r),w(r)}),s(),x(12,"ion-icon",42),s(),l(13,"div",43)(14,"div",44),O(15,w7,8,9,"div",45,b7,!1,T7,2,0,"p",46),s()()}if(n&2){let t=_();f(),Y("ngModel",t.categoryFilter),f(10),Y("ngModel",t.searchTerm),f(4),L(t.filteredCustomers())}}function M7(n,e){if(n&1&&(l(0,"div",60)(1,"strong",64),d(2,"\u6700\u5F8C\u7D50\u5E33\u6642\u9593"),s(),l(3,"span",58),d(4),Gt(5,"date"),s()()),n&2){let t=_();f(4),E(sn(5,1,t.lastCheckoutAt,"yyyy-MM-dd HH:mm"))}}function A7(n,e){if(n&1&&(l(0,"div",60)(1,"strong",64),d(2,"\u5099\u8A3B"),s(),l(3,"span",58),d(4),s()()),n&2){let t=_();f(4),E(t.note)}}function R7(n,e){if(n&1&&(l(0,"tr",68)(1,"td",66),d(2),s(),l(3,"td",66),d(4),s(),l(5,"td",69),d(6),s()()),n&2){let t=e.$implicit,i=_(3);f(2),E(t.date),f(2),E(i.formatSaleItems(t.items)),f(2),E(i.formatCurrency(t.total))}}function N7(n,e){if(n&1&&(l(0,"table",63)(1,"thead",65)(2,"tr")(3,"th",66),d(4,"\u65E5\u671F"),s(),l(5,"th",66),d(6,"\u54C1\u9805"),s(),l(7,"th",67),d(8,"\u7E3D\u91D1\u984D"),s()()(),l(9,"tbody"),O(10,R7,7,3,"tr",68,E7),s()()),n&2){let t=_(2);f(10),L(t.customerSales())}}function F7(n,e){n&1&&(l(0,"p",46),d(1,"\u7121\u4EA4\u6613\u7D00\u9304\u3002"),s())}function P7(n,e){if(n&1){let t=B();l(0,"div")(1,"div",21)(2,"div",51)(3,"div")(4,"h2",52),d(5),s(),l(6,"span",53),d(7),s()(),l(8,"button",54),b("click",function(){D(t);let r=_();return w(r.clearSelection())}),x(9,"ion-icon",55),s()(),l(10,"div",56)(11,"div")(12,"strong",57),d(13,"\u96FB\u8A71"),s(),l(14,"span",58),d(15),s()(),l(16,"div")(17,"strong",57),d(18,"\u6027\u5225"),s(),l(19,"span",58),d(20),s()(),l(21,"div")(22,"strong",57),d(23,"\u751F\u65E5"),s(),l(24,"span",58),d(25),s()(),l(26,"div")(27,"strong",57),d(28,"\u51FA\u751F\u5E74\u4EFD"),s(),l(29,"span",58),d(30),s()(),l(31,"div")(32,"strong",57),d(33,"\u7A4D\u5206\u9EDE\u6578"),s(),l(34,"span",59),d(35),s()(),l(36,"div")(37,"strong",57),d(38,"\u539F\u59CB\u9580\u5E97"),s(),l(39,"span",58),d(40),s()()(),M(41,M7,6,4,"div",60),M(42,A7,5,1,"div",60),s(),l(43,"div",61)(44,"h3",16),d(45,"\u4EA4\u6613\u6B77\u53F2"),s(),l(46,"div",62),M(47,N7,12,0,"table",63)(48,F7,2,0,"p",46),s()()()}if(n&2){let t=e,i=_();f(5),E(i.getCleanCustomerName(t)),f(),De(i.getCustomerTypeClass(t)),f(),E(i.getCustomerType(t)),f(8),E(t.phone||"-"),f(5),E(t.gender||"-"),f(5),E(t.birthday||"-"),f(5),E(t.birthYear||"-"),f(5),k("",t.loyaltyPoints||0," \u9EDE"),f(5),E(t.originStore||"-"),f(),A(t.lastCheckoutAt?41:-1),f(),A(t.note?42:-1),f(5),A(i.customerSales().length>0?47:48)}}function k7(n,e){n&1&&(l(0,"div",20)(1,"div",70),x(2,"ion-icon",71),l(3,"p",72),d(4,"\u8ACB\u5F9E\u5DE6\u5074\u9078\u64C7\u4E00\u4F4D\u9867\u5BA2\u4EE5\u67E5\u770B\u8A73\u7D30\u8CC7\u8A0A\u3002"),s()()())}function V7(n,e){n&1&&x(0,"div",27)}function O7(n,e){n&1&&(l(0,"p",28),d(1,"\u9EDE\u64CA\u6309\u9215\u4EE5\u5C0D\u5168\u9AD4\u9867\u5BA2\u7684 POS \u6578\u64DA\u904B\u884C AI \u8CFC\u7269\u7C43\u5206\u6790\u3002"),s())}function L7(n,e){n&1&&(l(0,"p",29),d(1,"AI \u6B63\u5728\u5206\u6790\u4EA4\u6613\u7D00\u9304..."),s())}function B7(n,e){if(n&1&&(l(0,"div",30)(1,"p",33),d(2,"\u767C\u751F\u932F\u8AA4"),s(),l(3,"p"),d(4),s()()),n&2){let t=_();f(4),E(t.geminiService.basketAnalysisError())}}function U7(n,e){if(n&1&&(l(0,"div",75)(1,"p",77),d(2),s(),l(3,"p",78)(4,"span",79),d(5,"\u5EFA\u8B70\uFF1A"),s(),d(6),s()()),n&2){let t=e.$implicit;f(2),E(t.items.join(" + ")),f(4),k(" ",t.suggestion)}}function $7(n,e){n&1&&(l(0,"p",28),d(1,"\u672A\u627E\u5230\u986F\u8457\u7684\u5546\u54C1\u7D44\u5408\u3002"),s())}function H7(n,e){if(n&1&&(l(0,"li"),d(1),s()),n&2){let t=e.$implicit;f(),E(t)}}function G7(n,e){if(n&1&&(l(0,"div",73)(1,"div")(2,"h4",74),d(3,"\u7D93\u5E38\u4E00\u8D77\u8CFC\u8CB7\u7684\u5546\u54C1"),s(),O(4,U7,7,2,"div",75,Sn,!1,$7,2,0,"p",28),s(),l(7,"div")(8,"h4",74),d(9,"\u9867\u5BA2\u884C\u70BA\u6D1E\u5BDF"),s(),l(10,"ul",76),O(11,H7,2,1,"li",null,Sn),s()()()),n&2){let t=e;f(4),L(t.frequently_bought_together),f(7),L(t.customer_behavior_insights)}}function q7(n,e){if(n&1&&M(0,G7,13,1,"div",73),n&2){let t,i=_();A((t=i.geminiService.basketAnalysis())?0:-1,t)}}var La=class La{constructor(){this.apiService=P(Xe);this.geminiService=P(Qm);this.customers=S([]);this.searchTerm=S("");this.categoryFilter=S("all");this.selectedCustomer=S(null);this.customerSales=S([]);this.customerFeedback=S([]);this.isLoading=S(!1);this.errorMessage=S(null);this.filteredCustomers=H(()=>{let e=this.customers(),t=this.categoryFilter();t!=="all"&&(e=e.filter(r=>this.getCustomerCategory(r)===t));let i=this.searchTerm().toLowerCase();return i&&(e=e.filter(r=>r.name?.toLowerCase().includes(i)||r.phone?.includes(i))),e});this.customerStats=H(()=>{let e=this.customers(),t=e.length,i=e.filter(a=>this.getCustomerCategory(a)==="cigar").length,r=e.filter(a=>this.getCustomerCategory(a)==="shareholder").length,o=e.filter(a=>this.getCustomerCategory(a)==="regular").length;return{total:t,cigarCount:i,regularCount:o,shareholderCount:r}});this.loadCustomers()}async loadCustomers(){this.isLoading.set(!0),this.errorMessage.set(null);try{let e=await this.apiService.getCustomers();e.success&&e.data&&Array.isArray(e.data)?this.customers.set(e.data):this.errorMessage.set(e.error||"\u7121\u6CD5\u53D6\u5F97\u9867\u5BA2\u8CC7\u6599")}catch(e){console.error("Error loading customers:",e),this.errorMessage.set("\u8F09\u5165\u9867\u5BA2\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoading.set(!1)}}selectCustomer(e){this.selectedCustomer.set(e)}clearSelection(){this.selectedCustomer.set(null),this.customerSales.set([]),this.customerFeedback.set([])}runBasketAnalysis(){}getCustomerCategory(e){let t=e.name||"";return t.includes("\u96EA\u8304")?"cigar":t.includes("\u80A1\u6771")?"shareholder":"regular"}getCleanCustomerName(e){let t=e.name||"";return t=t.replace(/\s*/g,"").replace(/\s*/g,""),t.trim()}getCustomerTypeClass(e){switch(this.getCustomerCategory(e)){case"cigar":return"bg-purple-100 text-purple-800";case"shareholder":return"bg-yellow-100 text-yellow-800";default:return"bg-blue-100 text-blue-800"}}getCustomerType(e){switch(this.getCustomerCategory(e)){case"cigar":return"\u96EA\u8304\u6703\u54E1";case"shareholder":return"\u80A1\u6771";default:return"\u4E00\u822C\u9867\u5BA2"}}formatSaleItems(e){return e?e.map(t=>t.name).join(", "):""}formatCurrency(e){return e==null?"":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}getStars(e){return Array(e).fill(0)}getEmptyStars(e){return Array(5-e).fill(0)}};La.\u0275fac=function(t){return new(t||La)},La.\u0275cmp=re({type:La,selectors:[["app-customer-analysis"]],decls:60,vars:11,consts:[[1,"space-y-8"],[1,"text-3xl","font-bold","text-gray-900"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-6"],[1,"bg-white","p-6","rounded-xl","shadow-md","flex","items-center","space-x-4"],[1,"bg-blue-100","p-3","rounded-full"],["name","people-outline",1,"text-2xl","text-blue-600"],[1,"text-sm","text-gray-500"],[1,"text-2xl","font-semibold","text-gray-900"],[1,"bg-green-100","p-3","rounded-full"],["name","person-outline",1,"text-2xl","text-green-600"],[1,"bg-purple-100","p-3","rounded-full"],["name","ribbon-outline",1,"text-2xl","text-purple-600"],[1,"bg-yellow-100","p-3","rounded-full"],["name","briefcase-outline",1,"text-2xl","text-yellow-600"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-8"],[1,"lg:col-span-1","bg-white","p-6","rounded-xl","shadow-md","flex","flex-col"],[1,"text-lg","font-semibold","text-gray-800","mb-4"],[1,"flex","items-center","justify-center","h-32"],[1,"bg-red-50","border","border-red-200","text-red-700","p-3","rounded-lg","mb-4","text-sm"],[1,"lg:col-span-2","space-y-8"],[1,"h-full","flex","items-center","justify-center","bg-white","p-6","rounded-xl","shadow-md"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"flex","justify-between","items-center","mb-4"],[1,"flex","items-center","space-x-3"],["name","basket-outline",1,"text-2xl","text-indigo-600"],[1,"text-lg","font-semibold","text-gray-800"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","disabled:bg-indigo-300","disabled:cursor-not-allowed","flex","items-center","space-x-2",3,"click","disabled"],[1,"w-5","h-5","border-2","border-white","border-t-transparent","rounded-full","animate-spin"],[1,"text-gray-500"],[1,"text-gray-500","animate-pulse"],[1,"bg-red-50","text-red-700","p-4","rounded-lg"],[1,"flex","flex-col","items-center","space-y-2"],[1,"w-8","h-8","border-3","border-indigo-200","border-t-indigo-600","rounded-full","animate-spin"],[1,"font-semibold"],[1,"mb-3"],[1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-50",3,"ngModelChange","ngModel"],["value","all"],["value","regular"],["value","cigar"],["value","shareholder"],[1,"relative","mb-4"],["type","text","placeholder","\u4F9D\u59D3\u540D\u6216\u96FB\u8A71\u641C\u5C0B...",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","pl-10","bg-gray-50",3,"ngModelChange","ngModel"],["name","search-outline",1,"absolute","left-3","top-1/2","-translate-y-1/2","text-gray-400"],[1,"flex-1","overflow-y-auto","-mx-2","px-2"],[1,"space-y-2"],[1,"p-3","rounded-lg","cursor-pointer","transition-colors",3,"bg-indigo-100","hover:bg-gray-100"],[1,"text-center","text-gray-500","py-4"],[1,"p-3","rounded-lg","cursor-pointer","transition-colors",3,"click"],[1,"flex","justify-between","items-center"],[1,"font-medium","text-gray-800"],[1,"text-xs","font-semibold","px-2","py-1","rounded-full"],[1,"flex","justify-between","items-start"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-sm","font-semibold","px-2","py-1","rounded-full","mt-1","inline-block"],[1,"text-gray-500","hover:text-gray-700",3,"click"],["name","close-circle-outline",1,"text-2xl"],[1,"mt-4","grid","grid-cols-2","md:grid-cols-3","gap-4","text-sm","border-t","pt-4"],[1,"block","text-gray-500"],[1,"text-gray-800"],[1,"text-gray-800","font-bold"],[1,"mt-4","pt-4","border-t","text-sm"],[1,"bg-white","p-6","rounded-xl","shadow-md","mt-8"],[1,"overflow-x-auto","max-h-60"],[1,"w-full","text-sm","text-left","text-gray-500"],[1,"block","text-gray-500","mb-1"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50","sticky","top-0"],[1,"px-4","py-2"],[1,"px-4","py-2","text-right"],[1,"bg-white","border-b","hover:bg-gray-50"],[1,"px-4","py-2","text-right","font-medium"],[1,"text-center"],["name","person-add-outline",1,"text-5xl","text-gray-400"],[1,"mt-2","text-gray-500"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6","text-sm"],[1,"font-semibold","text-gray-800","mb-2"],[1,"bg-indigo-50","p-4","rounded-lg","mb-4"],[1,"list-disc","list-inside","space-y-2","text-gray-600","bg-gray-50","p-4","rounded-lg"],[1,"font-semibold","text-indigo-800"],[1,"text-indigo-700","mt-1"],[1,"font-medium"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"h1",1),d(2,"\u9867\u5BA2\u7BA1\u7406"),s(),l(3,"div",2)(4,"div",3)(5,"div",4),x(6,"ion-icon",5),s(),l(7,"div")(8,"p",6),d(9,"\u7E3D\u9867\u5BA2\u6578"),s(),l(10,"p",7),d(11),s()()(),l(12,"div",3)(13,"div",8),x(14,"ion-icon",9),s(),l(15,"div")(16,"p",6),d(17,"\u4E00\u822C\u9867\u5BA2"),s(),l(18,"p",7),d(19),s()()(),l(20,"div",3)(21,"div",10),x(22,"ion-icon",11),s(),l(23,"div")(24,"p",6),d(25,"\u96EA\u8304\u6703\u54E1"),s(),l(26,"p",7),d(27),s()()(),l(28,"div",3)(29,"div",12),x(30,"ion-icon",13),s(),l(31,"div")(32,"p",6),d(33,"\u80A1\u6771"),s(),l(34,"p",7),d(35),s()()()(),l(36,"div",14)(37,"div",15)(38,"h3",16),d(39,"\u9867\u5BA2\u5217\u8868"),s(),M(40,S7,5,0,"div",17),M(41,D7,5,1,"div",18),M(42,I7,18,3),s(),l(43,"div",19),M(44,P7,49,13,"div")(45,k7,5,0,"div",20),s()(),l(46,"div",21)(47,"div",22)(48,"div",23),x(49,"ion-icon",24),l(50,"h3",25),d(51,"\u9867\u5BA2\u884C\u70BA\u5206\u6790 (\u6574\u9AD4)"),s()(),l(52,"button",26),b("click",function(){return i.runBasketAnalysis()}),M(53,V7,1,0,"div",27),l(54,"span"),d(55,"\u5206\u6790\u8CFC\u7269\u7C43"),s()()(),M(56,O7,2,0,"p",28)(57,L7,2,0,"p",29)(58,B7,5,1,"div",30)(59,q7,1,1),s()()),t&2){let r,o;f(11),E(i.customerStats().total),f(8),E(i.customerStats().regularCount),f(8),E(i.customerStats().cigarCount),f(8),E(i.customerStats().shareholderCount),f(5),A(i.isLoading()?40:-1),f(),A(i.errorMessage()?41:-1),f(),A(i.isLoading()?-1:42),f(2),A((r=i.selectedCustomer())?44:45,r),f(8),I("disabled",i.geminiService.basketAnalysisState()==="loading"),f(),A(i.geminiService.basketAnalysisState()==="loading"?53:-1),f(3),A((o=i.geminiService.basketAnalysisState())==="idle"?56:o==="loading"?57:o==="error"?58:o==="success"?59:-1)}},dependencies:[oe,Se,Fe,Pe,xe,Re,me,Ie,eo],encapsulation:2,changeDetection:0});var Zm=La;var _o=class _o{constructor(){this.mockTargetGoals=S([{id:"TG001",title:"\u516B\u6708\u7E3D\u71DF\u6536\u76EE\u6A19",type:"\u71DF\u6536",targetValue:35e4,currentValue:289190,startDate:"2024-08-01",endDate:"2024-08-31",status:"\u9032\u884C\u4E2D",unit:"\u5143",assigneeId:"USR002",period:"monthly"},{id:"TG002",title:"\u5341\u6708\u6D3B\u52D5\u5834\u6B21",type:"\u6D3B\u52D5",targetValue:15,currentValue:13,startDate:"2024-10-01",endDate:"2024-10-31",status:"\u9032\u884C\u4E2D",unit:"\u5834",assigneeId:"USR003",period:"monthly"},{id:"TG003",title:"\u7B2C\u4E09\u5B63 VIP \u9867\u5BA2\u589E\u9577",type:"\u9867\u5BA2",targetValue:10,currentValue:12,startDate:"2024-07-01",endDate:"2024-09-30",status:"\u5DF2\u9054\u6210",unit:"\u4EBA",assigneeId:"USR003",period:"monthly"},{id:"TG004",title:"\u7B2C\u56DB\u5B63\u9867\u5BA2\u6EFF\u610F\u5EA6\u63D0\u5347",type:"\u9867\u5BA2",targetValue:5,currentValue:4,startDate:"2024-10-01",endDate:"2024-12-31",status:"\u9032\u884C\u4E2D",unit:"\u5206",period:"monthly"},{id:"TG005",title:"2024\u5E74\u5E74\u5EA6\u7E3D\u71DF\u6536",type:"\u71DF\u6536",targetValue:4e6,currentValue:285e4,startDate:"2024-01-01",endDate:"2024-12-31",status:"\u9032\u884C\u4E2D",unit:"\u5143",period:"yearly"},{id:"TG006",title:"2024\u5E74\u7E3D\u6D3B\u52D5\u5834\u6B21",type:"\u6D3B\u52D5",targetValue:100,currentValue:85,startDate:"2024-01-01",endDate:"2024-12-31",status:"\u9032\u884C\u4E2D",unit:"\u5834",assigneeId:"USR003",period:"yearly"}]);this.mockEvents=S([{id:"EVT001",type:"\u5BB4\u5BA2",status:"active",date:"2024-10-03",name:"\u52DE\u502B\u65AF",attendees:"10~15",estimatedRevenue:19e3,actualRevenue:20980,notes:"\u9152\u5546\u8CBB: 9600/\u9910\u9EDE: \u4EBA600"},{id:"EVT002",type:"\u76AE\u5361",status:"active",date:"2024-10-04",time:"14:30~18:30",name:"\u5361\u724C",attendees:"10~15",estimatedRevenue:8e3,actualRevenue:8540},{id:"EVT003",type:"\u5546\u52D9\u3001\u5E97\u5167",status:"active",date:"2024-10-07",name:"\u6F2B\u9727",attendees:"6",estimatedRevenue:4200,actualRevenue:4900,notes:"\u662F\u5426\u8ABF\u6574"},{id:"EVT004",type:"\u5BB4\u5BA2",status:"active",date:"2024-10-13",name:"Dave",attendees:"8~10",estimatedRevenue:15e3,actualRevenue:24080,notes:"8000/\u4E2D\u5F0F"},{id:"EVT005",type:"\u76AE\u5361",status:"active",date:"2024-10-14",time:"14:30~18:00",name:"TCBA",organizer:"\u76AE\u5361",attendees:"8",estimatedRevenue:4e3,actualRevenue:4e3,notes:"\u4EBA/530"},{id:"EVT006",type:"\u5E97\u5167",status:"cancelled",date:"2024-10-17",name:"\u70C8\u9152\u54C1\u9152\u6703",attendees:"0",estimatedRevenue:0,actualRevenue:0},{id:"EVT007",type:"\u7DAD\u7DB8",status:"active",date:"2024-10-18",time:"\u665A\u4E0A18:00\u5F8C",name:"slp\u5275\u696D\u5B78\u9662",attendees:"70",estimatedRevenue:7e4,deposit:21e3,actualRevenue:77640,notes:"\u8A02\u91D1\u5DF2\u6536"},{id:"EVT008",type:"\u7D05\u767D\u806F\u8ABC",status:"active",date:"2024-10-19",time:"14:00~17:00",name:"\u5C0F\u745C",attendees:"7",estimatedRevenue:36e3,actualRevenue:7e3,notes:"\u9152\u5546\u8CBB: 12000~14000/\u4EBA\u6578: \u7537\u5973\u5C0D\u534A \u5C0F\u745C\u62BD500\u5143/\u4EBA"},{id:"EVT009",type:"\u5E97\u5167",status:"active",date:"2024-10-22",name:"\u7D05\u767D\u9152\u54C1\u6703",attendees:"4",estimatedRevenue:15e3,actualRevenue:6e3,notes:"\u9152\u5546\u8CBB: 12000 \u8CBB\u7528: 1,500\u5143/\u4EBA 4\u96BB\u9152/\u642D\u914D\u98A8\u5473\u98DF\u7269"},{id:"EVT010",type:"\u6D3B\u52D5",status:"cancelled",date:"2024-10-23",time:"19:00~22:00",name:"Scott",organizer:"Scott",attendees:"0",estimatedRevenue:0,actualRevenue:0,notes:"1\u4EBA/400"},{id:"EVT011",type:"\u7DAD\u7DB8",status:"active",date:"2024-10-25",time:"\u665A\u4E0A18:00\u5F8C",name:"slp\u5275\u696D\u5B78\u9662",attendees:"55",estimatedRevenue:7e4,deposit:21e3,actualRevenue:74010,notes:"\u8A02\u91D1\u5DF2\u6536"},{id:"EVT012",type:"Laurence",status:"active",date:"2024-10-26",time:"\u4E0B\u5348\u958B\u5E55",name:"\u516C\u53F8\u958B\u5E55",attendees:"30",estimatedRevenue:1e4,actualRevenue:1e4},{id:"EVT013",type:"\u80A1\u6771\u6703",status:"active",date:"2024-10-28",name:"\u80A1\u6771\u6703",attendees:"5",estimatedRevenue:0,actualRevenue:0},{id:"EVT014",type:"\u5BA2\u6236",status:"active",date:"2024-10-29",name:"Connyn",attendees:"20~25",estimatedRevenue:15e3,actualRevenue:15e3,notes:"\u83DC: 15000"},{id:"EVT015",type:"\u76AE\u5361",status:"active",date:"2024-10-30",time:"\u665A\u4E0A18:00\u5F8C",name:"\u5361\u724C",organizer:"\u76AE\u5361",attendees:"8",estimatedRevenue:4e3,actualRevenue:12890},{id:"EVT016",type:"\u5E97\u5167",status:"active",date:"2024-10-31",name:"\u6F2B\u9727",attendees:"6",estimatedRevenue:8400,actualRevenue:4900},{id:"EVT017",type:"\u5546\u52D9",status:"active",date:"2024-08-01",name:"\u6F2B\u9727",attendees:"20",estimatedRevenue:2e4,actualRevenue:21450},{id:"EVT018",type:"\u79C1\u4EBA",status:"active",date:"2024-08-09",name:"\u555F\u5E06",attendees:"5",estimatedRevenue:2e3,actualRevenue:1900},{id:"EVT019",type:"\u79C1\u4EBA",status:"active",date:"2024-08-13",name:"\u555F\u5E06",attendees:"10",estimatedRevenue:0,actualRevenue:0},{id:"EVT020",type:"\u5BB4\u5BA2",status:"active",date:"2024-08-14",name:"vic / jackle",attendees:"15",estimatedRevenue:18e3,actualRevenue:2e4},{id:"EVT021",type:"\u5546\u52D9",status:"active",date:"2024-08-22",name:"\u6F2B\u9727",attendees:"12",estimatedRevenue:1e4,actualRevenue:10155},{id:"EVT022",type:"\u79C1\u4EBA",status:"active",date:"2024-08-27",name:"\u555F\u5E06",attendees:"8",estimatedRevenue:8e3,actualRevenue:9300},{id:"EVT023",type:"\u54C1\u9152\u6703",status:"active",date:"2024-08-28",name:"\u5167\u90E8\u54C1\u9152",attendees:"10",estimatedRevenue:1e4,actualRevenue:10700}]);this.mockDailyRevenue=S([{date:"2024-08-01",nonEventRevenue:10520,isDayOff:!1},{date:"2024-08-02",nonEventRevenue:3340,isDayOff:!1},{date:"2024-08-03",nonEventRevenue:970,isDayOff:!1},{date:"2024-08-04",nonEventRevenue:0,isDayOff:!0},{date:"2024-08-05",nonEventRevenue:200,isDayOff:!1},{date:"2024-08-06",nonEventRevenue:0,isDayOff:!1},{date:"2024-08-07",nonEventRevenue:0,isDayOff:!1},{date:"2024-08-08",nonEventRevenue:17950,isDayOff:!1},{date:"2024-08-09",nonEventRevenue:6800,isDayOff:!1},{date:"2024-08-10",nonEventRevenue:8410,isDayOff:!1},{date:"2024-08-11",nonEventRevenue:0,isDayOff:!0},{date:"2024-08-12",nonEventRevenue:8970,isDayOff:!1},{date:"2024-08-13",nonEventRevenue:14900,isDayOff:!1},{date:"2024-08-14",nonEventRevenue:14130,isDayOff:!1},{date:"2024-08-15",nonEventRevenue:23630,isDayOff:!1},{date:"2024-08-16",nonEventRevenue:10740,isDayOff:!1},{date:"2024-08-17",nonEventRevenue:6090,isDayOff:!1},{date:"2024-08-18",nonEventRevenue:0,isDayOff:!0},{date:"2024-08-19",nonEventRevenue:7500,isDayOff:!1},{date:"2024-08-20",nonEventRevenue:1860,isDayOff:!1},{date:"2024-08-21",nonEventRevenue:700,isDayOff:!1},{date:"2024-08-22",nonEventRevenue:-845,isDayOff:!1},{date:"2024-08-23",nonEventRevenue:36100,isDayOff:!1},{date:"2024-08-24",nonEventRevenue:3140,isDayOff:!1},{date:"2024-08-25",nonEventRevenue:0,isDayOff:!0},{date:"2024-08-26",nonEventRevenue:2180,isDayOff:!1},{date:"2024-08-27",nonEventRevenue:4720,isDayOff:!1},{date:"2024-08-28",nonEventRevenue:17600,isDayOff:!1},{date:"2024-08-29",nonEventRevenue:18560,isDayOff:!1},{date:"2024-08-30",nonEventRevenue:11500,isDayOff:!1},{date:"2024-08-31",nonEventRevenue:4850,isDayOff:!1}]);this.mockEmployees=S([{id:"EMP001",name:"\u738B\u5C0F\u660E",type:"full-time",monthlySalary:55e3},{id:"EMP002",name:"\u9673\u7F8E\u9E97",type:"full-time",monthlySalary:62e3},{id:"EMP003",name:"\u674E\u5927\u885B",type:"part-time",hourlyRate:200},{id:"EMP004",name:"\u5F35\u4F73\u73B2",type:"part-time",hourlyRate:200},{id:"EMP005",name:"\u9EC3\u5FD7\u5F37",type:"part-time",hourlyRate:200}]);this.mockPunchRecords=S([{employeeId:"EMP003",date:"2024-08-01",clockIn:"10:00",clockOut:"18:30",isDoublePay:!1},{employeeId:"EMP003",date:"2024-08-02",clockIn:"10:05",clockOut:"17:55",isDoublePay:!1},{employeeId:"EMP003",date:"2024-08-05",clockIn:"14:00",clockOut:"22:15",isDoublePay:!1},{employeeId:"EMP003",date:"2024-08-06",clockIn:"13:58",clockOut:"22:05",isDoublePay:!1},{employeeId:"EMP003",date:"2024-08-08",clockIn:"10:00",clockOut:"14:00",isDoublePay:!1},{employeeId:"EMP003",date:"2024-08-09",clockIn:"09:55",clockOut:"18:00",isDoublePay:!0},{employeeId:"EMP003",date:"2024-08-12",clockIn:"10:00",clockOut:"18:00",isDoublePay:!1},{employeeId:"EMP003",date:"2024-08-13",clockIn:"10:00",clockOut:"18:00",isDoublePay:!1},{employeeId:"EMP003",date:"2024-08-15",clockIn:"10:00",clockOut:null,isDoublePay:!1},{employeeId:"EMP003",date:"2024-08-16",clockIn:"14:00",clockOut:"22:00",isDoublePay:!1},{employeeId:"EMP004",date:"2024-08-01",clockIn:"18:00",clockOut:"22:00",isDoublePay:!1},{employeeId:"EMP004",date:"2024-08-03",clockIn:"18:00",clockOut:"22:30",isDoublePay:!1},{employeeId:"EMP004",date:"2024-08-07",clockIn:"17:55",clockOut:"22:01",isDoublePay:!1},{employeeId:"EMP004",date:"2024-08-10",clockIn:"17:30",clockOut:"22:30",isDoublePay:!1},{employeeId:"EMP004",date:"2024-08-14",clockIn:"18:00",clockOut:"22:00",isDoublePay:!1},{employeeId:"EMP004",date:"2024-08-17",clockIn:"18:00",clockOut:"22:00",isDoublePay:!1},{employeeId:"EMP005",date:"2024-08-20",clockIn:"12:00",clockOut:"20:00",isDoublePay:!1},{employeeId:"EMP005",date:"2024-08-21",clockIn:"12:05",clockOut:"20:08",isDoublePay:!1},{employeeId:"EMP005",date:"2024-08-22",clockIn:null,clockOut:"20:00",isDoublePay:!1},{employeeId:"EMP005",date:"2024-08-24",clockIn:"11:58",clockOut:"20:03",isDoublePay:!1}]);this.mockTransactions=S([{id:"TXN001",date:"2025-12-16",item:"\u8CA0\u50B5",category:"\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8",amount:-66350,approved:!0},{id:"TXN002",date:"2025-12-17",item:"\u71DF\u696D\u6536\u5165",category:"-\u92B7\u6216\u6298\u8B93",amount:0,approved:!0},{id:"TXN003",date:"2025-12-17",item:"\u71DF\u696D\u6536\u5165",category:"\u92B7\u8CA8\u6536\u5165",amount:1150,approved:!1},{id:"TXN004",date:"2025-12-17",item:"\u8CC7\u7522",category:"\u71DF\u696D\u8A2D\u5099",amount:-295,vendorName:"\u8766\u76AE",description:"\u53EF\u9E97\u9732\u70E4\u76E4",approved:!0},{id:"TXN005",date:"2025-12-18",item:"\u71DF\u696D\u6536\u5165",category:"-\u92B7\u6216\u6298\u8B93",amount:-2862,approved:!0},{id:"TXN006",date:"2025-12-18",item:"\u71DF\u696D\u6536\u5165",category:"\u92B7\u8CA8\u6536\u5165",amount:17440,approved:!0},{id:"TXN007",date:"2025-12-19",item:"\u71DF\u696D\u6536\u5165",category:"-\u92B7\u6216\u6298\u8B93",amount:-191,approved:!0},{id:"TXN008",date:"2025-12-19",item:"\u71DF\u696D\u8CBB\u7528",category:"\u6587\u5177\u7528\u54C1",amount:-100,vendorTaxId:"14713177",vendorName:"\u91D1\u5409\u523B\u5370\u884C",approved:!0},{id:"TXN009",date:"2025-12-19",item:"\u71DF\u696D\u8CBB\u7528",category:"\u6587\u5177\u7528\u54C1",amount:-7,invoiceNumber:"VF-79457330",vendorTaxId:"90113315",vendorName:"\u5168\u65B9\u4F4D\u6578\u4F4D\u8F38\u51FA\u6709\u9650\u516C\u53F8\u5357\u4EAC\u6771\u8DEF\u5206\u516C\u53F8",approved:!0},{id:"TXN010",date:"2025-12-19",item:"\u71DF\u696D\u8CBB\u7528",category:"\u6587\u5177\u7528\u54C1",amount:-114,invoiceNumber:"UB-05014356",vendorTaxId:"97616452",vendorName:"\u5168\u806F\u798F\u5229\u4E2D\u5FC3",approved:!1},{id:"TXN011",date:"2025-12-19",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9152\u6C34",amount:-5580,vendorName:"\u6DFB\u6F64\u6D0B\u884C",approved:!0},{id:"TXN012",date:"2025-12-19",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-189,invoiceNumber:"12170425",vendorName:"\u89AA\u6C11\u98DF\u54C1\u6709\u9650\u516C\u53F8",approved:!0},{id:"TXN013",date:"2025-12-19",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-427,vendorName:"\u6D0B\u83EF\u9BAE\u98DF\u5BE6\u696D\u6709\u9650\u516C\u53F8",approved:!0},{id:"TXN014",date:"2025-12-19",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-280,invoiceNumber:"UK88724800",vendorName:"\u958B\u5143\u98DF\u54C1\u5DE5\u696D\u80A1\u4EFD\u6709\u9650\u516C\u53F8",approved:!0},{id:"TXN015",date:"2025-12-19",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-45,invoiceNumber:"111412191194",vendorTaxId:"79997612",vendorName:"\u570B\u8C50\u5546\u884C\u6709\u9650\u516C\u53F8",approved:!0},{id:"TXN016",date:"2025-12-19",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-1874,vendorTaxId:"79997612",vendorName:"\u570B\u8C50\u5546\u884C\u6709\u9650\u516C\u53F8",approved:!0},{id:"TXN017",date:"2025-12-19",item:"\u71DF\u696D\u6536\u5165",category:"\u92B7\u8CA8\u6536\u5165",amount:9280,approved:!0},{id:"TXN018",date:"2025-12-20",item:"\u71DF\u696D\u6536\u5165",category:"-\u92B7\u6216\u6298\u8B93",amount:-4349,approved:!1},{id:"TXN019",date:"2025-12-20",item:"\u71DF\u696D\u8CBB\u7528",category:"\u6587\u5177\u7528\u54C1",amount:-240,vendorTaxId:"93138304",vendorName:"\u798F\u5BF6\u523B\u5370\u884C",approved:!0},{id:"TXN020",date:"2025-12-20",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-72,invoiceNumber:"UB-05015759",vendorTaxId:"97616452",vendorName:"\u5168\u806F\u798F\u5229\u4E2D\u5FC3",approved:!0},{id:"TXN021",date:"2025-12-20",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-568,invoiceNumber:"UB-05015750",vendorTaxId:"97616452",vendorName:"\u5168\u806F\u798F\u5229\u4E2D\u5FC3",approved:!0},{id:"TXN022",date:"2025-12-20",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-160,vendorName:"\u5E02\u5834",approved:!0},{id:"TXN023",date:"2025-12-20",item:"\u71DF\u696D\u8CBB\u7528",category:"\u62DC\u62DC\u8CBB\u7528",amount:-198,invoiceNumber:"UN-74686337",vendorTaxId:"28983777",vendorName:"7-ELEVEN",approved:!0},{id:"TXN024",date:"2025-12-20",item:"\u71DF\u696D\u6536\u5165",category:"\u92B7\u8CA8\u6536\u5165",amount:25310,approved:!0},{id:"TXN025",date:"2025-12-21",item:"\u71DF\u696D\u6536\u5165",category:"-\u92B7\u6216\u6298\u8B93",amount:-1612,approved:!0},{id:"TXN026",date:"2025-12-21",item:"\u71DF\u696D\u6536\u5165",category:"\u92B7\u8CA8\u6536\u5165",amount:14660,approved:!0},{id:"TXN027",date:"2025-12-22",item:"\u71DF\u696D\u8CBB\u7528",category:"\u8CB8\u6B3E\u5229\u606F",amount:-3824,approved:!0},{id:"TXN028",date:"2025-12-22",item:"\u71DF\u696D\u6536\u5165",category:"-\u92B7\u6216\u6298\u8B93",amount:0,approved:!0},{id:"TXN029",date:"2025-12-23",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-2020,invoiceNumber:"SO1412221261",vendorTaxId:"22161107",vendorName:"\u9F0E\u8000\u98DF\u54C1\u80A1\u4EFD\u6709\u9650\u516C\u53F8",approved:!0},{id:"TXN030",date:"2025-12-23",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-36,invoiceNumber:"UB-15207729",vendorTaxId:"97616452",vendorName:"\u5168\u806F\u798F\u5229\u4E2D\u5FC3",approved:!1},{id:"TXN031",date:"2025-12-23",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-150,invoiceNumber:"UB-15209268",vendorTaxId:"97616452",vendorName:"\u5168\u806F\u798F\u5229\u4E2D\u5FC3",approved:!0},{id:"TXN032",date:"2025-12-23",item:"\u71DF\u696D\u6536\u5165",category:"\u92B7\u8CA8\u6536\u5165",amount:2650,approved:!0}]);this.mockVendors=S([{id:"V001",category:"\u98DF\u6750",name:"\u570B\u8C50",contactInfo:"\u696D\u52D9line @926yleos",restDays:"\u516D\u3001\u65E5",taxId:"79997612"},{id:"V002",category:"\u98DF\u6750",name:"\u570B\u6210",contactInfo:"(02)8671-9056",restDays:"\u516D\u3001\u65E5"},{id:"V003",category:"\u5976\u88FD/\u96DE\u7FC5",name:"\u958B\u5143",contactInfo:"\u696D\u52D9 MR.\u8F9C 0916-250-990",restDays:"\u516D\u3001\u65E5",taxId:"UK88724800"},{id:"V004",category:"\u51B0\u6DC7\u6DCB",name:"\u5408\u7A40",contactInfo:"(03)3578-130",restDays:"\u516D\u3001\u65E5"},{id:"V005",category:"\u53EF\u980C",name:"\u89AA\u6C11",contactInfo:"(02)2999-9381",restDays:"\u516D\u3001\u65E5"},{id:"V006",category:"\u8C9D\u679C",name:"\u5E03\u6717\u4E3B\u5EDA",contactInfo:"\u696D\u52D9line @928ebhwu",restDays:"\u516D\u3001\u65E5"},{id:"V007",category:"\u86CB\u7CD5",name:"\u897F\u9EDE\u5C0F\u8216",contactInfo:"\u7DB2\u9801\u4E0B\u55AE, (02)2995-0596",restDays:"\u4E8C\u3001\u4E09\u3001\u56DB\u3001\u516D\u3001\u65E5"},{id:"V008",category:"\u9152",name:"\u5229\u591A\u5409",contactInfo:"Line",restDays:"\u65E5\u3001\u4E00"},{id:"V009",category:"\u9152",name:"\u4E5D\u6A3D",contactInfo:"(02)7728-6670",restDays:"\u516D\u3001\u65E5"},{id:"V010",category:"\u9152",name:"\u9152\u9F0E",contactInfo:"(02)2578-1515",restDays:"\u516D\u3001\u65E5"},{id:"V011",category:"\u8017\u6750",name:"\u6613\u9054\u8C50",contactInfo:"\u696D\u52D9line 0926077730",restDays:"-"},{id:"V012",category:"\u5236\u670D",name:"\u570B\u8C6A",contactInfo:"\u738B\u5730\u7FA9 0932-036356",restDays:"-"},{id:"V013",category:"\u65B9\u51B0\u584A",name:"\u5FEB\u6A02\u51B0\u584A",contactInfo:"0932-357-696",restDays:"-"},{id:"V014",category:"\u83DC\u5546",name:"\u6D25\u83EF",contactInfo:"(02)2307-5255",restDays:"-"},{id:"V015",category:"\u6536\u5EE2\u6CB9",name:"\u5C24\u52A0\u5229",contactInfo:"0909-511-256 \u6797\u5955\u9716 02-8287 5522",restDays:"\u4E8C\u4E09\u56DB\u516D\u65E5"},{id:"V016",category:"\u6536\u5EE2\u6CB9",name:"\u6C38\u745E",contactInfo:"07-6161-580 \u8521\u4F73\u6210 0965-659-532",restDays:"\u9808\u63D0\u524D\u5B89\u6392"},{id:"V017",category:"\u725B\u8C6C\u8089",name:"\u7F8E\u798F",contactInfo:"(02)8791-9688",restDays:"\u516D\u3001\u65E5, \u5207\u8089\u52A01\u5929"},{id:"V018",category:"\u5496\u5561\u8C46",name:"\u4E0A\u7FA4",contactInfo:"(02)2504-2715",restDays:"\u516D\u3001\u65E5"},{id:"V019",category:"\u6D77\u9BAE",name:"\u81FB\u7FD4",contactInfo:"(02)2223-9647",restDays:"\u65E5\u3001\u4E00"},{id:"V020",category:"\u74E6\u65AF",name:"\u9806\u5B89",contactInfo:"(02)2765-7778",restDays:"-"},{id:"V021",category:"\u5E03",name:"\u69AE\u51A0\u5462\u7D68",contactInfo:"022556-6668 \u5468\u69AE\u4E7E 0931-337-876",restDays:"-"},{id:"V022",category:"\u98DF\u6750",name:"\u9F0E\u8000",contactInfo:"APP\u4E0B\u55AE, (02) 2910-6111",restDays:"\u65E5",taxId:"22161107"},{id:"V023",category:"\u9152",name:"\u5C1A\u5FB7",contactInfo:"Line",restDays:"\u516D\u3001\u65E5"},{id:"V024",category:"\u98DF\u6750",name:"COSTCO",contactInfo:"\u81EA\u884C\u63A1\u8CB7",restDays:"-"}]);this.mockPurchaseOrders=S([{id:"PO001",poNumber:"PO-2024-001",vendorId:"V001",date:"2024-08-05",items:[{productName:"\u7279\u7D1A\u521D\u69A8\u6A44\u6B16\u6CB9",quantity:10,unitPrice:350,total:3500},{productName:"\u7FA9\u5927\u5229\u9EB5",quantity:20,unitPrice:80,total:1600}],totalAmount:5100},{id:"PO002",poNumber:"PO-2024-002",vendorId:"V009",date:"2024-08-10",items:[{productName:"\u6CE2\u723E\u591A\u7D05\u9152",quantity:12,unitPrice:800,total:9600},{productName:"\u590F\u5E03\u5229\u767D\u9152",quantity:6,unitPrice:950,total:5700}],totalAmount:15300},{id:"PO003",poNumber:"PO-2024-003",vendorId:"V017",date:"2024-08-12",items:[{productName:"\u7F8E\u570B Prime \u7D1A\u808B\u773C\u725B\u6392",quantity:5,unitPrice:1200,total:6e3}],totalAmount:6e3}]);this.mockProductCosts=S([{id:"PC001",productId:"LIQ-001",productName:"\u544A\u767D",vendorId:"V023",category:"\u9152\u6C34",itemQuantity:700,itemUnit:"ml",totalUnit:"\u74F6",price:280},{id:"PC002",productId:"LIQ-002",productName:"\u73AB\u7470\u5564\u9152",vendorId:"V023",category:"\u9152\u6C34",itemQuantity:700,itemUnit:"ml",totalUnit:"\u74F6",price:420},{id:"PC003",productId:"LIQ-003",productName:"\u6A59\u9152",vendorId:"V023",category:"\u9152\u6C34",itemQuantity:700,itemUnit:"ml",totalUnit:"\u74F6",price:520},{id:"PC004",productId:"LIQ-004",productName:"\u91D1\u8CD3\u5A01\u58EB\u5FCC",vendorId:"V023",category:"\u9152\u6C34",itemQuantity:700,itemUnit:"ml",totalUnit:"\u74F6",price:330},{id:"PC005",productId:"LIQ-005",productName:"\u7259\u8CB7\u52A0\u9EA5\u65AF\u8FA3\u59C6\u9152",vendorId:"V023",category:"\u9152\u6C34",itemQuantity:1e3,itemUnit:"ml",totalUnit:"\u74F6",price:420},{id:"PC006",productId:"LIQ-006",productName:"\u99AC\u4E01\u5C3C\u767D\u9999\u827E\u9152",vendorId:"V023",category:"\u9152\u6C34",itemQuantity:750,itemUnit:"ml",totalUnit:"\u74F6",price:420},{id:"PC007",productId:"LIQ-007",productName:"Kahkua\u5496\u5561\u5229\u53E3\u9152",vendorId:"V023",category:"\u9152\u6C34",itemQuantity:750,itemUnit:"ml",totalUnit:"\u74F6",price:430},{id:"PC013",productId:"FOD-001",productName:"\u5BAE\u4FDD\u96DE\u4E01",vendorId:"V024",category:"\u98DF\u6750",itemQuantity:1200,itemUnit:"g",totalUnit:"\u5305",price:358},{id:"PC014",productId:"FOD-002",productName:"Swiss Delice 72%\u9ED1\u5DE7\u514B\u529B",vendorId:"V024",category:"\u98DF\u6750",itemQuantity:216,itemUnit:"\u9846",totalUnit:"\u5305",price:879},{id:"PC015",productId:"FOD-003",productName:"\u5805\u679C",vendorId:"V024",category:"\u98DF\u6750",itemQuantity:1070,itemUnit:"g",totalUnit:"\u7F50",price:659},{id:"PC016",productId:"LIQ-013",productName:"\u767E\u52A0\u5F97\u862D\u59C6\u9152",vendorId:"V024",category:"\u9152\u6C34",itemQuantity:1e3,itemUnit:"ml",totalUnit:"\u74F6",price:469},{id:"PC017",productId:"LIQ-014",productName:"\u7F8E\u570B\u4F0F\u7279\u52A0",vendorId:"V024",category:"\u9152\u6C34",itemQuantity:1750,itemUnit:"ml",totalUnit:"\u74F6",price:375},{id:"PC018",productId:"LIQ-015",productName:"\u79D1\u514B\u862D\u9F8D\u820C\u862D\u9152",vendorId:"V024",category:"\u9152\u6C34",itemQuantity:1750,itemUnit:"ml",totalUnit:"\u74F6",price:769},{id:"PC019",productId:"LIQ-016",productName:"\u79D1\u514B\u862D\u7434\u9152",vendorId:"V024",category:"\u9152\u6C34",itemQuantity:1750,itemUnit:"ml",totalUnit:"\u74F6",price:495},{id:"PC020",productId:"LIQ-017",productName:"\u9AD8\u767B\u7C89\u7D05\u7434\u9152",vendorId:"V024",category:"\u9152\u6C34",itemQuantity:1e3,itemUnit:"ml",totalUnit:"\u74F6",price:549}]);this.mockWineCosts=S([{id:"W01",vendor:"\u5C1A\u5FB7",productName:"\u544A\u767D",type:"\u767D\u6C23\u6CE1",cost:280,sellingPrice:1100},{id:"W02",vendor:"\u4E5D\u6A3D",productName:"Primo Amore Moscato Delle Venezie IGT \u521D\u6200",type:"\u751C\u767D",cost:450,sellingPrice:1100},{id:"W03",vendor:"\u4E5D\u6A3D",productName:"Francois Confuron Gindre Bourgogne (2020)",type:"\u767D\u9152",cost:1150,sellingPrice:2300},{id:"W04",vendor:"\u4E5D\u6A3D",productName:"Moet & Chandon",type:"\u9999\u6AB3",cost:1650,sellingPrice:3500},{id:"W05",vendor:"\u4E5D\u6A3D",productName:"McManis Cab. Sau (2022)",type:"\u7D05\u9152",cost:550,sellingPrice:1100},{id:"W06",vendor:"\u4E5D\u6A3D",productName:"Botter Cuvee16 Limited Edition Rosso Vino 16\u6A02\u7AE0",type:"\u7D05\u9152",cost:750,sellingPrice:2200},{id:"W07",vendor:"\u4E5D\u6A3D",productName:"Saint-Estephe Calon Segur \u5361\u9686\u8CFD\u683C\u4E09\u8ECD (2015)",type:"\u7D05\u9152",cost:1350,sellingPrice:3e3},{id:"W08",vendor:"\u9152\u9F0E",productName:"Adobe Reserva Sauvignon White (2018)",type:"\u767D\u9152",cost:550,sellingPrice:1600},{id:"W09",vendor:"\u9152\u9F0E",productName:"De Martino Estate Cabernet Sauvignon (2022)",type:"\u7D05\u9152",cost:480,sellingPrice:1800},{id:"W10",vendor:"\u9152\u9F0E",productName:"Adobe Reserva Sauvignon Red (2021)",type:"\u7D05\u9152",cost:550,sellingPrice:1600},{id:"W11",vendor:"\u5409\u591A\u5229",productName:"Santero Dile Moscato sweet\u5929\u4F7F\u4E4B\u624B",type:"\u767D\u6C23\u6CE1",cost:285,sellingPrice:1100},{id:"W12",vendor:"\u5409\u591A\u5229",productName:"Louis Eschenauer 24K Carat Gold Muscat Sparkling",type:"\u767D\u6C23\u6CE1",cost:520,sellingPrice:1600},{id:"W13",vendor:"\u5409\u591A\u5229",productName:"Joly de Tr\xE9buis R\xE9serve Brut Champagne",type:"\u9999\u6AB3",cost:1100,sellingPrice:2800},{id:"W14",vendor:"\u5409\u591A\u5229",productName:"Dark Horse Cabernet Sauvignon",type:"\u7D05\u9152",cost:480,sellingPrice:1450},{id:"W15",vendor:"\u5409\u591A\u5229",productName:"Domaine Viticole de la Ville de Colmar Signature de Colmar Pinot Noir",type:"\u7D05\u9152",cost:630,sellingPrice:1600},{id:"W16",vendor:"\u6DFB\u6F64",productName:"Glendronach \u683C\u862D\u591A\u7D0D12\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1150,sellingPrice:3200},{id:"W17",vendor:"\u6DFB\u6F64",productName:"Aberlour \u4E9E\u4F2F\u6A0212\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1100,sellingPrice:3200},{id:"W18",vendor:"\u6DFB\u6F64",productName:"Laphroaig \u62C9\u4F5B\u683C10\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1050,sellingPrice:3300},{id:"W19",vendor:"\u6DFB\u6F64",productName:"Fettercairn \u8CBB\u7279\u80AF12\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1050,sellingPrice:3300},{id:"W20",vendor:"\u6DFB\u6F64",productName:"Glenfiddich \u683C\u862D\u83F2\u8FEA12\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:950,sellingPrice:3500},{id:"W21",vendor:"\u6DFB\u6F64",productName:"Balvenie \u767E\u5BCC12\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1350,sellingPrice:3800},{id:"W22",vendor:"\u6DFB\u6F64",productName:"Mortlach \u6155\u8D6B12\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1350,sellingPrice:3800},{id:"W23",vendor:"\u6DFB\u6F64",productName:"Dalmore \u5927\u646912\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1396,sellingPrice:3900},{id:"W24",vendor:"\u6DFB\u6F64",productName:"Ardbeg \u96C5\u67CF10\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1350,sellingPrice:3900},{id:"W25",vendor:"\u6DFB\u6F64",productName:"Macallan \u9EA5\u5361\u502B12\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1650,sellingPrice:4200},{id:"W26",vendor:"\u6DFB\u6F64",productName:"Hibiki \u97FF",type:"\u8ABF\u548C\u5A01\u58EB\u5FCC",cost:2300,sellingPrice:4900},{id:"W27",vendor:"\u6DFB\u6F64",productName:"Johnnie Walker \u7D04\u7FF0\u8D70\u8DEF \u9ED1\u724C 12\u5E74",type:"\u8ABF\u548C\u5A01\u58EB\u5FCC",cost:750,sellingPrice:2100},{id:"W28",vendor:"\u6DFB\u6F64",productName:"Johnnie Walker \u7D04\u7FF0\u8D70\u8DEFXR 21\u5E74",type:"\u8ABF\u548C\u5A01\u58EB\u5FCC",cost:2390,sellingPrice:4900},{id:"W29",vendor:"\u6DFB\u6F64",productName:"Royal Salute \u7687\u5BB6\u79AE\u70AE",type:"\u8ABF\u548C\u5A01\u58EB\u5FCC",cost:2500,sellingPrice:4900},{id:"W30",vendor:"\u5927\u6469",productName:"\u5927\u646915",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:2300,sellingPrice:5200},{id:"W31",vendor:"\u767E\u5BCC",productName:"\u767E\u5BCC14",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1850,sellingPrice:4200},{id:"W32",vendor:"\u6155\u8D6B",productName:"\u6155\u8D6B16",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:2300,sellingPrice:4900},{id:"W33",vendor:"\u767E\u5BCC",productName:"\u767E\u9F61\u7F4830",type:"\u8ABF\u548C\u5A01\u58EB\u5FCC",cost:7800,sellingPrice:14e3}]);this.mockCigarCosts=S([{id:"C01",brand:"Allados",productName:"Robusto",size:"5*50",quantityPerBox:20,lishengCost:340,baijiaCost:370,sellingPrice:560},{id:"C02",brand:"Allados",productName:"Toro",size:"6*52",quantityPerBox:20,lishengCost:370,baijiaCost:390,sellingPrice:780},{id:"C03",brand:"Oliva",productName:"Flor De Oliva Robusto",size:"5*50",quantityPerBox:25,lishengCost:255,baijiaCost:285,sellingPrice:520},{id:"C04",brand:"Oliva",productName:"Flor De Oliva Toro",size:"6*50",quantityPerBox:25,lishengCost:270,baijiaCost:300,sellingPrice:580},{id:"C05",brand:"Oliva",productName:"Serie O Robusto",size:"5*50",quantityPerBox:20,lishengCost:375,baijiaCost:405,sellingPrice:750},{id:"C06",brand:"Oliva",productName:"Serie O Corona",size:"6*46",quantityPerBox:20,lishengCost:335,baijiaCost:365,sellingPrice:700},{id:"C07",brand:"Oliva",productName:"Serie V Lancero",size:"7*38",quantityPerBox:24,lishengCost:415,baijiaCost:430,sellingPrice:790},{id:"C08",brand:"Oliva",productName:"Serie V Belicoso",size:"5*54",quantityPerBox:24,lishengCost:415,baijiaCost:445,sellingPrice:800},{id:"C09",brand:"Oliva",productName:"Serie V DBL.Robusto",size:"5*54",quantityPerBox:24,lishengCost:450,baijiaCost:480,sellingPrice:820},{id:"C10",brand:"Oliva",productName:"Serie V DBL. Toro",size:"6*60",quantityPerBox:24,lishengCost:520,baijiaCost:550,sellingPrice:1100},{id:"C11",brand:"Oliva",productName:"Serie V Melanio Figurado",size:"6.5*52",quantityPerBox:10,lishengCost:570,baijiaCost:670,sellingPrice:1480},{id:"C12",brand:"Oliva",productName:"Serie V Melanio Toro",size:"6.5*52",quantityPerBox:10,lishengCost:690,baijiaCost:790,sellingPrice:1600},{id:"C13",brand:"Oliva",productName:"Connecticut Res.PETIT Corona",size:"4*38",quantityPerBox:30,lishengCost:270,baijiaCost:300,sellingPrice:540},{id:"C14",brand:"Oliva",productName:"Master Blender 3 Robusto",size:"5*50",quantityPerBox:20,lishengCost:440,baijiaCost:470,sellingPrice:950},{id:"C15",brand:"Oliva",productName:"Master Blender 3 Torpedo",size:"6.5*52",quantityPerBox:10,lishengCost:490,baijiaCost:520,sellingPrice:1e3},{id:"C16",brand:"Oliva",productName:"Oliva 135\u9031\u5E74\u7D00\u5FF5",size:"5.5*54",quantityPerBox:12,lishengCost:900,baijiaCost:1e3,sellingPrice:2e3},{id:"C17",brand:"Oliva",productName:"Oliva 2024\u9F8D\u5E74\u7CFB\u5217",size:"5.5*60",quantityPerBox:10,lishengCost:900,baijiaCost:1e3,sellingPrice:2e3},{id:"C18",brand:"Oliva",productName:"Serie V Melanio Torpedo",size:"6.5*52",quantityPerBox:10,lishengCost:690,baijiaCost:790,sellingPrice:1600}]);this.itemCategoryMap={\u8CC7\u7522:["\u73FE\u91D1","\u61C9\u6536\u5E33\u6B3E","\u5B58\u8CA8-\u9910\u98F2","\u5B58\u8CA8-\u9152\u6C34","\u5B58\u8CA8-\u96EA\u8304","\u88DD\u6F62","\u62BC\u91D1","\u71DF\u696D\u8A2D\u5099"],\u8CA0\u50B5:["\u61C9\u4ED8\u5E33\u6B3E","\u61C9\u4ED8\u88DD\u6F62\u6B3E","\u61C9\u4ED8\u85AA\u8CC7","\u61C9\u4ED8\u80A1\u6771\u56DE\u994B\u91D1","\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8","\u9280\u884C\u501F\u6B3E"],\u696D\u4E3B\u6B0A\u76CA:["\u8CC7\u672C","\u696D\u4E3B\u5B58\u5165","\u696D\u4E3B\u63D0\u51FA","\u672C\u671F\u640D\u76CA"],\u71DF\u696D\u6536\u5165:["\u92B7\u8CA8\u6536\u5165","\u5176\u4ED6\u6536\u5165","-\u92B7\u6216\u6298\u8B93"],\u71DF\u696D\u8CBB\u7528:["\u85AA\u8CC7\u652F\u51FA","\u5065\u4FDD\u8CBB","\u52DE\u4FDD\u8CBB","\u56DE\u994B\u91D1\u652F\u51FA","\u79DF\u91D1\u652F\u51FA","\u4FDD\u96AA\u8CBB","\u8CB8\u6B3E\u5229\u606F","\u5EDA\u623F\u6D88\u8017\u54C1","\u6587\u5177\u7528\u54C1","\u7DB2\u8DEF\u8CBB","\u96FB\u8A71\u8CBB","\u5927\u6A13\u7BA1\u7406\u8CBB","\u6703\u8A08\u8CBB\u7528","\u734E\u91D1\u652F\u51FA","\u6C34\u8CBB","\u74E6\u65AF\u8CBB","\u96FB\u8CBB","\u50AD\u91D1\u8CBB\u7528","\u8A66\u83DC\u8CBB\u7528","\u62DC\u62DC\u8CBB\u7528","pos\u6A5F\u8CBB\u7528","\u5176\u4ED6\u8CBB\u7528","\u71DF\u696D\u7A05"]};this.mockCustomers=S([{id:"C101",name:"\u6797\u5C0F\u59D0",phone:"0912-345-678",note:"VIP\u5BA2\u6236\uFF0C\u5E38\u5BA2",gender:"\u5973\u6027",birthday:"05/20",birthYear:"1990",loyaltyPoints:1250,originStore:"\u4FE1\u7FA9\u9580\u5E02",lastCheckoutAt:"2026-01-25T15:30:00Z",isDeleted:!1},{id:"C102",name:"\u9673\u5148\u751F",phone:"0987-654-321",note:"VIP\u5BA2\u6236\uFF0C\u559C\u611B\u5A01\u58EB\u5FCC",gender:"\u7537\u6027",birthday:"11/12",birthYear:"1985",loyaltyPoints:3400,originStore:"\u4FE1\u7FA9\u9580\u5E02",lastCheckoutAt:"2026-01-23T18:45:00Z",isDeleted:!1},{id:"C103",name:"\u9EC3\u5148\u751F",phone:"0928-111-222",note:"\u559C\u611B\u7D05\u9152",gender:"\u7537\u6027",birthday:"02/28",birthYear:"1992",loyaltyPoints:320,originStore:"\u5357\u4EAC\u9580\u5E02",lastCheckoutAt:"2026-01-20T12:15:00Z",isDeleted:!1},{id:"C104",name:"\u5F35\u5C0F\u59D0",phone:"0933-444-555",note:null,gender:"\u5973\u6027",birthday:"08/08",birthYear:"1998",loyaltyPoints:880,originStore:"\u4FE1\u7FA9\u9580\u5E02",lastCheckoutAt:"2026-01-19T20:30:00Z",isDeleted:!1},{id:"C201",name:"\u5433\u5148\u751F",phone:"0955-666-777",note:"\u5B9A\u671F\u4F86\u8A2A",gender:"\u7537\u6027",birthday:"07/15",birthYear:"1988",loyaltyPoints:150,originStore:"\u6771\u9580\u9580\u5E02",lastCheckoutAt:"2026-01-18T16:00:00Z",isDeleted:!1},{id:"C202",name:"\u5289\u5C0F\u59D0",phone:"0911-222-333",note:"\u5DF2\u505C\u6B62\u670D\u52D9",gender:"\u5973\u6027",birthday:"03/30",birthYear:"1995",loyaltyPoints:0,originStore:"\u4FE1\u7FA9\u9580\u5E02",lastCheckoutAt:"2025-06-30T14:20:00Z",isDeleted:!1}]);this.mockCustomerFeedback=S([{id:"F001",customerId:"C101",date:"2026-01-21",rating:5,comment:"\u5496\u5561\u5F88\u597D\u559D\uFF0C\u751C\u9EDE\u4E5F\u5F88\u68D2\uFF0C\u74B0\u5883\u8212\u9069\u3002"},{id:"F002",customerId:"C102",date:"2026-01-10",rating:4,comment:"\u5A01\u58EB\u5FCC\u9078\u64C7\u5F88\u591A\uFF0C\u96EA\u8304\u54C1\u8CEA\u4E0D\u932F\uFF0C\u4F46\u50F9\u683C\u504F\u9AD8\u3002"},{id:"F003",customerId:"C103",date:"2026-01-15",rating:5,comment:"\u7D05\u9152\u5F88\u9806\u53E3\uFF0C\u70B8\u7269\u62FC\u76E4\u8D85\u597D\u5403\uFF01"},{id:"F004",customerId:"C101",date:"2026-01-05",rating:4,comment:"\u9910\u9EDE\u597D\u5403\uFF0C\u4F46\u6C23\u6CE1\u98F2\u7684\u6C23\u6709\u9EDE\u4E0D\u8DB3\u3002"}]);this.mockLedger2024=[{date:"2024-01-15",description:"\u7DB2\u7AD9\u958B\u767C\u5C08\u6848 - A\u516C\u53F8",category:"\u92B7\u8CA8\u6536\u5165",income:15e4,expense:0},{date:"2024-01-20",description:"\u8FA6\u516C\u5BA4\u7528\u54C1\u63A1\u8CFC",category:"\u6587\u5177\u7528\u54C1",income:0,expense:4500},{date:"2024-02-10",description:"\u8A2D\u8A08\u670D\u52D9\u8CBB - B\u5BA2\u6236",category:"\u92B7\u8CA8\u6536\u5165",income:225e3,expense:0},{date:"2024-02-22",description:"SaaS \u8EDF\u9AD4\u8A02\u95B1\u8CBB",category:"\u5176\u4ED6\u8CBB\u7528",income:0,expense:6e3},{date:"2024-03-05",description:"\u96F2\u7AEF\u4F3A\u670D\u5668\u8CBB\u7528",category:"\u7DB2\u8DEF\u8CBB",income:0,expense:9e3},{date:"2024-03-18",description:"\u7DAD\u8B77\u5408\u7D04 - C\u516C\u53F8",category:"\u92B7\u8CA8\u6536\u5165",income:186e3,expense:0},{date:"2024-04-12",description:"\u6578\u4F4D\u5EE3\u544A\u6295\u653E",category:"\u884C\u92B7\u8CBB\u7528",income:0,expense:36e3},{date:"2024-04-25",description:"App\u958B\u767C\u5C08\u6848 - D\u5BA2\u6236",category:"\u92B7\u8CA8\u6536\u5165",income:243e3,expense:0},{date:"2024-05-15",description:"\u5916\u5305\u5C08\u6848\u8CBB\u7528",category:"\u50AD\u91D1\u8CBB\u7528",income:0,expense:45e3},{date:"2024-06-20",description:"\u9867\u554F\u670D\u52D9\u8CBB",category:"\u92B7\u8CA8\u6536\u5165",income:279e3,expense:0},{date:"2024-07-01",description:"\u8FA6\u516C\u5BA4\u79DF\u91D1 - Q3",category:"\u79DF\u91D1\u652F\u51FA",income:0,expense:6e4},{date:"2024-08-10",description:"\u7CFB\u7D71\u958B\u767C - E\u516C\u53F8",category:"\u92B7\u8CA8\u6536\u5165",income:165e3,expense:0}];this.mockLedger2025=[{date:"2025-01-15",description:"\u5E74\u5EA6\u7DAD\u8B77\u5408\u7D04 - A\u516C\u53F8",category:"\u92B7\u8CA8\u6536\u5165",income:18e4,expense:0},{date:"2025-01-20",description:"\u63A1\u8CFC\u65B0\u7B46\u96FB",category:"\u71DF\u696D\u8A2D\u5099",income:0,expense:75e3},{date:"2025-02-10",description:"\u54C1\u724C\u8A2D\u8A08\u5C08\u6848 - F\u5BA2\u6236",category:"\u92B7\u8CA8\u6536\u5165",income:255e3,expense:0},{date:"2025-02-22",description:"SaaS \u8EDF\u9AD4\u8A02\u95B1\u8CBB",category:"pos\u6A5F\u8CBB\u7528",income:0,expense:7500},{date:"2025-03-05",description:"\u96F2\u7AEF\u4F3A\u670D\u5668\u8CBB\u7528",category:"\u7DB2\u8DEF\u8CBB",income:0,expense:10500},{date:"2025-04-10",description:"\u6578\u4F4D\u5EE3\u544A\u6295\u653E - Q2",category:"\u884C\u92B7\u8CBB\u7528",income:0,expense:42e3},{date:"2025-05-20",description:"ERP \u7CFB\u7D71\u5C0E\u5165 - G \u516C\u53F8",category:"\u92B7\u8CA8\u6536\u5165",income:35e4,expense:0},{date:"2025-06-15",description:"\u8FA6\u516C\u5BA4\u64F4\u5EFA\u5DE5\u7A0B",category:"\u88DD\u6F62",income:0,expense:15e4},{date:"2025-07-01",description:"\u8FA6\u516C\u5BA4\u79DF\u91D1 - Q3",category:"\u79DF\u91D1\u652F\u51FA",income:0,expense:78e3},{date:"2025-08-18",description:"\u6CD5\u5F8B\u9867\u554F\u8CBB",category:"\u6703\u8A08\u8CBB\u7528",income:0,expense:25e3},{date:"2025-09-25",description:"\u96F2\u7AEF\u5E73\u53F0\u958B\u767C - H \u5BA2\u6236",category:"\u92B7\u8CA8\u6536\u5165",income:42e4,expense:0},{date:"2025-10-05",description:"\u4F3A\u670D\u5668\u786C\u9AD4\u5347\u7D1A",category:"\u71DF\u696D\u8A2D\u5099",income:0,expense:95e3},{date:"2025-11-12",description:"\u884C\u92B7\u6D3B\u52D5\u8CBB\u7528",category:"\u884C\u92B7\u8CBB\u7528",income:0,expense:65e3},{date:"2025-12-20",description:"\u5E74\u5EA6\u734E\u91D1\u767C\u653E",category:"\u734E\u91D1\u652F\u51FA",income:0,expense:25e4}];this.mockLedger2026=[{date:"2026-06-01",description:"VIP\u5305\u5EC2\u670D\u52D9\u8CBB",category:"\u92B7\u8CA8\u6536\u5165",income:88e3,expense:0},{date:"2026-06-05",description:"\u4F01\u696D\u5305\u5834\u6D3B\u52D5",category:"\u92B7\u8CA8\u6536\u5165",income:15e4,expense:0},{date:"2026-06-10",description:"\u7CFB\u7D71\u6574\u5408\u670D\u52D9 - M \u516C\u53F8",category:"\u92B7\u8CA8\u6536\u5165",income:22e4,expense:0},{date:"2026-06-12",description:"\u5834\u5730\u79DF\u8CC3\u6536\u5165",category:"\u5176\u4ED6\u6536\u5165",income:25e3,expense:0},{date:"2026-06-15",description:"\u9867\u5BA2\u8A02\u91D1\u6C92\u6536",category:"\u5176\u4ED6\u6536\u5165",income:5e3,expense:0},{date:"2026-06-20",description:"\u719F\u5BA2\u512A\u60E0\u6298\u8B93",category:"\u92B7\u8CA8\u6298\u8B93",income:12e3,expense:0},{date:"2026-06-02",description:"\u516D\u6708\u4EFD\u8FA6\u516C\u5BA4\u79DF\u91D1",category:"\u79DF\u91D1\u652F\u51FA",income:0,expense:8e4},{date:"2026-06-02",description:"\u516D\u6708\u4EFD\u5927\u6A13\u7BA1\u7406\u8CBB",category:"\u5927\u6A13\u7BA1\u7406\u8CBB",income:0,expense:5e3},{date:"2026-06-05",description:"\u54E1\u5DE5\u85AA\u8CC7",category:"\u85AA\u8CC7\u652F\u51FA",income:0,expense:18e4},{date:"2026-06-05",description:"\u52DE\u5065\u4FDD\u8CBB\u7528",category:"\u52DE\u4FDD\u8CBB",income:0,expense:15e3},{date:"2026-06-05",description:"\u52DE\u5065\u4FDD\u8CBB\u7528",category:"\u5065\u4FDD\u8CBB",income:0,expense:18e3},{date:"2026-06-08",description:"\u6C34\u96FB\u74E6\u65AF\u8CBB",category:"\u6C34\u8CBB",income:0,expense:2500},{date:"2026-06-08",description:"\u6C34\u96FB\u74E6\u65AF\u8CBB",category:"\u96FB\u8CBB",income:0,expense:12e3},{date:"2026-06-08",description:"\u6C34\u96FB\u74E6\u65AF\u8CBB",category:"\u74E6\u65AF\u8CBB",income:0,expense:3500},{date:"2026-06-10",description:"\u96FB\u4FE1\u7DB2\u8DEF\u8CBB",category:"\u7DB2\u8DEF\u8CBB",income:0,expense:2e3},{date:"2026-06-10",description:"\u96FB\u4FE1\u7DB2\u8DEF\u8CBB",category:"\u96FB\u8A71\u8CBB",income:0,expense:1500},{date:"2026-06-12",description:"\u5EDA\u623F\u98DF\u6750\u3001\u7D19\u5DFE\u7B49\u6D88\u8017\u54C1",category:"\u5EDA\u623F\u6D88\u8017\u54C1",income:0,expense:18e3},{date:"2026-06-15",description:"\u5F71\u5370\u7D19\u3001\u7B46\u7B49\u8FA6\u516C\u7528\u54C1",category:"\u6587\u5177\u7528\u54C1",income:0,expense:3e3},{date:"2026-06-18",description:"\u884C\u92B7\u6D3B\u52D5\u50AD\u91D1",category:"\u50AD\u91D1\u8CBB\u7528",income:0,expense:22e3},{date:"2026-06-20",description:"POS\u7CFB\u7D71\u6708\u8CBB",category:"pos\u6A5F\u8CBB\u7528",income:0,expense:5e3},{date:"2026-06-21",description:"\u7AEF\u5348\u7BC0\u62DC\u62DC\u7528\u54C1",category:"\u62DC\u62DC\u8CBB\u7528",income:0,expense:2e3},{date:"2026-06-22",description:"\u65B0\u83DC\u8272\u7814\u767C\u98DF\u6750",category:"\u8A66\u83DC\u8CBB\u7528",income:0,expense:8e3},{date:"2026-06-24",description:"\u71DF\u696D\u7528\u8CA1\u7522\u4FDD\u96AA",category:"\u4FDD\u96AA\u8CBB",income:0,expense:6e3},{date:"2026-06-25",description:"\u6703\u8A08\u5E2B\u8A18\u5E33\u8CBB",category:"\u6703\u8A08\u8CBB\u7528",income:0,expense:8e3},{date:"2026-06-25",description:"\u9280\u884C\u8CB8\u6B3E\u5229\u606F",category:"\u8CB8\u6B3E\u5229\u606F",income:0,expense:12e3}];this.mockPurchases=[{date:"2024-01-18",category:"\u9152\u6C34",amount:12e3},{date:"2024-02-05",category:"\u9910\u98F2",amount:8500},{date:"2024-02-25",category:"\u96EA\u8304",amount:25e3},{date:"2024-03-12",category:"\u9152\u6C34",amount:15e3},{date:"2024-04-20",category:"\u9910\u98F2",amount:9800},{date:"2024-05-10",category:"\u96EA\u8304",amount:32e3},{date:"2024-06-22",category:"\u9152\u6C34",amount:18e3},{date:"2024-07-15",category:"\u9910\u98F2",amount:11e3},{date:"2025-01-22",category:"\u9152\u6C34",amount:16e3},{date:"2025-02-15",category:"\u96EA\u8304",amount:45e3},{date:"2025-03-01",category:"\u9910\u98F2",amount:13500},{date:"2025-04-10",category:"\u9152\u6C34",amount:22e3},{date:"2025-05-15",category:"\u9910\u98F2",amount:15e3},{date:"2025-06-20",category:"\u96EA\u8304",amount:52e3},{date:"2025-08-05",category:"\u9152\u6C34",amount:25e3},{date:"2025-10-18",category:"\u9910\u98F2",amount:18e3},{date:"2025-12-01",category:"\u96EA\u8304",amount:65e3},{date:"2026-01-20",category:"\u9152\u6C34",amount:28e3},{date:"2026-02-18",category:"\u9910\u98F2",amount:25e3},{date:"2026-03-10",category:"\u9910\u98F2",amount:21e3},{date:"2026-03-25",category:"\u96EA\u8304",amount:82e3},{date:"2026-04-25",category:"\u96EA\u8304",amount:75e3},{date:"2026-05-15",category:"\u9152\u6C34",amount:35e3},{date:"2026-06-05",category:"\u9152\u6C34",amount:32e3},{date:"2026-06-12",category:"\u9910\u98F2",amount:28e3},{date:"2026-06-20",category:"\u96EA\u8304",amount:95e3}];this.mockPOSSales=[{transactionId:"T201",customerId:"C101",date:"2026-01-05",items:[{name:"\u4E3B\u98DF",price:350,quantity:2},{name:"\u6C23\u6CE1\u98F2",price:120,quantity:2}],total:940},{transactionId:"T202",customerId:"C102",date:"2026-01-10",items:[{name:"\u5A01\u58EB\u5FCC",price:2800,quantity:1},{name:"\u96EA\u8304",price:900,quantity:2}],total:4600},{transactionId:"T203",customerId:"C103",date:"2026-01-15",items:[{name:"\u7D05\u9152/\u767D\u9152",price:1800,quantity:1},{name:"\u70B8\u7269",price:250,quantity:1}],total:2050},{transactionId:"T204",customerId:"C101",date:"2026-01-20",items:[{name:"\u5496\u5561",price:150,quantity:2},{name:"\u751C\u9EDE",price:180,quantity:2}],total:660},{transactionId:"T205",customerId:"C104",date:"2026-01-25",items:[{name:"\u6D3B\u52D5",price:13e3,quantity:1}],total:13e3},{transactionId:"T301",customerId:"C201",date:"2026-02-03",items:[{name:"\u5564\u9152",price:200,quantity:4},{name:"\u70B8\u7269",price:250,quantity:2}],total:1300},{transactionId:"T302",customerId:"C202",date:"2026-02-12",items:[{name:"\u5A01\u58EB\u5FCC",price:3200,quantity:1}],total:3200},{transactionId:"T303",customerId:"C103",date:"2026-02-18",items:[{name:"\u4E3B\u98DF",price:400,quantity:1},{name:"\u8336\u98F2",price:130,quantity:1}],total:530},{transactionId:"T304",customerId:"C201",date:"2026-02-25",items:[{name:"\u96EA\u8304",price:1200,quantity:1}],total:1200},{transactionId:"T401",customerId:"C104",date:"2026-03-05",items:[{name:"\u5834\u5730\u4F7F\u7528\u8CBB",price:4e3,quantity:1}],total:4e3},{transactionId:"T402",customerId:"C101",date:"2026-03-10",items:[{name:"\u8ABF\u9152",price:450,quantity:2},{name:"\u55AE\u9EDE",price:300,quantity:1}],total:1200},{transactionId:"T403",customerId:"C102",date:"2026-03-20",items:[{name:"\u5A01\u58EB\u5FCC",price:2500,quantity:1},{name:"\u96EA\u8304",price:850,quantity:3}],total:5050},{transactionId:"T404",customerId:"C101",date:"2026-03-28",items:[{name:"\u4E0B\u5348\u8336\u5957\u9910",price:600,quantity:2}],total:1200},{transactionId:"T501",customerId:"C104",date:"2026-04-02",items:[{name:"\u5834\u5730\u4F7F\u7528\u8CBB",price:15e3,quantity:1}],total:15e3},{transactionId:"T502",customerId:"C101",date:"2026-04-10",items:[{name:"\u4E3B\u98DF",price:380,quantity:2},{name:"\u7D05\u9152/\u767D\u9152",price:2200,quantity:1}],total:2960},{transactionId:"T503",customerId:"C103",date:"2026-04-22",items:[{name:"\u96EA\u8304",price:1100,quantity:2}],total:2200}];this.productCategoryMap=new Map([["\u5834\u5730\u4F7F\u7528\u8CBB","\u6D3B\u52D5\u5834\u5730"],["\u6D3B\u52D5","\u6D3B\u52D5\u5834\u5730"],["\u8ABF\u9152","\u9152\u6C34"],["\u7D05\u9152/\u767D\u9152","\u9152\u6C34"],["\u5564\u9152","\u9152\u6C34"],["\u5A01\u58EB\u5FCC","\u9152\u6C34"],["\u4E3B\u98DF","\u9910\u98F2"],["\u70B8\u7269","\u9910\u98F2"],["\u5976\u6614","\u9910\u98F2"],["\u6C23\u6CE1\u98F2","\u9910\u98F2"],["\u55AE\u9EDE","\u9910\u98F2"],["\u8336\u98F2","\u9910\u98F2"],["\u8C9D\u679C/\u53EF\u980C","\u9910\u98F2"],["\u5496\u5561","\u9910\u98F2"],["\u751C\u9EDE","\u9910\u98F2"],["\u6C99\u62C9","\u9910\u98F2"],["\u4E0B\u5348\u8336\u5957\u9910","\u9910\u98F2"],["\u96EA\u8304","\u96EA\u8304"]]);this.mockCostRateMap=new Map([["\u6D3B\u52D5\u5834\u5730",.1],["\u9152\u6C34",.35],["\u9910\u98F2",.25],["\u96EA\u8304",.55]]);this.mockMonthlyBalanceSheetData2026={assets:{\u73FE\u91D1:{"2026-01":-60372,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u61C9\u6536\u5E33\u6B3E:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},"\u5B58\u8CA8-\u9910\u98F2":{"2026-01":42459,"2026-02":56424,"2026-03":63318,"2026-04":53737,"2026-05":41714,"2026-06":62941,"2026-07":55331,"2026-08":57454,"2026-09":42199,"2026-10":88353,"2026-11":56195,"2026-12":70131},"\u5B58\u8CA8-\u9152\u6C34":{"2026-01":4561,"2026-02":51162,"2026-03":28630,"2026-04":51807,"2026-05":26140,"2026-06":7117,"2026-07":5707,"2026-08":23549,"2026-09":40217,"2026-10":80083,"2026-11":38428,"2026-12":13344},"\u5B58\u8CA8-\u96EA\u8304":{"2026-01":106380,"2026-02":114733,"2026-03":150810,"2026-04":112936,"2026-05":79912,"2026-06":91653,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u88DD\u6F62:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":1700030,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u62BC\u91D1:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u71DF\u696D\u8A2D\u5099:{"2026-01":20472,"2026-02":9694,"2026-03":4235,"2026-04":25624,"2026-05":25084,"2026-06":1044,"2026-07":770,"2026-08":2876,"2026-09":6678,"2026-10":25840,"2026-11":5444,"2026-12":1589}},liabilities:{\u61C9\u4ED8\u5E33\u6B3E:{"2026-01":-116791,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u61C9\u4ED8\u88DD\u6F62\u6B3E:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":-34e4,"2026-07":-34e4,"2026-08":-34e4,"2026-09":-34e4,"2026-10":-26e4,"2026-11":0,"2026-12":0},\u61C9\u4ED8\u85AA\u8CC7:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":-73145,"2026-08":-53145,"2026-09":-38145,"2026-10":0,"2026-11":-67145,"2026-12":-50145},\u61C9\u4ED8\u80A1\u6771\u56DE\u994B\u91D1:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":-21181,"2026-09":-1830,"2026-10":0,"2026-11":0,"2026-12":0},\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":-99275,"2026-07":-78270,"2026-08":-224230,"2026-09":-113975,"2026-10":-118535,"2026-11":-71145,"2026-12":-66350},\u9280\u884C\u501F\u6B3E:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":2e6,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0}},equity:{\u8CC7\u672C:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u696D\u4E3B\u5B58\u5165:{"2026-01":0,"2026-02":3e5,"2026-03":15e4,"2026-04":5e4,"2026-05":1e5,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u696D\u4E3B\u63D0\u51FA:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0}}};this.mockMonthlyIncomeStatementData2026={revenue:{\u92B7\u8CA8\u6536\u5165:{"2026-01":515140,"2026-02":347057,"2026-03":327890,"2026-04":261350,"2026-05":256858,"2026-06":187580,"2026-07":200710,"2026-08":308020,"2026-09":224550,"2026-10":504140,"2026-11":236815,"2026-12":340853},\u5176\u4ED6\u6536\u5165:{"2026-01":100,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":27677,"2026-07":636,"2026-08":25e3,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u92B7\u8CA8\u6298\u8B93:{"2026-01":-111972,"2026-02":-84928,"2026-03":-59978,"2026-04":-58915,"2026-05":-35331,"2026-06":-29417,"2026-07":-22367,"2026-08":-30058,"2026-09":-36237,"2026-10":-55599,"2026-11":-22119,"2026-12":-35978}},expenses:{\u85AA\u8CC7\u652F\u51FA:{"2026-01":-117806,"2026-02":-97814,"2026-03":-110799,"2026-04":-105507,"2026-05":-110155,"2026-06":-109977,"2026-07":-25718,"2026-08":-52922,"2026-09":-70688,"2026-10":-95017,"2026-11":-35040,"2026-12":-37492},\u5065\u4FDD\u8CBB:{"2026-01":0,"2026-02":-2368,"2026-03":-2368,"2026-04":-2368,"2026-05":-2373,"2026-06":-2368,"2026-07":-2368,"2026-08":-2368,"2026-09":-2368,"2026-10":-2368,"2026-11":-2368,"2026-12":0},\u52DE\u4FDD\u8CBB:{"2026-01":-4447,"2026-02":-8883,"2026-03":-5382,"2026-04":-15787,"2026-05":-5138,"2026-06":-4827,"2026-07":-4827,"2026-08":-4827,"2026-09":-4827,"2026-10":-4827,"2026-11":-4827,"2026-12":-4827},\u56DE\u994B\u91D1\u652F\u51FA:{"2026-01":-1654,"2026-02":-1581,"2026-03":-1623,"2026-04":-3320,"2026-05":-9792,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":-15e3,"2026-12":0},\u79DF\u91D1\u652F\u51FA:{"2026-01":-72425,"2026-02":-72425,"2026-03":-72425,"2026-04":-72425,"2026-05":-72425,"2026-06":-72425,"2026-07":-72425,"2026-08":-72410,"2026-09":-72410,"2026-10":-72410,"2026-11":-72410,"2026-12":-72410},\u4FDD\u96AA\u8CBB:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":-21297,"2026-12":0},\u8CB8\u6B3E\u5229\u606F:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":-3824,"2026-07":-3824,"2026-08":-3824,"2026-09":-3824,"2026-10":-3824,"2026-11":-3824,"2026-12":-3824},\u5EDA\u623F\u6D88\u8017\u54C1:{"2026-01":-596,"2026-02":-834,"2026-03":-79,"2026-04":-3002,"2026-05":0,"2026-06":0,"2026-07":-641,"2026-08":-300,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":-1293},\u6587\u5177\u7528\u54C1:{"2026-01":-266,"2026-02":-590,"2026-03":-1263,"2026-04":-9358,"2026-05":-149,"2026-06":-1255,"2026-07":-207,"2026-08":-953,"2026-09":-152,"2026-10":-163,"2026-11":-1989,"2026-12":-621},\u7DB2\u8DEF\u8CBB:{"2026-01":-4794,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":-4794,"2026-06":0,"2026-07":-2397,"2026-08":0,"2026-09":0,"2026-10":-2553,"2026-11":-2302,"2026-12":-1344},\u96FB\u8A71\u8CBB:{"2026-01":0,"2026-02":-334,"2026-03":-1302,"2026-04":-338,"2026-05":-369,"2026-06":-359,"2026-07":-330,"2026-08":-316,"2026-09":-328,"2026-10":-310,"2026-11":-357,"2026-12":-340},\u5927\u6A13\u7BA1\u7406\u8CBB:{"2026-01":-1400,"2026-02":-1400,"2026-03":-1400,"2026-04":0,"2026-05":0,"2026-06":-1400,"2026-07":-1400,"2026-08":0,"2026-09":0,"2026-10":-1400,"2026-11":-1400,"2026-12":0},\u6703\u8A08\u8CBB\u7528:{"2026-01":0,"2026-02":-14730,"2026-03":-4e3,"2026-04":0,"2026-05":-4162,"2026-06":0,"2026-07":-4e3,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u734E\u91D1\u652F\u51FA:{"2026-01":0,"2026-02":-3e3,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u6C34\u8CBB:{"2026-01":-709,"2026-02":0,"2026-03":-696,"2026-04":0,"2026-05":-599,"2026-06":0,"2026-07":-525,"2026-08":0,"2026-09":-578,"2026-10":0,"2026-11":-1218,"2026-12":0},\u74E6\u65AF\u8CBB:{"2026-01":-300,"2026-02":0,"2026-03":0,"2026-04":-300,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":-2100,"2026-10":-600,"2026-11":-300,"2026-12":-1540},\u96FB\u8CBB:{"2026-01":0,"2026-02":-8811,"2026-03":-807,"2026-04":0,"2026-05":0,"2026-06":-12543,"2026-07":0,"2026-08":-24358,"2026-09":0,"2026-10":-24920,"2026-11":0,"2026-12":-14417},\u50AD\u91D1\u8CBB\u7528:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":-3e3},\u8A66\u83DC\u8CBB\u7528:{"2026-01":-10530,"2026-02":-1070,"2026-03":-1403,"2026-04":0,"2026-05":0,"2026-06":-225,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u62DC\u62DC\u8CBB\u7528:{"2026-01":-3744,"2026-02":-6043,"2026-03":-1174,"2026-04":-838,"2026-05":-554,"2026-06":-1228,"2026-07":-608,"2026-08":-1258,"2026-09":-1216,"2026-10":-1216,"2026-11":-585,"2026-12":-806},pos\u6A5F\u8CBB\u7528:{"2026-01":0,"2026-02":-11700,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u5176\u4ED6\u8CBB\u7528:{"2026-01":-2030,"2026-02":-3058,"2026-03":-3570,"2026-04":0,"2026-05":-25418,"2026-06":-13010,"2026-07":-6445,"2026-08":-154,"2026-09":-1302,"2026-10":-6413,"2026-11":-1e3,"2026-12":-13126},\u71DF\u696D\u7A05:{"2026-01":0,"2026-02":0,"2026-03":-8421,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":-4915,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":-22930,"2026-12":0}}};this.mockRebateTransactions=S([{id:"RT001",shareholderName:"\u80A1\u6771 A",checkoutTime:"2024/08/01 20:30:15",discountDetails:"\u9910\u98F28\u6298",invoiceAmount:5e3,rebatePercentage:5,rebateAmount:250,discountUsed:"\u7121"},{id:"RT002",shareholderName:"\u80A1\u6771 A",checkoutTime:"2024/08/15 21:00:00",discountDetails:"\u96EA\u83049\u6298",invoiceAmount:8e3,rebatePercentage:5,rebateAmount:400,discountUsed:"\u751F\u65E5\u5238"},{id:"RT003",shareholderName:"\u80A1\u6771 B",checkoutTime:"2024/08/10 19:45:00",discountDetails:"\u5168\u55AE85\u6298",invoiceAmount:12e3,rebatePercentage:8,rebateAmount:960,discountUsed:"\u7121"}])}getFilteredLedger(e,t){let i=[...this.mockLedger2024,...this.mockLedger2025,...this.mockLedger2026];return!e&&!t?i:i.filter(r=>{let o=r.date,a=e?o>=e:!0,u=t?o<=t:!0;return a&&u})}getFilteredPurchases(e,t){return!e&&!t?this.mockPurchases:this.mockPurchases.filter(i=>{let r=i.date,o=e?r>=e:!0,a=t?r<=t:!0;return o&&a})}getFilteredPOSSales(e,t,i){let r=this.mockPOSSales;return i&&(r=r.filter(o=>o.customerId===i)),!e&&!t?r:r.filter(o=>{let a=o.date,u=e?a>=e:!0,c=t?a<=t:!0;return u&&c})}getFinancialSummary(e,t){let i=this.getFilteredLedger(e,t),r=i.filter(T=>T.category!=="\u92B7\u8CA8\u6298\u8B93").reduce((T,R)=>T+R.income,0),o=i.filter(T=>T.category==="\u92B7\u8CA8\u6298\u8B93").reduce((T,R)=>T+R.income,0),a=r-o,u=i.reduce((T,R)=>T+R.expense,0),c=a-u,h=this.getFilteredPurchases(e,t).reduce((T,R)=>T+R.amount,0),y=1e6+c,v=3e5,C=y-v;return{totalRevenue:a,totalExpenses:u,netIncome:c,totalAssets:y,totalLiabilities:v,equity:C,totalPurchases:h,totalAllowance:o}}getPOSSales(e,t,i){return this.getFilteredPOSSales(e,t,i)}getMonthlyPerformance(e,t){let i=new Map;return this.getFilteredLedger(e,t).forEach(o=>{let a=o.date.substring(0,7);i.has(a)||i.set(a,{revenue:0,expenses:0,accountsPayable:0});let u=i.get(a);o.category==="\u92B7\u8CA8\u6298\u8B93"?u.revenue-=o.income:u.revenue+=o.income,u.expenses+=o.expense,u.accountsPayable=u.expenses*.4+u.revenue*.05}),Array.from(i.keys()).sort().map(o=>V({month:o},i.get(o)))}getExpensesByCategory(e,t){let i=new Map;return this.getFilteredLedger(e,t).forEach(o=>{o.expense>0&&o.category!=="\u8CC7\u672C\u652F\u51FA"&&i.set(o.category,(i.get(o.category)||0)+o.expense)}),Array.from(i.entries()).map(([o,a])=>({category:o,amount:a}))}getPurchasesByCategory(e,t){let i=new Map;return this.getFilteredPurchases(e,t).forEach(o=>{i.set(o.category,(i.get(o.category)||0)+o.amount)}),Array.from(i.entries()).map(([o,a])=>({category:o,amount:a}))}getTopSellingProducts(e,t){let i=new Map;return this.getFilteredPOSSales(e,t).forEach(r=>{r.items.forEach(o=>{let a=i.get(o.name)||{quantitySold:0,revenue:0};a.quantitySold+=o.quantity,a.revenue+=o.price*o.quantity,i.set(o.name,a)})}),Array.from(i.entries()).map(([r,o])=>V({name:r},o)).sort((r,o)=>o.revenue-r.revenue).slice(0,5)}getFilteredPOSSalesByMonth(e,t){return!e&&!t?this.mockPOSSales:this.mockPOSSales.filter(i=>{let r=i.date.substring(0,7),o=e?r>=e:!0,a=t?r<=t:!0;return o&&a})}getAllProductsAnalysis(e,t){let i=new Map,r=this.getFilteredPOSSalesByMonth(e,t),o=r.reduce((a,u)=>a+u.total,0);return r.forEach(a=>{a.items.forEach(u=>{let c=i.get(u.name)||{quantitySold:0,revenue:0,prices:[]};c.quantitySold+=u.quantity,c.revenue+=u.price*u.quantity,c.prices.push(u.price),i.set(u.name,c)})}),i.size===0?[]:Array.from(i.entries()).map(([a,u])=>{let c=u.prices.length>0?u.prices.reduce((h,y)=>h+y,0)/u.prices.length:0,m=o>0?u.revenue/o*100:0;return{name:a,category:this.productCategoryMap.get(a)||"\u5176\u4ED6",quantitySold:u.quantitySold,revenue:u.revenue,avgPrice:c,revenueShare:m}}).sort((a,u)=>u.revenue-a.revenue)}getProductAnalysisReport(e,t){let i=this.getFilteredPOSSalesByMonth(e,t);if(i.length===0)return null;let r=[...new Set(i.map(C=>C.date.substring(0,7)))].sort(),o=new Map,a=new Map;r.forEach(C=>a.set(C,{revenue:0}));for(let C of i){let T=C.date.substring(0,7);a.get(T).revenue+=C.total;for(let R of C.items){o.has(R.name)||o.set(R.name,{category:this.productCategoryMap.get(R.name)||"\u5176\u4ED6",totalRevenue:0,totalQuantity:0,monthly:new Map});let N=o.get(R.name),F=R.price*R.quantity;N.totalRevenue+=F,N.totalQuantity+=R.quantity,N.monthly.has(T)||N.monthly.set(T,{revenue:0,quantity:0});let $=N.monthly.get(T);$.revenue+=F,$.quantity+=R.quantity}}let u=Array.from(a.values()).reduce((C,T)=>C+T.revenue,0);if(u===0)return null;let c=Array.from(o.entries()).map(([C,T])=>{let R={};for(let N of r){let F=T.monthly.get(N),$=a.get(N).revenue,q=this.mockCostRateMap.get(T.category)||0;R[N]={quantitySold:F?.quantity||0,revenue:F?.revenue||0,revenueShare:$>0?(F?.revenue||0)/$*100:0,costRate:q>0?q+(Math.random()-.5)*.1:0}}return{name:C,category:T.category,totalRevenue:T.totalRevenue,totalQuantity:T.totalQuantity,totalRevenueShare:T.totalRevenue/u*100,monthlyMetrics:R}}),m=["\u6D3B\u52D5\u5834\u5730","\u9152\u6C34","\u9910\u98F2","\u96EA\u8304"],h=[];for(let C of m){let T=c.filter($=>$.category===C).sort(($,q)=>q.totalRevenue-$.totalRevenue);if(T.length===0)continue;let R={};for(let $ of r){let q=T.reduce((le,Oe)=>le+Oe.monthlyMetrics[$].quantitySold,0),Q=T.reduce((le,Oe)=>le+Oe.monthlyMetrics[$].revenue,0),ie=a.get($).revenue,de=T.reduce((le,Oe)=>le+Oe.monthlyMetrics[$].revenue*Oe.monthlyMetrics[$].costRate,0);R[$]={quantitySold:q,revenue:Q,revenueShare:ie>0?Q/ie*100:0,costRate:Q>0?de/Q:0}}let N=T.reduce(($,q)=>$+q.totalRevenue,0),F={name:"\u5C0F\u8A08",category:C,totalRevenue:N,totalQuantity:T.reduce(($,q)=>$+q.totalQuantity,0),totalRevenueShare:N/u*100,monthlyMetrics:R};h.push({category:C,products:T,subtotal:F})}let y={};for(let C of r){let T=a.get(C).revenue,R=h.reduce((N,F)=>N+F.subtotal.monthlyMetrics[C].revenue*F.subtotal.monthlyMetrics[C].costRate,0);y[C]={quantitySold:h.reduce((N,F)=>N+F.subtotal.monthlyMetrics[C].quantitySold,0),revenue:T,revenueShare:100,costRate:T>0?R/T:0}}let v={name:"\u7E3D\u8A08",category:"",totalRevenue:u,totalQuantity:h.reduce((C,T)=>C+T.subtotal.totalQuantity,0),totalRevenueShare:100,monthlyMetrics:y};return{months:r,categoryGroups:h,grandTotal:v}}getIncomeStatement(e,t){let i=this.getFilteredLedger(e,t),r=new Map,o=new Map;i.forEach(y=>{y.income>0&&r.set(y.category,(r.get(y.category)||0)+y.income),y.expense>0&&o.set(y.category,(o.get(y.category)||0)+y.expense)});let a=r.get("\u92B7\u8CA8\u6536\u5165")||0,u=r.get("\u5176\u4ED6\u6536\u5165")||0,c=r.get("\u92B7\u8CA8\u6298\u8B93")||0,m={items:[{account:"\u92B7\u8CA8\u6536\u5165",amount:a},{account:"\u5176\u4ED6\u6536\u5165",amount:u},{account:"\u92B7\u8CA8\u6298\u8B93",amount:-c}],total:a+u-c},h={items:Array.from(o.entries()).map(([y,v])=>({account:y,amount:v})).sort((y,v)=>v.amount-y.amount),total:Array.from(o.values()).reduce((y,v)=>y+v,0)};return{operatingRevenue:m,operatingExpenses:h,netIncome:m.total-h.total}}getBalanceSheet(e,t){let i=this.getIncomeStatement(e,t),r=i.netIncome,o=this.getFilteredPurchases(e,t),u={items:[{account:"\u73FE\u91D1",amount:5e5+r},{account:"\u61C9\u6536\u5E33\u6B3E",amount:i.operatingRevenue.total*.15},{account:"\u5B58\u8CA8-\u9910\u98F2",amount:o.filter(C=>C.category==="\u9910\u98F2").reduce((C,T)=>C+T.amount,0)*.4},{account:"\u5B58\u8CA8-\u9152\u6C34",amount:o.filter(C=>C.category==="\u9152\u6C34").reduce((C,T)=>C+T.amount,0)*.5},{account:"\u5B58\u8CA8-\u96EA\u8304",amount:o.filter(C=>C.category==="\u96EA\u8304").reduce((C,T)=>C+T.amount,0)*.6},{account:"\u88DD\u6F62",amount:12e5},{account:"\u62BC\u91D1",amount:15e4},{account:"\u71DF\u696D\u8A2D\u5099",amount:45e4}],total:0};u.total=u.items.reduce((C,T)=>C+T.amount,0);let c={items:[{account:"\u61C9\u4ED8\u5E33\u6B3E",amount:i.operatingExpenses.total*.3},{account:"\u61C9\u4ED8\u88DD\u6F62\u6B3E",amount:25e4},{account:"\u61C9\u4ED8\u85AA\u8CC7",amount:45e3},{account:"\u61C9\u4ED8\u80A1\u6771\u56DE\u994B\u91D1",amount:15e3},{account:"\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8",amount:35e3},{account:"\u9280\u884C\u501F\u6B3E",amount:8e5}],total:0};c.total=c.items.reduce((C,T)=>C+T.amount,0);let m={items:[{account:"\u8CC7\u672C",amount:1e6},{account:"\u696D\u4E3B\u5B58\u5165",amount:5e4},{account:"\u696D\u4E3B\u63D0\u51FA",amount:-2e4},{account:"\u672C\u671F\u640D\u76CA",amount:r}],total:0};m.total=m.items.reduce((C,T)=>C+T.amount,0);let h=c.total+m.total,y=u.total-h,v=m.items.find(C=>C.account==="\u8CC7\u672C");return v&&(v.amount+=y,m.total+=y),{assets:u,liabilities:c,equity:m,totalLiabilitiesAndEquity:u.total}}getMonthlyBalanceSheetReport(e,t){if(e!==2026)return null;let i=this.mockMonthlyBalanceSheetData2026,r=`${e}-`,o=Array.from({length:12},(C,T)=>r+String(T+1).padStart(2,"0")),a;if(t==="all")a=o;else{let C=(t-1)*3+1;a=o.slice(C-1,C+2)}let u=C=>{let T=[],R={};for(let F in C){let $=C[F],q=$[a[a.length-1]]||0;T.push({account:F,monthlyAmounts:$,total:q,percentage:0})}for(let F of o)R[F]=T.reduce(($,q)=>$+(q.monthlyAmounts[F]||0),0);let N=R[a[a.length-1]]||0;return{items:T,monthlyTotals:R,grandTotal:N}},c=u(i.assets),m=u(i.liabilities),h=u(i.equity);c.grandTotal!==0&&c.items.forEach(C=>C.percentage=C.total/c.grandTotal*100);let y=m.grandTotal+h.grandTotal;y!==0&&(m.items.forEach(C=>C.percentage=C.total/y*100),h.items.forEach(C=>C.percentage=C.total/y*100));let v={items:[],monthlyTotals:{},grandTotal:y};for(let C of o)v.monthlyTotals[C]=(m.monthlyTotals[C]||0)+(h.monthlyTotals[C]||0);return{months:a,assets:c,liabilities:m,equity:h,totalLiabilitiesAndEquity:v}}getMonthlyIncomeStatementReport(e,t){if(e!==2026)return null;let i=this.mockMonthlyIncomeStatementData2026,r=`${e}-`,o=Array.from({length:12},(y,v)=>r+String(v+1).padStart(2,"0")),a;if(t==="all")a=o;else{let y=(t-1)*3+1;a=o.slice(y-1,y+2)}let u=y=>{let v=[],C={};for(let R in y){let N=y[R],F=a.reduce(($,q)=>$+(N[q]||0),0);v.push({account:R,monthlyAmounts:N,total:F,percentage:0})}for(let R of o)C[R]=v.reduce((N,F)=>N+(F.monthlyAmounts[R]||0),0);let T=a.reduce((R,N)=>R+(C[N]||0),0);return T!==0&&v.forEach(R=>R.percentage=R.total/T*100),{items:v,monthlyTotals:C,grandTotal:T}},c=u(i.revenue),m=u(i.expenses),h={monthlyTotals:{},grandTotal:c.grandTotal+m.grandTotal};for(let y of o)h.monthlyTotals[y]=(c.monthlyTotals[y]||0)+(m.monthlyTotals[y]||0);return{months:a,operatingRevenue:c,operatingExpenses:m,netIncome:h}}getTransactions(e){let t=this.mockTransactions();if(e.startDate&&(t=t.filter(i=>i.date>=e.startDate)),e.endDate&&(t=t.filter(i=>i.date<=e.endDate)),e.item&&(t=t.filter(i=>i.item===e.item)),e.category&&(t=t.filter(i=>i.category===e.category)),e.vendorName&&(t=t.filter(i=>i.vendorName===e.vendorName)),e.description){let i=e.description.toLowerCase();t=t.filter(r=>r.description?.toLowerCase().includes(i))}return t}addTransaction(e){let t=G(V({},e),{id:`TXN${Date.now()}`});this.mockTransactions.update(i=>[...i,t])}updateTransaction(e){this.mockTransactions.update(t=>t.map(i=>i.id===e.id?e:i))}getLedgerFilterOptions(){let e=this.mockTransactions(),t=[...new Set(e.map(o=>o.item))],i=[...new Set(e.map(o=>o.category))],r=[...new Set(e.map(o=>o.vendorName).filter(o=>!!o))];return{items:t.sort(),categories:i.sort(),vendorNames:r.sort()}}getEvents(){return this.mockEvents()}getEventById(e){return this.mockEvents().find(t=>t.id===e)}addEvent(e){let t=G(V({},e),{id:`EVT${Date.now()}`});this.mockEvents.update(i=>[...i,t])}updateEvent(e){this.mockEvents.update(t=>t.map(i=>i.id===e.id?e:i))}deleteEvent(e){this.mockEvents.update(t=>t.filter(i=>i.id!==e))}getDailyRevenueReport(e,t){let i=new Date(e,t-1,1),o=new Date(e,t,0).getDate(),a=`${e}-${String(t).padStart(2,"0")}`,u=[];for(let c=1;c<=o;c++){let m=`${a}-${String(c).padStart(2,"0")}`,h=this.mockDailyRevenue().find(R=>R.date===m)||{date:m,nonEventRevenue:0,isDayOff:!1},y=this.mockEvents().filter(R=>R.date===m&&R.status==="active"),v=y.reduce((R,N)=>R+N.actualRevenue,0),C=h.nonEventRevenue+v,T=y.map(R=>R.name);u.push({day:c,date:m,isDayOff:h.isDayOff,totalDailyRevenue:C,eventRevenue:v,eventNames:T})}return u}getDailyRevenueEntryByDate(e){return this.mockDailyRevenue().find(t=>t.date===e)||{date:e,nonEventRevenue:0,isDayOff:!1}}updateDailyRevenueEntry(e,t){this.mockDailyRevenue.update(i=>{let r=i.findIndex(o=>o.date===e);if(r>-1){let o=[...i];return o[r]=V(V({},o[r]),t),o}else return[...i,{date:e,nonEventRevenue:t.nonEventRevenue??0,isDayOff:t.isDayOff??!1}]})}getEmployees(e){let t=this.mockEmployees();return e?t.filter(i=>i.type===e):t}getEmployeeById(e){return this.mockEmployees().find(t=>t.id===e)}getPayrollSummary(e,t){let i=this.getEmployees("full-time"),r=this.getEmployees("part-time"),o=`${e}-${String(t).padStart(2,"0")}`,a=i.reduce((m,h)=>m+(h.monthlySalary||0),0),u=r.map(m=>{let h=this.mockPunchRecords().filter(T=>T.employeeId===m.id&&T.date.startsWith(o)),y=0,v=0,C=!1;return h.forEach(T=>{if(!T.clockIn||!T.clockOut){C=!0;return}let[R,N]=T.clockIn.split(":").map(Number),[F,$]=T.clockOut.split(":").map(Number),q=new Date(0,0,0,R,N),Q=new Date(0,0,0,F,$);if(Q<q)return;let de=(Q.getTime()-q.getTime())/(1e3*60)/60,le=Math.floor(de*100)/100;y+=le;let Oe=le*(m.hourlyRate||0);T.isDoublePay&&(Oe*=2),v+=Oe}),{employeeId:m.id,name:m.name,totalHours:y,totalPay:v,hasMissingPunch:C}}),c=u.reduce((m,h)=>m+h.totalPay,0);return{fullTimePayroll:a,partTimePayroll:c,partTimeDetails:u}}getPunchRecordsForMonth(e,t,i){let r=`${t}-${String(i).padStart(2,"0")}`;return this.mockPunchRecords().filter(o=>o.employeeId===e&&o.date.startsWith(r))}updatePunchRecords(e,t,i,r){let o=`${t}-${String(i).padStart(2,"0")}`;this.mockPunchRecords.update(a=>{let u=a.filter(m=>!(m.employeeId===e&&m.date.startsWith(o))),c=r.filter(m=>m.clockIn||m.clockOut);return[...u,...c]})}getVendors(){return this.mockVendors()}addVendor(e){let t=G(V({},e),{id:`V${Date.now()}`});this.mockVendors.update(i=>[...i,t])}updateVendor(e){this.mockVendors.update(t=>t.map(i=>i.id===e.id?e:i))}deleteVendor(e){this.mockVendors.update(t=>t.filter(i=>i.id!==e))}getPurchaseOrders(){return this.mockPurchaseOrders()}addPurchaseOrder(e){let t=G(V({},e),{id:`PO${Date.now()}`});this.mockPurchaseOrders.update(i=>[...i,t])}updatePurchaseOrder(e){this.mockPurchaseOrders.update(t=>t.map(i=>i.id===e.id?e:i))}deletePurchaseOrder(e){this.mockPurchaseOrders.update(t=>t.filter(i=>i.id!==e))}getProductCosts(){return this.mockProductCosts()}addProductCost(e){let t=G(V({},e),{id:`PC${Date.now()}`});this.mockProductCosts.update(i=>[...i,t])}updateProductCost(e){this.mockProductCosts.update(t=>t.map(i=>i.id===e.id?e:i))}deleteProductCost(e){this.mockProductCosts.update(t=>t.filter(i=>i.id!==e))}getCigarCosts(){return this.mockCigarCosts()}addCigarCost(e){let t=G(V({},e),{id:`C${Date.now()}`});this.mockCigarCosts.update(i=>[...i,t])}updateCigarCost(e){this.mockCigarCosts.update(t=>t.map(i=>i.id===e.id?e:i))}deleteCigarCost(e){this.mockCigarCosts.update(t=>t.filter(i=>i.id!==e))}getWineCosts(){return this.mockWineCosts()}addWineCost(e){let t=G(V({},e),{id:`W${Date.now()}`});this.mockWineCosts.update(i=>[...i,t])}updateWineCost(e){this.mockWineCosts.update(t=>t.map(i=>i.id===e.id?e:i))}deleteWineCost(e){this.mockWineCosts.update(t=>t.filter(i=>i.id!==e))}getCustomers(){return this.mockCustomers()}getFeedbackForCustomer(e){return this.mockCustomerFeedback().filter(t=>t.customerId===e)}getAnnualSummaryReport(e,t){let i=Array.from({length:t-e+1},(a,u)=>e+u),r={years:i,revenue:{total:0},expense:{total:0},net:{total:0},unpaid:{total:0}},o=[...this.mockLedger2024,...this.mockLedger2025,...this.mockLedger2026];return i.forEach(a=>{let u=o.filter(v=>v.date.startsWith(a.toString())),c=u.filter(v=>v.category!=="\u92B7\u8CA8\u6298\u8B93").reduce((v,C)=>v+C.income,0),m=u.filter(v=>v.category==="\u92B7\u8CA8\u6298\u8B93").reduce((v,C)=>v+C.income,0),h=c-m,y=u.reduce((v,C)=>v+C.expense,0);r.revenue[a]=h,r.expense[a]=y,r.net[a]=h-y,r.unpaid[a]=y*.15}),r.revenue.total=i.reduce((a,u)=>a+r.revenue[u],0),r.expense.total=i.reduce((a,u)=>a+r.expense[u],0),r.net.total=i.reduce((a,u)=>a+r.net[u],0),r.unpaid.total=i.reduce((a,u)=>a+r.unpaid[u],0),r}getMonthlyDetail(e,t){let i=e.toString(),o=[...this.mockLedger2024,...this.mockLedger2025,...this.mockLedger2026].filter(u=>u.date.startsWith(i)),a={year:e,type:t==="unpaid"?"\u672A\u4ED8":t==="revenue"?"\u6536\u5165":"\u652F\u51FA",data:[]};for(let u=1;u<=12;u++){let c=`${i}-${String(u).padStart(2,"0")}`,m=o.filter(v=>v.date?.startsWith(c));if(m.length===0)continue;let h=0,y=new Map;t==="revenue"?m.forEach(v=>{if(v.income>0){let C=v.category==="\u92B7\u8CA8\u6298\u8B93"?-v.income:v.income;y.set(v.category,(y.get(v.category)||0)+C),h+=C}}):t==="expense"?m.forEach(v=>{v.expense>0&&(y.set(v.category,(y.get(v.category)||0)+v.expense),h+=v.expense)}):(h=m.reduce((C,T)=>C+T.expense,0)*.15,y.set("\u61C9\u4ED8\u5E33\u6B3E",h*.7),y.set("\u61C9\u4ED8\u85AA\u8CC7",h*.3)),a.data.push({month:u,total:h,items:Array.from(y.entries()).map(([v,C])=>({name:v,amount:C}))})}return a.data.length>0?a:null}getProductGrossMarginReport(e,t){let i={dining:{totalPurchases:5e4,totalSales:15e4,grossMargin:1e5,grossMarginRate:.66},drinks:{totalPurchases:8e4,totalSales:2e5,grossMargin:12e4,grossMarginRate:.6},cigars:{totalPurchases:12e4,totalSales:22e4,grossMargin:1e5,grossMarginRate:.45},venue:{totalPurchases:1e4,totalSales:8e4,grossMargin:7e4,grossMarginRate:.875},total:{totalPurchases:26e4,totalSales:65e4,grossMargin:39e4,grossMarginRate:.6}},r=[],o=new Date(e.replace("/","-")+"-01"),a=new Date(t.replace("/","-")+"-01");for(;o<=a;){let u=5e4+Math.random()*2e4,c=6e4+Math.random()*3e4,m=7e4+Math.random()*4e4,h=2e4+Math.random()*1e4;r.push({month:`${o.getFullYear()}/${String(o.getMonth()+1).padStart(2,"0")}`,dining:u,drinks:c,cigars:m,venue:h,total:u+c+m+h}),o.setMonth(o.getMonth()+1)}return{summary:i,monthlySales:r}}getShareholderRebates(e,t){return[{name:"\u80A1\u6771 A",currentMonthRebate:650,unpaidRebate:1500,cumulativeRebate:8500},{name:"\u80A1\u6771 B",currentMonthRebate:960,unpaidRebate:500,cumulativeRebate:12e3},{name:"\u80A1\u6771 C",currentMonthRebate:200,unpaidRebate:2200,cumulativeRebate:5500}]}getMonthlyRebateHistory(e){return[{year:2024,month:8,totalRebate:650,unpaidRebate:0},{year:2024,month:7,totalRebate:850,unpaidRebate:850},{year:2024,month:6,totalRebate:500,unpaidRebate:0}].filter(t=>t.totalRebate>0)}getRebateTransactions(e,t,i){let r=`${t}/${String(i).padStart(2,"0")}`;return this.mockRebateTransactions().filter(o=>o.shareholderName===e&&o.checkoutTime.startsWith(r))}updateRebateTransaction(e){this.mockRebateTransactions.update(t=>t.map(i=>i.id===e.id?G(V({},e),{isEdited:!0}):i))}getTargetGoals(){return this.mockTargetGoals()}addTargetGoal(e){let t=G(V({},e),{id:`TG${Date.now()}`});this.mockTargetGoals.update(i=>[...i,t])}updateTargetGoal(e){this.mockTargetGoals.update(t=>t.map(i=>i.id===e.id?e:i))}deleteTargetGoal(e){this.mockTargetGoals.update(t=>t.filter(i=>i.id!==e))}};_o.\u0275fac=function(t){return new(t||_o)},_o.\u0275prov=Z({token:_o,factory:_o.\u0275fac,providedIn:"root"});var Bt=_o;var W7=["mainCategoryChart"],j7=["diningChart"],z7=["drinksChart"],Y7=["monthlyTrendChart"],J7=(n,e)=>e.month;function K7(n,e){if(n&1&&(l(0,"option",13),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),k("",t,"\u5E74")}}function Q7(n,e){if(n&1&&(l(0,"option",13),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),k("",t,"\u6708")}}function Z7(n,e){if(n&1&&(l(0,"option",13),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),k("",t,"\u5E74")}}function X7(n,e){if(n&1&&(l(0,"option",13),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),k("",t,"\u6708")}}function eV(n,e){if(n&1){let t=B();l(0,"div",4)(1,"div",10)(2,"label",11),d(3,"\u5F9E:"),s(),l(4,"select",12),b("ngModelChange",function(r){D(t);let o=_();return w(o.selectedStartYear.set(r))}),O(5,K7,2,2,"option",13,j),s(),l(7,"select",12),b("ngModelChange",function(r){D(t);let o=_();return w(o.selectedStartMonth.set(r))}),O(8,Q7,2,2,"option",13,j),s()(),l(10,"div",10)(11,"label",11),d(12,"\u81F3:"),s(),l(13,"select",12),b("ngModelChange",function(r){D(t);let o=_();return w(o.selectedEndYear.set(r))}),O(14,Z7,2,2,"option",13,j),s(),l(16,"select",12),b("ngModelChange",function(r){D(t);let o=_();return w(o.selectedEndMonth.set(r))}),O(17,X7,2,2,"option",13,j),s()(),l(19,"div",14)(20,"button",15),b("click",function(){D(t);let r=_();return w(r.applyAnalysisFilter())}),x(21,"ion-icon",16),l(22,"span"),d(23,"\u5957\u7528"),s()(),l(24,"button",17),b("click",function(){D(t);let r=_();return w(r.resetAnalysisFilter())}),x(25,"ion-icon",18),s()()()}if(n&2){let t=_();f(4),I("ngModel",t.selectedStartYear()),f(),L(t.analysisYears()),f(2),I("ngModel",t.selectedStartMonth()),f(),L(t.analysisMonths()),f(5),I("ngModel",t.selectedEndYear()),f(),L(t.analysisYears()),f(2),I("ngModel",t.selectedEndMonth()),f(),L(t.analysisMonths())}}function tV(n,e){if(n&1&&(l(0,"option",13),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),k("",t,"\u5E74")}}function nV(n,e){if(n&1&&(l(0,"option",13),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),k("",t,"\u6708")}}function iV(n,e){if(n&1&&(l(0,"option",13),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),k("",t,"\u5E74")}}function rV(n,e){if(n&1&&(l(0,"option",13),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),k("",t,"\u6708")}}function oV(n,e){if(n&1){let t=B();l(0,"div",4)(1,"div",10)(2,"label",11),d(3,"\u5F9E:"),s(),l(4,"select",12),J("ngModelChange",function(r){D(t);let o=_();return K(o.selectedMarginStartYear,r)||(o.selectedMarginStartYear=r),w(r)}),O(5,tV,2,2,"option",13,j),s(),l(7,"select",12),J("ngModelChange",function(r){D(t);let o=_();return K(o.selectedMarginStartMonth,r)||(o.selectedMarginStartMonth=r),w(r)}),O(8,nV,2,2,"option",13,j),s()(),l(10,"div",10)(11,"label",11),d(12,"\u81F3:"),s(),l(13,"select",12),J("ngModelChange",function(r){D(t);let o=_();return K(o.selectedMarginEndYear,r)||(o.selectedMarginEndYear=r),w(r)}),O(14,iV,2,2,"option",13,j),s(),l(16,"select",12),J("ngModelChange",function(r){D(t);let o=_();return K(o.selectedMarginEndMonth,r)||(o.selectedMarginEndMonth=r),w(r)}),O(17,rV,2,2,"option",13,j),s()(),l(19,"div",14)(20,"button",15),b("click",function(){D(t);let r=_();return w(r.applyMarginFilter())}),x(21,"ion-icon",16),l(22,"span"),d(23,"\u5957\u7528"),s()(),l(24,"button",17),b("click",function(){D(t);let r=_();return w(r.resetMarginFilter())}),x(25,"ion-icon",18),s()()()}if(n&2){let t=_();f(4),Y("ngModel",t.selectedMarginStartYear),f(),L(t.marginYears()),f(2),Y("ngModel",t.selectedMarginStartMonth),f(),L(t.marginAllMonths()),f(5),Y("ngModel",t.selectedMarginEndYear),f(),L(t.marginYears()),f(2),Y("ngModel",t.selectedMarginEndMonth),f(),L(t.marginAllMonths())}}function aV(n,e){n&1&&(l(0,"div",19)(1,"h3",20),d(2,"\u6708\u92B7\u552E\u8DA8\u52E2"),s(),l(3,"div",26),x(4,"canvas",null,0),s()())}function sV(n,e){n&1&&(l(0,"div",22)(1,"div",27),x(2,"div",28),l(3,"p",29),d(4,"\u8F09\u5165\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u4E2D..."),s()()())}function lV(n,e){if(n&1&&(l(0,"div",23)(1,"div",30),x(2,"ion-icon",31),l(3,"div",32)(4,"p",33),d(5,"\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u8F09\u5165\u5931\u6557"),s(),l(6,"div",34),d(7),s()()(),l(8,"div",35),d(9," \u{1F4A1} \u63D0\u793A\uFF1A\u76EE\u524D\u8CC7\u6599\u5EAB\u4E2D\u53EA\u6709 "),l(10,"strong"),d(11,"2024-2025 \u5E74"),s(),d(12,"\u7684\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u3002 "),s()()),n&2){let t=_(2);f(7),k(" ",t.productSalesError()," ")}}function uV(n,e){if(n&1&&(l(0,"th",40),d(1),s()),n&2){let t=e.$implicit,i=_(3);f(),E(i.formatMonth(t))}}function dV(n,e){n&1&&(l(0,"th",44),d(1,"\u92B7\u552E\u91CF"),s(),l(2,"th",45),d(3,"\u71DF\u696D\u984D"),s(),l(4,"th",45),d(5,"\u71DF\u696D\u984D\u4F54\u6BD4"),s())}function cV(n,e){if(n&1&&(l(0,"td",49),d(1),s()),n&2){let t=_().$implicit;W("bg-yellow-50",t.isSubtotal)("bg-red-100",t.isTotal)("bg-white",!t.isSubtotal&&!t.isTotal),f(),k(" ",t.category," ")}}function mV(n,e){n&1&&x(0,"td",47)}function pV(n,e){if(n&1&&(l(0,"td",50),d(1),s(),l(2,"td",50),d(3),s(),l(4,"td",50),d(5),s()),n&2){let t=e.$implicit,i=_().$implicit,r=_(3);f(),E((i.monthlyData[t]==null?null:i.monthlyData[t].sales)||0),f(2),E(r.formatCurrency((i.monthlyData[t]==null?null:i.monthlyData[t].revenue)||0)),f(2),k("",((i.monthlyData[t]==null?null:i.monthlyData[t].rate)||0).toFixed(2),"%")}}function fV(n,e){if(n&1&&(l(0,"tr"),M(1,cV,2,7,"td",46)(2,mV,1,0,"td",47),l(3,"td",48),d(4),s(),O(5,pV,6,3,null,null,j),s()),n&2){let t=e.$implicit,i=_(3);De(t.isSubtotal?"bg-yellow-50 font-semibold":t.isTotal?"bg-red-100 font-bold":"hover:bg-gray-50"),f(),A(!t.item||t.item==="\u5C0F\u8A08"||t.item==="\u7E3D\u8A08"?1:2),f(2),W("bg-yellow-50",t.isSubtotal)("bg-red-100",t.isTotal)("bg-white",!t.isSubtotal&&!t.isTotal),f(),k(" ",t.item||t.category," "),f(),L(i.monthlySalesData().months)}}function gV(n,e){if(n&1&&(l(0,"div",24)(1,"table",36)(2,"thead",37)(3,"tr")(4,"th",38),d(5,"\u5206\u985E"),s(),l(6,"th",39),d(7,"\u54C1\u9805"),s(),O(8,uV,2,1,"th",40,j),s(),l(10,"tr"),x(11,"th",41)(12,"th",42),O(13,dV,6,0,null,null,j),s()(),l(15,"tbody"),O(16,fV,7,10,"tr",43,Sn),s()()()),n&2){let t=_(2);f(8),L(t.monthlySalesData().months),f(5),L(t.monthlySalesData().months),f(3),L(t.monthlySalesData().data)}}function hV(n,e){n&1&&(l(0,"div",25)(1,"p",51),d(2,"\u672A\u627E\u5230\u5546\u54C1\u92B7\u552E\u8CC7\u6599"),s(),l(3,"p",52),d(4,"\u8ACB\u9078\u64C7\u6642\u9593\u7BC4\u570D\u4E26\u5957\u7528\u7BE9\u9078"),s()())}function yV(n,e){if(n&1&&(l(0,"div",1),M(1,aV,6,0,"div",19),l(2,"div")(3,"h3",20),d(4,"\u5546\u54C1\u92B7\u552E\u660E\u7D30\u8868"),s(),l(5,"div",21),M(6,sV,5,0,"div",22),M(7,lV,13,1,"div",23),M(8,gV,18,0,"div",24),M(9,hV,5,0,"div",25),s()()()),n&2){let t=_();f(),A(!t.isLoadingProductSales()&&t.productSalesData().length>0?1:-1),f(5),A(t.isLoadingProductSales()?6:-1),f(),A(t.productSalesError()?7:-1),f(),A(!t.isLoadingProductSales()&&t.monthlySalesData().data.length>0?8:-1),f(),A(!t.isLoadingProductSales()&&t.monthlySalesData().data.length===0&&!t.productSalesError()?9:-1)}}function _V(n,e){n&1&&(l(0,"div",22)(1,"div",27),x(2,"div",28),l(3,"p",29),d(4,"\u8F09\u5165\u5546\u54C1\u6BDB\u5229\u8CC7\u6599\u4E2D..."),s()()())}function vV(n,e){if(n&1&&(l(0,"div",23)(1,"div",30),x(2,"ion-icon",31),l(3,"div",32)(4,"p",33),d(5,"\u5546\u54C1\u6BDB\u5229\u8CC7\u6599\u8F09\u5165\u5931\u6557"),s(),l(6,"div",34),d(7),s()()(),l(8,"div",35),d(9," \u{1F4A1} \u63D0\u793A\uFF1A\u76EE\u524D\u8CC7\u6599\u5EAB\u4E2D\u53EA\u6709 "),l(10,"strong"),d(11,"2024-2025 \u5E74"),s(),d(12,"\u7684\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u3002 "),s()()),n&2){let t=_(2);f(7),k(" ",t.marginDataError()," ")}}function CV(n,e){if(n&1&&(l(0,"tr",64)(1,"td",65),d(2),s(),l(3,"td"),d(4),s(),l(5,"td"),d(6),s(),l(7,"td"),d(8),s(),l(9,"td"),d(10),s(),l(11,"td",66),d(12),s()()),n&2){let t=e.$implicit,i=_(3);f(2),E(t.month),f(2),E(i.formatCurrency(t.dining)),f(2),E(i.formatCurrency(t.drinks)),f(2),E(i.formatCurrency(t.cigars)),f(2),E(i.formatCurrency(t.venue)),f(2),E(i.formatCurrency(t.total))}}function xV(n,e){n&1&&(l(0,"tr")(1,"td",67),d(2,"\u6B64\u6642\u9593\u5340\u9593\u7121\u8CC7\u6599\u3002"),s()())}function bV(n,e){if(n&1&&(l(0,"div",21)(1,"table",53)(2,"thead",54)(3,"tr",55),x(4,"th",56),l(5,"th",57),d(6,"\u9910\u98F2"),s(),l(7,"th",57),d(8,"\u9152\u6C34"),s(),l(9,"th",57),d(10,"\u96EA\u8304(\u542B\u61C9\u4ED8)"),s(),l(11,"th",57),d(12,"\u6D3B\u52D5\u5834\u5730"),s(),l(13,"th",57),d(14,"\u5C0F\u8A08"),s()()(),l(15,"tbody")(16,"tr",58)(17,"td",59),d(18,"\u9032\u8CA8\u7E3D\u8A08"),s(),l(19,"td"),d(20),s(),l(21,"td"),d(22),s(),l(23,"td"),d(24),s(),l(25,"td",60),d(26,"--"),s(),l(27,"td",61),d(28),s()(),l(29,"tr",58)(30,"td",59),d(31,"\u92B7\u8CA8\u7E3D\u8A08(\u6263\u6298\u8B93)"),s(),l(32,"td"),d(33),s(),l(34,"td"),d(35),s(),l(36,"td"),d(37),s(),l(38,"td"),d(39),s(),l(40,"td",61),d(41),s()(),l(42,"tr",62)(43,"td",59),d(44,"\u6BDB\u5229"),s(),l(45,"td"),d(46),s(),l(47,"td"),d(48),s(),l(49,"td"),d(50),s(),l(51,"td",60),d(52,"--"),s(),l(53,"td",61),d(54),s()(),l(55,"tr",63)(56,"td",59),d(57,"\u6BDB\u5229\u7387"),s(),l(58,"td"),d(59),s(),l(60,"td"),d(61),s(),l(62,"td"),d(63),s(),l(64,"td",60),d(65,"--"),s(),l(66,"td",61),d(67),s()(),O(68,CV,13,6,"tr",64,J7,!1,xV,3,0,"tr"),s()()()),n&2){let t=e,i=_(2);f(20),E(i.formatCurrency(t.summary.dining.totalPurchases)),f(2),E(i.formatCurrency(t.summary.drinks.totalPurchases)),f(2),E(i.formatCurrency(t.summary.cigars.totalPurchases)),f(4),E(i.formatCurrency(t.summary.total.totalPurchases)),f(5),E(i.formatCurrency(t.summary.dining.totalSales)),f(2),E(i.formatCurrency(t.summary.drinks.totalSales)),f(2),E(i.formatCurrency(t.summary.cigars.totalSales)),f(2),E(i.formatCurrency(t.summary.venue.totalSales)),f(2),E(i.formatCurrency(t.summary.total.totalSales)),f(4),W("text-red-600",t.summary.dining.grossMargin<0),f(),E(i.formatCurrency(t.summary.dining.grossMargin)),f(),W("text-red-600",t.summary.drinks.grossMargin<0),f(),E(i.formatCurrency(t.summary.drinks.grossMargin)),f(),W("text-red-600",t.summary.cigars.grossMargin<0),f(),E(i.formatCurrency(t.summary.cigars.grossMargin)),f(3),W("text-red-600",t.summary.total.grossMargin<0),f(),E(i.formatCurrency(t.summary.total.grossMargin)),f(4),W("text-red-600",t.summary.dining.grossMarginRate<0),f(),k("",(t.summary.dining.grossMarginRate*100).toFixed(2),"%"),f(),W("text-red-600",t.summary.drinks.grossMarginRate<0),f(),k("",(t.summary.drinks.grossMarginRate*100).toFixed(2),"%"),f(),W("text-red-600",t.summary.cigars.grossMarginRate<0),f(),k("",(t.summary.cigars.grossMarginRate*100).toFixed(2),"%"),f(3),W("text-red-600",t.summary.total.grossMarginRate<0),f(),k("",(t.summary.total.grossMarginRate*100).toFixed(2),"%"),f(),L(t.monthlySales)}}function EV(n,e){n&1&&(l(0,"div",25)(1,"p",51),d(2,"\u672A\u627E\u5230\u5546\u54C1\u6BDB\u5229\u8CC7\u6599"),s(),l(3,"p",52),d(4,"\u8ACB\u9078\u64C7\u6642\u9593\u7BC4\u570D\u4E26\u5957\u7528\u7BE9\u9078"),s()())}function SV(n,e){if(n&1&&(M(0,_V,5,0,"div",22),M(1,vV,13,1,"div",23),M(2,bV,71,34,"div",21),M(3,EV,5,0,"div",25)),n&2){let t,i=_();A(i.isLoadingMarginData()?0:-1),f(),A(i.marginDataError()?1:-1),f(),A((t=!i.isLoadingMarginData()&&i.productGrossMarginReport())?2:-1,t),f(),A(!i.isLoadingMarginData()&&!i.productGrossMarginReport()&&!i.marginDataError()?3:-1)}}var Ba=class Ba{constructor(){this.apiService=P(Xe);this.dataService=P(Bt);this.injector=P(Yt);this.chartInstances=[];this.colors={main:["#3b82f6","#8b5cf6","#ef4444","#f59e0b"],sub:["#1d4ed8","#3b82f6","#60a5fa","#93c5fd","#bfdbfe"]};this.activeView=S("analysis");this.productSalesData=S([]);this.isLoadingProductSales=S(!1);this.productSalesError=S(null);this.report=S(null);this.analysisYears=S([2025,2024,2023]);this.analysisMonths=S(Array.from({length:12},(e,t)=>t+1));this.selectedStartYear=S(new Date().getMonth()>=3?new Date().getFullYear():new Date().getFullYear()-1);this.selectedStartMonth=S(new Date().getMonth()>=3?new Date().getMonth()-2:new Date().getMonth()+10);this.selectedEndYear=S(new Date().getFullYear());this.selectedEndMonth=S(new Date().getMonth()+1);this.productGrossMarginReport=S(null);this.isLoadingMarginData=S(!1);this.marginDataError=S(null);this.marginYears=S([2025,2024]);this.marginAllMonths=S(Array.from({length:12},(e,t)=>t+1));this.selectedMarginStartYear=S(2024);this.selectedMarginStartMonth=S(12);this.selectedMarginEndYear=S(2025);this.selectedMarginEndMonth=S(12);this.monthlySalesData=H(()=>{let e=this.productSalesData();if(!e||e.length===0)return{months:[],data:[]};let t=this.buildMonthRange(this.selectedStartYear(),this.selectedStartMonth(),this.selectedEndYear(),this.selectedEndMonth());if(console.log("========== monthlySalesData \u8A08\u7B97\u958B\u59CB =========="),console.log("\u9078\u64C7\u7684\u6708\u4EFD\u7BC4\u570D:",t),console.log("\u6536\u5230\u7684\u5206\u985E\u6578:",e.length),e[0]&&console.log("\u7B2C\u4E00\u500B\u5206\u985E\u7684\u6708\u4EFD:",e[0].items.map(u=>u.reportMonth)),t.length===0)return console.warn("\u6708\u4EFD\u7BC4\u570D\u70BA\u7A7A\uFF01"),{months:[],data:[]};let i=[{name:"\u5176\u4ED6",items:["\u5834\u5730\u4F7F\u7528\u8CBB","\u6D3B\u52D5"]},{name:"\u9152\u6C34",items:["\u8ABF\u9152","\u7D05\u9152/\u767D\u9152","\u5564\u9152","\u5A01\u58EB\u5FCC"]},{name:"\u9910\u98F2",items:["\u4E3B\u98DF","\u70B8\u7269","\u5976\u6614","\u6C23\u6CE1\u98F2","\u55AE\u9EDE","\u8336\u98F2","\u8C9D\u679C/\u53EF\u980C","\u5496\u5561","\u751C\u9EDE","\u6C99\u62C9","\u4E0B\u5348\u8336\u5957\u9910"]},{name:"\u96EA\u8304",items:["\u96EA\u8304"]}],r={};i.forEach(u=>{r[u.name]={},t.forEach(c=>{let m=0,h=0;u.items.forEach(y=>{let v=e.find(C=>C.categoryName===y);if(v){let C=v.items.filter(T=>T.reportMonth===c);m+=C.reduce((T,R)=>T+(R.salesNumber||0),0),h+=C.reduce((T,R)=>T+(R.salesAmount||0),0)}}),r[u.name][c]={sales:m,revenue:h}})});let o=[];i.forEach(u=>{if(u.items.length===1&&u.items[0]==="\u96EA\u8304"){let c={};t.forEach(m=>{let h=r[u.name][m];c[m]={sales:h.sales,revenue:h.revenue,rate:0}}),o.push({category:u.name,item:null,isCategory:!0,monthlyData:c})}else{u.items.forEach(m=>{let h={};t.forEach(y=>{let v=e.find(C=>C.categoryName===m);if(v){let C=v.items.filter(N=>N.reportMonth===y),T=C.reduce((N,F)=>N+(F.salesNumber||0),0),R=C.reduce((N,F)=>N+(F.salesAmount||0),0);R>0&&console.log(`\u2713 ${m} ${y}: \u71DF\u696D\u984D=${R}, \u92B7\u91CF=${T}`),h[y]={sales:T,revenue:R,rate:0}}else h[y]={sales:0,revenue:0,rate:0}}),o.push({category:u.name,item:m,isCategory:!1,isItem:!0,monthlyData:h})});let c={};t.forEach(m=>{let h=r[u.name][m];c[m]={sales:h.sales,revenue:h.revenue,rate:0}}),o.push({category:u.name,item:"\u5C0F\u8A08",isSubtotal:!0,monthlyData:c})}}),t.forEach(u=>{let c=i.reduce((m,h)=>m+(r[h.name][u]?.revenue||0),0);o.forEach(m=>{if(m.monthlyData[u]){if(m.isSubtotal||m.isCategory)m.monthlyData[u].rate=c>0?m.monthlyData[u].revenue/c*100:0;else if(m.isItem){let h=r[m.category][u];m.monthlyData[u].rate=h.revenue>0?m.monthlyData[u].revenue/h.revenue*100:0}}})});let a={};return t.forEach(u=>{let c=i.reduce((h,y)=>h+(r[y.name][u]?.sales||0),0),m=i.reduce((h,y)=>h+(r[y.name][u]?.revenue||0),0);a[u]={sales:c,revenue:m,rate:100}}),o.push({category:"\u5408\u8A08",item:"\u7E3D\u8A08",isTotal:!0,monthlyData:a}),{months:t,data:o}});this.summaryMetrics=H(()=>{let e=this.productSalesData();if(!e||e.length===0)return{uniqueProducts:0,totalItemsSold:0,bestContributor:"N/A",totalRevenue:0};let t=e.flatMap(a=>a.items),i=t.length>0?t.sort((a,u)=>u.salesAmount-a.salesAmount)[0]:null,r=e.reduce((a,u)=>a+u.salesAmount,0),o=e.reduce((a,u)=>a+u.salesNumber,0);return{uniqueProducts:t.length,totalItemsSold:o,bestContributor:i?.itemName||"N/A",totalRevenue:r}});this.chartData=H(()=>{let e=this.productSalesData();if(!e||e.length===0)return{main:[],dining:[],drinks:[],cigars:[],other:[]};let t=e.map(r=>({name:r.categoryName,value:r.salesAmount})),i=r=>{let o=e.find(a=>a.categoryName===r);return o?o.items.map(a=>({name:a.itemName,value:a.salesAmount})):[]};return{main:t,dining:i("\u9910\u98F2"),drinks:i("\u9152\u6C34"),cigars:i("\u96EA\u8304"),other:i("\u5176\u4ED6")}});this.monthlyTrendChartData=H(()=>{let e=this.productSalesData();if(console.log("\u{1F4C8} monthlyTrendChartData computed \u88AB\u89F8\u767C"),console.log("categories \u9577\u5EA6:",e?.length),!e||e.length===0)return console.warn("\u26A0\uFE0F \u6C92\u6709 productSalesData"),{labels:[],datasets:[]};let t=this.buildMonthRange(this.selectedStartYear(),this.selectedStartMonth(),this.selectedEndYear(),this.selectedEndMonth());if(console.log("sortedMonths:",t),t.length===0)return console.warn("\u26A0\uFE0F sortedMonths \u70BA\u7A7A"),{labels:[],datasets:[]};let i=t.map(a=>this.formatMonth(a));console.log("\u5716\u8868 labels:",i);let o=[{displayName:"\u5176\u4ED6",dbCategories:["\u5834\u5730\u4F7F\u7528\u8CBB","\u6D3B\u52D5"],color:"#10b981"},{displayName:"\u9152\u6C34",dbCategories:["\u8ABF\u9152","\u7D05\u9152/\u767D\u9152","\u5564\u9152","\u5A01\u58EB\u5FCC"],color:"#8b5cf6"},{displayName:"\u9910\u98F2",dbCategories:["\u4E3B\u98DF","\u70B8\u7269","\u5976\u6614","\u6C23\u6CE1\u98F2","\u55AE\u9EDE","\u8336\u98F2","\u8C9D\u679C/\u53EF\u980C","\u5496\u5561","\u751C\u9EDE","\u6C99\u62C9","\u4E0B\u5348\u8336\u5957\u9910"],color:"#3b82f6"},{displayName:"\u96EA\u8304",dbCategories:["\u96EA\u8304"],color:"#ef4444"}].map(a=>{let u=t.map(c=>{let m=0;return a.dbCategories.forEach(h=>{let y=e.find(v=>v.categoryName===h);if(y){let v=y.items.filter(C=>C.reportMonth===c);m+=v.reduce((C,T)=>C+(T.salesAmount||0),0)}}),m});return{label:a.displayName,data:u,borderColor:a.color,backgroundColor:`${a.color}1A`,fill:!0,tension:.4}});return console.log("datasets \u751F\u6210\u5B8C\u6210:",o.map(a=>({label:a.label,dataLength:a.data.length}))),{labels:i,datasets:o}});this.applyAnalysisFilter(),this.applyMarginFilter(),$i(()=>{this.activeView()==="analysis"&&this.createAllCharts(this.chartData())}),$n(()=>{let e=this.activeView();Rt(this.injector,()=>{$i(()=>{e==="analysis"?this.updateAllCharts(this.chartData()):this.destroyCharts()})})})}changeView(e){this.activeView.set(e)}async applyAnalysisFilter(){let e=`${this.selectedStartYear()}-${String(this.selectedStartMonth()).padStart(2,"0")}`,t=`${this.selectedEndYear()}-${String(this.selectedEndMonth()).padStart(2,"0")}`;if(e>t){this.productSalesError.set("\u274C \u932F\u8AA4\uFF1A\u8D77\u59CB\u5E74\u6708\u4E0D\u80FD\u665A\u65BC\u7D50\u675F\u5E74\u6708\u3002");return}if(this.selectedStartYear()===2026){this.productSalesError.set(`\u26A0\uFE0F \u63D0\u793A\uFF1A\u8CC7\u6599\u5EAB\u4E2D\u76EE\u524D\u53EA\u6709 2024-2025 \u5E74\u7684\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u3002
\u5DF2\u81EA\u52D5\u8ABF\u6574\u70BA 2025 \u5E74\u3002\u8ACB\u9EDE\u64CA\u300C\u5957\u7528\u300D\u91CD\u65B0\u67E5\u8A62\u3002`),this.selectedStartYear.set(2025),this.selectedEndYear.set(2025);return}this.isLoadingProductSales.set(!0),this.productSalesError.set(null);try{console.log("\u2550".repeat(60)),console.log("\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u67E5\u8A62"),console.log("\u2550".repeat(60)),console.log("\u67E5\u8A62\u53C3\u6578:",{startMonth:e,endMonth:t,selectedYear:this.selectedStartYear()});let r=await this.apiService.getProductSales({startMonth:e,endMonth:t,limit:1e4});if(console.log("API \u539F\u59CB\u56DE\u61C9:",{success:r.success,total:r.total,count:r.count,dataLength:r.data?r.data.length:0,categoriesLength:r.categories?r.categories.length:0}),console.log("API \u5B8C\u6574\u56DE\u61C9 data \u524D10\u7B46:",r.data?.slice(0,10)),!r)throw new Error("API \u8FD4\u56DE\u7A7A\u56DE\u61C9");if(!r.success)throw new Error(`API \u8FD4\u56DE\u5931\u6557: ${r.error||"\u672A\u77E5\u932F\u8AA4"}`);if(r.data&&r.data.length>0){console.log(`\u2713 \u6536\u5230 ${r.data.length} \u7B46\u539F\u59CB\u8CC7\u6599\uFF0C\u6B63\u5728\u6309\u5206\u985E\u5206\u7D44...`),console.log("\u524D5\u7B46\u539F\u59CB\u8CC7\u6599:",r.data.slice(0,5));let o=new Map;r.data.forEach(c=>{let m=c.reportMonth;o.set(m,(o.get(m)||0)+1)}),console.log("\u6708\u4EFD\u5206\u4F48:",Array.from(o.entries()).sort());let a=new Map;r.data.forEach(c=>{let m=c.categoryName||"\u5176\u4ED6";a.has(m)||a.set(m,[]),a.get(m).push(c)});let u=[];a.forEach((c,m)=>{console.log(`\u5206\u985E "${m}" \u6709 ${c.length} \u7B46\u8CC7\u6599`),u.push({categoryName:m,categoryUuid:c[0].categoryUuid||"",items:c})}),console.log(`\u2713 \u5206\u7D44\u5B8C\u6210\uFF1A${u.length} \u500B\u5206\u985E`),console.log("\u7B2C\u4E00\u500B\u5206\u985E:",u[0]),u[0]&&(console.log("\u7B2C\u4E00\u500B\u5206\u985E\u7684 items \u6578\u91CF:",u[0].items.length),console.log("\u7B2C\u4E00\u500B\u5206\u985E\u7684\u524D3\u500B items:",u[0].items.slice(0,3))),this.productSalesData.set(u),setTimeout(()=>{console.log("\u{1F4CA} \u6E96\u5099\u66F4\u65B0\u6708\u92B7\u552E\u8DA8\u52E2\u5716\u8868..."),this.createMonthlyTrendChartOnly()},100)}else if(!r.categories||r.categories.length===0)if(console.warn("\u26A0\uFE0F API \u8FD4\u56DE success=true \u4F46 categories \u9663\u5217\u70BA\u7A7A"),console.warn("API \u56DE\u61C9\u9375\u503C:",Object.keys(r)),console.warn("\u5B8C\u6574\u56DE\u61C9:",JSON.stringify(r,null,2)),r.data&&r.data.length>0){console.log("\u2713 \u6AA2\u6E2C\u5230 data \u6B04\u4F4D\u6709\u8CC7\u6599\uFF0C\u6B63\u5728\u91CD\u65B0\u5206\u7D44...");let o=new Map;r.data.forEach(u=>{let c=u.categoryName||"\u5176\u4ED6";o.has(c)||o.set(c,[]),o.get(c).push(u)});let a=[];o.forEach((u,c)=>{let m=u.reduce((y,v)=>y+Number(v.salesAmount||0),0),h=u.reduce((y,v)=>y+Number(v.salesNumber||0),0);a.push({categoryName:c,categoryUuid:u[0].categoryUuid||"",reportMonth:u[0].reportMonth||"",salesAmount:m,salesNumber:h,averagePrice:h>0?m/h:0,items:u})}),console.log(`\u2713 \u5F9E data \u91CD\u65B0\u5206\u7D44\u6210 ${a.length} \u500B\u5206\u985E`),this.productSalesData.set(a),setTimeout(()=>{console.log("\u{1F4CA} \u6E96\u5099\u66F4\u65B0\u6708\u92B7\u552E\u8DA8\u52E2\u5716\u8868..."),this.createMonthlyTrendChartOnly()},100)}else{let o=`\u2717 \u67E5\u8A62\u6642\u9593\u7BC4\u570D\uFF1A${e} \u5230 ${t}
\u2717 API \u8FD4\u56DE\uFF1Atotal=${r.total}, count=${r.count}
\u2717 \u5EFA\u8B70\uFF1A\u9078\u64C7 2024-2025 \u5E74\u9593\u7684\u6708\u4EFD`;this.productSalesError.set(`\u7121\u6CD5\u7372\u53D6\u5546\u54C1\u92B7\u552E\u8CC7\u6599

\u53EF\u80FD\u539F\u56E0\uFF1A
1. \u9078\u64C7\u7684\u6642\u9593\u7BC4\u570D\u6C92\u6709\u92B7\u552E\u8A18\u9304
2. \u8CC7\u6599\u5EAB\u4E2D\u8A72\u6708\u4EFD\u7121\u5546\u54C1\u92B7\u552E\u8CC7\u6599
3. \u8ACB\u9078\u64C7 2024 \u6216 2025 \u5E74

`+o)}}catch(r){console.error("\u274C \u8F09\u5165\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u6642\u767C\u751F\u932F\u8AA4:",r);let o=r instanceof Error?r.message:"\u8F09\u5165\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66";this.productSalesError.set(`\u274C \u932F\u8AA4\uFF1A${o}

\u8A66\u8A66\u770B\uFF1A
1. \u78BA\u8A8D\u5F8C\u7AEF\u670D\u52D9\u5DF2\u555F\u52D5
2. \u9078\u64C7 2024-2025 \u5E74\u7684\u6708\u4EFD
3. \u6253\u958B\u700F\u89BD\u5668 F12 \u67E5\u770B\u8A73\u7D30\u932F\u8AA4`),this.productSalesData.set([])}finally{this.isLoadingProductSales.set(!1)}}resetAnalysisFilter(){let e=new Date,t=e.getFullYear(),i=e.getMonth()+1;i>=4?(this.selectedStartYear.set(t),this.selectedStartMonth.set(i-3)):(this.selectedStartYear.set(t-1),this.selectedStartMonth.set(i+9)),this.selectedEndYear.set(t),this.selectedEndMonth.set(i),this.productSalesError.set(null),this.applyAnalysisFilter()}async applyMarginFilter(){let e=`${this.selectedMarginStartYear()}-${String(this.selectedMarginStartMonth()).padStart(2,"0")}`,t=`${this.selectedMarginEndYear()}-${String(this.selectedMarginEndMonth()).padStart(2,"0")}`;if(e>t){this.marginDataError.set("\u274C \u932F\u8AA4\uFF1A\u8D77\u59CB\u5E74\u6708\u4E0D\u80FD\u665A\u65BC\u7D50\u675F\u5E74\u6708\u3002");return}this.isLoadingMarginData.set(!0),this.marginDataError.set(null);try{console.log("\u2550".repeat(60)),console.log("\u5546\u54C1\u6BDB\u5229\u8CC7\u6599\u67E5\u8A62"),console.log("\u2550".repeat(60)),console.log("\u67E5\u8A62\u53C3\u6578:",{startMonth:e,endMonth:t});let[i,r]=await Promise.all([this.apiService.getProductSales({startMonth:e,endMonth:t,limit:1e4}),this.apiService.getPurchaseCosts({startMonth:e,endMonth:t})]);if(!i||!i.success)throw new Error(`\u92B7\u552E\u6578\u64DA API \u8FD4\u56DE\u5931\u6557: ${i?.error||"\u672A\u77E5\u932F\u8AA4"}`);if(!r||!r.success)throw new Error(`\u9032\u8CA8\u6578\u64DA API \u8FD4\u56DE\u5931\u6557: ${r?.error||"\u672A\u77E5\u932F\u8AA4"}`);if(!i.data||i.data.length===0){this.marginDataError.set(`\u26A0\uFE0F \u63D0\u793A\uFF1A\u9078\u64C7\u7684\u6642\u9593\u7BC4\u570D\u5167\u6C92\u6709\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u3002

\u76EE\u524D\u8CC7\u6599\u5EAB\u4E2D\u53EA\u6709 2024-2025 \u5E74\u7684\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u3002`),this.productGrossMarginReport.set(null);return}console.log(`\u2713 \u6536\u5230 ${i.data.length} \u7B46\u5546\u54C1\u92B7\u552E\u8CC7\u6599`),console.log("\u2713 \u6536\u5230\u9032\u8CA8\u6210\u672C\u8CC7\u6599:",r.data.summary);let o={\u9910\u98F2:["\u4E3B\u98DF","\u70B8\u7269","\u5976\u6614","\u6C23\u6CE1\u98F2","\u55AE\u9EDE","\u8336\u98F2","\u8C9D\u679C/\u53EF\u980C","\u5496\u5561","\u751C\u9EDE","\u6C99\u62C9","\u4E0B\u5348\u8336\u5957\u9910"],\u9152\u6C34:["\u8ABF\u9152","\u7D05\u9152/\u767D\u9152","\u5564\u9152","\u5A01\u58EB\u5FCC"],\u96EA\u8304:["\u96EA\u8304"],\u6D3B\u52D5\u5834\u5730:["\u5834\u5730\u4F7F\u7528\u8CBB","\u6D3B\u52D5","\u5176\u4ED6"]},a=r.data.summary,u={dining:{totalPurchases:a.dining,totalSales:0,grossMargin:0,grossMarginRate:0},drinks:{totalPurchases:a.drinks,totalSales:0,grossMargin:0,grossMarginRate:0},cigars:{totalPurchases:a.cigars,totalSales:0,grossMargin:0,grossMarginRate:0},venue:{totalPurchases:null,totalSales:0,grossMargin:null,grossMarginRate:null},total:{totalPurchases:a.total,totalSales:0,grossMargin:0,grossMarginRate:0}},c=new Map;i.data.forEach(h=>{let y=h.categoryName||"\u5176\u4ED6",v=h.salesAmount||0,C=h.reportMonth,T=null;if(o.\u9910\u98F2.includes(y)?T="dining":o.\u9152\u6C34.includes(y)?T="drinks":o.\u96EA\u8304.includes(y)?T="cigars":o.\u6D3B\u52D5\u5834\u5730.includes(y)&&(T="venue"),T){u[T].totalSales+=v,u.total.totalSales+=v,c.has(C)||c.set(C,{month:C.replace("-","/"),dining:0,drinks:0,cigars:0,venue:0,total:0});let R=c.get(C);R[T]+=v,R.total+=v}}),["dining","drinks","cigars","total"].forEach(h=>{let y=u[h];y.totalPurchases!==null&&(y.grossMargin=y.totalSales-y.totalPurchases,y.grossMarginRate=y.totalSales>0?y.grossMargin/y.totalSales:0)});let m=Array.from(c.values()).sort((h,y)=>h.month.localeCompare(y.month));console.log("\u2713 \u5546\u54C1\u6BDB\u5229\u8A08\u7B97\u5B8C\u6210:",{summary:u,monthlySalesCount:m.length}),this.productGrossMarginReport.set({summary:u,monthlySales:m})}catch(i){console.error("\u274C \u8F09\u5165\u5546\u54C1\u6BDB\u5229\u8CC7\u6599\u6642\u767C\u751F\u932F\u8AA4:",i);let r=i instanceof Error?i.message:"\u8F09\u5165\u5546\u54C1\u6BDB\u5229\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66";this.marginDataError.set(`\u274C \u932F\u8AA4\uFF1A${r}

\u63D0\u793A\uFF1A
1. \u78BA\u8A8D\u5F8C\u7AEF\u670D\u52D9\u5DF2\u555F\u52D5
2. \u9078\u64C7 2024-2025 \u5E74\u7684\u6708\u4EFD
3. \u6253\u958B\u700F\u89BD\u5668 F12 \u67E5\u770B\u8A73\u7D30\u932F\u8AA4`),this.productGrossMarginReport.set(null)}finally{this.isLoadingMarginData.set(!1)}}resetMarginFilter(){this.selectedMarginStartYear.set(2024),this.selectedMarginStartMonth.set(12),this.selectedMarginEndYear.set(2025),this.selectedMarginEndMonth.set(12),this.applyMarginFilter()}formatMonth(e){return`${parseInt(e.split("-")[1],10)}\u6708`}buildMonthRange(e,t,i,r){let o=Number(e),a=Number(t),u=Number(i),c=Number(r);if(!o||!a||!u||!c)return[];let m=[],h=o,y=a;for(;h<u||h===u&&y<=c;)m.push(`${h}-${String(y).padStart(2,"0")}`),y+=1,y>12&&(y=1,h+=1);return m}formatCurrency(e){return e==null?"NT$0":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}createAllCharts(e){this.destroyCharts(),this.mainCategoryChart=this.createDonutChart(this.mainCategoryChartRef,e.main,"\u4E3B\u8981\u5206\u985E\u71DF\u6536\u4F54\u6BD4",this.colors.main),this.diningChart=this.createDonutChart(this.diningChartRef,e.dining,"\u9910\u98F2\u985E\u54C1\u9805\u4F54\u6BD4",this.colors.sub),this.drinksChart=this.createDonutChart(this.drinksChartRef,e.drinks,"\u9152\u6C34\u985E\u54C1\u9805\u4F54\u6BD4",this.colors.sub),this.chartInstances=[this.mainCategoryChart,this.diningChart,this.drinksChart].filter(t=>t)}createMonthlyTrendChartOnly(){console.log("\u{1F4CA} createMonthlyTrendChartOnly \u88AB\u8ABF\u7528");let e=this.monthlyTrendChartData();if(console.log("\u5716\u8868\u8CC7\u6599:",{labelsLength:e.labels?.length,datasetsLength:e.datasets?.length,labels:e.labels,datasets:e.datasets?.map(t=>({label:t.label,dataLength:t.data?.length,data:t.data}))}),!this.monthlyTrendChartRef){console.error("\u274C monthlyTrendChartRef \u4E0D\u5B58\u5728\uFF01");return}if(!this.monthlyTrendChartRef.nativeElement){console.error("\u274C monthlyTrendChartRef.nativeElement \u4E0D\u5B58\u5728\uFF01");return}if(console.log("\u2713 Canvas \u5143\u7D20\u5B58\u5728"),this.monthlyTrendChart){console.log("\u{1F5D1}\uFE0F \u92B7\u6BC0\u820A\u5716\u8868");try{this.monthlyTrendChart.destroy()}catch(t){console.warn("\u92B7\u6BC0\u5716\u8868\u6642\u51FA\u932F\uFF08\u53EF\u80FD\u5DF2\u88AB\u92B7\u6BC0\uFF09:",t)}this.monthlyTrendChart=null}e.labels.length>0?(console.log("\u{1F3A8} \u5275\u5EFA\u65B0\u5716\u8868\uFF0Clabels:",e.labels.length,"datasets:",e.datasets.length),this.monthlyTrendChart=this.createMonthlyTrendChart(this.monthlyTrendChartRef,e),this.monthlyTrendChart?console.log("\u2705 \u5716\u8868\u5275\u5EFA\u6210\u529F\uFF01",this.monthlyTrendChart):console.error("\u274C \u5716\u8868\u5275\u5EFA\u5931\u6557\uFF01createMonthlyTrendChart \u8FD4\u56DE null")):console.warn("\u26A0\uFE0F \u6C92\u6709\u5716\u8868\u8CC7\u6599\uFF08labels \u70BA\u7A7A\uFF09")}updateAllCharts(e){this.destroyCharts(),this.createAllCharts(e)}destroyCharts(){this.chartInstances.forEach(e=>e?.destroy()),this.chartInstances=[],this.monthlyTrendChart&&(this.monthlyTrendChart.destroy(),this.monthlyTrendChart=null)}createTooltipCallback(e){return t=>{let i=t.label||"",r=t.raw||0,o=e>0?(r/e*100).toFixed(2):0,a=new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0}).format(r);return`${i}: ${a} (${o}%)`}}createDonutChart(e,t,i,r){if(!e||!e.nativeElement||t.length===0)return null;let o=e.nativeElement.getContext("2d");if(!o)return null;let a=t.reduce((u,c)=>u+c.value,0);return new Chart(o,{type:"doughnut",data:{labels:t.map(u=>u.name),datasets:[{data:t.map(u=>u.value),backgroundColor:r,hoverOffset:4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!0,text:i,font:{size:16}},legend:{display:!0,position:"bottom",labels:{boxWidth:12,padding:15}},tooltip:{callbacks:{label:this.createTooltipCallback(a)}}}}})}createMonthlyTrendChart(e,t){if(!e||!e.nativeElement||t.datasets.length===0)return null;let i=e.nativeElement.getContext("2d");return i?new Chart(i,{type:"line",data:t,options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{callback:r=>this.formatCurrency(r)}}},plugins:{title:{display:!0,text:"\u6BCF\u6708\u54C1\u9805\u71DF\u6536\u8DA8\u52E2",font:{size:16}},legend:{display:!0,position:"bottom"},tooltip:{callbacks:{label:r=>`${r.dataset.label}: ${this.formatCurrency(r.raw)}`}}}}}):null}};Ba.\u0275fac=function(t){return new(t||Ba)},Ba.\u0275cmp=re({type:Ba,selectors:[["app-product-analysis"]],viewQuery:function(t,i){if(t&1&&(Dn(W7,5),Dn(j7,5),Dn(z7,5),Dn(Y7,5)),t&2){let r;on(r=an())&&(i.mainCategoryChartRef=r.first),on(r=an())&&(i.diningChartRef=r.first),on(r=an())&&(i.drinksChartRef=r.first),on(r=an())&&(i.monthlyTrendChartRef=r.first)}},decls:16,vars:8,consts:[["monthlyTrendChart",""],[1,"space-y-8"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"flex","flex-col","sm:flex-row","items-center","gap-2","bg-white","p-3","rounded-xl","shadow-md","border","border-gray-200"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"border-b","border-gray-200"],["aria-label","Tabs",1,"-mb-px","flex","space-x-6"],[1,"whitespace-nowrap","py-4","px-1","border-b-2","font-medium","text-sm",3,"click"],[1,"pt-6"],[1,"flex","items-center","gap-2"],[1,"text-sm","font-medium","text-gray-600"],[1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100",3,"ngModelChange","ngModel"],[3,"value"],[1,"flex","items-center","gap-2","mt-2","sm:mt-0"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","filter-outline"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"bg-white","p-6","rounded-xl","shadow-inner","border","mb-6"],[1,"text-lg","font-semibold","text-gray-800","mb-4"],[1,"overflow-x-auto"],[1,"flex","items-center","justify-center","h-32","bg-white","rounded-xl"],[1,"bg-red-50","border-l-4","border-red-500","p-4","rounded-lg","mb-4","space-y-3"],[1,"overflow-x-auto","border","rounded-lg",2,"max-width","100%"],[1,"bg-gray-50","border","border-gray-200","rounded-lg","p-8","text-center"],[1,"h-80"],[1,"flex","flex-col","items-center","space-y-2"],[1,"w-8","h-8","border-3","border-indigo-200","border-t-indigo-600","rounded-full","animate-spin"],[1,"text-sm","text-gray-500"],[1,"flex","items-start","gap-3"],["name","alert-circle-outline",1,"text-2xl","text-red-600","flex-shrink-0","mt-1"],[1,"flex-grow"],[1,"font-bold","text-red-900","text-lg"],[1,"mt-2","text-sm","text-red-800","whitespace-pre-wrap","leading-relaxed"],[1,"bg-red-100","p-3","rounded","text-sm","text-red-900","font-medium"],[1,"text-sm","text-left","border-collapse","bg-white",2,"min-width","100%","width","max-content"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100","sticky","top-0","z-40"],["scope","col",1,"px-3","py-2","border","border-gray-300","font-semibold","sticky","left-0","bg-gray-100","z-50",2,"min-width","80px"],["scope","col",1,"px-3","py-2","border","border-gray-300","font-semibold","sticky","bg-gray-100","z-50",2,"left","80px","min-width","120px"],["scope","col","colspan","3",1,"px-2","py-2","border","border-gray-300","text-center","font-semibold","bg-gray-100",2,"min-width","200px"],[1,"px-3","py-2","border","border-gray-300","sticky","left-0","bg-gray-100","z-50"],[1,"px-3","py-2","border","border-gray-300","sticky","bg-gray-100","z-50",2,"left","80px"],[3,"class"],["scope","col",1,"px-2","py-1","border","border-gray-300","text-center","text-xs","bg-gray-100",2,"min-width","60px"],["scope","col",1,"px-2","py-1","border","border-gray-300","text-center","text-xs","bg-gray-100",2,"min-width","70px"],[1,"px-3","py-2","border","border-gray-300","font-semibold","sticky","left-0","z-20",3,"bg-yellow-50","bg-red-100","bg-white"],[1,"px-3","py-2","border","border-gray-300","sticky","left-0","bg-white","z-20"],[1,"px-3","py-2","border","border-gray-300","sticky","z-20",2,"left","80px"],[1,"px-3","py-2","border","border-gray-300","font-semibold","sticky","left-0","z-20"],[1,"px-2","py-2","border","border-gray-300","text-right","text-xs",2,"white-space","nowrap"],[1,"text-gray-500","mb-2"],[1,"text-sm","text-gray-400"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50"],[1,"text-center"],[1,"py-3","px-4","text-left"],[1,"py-3","px-4"],[1,"border-b","text-right"],[1,"py-3","px-4","font-semibold","text-gray-800","text-left"],[1,"text-gray-400"],[1,"font-bold"],[1,"border-b","text-right","font-medium"],[1,"border-b","text-right","font-medium","bg-gray-50"],[1,"border-b","text-right","hover:bg-gray-50"],[1,"py-2","px-4","text-gray-500","text-left"],[1,"font-semibold"],["colspan","6",1,"text-center","py-8","text-gray-500"]],template:function(t,i){t&1&&(l(0,"div",1)(1,"div",2)(2,"h1",3),d(3,"\u5546\u54C1\u5206\u6790"),s(),M(4,eV,26,4,"div",4),M(5,oV,26,4,"div",4),s(),l(6,"div",5)(7,"div",6)(8,"nav",7)(9,"button",8),b("click",function(){return i.changeView("analysis")}),d(10," \u5546\u54C1\u5206\u6790 "),s(),l(11,"button",8),b("click",function(){return i.changeView("margin")}),d(12," \u5546\u54C1\u6BDB\u5229 "),s()()(),l(13,"div",9),M(14,yV,10,5,"div",1),M(15,SV,4,4),s()()()),t&2&&(f(4),A(i.activeView()==="analysis"?4:-1),f(),A(i.activeView()==="margin"?5:-1),f(4),De(i.activeView()==="analysis"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),f(2),De(i.activeView()==="margin"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),f(3),A(i.activeView()==="analysis"?14:-1),f(),A(i.activeView()==="margin"?15:-1))},dependencies:[oe,Se,Fe,Pe,Re,me,Ie],encapsulation:2,changeDetection:0});var Xm=Ba;var DV=(n,e)=>e.entry_id,G2=(n,e)=>e.shipment_id;function wV(n,e){n&1&&(l(0,"div",2),x(1,"ion-icon",11),l(2,"span",12),d(3,"\u6B63\u5728\u52A0\u8F09\u6578\u64DA..."),s()())}function TV(n,e){if(n&1&&(l(0,"div",3),x(1,"ion-icon",13),l(2,"span",14),d(3),s()()),n&2){let t=_();f(3),E(t.errorMessage())}}function IV(n,e){if(n&1&&(l(0,"option",26),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),E(t)}}function MV(n,e){if(n&1&&(l(0,"option",26),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),E(t)}}function AV(n,e){if(n&1&&(l(0,"option",26),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),E(t)}}function RV(n,e){n&1&&(x(0,"ion-icon",48),l(1,"span"),d(2,"\u5957\u7528\u4E2D..."),s())}function NV(n,e){n&1&&(x(0,"ion-icon",49),l(1,"span"),d(2,"\u5957\u7528"),s())}function FV(n,e){if(n&1){let t=B();l(0,"tr",50),b("click",function(){let r=D(t).$implicit,o=_(2);return w(o.openEditModal(r))}),l(1,"td",51),x(2,"input",52),s(),l(3,"td",53),d(4),s(),l(5,"td",53),d(6),s(),l(7,"td",53),d(8),s(),l(9,"td",54),d(10),s(),l(11,"td",53),d(12),s(),l(13,"td",53),d(14),s(),l(15,"td",53),d(16),s(),l(17,"td",55),d(18),s()()}if(n&2){let t=e.$implicit,i=_(2);W("bg-red-50",!t.is_sigh_off),f(2),I("checked",t.is_sigh_off),f(2),E((t.entry_date==null?null:t.entry_date.substring(0,10))||t.entry_date),f(2),E(t.item_group),f(2),E(t.subject_name),f(2),E(i.formatCurrency(t.amount)),f(2),E(t.invoice_no),f(2),E(t.vendor_tax_id),f(2),E(t.vendor_name),f(2),E(t.description)}}function PV(n,e){n&1&&(l(0,"tr")(1,"td",56),d(2,"\u7121\u7B26\u5408\u689D\u4EF6\u7684\u6D41\u6C34\u5E33\u8CC7\u6599\u3002"),s()())}function kV(n,e){if(n&1){let t=B();l(0,"div",9)(1,"div",15)(2,"div",16)(3,"label",17),d(4,"\u5F9E:"),s(),l(5,"div",18)(6,"input",19),J("ngModelChange",function(r){D(t);let o=_();return K(o.startDate,r)||(o.startDate=r),w(r)}),s(),l(7,"div",20),x(8,"ion-icon",21),s()()(),l(9,"div",16)(10,"label",22),d(11,"\u81F3:"),s(),l(12,"div",18)(13,"input",23),J("ngModelChange",function(r){D(t);let o=_();return K(o.endDate,r)||(o.endDate=r),w(r)}),s(),l(14,"div",20),x(15,"ion-icon",21),s()()(),l(16,"div")(17,"select",24),J("ngModelChange",function(r){D(t);let o=_();return K(o.selectedItem,r)||(o.selectedItem=r),w(r)}),l(18,"option",25),d(19,"\u6240\u6709\u9805\u76EE"),s(),O(20,IV,2,2,"option",26,j),s()(),l(22,"div")(23,"select",27),J("ngModelChange",function(r){D(t);let o=_();return K(o.selectedCategory,r)||(o.selectedCategory=r),w(r)}),l(24,"option",25),d(25,"\u6240\u6709\u79D1\u76EE"),s(),O(26,MV,2,2,"option",26,j),s()(),l(28,"div",28)(29,"select",24),J("ngModelChange",function(r){D(t);let o=_();return K(o.selectedVendor,r)||(o.selectedVendor=r),w(r)}),l(30,"option",25),d(31,"\u6240\u6709\u8CE3\u65B9"),s(),O(32,AV,2,2,"option",26,j),s()(),l(34,"div")(35,"input",29),J("ngModelChange",function(r){D(t);let o=_();return K(o.entryIdFilter,r)||(o.entryIdFilter=r),w(r)}),s()(),l(36,"div")(37,"input",30),J("ngModelChange",function(r){D(t);let o=_();return K(o.descriptionFilter,r)||(o.descriptionFilter=r),w(r)}),s()(),l(38,"div",31)(39,"button",32),b("click",function(){D(t);let r=_();return w(r.applyFilters())}),M(40,RV,3,0)(41,NV,3,0),s(),l(42,"button",33),b("click",function(){D(t);let r=_();return w(r.resetFilters())}),x(43,"ion-icon",34),s()()(),l(44,"div",35)(45,"table",36)(46,"thead",37)(47,"tr")(48,"th",38)(49,"div",39)(50,"input",40),b("change",function(r){D(t);let o=_();return w(o.toggleAllApprovals(r))}),s(),l(51,"span"),d(52,"\u7C3D\u6838"),s()()(),l(53,"th",41),b("click",function(){D(t);let r=_();return w(r.sortData("entry_date"))}),d(54,"\u65E5\u671F "),x(55,"ion-icon",42),s(),l(56,"th",41),b("click",function(){D(t);let r=_();return w(r.sortData("item_group"))}),d(57,"\u9805\u76EE "),x(58,"ion-icon",42),s(),l(59,"th",41),b("click",function(){D(t);let r=_();return w(r.sortData("subject_name"))}),d(60,"\u79D1\u76EE "),x(61,"ion-icon",42),s(),l(62,"th",43),b("click",function(){D(t);let r=_();return w(r.sortData("amount"))}),d(63,"\u91D1\u984D "),x(64,"ion-icon",42),s(),l(65,"th",41),b("click",function(){D(t);let r=_();return w(r.sortData("invoice_no"))}),d(66,"\u767C\u7968\u865F\u78BC "),x(67,"ion-icon",42),s(),l(68,"th",41),b("click",function(){D(t);let r=_();return w(r.sortData("vendor_tax_id"))}),d(69,"\u8CE3\u65B9\u7D71\u7DE8 "),x(70,"ion-icon",42),s(),l(71,"th",41),b("click",function(){D(t);let r=_();return w(r.sortData("vendor_name"))}),d(72,"\u8CE3\u65B9\u540D\u7A31 "),x(73,"ion-icon",42),s(),l(74,"th",38),d(75,"\u8AAA\u660E"),s()()(),l(76,"tbody"),O(77,FV,19,11,"tr",44,DV,!1,PV,3,0,"tr"),s()()(),l(80,"div",45)(81,"div",46),d(82),s(),l(83,"div",16)(84,"button",47),b("click",function(){D(t);let r=_();return w(r.goToPrevPage())}),d(85," \u4E0A\u4E00\u9801 "),s(),l(86,"button",47),b("click",function(){D(t);let r=_();return w(r.goToNextPage())}),d(87," \u4E0B\u4E00\u9801 "),s()()()()}if(n&2){let t=_();f(6),Y("ngModel",t.startDate),f(7),Y("ngModel",t.endDate),f(4),Y("ngModel",t.selectedItem),f(3),L(t.modalAvailableItems()),f(3),Y("ngModel",t.selectedCategory),I("disabled",!t.selectedItem()),f(3),L(t.filterAvailableCategories()),f(3),Y("ngModel",t.selectedVendor),f(3),L(t.filterOptions().vendorNames),f(3),Y("ngModel",t.entryIdFilter),f(2),Y("ngModel",t.descriptionFilter),f(2),I("disabled",t.isLoading()),f(),A(t.isLoading()?40:41),f(10),I("checked",t.areAllApproved()),f(27),L(t.pagedTransactions()),f(5),Kt(" \u7B2C ",t.currentPage()," / ",t.totalPages()," \u9801\uFF0C\u5171 ",t.totalRecords()," \u7B46 "),f(2),I("disabled",t.currentPage()===1),f(2),I("disabled",t.currentPage()===t.totalPages())}}function VV(n,e){if(n&1&&(l(0,"option",26),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),E(t)}}function OV(n,e){if(n&1&&(l(0,"option",26),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),E(t)}}function LV(n,e){if(n&1){let t=B();l(0,"form",59),b("ngSubmit",function(){D(t);let r=_(2);return w(r.handleFormSubmit())}),l(1,"div",60)(2,"div")(3,"label",61),d(4,"\u65E5\u671F*"),s(),l(5,"div",62),x(6,"input",63),l(7,"div",20),x(8,"ion-icon",21),s()()(),l(9,"div")(10,"label",64),d(11,"\u9805\u76EE*"),s(),l(12,"select",65)(13,"option",66),d(14,"\u8ACB\u9078\u64C7\u9805\u76EE"),s(),O(15,VV,2,2,"option",26,j),s()(),l(17,"div")(18,"label",67),d(19,"\u79D1\u76EE*"),s(),l(20,"select",68)(21,"option",66),d(22,"\u8ACB\u9078\u64C7\u79D1\u76EE"),s(),O(23,OV,2,2,"option",26,j),s()(),l(25,"div")(26,"label",69),d(27,"\u91D1\u984D*"),s(),x(28,"input",70),s(),l(29,"div")(30,"label",71),d(31,"\u767C\u7968\u865F\u78BC"),s(),x(32,"input",72),s(),l(33,"div")(34,"label",73),d(35,"\u8CE3\u65B9\u7D71\u7DE8"),s(),l(36,"input",74),b("input",function(r){D(t);let o=_(2);return w(o.onVendorTaxIdInput(r))}),s()(),l(37,"div",75)(38,"label",76),d(39,"\u8CE3\u65B9\u540D\u7A31"),s(),x(40,"input",77),s(),l(41,"div",75)(42,"label",78),d(43,"\u8AAA\u660E"),s(),x(44,"textarea",79),s()(),l(45,"div",80)(46,"button",81),b("click",function(){D(t);let r=_(2);return w(r.resetForm())}),d(47,"\u53D6\u6D88"),s(),l(48,"button",82),d(49,"\u9001\u51FA"),s()()()}if(n&2){let t=_(2);I("formGroup",t.ledgerForm),f(6),W("border-red-500",t.isInvalid("entry_date")),f(6),W("border-red-500",t.isInvalid("item_group")),f(3),L(t.filterOptions().items),f(5),W("border-red-500",t.isInvalid("subject_name")),f(3),L(t.availableCategories()),f(5),W("border-red-500",t.isInvalid("amount"))}}function BV(n,e){if(n&1&&(l(0,"div",89),x(1,"ion-icon",97),l(2,"span"),d(3),s()()),n&2){let t=_(3);f(3),E(t.saveSuccessMessage())}}function UV(n,e){n&1&&(l(0,"div",90),x(1,"ion-icon",98),l(2,"span"),d(3,"\u8F09\u5165\u4E2D..."),s()())}function $V(n,e){if(n&1&&(l(0,"div",93)(1,"div",16),x(2,"ion-icon",99),l(3,"span"),d(4),s()()()),n&2){let t=_(3);f(4),E(t.shipmentItemsError())}}function HV(n,e){n&1&&(l(0,"div",94),d(1,"\u6B64\u6D41\u6C34\u5E33\u5C1A\u672A\u95DC\u806F\u9032\u8CA8\u8CC7\u6599\u3002"),s())}function GV(n,e){n&1&&d(0," \u5132\u5B58\u4E2D... ")}function qV(n,e){n&1&&d(0," \u5132\u5B58\u9032\u8CA8\u8CC7\u6599 ")}function WV(n,e){if(n&1){let t=B();l(0,"div")(1,"div",101)(2,"div")(3,"label",102),d(4,"\u54C1\u9805\u540D\u7A31"),s(),l(5,"input",103),J("ngModelChange",function(r){let o=D(t).$implicit;return K(o.itemName,r)||(o.itemName=r),w(r)}),s()(),l(6,"div")(7,"label",102),d(8,"\u6578\u91CF"),s(),l(9,"input",104),J("ngModelChange",function(r){let o=D(t).$implicit;return K(o.qty,r)||(o.qty=r),w(r)}),s()(),l(10,"div")(11,"label",102),d(12,"\u55AE\u4F4D"),s(),l(13,"input",103),J("ngModelChange",function(r){let o=D(t).$implicit;return K(o.unit,r)||(o.unit=r),w(r)}),s()(),l(14,"div")(15,"label",102),d(16,"\u55AE\u50F9"),s(),l(17,"input",104),J("ngModelChange",function(r){let o=D(t).$implicit;return K(o.unitPrice,r)||(o.unitPrice=r),w(r)}),s()(),l(18,"div")(19,"label",102),d(20,"\u5C0F\u8A08"),s(),x(21,"input",105),s(),l(22,"div",75)(23,"label",102),d(24,"\u5099\u8A3B"),s(),l(25,"textarea",106),J("ngModelChange",function(r){let o=D(t).$implicit;return K(o.remark,r)||(o.remark=r),w(r)}),s()()(),l(26,"div",107)(27,"button",108),b("click",function(){let r=D(t).$implicit,o=_(4);return w(o.deleteShipmentItem(r))}),x(28,"ion-icon",109),l(29,"span"),d(30,"\u522A\u9664"),s()(),l(31,"button",110),b("click",function(){let r=D(t).$implicit,o=_(4);return w(o.saveShipmentItem(r))}),M(32,GV,1,0)(33,qV,1,0),s()()()}if(n&2){let t=e.$implicit,i=_(4);De("border rounded-lg p-4 "+(i.newShipmentItemIds().includes(t.shipment_id)?"bg-yellow-50":"bg-gray-50")),f(5),I("name",hn("shipmentItemName",t.shipment_id)),Y("ngModel",t.itemName),f(4),I("name",hn("shipmentQty",t.shipment_id)),Y("ngModel",t.qty),f(4),I("name",hn("shipmentUnit",t.shipment_id)),Y("ngModel",t.unit),f(4),I("name",hn("shipmentUnitPrice",t.shipment_id)),Y("ngModel",t.unitPrice),f(4),I("value",t.lineAmount??"-"),f(4),I("name",hn("shipmentRemark",t.shipment_id)),Y("ngModel",t.remark),f(6),I("disabled",i.isSavingShipmentItem(t.shipment_id)),f(),A(i.isSavingShipmentItem(t.shipment_id)?32:33)}}function jV(n,e){if(n&1&&(l(0,"div",9),O(1,WV,34,20,"div",100,G2),s()),n&2){let t=_(3);f(),L(t.shipmentItems())}}function zV(n,e){if(n&1){let t=B();l(0,"div",58)(1,"div",83),x(2,"ion-icon",84),l(3,"span",12),d(4,"\u6D41\u6C34\u5E33\u5DF2\u6210\u529F\u65B0\u589E\uFF01\u60A8\u73FE\u5728\u53EF\u4EE5\u95DC\u806F\u9032\u8CA8\u8CC7\u6599\u3002"),s()(),l(5,"div",85)(6,"div",86)(7,"div",87)(8,"h4",88),d(9),s(),M(10,BV,4,1,"div",89),s(),l(11,"div",16),M(12,UV,4,0,"div",90),l(13,"button",91),b("click",function(){D(t);let r=_(2);return w(r.addNewShipmentItem())}),x(14,"ion-icon",92),l(15,"span"),d(16,"\u65B0\u589E\u9032\u8CA8\u55AE"),s()()()(),M(17,$V,5,1,"div",93),M(18,HV,2,0,"div",94),M(19,jV,3,0,"div",9),l(20,"div",95)(21,"button",81),b("click",function(){D(t);let r=_(2);return w(r.resetAddView())}),d(22,"\u8FD4\u56DE\u65B0\u589E\u8868\u55AE"),s(),l(23,"button",96),b("click",function(){D(t);let r=_(2);return w(r.changeView("details"))}),d(24,"\u5B8C\u6210"),s()()()()}if(n&2){let t,i=_(2);f(9),k("\u95DC\u806F\u9032\u8CA8\u8CC7\u6599\uFF1A",i.shipmentItems().length,"\u7B46"),f(),A(i.saveSuccessMessage()?10:-1),f(2),A(i.isLoadingShipmentItems()?12:-1),f(),I("disabled",i.isLoadingShipmentItems()||!((t=i.newlyCreatedEntry())!=null&&t.entry_id)),f(4),A(i.shipmentItemsError()?17:-1),f(),A(!i.isLoadingShipmentItems()&&i.shipmentItems().length===0?18:-1),f(),A(i.shipmentItems().length>0?19:-1)}}function YV(n,e){if(n&1&&M(0,LV,50,9,"form",57)(1,zV,25,7,"div",58),n&2){let t=_();A(t.newlyCreatedEntry()?1:0)}}function JV(n,e){if(n&1&&(l(0,"option",26),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),E(t)}}function KV(n,e){if(n&1&&(l(0,"option",26),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),E(t)}}function QV(n,e){if(n&1&&(l(0,"p",130),d(1),s()),n&2){let t=_(2);f(),E(t.getErrorMessage("vendor_tax_id"))}}function ZV(n,e){if(n&1&&(l(0,"div",147)(1,"p",151)(2,"strong"),d(3,"\u6CE8\u610F\uFF1A"),s(),d(4,"\u6B64\u6D41\u6C34\u5E33\u5DF2\u95DC\u806F "),l(5,"strong"),d(6),s(),d(7," \u7B46\u9032\u8CA8\u55AE\u9805\u76EE\uFF0C\u522A\u9664\u6B64\u6D41\u6C34\u5E33\u6642\u5C07\u4E00\u4F75\u522A\u9664\u9019\u4E9B\u9032\u8CA8\u55AE\u9805\u76EE\u3002 "),s()()),n&2){let t=_(3);f(6),E(t.ledgerDeleteConfirmation().relatedShipmentCount)}}function XV(n,e){if(n&1){let t=B();l(0,"div",140)(1,"div",142)(2,"div",143),x(3,"ion-icon",144),l(4,"h3",88),d(5,"\u78BA\u8A8D\u522A\u9664\u6D41\u6C34\u5E33"),s()(),l(6,"div",145)(7,"p",146),d(8,"\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u6B64\u6D41\u6C34\u5E33\u8A18\u9304\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"),s(),M(9,ZV,8,1,"div",147),s(),l(10,"div",148)(11,"button",149),b("click",function(){D(t);let r=_(2);return w(r.cancelDeleteLedgerEntry())}),d(12,"\u53D6\u6D88"),s(),l(13,"button",150),b("click",function(){D(t);let r=_(2);return w(r.confirmDeleteLedgerEntry())}),d(14,"\u78BA\u8A8D\u522A\u9664"),s()()()()}if(n&2){let t=_(2);f(9),A(t.ledgerDeleteConfirmation().relatedShipmentCount>0?9:-1)}}function e9(n,e){if(n&1&&(l(0,"div",89),x(1,"ion-icon",97),l(2,"span"),d(3),s()()),n&2){let t=_(2);f(3),E(t.saveSuccessMessage())}}function t9(n,e){n&1&&(l(0,"div",90),x(1,"ion-icon",98),l(2,"span"),d(3,"\u8F09\u5165\u4E2D..."),s()())}function n9(n,e){if(n&1&&(l(0,"div",93)(1,"div",16),x(2,"ion-icon",99),l(3,"span"),d(4),s()()()),n&2){let t=_(2);f(4),E(t.shipmentItemsError())}}function i9(n,e){n&1&&(l(0,"div",94),d(1,"\u6B64\u6D41\u6C34\u5E33\u5C1A\u672A\u95DC\u806F\u9032\u8CA8\u8CC7\u6599\u3002"),s())}function r9(n,e){n&1&&d(0," \u5132\u5B58\u4E2D... ")}function o9(n,e){n&1&&d(0," \u5132\u5B58\u9032\u8CA8\u8CC7\u6599 ")}function a9(n,e){if(n&1){let t=B();l(0,"div")(1,"div",101)(2,"div")(3,"label",102),d(4,"\u54C1\u9805\u540D\u7A31"),s(),l(5,"input",103),J("ngModelChange",function(r){let o=D(t).$implicit;return K(o.itemName,r)||(o.itemName=r),w(r)}),s()(),l(6,"div")(7,"label",102),d(8,"\u6578\u91CF"),s(),l(9,"input",104),J("ngModelChange",function(r){let o=D(t).$implicit;return K(o.qty,r)||(o.qty=r),w(r)}),s()(),l(10,"div")(11,"label",102),d(12,"\u55AE\u4F4D"),s(),l(13,"input",103),J("ngModelChange",function(r){let o=D(t).$implicit;return K(o.unit,r)||(o.unit=r),w(r)}),s()(),l(14,"div")(15,"label",102),d(16,"\u55AE\u50F9"),s(),l(17,"input",104),J("ngModelChange",function(r){let o=D(t).$implicit;return K(o.unitPrice,r)||(o.unitPrice=r),w(r)}),s()(),l(18,"div")(19,"label",102),d(20,"\u5C0F\u8A08"),s(),x(21,"input",105),s(),l(22,"div",75)(23,"label",102),d(24,"\u5099\u8A3B"),s(),l(25,"textarea",106),J("ngModelChange",function(r){let o=D(t).$implicit;return K(o.remark,r)||(o.remark=r),w(r)}),s()()(),l(26,"div",107)(27,"button",108),b("click",function(){let r=D(t).$implicit,o=_(3);return w(o.deleteShipmentItem(r))}),x(28,"ion-icon",109),l(29,"span"),d(30,"\u522A\u9664"),s()(),l(31,"button",110),b("click",function(){let r=D(t).$implicit,o=_(3);return w(o.saveShipmentItem(r))}),M(32,r9,1,0)(33,o9,1,0),s()()()}if(n&2){let t=e.$implicit,i=_(3);De("border rounded-lg p-4 "+(i.newShipmentItemIds().includes(t.shipment_id)?"bg-yellow-50":"bg-gray-50")),f(5),I("name",hn("shipmentItemName",t.shipment_id)),Y("ngModel",t.itemName),f(4),I("name",hn("shipmentQty",t.shipment_id)),Y("ngModel",t.qty),f(4),I("name",hn("shipmentUnit",t.shipment_id)),Y("ngModel",t.unit),f(4),I("name",hn("shipmentUnitPrice",t.shipment_id)),Y("ngModel",t.unitPrice),f(4),I("value",t.lineAmount??"-"),f(4),I("name",hn("shipmentRemark",t.shipment_id)),Y("ngModel",t.remark),f(6),I("disabled",i.isSavingShipmentItem(t.shipment_id)),f(),A(i.isSavingShipmentItem(t.shipment_id)?32:33)}}function s9(n,e){if(n&1&&(l(0,"div",9),O(1,a9,34,20,"div",100,G2),s()),n&2){let t=_(2);f(),L(t.shipmentItems())}}function l9(n,e){if(n&1){let t=B();l(0,"div",10)(1,"div",111)(2,"div",112)(3,"h3",113),d(4),s(),l(5,"button",114),b("click",function(){D(t);let r=_();return w(r.closeModal())}),x(6,"ion-icon",115),s()(),l(7,"div",116)(8,"form",117),b("ngSubmit",function(){D(t);let r=_();return w(r.handleFormSubmit())}),l(9,"div",60)(10,"div")(11,"label",118),d(12,"\u65E5\u671F*"),s(),l(13,"div",62),x(14,"input",119),l(15,"div",20),x(16,"ion-icon",21),s()()(),l(17,"div")(18,"label",120),d(19,"\u9805\u76EE*"),s(),l(20,"select",121),O(21,JV,2,2,"option",26,j),s()(),l(23,"div")(24,"label",122),d(25,"\u79D1\u76EE*"),s(),l(26,"select",123)(27,"option",25),d(28,"\u8ACB\u9078\u64C7\u79D1\u76EE"),s(),O(29,KV,2,2,"option",26,j),s()(),l(31,"div")(32,"label",124),d(33,"\u91D1\u984D*"),s(),x(34,"input",125),s(),l(35,"div")(36,"label",126),d(37,"\u767C\u7968\u865F\u78BC"),s(),x(38,"input",127),s(),l(39,"div")(40,"label",128),d(41,"\u8CE3\u65B9\u7D71\u7DE8"),s(),l(42,"input",129),b("input",function(r){D(t);let o=_();return w(o.onVendorTaxIdInput(r))}),s(),M(43,QV,2,1,"p",130),s(),l(44,"div",75)(45,"label",131),d(46,"\u8CE3\u65B9\u540D\u7A31"),s(),x(47,"input",132),s(),l(48,"div",75)(49,"label",133),d(50,"\u8AAA\u660E"),s(),x(51,"textarea",134),s(),l(52,"div",75)(53,"label",135),x(54,"input",136),l(55,"span",137),d(56,"\u5DF2\u7C3D\u6838"),s()()()(),l(57,"div",138)(58,"button",139),b("click",function(){D(t);let r=_();return w(r.deleteLedgerEntry())}),d(59,"\u522A\u9664"),s(),l(60,"button",81),b("click",function(){D(t);let r=_();return w(r.closeModal())}),d(61,"\u53D6\u6D88"),s(),l(62,"button",82),d(63,"\u4FEE\u6539"),s()()(),M(64,XV,15,1,"div",140),l(65,"div",141)(66,"div",86)(67,"div",87)(68,"h4",88),d(69),s(),M(70,e9,4,1,"div",89),s(),l(71,"div",16),M(72,t9,4,0,"div",90),l(73,"button",91),b("click",function(){D(t);let r=_();return w(r.addNewShipmentItem())}),x(74,"ion-icon",92),l(75,"span"),d(76,"\u65B0\u589E\u9032\u8CA8\u55AE"),s()()()(),M(77,n9,5,1,"div",93),M(78,i9,2,0,"div",94),M(79,s9,3,0,"div",9),s()()()()}if(n&2){let t,i,r=_();f(4),k("\u4FEE\u6539\u6D41\u6C34\u5E33 ID\uFF1A",(t=r.editingTransaction())==null?null:t.entry_id),f(4),I("formGroup",r.ledgerForm),f(6),W("border-red-500",r.isInvalid("entry_date")),f(6),W("border-red-500",r.isInvalid("item_group")),f(),L(r.modalAvailableItems()),f(5),W("border-red-500",r.isInvalid("subject_name")),f(3),L(r.availableCategories()),f(5),W("border-red-500",r.isInvalid("amount")),f(8),W("border-red-500",r.isInvalid("vendor_tax_id")),f(),A(r.isInvalid("vendor_tax_id")?43:-1),f(21),A(r.ledgerDeleteConfirmation()?64:-1),f(5),k("\u95DC\u806F\u9032\u8CA8\u8CC7\u6599\uFF1A",r.shipmentItems().length,"\u7B46"),f(),A(r.saveSuccessMessage()?70:-1),f(2),A(r.isLoadingShipmentItems()?72:-1),f(),I("disabled",r.isLoadingShipmentItems()||!((i=r.editingTransaction())!=null&&i.entry_id)),f(4),A(r.shipmentItemsError()?77:-1),f(),A(!r.isLoadingShipmentItems()&&r.shipmentItems().length===0?78:-1),f(),A(r.shipmentItems().length>0?79:-1)}}function u9(n,e){if(n&1){let t=B();l(0,"div",10)(1,"div",152)(2,"div",153)(3,"div",154),x(4,"ion-icon",155),s(),l(5,"h3",156),d(6,"\u8ACB\u78BA\u8A8D"),s(),l(7,"p",157),d(8),s()(),l(9,"div",158)(10,"button",159),b("click",function(){D(t);let r=_();return w(r.cancelApproval())}),d(11,"\u53D6\u6D88"),s(),l(12,"button",160),b("click",function(){D(t);let r=_();return w(r.confirmApproval())}),d(13,"\u78BA\u8A8D"),s()()()()}n&2&&(f(8),E(e.message))}function d9(n,e){if(n&1){let t=B();l(0,"div",10)(1,"div",152)(2,"div",153)(3,"div",161),x(4,"ion-icon",162),s(),l(5,"h3",156),d(6,"\u78BA\u8A8D\u522A\u9664"),s(),l(7,"p",157),d(8),s(),l(9,"p",163),d(10,"\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"),s()(),l(11,"div",158)(12,"button",159),b("click",function(){D(t);let r=_();return w(r.cancelDeleteShipmentItem())}),d(13,"\u53D6\u6D88"),s(),l(14,"button",164),b("click",function(){D(t);let r=_();return w(r.confirmDeleteShipmentItem())}),d(15,"\u78BA\u8A8D\u522A\u9664"),s()()()()}n&2&&(f(8),k("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u9032\u8CA8\u55AE\u9805\u76EE\u300C",e.itemName,"\u300D\u55CE\uFF1F"))}var Ua=class Ua{constructor(){this.apiService=P(Xe);this.fb=P(je);this.activeView=S("details");this.allTransactions=S([]);this.displayedTransactions=S([]);this.pagination=S({total:0,totalPages:1,page:1,limit:20});this.filterOptions=S({items:[],categories:[],vendorNames:[]});this.editingTransaction=S(null);this.newlyCreatedEntry=S(null);this.isModalOpen=S(!1);this.isLoading=S(!1);this.errorMessage=S(null);this.confirmationState=S(null);this.shipmentItems=S([]);this.isLoadingShipmentItems=S(!1);this.shipmentItemsError=S(null);this.savingShipmentItemIds=S([]);this.deleteConfirmation=S(null);this.newShipmentItemIds=S([]);this.saveSuccessMessage=S(null);this.ledgerDeleteConfirmation=S(null);this.isCheckingShipment=S(!1);this.today=new Date;this.firstDayOfMonth=new Date(this.today.getFullYear(),this.today.getMonth(),1);this.lastDayOfMonth=new Date(this.today.getFullYear(),this.today.getMonth()+1,0);this.startDate=S(this.formatDate(this.firstDayOfMonth));this.endDate=S(this.formatDate(this.lastDayOfMonth));this.selectedItem=S("");this.selectedCategory=S("");this.selectedVendor=S("");this.descriptionFilter=S("");this.entryIdFilter=S("");this.appliedItem=S("");this.appliedCategory=S("");this.appliedVendor=S("");this.appliedDescriptionFilter=S("");this.appliedEntryIdFilter=S("");this.pageSize=20;this.currentPage=S(1);this.sortColumn=S("entry_date");this.sortDirection=S("desc");this.submitted=S(!1);this.formItemGroup=S(null);this.ledgerForm=this.fb.group({entry_id:[""],entry_date:["",U.required],item_group:["",U.required],subject_name:["",U.required],amount:["",U.required],invoice_no:[""],vendor_tax_id:["",[U.pattern(/^\d{0,8}$/)]],vendor_id:[null],vendor_name:[""],description:[""],is_sigh_off:[!1],gl_account_id:[null]});this.glAccounts=S([]);this.isLoadingGLAccounts=S(!1);this.glAccountsError=S(null);this.glAccountsHierarchy=H(()=>{let e=this.glAccounts(),t={};return e.forEach(i=>{let r=i.parent_account_id!==null&&i.parent_account_id!==void 0?i.parent_account_id.toString():"null";t[r]||(t[r]=[]),t[r].push(i)}),t});this.topLevelAccounts=H(()=>(this.glAccountsHierarchy().null||[]).sort((t,i)=>t.gl_account_id-i.gl_account_id));this.selectedItemSubAccounts=H(()=>{let e=this.ledgerForm.get("item_group")?.value,t=this.glAccounts();if(!e||t.length===0)return[];let i=t.find(r=>r.account_name===e&&r.parent_account_id===null);return i?t.filter(r=>r.parent_account_id===i.gl_account_id).sort((r,o)=>r.gl_account_id-o.gl_account_id):[]});this.itemCategoryMap={\u8CC7\u7522:["\u73FE\u91D1","\u9280\u884C\u5B58\u6B3E","\u61C9\u6536\u5E33\u6B3E","\u5B58\u8CA8"],\u8CA0\u50B5:["\u61C9\u4ED8\u5E33\u6B3E","\u61C9\u4ED8\u85AA\u8CC7","\u61C9\u4ED8\u7A05\u6B3E"],\u696D\u4E3B\u6B0A\u76CA:["\u8CC7\u672C","\u4FDD\u7559\u76C8\u9918"],\u71DF\u696D\u6536\u5165:["\u92B7\u8CA8\u6536\u5165","\u5176\u4ED6\u6536\u5165"],\u71DF\u696D\u8CBB\u7528:["\u4EBA\u4E8B\u8CBB\u7528","\u9032\u8CA8\u6210\u672C","\u5176\u4ED6\u8CBB\u7528"]};this.availableCategories=H(()=>{let e=this.formItemGroup();if(!e)return[];let t=this.glAccounts();if(t.length>0){let a=t.find(u=>u.account_name===e&&u.parent_account_id===null);if(a){let u=t.filter(c=>c.parent_account_id===a.gl_account_id).map(c=>c.account_name).filter(Boolean).sort();if(u.length>0)return u}}let r=this.allTransactions().filter(a=>a.item_group===e).map(a=>a.subject_name).filter(Boolean),o=[...new Set(r)].sort();if(o.length===0){let a=this.itemCategoryMap[e];if(a&&a.length>0)return a}return o});this.filterAvailableCategories=H(()=>{let e=this.selectedItem();if(this.glAccounts().length>0){let r=this.glAccounts(),o=r.find(a=>a.account_name===e&&a.parent_account_id===null);if(o){let a=r.filter(u=>u.parent_account_id===o.gl_account_id).map(u=>u.account_name).filter(Boolean).sort();if(a.length>0)return a}}if(!e)return[];let i=this.allTransactions().filter(r=>r.item_group===e).map(r=>r.subject_name).filter(Boolean);return[...new Set(i)].sort()});this.modalAvailableItems=H(()=>this.glAccounts().length>0?this.topLevelAccounts().map(e=>e.account_name).filter(Boolean).sort():Object.keys(this.itemCategoryMap).sort());this.pagedTransactions=H(()=>this.displayedTransactions());this.totalPages=H(()=>this.pagination().totalPages);this.totalRecords=H(()=>this.pagination().total);this.areAllApproved=H(()=>{let e=this.displayedTransactions();return e.length>0&&e.every(t=>t.is_sigh_off)});this.loadInitialData(),this.ledgerForm.get("item_group")?.valueChanges.subscribe(e=>{this.formItemGroup.set(e)}),$n(()=>{let e=this.formItemGroup(),t=this.availableCategories(),i=this.ledgerForm.get("subject_name")?.value;i&&t.length>0&&!t.includes(i)&&(this.ledgerForm.get("subject_name")?.setValue("",{emitEvent:!1}),this.ledgerForm.get("gl_account_id")?.setValue(null,{emitEvent:!1}))}),this.ledgerForm.get("subject_name")?.valueChanges.subscribe(async()=>{await this.updateGLAccountId()}),$n(()=>{this.selectedItem()||this.selectedCategory.set("")})}async loadInitialData(){await Promise.all([this.loadGLAccounts(),this.applyFilters()])}async loadGLAccounts(){this.isLoadingGLAccounts.set(!0),this.glAccountsError.set(null);try{let e=await this.apiService.getGLAccounts();e.success&&e.data?this.glAccounts.set(e.data):this.glAccountsError.set(e.error||"\u7121\u6CD5\u52A0\u8F09\u6703\u8A08\u79D1\u76EE")}catch{this.glAccountsError.set("\u52A0\u8F09\u6703\u8A08\u79D1\u76EE\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoadingGLAccounts.set(!1)}}async applyFilters(){this.isLoading.set(!0),this.errorMessage.set(null),this.appliedItem.set(this.selectedItem()),this.appliedCategory.set(this.selectedCategory()),this.appliedVendor.set(this.selectedVendor()),this.appliedDescriptionFilter.set(this.descriptionFilter()),this.appliedEntryIdFilter.set(this.entryIdFilter()),this.currentPage.set(1),await this.loadPageData(1)}async loadPageData(e){this.isLoading.set(!0),this.errorMessage.set(null);try{let t=await this.apiService.getLedgerEntries({startDate:this.startDate(),endDate:this.endDate(),itemGroup:this.appliedItem()||void 0,subjectName:this.appliedCategory()||void 0,vendorName:this.appliedVendor()||void 0,description:this.appliedDescriptionFilter()||void 0,entryId:this.appliedEntryIdFilter()?parseInt(this.appliedEntryIdFilter(),10):void 0,page:e,limit:20});if(t.success&&t.data){if(this.displayedTransactions.set(t.data),t.pagination&&this.pagination.set({total:t.pagination.total,totalPages:t.pagination.totalPages,page:t.pagination.page,limit:t.pagination.limit}),e===1){let i=await this.apiService.getLedgerEntries({startDate:this.startDate(),endDate:this.endDate(),limit:9999});if(i.success&&i.data){this.allTransactions.set(i.data);let r=Object.keys(this.itemCategoryMap),o=i.data.map(m=>m.item_group).filter(Boolean),a=[...new Set([...r,...o])].sort(),u=[...new Set(i.data.map(m=>m.subject_name).filter(Boolean))].sort(),c=[...new Set(i.data.map(m=>m.vendor_name).filter(Boolean))].sort();this.filterOptions.set({items:a,categories:u,vendorNames:c})}}}else this.errorMessage.set(t.error||"\u7121\u6CD5\u53D6\u5F97\u6D41\u6C34\u5E33\u8CC7\u6599")}catch(t){console.error("Error loading ledger entries:",t),this.errorMessage.set("\u53D6\u5F97\u6D41\u6C34\u5E33\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoading.set(!1)}}resetFilters(){this.startDate.set(this.formatDate(this.firstDayOfMonth)),this.endDate.set(this.formatDate(this.lastDayOfMonth)),this.selectedItem.set(""),this.selectedCategory.set(""),this.selectedVendor.set(""),this.descriptionFilter.set(""),this.entryIdFilter.set(""),this.appliedItem.set(""),this.appliedCategory.set(""),this.appliedVendor.set(""),this.appliedDescriptionFilter.set(""),this.appliedEntryIdFilter.set(""),this.currentPage.set(1),this.applyFilters()}changeView(e){this.activeView.set(e),e==="add"&&(this.resetForm(),this.newlyCreatedEntry.set(null),this.shipmentItems.set([]),this.shipmentItemsError.set(null))}async goToPage(e){let t=this.totalPages(),i=Math.min(Math.max(e,1),t);i!==this.currentPage()&&(this.currentPage.set(i),await this.loadPageData(i))}async goToPrevPage(){await this.goToPage(this.currentPage()-1)}async goToNextPage(){await this.goToPage(this.currentPage()+1)}sortData(e){this.sortColumn()===e?this.sortDirection.update(t=>t==="asc"?"desc":"asc"):(this.sortColumn.set(e),this.sortDirection.set("asc")),this.currentPage.set(1)}async openEditModal(e){this.editingTransaction.set(e),this.formItemGroup.set(e.item_group),this.ledgerForm.patchValue({entry_id:e.entry_id?e.entry_id.toString():"",entry_date:this.normalizeDateInput(e.entry_date),item_group:e.item_group,subject_name:e.subject_name,amount:e.amount?e.amount.toString():"",invoice_no:e.invoice_no,vendor_tax_id:this.sanitizeVendorTaxId(e.vendor_tax_id),vendor_name:e.vendor_name,description:e.description,is_sigh_off:e.is_sigh_off}),this.isModalOpen.set(!0),await this.loadShipmentItemsForEntry(e.entry_id)}closeModal(){this.isModalOpen.set(!1),this.editingTransaction.set(null),this.shipmentItems.set([]),this.shipmentItemsError.set(null),this.isLoadingShipmentItems.set(!1),this.resetForm()}async loadShipmentItemsForEntry(e){if(!e){this.shipmentItems.set([]),this.shipmentItemsError.set(null);return}let t=typeof e=="string"?parseInt(e,10):e;this.isLoadingShipmentItems.set(!0),this.shipmentItemsError.set(null);try{let i={entryId:t,limit:1e3,offset:0},r=await this.apiService.getShipmentItems(i);if(r.success&&r.data){let o=r.data.map(a=>V({},a));this.shipmentItems.set(o)}else this.shipmentItems.set([]),this.shipmentItemsError.set(r.error||"\u7121\u6CD5\u53D6\u5F97\u9032\u8CA8\u8CC7\u6599")}catch(i){console.error("Error loading shipment items:",i),this.shipmentItems.set([]),this.shipmentItemsError.set("\u53D6\u5F97\u9032\u8CA8\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoadingShipmentItems.set(!1)}}isSavingShipmentItem(e){return this.savingShipmentItemIds().includes(e)}async saveShipmentItem(e){if(!e?.shipment_id)return;let t=this.savingShipmentItemIds();if(t.includes(e.shipment_id))return;let r=(this.editingTransaction()||this.newlyCreatedEntry())?.entry_id;this.savingShipmentItemIds.set([...t,e.shipment_id]),this.shipmentItemsError.set(null);try{let o=await this.apiService.updateShipmentItem(e.shipment_id,{itemName:e.itemName,qty:e.qty??null,unitPrice:e.unitPrice??null,unit:e.unit??null,remark:e.remark??null,entryId:r??null});o.success?(this.saveSuccessMessage.set("\u9032\u8CA8\u8CC7\u6599\u5DF2\u5132\u5B58\u6210\u529F"),this.newShipmentItemIds.set(this.newShipmentItemIds().filter(a=>a!==e.shipment_id)),setTimeout(()=>{this.saveSuccessMessage.set(null)},3e3)):this.shipmentItemsError.set(o.error||"\u66F4\u65B0\u9032\u8CA8\u8CC7\u6599\u5931\u6557")}catch(o){console.error("Error updating shipment item:",o),this.shipmentItemsError.set("\u66F4\u65B0\u9032\u8CA8\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.savingShipmentItemIds.set(this.savingShipmentItemIds().filter(o=>o!==e.shipment_id))}}async addNewShipmentItem(){let e=this.editingTransaction()||this.newlyCreatedEntry();if(!e||!e.entry_id){this.shipmentItemsError.set("\u7121\u6CD5\u65B0\u589E\u9032\u8CA8\u55AE\uFF1A\u6D41\u6C34\u5E33\u5C1A\u672A\u4FDD\u5B58");return}let i=this.ledgerForm.get("vendor_id")?.value||e.vendor_id||null;this.isLoadingShipmentItems.set(!0),this.shipmentItemsError.set(null);try{let r=await this.apiService.createShipmentItem({entryId:e.entry_id,issueDate:e.entry_date||new Date().toISOString().split("T")[0],vendorId:i,itemName:"\u65B0\u54C1\u9805",qty:0,unitPrice:0,unit:"",remark:""});if(r.success&&r.data){let o=this.shipmentItems();this.shipmentItems.set([r.data,...o]),this.newShipmentItemIds.set([...this.newShipmentItemIds(),r.data.shipment_id])}else this.shipmentItemsError.set(r.error||"\u65B0\u589E\u9032\u8CA8\u8CC7\u6599\u5931\u6557")}catch(r){console.error("Error creating shipment item:",r),this.shipmentItemsError.set("\u65B0\u589E\u9032\u8CA8\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoadingShipmentItems.set(!1)}}deleteShipmentItem(e){this.deleteConfirmation.set({shipmentId:e.shipment_id,itemName:e.itemName})}async confirmDeleteShipmentItem(){let e=this.deleteConfirmation();if(e)try{let t=await this.apiService.deleteShipmentItem(e.shipmentId);if(t.success){let i=this.shipmentItems();this.shipmentItems.set(i.filter(r=>r.shipment_id!==e.shipmentId)),this.shipmentItemsError.set(null)}else this.shipmentItemsError.set(t.error||"\u522A\u9664\u9032\u8CA8\u8CC7\u6599\u5931\u6557")}catch(t){console.error("Error deleting shipment item:",t),this.shipmentItemsError.set("\u522A\u9664\u9032\u8CA8\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.deleteConfirmation.set(null)}}cancelDeleteShipmentItem(){this.deleteConfirmation.set(null)}async deleteLedgerEntry(){let e=this.editingTransaction();if(!e?.entry_id){this.errorMessage.set("\u7121\u6CD5\u53D6\u5F97\u6D41\u6C34\u5E33ID");return}this.isCheckingShipment.set(!0);try{let t=await this.apiService.checkLedgerShipmentItems(e.entry_id);t.success?this.ledgerDeleteConfirmation.set({entryId:e.entry_id,relatedShipmentCount:t.data?.shipmentItemsCount||0}):this.errorMessage.set(t.error||"\u6AA2\u67E5\u9032\u8CA8\u55AE\u5931\u6557")}catch(t){console.error("Error checking shipment items:",t),this.errorMessage.set("\u6AA2\u67E5\u9032\u8CA8\u55AE\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isCheckingShipment.set(!1)}}async confirmDeleteLedgerEntry(){let e=this.ledgerDeleteConfirmation();if(e)try{let t=await this.apiService.deleteLedgerEntry(e.entryId);if(t.success){let i=this.displayedTransactions();this.displayedTransactions.set(i.filter(r=>r.entry_id!==e.entryId)),this.ledgerDeleteConfirmation.set(null),this.closeModal(),this.errorMessage.set(`\u6D41\u6C34\u5E33\u5DF2\u522A\u9664${e.relatedShipmentCount>0?`\uFF0C\u4E26\u540C\u6642\u522A\u9664\u4E86 ${e.relatedShipmentCount} \u7B46\u9032\u8CA8\u55AE\u9805\u76EE`:""}`),setTimeout(()=>{this.errorMessage.set(null)},3e3)}else this.errorMessage.set(t.error||"\u522A\u9664\u6D41\u6C34\u5E33\u5931\u6557")}catch(t){console.error("Error deleting ledger entry:",t),this.errorMessage.set("\u522A\u9664\u6D41\u6C34\u5E33\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}}cancelDeleteLedgerEntry(){this.ledgerDeleteConfirmation.set(null)}toggleAllApprovals(e){let t=e.target,i=t.checked,r=i?"\u60A8\u78BA\u5B9A\u8981\u7C3D\u6838\u6240\u6709\u53EF\u898B\u9805\u76EE\u55CE\uFF1F":"\u60A8\u78BA\u5B9A\u8981\u53D6\u6D88\u7C3D\u6838\u6240\u6709\u53EF\u898B\u9805\u76EE\u55CE\uFF1F";this.confirmationState.set({message:r,isChecked:i,target:t})}async confirmApproval(){let e=this.confirmationState();if(!e)return;let{isChecked:t}=e,i=this.displayedTransactions().filter(o=>o.is_sigh_off!==t),r=i.map(o=>this.apiService.updateLedgerEntry({entry_id:o.entry_id,is_sigh_off:t}));try{await Promise.all(r);let o=this.allTransactions().map(a=>i.some(c=>c.entry_id===a.entry_id)?G(V({},a),{is_sigh_off:t}):a);this.allTransactions.set(o)}catch(o){console.error("\u66F4\u65B0\u7C3D\u6838\u72C0\u614B\u5931\u6557:",o),this.errorMessage.set("\u66F4\u65B0\u7C3D\u6838\u72C0\u614B\u5931\u6557")}this.confirmationState.set(null)}cancelApproval(){let e=this.confirmationState();e&&(e.target.checked=!e.isChecked,this.confirmationState.set(null))}async updateGLAccountId(){let e=this.ledgerForm.get("item_group")?.value,t=this.ledgerForm.get("subject_name")?.value;if(!e||!t){this.ledgerForm.get("gl_account_id")?.setValue(null);return}try{let i=await this.apiService.resolveGLAccount(e,t);i.success&&i.data?.glAccountId?this.ledgerForm.get("gl_account_id")?.setValue(i.data.glAccountId,{emitEvent:!1}):this.ledgerForm.get("gl_account_id")?.setValue(null,{emitEvent:!1})}catch(i){console.error("Error resolving GL account:",i),this.ledgerForm.get("gl_account_id")?.setValue(null,{emitEvent:!1})}}async handleFormSubmit(){if(this.submitted.set(!0),this.ledgerForm.invalid)return;let e=this.ledgerForm.get("vendor_tax_id")?.value;if(e&&e.trim().length>0){if(!/^\d{1,8}$/.test(e)){this.errorMessage.set("\u8CE3\u65B9\u7D71\u7DE8\u53EA\u80FD\u662F 1-8 \u4F4D\u6578\u5B57"),this.isLoading.set(!1);return}try{let t=await this.apiService.getVendorByTaxId(e);t.success&&t.data?this.ledgerForm.patchValue({vendor_id:t.data.vendor_id,vendor_name:t.data.vendor_name},{emitEvent:!1}):console.warn("\u8CE3\u65B9\u7D71\u7DE8\u4E0D\u5B58\u5728\u65BC\u7CFB\u7D71\u4E2D\uFF0C\u4F46\u5141\u8A31\u7E7C\u7E8C\u4FDD\u5B58\uFF08\u53EF\u80FD\u662F\u5E02\u5834\u8CB7\u7684\u8CA8\uFF09")}catch(t){console.warn("\u9A57\u8B49\u8CE3\u65B9\u7D71\u7DE8\u6642\u51FA\u932F\uFF1A",t)}}this.isLoading.set(!0),this.errorMessage.set(null);try{let t=this.ledgerForm.value,i={entry_date:t.entry_date,item_group:t.item_group,subject_name:t.subject_name,amount:Number(t.amount),invoice_no:t.invoice_no,vendor_tax_id:t.vendor_tax_id,vendor_name:t.vendor_name,vendor_id:t.vendor_id,description:t.description,is_sigh_off:t.is_sigh_off||!1,gl_account_id:t.gl_account_id||null};if(this.editingTransaction()){let r=this.editingTransaction();if((await this.apiService.updateLedgerEntry(V({entry_id:r.entry_id},i))).success){let a=this.allTransactions().map(u=>u.entry_id===r.entry_id?V(V({},u),i):u);this.allTransactions.set(a),this.closeModal()}}else{let r=await this.apiService.createLedgerEntry(i);if(r.success&&r.data){let o={entry_id:r.data.entry_id,entry_date:r.data.entry_date,item_group:r.data.item_group,subject_name:r.data.subject_name,amount:r.data.amount,invoice_no:r.data.invoice_no,vendor_tax_id:r.data.vendor_tax_id,vendor_name:r.data.vendor_name,vendor_id:r.data.vendor_id,description:r.data.description,is_sigh_off:r.data.is_sigh_off||!1,gl_account_id:r.data.gl_account_id||null};this.newlyCreatedEntry.set(o),this.resetForm(),await this.loadShipmentItemsForEntry(o.entry_id)}}}catch(t){console.error("\u4FDD\u5B58\u5931\u6557:",t),this.errorMessage.set("\u4FDD\u5B58\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoading.set(!1)}this.editingTransaction()||this.applyFilters()}resetForm(){this.ledgerForm.reset({is_sigh_off:!1}),this.submitted.set(!1)}resetAddView(){this.newlyCreatedEntry.set(null),this.shipmentItems.set([]),this.shipmentItemsError.set(null),this.resetForm()}formatCurrency(e){if(e==null||isNaN(e))return"";let t=e<0,r=Math.abs(e).toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0});return t?`-${r}`:r}getErrorMessage(e){let t=this.ledgerForm.get(e);if(!t||!t.errors)return"";if(e==="vendor_tax_id"){if(t.errors.pattern)return"\u8CE3\u65B9\u7D71\u7DE8\u53EA\u80FD\u662F 1-8 \u4F4D\u6578\u5B57";if(t.errors.required)return"\u8CE3\u65B9\u7D71\u7DE8\u70BA\u5FC5\u586B"}return t.errors.required?`${e} \u70BA\u5FC5\u586B`:t.errors.pattern?`${e} \u683C\u5F0F\u4E0D\u6B63\u78BA`:"\u8F38\u5165\u8CC7\u6599\u6709\u8AA4"}sanitizeVendorTaxId(e){return e?e.replace(/\D/g,"").slice(0,8):""}onVendorTaxIdInput(e){let t=e.target,i=this.sanitizeVendorTaxId(t.value);this.ledgerForm.get("vendor_tax_id")?.setValue(i)}formatDate(e){let t=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return`${t}-${i}-${r}`}normalizeDateInput(e){if(!e)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;let t=new Date(e);return Number.isNaN(t.getTime())?"":this.formatDate(t)}isInvalid(e){let t=this.ledgerForm.get(e);return!!t&&t.invalid&&(t.touched||this.submitted())}};Ua.\u0275fac=function(t){return new(t||Ua)},Ua.\u0275cmp=re({type:Ua,selectors:[["app-ledger"]],decls:18,vars:11,consts:[[1,"space-y-6"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-4","flex","items-center","gap-3"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4","flex","items-center","gap-3"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"border-b","border-gray-200"],["aria-label","Tabs",1,"-mb-px","flex","space-x-6"],[1,"whitespace-nowrap","py-4","px-1","border-b-2","font-medium","text-sm",3,"click"],[1,"pt-6"],[1,"space-y-4"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],["name","hourglass-outline",1,"text-blue-600","text-xl","animate-spin"],[1,"text-blue-700"],["name","alert-circle-outline",1,"text-red-600","text-xl"],[1,"text-red-700"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4","p-4","bg-gray-50","rounded-lg"],[1,"flex","items-center","gap-2"],["for","startDate",1,"text-sm","font-medium","text-gray-600","shrink-0"],[1,"relative","w-full"],["type","date","id","startDate",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white","pr-10",3,"ngModelChange","ngModel"],[1,"absolute","inset-y-0","right-0","flex","items-center","pr-3","pointer-events-none"],["name","calendar-outline",1,"text-gray-400"],["for","endDate",1,"text-sm","font-medium","text-gray-600","shrink-0"],["type","date","id","endDate",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white","pr-10",3,"ngModelChange","ngModel"],[1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white","disabled:bg-gray-100","disabled:cursor-not-allowed",3,"ngModelChange","ngModel","disabled"],[1,"lg:col-span-2"],["type","text","placeholder","\u641C\u5C0BID...","inputmode","numeric","pattern","[0-9]*",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["type","text","placeholder","\u641C\u5C0B\u8AAA\u660E\u95DC\u9375\u5B57...",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"flex","items-center","gap-2","lg:col-span-4","justify-end"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-4","py-3"],[1,"flex","items-center","justify-center","gap-2"],["type","checkbox","title","\u5168\u90E8\u7C3D\u6838/\u53D6\u6D88\u7C3D\u6838",1,"rounded","h-4","w-4","text-indigo-600","border-gray-300","focus:ring-indigo-500","cursor-pointer",3,"change","checked"],[1,"px-4","py-3","cursor-pointer",3,"click"],["name","swap-vertical-outline"],[1,"px-4","py-3","cursor-pointer","text-right",3,"click"],[1,"border-b","hover:bg-gray-50","cursor-pointer",3,"bg-red-50"],[1,"flex","flex-col","sm:flex-row","items-center","justify-between","gap-3","pt-4"],[1,"text-sm","text-gray-600"],["type","button",1,"px-3","py-1.5","text-sm","border","rounded-md","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["name","hourglass-outline",1,"animate-spin"],["name","filter-outline"],[1,"border-b","hover:bg-gray-50","cursor-pointer",3,"click"],[1,"px-4","py-2","text-center"],["type","checkbox","disabled","",1,"rounded","h-4","w-4","text-indigo-500","border-gray-300","cursor-not-allowed",3,"checked"],[1,"px-4","py-2"],[1,"px-4","py-2","text-right"],[1,"px-4","py-2","truncate","max-w-xs"],["colspan","9",1,"text-center","py-8","text-gray-500"],["novalidate","",1,"space-y-6","max-w-4xl","mx-auto",3,"formGroup"],[1,"max-w-4xl","mx-auto"],["novalidate","",1,"space-y-6","max-w-4xl","mx-auto",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],["for","date",1,"block","text-sm","font-medium","text-gray-700"],[1,"relative","mt-1"],["type","date","id","date","formControlName","entry_date",1,"block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2","pr-10"],["for","item",1,"block","text-sm","font-medium","text-gray-700"],["id","item","formControlName","item_group",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["value","","disabled",""],["for","category",1,"block","text-sm","font-medium","text-gray-700"],["id","category","formControlName","subject_name",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","amount",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","amount","formControlName","amount","placeholder","\u6B63\u6578\u70BA\u6536\u5165\uFF0C\u8CA0\u6578\u70BA\u8A72\u9805\u76EE\u5C0D\u6C96",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2","text-right"],["for","invoiceNumber",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","invoiceNumber","formControlName","invoice_no",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","vendorTaxId",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","vendorTaxId","formControlName","vendor_tax_id","inputmode","numeric","pattern","\\d*","maxlength","8",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2",3,"input"],[1,"md:col-span-2"],["for","vendorName",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","vendorName","formControlName","vendor_name",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","description",1,"block","text-sm","font-medium","text-gray-700"],["id","description","formControlName","description","rows","3",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],[1,"flex","justify-end","gap-4"],["type","button",1,"px-4","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],["type","submit",1,"px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-indigo-600","hover:bg-indigo-700"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-4","mb-6","flex","items-center","gap-3"],["name","checkmark-circle-outline",1,"text-blue-600","text-xl"],[1,"mt-8"],[1,"flex","items-center","justify-between","mb-4"],[1,"flex","items-center","gap-4","flex-grow"],[1,"text-lg","font-semibold","text-gray-900"],[1,"flex","items-center","gap-2","px-3","py-1.5","text-sm","text-green-700","bg-green-50","border","border-green-200","rounded-md"],[1,"flex","items-center","gap-2","text-sm","text-blue-600"],["type","button",1,"px-3","py-1.5","text-sm","bg-green-600","text-white","rounded-md","hover:bg-green-700","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","gap-1",3,"click","disabled"],["name","add-outline"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-3","text-red-700","text-sm","mb-4"],[1,"text-sm","text-gray-500"],[1,"flex","justify-end","gap-4","mt-6","pt-6","border-t"],["type","button",1,"px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-indigo-600","hover:bg-indigo-700",3,"click"],["name","checkmark-circle-outline",1,"text-green-600"],["name","refresh-outline",1,"animate-spin"],["name","alert-circle-outline"],[3,"class"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"block","text-xs","font-medium","text-gray-600"],["type","text",1,"mt-1","block","w-full","border","bg-white","rounded-md","shadow-sm","p-2",3,"ngModelChange","ngModel","name"],["type","number","step","0.01",1,"mt-1","block","w-full","border","bg-white","rounded-md","shadow-sm","p-2","text-right",3,"ngModelChange","ngModel","name"],["type","text","readonly","",1,"mt-1","block","w-full","border","bg-gray-100","rounded-md","shadow-sm","p-2","text-right",3,"value"],["rows","2",1,"mt-1","block","w-full","border","bg-white","rounded-md","shadow-sm","p-2",3,"ngModelChange","ngModel","name"],[1,"flex","justify-end","gap-2","mt-3"],["type","button",1,"px-3","py-1.5","text-sm","bg-red-600","text-white","rounded-md","hover:bg-red-700","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","gap-1",3,"click"],["name","trash-outline"],["type","button",1,"px-3","py-1.5","text-sm","bg-indigo-600","text-white","rounded-md","hover:bg-indigo-700","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-2xl","max-h-[90vh]","flex","flex-col"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],["novalidate","",1,"space-y-6",3,"ngSubmit","formGroup"],["for","modal-date",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","modal-date","formControlName","entry_date",1,"block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2","pr-10"],["for","modal-item",1,"block","text-sm","font-medium","text-gray-700"],["id","modal-item","formControlName","item_group",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","modal-category",1,"block","text-sm","font-medium","text-gray-700"],["id","modal-category","formControlName","subject_name",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","modal-amount",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","modal-amount","formControlName","amount",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2","text-right"],["for","modal-invoiceNumber",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","modal-invoiceNumber","formControlName","invoice_no",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","modal-vendorTaxId",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","modal-vendorTaxId","formControlName","vendor_tax_id","inputmode","numeric","pattern","\\d*","maxlength","8",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2",3,"input"],[1,"mt-1","text-sm","text-red-600"],["for","modal-vendorName",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","modal-vendorName","formControlName","vendor_name","readonly","",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2","cursor-not-allowed","opacity-60"],["for","modal-description",1,"block","text-sm","font-medium","text-gray-700"],["id","modal-description","formControlName","description","rows","3",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],[1,"flex","items-center","space-x-2"],["type","checkbox","formControlName","is_sigh_off",1,"rounded","h-4","w-4","text-indigo-600","focus:ring-indigo-500","border-gray-300"],[1,"text-sm","text-gray-700"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-6"],["type","button",1,"px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-red-600","hover:bg-red-700",3,"click"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-[60]"],[1,"mt-8","pt-6","border-t"],[1,"bg-white","rounded-lg","shadow-lg","p-6","max-w-md","w-full","mx-4"],[1,"flex","items-center","gap-3","mb-4"],["name","warning-outline",1,"text-2xl","text-orange-600"],[1,"space-y-3","mb-6"],[1,"text-gray-700"],[1,"bg-red-50","border","border-red-200","rounded-md","p-3"],[1,"flex","justify-end","gap-3"],[1,"px-4","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],[1,"px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-red-600","hover:bg-red-700",3,"click"],[1,"text-sm","text-red-700"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","m-4"],[1,"p-6","text-center"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-blue-100"],["name","help-outline",1,"h-6","w-6","text-blue-600"],[1,"mt-4","text-lg","font-semibold","text-gray-900"],[1,"mt-2","text-sm","text-gray-500"],[1,"flex","justify-center","gap-4","bg-gray-50","px-6","py-4","rounded-b-xl"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","button",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","hover:bg-indigo-700",3,"click"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100"],["name","trash-outline",1,"h-6","w-6","text-red-600"],[1,"mt-1","text-xs","text-gray-400"],["type","button",1,"px-4","py-2","bg-red-600","text-white","rounded-md","hover:bg-red-700",3,"click"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"h1",1),d(2,"\u6D41\u6C34\u5E33"),s(),M(3,wV,4,0,"div",2),M(4,TV,4,1,"div",3),l(5,"div",4)(6,"div",5)(7,"nav",6)(8,"button",7),b("click",function(){return i.changeView("details")}),d(9," \u6D41\u6C34\u5E33\u7D30\u9805 "),s(),l(10,"button",7),b("click",function(){return i.changeView("add")}),d(11," \u65B0\u589E\u5E33\u52D9 "),s()()(),l(12,"div",8),M(13,kV,88,17,"div",9),M(14,YV,2,1),s()()(),M(15,l9,80,21,"div",10),M(16,u9,14,1,"div",10),M(17,d9,16,1,"div",10)),t&2){let r,o;f(3),A(i.isLoading()?3:-1),f(),A(i.errorMessage()?4:-1),f(4),De(i.activeView()==="details"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),f(2),De(i.activeView()==="add"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),f(3),A(i.activeView()==="details"?13:-1),f(),A(i.activeView()==="add"?14:-1),f(),A(i.isModalOpen()?15:-1),f(),A((r=i.confirmationState())?16:-1,r),f(),A((o=i.deleteConfirmation())?17:-1,o)}},dependencies:[oe,Se,Be,Fe,Pe,xe,kt,mo,Re,me,Le,ql,Wl,Ie,ke,Ue,Ge],encapsulation:2,changeDetection:0});var ep=Ua;var vo=class vo{constructor(){this.holidays2024=[{date:"2024-01-01",name:"\u5143\u65E6"},{date:"2024-02-08",name:"\u8FB2\u66C6\u6625\u7BC0"},{date:"2024-02-09",name:"\u8FB2\u66C6\u6625\u7BC0"},{date:"2024-02-10",name:"\u8FB2\u66C6\u6625\u7BC0"},{date:"2024-02-11",name:"\u8FB2\u66C6\u6625\u7BC0"},{date:"2024-02-12",name:"\u8FB2\u66C6\u6625\u7BC0"},{date:"2024-02-13",name:"\u8FB2\u66C6\u6625\u7BC0"},{date:"2024-02-14",name:"\u8FB2\u66C6\u6625\u7BC0"},{date:"2024-02-28",name:"\u548C\u5E73\u7D00\u5FF5\u65E5"},{date:"2024-04-04",name:"\u5152\u7AE5\u7BC0"},{date:"2024-04-05",name:"\u6E05\u660E\u7BC0"},{date:"2024-06-10",name:"\u7AEF\u5348\u7BC0"},{date:"2024-09-17",name:"\u4E2D\u79CB\u7BC0"},{date:"2024-10-10",name:"\u570B\u6176\u65E5"}]}getHolidays(e){return e===2024?this.holidays2024:[]}};vo.\u0275fac=function(t){return new(t||vo)},vo.\u0275prov=Z({token:vo,factory:vo.\u0275fac,providedIn:"root"});var tp=vo;var c9=()=>({month:"long"}),m9=()=>["\u65E5","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D"],p9=(n,e)=>e.date,f9=(n,e)=>e.id;function g9(n,e){if(n&1&&(tt(0,"div",7),d(1),nt()),n&2){let t=e.$implicit;f(),E(t)}}function h9(n,e){if(n&1&&(tt(0,"div",12),d(1),nt()),n&2){let t=_().$implicit;f(),k(" ",t.holiday.name," ")}}function y9(n,e){if(n&1){let t=B();tt(0,"div",14),ta("click",function(){let r=D(t).$implicit,o=_(2);return w(o.editEvent(r))}),d(1),nt()}if(n&2){let t=e.$implicit;W("opacity-60",t.status==="cancelled")("line-through",t.status==="cancelled"),f(),k(" ",t.name," ")}}function _9(n,e){if(n&1&&(tt(0,"div",9)(1,"time",10),d(2),nt(),tt(3,"div",11),M(4,h9,2,1,"div",12),O(5,y9,2,5,"div",13,f9),nt()()),n&2){let t=e.$implicit;W("bg-gray-50",!t.isCurrentMonth),f(),W("text-gray-400",!t.isCurrentMonth)("bg-indigo-600",t.isToday)("text-white",t.isToday)("rounded-full",t.isToday)("w-6",t.isToday)("h-6",t.isToday)("flex",t.isToday)("items-center",t.isToday)("justify-center",t.isToday),Jd("dateTime",t.date.toISOString()),f(),k(" ",t.date.getDate()," "),f(2),A(t.holiday?4:-1),f(),L(t.events)}}var $a=class $a{constructor(){this.holidayService=P(tp);this.router=P(Ve);this.events=ec.required();this.currentDate=S(new Date("2024-10-01"));this.holidays=S([]);this.calendarGrid=H(()=>{let e=this.events(),t=this.holidays(),i=this.currentDate(),r=i.getFullYear(),o=i.getMonth(),a=new Date(r,o,1),u=new Date(r,o+1,0),c=a.getDay(),m=new Date(a);m.setDate(a.getDate()-c);let h=[],y=new Date;y.setHours(0,0,0,0);for(let v=0;v<42;v++){let C=new Date(m);C.setDate(m.getDate()+v);let T=this.formatDate(C);h.push({date:C,isCurrentMonth:C.getMonth()===o,isToday:C.getTime()===y.getTime(),events:e.filter(R=>R.date===T),holiday:t.find(R=>R.date===T)})}return h});this.loadHolidays()}formatDate(e){let t=e.getFullYear(),i=(e.getMonth()+1).toString().padStart(2,"0"),r=e.getDate().toString().padStart(2,"0");return`${t}-${i}-${r}`}loadHolidays(){let e=this.currentDate().getFullYear();this.holidays.set(this.holidayService.getHolidays(e))}previousMonth(){this.currentDate.update(e=>{let t=new Date(e);return t.setMonth(e.getMonth()-1),t}),this.loadHolidays()}nextMonth(){this.currentDate.update(e=>{let t=new Date(e);return t.setMonth(e.getMonth()+1),t}),this.loadHolidays()}editEvent(e){this.router.navigate(["/events/edit",e.id])}};$a.\u0275fac=function(t){return new(t||$a)},$a.\u0275cmp=re({type:$a,selectors:[["app-calendar-view"]],inputs:{events:[1,"events"]},decls:13,vars:4,consts:[[1,"space-y-4"],[1,"flex","items-center","justify-between"],[1,"p-2","rounded-full","hover:bg-gray-100","transition-colors",3,"click"],["name","chevron-back-outline",1,"text-xl","text-gray-600"],[1,"text-xl","font-semibold","text-gray-800"],["name","chevron-forward-outline",1,"text-xl","text-gray-600"],[1,"grid","grid-cols-7","gap-px","bg-gray-200","border","border-gray-200","rounded-lg","overflow-hidden"],[1,"py-2","text-center","text-sm","font-medium","text-gray-600","bg-gray-50"],[1,"relative","min-h-[120px]","bg-white","p-2",3,"bg-gray-50"],[1,"relative","min-h-[120px]","bg-white","p-2"],[1,"text-sm","font-medium",3,"dateTime"],[1,"mt-2","space-y-1","overflow-hidden"],[1,"text-xs","text-red-700","bg-red-100","rounded","px-1","py-0.5","truncate","font-medium"],[1,"text-xs","text-indigo-800","bg-indigo-100","rounded","px-1","py-0.5","cursor-pointer","hover:bg-indigo-200","truncate",3,"opacity-60","line-through"],[1,"text-xs","text-indigo-800","bg-indigo-100","rounded","px-1","py-0.5","cursor-pointer","hover:bg-indigo-200","truncate",3,"click"]],template:function(t,i){t&1&&(tt(0,"div",0)(1,"div",1)(2,"button",2),ta("click",function(){return i.previousMonth()}),qi(3,"ion-icon",3),nt(),tt(4,"h2",4),d(5),nt(),tt(6,"button",2),ta("click",function(){return i.nextMonth()}),qi(7,"ion-icon",5),nt()(),tt(8,"div",6),O(9,g9,2,1,"div",7,j),O(11,_9,7,23,"div",8,p9),nt()()),t&2&&(f(5),Ke(" ",i.currentDate().getFullYear(),"\u5E74 ",i.currentDate().toLocaleString("zh-TW",wt(2,c9))," "),f(4),L(wt(3,m9)),f(2),L(i.calendarGrid()))},dependencies:[oe],encapsulation:2,changeDetection:0});var np=$a;var v9=(n,e)=>e.value,C9=(n,e)=>e.id;function x9(n,e){if(n&1&&(l(0,"option",15),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),k("",t,"\u5E74")}}function b9(n,e){if(n&1&&(l(0,"option",15),d(1),s()),n&2){let t=e.$implicit;I("value",t.value),f(),E(t.label)}}function E9(n,e){if(n&1){let t=B();l(0,"tr",35),b("click",function(){let r=D(t).$implicit,o=_(2);return w(o.editEvent(r))}),l(1,"td",36),d(2),s(),l(3,"td",36),d(4),s(),l(5,"td",36),d(6),s(),l(7,"td",36),d(8),s(),l(9,"td",37),d(10),s(),l(11,"td",36),d(12),s(),l(13,"td",36),d(14),s(),l(15,"td",38),d(16),s(),l(17,"td",38),d(18),s(),l(19,"td",39),d(20),s(),l(21,"td",40),d(22),s()()}if(n&2){let t=e.$implicit,i=e.$index,r=_(2);W("text-gray-400",t.status==="cancelled")("line-through",t.status==="cancelled"),f(2),E((r.currentPage()-1)*r.pageSize+i+1),f(2),E(t.type),f(2),E(r.formatDateForDisplay(t.date)),f(2),E(t.time),f(2),E(t.name),f(2),E(t.organizer),f(2),E(t.attendees),f(2),E(r.formatCurrency(t.estimatedRevenue)),f(2),E(r.formatCurrency(t.deposit)),f(2),E(r.formatCurrency(t.actualRevenue)),f(2),E(t.notes)}}function S9(n,e){n&1&&(l(0,"tr")(1,"td",41),d(2,"\u627E\u4E0D\u5230\u7B26\u5408\u689D\u4EF6\u7684\u6D3B\u52D5\u3002"),s()())}function D9(n,e){if(n&1){let t=B();l(0,"div",34)(1,"span",42),d(2),s(),l(3,"div",12)(4,"button",43),b("click",function(){D(t);let r=_(2);return w(r.prevPage())}),x(5,"ion-icon",44),s(),l(6,"span",45),d(7),s(),l(8,"button",43),b("click",function(){D(t);let r=_(2);return w(r.nextPage())}),x(9,"ion-icon",46),s()()()}if(n&2){let t=_(2);f(2),Kt(" \u986F\u793A\u7B2C ",(t.currentPage()-1)*t.pageSize+1," \u81F3 ",t.Math.min(t.currentPage()*t.pageSize,t.filteredEvents().length)," \u7B46\uFF0C\u5171 ",t.filteredEvents().length," \u7B46 "),f(2),I("disabled",t.currentPage()===1),f(3),Ke("\u7B2C ",t.currentPage()," \u9801 / \u5171 ",t.totalPages()," \u9801"),f(),I("disabled",t.currentPage()===t.totalPages())}}function w9(n,e){if(n&1){let t=B();l(0,"div",26)(1,"table",27)(2,"thead",28)(3,"tr")(4,"th",29),d(5,"\u7DE8\u865F"),s(),l(6,"th",30),b("click",function(){D(t);let r=_();return w(r.sortData("type"))}),d(7,"\u985E\u578B "),x(8,"ion-icon",31),s(),l(9,"th",30),b("click",function(){D(t);let r=_();return w(r.sortData("date"))}),d(10,"\u65E5\u671F "),x(11,"ion-icon",31),s(),l(12,"th",30),b("click",function(){D(t);let r=_();return w(r.sortData("time"))}),d(13,"\u6642\u9593 "),x(14,"ion-icon",31),s(),l(15,"th",30),b("click",function(){D(t);let r=_();return w(r.sortData("name"))}),d(16,"\u540D\u7A31 "),x(17,"ion-icon",31),s(),l(18,"th",30),b("click",function(){D(t);let r=_();return w(r.sortData("organizer"))}),d(19,"\u4ECB\u7D39\u4EBA "),x(20,"ion-icon",31),s(),l(21,"th",30),b("click",function(){D(t);let r=_();return w(r.sortData("attendees"))}),d(22,"\u4EBA\u6578 "),x(23,"ion-icon",31),s(),l(24,"th",32),b("click",function(){D(t);let r=_();return w(r.sortData("estimatedRevenue"))}),d(25,"\u9810\u8A08\u6536\u5165 "),x(26,"ion-icon",31),s(),l(27,"th",32),b("click",function(){D(t);let r=_();return w(r.sortData("deposit"))}),d(28,"\u8A02\u91D1 "),x(29,"ion-icon",31),s(),l(30,"th",32),b("click",function(){D(t);let r=_();return w(r.sortData("actualRevenue"))}),d(31,"\u5BE6\u969B\u6536\u5165 "),x(32,"ion-icon",31),s(),l(33,"th",30),b("click",function(){D(t);let r=_();return w(r.sortData("notes"))}),d(34,"\u5099\u8A3B "),x(35,"ion-icon",31),s()()(),l(36,"tbody"),O(37,E9,23,15,"tr",33,C9,!1,S9,3,0,"tr"),s()()(),M(40,D9,10,7,"div",34)}if(n&2){let t=_();f(37),L(t.paginatedEvents()),f(3),A(t.totalPages()>1?40:-1)}}function T9(n,e){if(n&1&&x(0,"app-calendar-view",25),n&2){let t=_();I("events",t.filteredEvents())}}var Ha=class Ha{constructor(){this.dataService=P(Bt);this.router=P(Ve);this.allEvents=S([]);this.searchTerm=S("");this.activeView=S("list");this.availableYears=S([]);this.availableMonths=S([]);this.selectedYear=S(2024);this.selectedMonth=S(10);this.appliedFilters=S({year:2024,month:10});this.currentPage=S(1);this.pageSize=10;this.Math=Math;this.sortColumn=S("date");this.sortDirection=S("asc");this.filteredEvents=H(()=>{let e=this.searchTerm().toLowerCase(),{year:t,month:i}=this.appliedFilters(),r=this.allEvents();if(t){let c=t.toString();if(i!==0){let m=String(i).padStart(2,"0"),h=`${c}-${m}`;r=r.filter(y=>y.date.startsWith(h))}else r=r.filter(m=>m.date.startsWith(c))}e&&(r=r.filter(c=>c.name.toLowerCase().includes(e)||c.date.includes(e)));let o=this.sortColumn(),a=this.sortDirection(),u=[...r];return u.sort((c,m)=>{let h=c[o],y=m[o];return h==null&&y!=null?1:h!=null&&y==null?-1:h==null&&y==null?0:h<y?a==="asc"?-1:1:h>y?a==="asc"?1:-1:0}),u});this.paginatedEvents=H(()=>{let e=this.filteredEvents(),t=(this.currentPage()-1)*this.pageSize;return e.slice(t,t+this.pageSize)});this.totalPages=H(()=>Math.ceil(this.filteredEvents().length/this.pageSize));this.eventsSummary=H(()=>{let t=this.filteredEvents().filter(a=>a.status==="active"),i=t.reduce((a,u)=>a+u.estimatedRevenue,0),r=t.reduce((a,u)=>a+u.actualRevenue,0),o=r/2e5*100;return{estimatedRevenue:i,actualRevenue:r,targetRevenue:2e5,achievementRate:o}});this.loadEvents(),this.setupFilters()}loadEvents(){this.allEvents.set(this.dataService.getEvents())}setupFilters(){let e=[...new Set(this.allEvents().map(i=>new Date(i.date).getFullYear()))].sort((i,r)=>r-i);this.availableYears.set(e),this.availableMonths.set([{value:0,label:"\u5168\u5E74"},...Array.from({length:12},(i,r)=>({value:r+1,label:`${r+1}\u6708`}))]);let t=e.includes(2024)?2024:e[0]||new Date().getFullYear();this.selectedYear.set(t),this.selectedMonth.set(10),this.appliedFilters.set({year:t,month:10})}applyFilter(){this.appliedFilters.set({year:this.selectedYear(),month:this.selectedMonth()}),this.currentPage.set(1)}resetFilter(){let e=this.availableYears().includes(2024)?2024:this.availableYears()[0]||new Date().getFullYear();this.selectedYear.set(e),this.selectedMonth.set(10),this.applyFilter()}onSearchChange(e){this.searchTerm.set(e),this.currentPage.set(1)}sortData(e){this.sortColumn()===e?this.sortDirection.update(t=>t==="asc"?"desc":"asc"):(this.sortColumn.set(e),this.sortDirection.set("asc"))}goToPage(e){e>=1&&e<=this.totalPages()&&this.currentPage.set(e)}nextPage(){this.goToPage(this.currentPage()+1)}prevPage(){this.goToPage(this.currentPage()-1)}editEvent(e){this.router.navigate(["/events/edit",e.id])}formatDateForDisplay(e){let t=new Date(e),i=t.getMonth()+1,r=t.getDate(),o=["\u65E5","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D"][t.getDay()];return`${i}/${r} (${o})`}formatCurrency(e){return e==null?"":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}setView(e){this.activeView.set(e)}};Ha.\u0275fac=function(t){return new(t||Ha)},Ha.\u0275cmp=re({type:Ha,selectors:[["app-events"]],decls:55,vars:32,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],["routerLink","/events/new",1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm"],["name","add-outline"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-4","gap-6"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"text-sm","text-gray-500"],[1,"text-2xl","font-semibold","text-gray-900"],[1,"text-2xl","font-semibold"],[1,"flex","flex-wrap","justify-between","items-center","gap-4","mb-4","border-b","pb-4"],[1,"flex","flex-wrap","items-center","gap-4"],[1,"flex","items-center","gap-2"],[1,"text-sm","font-medium","text-gray-600","shrink-0"],[1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-50","pr-8",3,"ngModelChange","ngModel"],[3,"value"],[1,"bg-indigo-600","text-white","px-3","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-1","text-sm",3,"click"],["name","filter-outline"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],["type","text","placeholder","\u4F9D\u6D3B\u52D5\u540D\u7A31\u6216\u65E5\u671F\u641C\u5C0B...",1,"w-full","sm:w-auto","flex-grow","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"flex","items-center","border","border-gray-200","rounded-lg","p-1","space-x-1","bg-gray-50","shrink-0"],[1,"px-3","py-1","text-sm","font-medium","rounded-md","transition-colors","flex","items-center","gap-2",3,"click"],["name","list-outline"],["name","calendar-outline"],[3,"events"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-4","py-3"],[1,"px-4","py-3","cursor-pointer",3,"click"],["name","swap-vertical-outline"],[1,"px-4","py-3","cursor-pointer","text-right",3,"click"],[1,"border-b","hover:bg-gray-50","cursor-pointer",3,"text-gray-400","line-through"],[1,"flex","justify-between","items-center","pt-4","border-t","mt-4"],[1,"border-b","hover:bg-gray-50","cursor-pointer",3,"click"],[1,"px-4","py-2"],[1,"px-4","py-2","font-medium"],[1,"px-4","py-2","text-right"],[1,"px-4","py-2","text-right","font-semibold"],[1,"px-4","py-2","truncate","max-w-xs"],["colspan","11",1,"text-center","py-8","text-gray-500"],[1,"text-sm","text-gray-600"],[1,"px-3","py-1","border","rounded-md","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["name","chevron-back-outline"],[1,"text-sm"],["name","chevron-forward-outline"]],template:function(t,i){t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),d(3,"\u6D3B\u52D5\u7BA1\u7406"),s(),l(4,"a",3),x(5,"ion-icon",4),l(6,"span"),d(7,"\u65B0\u589E\u6D3B\u52D5"),s()()(),l(8,"div",5)(9,"div",6)(10,"p",7),d(11,"\u9810\u8A08\u7E3D\u6536\u5165"),s(),l(12,"p",8),d(13),s()(),l(14,"div",6)(15,"p",7),d(16,"\u5BE6\u969B\u7E3D\u6536\u5165"),s(),l(17,"p",8),d(18),s()(),l(19,"div",6)(20,"p",7),d(21,"\u76EE\u6A19\u6536\u5165"),s(),l(22,"p",8),d(23),s()(),l(24,"div",6)(25,"p",7),d(26,"\u76EE\u6A19\u9054\u6210\u7387"),s(),l(27,"p",9),d(28),s()()(),l(29,"div",6)(30,"div",10)(31,"div",11)(32,"div",12)(33,"label",13),d(34,"\u6642\u9593:"),s(),l(35,"select",14),J("ngModelChange",function(o){return K(i.selectedYear,o)||(i.selectedYear=o),o}),O(36,x9,2,2,"option",15,j),s(),l(38,"select",14),J("ngModelChange",function(o){return K(i.selectedMonth,o)||(i.selectedMonth=o),o}),O(39,b9,2,2,"option",15,v9),s(),l(41,"button",16),b("click",function(){return i.applyFilter()}),x(42,"ion-icon",17),s(),l(43,"button",18),b("click",function(){return i.resetFilter()}),x(44,"ion-icon",19),s()(),l(45,"input",20),b("ngModelChange",function(o){return i.onSearchChange(o)}),s()(),l(46,"div",21)(47,"button",22),b("click",function(){return i.setView("list")}),x(48,"ion-icon",23),d(49," \u5217\u8868 "),s(),l(50,"button",22),b("click",function(){return i.setView("calendar")}),x(51,"ion-icon",24),d(52," \u65E5\u66C6 "),s()()(),M(53,w9,41,2)(54,T9,1,1,"app-calendar-view",25),s()()),t&2&&(f(13),E(i.formatCurrency(i.eventsSummary().estimatedRevenue)),f(5),E(i.formatCurrency(i.eventsSummary().actualRevenue)),f(5),E(i.formatCurrency(i.eventsSummary().targetRevenue)),f(4),W("text-green-600",i.eventsSummary().achievementRate>=100)("text-red-600",i.eventsSummary().achievementRate<100),f(),k(" ",i.eventsSummary().achievementRate.toFixed(1),"% "),f(7),Y("ngModel",i.selectedYear),f(),L(i.availableYears()),f(2),Y("ngModel",i.selectedMonth),f(),L(i.availableMonths()),f(6),I("ngModel",i.searchTerm()),f(2),W("bg-white",i.activeView()==="list")("shadow-sm",i.activeView()==="list")("text-indigo-600",i.activeView()==="list")("text-gray-600",i.activeView()!=="list")("hover:bg-gray-200",i.activeView()!=="list"),f(3),W("bg-white",i.activeView()==="calendar")("shadow-sm",i.activeView()==="calendar")("text-indigo-600",i.activeView()==="calendar")("text-gray-600",i.activeView()!=="calendar")("hover:bg-gray-200",i.activeView()!=="calendar"),f(3),A(i.activeView()==="list"?53:54))},dependencies:[oe,Se,Fe,Pe,xe,Re,me,Ie,Cr,np],encapsulation:2,changeDetection:0});var ip=Ha;function I9(n,e){if(n&1){let t=B();l(0,"button",35),b("click",function(){D(t);let r=_();return w(r.onDelete())}),d(1," \u522A\u9664\u6D3B\u52D5 "),s()}}var Ga=class Ga{constructor(){this.fb=P(je);this.dataService=P(Bt);this.router=P(Ve);this.route=P(un);this.isEditMode=S(!1);this.eventId=S(null);this.submitted=S(!1);this.eventForm=this.fb.group({type:["",U.required],status:["active",U.required],date:["",U.required],time:[""],name:["",U.required],organizer:[""],attendees:["",U.required],estimatedRevenue:[0,[U.required,U.min(0)]],deposit:[null],actualRevenue:[0,[U.required,U.min(0)]],notes:[""]});this.route.paramMap.pipe(he(e=>e.get("id")),et(e=>{this.isEditMode.set(!!e),this.eventId.set(e)}),Mt(e=>!!e),he(e=>this.dataService.getEventById(e)),et(e=>{e?this.eventForm.patchValue(e):(alert("\u627E\u4E0D\u5230\u6D3B\u52D5\uFF01"),this.router.navigate(["/events"]))})).subscribe()}isInvalid(e){let t=this.eventForm.get(e);return!!t&&t.invalid&&(t.touched||this.submitted())}onSubmit(){if(this.submitted.set(!0),this.eventForm.invalid){alert("\u8ACB\u6AA2\u67E5\u8868\u55AE\u4E26\u586B\u5BEB\u6240\u6709\u5FC5\u586B\u6B04\u4F4D\u3002");return}let e=this.eventForm.getRawValue(),t=G(V({},e),{deposit:e.deposit??void 0});this.isEditMode()&&this.eventId()?(this.dataService.updateEvent(G(V({},t),{id:this.eventId()})),alert("\u6D3B\u52D5\u5DF2\u6210\u529F\u66F4\u65B0\uFF01")):(this.dataService.addEvent(t),alert("\u6D3B\u52D5\u5DF2\u6210\u529F\u65B0\u589E\uFF01")),this.router.navigate(["/events"])}onDelete(){this.isEditMode()&&this.eventId()&&confirm("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u6B64\u6D3B\u52D5\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002")&&(this.dataService.deleteEvent(this.eventId()),alert("\u6D3B\u52D5\u5DF2\u522A\u9664\u3002"),this.router.navigate(["/events"]))}onCancel(){this.router.navigate(["/events"])}};Ga.\u0275fac=function(t){return new(t||Ga)},Ga.\u0275cmp=re({type:Ga,selectors:[["app-event-form"]],decls:61,vars:18,consts:[[1,"space-y-6","max-w-4xl","mx-auto"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-white","p-6","md:p-8","rounded-xl","shadow-md"],["novalidate","",1,"space-y-6",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-x-6","gap-y-4"],[1,"md:col-span-2"],["for","name",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","name","formControlName","name",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","date",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","date","formControlName","date",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","time",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","time","formControlName","time","placeholder","\u4F8B\u5982: 14:30~18:30",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","type",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","type","formControlName","type",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","attendees",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","attendees","formControlName","attendees","placeholder","\u4F8B\u5982: 10~15",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","organizer",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","organizer","formControlName","organizer",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","estimatedRevenue",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","estimatedRevenue","formControlName","estimatedRevenue",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","deposit",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","deposit","formControlName","deposit",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","actualRevenue",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","actualRevenue","formControlName","actualRevenue",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","status",1,"block","text-sm","font-medium","text-gray-700"],["id","status","formControlName","status",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["value","active"],["value","cancelled"],["for","notes",1,"block","text-sm","font-medium","text-gray-700"],["id","notes","formControlName","notes","rows","4",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],[1,"flex","items-center","justify-end","gap-4","pt-4","border-t","mt-6"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-red-600","bg-transparent","hover:bg-red-50","rounded-md"],[1,"flex-grow"],["type","button",1,"px-4","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],["type","submit",1,"px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-indigo-600","hover:bg-indigo-700"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-red-600","bg-transparent","hover:bg-red-50","rounded-md",3,"click"]],template:function(t,i){t&1&&(l(0,"div",0)(1,"h1",1),d(2),s(),l(3,"div",2)(4,"form",3),b("ngSubmit",function(){return i.onSubmit()}),l(5,"div",4)(6,"div",5)(7,"label",6),d(8,"\u6D3B\u52D5\u540D\u7A31*"),s(),x(9,"input",7),s(),l(10,"div")(11,"label",8),d(12,"\u65E5\u671F*"),s(),x(13,"input",9),s(),l(14,"div")(15,"label",10),d(16,"\u6642\u9593"),s(),x(17,"input",11),s(),l(18,"div")(19,"label",12),d(20,"\u985E\u578B*"),s(),x(21,"input",13),s(),l(22,"div")(23,"label",14),d(24,"\u4EBA\u6578*"),s(),x(25,"input",15),s(),l(26,"div",5)(27,"label",16),d(28,"\u4ECB\u7D39\u4EBA"),s(),x(29,"input",17),s(),l(30,"div")(31,"label",18),d(32,"\u9810\u8A08\u5831\u540D\u6536\u5165*"),s(),x(33,"input",19),s(),l(34,"div")(35,"label",20),d(36,"\u8A02\u91D1"),s(),x(37,"input",21),s(),l(38,"div")(39,"label",22),d(40,"\u5BE6\u969B\u7E3D\u6536\u5165*"),s(),x(41,"input",23),s(),l(42,"div")(43,"label",24),d(44,"\u72C0\u614B*"),s(),l(45,"select",25)(46,"option",26),d(47,"\u9032\u884C\u4E2D"),s(),l(48,"option",27),d(49,"\u5DF2\u53D6\u6D88"),s()()(),l(50,"div",5)(51,"label",28),d(52,"\u5099\u8A3B"),s(),x(53,"textarea",29),s()(),l(54,"div",30),M(55,I9,2,0,"button",31),x(56,"div",32),l(57,"button",33),b("click",function(){return i.onCancel()}),d(58," \u53D6\u6D88 "),s(),l(59,"button",34),d(60),s()()()()()),t&2&&(f(2),k(" ",i.isEditMode()?"\u7DE8\u8F2F\u6D3B\u52D5":"\u65B0\u589E\u6D3B\u52D5"," "),f(2),I("formGroup",i.eventForm),f(5),W("border-red-500",i.isInvalid("name")),f(4),W("border-red-500",i.isInvalid("date")),f(8),W("border-red-500",i.isInvalid("type")),f(4),W("border-red-500",i.isInvalid("attendees")),f(8),W("border-red-500",i.isInvalid("estimatedRevenue")),f(8),W("border-red-500",i.isInvalid("actualRevenue")),f(4),W("border-red-500",i.isInvalid("status")),f(10),A(i.isEditMode()?55:-1),f(5),k(" ",i.isEditMode()?"\u5132\u5B58\u8B8A\u66F4":"\u5132\u5B58\u6D3B\u52D5"," "))},dependencies:[oe,ke,Be,Fe,Pe,xe,kt,Re,me,Le,Ue,Ge],encapsulation:2,changeDetection:0});var Xl=Ga;var M9=["dailyRevenueChart"],A9=(n,e)=>e.transactionDate;function R9(n,e){if(n&1&&(l(0,"option",8),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),k("",t,"\u5E74")}}function N9(n,e){if(n&1&&(l(0,"option",8),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),k("",t,"\u6708")}}function F9(n,e){if(n&1&&(l(0,"div",14),x(1,"ion-icon",16),l(2,"span"),d(3),s()()),n&2){let t=_();f(3),E(t.errorMessage())}}function P9(n,e){n&1&&(l(0,"div",15),x(1,"div",17),s())}function k9(n,e){if(n&1&&d(0),n&2){let t=_().$implicit,i=_(2);k(" ",i.formatCurrency(t.debitAmount)," ")}}function V9(n,e){if(n&1&&d(0),n&2){let t=_().$implicit,i=_(2);k(" ",i.formatCurrency(t.creditAmount)," ")}}function O9(n,e){n&1&&d(0," \u516C\u4F11\u65E5 ")}function L9(n,e){n&1&&d(0," 0 ")}function B9(n,e){if(n&1&&M(0,O9,1,0)(1,L9,1,0),n&2){let t=_().$implicit,i=_(2);A(i.isClosedDay(t.transactionDate,!1)?0:1)}}function U9(n,e){if(n&1&&(l(0,"tr",33)(1,"td",34),d(2),s(),l(3,"td",35),M(4,k9,1,1)(5,V9,1,1)(6,B9,2,1),s()()),n&2){let t=e.$implicit,i=_(2);f(2),E(i.formatDate(t.transactionDate)),f(2),A(t.debitAmount>0?4:t.creditAmount>0?5:6)}}function $9(n,e){n&1&&(l(0,"tr")(1,"td",36),d(2,"\u627E\u4E0D\u5230\u8A72\u6708\u4EFD\u7684\u92B7\u8CA8\u6536\u5165\u8CC7\u6599\u3002"),s()())}function H9(n,e){if(n&1&&(l(0,"div",18)(1,"div",19)(2,"p",20),d(3,"\u6708\u71DF\u6536\u76EE\u6A19"),s(),l(4,"p",21),d(5),s()(),l(6,"div",19)(7,"p",20),d(8,"\u6BCF\u65E5\u5E73\u5747\u76EE\u6A19"),s(),l(9,"p",21),d(10),s()(),l(11,"div",19)(12,"p",20),d(13,"\u76EE\u6A19\u5DEE\u984D"),s(),l(14,"p",22),d(15),s()(),l(16,"div",19)(17,"p",20),d(18,"\u672C\u6708\u7D2F\u8A08\u71DF\u6536"),s(),l(19,"p",21),d(20),s()(),l(21,"div",19)(22,"p",20),d(23,"\u6708\u71DF\u6536\u76EE\u6A19\u9054\u6210\u7387"),s(),l(24,"p",22),d(25),s()()(),l(26,"div",23)(27,"h3",24),d(28,"\u6BCF\u65E5\u71DF\u6536\u8DA8\u52E2"),s(),l(29,"div",25),x(30,"canvas",null,0),s()(),l(32,"div",23)(33,"h3",24),d(34,"\u7576\u65E5\u71DF\u6536\u660E\u7D30"),s(),l(35,"div",26),x(36,"ion-icon",27),d(37," \u9019\u500B\u8868\u683C\u986F\u793A\u6240\u9078\u64C7\u7684\u6708\u4EFD\u4E2D\uFF0C\u5F9E\u6D41\u6C34\u5E33\u6578\u64DA\u8868\u62C9\u53D6\u7684\u6240\u6709\u7B97\u7B26\u540D\u7A31\u70BA\u300C\u92B7\u8CA8\u6536\u5165\u300D\u7684\u4EA4\u6613\u7D00\u9304\uFF0C\u4E26\u4F9D\u7167\u4EA4\u6613\u6642\u9593\u5347\u5E8F\u6392\u5217\u3002 "),s(),l(38,"div",28)(39,"table",29)(40,"thead",30)(41,"tr")(42,"th",31),d(43,"\u4EA4\u6613\u65E5\u671F"),s(),l(44,"th",32),d(45,"\u91D1\u984D"),s()()(),l(46,"tbody"),O(47,U9,7,2,"tr",33,A9,!1,$9,3,0,"tr"),s()()()()),n&2){let t=_();f(5),E(t.formatCurrency(t.summary().monthlyRevenueTarget)),f(5),E(t.formatCurrency(t.summary().dailyAverageTarget)),f(4),W("text-red-600",t.summary().targetDeficit<0)("text-green-600",t.summary().targetDeficit>=0),f(),k(" ",t.formatCurrency(t.summary().targetDeficit)," "),f(5),E(t.formatCurrency(t.summary().cumulativeMonthlyRevenue)),f(4),W("text-green-600",t.summary().monthlyTargetAchievementRate>=100)("text-red-600",t.summary().monthlyTargetAchievementRate<100),f(),k(" ",t.summary().monthlyTargetAchievementRate.toFixed(2),"% "),f(22),L(t.ledgerDetails())}}var qa=class qa{constructor(){this.apiService=P(Xe);this.router=P(Ve);this.monthlyTargetData=S(null);this.monthlyRevenueTarget=28e4;this.availableYears=S([2024,2025,2026]);this.availableMonths=S(Array.from({length:12},(e,t)=>t+1));this.selectedYear=S(new Date().getFullYear());this.selectedMonth=S(new Date().getMonth()+1);this.monthlyData=S(null);this.ledgerDetails=S([]);this.isLoading=S(!1);this.errorMessage=S(null);this.reportData=H(()=>{let e=this.monthlyData();if(!e)return[];let i=this.monthlyTargetData()?.monthlyRevenueTarget||this.monthlyRevenueTarget,r=e.dailyReports.filter(a=>a.totalRevenue>0).length,o=r>0?i/r:0;return e.dailyReports.map(a=>({day:a.day,date:a.date,isDayOff:a.totalRevenue===0&&a.recordCount===0,totalDailyRevenue:a.totalRevenue,dailyAchievementRate:o>0?a.totalRevenue/o*100:0,cancelledInvoiceCount:a.cancelledInvoiceCount,shortAmount:a.shortAmount,recordCount:a.recordCount}))});this.dailyRevenueFromLedger=H(()=>{let e=this.ledgerDetails(),t=new Map;return console.log("\u6B63\u5728\u8A08\u7B97\u6BCF\u65E5\u71DF\u6536\uFF0C\u6D41\u6C34\u5E33\u7B46\u6578:",e.length),e.forEach((i,r)=>{let o=i.transactionDate;if(!o)return;if(!/^\d{4}-\d{2}-\d{2}$/.test(o)){let c=new Date(o);if(isNaN(c.getTime())){console.warn("\u7121\u6CD5\u89E3\u6790\u65E5\u671F:",i.transactionDate);return}else{let m=c.getFullYear(),h=String(c.getMonth()+1).padStart(2,"0"),y=String(c.getDate()).padStart(2,"0");o=`${m}-${h}-${y}`}}let a=Number(i.debitAmount)>0?Number(i.debitAmount):Number(i.creditAmount);r<5&&console.log(`\u6D41\u6C34\u5E33[${r}]`,{originalDate:i.transactionDate,normalizedDate:o,debitAmount:i.debitAmount,creditAmount:i.creditAmount,calculatedAmount:a});let u=t.get(o)||0;t.set(o,u+a)}),console.log("\u6BCF\u65E5\u71DF\u6536Map:",{size:t.size,sample:Array.from(t.entries()).slice(0,10),total:Array.from(t.values()).reduce((i,r)=>i+r,0)}),t});this.chartData=H(()=>{let e=this.dailyRevenueFromLedger(),t=this.selectedYear(),i=this.selectedMonth(),o=this.monthlyTargetData()?.monthlyRevenueTarget||this.monthlyRevenueTarget,a=new Date(t,i,0).getDate(),u=Array.from(e.values()).filter(h=>h>0).length,c=u>0?o/u:0;console.log("\u69CB\u5EFA\u5716\u8868\u6578\u64DA:",{year:t,month:i,lastDay:a,revenueMapSize:e.size,revenueMapEntries:Array.from(e.entries()).slice(0,10),workingDays:u,dailyAverageTarget:c});let m=[];for(let h=1;h<=a;h++){let y=`${t}-${String(i).padStart(2,"0")}-${String(h).padStart(2,"0")}`,v=e.get(y)||0;m.push({day:h,date:y,isDayOff:v===0,totalDailyRevenue:v,dailyAchievementRate:c>0?v/c*100:0,cancelledInvoiceCount:0,shortAmount:0,recordCount:v>0?1:0})}return console.log("\u5716\u8868\u6578\u64DA\u69CB\u5EFA\u5B8C\u6210:",{totalDays:m.length,daysWithRevenue:m.filter(h=>h.totalDailyRevenue>0).length,sampleData:m.slice(0,5)}),m});this.summary=H(()=>{let e=this.chartData(),t=this.monthlyTargetData(),i=this.ledgerDetails(),r=t?.monthlyRevenueTarget||this.monthlyRevenueTarget,o=t?.dailyAvgTarget||0,a=i.reduce((m,h)=>{let y=Number(h.debitAmount)>0?Number(h.debitAmount):Number(h.creditAmount);return m+y},0),u=a-r,c=r>0?a/r*100:0;return{monthlyRevenueTarget:r,dailyAverageTarget:o,targetDeficit:u,cumulativeMonthlyRevenue:a,monthlyTargetAchievementRate:c,totalCancelledInvoices:e.reduce((m,h)=>m+h.cancelledInvoiceCount,0),totalShortAmount:e.reduce((m,h)=>m+h.shortAmount,0)}});this.loadData()}set dailyRevenueChartRef(e){this.destroyChart(),e&&this.chartData().length>0&&this.createChart(e)}async loadData(){this.isLoading.set(!0),this.errorMessage.set(null);try{let e=this.selectedYear(),t=this.selectedMonth(),i=String(e),r=String(t).padStart(2,"0"),o=`${i}-${r}-01`,a=new Date(e,t,0).getDate(),u=`${i}-${r}-${String(a).padStart(2,"0")}`,[c,m,h]=await Promise.all([this.apiService.getMonthlyRevenue(e,t),this.apiService.getMonthlyTargets({startMonth:`${i}-${r}`,endMonth:`${i}-${r}`}),this.apiService.getLedgerEntries({startDate:o,endDate:u,subjectName:"\u92B7\u8CA8\u6536\u5165",sortBy:"entry_date",sortOrder:"asc"})]);if(this.monthlyData.set(c),m.success&&m.data&&m.data.length>0){let y=m.data[0];this.monthlyTargetData.set({targetId:y.targetId,targetMonth:y.targetMonth,monthlyRevenueTarget:y.monthlyRevenueTarget,eventRevenueTarget:y.eventRevenueTarget,totalTarget:y.totalTarget,dailyAvgTarget:y.dailyAvgTarget,remark:y.remark}),console.log("\u2713 \u6708\u5EA6\u71DF\u6536\u76EE\u6A19\u5DF2\u8F09\u5165:",y)}else console.warn("\u26A0 \u8A72\u6708\u4EFD\u672A\u8A2D\u5B9A\u71DF\u6536\u76EE\u6A19\uFF0C\u5C07\u4F7F\u7528\u7CFB\u7D71\u9810\u8A2D\u503C"),this.monthlyTargetData.set(null);console.log("\u6B63\u5728\u8F09\u5165\u6D41\u6C34\u5E33\u8CC7\u6599:",{startDate:o,endDate:u}),h.success&&h.data?this.ledgerDetails.set(h.data.map(y=>({transactionDate:y.entry_date||"",description:y.description||"",subjectName:y.subject_name||"",debitAmount:y.amount&&y.amount>0?y.amount:0,creditAmount:y.amount&&y.amount<0?Math.abs(y.amount):0,glAccountName:y.account_name||""}))):this.ledgerDetails.set([])}catch(e){console.error("\u8F09\u5165\u7576\u65E5\u71DF\u6536\u8CC7\u6599\u6642\u767C\u751F\u932F\u8AA4:",e);let t=e instanceof Error?e.message:"\u7121\u6CD5\u8F09\u5165\u71DF\u6536\u8CC7\u6599\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66";this.errorMessage.set(t)}finally{this.isLoading.set(!1)}}applyFilter(){this.loadData()}resetFilter(){this.selectedYear.set(new Date().getFullYear()),this.selectedMonth.set(new Date().getMonth()+1),this.loadData()}navigateToDetail(e){this.router.navigate(["/daily-revenue",e])}formatCurrency(e){return e==null?"":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}getWeekdayChar(e){return["\u65E5","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D"][e%7]}formatDate(e){if(!e)return"";let t;if(/^\d{4}-\d{2}-\d{2}$/.test(e)){let[u,c,m]=e.split("-").map(Number);t=new Date(u,c-1,m)}else t=new Date(e);if(isNaN(t.getTime()))return e;let i=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0"),a=this.getWeekdayChar(t.getDay());return`${i}-${r}-${o}(${a})`}isClosedDay(e,t){if(t||!e)return!1;let i;if(/^\d{4}-\d{2}-\d{2}$/.test(e)){let[r,o,a]=e.split("-").map(Number);i=new Date(r,o-1,a)}else i=new Date(e);return isNaN(i.getTime())?!1:i.getDay()===1}createChart(e){let t=this.chartData(),i=this.summary(),r=t.map(m=>m.day),o=t.map(m=>m.totalDailyRevenue),a=o.some(m=>m>0);console.log("\u6B63\u5728\u5EFA\u7ACB\u5716\u8868:",{dataCount:t.length,hasRevenueData:a,revenueDataSample:o.slice(0,10),daysWithRevenue:o.filter(m=>m>0).length});let u=[{label:"\u6BCF\u65E5\u71DF\u6536",data:o,borderColor:"#4f46e5",backgroundColor:"rgba(79, 70, 229, 0.1)",fill:!0,tension:.4,pointRadius:4,pointBackgroundColor:"#4f46e5"},{label:"\u6BCF\u65E5\u5E73\u5747\u76EE\u6A19",data:t.map(()=>i.dailyAverageTarget),borderColor:"#f97316",borderDash:[5,5],fill:!1,pointRadius:0,pointHitRadius:0}],c=e.nativeElement.getContext("2d");this.dailyChart=new Chart(c,{type:"line",data:{labels:r,datasets:u},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{callback:m=>this.formatCurrency(m)}},x:{title:{display:!0,text:"\u65E5\u671F"}}},plugins:{tooltip:{callbacks:{label:m=>`${m.dataset.label}: ${this.formatCurrency(m.raw)}`}}}}})}destroyChart(){this.dailyChart&&(this.dailyChart.destroy(),this.dailyChart=null)}};qa.\u0275fac=function(t){return new(t||qa)},qa.\u0275cmp=re({type:qa,selectors:[["app-daily-revenue"]],viewQuery:function(t,i){if(t&1&&Dn(M9,5),t&2){let r;on(r=an())&&(i.dailyRevenueChartRef=r.first)}},decls:24,vars:9,consts:[["dailyRevenueChart",""],[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"flex","flex-col","sm:flex-row","items-center","gap-2","bg-white","p-3","rounded-xl","shadow-md","border","border-gray-200"],[1,"flex","items-center","gap-2"],[1,"text-sm","font-medium","text-gray-600"],[1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100","pr-8",3,"ngModelChange","ngModel"],[3,"value"],[1,"flex","items-center","gap-2","mt-2","sm:mt-0"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm","disabled:opacity-50",3,"click","disabled"],[3,"name"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200","disabled:opacity-50",3,"click","disabled"],["name","refresh-outline",1,"text-xl"],[1,"bg-red-50","border","border-red-200","text-red-700","px-4","py-3","rounded-lg","flex","items-center","gap-2"],[1,"flex","justify-center","items-center","py-12"],["name","alert-circle-outline",1,"text-xl"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-indigo-600"],[1,"grid","grid-cols-2","md:grid-cols-3","lg:grid-cols-5","gap-6"],[1,"bg-white","p-4","rounded-xl","shadow-md","text-center"],[1,"text-sm","text-gray-500"],[1,"text-xl","font-semibold","text-gray-900","mt-1"],[1,"text-xl","font-semibold","mt-1"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"text-lg","font-semibold","text-gray-800","mb-4"],[1,"h-80"],[1,"text-sm","text-gray-600","mb-4"],["name","information-circle-outline",1,"align-middle"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-4","py-3"],[1,"px-4","py-3","text-right"],[1,"border-b","hover:bg-gray-50"],[1,"px-4","py-2","font-medium"],[1,"px-4","py-2","text-right"],["colspan","2",1,"text-center","py-8","text-gray-500"]],template:function(t,i){t&1&&(l(0,"div",1)(1,"div",2)(2,"h1",3),d(3,"\u7576\u65E5\u71DF\u6536"),s(),l(4,"div",4)(5,"div",5)(6,"label",6),d(7,"\u6642\u9593:"),s(),l(8,"select",7),J("ngModelChange",function(o){return K(i.selectedYear,o)||(i.selectedYear=o),o}),O(9,R9,2,2,"option",8,j),s(),l(11,"select",7),J("ngModelChange",function(o){return K(i.selectedMonth,o)||(i.selectedMonth=o),o}),O(12,N9,2,2,"option",8,j),s()(),l(14,"div",9)(15,"button",10),b("click",function(){return i.applyFilter()}),x(16,"ion-icon",11),l(17,"span"),d(18),s()(),l(19,"button",12),b("click",function(){return i.resetFilter()}),x(20,"ion-icon",13),s()()()(),M(21,F9,4,1,"div",14),M(22,P9,2,0,"div",15),M(23,H9,50,14),s()),t&2&&(f(8),Y("ngModel",i.selectedYear),f(),L(i.availableYears()),f(2),Y("ngModel",i.selectedMonth),f(),L(i.availableMonths()),f(3),I("disabled",i.isLoading()),f(),I("name",i.isLoading()?"hourglass-outline":"filter-outline"),f(2),E(i.isLoading()?"\u8F09\u5165\u4E2D...":"\u5957\u7528"),f(),I("disabled",i.isLoading()),f(2),A(i.errorMessage()?21:-1),f(),A(i.isLoading()?22:-1),f(),A(!i.isLoading()&&!i.errorMessage()?23:-1))},dependencies:[oe,Se,Fe,Pe,Re,me,Ie],encapsulation:2,changeDetection:0});var rp=qa;var G9=(n,e)=>e.id;function q9(n,e){if(n&1&&(l(0,"tr",24)(1,"td",28),d(2),s(),l(3,"td",29),d(4),s(),l(5,"td",30),d(6),s()()),n&2){let t=e.$implicit,i=_();f(2),E(t.name),f(2),E(t.organizer),f(2),E(i.formatCurrency(t.actualRevenue))}}function W9(n,e){n&1&&(l(0,"tr")(1,"td",31),d(2,"\u672C\u65E5\u7121\u6D3B\u52D5\u3002"),s()())}var Wa=class Wa{constructor(){this.fb=P(je);this.dataService=P(Bt);this.router=P(Ve);this.route=P(un);this.date=S("");this.dailyEntry=S(null);this.eventsOnDay=S([]);this.submitted=S(!1);this.revenueForm=this.fb.group({nonEventRevenue:[0,[U.required,U.min(0)]]});this.totalEventRevenue=H(()=>this.eventsOnDay().reduce((e,t)=>e+t.actualRevenue,0));this.totalDailyRevenue=H(()=>(this.revenueForm.controls.nonEventRevenue.value??0)+this.totalEventRevenue());this.route.paramMap.pipe(he(e=>e.get("date")),et(e=>{if(!e||!/^\d{4}-\d{2}-\d{2}$/.test(e)){alert("\u7121\u6548\u7684\u65E5\u671F\u683C\u5F0F"),this.router.navigate(["/daily-revenue"]);return}this.date.set(e);let t=this.dataService.getDailyRevenueEntryByDate(e);this.dailyEntry.set(t),this.revenueForm.patchValue({nonEventRevenue:t.nonEventRevenue});let i=this.dataService.getEvents();this.eventsOnDay.set(i.filter(r=>r.date===e&&r.status==="active"))})).subscribe()}onSubmit(){if(this.submitted.set(!0),this.revenueForm.invalid){alert("\u8ACB\u8F38\u5165\u6709\u6548\u7684\u975E\u6D3B\u52D5\u71DF\u6536\u91D1\u984D\u3002");return}let e=this.revenueForm.controls.nonEventRevenue.value??0;this.dataService.updateDailyRevenueEntry(this.date(),{nonEventRevenue:e}),alert("\u7576\u65E5\u71DF\u6536\u5DF2\u66F4\u65B0\uFF01"),this.router.navigate(["/daily-revenue"])}onCancel(){this.router.navigate(["/daily-revenue"])}formatCurrency(e){return e==null?"":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}};Wa.\u0275fac=function(t){return new(t||Wa)},Wa.\u0275cmp=re({type:Wa,selectors:[["app-daily-revenue-detail"]],decls:53,vars:7,consts:[[1,"space-y-6","max-w-4xl","mx-auto"],[1,"flex","items-center","gap-4"],[1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","arrow-back-outline",1,"text-2xl"],[1,"text-3xl","font-bold","text-gray-900"],[1,"text-indigo-600"],["novalidate","",3,"ngSubmit","formGroup"],[1,"bg-white","p-6","md:p-8","rounded-xl","shadow-md","space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],[1,"bg-gray-50","p-4","rounded-lg"],["for","nonEventRevenue",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","nonEventRevenue","formControlName","nonEventRevenue",1,"mt-2","block","w-full","border","bg-white","rounded-md","shadow-sm","p-2","text-lg","text-right","font-semibold"],[1,"text-xs","text-gray-500","mt-1"],[1,"bg-blue-50","p-4","rounded-lg"],[1,"text-sm","font-medium","text-gray-700"],[1,"mt-2","text-lg","text-right","font-semibold","text-blue-800"],[1,"bg-green-50","p-4","rounded-lg"],[1,"mt-2","text-lg","text-right","font-semibold","text-green-800"],[1,"text-lg","font-semibold","text-gray-800","mb-2"],[1,"border","rounded-lg","overflow-hidden"],[1,"w-full","text-sm","text-left"],[1,"bg-gray-100","text-xs","uppercase"],[1,"px-4","py-2"],[1,"px-4","py-2","text-right"],[1,"border-t"],[1,"flex","items-center","justify-end","gap-4","pt-4","border-t","mt-6"],["type","button",1,"px-4","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],["type","submit",1,"px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-indigo-600","hover:bg-indigo-700"],[1,"px-4","py-2","font-medium"],[1,"px-4","py-2","text-gray-600"],[1,"px-4","py-2","text-right","font-semibold"],["colspan","3",1,"px-4","py-4","text-center","text-gray-500"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"button",2),b("click",function(){return i.onCancel()}),x(3,"ion-icon",3),s(),l(4,"h1",4),d(5," \u7DE8\u8F2F\u7576\u65E5\u71DF\u6536 - "),l(6,"span",5),d(7),s()()(),l(8,"form",6),b("ngSubmit",function(){return i.onSubmit()}),l(9,"div",7)(10,"div",8)(11,"div",9)(12,"label",10),d(13,"\u975E\u6D3B\u52D5\u71DF\u6536*"),s(),x(14,"input",11),l(15,"p",12),d(16,"\u624B\u52D5\u8F38\u5165\u7576\u5929\u975E\u6D3B\u52D5\u76F8\u95DC\u7684\u71DF\u6536\u3002"),s()(),l(17,"div",13)(18,"p",14),d(19,"\u6D3B\u52D5\u7E3D\u71DF\u6536"),s(),l(20,"p",15),d(21),s(),l(22,"p",12),d(23,"\u4F86\u81EA\u4E0B\u65B9\u6D3B\u52D5\u5217\u8868\u7684\u52A0\u7E3D\u3002"),s()(),l(24,"div",16)(25,"p",14),d(26,"\u7576\u65E5\u7E3D\u71DF\u6536"),s(),l(27,"p",17),d(28),s(),l(29,"p",12),d(30,"\u975E\u6D3B\u52D5\u71DF\u6536 + \u6D3B\u52D5\u7E3D\u71DF\u6536\u3002"),s()()(),l(31,"div")(32,"h3",18),d(33,"\u672C\u65E5\u6D3B\u52D5"),s(),l(34,"div",19)(35,"table",20)(36,"thead",21)(37,"tr")(38,"th",22),d(39,"\u6D3B\u52D5\u540D\u7A31"),s(),l(40,"th",22),d(41,"\u4ECB\u7D39\u4EBA"),s(),l(42,"th",23),d(43,"\u5BE6\u969B\u6536\u5165"),s()()(),l(44,"tbody"),O(45,q9,7,3,"tr",24,G9,!1,W9,3,0,"tr"),s()()()(),l(48,"div",25)(49,"button",26),b("click",function(){return i.onCancel()}),d(50," \u53D6\u6D88 "),s(),l(51,"button",27),d(52," \u5132\u5B58\u8B8A\u66F4 "),s()()()()()),t&2){let r;f(7),E(i.date()),f(),I("formGroup",i.revenueForm),f(6),W("border-red-500",i.submitted()&&((r=i.revenueForm.get("nonEventRevenue"))==null?null:r.invalid)),f(7),E(i.formatCurrency(i.totalEventRevenue())),f(7),E(i.formatCurrency(i.totalDailyRevenue())),f(17),L(i.eventsOnDay())}},dependencies:[oe,ke,Be,xe,kt,me,Le,Ue,Ge],encapsulation:2,changeDetection:0});var op=Wa;var q2=()=>[2024,2025,2026,2027],j9=()=>[1,2,3,4,5,6,7,8,9,10,11,12],W2=(n,e)=>e.user_id+"-"+e.year_month,e_=(n,e)=>e.id,z9=(n,e)=>e.employee_id,Y9=(n,e)=>e.source_month,J9=(n,e)=>e.payable_id;function K9(n,e){if(n&1&&(l(0,"option",23),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),k("",t,"\u5E74")}}function Q9(n,e){if(n&1){let t=B();l(0,"div",10)(1,"label",21),d(2,"\u5E74\u4EFD:"),s(),l(3,"select",22),J("ngModelChange",function(r){D(t);let o=_();return K(o.selectedYear,r)||(o.selectedYear=r),w(r)}),b("change",function(){D(t);let r=_();return w(r.onMonthChange())}),O(4,K9,2,2,"option",23,j),s()()}if(n&2){let t=_();f(3),Y("ngModel",t.selectedYear),f(),L(wt(1,q2))}}function Z9(n,e){if(n&1&&(l(0,"option",23),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),k("",t,"\u5E74")}}function X9(n,e){if(n&1&&(l(0,"option",23),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),k("",t,"\u6708")}}function eO(n,e){if(n&1){let t=B();l(0,"div",10)(1,"label",21),d(2,"\u6708\u4EFD:"),s(),l(3,"select",22),J("ngModelChange",function(r){D(t);let o=_();return K(o.selectedYear,r)||(o.selectedYear=r),w(r)}),b("change",function(){D(t);let r=_();return w(r.onMonthChange())}),O(4,Z9,2,2,"option",23,j),s(),l(6,"select",22),J("ngModelChange",function(r){D(t);let o=_();return K(o.selectedMonth,r)||(o.selectedMonth=r),w(r)}),b("change",function(){D(t);let r=_();return w(r.onMonthChange())}),O(7,X9,2,2,"option",23,j),s()()}if(n&2){let t=_();f(3),Y("ngModel",t.selectedYear),f(),L(wt(2,q2)),f(2),Y("ngModel",t.selectedMonth),f(),L(wt(3,j9))}}function tO(n,e){if(n&1&&(l(0,"div",24)(1,"div",28)(2,"p",29),d(3,"\u7B46\u6578"),s(),l(4,"p",30),d(5),s()(),l(6,"div",28)(7,"p",29),d(8,"\u7E3D\u85AA\u8CC7"),s(),l(9,"p",31),d(10),s()(),l(11,"div",28)(12,"p",29),d(13,"\u5DF2\u6838\u5C0D"),s(),l(14,"p",32),d(15),s()(),l(16,"div",28)(17,"p",29),d(18,"\u5DF2\u767C\u653E"),s(),l(19,"p",33),d(20),s()()()),n&2){let t=_(2);f(5),E(t.dailyStats().totalRecords),f(5),E(t.formatCurrency(t.dailyStats().totalWages)),f(5),E(t.dailyStats().verifiedCount),f(5),E(t.dailyStats().paidCount)}}function nO(n,e){if(n&1&&(l(0,"div",25)(1,"p",34),d(2),s()()),n&2){let t=_(2);f(2),E(t.dailyError())}}function iO(n,e){n&1&&(l(0,"div",26)(1,"p",35),d(2,"\u8F09\u5165\u4E2D..."),s()())}function rO(n,e){if(n&1&&(l(0,"span",54),d(1),s()),n&2){let t=_().$implicit;f(),k("\u7F3A\u5361",t.missing_records,"\u7B46")}}function oO(n,e){n&1&&(l(0,"span",55),d(1,"\u5DF2\u6838\u5C0D"),s())}function aO(n,e){n&1&&(l(0,"span",35),d(1,"\u672A\u6838\u5C0D"),s())}function sO(n,e){n&1&&(l(0,"span",55),d(1,"\u5DF2\u767C\u653E"),s())}function lO(n,e){n&1&&(l(0,"span",35),d(1,"\u672A\u767C\u653E"),s())}function uO(n,e){if(n&1&&(l(0,"span",56),d(1),s()),n&2){let t=_().$implicit;f(),k("#",t.entry_id)}}function dO(n,e){n&1&&(l(0,"span",57),d(1,"-"),s())}function cO(n,e){n&1&&(l(0,"span"),d(1,"\u7522\u751F\u4E2D..."),s())}function mO(n,e){n&1&&(l(0,"span"),d(1,"\u4E0B\u8F09"),s())}function pO(n,e){if(n&1){let t=B();l(0,"tr",48),b("click",function(){let r=D(t).$implicit,o=_(4);return w(o.openMonthlyDetails(r))}),l(1,"td",49),d(2),s(),l(3,"td",50),d(4),s(),l(5,"td",51),d(6),s(),l(7,"td",52),d(8),s(),l(9,"td",53),M(10,rO,2,1,"span",54),s(),l(11,"td",53),M(12,oO,2,0,"span",55)(13,aO,2,0,"span",35),s(),l(14,"td",53),M(15,sO,2,0,"span",55)(16,lO,2,0,"span",35),s(),l(17,"td",53),M(18,uO,2,1,"span",56)(19,dO,2,0,"span",57),s(),l(20,"td",53)(21,"button",58),b("click",function(r){let o=D(t).$implicit,a=_(4);return w(a.downloadLaborReport(o,r))}),M(22,cO,2,0,"span")(23,mO,2,0,"span"),s()()()}if(n&2){let t=e.$implicit,i=_(4);f(2),E(t.year_month),f(2),E(t.display_name),f(2),k("",t.total_work_hours.toFixed(2)," h"),f(2),E(i.formatCurrency(t.total_wage)),f(2),A(t.missing_records>0?10:-1),f(2),A(t.is_fully_verified?12:13),f(3),A(t.is_fully_paid?15:16),f(3),A(t.entry_id?18:19),f(3),I("disabled",i.downloadingReports().has(t.user_id+"-"+t.year_month)),f(),A(i.downloadingReports().has(t.user_id+"-"+t.year_month)?22:23)}}function fO(n,e){if(n&1&&(l(0,"div",36)(1,"div",38)(2,"h3",39),d(3,"\u8A08\u6642\u54E1\u5DE5"),s()(),l(4,"div",40)(5,"table",41)(6,"thead",42)(7,"tr")(8,"th",43),d(9,"\u5DE5\u4F5C\u6708\u4EFD"),s(),l(10,"th",43),d(11,"\u54E1\u5DE5"),s(),l(12,"th",44),d(13,"\u7E3D\u5DE5\u6642"),s(),l(14,"th",44),d(15,"\u7E3D\u85AA\u8CC7"),s(),l(16,"th",45),d(17,"\u7F3A\u5361"),s(),l(18,"th",45),d(19,"\u6838\u5C0D"),s(),l(20,"th",45),d(21,"\u767C\u653E"),s(),l(22,"th",45),d(23,"\u6D41\u6C34\u5E33"),s(),l(24,"th",45),d(25,"\u52DE\u5831\u55AE"),s()()(),l(26,"tbody",46),O(27,pO,24,10,"tr",47,W2),s()()()()),n&2){let t=_(3);f(27),L(t.hourlySummaries())}}function gO(n,e){if(n&1&&(l(0,"span",54),d(1),s()),n&2){let t=_().$implicit;f(),k("\u7F3A\u5361",t.missing_records,"\u7B46")}}function hO(n,e){n&1&&(l(0,"span",63),x(1,"ion-icon",67),d(2," \u5DF2\u6838\u5C0D "),s())}function yO(n,e){if(n&1){let t=B();l(0,"button",68),b("click",function(){D(t);let r=_().$implicit,o=_(4);return w(o.verifyMonthlySalarySummary(r))}),d(1," \u6838\u5C0D "),s()}}function _O(n,e){n&1&&(l(0,"span",65),x(1,"ion-icon",69),d(2," \u5DF2\u767C\u653E "),s())}function vO(n,e){if(n&1){let t=B();l(0,"button",70),b("click",function(){D(t);let r=_().$implicit,o=_(4);return w(o.releaseMonthlySalarySummary(r))}),d(1," \u767C\u653E "),s()}if(n&2){let t=_().$implicit;I("disabled",!t.is_fully_verified)}}function CO(n,e){if(n&1&&(l(0,"span",56),d(1),s()),n&2){let t=_().$implicit;f(),k("#",t.entry_id)}}function xO(n,e){n&1&&(l(0,"span",57),d(1,"-"),s())}function bO(n,e){if(n&1){let t=B();l(0,"tr",61)(1,"td",49),d(2),s(),l(3,"td",50),d(4),s(),l(5,"td",51),d(6),s(),l(7,"td",52),d(8),s(),l(9,"td",53)(10,"button",62),b("click",function(){let r=D(t).$implicit,o=_(4);return w(o.openMonthlySalaryAdjust(r))}),d(11," \u8ABF\u6574 "),s()(),l(12,"td",53),M(13,gO,2,1,"span",54),s(),l(14,"td",53),M(15,hO,3,0,"span",63)(16,yO,2,0,"button",64),s(),l(17,"td",53),M(18,_O,3,0,"span",65)(19,vO,2,1,"button",66),s(),l(20,"td",53),M(21,CO,2,1,"span",56)(22,xO,2,0,"span",57),s()()}if(n&2){let t=e.$implicit,i=_(4);f(2),E(t.year_month),f(2),E(t.display_name),f(2),k("",t.total_work_hours.toFixed(2)," h"),f(2),E(i.formatCurrency(t.total_wage)),f(2),I("disabled",t.is_fully_paid),f(3),A(t.missing_records>0?13:-1),f(2),A(t.is_fully_verified?15:16),f(3),A(t.is_fully_paid?18:19),f(3),A(t.entry_id?21:22)}}function EO(n,e){if(n&1&&(l(0,"div",37)(1,"div",59)(2,"h3",60),d(3,"\u6B63\u8077\u54E1\u5DE5 (\u6708\u85AA)"),s()(),l(4,"div",40)(5,"table",41)(6,"thead",42)(7,"tr")(8,"th",43),d(9,"\u5DE5\u4F5C\u6708\u4EFD"),s(),l(10,"th",43),d(11,"\u54E1\u5DE5"),s(),l(12,"th",44),d(13,"\u7E3D\u5DE5\u6642"),s(),l(14,"th",44),d(15,"\u7E3D\u85AA\u8CC7"),s(),l(16,"th",45),d(17,"\u8ABF\u6574"),s(),l(18,"th",45),d(19,"\u7F3A\u5361"),s(),l(20,"th",45),d(21,"\u6838\u5C0D"),s(),l(22,"th",45),d(23,"\u767C\u653E"),s(),l(24,"th",45),d(25,"\u6D41\u6C34\u5E33"),s()()(),l(26,"tbody",46),O(27,bO,23,9,"tr",61,W2),s()()()()),n&2){let t=_(3);f(27),L(t.monthlySalarySummaries())}}function SO(n,e){if(n&1&&(M(0,fO,29,0,"div",36),M(1,EO,29,0,"div",37)),n&2){let t=_(2);A(t.hourlySummaries().length>0?0:-1),f(),A(t.monthlySalarySummaries().length>0?1:-1)}}function DO(n,e){if(n&1&&(l(0,"div",27)(1,"p",71),d(2),s()()),n&2){let t=_(2);f(2),k("",t.getMonthLabel()," \u6C92\u6709\u85AA\u8CC7\u8A18\u9304")}}function wO(n,e){if(n&1&&(l(0,"span",91),d(1),s()),n&2){let t=_().$implicit;f(),k(" ",t.multiplier,"x ")}}function TO(n,e){n&1&&(l(0,"span",57),d(1,"-"),s())}function IO(n,e){n&1&&(l(0,"span",63),x(1,"ion-icon",67),d(2," \u5DF2\u6838\u5C0D "),s())}function MO(n,e){n&1&&(l(0,"span",92),d(1," \u672A\u6838\u5C0D "),s())}function AO(n,e){n&1&&(l(0,"span",65),x(1,"ion-icon",69),d(2," \u5DF2\u767C\u653E "),s())}function RO(n,e){n&1&&(l(0,"span",92),d(1," \u672A\u767C\u653E "),s())}function NO(n,e){if(n&1){let t=B();l(0,"tr",61)(1,"td",53)(2,"input",89),b("change",function(r){let o=D(t).$implicit,a=_(3);return w(a.toggleRowSelection(o.id,r))}),s()(),l(3,"td",49),d(4),s(),l(5,"td",49)(6,"input",90),J("ngModelChange",function(r){let o=D(t).$implicit;return K(o.clock_in_time_input,r)||(o.clock_in_time_input=r),w(r)}),b("change",function(){let r=D(t).$implicit,o=_(3);return w(o.updateMonthlyDetailDisplay(r))}),s()(),l(7,"td",49)(8,"input",90),J("ngModelChange",function(r){let o=D(t).$implicit;return K(o.clock_out_time_input,r)||(o.clock_out_time_input=r),w(r)}),b("change",function(){let r=D(t).$implicit,o=_(3);return w(o.updateMonthlyDetailDisplay(r))}),s()(),l(9,"td",51),d(10),s(),l(11,"td",51),d(12),s(),l(13,"td",53),M(14,wO,2,1,"span",91)(15,TO,2,0,"span",57),s(),l(16,"td",53),M(17,IO,3,0,"span",63)(18,MO,2,0,"span",92),s(),l(19,"td",53),M(20,AO,3,0,"span",65)(21,RO,2,0,"span",92),s(),l(22,"td",53)(23,"div",93)(24,"button",94),b("click",function(){let r=D(t).$implicit,o=_(3);return w(o.saveMonthlyDetail(r))}),x(25,"ion-icon",95),s(),l(26,"button",96),b("click",function(){let r=D(t).$implicit,o=_(3);return w(o.deleteMonthlyDetail(r))}),x(27,"ion-icon",97),s()()()()}if(n&2){let t=e.$implicit,i=_(3);W("bg-green-50",t.is_paid)("opacity-60",t.is_paid),f(2),I("checked",i.isRowSelected(t.id))("disabled",t.is_paid),f(2),E(i.formatDateYMD(t.work_date)),f(2),Y("ngModel",t.clock_in_time_input),I("disabled",t.is_paid),f(2),Y("ngModel",t.clock_out_time_input),I("disabled",t.is_paid),f(2),E(t.work_hours.toFixed(2)),f(2),E(i.formatCurrency(t.total_wage)),f(2),A(t.multiplier&&t.multiplier!==1?14:15),f(3),A(t.is_verified?17:18),f(3),A(t.is_paid?20:21),f(4),I("disabled",t.is_paid),f(2),I("disabled",t.is_paid)}}function FO(n,e){if(n&1){let t=B();l(0,"div",19)(1,"div",72)(2,"div",73)(3,"h2",74),d(4),s(),l(5,"button",75),b("click",function(){D(t);let r=_(2);return w(r.closeMonthlyDetails())}),x(6,"ion-icon",76),s()(),l(7,"div",77)(8,"div",78)(9,"div",79),d(10),s(),l(11,"div",80)(12,"button",81),b("click",function(){D(t);let r=_(2);return w(r.openCreateClockRecord())}),x(13,"ion-icon",82),d(14," \u65B0\u589E\u6253\u5361 "),s(),l(15,"button",83),b("click",function(){D(t);let r=_(2);return w(r.batchVerifyRecords())}),x(16,"ion-icon",84),d(17," \u6279\u91CF\u6838\u5C0D "),s(),l(18,"button",85),b("click",function(){D(t);let r=_(2);return w(r.batchReleaseRecords())}),x(19,"ion-icon",86),d(20," \u6279\u91CF\u767C\u653E "),s()()(),l(21,"div",40)(22,"table",41)(23,"thead",42)(24,"tr")(25,"th",53)(26,"input",87),b("change",function(r){D(t);let o=_(2);return w(o.toggleSelectAll(r))}),s()(),l(27,"th",43),d(28,"\u5DE5\u4F5C\u65E5\u671F"),s(),l(29,"th",43),d(30,"\u4E0A\u73ED\u6253\u5361\u6642\u9593"),s(),l(31,"th",43),d(32,"\u4E0B\u73ED\u6253\u5361\u6642\u9593"),s(),l(33,"th",44),d(34,"\u5DE5\u4F5C\u6642\u6578"),s(),l(35,"th",44),d(36,"\u85AA\u8CC7\u91D1\u984D"),s(),l(37,"th",45),d(38,"\u500D\u6578"),s(),l(39,"th",45),d(40,"\u6838\u5C0D"),s(),l(41,"th",45),d(42,"\u767C\u653E"),s(),l(43,"th",45),d(44,"\u64CD\u4F5C"),s()()(),l(45,"tbody",46),O(46,NO,28,18,"tr",88,e_),s()()()()()()}if(n&2){let t,i=_(2);f(4),E(i.monthlyDetailsTitle()),f(6),k(" \u5DF2\u9078\u64C7 ",i.selectedRows().length," \u7B46\u8A18\u9304 "),f(2),I("disabled",(t=i.currentMonthlySummary())==null?null:t.is_paid),f(3),I("disabled",i.selectedRows().length===0),f(3),I("disabled",i.selectedRows().length===0),f(28),L(i.monthlyDetailsRows())}}function PO(n,e){if(n&1&&(l(0,"div",5),M(1,tO,21,4,"div",24),M(2,nO,3,1,"div",25),M(3,iO,3,0,"div",26),M(4,SO,2,2),M(5,DO,3,1,"div",27),M(6,FO,48,5,"div",19),s()),n&2){let t=_();f(),A(!t.dailyLoading()&&t.dailySummaries().length>0?1:-1),f(),A(t.dailyError()?2:-1),f(),A(t.dailyLoading()?3:-1),f(),A(!t.dailyLoading()&&(t.hourlySummaries().length>0||t.monthlySalarySummaries().length>0)?4:-1),f(),A(!t.dailyLoading()&&t.hourlySummaries().length===0&&t.monthlySalarySummaries().length===0?5:-1),f(),A(t.monthlyDetailsVisible()?6:-1)}}function kO(n,e){if(n&1&&(l(0,"div",25)(1,"p",34),d(2),s()()),n&2){let t=_(2);f(2),E(t.wagesError())}}function VO(n,e){n&1&&(l(0,"div",26)(1,"p",35),d(2,"\u8F09\u5165\u4E2D..."),s()())}function OO(n,e){n&1&&(l(0,"span",100),d(1," \u555F\u7528 "),s())}function LO(n,e){n&1&&(l(0,"span",101),d(1," \u505C\u7528 "),s())}function BO(n,e){if(n&1){let t=B();l(0,"tr",61)(1,"td",49),d(2),s(),l(3,"td",50),d(4),s(),l(5,"td",51),d(6),s(),l(7,"td",49),d(8),s(),l(9,"td",49),d(10),s(),l(11,"td",49),d(12),s(),l(13,"td",53),M(14,OO,2,0,"span",100)(15,LO,2,0,"span",101),s(),l(16,"td",53)(17,"button",102),b("click",function(){let r=D(t).$implicit,o=_(3);return w(o.openWageForm(r))}),x(18,"ion-icon",103),s(),l(19,"button",104),b("click",function(){let r=D(t).$implicit,o=_(3);return w(o.deleteWageRecord(r))}),x(20,"ion-icon",105),s()()()}if(n&2){let t=e.$implicit,i=_(3);f(2),E(t.user_id),f(2),E(t.display_name),f(2),Ke("",i.formatCurrency(t.hourly_rate),"",t.wage_type==="hourly"?"/\u5C0F\u6642":"/\u6708"),f(2),E(t.wage_type==="hourly"?"\u8A08\u6642":"\u6708\u85AA"),f(2),E(i.formatDate(t.effective_from)),f(2),E(t.effective_to?i.formatDate(t.effective_to):"-"),f(2),A(t.is_active?14:15)}}function UO(n,e){if(n&1&&(l(0,"div",37)(1,"div",40)(2,"table",41)(3,"thead",42)(4,"tr")(5,"th",43),d(6,"\u54E1\u5DE5 ID"),s(),l(7,"th",43),d(8,"\u54E1\u5DE5\u540D\u7A31"),s(),l(9,"th",44),d(10,"\u85AA\u8CC7"),s(),l(11,"th",43),d(12,"\u985E\u578B"),s(),l(13,"th",43),d(14,"\u751F\u6548\u65E5\u671F"),s(),l(15,"th",43),d(16,"\u622A\u6B62\u65E5\u671F"),s(),l(17,"th",45),d(18,"\u72C0\u614B"),s(),l(19,"th",45),d(20,"\u64CD\u4F5C"),s()()(),l(21,"tbody",46),O(22,BO,21,8,"tr",61,e_),s()()()()),n&2){let t=_(2);f(22),L(t.employeeWages())}}function $O(n,e){if(n&1){let t=B();l(0,"div",27)(1,"p",71),d(2,"\u6C92\u6709\u54E1\u5DE5\u85AA\u8CC7\u8A2D\u5B9A"),s(),l(3,"button",106),b("click",function(){D(t);let r=_(2);return w(r.openWageForm())}),d(4," \u65B0\u589E\u85AA\u8CC7\u8A2D\u5B9A "),s()()}}function HO(n,e){if(n&1){let t=B();l(0,"div",19)(1,"div",107)(2,"div",108)(3,"h2",74),d(4),s(),l(5,"button",75),b("click",function(){D(t);let r=_(2);return w(r.closeWageForm())}),x(6,"ion-icon",76),s()(),l(7,"form",109)(8,"div",110)(9,"div")(10,"label",111),d(11,"\u54E1\u5DE5 ID *"),s(),x(12,"input",112),s(),l(13,"div")(14,"label",111),d(15,"\u54E1\u5DE5\u540D\u7A31"),s(),x(16,"input",113),s()(),l(17,"div",110)(18,"div")(19,"label",111),d(20,"\u85AA\u8CC7 *"),s(),x(21,"input",114),s(),l(22,"div")(23,"label",111),d(24,"\u85AA\u8CC7\u985E\u578B"),s(),l(25,"select",115)(26,"option",116),d(27,"\u8A08\u6642"),s(),l(28,"option",117),d(29,"\u6708\u85AA"),s()()()(),l(30,"div",110)(31,"div")(32,"label",111),d(33,"\u751F\u6548\u65E5\u671F *"),s(),x(34,"input",118),s(),l(35,"div")(36,"label",111),d(37,"\u622A\u6B62\u65E5\u671F"),s(),x(38,"input",119),s()(),l(39,"div")(40,"label",111),d(41,"\u5099\u8A3B"),s(),x(42,"textarea",120),s(),l(43,"div",121)(44,"button",122),b("click",function(){D(t);let r=_(2);return w(r.closeWageForm())}),d(45," \u53D6\u6D88 "),s(),l(46,"button",123),b("click",function(){D(t);let r=_(2);return w(r.saveWageRecord())}),d(47," \u4FDD\u5B58 "),s()()()()()}if(n&2){let t=_(2);f(4),E(t.editingWage()?"\u7DE8\u8F2F\u85AA\u8CC7\u8A2D\u5B9A":"\u65B0\u589E\u85AA\u8CC7\u8A2D\u5B9A"),f(3),I("formGroup",t.wageForm),f(5),W("bg-gray-100",!!t.editingWage())("cursor-not-allowed",!!t.editingWage()),I("readonly",!!t.editingWage())}}function GO(n,e){if(n&1){let t=B();l(0,"div",5),M(1,kO,3,1,"div",25),l(2,"div",98)(3,"button",99),b("click",function(){D(t);let r=_();return w(r.openWageForm())}),x(4,"ion-icon",82),d(5," \u65B0\u589E\u85AA\u8CC7\u8A2D\u5B9A "),s()(),M(6,VO,3,0,"div",26),M(7,UO,24,0,"div",37),M(8,$O,5,0,"div",27),M(9,HO,48,7,"div",19),s()}if(n&2){let t=_();f(),A(t.wagesError()?1:-1),f(5),A(t.wagesLoading()?6:-1),f(),A(!t.wagesLoading()&&t.employeeWages().length>0?7:-1),f(),A(!t.wagesLoading()&&t.employeeWages().length===0?8:-1),f(),A(t.wagesFormVisible()?9:-1)}}function qO(n,e){n&1&&(l(0,"div",26)(1,"p",35),d(2,"\u8F09\u5165\u4E2D..."),s()())}function WO(n,e){if(n&1&&(l(0,"div",127),d(1),s()),n&2){let t=_(2);f(),k(" ",t.specialError()," ")}}function jO(n,e){n&1&&(l(0,"tr")(1,"td",135),d(2," \u76EE\u524D\u6C92\u6709\u7279\u6B8A\u5DE5\u4F5C\u65E5\u8A2D\u5B9A "),s()())}function zO(n,e){n&1&&(l(0,"span",100),d(1," \u555F\u7528 "),s())}function YO(n,e){n&1&&(l(0,"span",101),d(1," \u505C\u7528 "),s())}function JO(n,e){if(n&1){let t=B();l(0,"tr",134)(1,"td",136),d(2),s(),l(3,"td",137),d(4),s(),l(5,"td",138)(6,"span",139),d(7),s()(),l(8,"td",138),M(9,zO,2,0,"span",100)(10,YO,2,0,"span",101),s(),l(11,"td",140),d(12),s(),l(13,"td",141)(14,"button",142),b("click",function(){let r=D(t).$implicit,o=_(3);return w(o.openSpecialForm(r))}),x(15,"ion-icon",143),s(),l(16,"button",144),b("click",function(){let r=D(t).$implicit,o=_(3);return w(o.deleteSpecialDate(r.id))}),x(17,"ion-icon",145),s()()()}if(n&2){let t=e.$implicit,i=_(3);f(2),k(" ",i.formatDateYMD(t.date)," "),f(2),k(" ",t.name," "),f(3),k(" ",t.multiplier,"x "),f(2),A(t.is_active?9:10),f(3),k(" ",t.notes||"-"," ")}}function KO(n,e){if(n&1&&(l(0,"div",128)(1,"table",129)(2,"thead",130)(3,"tr")(4,"th",131),d(5,"\u65E5\u671F"),s(),l(6,"th",131),d(7,"\u540D\u7A31"),s(),l(8,"th",132),d(9,"\u85AA\u8CC7\u500D\u6578"),s(),l(10,"th",132),d(11,"\u72C0\u614B"),s(),l(12,"th",131),d(13,"\u5099\u8A3B"),s(),l(14,"th",132),d(15,"\u64CD\u4F5C"),s()()(),l(16,"tbody",133),M(17,jO,3,0,"tr"),O(18,JO,18,5,"tr",134,e_),s()()()),n&2){let t=_(2);f(17),A(t.specialDates().length===0?17:-1),f(),L(t.specialDates())}}function QO(n,e){if(n&1){let t=B();l(0,"div",19)(1,"div",146)(2,"div",77)(3,"h3",147),d(4),s(),l(5,"div",148)(6,"div")(7,"label",111),d(8,"\u65E5\u671F *"),s(),x(9,"input",149,0),s(),l(11,"div")(12,"label",111),d(13,"\u540D\u7A31 *"),s(),x(14,"input",150,1),s(),l(16,"div")(17,"label",111),d(18,"\u85AA\u8CC7\u500D\u6578 *"),s(),x(19,"input",151,2),s(),l(21,"div")(22,"label",152),x(23,"input",153,3),l(25,"span",154),d(26,"\u555F\u7528"),s()()(),l(27,"div")(28,"label",111),d(29,"\u5099\u8A3B"),s(),x(30,"textarea",155,4),s()(),l(32,"div",156)(33,"button",122),b("click",function(){D(t);let r=_(2);return w(r.closeSpecialForm())}),d(34," \u53D6\u6D88 "),s(),l(35,"button",123),b("click",function(){D(t);let r=wn(10),o=wn(15),a=wn(20),u=wn(24),c=wn(31),m=_(2);return w(m.saveSpecialDate({date:r.value,name:o.value,multiplier:+a.value,is_active:u.checked,notes:c.value||null}))}),d(36," \u4FDD\u5B58 "),s()()()()()}if(n&2){let t,i,r,o,a,u=_(2);f(4),k(" ",u.editingSpecial()?"\u7DE8\u8F2F\u7279\u6B8A\u5DE5\u4F5C\u65E5":"\u65B0\u589E\u7279\u6B8A\u5DE5\u4F5C\u65E5"," "),f(5),I("value",((t=u.editingSpecial())==null?null:t.date)||""),f(5),I("value",((i=u.editingSpecial())==null?null:i.name)||""),f(5),I("value",((r=u.editingSpecial())==null?null:r.multiplier)||2),f(4),I("checked",((o=u.editingSpecial())==null?null:o.is_active)??!0),f(7),I("value",((a=u.editingSpecial())==null?null:a.notes)||"")}}function ZO(n,e){if(n&1){let t=B();l(0,"div",5)(1,"div",124)(2,"h2",125),d(3,"\u7279\u6B8A\u5DE5\u4F5C\u65E5\u8A2D\u5B9A"),s(),l(4,"button",126),b("click",function(){D(t);let r=_();return w(r.openSpecialForm())}),x(5,"ion-icon",82),d(6," \u65B0\u589E\u7279\u6B8A\u5DE5\u4F5C\u65E5 "),s()(),M(7,qO,3,0,"div",26),M(8,WO,2,1,"div",127),M(9,KO,20,1,"div",128),M(10,QO,37,6,"div",19),s()}if(n&2){let t=_();f(7),A(t.specialLoading()?7:-1),f(),A(t.specialError()?8:-1),f(),A(!t.specialLoading()&&!t.specialError()?9:-1),f(),A(t.specialFormVisible()?10:-1)}}function XO(n,e){n&1&&(l(0,"p",159),d(1,"\u8F09\u5165\u4E2D..."),s())}function eL(n,e){if(n&1&&(l(0,"p",160),d(1),s(),l(2,"p",161),d(3),s()),n&2){let t=_(2);f(),k(" ",t.formatCurrency(t.payablesSummary().total_payable)," "),f(2),k(" \u5171 ",t.payablesSummary().employees.length," \u4F4D\u54E1\u5DE5\u6709\u61C9\u4ED8\u85AA\u8CC7 ")}}function tL(n,e){n&1&&(l(0,"div",26)(1,"p",35),d(2,"\u8F09\u5165\u4E2D..."),s()())}function nL(n,e){if(n&1&&(l(0,"div",127),d(1),s()),n&2){let t=_(2);f(),k(" ",t.payablesError()," ")}}function iL(n,e){n&1&&(l(0,"tr")(1,"td",165),d(2," \u76EE\u524D\u6C92\u6709\u61C9\u4ED8\u85AA\u8CC7\u8A18\u9304 "),s()())}function rL(n,e){if(n&1){let t=B();l(0,"tr",166),b("click",function(){let r=D(t).$implicit,o=_(3);return w(o.openPayablesDetail(r))}),l(1,"td",167)(2,"div",152)(3,"div",168),x(4,"ion-icon",169),s(),l(5,"div",170)(6,"div",171),d(7),s(),l(8,"div",172),d(9),s()()()(),l(10,"td",173)(11,"div",174),d(12),s()(),l(13,"td",175)(14,"button",176),b("click",function(r){let o=D(t).$implicit;return _(3).openPayablesDetail(o),w(r.stopPropagation())}),d(15," \u67E5\u770B\u660E\u7D30 "),x(16,"ion-icon",177),s()()()}if(n&2){let t=e.$implicit,i=_(3);f(7),E(t.employee_name),f(2),k("ID: ",t.employee_id),f(3),k(" ",i.formatCurrency(t.total_payable)," ")}}function oL(n,e){if(n&1&&(l(0,"div",128)(1,"div",162)(2,"h2",31),d(3,"\u54E1\u5DE5\u61C9\u4ED8\u85AA\u8CC7\u660E\u7D30"),s()(),l(4,"table",129)(5,"thead",130)(6,"tr")(7,"th",131),d(8,"\u54E1\u5DE5\u540D\u7A31"),s(),l(9,"th",163),d(10,"\u7D2F\u7A4D\u61C9\u4ED8\u85AA\u8CC7"),s(),l(11,"th",132),d(12,"\u64CD\u4F5C"),s()()(),l(13,"tbody",133),M(14,iL,3,0,"tr"),O(15,rL,17,3,"tr",164,z9),s()()()),n&2){let t=_(2);f(14),A(t.payablesSummary().employees.length===0?14:-1),f(),L(t.payablesSummary().employees)}}function aL(n,e){if(n&1&&(l(0,"div",5)(1,"div",157)(2,"p",158),d(3,"\u7E3D\u61C9\u4ED8\u85AA\u8CC7"),s(),M(4,XO,2,0,"p",159)(5,eL,4,2),s(),M(6,tL,3,0,"div",26),M(7,nL,2,1,"div",127),M(8,oL,17,1,"div",128),s()),n&2){let t=_();f(4),A(t.payablesLoading()?4:5),f(2),A(t.payablesLoading()?6:-1),f(),A(t.payablesError()?7:-1),f(),A(!t.payablesLoading()&&!t.payablesError()?8:-1)}}function sL(n,e){n&1&&(l(0,"div",26)(1,"p",35),d(2,"\u8F09\u5165\u4E2D..."),s()())}function lL(n,e){n&1&&(l(0,"div",186),d(1," \u66AB\u7121\u61C9\u4ED8\u85AA\u8CC7\u8A18\u9304 "),s())}function uL(n,e){if(n&1&&(l(0,"span",208),d(1),s()),n&2){let t=_().$implicit;f(),k("(\u6D41\u6C34\u5E33 #",t.entry_id,")")}}function dL(n,e){if(n&1&&(l(0,"div",206)(1,"div",207)(2,"span",56),d(3),s(),M(4,uL,2,1,"span",208),s(),l(5,"div",209)(6,"span",210),d(7),s()()()),n&2){let t=e.$implicit,i=_(6);f(3),E(t.reference_note),f(),A(t.entry_id?4:-1),f(2),W("text-green-600",t.amount<0)("text-red-600",t.amount>0),f(),Ke(" ",t.amount>=0?"+":"","",i.formatCurrency(t.amount)," ")}}function cL(n,e){if(n&1&&(l(0,"tr",201)(1,"td",202)(2,"details",203)(3,"summary",204),d(4),s(),l(5,"div",205),O(6,dL,8,8,"div",206,J9),s()()()()),n&2){let t=_().$implicit;f(4),k(" \u67E5\u770B\u8A72\u6708\u660E\u7D30\uFF08\u5171 ",t.records.length," \u7B46\u8A18\u9304\uFF09 "),f(2),L(t.records)}}function mL(n,e){if(n&1&&(l(0,"tr",196)(1,"td",197),d(2),s(),l(3,"td",198),d(4),s(),l(5,"td",199),d(6),s(),l(7,"td",200),d(8),s()(),M(9,cL,8,1,"tr",201)),n&2){let t=e.$implicit,i=_(4);f(2),k(" ",i.formatDateYM(t.source_month)," "),f(2),k(" ",i.formatCurrency(t.total_salary)," "),f(2),k(" ",i.formatCurrency(t.paid_amount)," "),f(),W("text-red-600",t.payable_amount>0)("text-gray-400",t.payable_amount<=0),f(),k(" ",i.formatCurrency(t.payable_amount)," "),f(),A(t.records.length>1?9:-1)}}function pL(n,e){if(n&1&&(l(0,"div",40)(1,"table",187)(2,"thead")(3,"tr",188)(4,"th",189),d(5,"\u65E5\u671F"),s(),l(6,"th",190),d(7,"\u85AA\u6C34"),s(),l(8,"th",190),d(9,"\u5BE6\u969B\u4ED8\u6B3E"),s(),l(10,"th",190),d(11,"\u61C9\u4ED8\u85AA\u8CC7"),s()()(),l(12,"tbody"),O(13,mL,10,9,null,null,Y9),s(),l(15,"tfoot")(16,"tr",191)(17,"td",192),d(18,"\u7E3D\u8A08"),s(),l(19,"td",193),d(20),s(),l(21,"td",194),d(22),s(),l(23,"td",195),d(24),s()()()()()),n&2){let t=_(3);f(13),L(t.payablesDetails().monthly_summary),f(7),k(" ",t.formatCurrency(t.calculateTotalSalary(t.payablesDetails().monthly_summary))," "),f(2),k(" ",t.formatCurrency(t.calculateTotalPaid(t.payablesDetails().monthly_summary))," "),f(2),k(" ",t.formatCurrency(t.payablesDetails().total_payable)," ")}}function fL(n,e){if(n&1&&M(0,lL,2,0,"div",186)(1,pL,25,3,"div",40),n&2){let t=_(2);A(t.payablesDetails().monthly_summary.length===0?0:1)}}function gL(n,e){if(n&1){let t=B();l(0,"div",19)(1,"div",178)(2,"div",179)(3,"div")(4,"h3",31),d(5),s(),l(6,"p",180),d(7," \u7D2F\u8A08\u61C9\u4ED8\uFF1A"),l(8,"span",181),d(9),s()()(),l(10,"button",182),b("click",function(){D(t);let r=_();return w(r.closePayablesDetailModal())}),x(11,"ion-icon",76),s()(),l(12,"div",183),M(13,sL,3,0,"div",26)(14,fL,2,1),s(),l(15,"div",184)(16,"button",185),b("click",function(){D(t);let r=_();return w(r.closePayablesDetailModal())}),d(17," \u95DC\u9589 "),s()()()()}if(n&2){let t,i,r=_();f(5),k(" ",(t=r.payablesDetails())==null?null:t.employee_name," - \u61C9\u4ED8\u85AA\u8CC7\u660E\u7D30 "),f(4),E(r.formatCurrency(((i=r.payablesDetails())==null?null:i.total_payable)||0)),f(4),A(r.payablesDetailsLoading()?13:r.payablesDetails()?14:-1)}}function hL(n,e){n&1&&(l(0,"p",217),d(1,"\u5FC5\u586B\u6B04\u4F4D"),s())}function yL(n,e){n&1&&(l(0,"p",217),d(1,"\u91D1\u984D\u4E0D\u80FD\u70BA\u8CA0\u6578"),s())}function _L(n,e){if(n&1){let t=B();l(0,"div",20)(1,"div",211)(2,"h3",212),d(3),s(),l(4,"form",213),b("ngSubmit",function(){D(t);let r=_();return w(r.confirmMonthlySalaryAdjust())}),l(5,"div",214)(6,"label",215),d(7,"\u8ABF\u6574\u5F8C\u85AA\u8CC7"),s(),x(8,"input",216),M(9,hL,2,0,"p",217),M(10,yL,2,0,"p",217),s(),l(11,"div",218)(12,"button",219),b("click",function(){D(t);let r=_();return w(r.closeMonthlySalaryAdjustModal())}),d(13," \u53D6\u6D88 "),s(),l(14,"button",220),d(15," \u78BA\u8A8D\u8ABF\u6574 "),s()()()()()}if(n&2){let t,i,r,o=_();f(3),k("",(t=o.adjustingMonthlySalarySummary())==null?null:t.display_name," \u85AA\u8CC7\u8ABF\u6574"),f(),I("formGroup",o.adjustingAmountForm),f(5),A(!((i=o.adjustingAmountForm.get("total_wage"))==null||i.errors==null)&&i.errors.required?9:-1),f(),A(!((r=o.adjustingAmountForm.get("total_wage"))==null||r.errors==null)&&r.errors.min?10:-1),f(4),I("disabled",!o.adjustingAmountForm.valid)}}function vL(n,e){n&1&&(l(0,"p",217),d(1,"\u5FC5\u586B\u6B04\u4F4D"),s())}function CL(n,e){n&1&&(l(0,"p",217),d(1,"\u91D1\u984D\u4E0D\u80FD\u70BA\u8CA0\u6578"),s())}function xL(n,e){n&1&&d(0," \u767C\u653E\u91D1\u984D\u4F4E\u65BC\u85AA\u8CC7\u7E3D\u984D\uFF0C\u5DEE\u984D\u5C07\u81EA\u52D5\u8A18\u9304\u5230\u61C9\u4ED8\u85AA\u8CC7\u79D1\u76EE ")}function bL(n,e){n&1&&d(0," \u767C\u653E\u91D1\u984D\u7B49\u65BC\u85AA\u8CC7\u7E3D\u984D\uFF0C\u5C07\u76F4\u63A5\u8A18\u9304\u5230\u85AA\u8CC7\u652F\u51FA\u79D1\u76EE ")}function EL(n,e){if(n&1){let t=B();l(0,"div",20)(1,"div",211)(2,"h3",212),d(3),s(),l(4,"form",213),b("ngSubmit",function(){D(t);let r=_();return w(r.confirmReleaseMonthlySalarySummary())}),l(5,"div",214)(6,"label",221),d(7,"\u54E1\u5DE5\u85AA\u8CC7\u7E3D\u984D"),s(),l(8,"div",222),d(9),s()(),l(10,"div",214)(11,"label",223),d(12,"\u767C\u653E\u91D1\u984D"),s(),x(13,"input",224),M(14,vL,2,0,"p",217),M(15,CL,2,0,"p",217),s(),l(16,"div",225)(17,"p",226)(18,"strong"),d(19,"\u8AAA\u660E\uFF1A"),s(),M(20,xL,1,0)(21,bL,1,0),s()(),l(22,"div",218)(23,"button",219),b("click",function(){D(t);let r=_();return w(r.closeMonthlySalaryReleaseModal())}),d(24," \u53D6\u6D88 "),s(),l(25,"button",227),d(26," \u78BA\u8A8D\u767C\u653E "),s()()()()()}if(n&2){let t,i,r,o,a,u,c=_();f(3),k("",(t=c.releasingMonthlySalarySummary())==null?null:t.display_name," \u85AA\u8CC7\u767C\u653E"),f(),I("formGroup",c.releasingAmountForm),f(5),k(" ",c.formatCurrency(((i=c.releasingMonthlySalarySummary())==null?null:i.total_wage)||0)," "),f(4),I("max",(r=c.releasingMonthlySalarySummary())==null?null:r.total_wage),f(),A(!((o=c.releasingAmountForm.get("release_amount"))==null||o.errors==null)&&o.errors.required?14:-1),f(),A(!((a=c.releasingAmountForm.get("release_amount"))==null||a.errors==null)&&a.errors.min?15:-1),f(5),A((((u=c.releasingAmountForm.get("release_amount"))==null?null:u.value)||0)<(((u=c.releasingMonthlySalarySummary())==null?null:u.total_wage)||0)?20:21),f(5),I("disabled",!c.releasingAmountForm.valid)}}function SL(n,e){n&1&&(l(0,"p",217),d(1,"\u5FC5\u586B\u6B04\u4F4D"),s())}function DL(n,e){n&1&&(l(0,"p",217),d(1,"\u5FC5\u586B\u6B04\u4F4D"),s())}function wL(n,e){if(n&1){let t=B();l(0,"div",19)(1,"div",228)(2,"div",73)(3,"h2",74),d(4),s(),l(5,"button",75),b("click",function(){D(t);let r=_();return w(r.closeDailyForm())}),x(6,"ion-icon",76),s()(),l(7,"form",229),b("ngSubmit",function(){D(t);let r=_();return w(r.saveDailyRecord())}),l(8,"div",230)(9,"div")(10,"label",111),d(11,"\u54E1\u5DE5 ID"),s(),x(12,"input",231),s(),l(13,"div")(14,"label",111),d(15,"\u54E1\u5DE5\u59D3\u540D"),s(),x(16,"input",232),s()(),l(17,"div")(18,"label",111),d(19,"\u5DE5\u4F5C\u65E5\u671F *"),s(),x(20,"input",233),M(21,SL,2,0,"p",217),s(),l(22,"div",230)(23,"div")(24,"label",111),d(25,"\u4E0A\u73ED\u6253\u5361\u6642\u9593"),s(),x(26,"input",234),s(),l(27,"div")(28,"label",111),d(29,"\u4E0B\u73ED\u6253\u5361\u6642\u9593"),s(),x(30,"input",235),s()(),l(31,"div",230)(32,"div")(33,"label",111),d(34,"\u57FA\u672C\u6642\u85AA *"),s(),x(35,"input",236),M(36,DL,2,0,"p",217),s(),l(37,"div")(38,"label",111),d(39,"\u500D\u6578"),s(),x(40,"input",237),s()(),l(41,"div")(42,"label",111),d(43,"\u7279\u6B8A\u734E\u91D1"),s(),x(44,"input",238),s(),l(45,"div",152),x(46,"input",239),l(47,"label",240),d(48,"\u7279\u6B8A\u65E5\u671F"),s()(),l(49,"div")(50,"label",111),d(51,"\u5099\u8A3B"),s(),x(52,"textarea",241),s(),l(53,"div",242)(54,"button",122),b("click",function(){D(t);let r=_();return w(r.closeDailyForm())}),d(55," \u53D6\u6D88 "),s(),l(56,"button",220),d(57),s()()()()()}if(n&2){let t,i,r=_();f(4),E(r.editingDaily()?"\u7DE8\u8F2F\u6253\u5361\u8A18\u9304":"\u65B0\u589E\u6253\u5361\u8A18\u9304"),f(3),I("formGroup",r.dailyForm),f(14),A(!((t=r.dailyForm.get("work_date"))==null||t.errors==null)&&t.errors.required?21:-1),f(15),A(!((i=r.dailyForm.get("base_wage"))==null||i.errors==null)&&i.errors.required?36:-1),f(20),I("disabled",!r.dailyForm.valid),f(),k(" ",r.editingDaily()?"\u66F4\u65B0":"\u65B0\u589E"," ")}}var ja=class ja{constructor(){this.apiService=P(Xe);this.router=P(Ve);this.fb=P(je);this.activeTab=S("daily");this.currentDate=new Date;this.previousMonth=this.getPreviousMonth();this.selectedYear=S(this.previousMonth.year);this.selectedMonth=S(this.previousMonth.month);this.dailySummaries=S([]);this.dailyLoading=S(!1);this.dailyError=S("");this.monthlySummaryRecords=S([]);this.monthlySummaries=H(()=>{let e=this.dailySummaries(),t=this.getMonthlyWageUserIds(),i=new Map;return e.forEach(r=>{let o=new Date(r.work_date),a=o.getFullYear(),u=String(o.getMonth()+1).padStart(2,"0"),c=`${a}-${u}`,m=`${r.user_id}-${c}`,h=i.get(m)||{user_id:r.user_id,display_name:r.display_name,year_month:c,total_work_hours:0,total_wage:0,total_days:0,missing_records:0,is_fully_verified:!0,is_fully_paid:!0,wage_type:t.has(r.user_id)?"monthly":r.wage_type||"hourly",entry_id:r.entry_id||void 0};h.total_work_hours+=this.toNumber(r.work_hours),h.total_wage+=this.toNumber(r.total_wage),h.total_days+=1,(!r.clock_in_time||!r.clock_out_time)&&(h.missing_records+=1),r.is_verified||(h.is_fully_verified=!1),r.is_paid||(h.is_fully_paid=!1),r.entry_id&&!h.entry_id&&(h.entry_id=r.entry_id),i.set(m,h)}),Array.from(i.values()).sort((r,o)=>r.year_month===o.year_month?r.user_id-o.user_id:r.year_month.localeCompare(o.year_month))});this.hourlySummaries=H(()=>this.monthlySummaries().filter(e=>e.wage_type!=="monthly"));this.monthlySalarySummaries=H(()=>{let e=this.monthlySummaries().filter(y=>y.wage_type==="monthly"),t=this.monthlySalaryOverrides(),i=new Map(this.monthlySummaryRecords().map(y=>{let v=String(y.month).padStart(2,"0");return[`${y.user_id}-${y.year}-${v}`,y]})),r=this.selectedYear(),o=this.selectedMonth(),a=`${r}-${String(o).padStart(2,"0")}`,u=new Set(e.map(y=>y.user_id)),m=this.employeeWages().filter(y=>y.wage_type==="monthly").filter(y=>this.isWageEffectiveForMonth(y,r,o)).filter(y=>!u.has(y.user_id)).map(y=>({user_id:y.user_id,display_name:y.display_name||`ID: ${y.user_id}`,year_month:a,total_work_hours:0,total_wage:this.toNumber(y.hourly_rate),total_days:0,missing_records:0,is_fully_verified:!1,is_fully_paid:!1,wage_type:"monthly",entry_id:void 0}));return[...e,...m].map(y=>{let v=`${y.user_id}-${y.year_month}`,C=i.get(v),T=t.get(v);return G(V({},y),{display_name:C?.display_name||y.display_name,total_work_hours:C?.total_work_hours||y.total_work_hours,total_wage:C?.total_wage||y.total_wage,is_fully_verified:T?.is_fully_verified??C?.is_closed??y.is_fully_verified,is_fully_paid:T?.is_fully_paid??C?.is_paid??y.is_fully_paid,entry_id:T?.entry_id??C?.entry_id??y.entry_id})}).sort((y,v)=>y.user_id-v.user_id)});this.monthlyDetailsVisible=S(!1);this.monthlyDetailsRows=S([]);this.monthlyDetailsTitle=S("");this.currentMonthlySummary=S(null);this.selectedRows=S([]);this.dailyFormVisible=S(!1);this.editingDaily=S(null);this.employeeWages=S([]);this.wagesLoading=S(!1);this.wagesError=S("");this.specialDates=S([]);this.specialLoading=S(!1);this.specialError=S("");this.specialFormVisible=S(!1);this.editingSpecial=S(null);this.downloadingReports=S(new Set);this.wagesFormVisible=S(!1);this.editingWage=S(null);this.monthlySalaryReleaseModalVisible=S(!1);this.releasingMonthlySalarySummary=S(null);this.monthlySalaryOverrides=S(new Map);this.monthlySalaryAdjustModalVisible=S(!1);this.adjustingMonthlySalarySummary=S(null);this.payablesSummary=S({total_payable:0,employees:[]});this.payablesLoading=S(!1);this.payablesError=S("");this.payablesDetailModalVisible=S(!1);this.payablesDetails=S(null);this.payablesDetailsLoading=S(!1);this.dailyStats=H(()=>{let e=[...this.hourlySummaries(),...this.monthlySalarySummaries()],t=this.dailySummaries();return{totalRecords:e.length,totalWages:e.reduce((i,r)=>i+(Number(r.total_wage)||0),0),verifiedCount:e.filter(i=>i.is_fully_verified).length,paidCount:e.filter(i=>i.is_fully_paid).length,specialDayCount:t.filter(i=>i.is_special_day).length}});this.dailyForm=this.fb.group({user_id:["",U.required],display_name:["",U.required],work_date:["",U.required],clock_in_time:[""],clock_out_time:[""],work_hours:[""],regular_hours:[""],overtime_hours:[""],base_wage:["",U.required],multiplier:[1],regular_wage:[""],overtime_wage:[""],special_bonus:[0],total_wage:["",U.required],is_special_day:[!1],notes:[""]}),this.wageForm=this.fb.group({user_id:["",U.required],display_name:[""],hourly_rate:["",U.required],wage_type:["hourly"],effective_from:["",U.required],effective_to:[""],notes:[""]}),this.releasingAmountForm=this.fb.group({release_amount:["",[U.required,U.min(0)]]}),this.adjustingAmountForm=this.fb.group({total_wage:["",[U.required,U.min(0)]]}),$n(()=>{let e=this.activeTab();e==="daily"?(this.loadDailySummaries(),this.loadMonthlySummaries(),this.loadEmployeeWages()):e==="wages"?this.loadEmployeeWages():e==="special"?this.loadSpecialDates():e==="payables"&&this.loadPayablesSummary()})}getMonthlyWageUserIds(){let e=this.selectedYear(),t=this.selectedMonth(),i=this.employeeWages().filter(r=>r.wage_type==="monthly").filter(r=>this.isWageEffectiveForMonth(r,e,t)).map(r=>r.user_id);return new Set(i)}isWageEffectiveForMonth(e,t,i){let r=new Date(t,i-1,1),o=new Date(t,i,0),a=e.effective_from?new Date(e.effective_from):null,u=e.effective_to?new Date(e.effective_to):null;return!(a&&a>o||u&&u<r)}async loadSpecialDates(){this.specialLoading.set(!0),this.specialError.set("");try{let e=await this.apiService.getSpecialDates({year:this.selectedYear()});if(e.success&&e.data){let t=e.data.sort((i,r)=>new Date(i.date).getTime()-new Date(r.date).getTime());this.specialDates.set(t)}else this.specialError.set(e.error||"\u8F09\u5165\u7279\u6B8A\u5DE5\u4F5C\u65E5\u5931\u6557")}catch(e){this.specialError.set(e?.message||"\u8F09\u5165\u5931\u6557"),console.error("Error loading special dates:",e)}finally{this.specialLoading.set(!1)}}async saveSpecialDate(e){try{let t=this.editingSpecial(),i;t?i=await this.apiService.updateSpecialDate(t.id,e):i=await this.apiService.createSpecialDate(e),i.success?(alert(t?"\u66F4\u65B0\u6210\u529F":"\u65B0\u589E\u6210\u529F"),this.specialFormVisible.set(!1),this.loadSpecialDates()):alert("\u64CD\u4F5C\u5931\u6557: "+(i.error||"\u672A\u77E5\u932F\u8AA4"))}catch(t){alert("\u64CD\u4F5C\u5931\u6557: "+t?.message)}}async deleteSpecialDate(e){if(confirm("\u78BA\u5B9A\u8981\u522A\u9664\u6B64\u7279\u6B8A\u5DE5\u4F5C\u65E5\u8A2D\u5B9A\u55CE\uFF1F"))try{let t=await this.apiService.deleteSpecialDate(e);t.success?(alert("\u522A\u9664\u6210\u529F"),this.loadSpecialDates()):alert("\u522A\u9664\u5931\u6557: "+(t.error||"\u672A\u77E5\u932F\u8AA4"))}catch(t){alert("\u522A\u9664\u5931\u6557: "+t?.message)}}openSpecialForm(e){if(e){let t=G(V({},e),{date:this.formatDateYMD(e.date)});this.editingSpecial.set(t)}else this.editingSpecial.set(null);this.specialFormVisible.set(!0)}closeSpecialForm(){this.specialFormVisible.set(!1),this.editingSpecial.set(null)}async downloadLaborReport(e,t){t.stopPropagation();let i=`${e.user_id}-${e.year_month}`;if(this.downloadingReports().has(i))return;let r=new Set(this.downloadingReports());r.add(i),this.downloadingReports.set(r);try{let o=await this.apiService.downloadLaborReport(e.user_id,e.year_month),a=o.body||new Blob,u=o.headers.get("Content-Disposition")||"",c=u.match(/filename\*=UTF-8''([^;]+)/i),m=u.match(/filename="?([^";]+)"?/i),h="labor-report.zip";if(c?.[1])try{h=decodeURIComponent(c[1])}catch{h=c[1]}else m?.[1]&&(h=m[1]);let y=window.URL.createObjectURL(a),v=document.createElement("a");v.href=y,v.download=h,document.body.appendChild(v),v.click(),document.body.removeChild(v),window.URL.revokeObjectURL(y)}catch(o){alert("\u4E0B\u8F09\u52DE\u5831\u55AE\u5931\u6557: "+(o?.message||"\u672A\u77E5\u932F\u8AA4")),console.error("Error downloading labor report:",o)}finally{let o=new Set(this.downloadingReports());o.delete(i),this.downloadingReports.set(o)}}toNumber(e){if(e==null||e==="")return 0;let t=Number(e);return Number.isFinite(t)?t:0}toDateInput(e){if(!e)return"";let t=new Date(e);if(Number.isNaN(t.getTime()))return typeof e=="string"&&e.includes("T")?e.split("T")[0]:typeof e=="string"?e:"";let i=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0");return`${i}-${r}-${o}`}toTimeInput(e){if(!e)return"";let t=new Date(e);if(!Number.isNaN(t.getTime())){let i=String(t.getHours()).padStart(2,"0"),r=String(t.getMinutes()).padStart(2,"0");return`${i}:${r}`}return typeof e=="string"?e.includes("T")?(e.split("T")[1]||"").slice(0,5):e.slice(0,5):""}combineDateTime(e,t){if(!t)return null;let i=this.toDateInput(e),r=new Date(`${i}T${t}:00`);if(isNaN(r.getTime()))return null;let o=r.getFullYear(),a=String(r.getMonth()+1).padStart(2,"0"),u=String(r.getDate()).padStart(2,"0"),c=String(r.getHours()).padStart(2,"0"),m=String(r.getMinutes()).padStart(2,"0"),h=String(r.getSeconds()).padStart(2,"0"),y=-r.getTimezoneOffset(),v=String(Math.floor(Math.abs(y)/60)).padStart(2,"0"),C=String(Math.abs(y)%60).padStart(2,"0"),T=y>=0?"+":"-";return`${o}-${a}-${u}T${c}:${m}:${h}${T}${v}:${C}`}calculateWorkHours(e,t){if(!e||!t)return 0;try{let i=new Date(e),r=new Date(t);if(isNaN(i.getTime())){let u=e.replace(/ /g,"T").split("+")[0];i=new Date(u)}if(isNaN(r.getTime())){let u=t.replace(/ /g,"T").split("+")[0];r=new Date(u)}if(isNaN(i.getTime())||isNaN(r.getTime()))return 0;let o=r.getTime()-i.getTime();return o<0&&(o+=1440*60*1e3),Math.floor(o/(1e3*60*60)*100)/100}catch{return 0}}calculateWage(e,t){if(e<=0)return 0;let i;if(e<=8)i=e*t;else{let r=8*t,o=(e-8)*t*1.34;i=r+o}return Math.floor(i)}normalizeDailySummary(e){return G(V({},e),{work_hours:this.toNumber(e.work_hours),regular_hours:this.toNumber(e.regular_hours),overtime_hours:this.toNumber(e.overtime_hours),base_wage:this.toNumber(e.base_wage),multiplier:this.toNumber(e.multiplier),regular_wage:this.toNumber(e.regular_wage),overtime_wage:this.toNumber(e.overtime_wage),special_bonus:this.toNumber(e.special_bonus),total_wage:this.toNumber(e.total_wage)})}normalizeEmployeeWage(e){return G(V({},e),{hourly_rate:this.toNumber(e.hourly_rate)})}getPreviousMonth(){let e=new Date,t=e.getMonth()+1,i=e.getFullYear();return t===1?(t=12,i--):t--,{year:i,month:t}}onMonthChange(){this.activeTab()==="daily"&&(this.loadDailySummaries(),this.loadMonthlySummaries())}resetFilter(){let e=this.getPreviousMonth();this.selectedYear.set(e.year),this.selectedMonth.set(e.month),this.onMonthChange()}async loadDailySummaries(){this.dailyLoading.set(!0),this.dailyError.set("");try{let e=await this.apiService.getDailySummaries({year:this.selectedYear(),month:this.selectedMonth(),limit:1e3});if(e.success&&e.data){let t=e.data.map(i=>this.normalizeDailySummary(i));this.dailySummaries.set(t)}else this.dailyError.set(e.error||"\u8F09\u5165\u8CC7\u6599\u5931\u6557")}catch(e){this.dailyError.set(e?.message||"\u8F09\u5165\u5931\u6557"),console.error("Error loading daily summaries:",e)}finally{this.dailyLoading.set(!1)}}async loadMonthlySummaries(){try{let e=await this.apiService.getMonthlySummaries({year:this.selectedYear(),month:this.selectedMonth()});if(e.success&&e.data){let t=e.data.map(i=>G(V({},i),{total_work_hours:this.toNumber(i.total_work_hours),total_wage:this.toNumber(i.total_wage)}));this.monthlySummaryRecords.set(t)}else this.monthlySummaryRecords.set([])}catch(e){console.error("Error loading monthly summaries:",e),this.monthlySummaryRecords.set([])}}openDailyForm(e){if(e){let t=this.normalizeDailySummary(e);this.editingDaily.set(t),this.dailyForm.patchValue(G(V({},t),{work_date:this.toDateInput(t.work_date)}))}else this.editingDaily.set(null),this.dailyForm.reset({multiplier:1,special_bonus:0,is_special_day:!1});this.dailyFormVisible.set(!0)}openMonthlyDetails(e){let i=this.dailySummaries().filter(r=>r.user_id===e.user_id).filter(r=>{let o=new Date(r.work_date),a=o.getFullYear(),u=String(o.getMonth()+1).padStart(2,"0");return`${a}-${u}`===e.year_month}).sort((r,o)=>new Date(r.work_date).getTime()-new Date(o.work_date).getTime()).map(r=>{let o=this.normalizeDailySummary(r),a=G(V({},o),{clock_in_time_input:this.toTimeInput(r.clock_in_time),clock_out_time_input:this.toTimeInput(r.clock_out_time)});if(r.clock_in_time&&r.clock_out_time&&(!o.work_hours||o.work_hours===0)){let u=r.clock_in_time,c=r.clock_out_time,m=this.calculateWorkHours(u,c),h=this.calculateWage(m,o.base_wage);a.work_hours=m,a.total_wage=h,console.log("[DEBUG] \u81EA\u52D5\u8A08\u7B97\u5DE5\u6642:",{work_date:r.work_date,clock_in_time:u,clock_out_time:c,calculated_hours:m,calculated_wage:h,base_wage:o.base_wage}),this.apiService.updateDailySummary(r.id,{work_hours:m,total_wage:h}).then(y=>{y.success?console.log("[DEBUG] \u81EA\u52D5\u4FDD\u5B58\u6210\u529F:",{id:r.id}):console.warn("[DEBUG] \u81EA\u52D5\u4FDD\u5B58\u5931\u6557:",y.error)}).catch(y=>{console.error("[DEBUG] \u81EA\u52D5\u4FDD\u5B58\u932F\u8AA4:",y)})}return a}).map(r=>{let o=this.combineDateTime(r.work_date,r.clock_in_time_input),a=this.combineDateTime(r.work_date,r.clock_out_time_input);if(o&&a){let u=new Date(o).getTime();if(new Date(a).getTime()<u){let[m,h,y]=r.work_date.split("-"),v=new Date(parseInt(m),parseInt(h)-1,parseInt(y)+1),C=`${v.getFullYear()}-${String(v.getMonth()+1).padStart(2,"0")}-${String(v.getDate()).padStart(2,"0")}`;a=this.combineDateTime(C,r.clock_out_time_input)}}if(o&&a){let u=this.calculateWorkHours(o,a),c=this.calculateWage(u,r.base_wage);return G(V({},r),{work_hours:u,total_wage:c})}return r});this.monthlyDetailsRows.set(i),this.currentMonthlySummary.set(e),this.monthlyDetailsTitle.set(`${e.display_name} - ${e.year_month}`),this.monthlyDetailsVisible.set(!0)}closeMonthlyDetails(){this.monthlyDetailsVisible.set(!1),this.monthlyDetailsRows.set([]),this.monthlyDetailsTitle.set(""),this.currentMonthlySummary.set(null),this.selectedRows.set([]),this.loadDailySummaries()}toggleRowSelection(e,t){let i=t.target.checked,r=this.selectedRows();i?this.selectedRows.set([...r,e]):this.selectedRows.set(r.filter(o=>o!==e))}toggleSelectAll(e){if(e.target.checked){let i=this.monthlyDetailsRows().filter(r=>!r.is_paid).map(r=>r.id);this.selectedRows.set(i)}else this.selectedRows.set([])}isRowSelected(e){return this.selectedRows().includes(e)}async batchVerifyRecords(){let e=this.selectedRows();if(e.length===0){alert("\u8ACB\u9078\u64C7\u8981\u6838\u5C0D\u7684\u8A18\u9304");return}if(confirm(`\u78BA\u5B9A\u8981\u6838\u5C0D\u9078\u4E2D\u7684 ${e.length} \u7B46\u8A18\u9304\u55CE\uFF1F`))try{let t=e.map(u=>this.apiService.updateDailySummary(u,{is_verified:!0})),r=(await Promise.all(t)).filter(u=>u.success).length,a=this.monthlyDetailsRows().map(u=>e.includes(u.id)?G(V({},u),{is_verified:!0}):u);this.monthlyDetailsRows.set(a),this.selectedRows.set([]),alert(`\u6210\u529F\u6838\u5C0D ${r} \u7B46\u8A18\u9304`)}catch(t){alert("\u6279\u91CF\u6838\u5C0D\u5931\u6557: "+t?.message)}}async batchReleaseRecords(){let e=this.selectedRows();if(e.length===0){alert("\u8ACB\u9078\u64C7\u8981\u767C\u653E\u7684\u8A18\u9304");return}let t=this.monthlyDetailsRows();if(e.filter(r=>{let o=t.find(a=>a.id===r);return o&&!o.is_verified}).length>0){alert("\u6709\u672A\u6838\u5C0D\u7684\u8A18\u9304\uFF0C\u8ACB\u5148\u6838\u5C0D\u5F8C\u518D\u767C\u653E");return}if(confirm(`\u78BA\u5B9A\u8981\u767C\u653E\u9078\u4E2D\u7684 ${e.length} \u7B46\u8A18\u9304\u55CE\uFF1F\u767C\u653E\u5F8C\u5C07\u7121\u6CD5\u518D\u7DE8\u8F2F\u3002`))try{let r=await this.apiService.batchReleasePayroll(e);if(!r.success||!r.data){alert("\u6279\u91CF\u767C\u653E\u5931\u6557: "+(r.error||"\u672A\u77E5\u932F\u8AA4"));return}let o=r.data.entry_id,u=this.monthlyDetailsRows().map(h=>e.includes(h.id)?G(V({},h),{is_paid:!0,entry_id:o}):h);this.monthlyDetailsRows.set(u);let m=this.dailySummaries().map(h=>e.includes(h.id)?G(V({},h),{is_paid:!0,entry_id:o}):h);this.dailySummaries.set(m),this.selectedRows.set([]),alert("\u6279\u91CF\u767C\u653E\u6210\u529F")}catch(r){alert("\u6279\u91CF\u767C\u653E\u5931\u6557: "+r?.message)}}updateMonthlyDetailDisplay(e){let t=this.combineDateTime(e.work_date,e.clock_in_time_input),i=this.combineDateTime(e.work_date,e.clock_out_time_input);if(console.log("[DEBUG] updateMonthlyDetailDisplay:",{work_date:e.work_date,clock_in_time_input:e.clock_in_time_input,clock_out_time_input:e.clock_out_time_input,clockInTime:t,clockOutTime:i,base_wage:e.base_wage}),t&&i){let r=new Date(t).getTime();if(new Date(i).getTime()<r){let[a,u,c]=e.work_date.split("-"),m=new Date(parseInt(a),parseInt(u)-1,parseInt(c)+1),h=`${m.getFullYear()}-${String(m.getMonth()+1).padStart(2,"0")}-${String(m.getDate()).padStart(2,"0")}`;i=this.combineDateTime(h,e.clock_out_time_input),console.log("[DEBUG] \u5075\u6E2C\u5230\u8DE8\u65E5\u73ED\u6B21\uFF0C\u4E0B\u73ED\u65E5\u671F\u8ABF\u6574\u70BA:",h)}}if(t&&i){let r=this.calculateWorkHours(t,i),o=this.calculateWage(r,e.base_wage);console.log("[DEBUG] \u8A08\u7B97\u7D50\u679C:",{newWorkHours:r,newTotalWage:o}),e.work_hours=r,e.total_wage=o,this.monthlyDetailsRows.set([...this.monthlyDetailsRows()])}else console.warn("[DEBUG] clockInTime \u6216 clockOutTime \u7121\u6548",{clockInTime:t,clockOutTime:i})}async saveMonthlyDetail(e){let t=this.combineDateTime(e.work_date,e.clock_in_time_input),i=this.combineDateTime(e.work_date,e.clock_out_time_input);if(t&&i){let u=new Date(t).getTime();if(new Date(i).getTime()<u){let[m,h,y]=e.work_date.split("-"),v=new Date(parseInt(m),parseInt(h)-1,parseInt(y)+1),C=`${v.getFullYear()}-${String(v.getMonth()+1).padStart(2,"0")}-${String(v.getDate()).padStart(2,"0")}`;i=this.combineDateTime(C,e.clock_out_time_input)}}let r=this.calculateWorkHours(t,i),o=this.calculateWage(r,e.base_wage),a={clock_in_time:t,clock_out_time:i,work_hours:r,total_wage:o};try{let u=await this.apiService.updateDailySummary(e.id,a);u.success?(alert("\u66F4\u65B0\u6210\u529F"),this.loadDailySummaries()):alert("\u66F4\u65B0\u5931\u6557: "+(u.error||"\u672A\u77E5\u932F\u8AA4"))}catch(u){alert("\u66F4\u65B0\u5931\u6557: "+u?.message)}}async deleteMonthlyDetail(e){if(confirm(`\u78BA\u5B9A\u8981\u522A\u9664 ${e.display_name} \u5728 ${this.formatDateYMD(e.work_date)} \u7684\u6253\u5361\u8A18\u9304\u55CE\uFF1F`))try{let t=await this.apiService.deleteDailySummary(e.id);if(t.success){alert("\u522A\u9664\u6210\u529F"),this.loadDailySummaries();let i=this.monthlyDetailsRows();this.monthlyDetailsRows.set(i.filter(r=>r.id!==e.id))}else alert("\u522A\u9664\u5931\u6557: "+(t.error||"\u672A\u77E5\u932F\u8AA4"))}catch(t){alert("\u522A\u9664\u5931\u6557: "+t?.message)}}openCreateClockRecord(){let e=this.monthlyDetailsTitle();console.log("[DEBUG] openCreateClockRecord title:",e);let t=e.match(/(.+?)\s*-\s*(\d{4})-(\d{1,2})/)||e.match(/(.+) - (\d{4})-(\d{2})/),i=this.monthlyDetailsRows()[0];if(!i){alert("\u7121\u6CD5\u7372\u53D6\u54E1\u5DE5\u4FE1\u606F");return}let r=`${this.selectedYear()}-${String(this.selectedMonth()).padStart(2,"0")}-01`;if(t){let o=t[2],a=String(t[3]).padStart(2,"0");r=`${o}-${a}-01`}this.dailyForm.patchValue({user_id:i.user_id,display_name:i.display_name,work_date:r,base_wage:i.base_wage||200,total_wage:0,multiplier:1,special_bonus:0,is_special_day:!1}),this.editingDaily.set(null),this.dailyFormVisible.set(!0),console.log("[DEBUG] openCreateClockRecord - \u8868\u55AE\u5DF2\u6253\u958B")}async verifyMonthlyDetail(e){try{let t=await this.apiService.updateDailySummary(e.id,{is_verified:!e.is_verified});t.success?(alert(e.is_verified?"\u5DF2\u53D6\u6D88\u6838\u5C0D":"\u5DF2\u6838\u5C0D"),this.loadDailySummaries()):alert("\u64CD\u4F5C\u5931\u6557: "+(t.error||"\u672A\u77E5\u932F\u8AA4"))}catch(t){alert("\u64CD\u4F5C\u5931\u6557: "+t?.message)}}async releaseMonthlyDetail(e){try{let t=await this.apiService.updateDailySummary(e.id,{is_paid:!e.is_paid});t.success?(alert(e.is_paid?"\u5DF2\u53D6\u6D88\u767C\u653E":"\u5DF2\u767C\u653E"),this.loadDailySummaries()):alert("\u64CD\u4F5C\u5931\u6557: "+(t.error||"\u672A\u77E5\u932F\u8AA4"))}catch(t){alert("\u64CD\u4F5C\u5931\u6557: "+t?.message)}}closeDailyForm(){this.dailyFormVisible.set(!1),this.editingDaily.set(null),this.dailyForm.reset()}async saveDailyRecord(){if(!this.dailyForm.valid){alert("\u8ACB\u586B\u5BEB\u5FC5\u8981\u6B04\u4F4D");return}try{let e=this.dailyForm.value,t=this.editingDaily();if(!t&&this.dailySummaries().find(m=>m.user_id===e.user_id&&m.work_date===e.work_date)){alert(`\u8A72\u54E1\u5DE5\u5728 ${e.work_date} \u5DF2\u6709\u6253\u5361\u8A18\u9304\uFF0C\u8ACB\u5148\u522A\u9664\u5F8C\u91CD\u65B0\u65B0\u589E`);return}let i=null,r=null;if(e.work_date&&e.clock_in_time&&(i=this.combineDateTime(e.work_date,e.clock_in_time)),e.work_date&&e.clock_out_time&&(r=this.combineDateTime(e.work_date,e.clock_out_time)),i&&r){let c=new Date(i).getTime();if(new Date(r).getTime()<c){let[h,y,v]=e.work_date.split("-"),C=new Date(parseInt(h),parseInt(y)-1,parseInt(v)+1),T=`${C.getFullYear()}-${String(C.getMonth()+1).padStart(2,"0")}-${String(C.getDate()).padStart(2,"0")}`;r=this.combineDateTime(T,e.clock_out_time)}}let o=this.calculateWorkHours(i,r),a=this.calculateWage(o,e.base_wage||200),u={user_id:e.user_id,display_name:e.display_name,work_date:e.work_date,clock_in_time:i,clock_out_time:r,work_hours:o,base_wage:e.base_wage||200,multiplier:e.multiplier||1,special_bonus:e.special_bonus||0,total_wage:a,release_amount:a,is_special_day:e.is_special_day||!1,notes:e.notes||""};if(t){let c=await this.apiService.updateDailySummary(t.id,u);c.success?(alert("\u66F4\u65B0\u6210\u529F"),this.closeDailyForm(),this.loadDailySummaries()):alert("\u66F4\u65B0\u5931\u6557: "+(c.error||"\u672A\u77E5\u932F\u8AA4"))}else{let c=await this.apiService.createDailySummary(u);c.success?(alert("\u65B0\u589E\u6210\u529F"),this.closeDailyForm(),this.loadDailySummaries()):alert("\u65B0\u589E\u5931\u6557: "+(c.error||"\u672A\u77E5\u932F\u8AA4"))}}catch(e){alert("\u64CD\u4F5C\u5931\u6557: "+e?.message),console.error("Error saving daily record:",e)}}async deleteDailyRecord(e){if(confirm(`\u78BA\u5B9A\u8981\u522A\u9664 ${e.display_name} \u7684\u85AA\u8CC7\u7D00\u9304\u55CE?`))try{let t=await this.apiService.deleteDailySummary(e.id);t.success?(alert("\u522A\u9664\u6210\u529F"),this.loadDailySummaries()):alert("\u522A\u9664\u5931\u6557: "+(t.error||"\u672A\u77E5\u932F\u8AA4"))}catch(t){alert("\u522A\u9664\u5931\u6557: "+t?.message),console.error("Error deleting daily record:",t)}}async verifyDailyRecord(e){try{let t=await this.apiService.updateDailySummary(e.id,{is_verified:!e.is_verified,verified_by:"user",verified_at:e.is_verified?null:new Date().toISOString()});t.success?(alert(e.is_verified?"\u5DF2\u53D6\u6D88\u6838\u5C0D":"\u5DF2\u6838\u5C0D"),this.loadDailySummaries()):alert("\u64CD\u4F5C\u5931\u6557: "+(t.error||"\u672A\u77E5\u932F\u8AA4"))}catch(t){alert("\u64CD\u4F5C\u5931\u6557: "+t?.message)}}async releaseDailyRecord(e){try{let t=await this.apiService.updateDailySummary(e.id,{is_paid:!e.is_paid,paid_by:"user",paid_at:e.is_paid?null:new Date().toISOString()});t.success?(alert(e.is_paid?"\u5DF2\u53D6\u6D88\u767C\u653E":"\u5DF2\u767C\u653E"),this.loadDailySummaries()):alert("\u64CD\u4F5C\u5931\u6557: "+(t.error||"\u672A\u77E5\u932F\u8AA4"))}catch(t){alert("\u64CD\u4F5C\u5931\u6557: "+t?.message)}}async loadEmployeeWages(){this.wagesLoading.set(!0),this.wagesError.set("");try{let e=await this.apiService.getEmployeeWages({limit:1e3});if(e.success&&e.data){let t=e.data.map(i=>this.normalizeEmployeeWage(i));this.employeeWages.set(t)}else this.wagesError.set(e.error||"\u8F09\u5165\u8CC7\u6599\u5931\u6557")}catch(e){this.wagesError.set(e?.message||"\u8F09\u5165\u5931\u6557"),console.error("Error loading employee wages:",e)}finally{this.wagesLoading.set(!1)}}openWageForm(e){if(e){let t=this.normalizeEmployeeWage(e);this.editingWage.set(t),this.wageForm.patchValue(G(V({},t),{effective_from:this.toDateInput(t.effective_from),effective_to:this.toDateInput(t.effective_to)}))}else this.editingWage.set(null),this.wageForm.reset({wage_type:"hourly",effective_from:this.toDateInput(new Date)});this.wagesFormVisible.set(!0)}closeWageForm(){this.wagesFormVisible.set(!1),this.editingWage.set(null),this.wageForm.reset()}async saveWageRecord(){if(!this.wageForm.valid){alert("\u8ACB\u586B\u5BEB\u5FC5\u8981\u6B04\u4F4D");return}try{let e=this.wageForm.value,t=this.editingWage();if(t){let i=await this.apiService.updateEmployeeWage(t.id,e);i.success?(alert("\u66F4\u65B0\u6210\u529F"),this.closeWageForm(),this.loadEmployeeWages()):alert("\u66F4\u65B0\u5931\u6557: "+(i.error||"\u672A\u77E5\u932F\u8AA4"))}else{let i=await this.apiService.createEmployeeWage(e);i.success?(alert("\u65B0\u589E\u6210\u529F"),this.closeWageForm(),this.loadEmployeeWages()):alert("\u65B0\u589E\u5931\u6557: "+(i.error||"\u672A\u77E5\u932F\u8AA4"))}}catch(e){alert("\u64CD\u4F5C\u5931\u6557: "+e?.message),console.error("Error saving wage record:",e)}}async deleteWageRecord(e){if(confirm(`\u78BA\u5B9A\u8981\u522A\u9664 ${e.display_name||`ID: ${e.user_id}`} \u7684\u85AA\u8CC7\u8A2D\u5B9A\u55CE?`))try{let t=await this.apiService.deleteEmployeeWage(e.id);t.success?(alert("\u522A\u9664\u6210\u529F"),this.loadEmployeeWages()):alert("\u522A\u9664\u5931\u6557: "+(t.error||"\u672A\u77E5\u932F\u8AA4"))}catch(t){alert("\u522A\u9664\u5931\u6557: "+t?.message),console.error("Error deleting wage record:",t)}}formatCurrency(e){return e==null?"":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}formatDate(e){if(!e)return"";try{return new Date(e).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"})}catch{return e}}formatDateYMD(e){if(!e)return"";try{let t=new Date(e),i=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0");return`${i}-${r}-${o}`}catch{return e||""}}formatMonth(e){if(!e)return"";try{let t=new Date(e),i=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0");return`${i}-${r}`}catch{return e}}formatDateYM(e){if(!e)return"";try{let t=new Date(e),i=t.getFullYear(),r=t.getMonth()+1;return`${i}\u5E74${r}\u6708`}catch{return e}}formatDateTime(e){if(!e)return"";try{return new Date(e).toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1})}catch{return e}}formatTime(e){if(!e)return"";try{return new Date(e).toLocaleTimeString("zh-TW",{hour:"2-digit",minute:"2-digit"})}catch{return e}}async verifyMonthlySalarySummary(e){if(confirm(`\u78BA\u5B9A\u8981\u6838\u5C0D ${e.display_name} (${e.year_month}) \u7684\u85AA\u8CC7\u55CE\uFF1F`))try{let[t,i]=e.year_month.split("-").map(Number),r=await this.apiService.verifyMonthlySalary(e.user_id,t,i);if(r.success){alert("\u6838\u5C0D\u6210\u529F");let o=`${e.user_id}-${e.year_month}`,a=new Map(this.monthlySalaryOverrides()),u=a.get(o)||{};a.set(o,G(V({},u),{is_fully_verified:!0})),this.monthlySalaryOverrides.set(a);let[c,m]=e.year_month.split("-").map(Number),h=this.monthlySummaryRecords(),y=!1,v=h.map(C=>C.user_id===e.user_id&&C.year===c&&C.month===m?(y=!0,G(V({},C),{is_closed:!0})):C);y||v.push({id:0,user_id:e.user_id,display_name:e.display_name,year:c,month:m,total_work_hours:e.total_work_hours,total_wage:e.total_wage,is_closed:!0,is_paid:!1,entry_id:e.entry_id||null}),this.monthlySummaryRecords.set(v)}else alert("\u6838\u5C0D\u5931\u6557: "+(r.error||"\u672A\u77E5\u932F\u8AA4"))}catch(t){alert("\u6838\u5C0D\u5931\u6557: "+t?.message)}}async releaseMonthlySalarySummary(e){this.releasingMonthlySalarySummary.set(e),this.releasingAmountForm.patchValue({release_amount:e.total_wage}),this.monthlySalaryReleaseModalVisible.set(!0)}openMonthlySalaryAdjust(e){if(e.is_fully_paid){alert("\u5DF2\u767C\u653E\u7684\u85AA\u8CC7\u7121\u6CD5\u8ABF\u6574");return}this.adjustingMonthlySalarySummary.set(e),this.adjustingAmountForm.patchValue({total_wage:e.total_wage}),this.monthlySalaryAdjustModalVisible.set(!0)}closeMonthlySalaryAdjustModal(){this.monthlySalaryAdjustModalVisible.set(!1),this.adjustingMonthlySalarySummary.set(null),this.adjustingAmountForm.reset()}async confirmMonthlySalaryAdjust(){if(!this.adjustingAmountForm.valid){alert("\u8ACB\u8F38\u5165\u6709\u6548\u7684\u85AA\u8CC7\u91D1\u984D");return}let e=this.adjustingMonthlySalarySummary();if(!e)return;let t=Number(this.adjustingAmountForm.get("total_wage")?.value);if(Number.isNaN(t)||t<0){alert("\u85AA\u8CC7\u91D1\u984D\u5FC5\u9808\u70BA 0 \u4EE5\u4E0A");return}if(confirm(`\u78BA\u5B9A\u8981\u8ABF\u6574 ${e.display_name} (${e.year_month}) \u7684\u85AA\u8CC7\u70BA ${this.formatCurrency(t)} \u55CE\uFF1F`))try{let[i,r]=e.year_month.split("-").map(Number),o=await this.apiService.updateMonthlySummary({user_id:e.user_id,year:i,month:r,total_wage:t,total_work_hours:e.total_work_hours,display_name:e.display_name});if(o.success&&o.data){alert("\u8ABF\u6574\u6210\u529F");let a=this.monthlySummaryRecords(),u=!1,c=a.map(m=>m.user_id===e.user_id&&m.year===i&&m.month===r?(u=!0,G(V({},m),{total_wage:t,total_work_hours:e.total_work_hours,display_name:e.display_name})):m);u||c.push({id:o.data.id||0,user_id:e.user_id,display_name:e.display_name,year:i,month:r,total_work_hours:e.total_work_hours,total_wage:t,is_closed:!1,is_paid:!1,entry_id:e.entry_id||null}),this.monthlySummaryRecords.set(c),this.closeMonthlySalaryAdjustModal()}else alert("\u8ABF\u6574\u5931\u6557: "+(o.error||"\u672A\u77E5\u932F\u8AA4"))}catch(i){alert("\u8ABF\u6574\u5931\u6557: "+i?.message)}}closeMonthlySalaryReleaseModal(){this.monthlySalaryReleaseModalVisible.set(!1),this.releasingMonthlySalarySummary.set(null),this.releasingAmountForm.reset()}async confirmReleaseMonthlySalarySummary(){if(!this.releasingAmountForm.valid){alert("\u8ACB\u8F38\u5165\u6709\u6548\u7684\u767C\u653E\u91D1\u984D");return}let e=this.releasingMonthlySalarySummary();if(!e)return;let t=Number(this.releasingAmountForm.get("release_amount")?.value);if(Number.isNaN(t)||t<0||t>e.total_wage){alert("\u767C\u653E\u91D1\u984D\u5FC5\u9808\u5728 0 \u5230 "+e.total_wage+" \u4E4B\u9593");return}if(confirm(`\u78BA\u5B9A\u8981\u767C\u653E ${e.display_name} (${e.year_month}) \u5171 ${this.formatCurrency(t)} \u55CE\uFF1F`))try{let[i,r]=e.year_month.split("-").map(Number),o=await this.apiService.releaseMonthlySalary(e.user_id,i,r,e.total_wage,e.total_work_hours,e.display_name,t);if(o.success&&o.data){alert(`\u767C\u653E\u6210\u529F (\u6D41\u6C34\u5E33: #${o.data.entry_id})`);let a=`${e.user_id}-${e.year_month}`,u=new Map(this.monthlySalaryOverrides()),c=u.get(a)||{};u.set(a,G(V({},c),{is_fully_paid:!0,entry_id:o.data.entry_id})),this.monthlySalaryOverrides.set(u);let[m,h]=e.year_month.split("-").map(Number),y=this.monthlySummaryRecords(),v=!1,C=y.map(T=>T.user_id===e.user_id&&T.year===m&&T.month===h?(v=!0,G(V({},T),{is_paid:!0,entry_id:o.data.entry_id})):T);v||C.push({id:0,user_id:e.user_id,display_name:e.display_name,year:m,month:h,total_work_hours:e.total_work_hours,total_wage:e.total_wage,is_closed:!0,is_paid:!0,entry_id:o.data.entry_id}),this.monthlySummaryRecords.set(C),this.closeMonthlySalaryReleaseModal()}else alert("\u767C\u653E\u5931\u6557: "+(o.error||"\u672A\u77E5\u932F\u8AA4"))}catch(i){alert("\u767C\u653E\u5931\u6557: "+i?.message)}}getMonthLabel(){return`${this.selectedYear()}\u5E74${this.selectedMonth()}\u6708`}async loadPayablesSummary(){this.payablesLoading.set(!0),this.payablesError.set("");try{let e=await this.apiService.getPayrollPayablesSummary();e.success&&e.data?this.payablesSummary.set({total_payable:e.data.total_payable||0,employees:e.data.employees||[]}):this.payablesError.set(e.error||"\u8F09\u5165\u8CC7\u6599\u5931\u6557")}catch(e){this.payablesError.set(e?.message||"\u8F09\u5165\u5931\u6557"),console.error("Error loading payables summary:",e)}finally{this.payablesLoading.set(!1)}}async openPayablesDetail(e){this.payablesDetailModalVisible.set(!0),await this.loadPayablesDetails(e.employee_id)}async loadPayablesDetails(e){this.payablesDetailsLoading.set(!0);try{let t=await this.apiService.getPayrollPayablesDetails(e);console.log("\u61C9\u4ED8\u85AA\u8CC7\u660E\u7D30 API \u56DE\u61C9:",t),t.success&&t.data?(console.log("\u6708\u5EA6\u5F59\u7E3D\u8CC7\u6599:",t.data.monthly_summary),this.payablesDetails.set(t.data)):alert("\u8F09\u5165\u660E\u7D30\u5931\u6557: "+(t.error||"\u672A\u77E5\u932F\u8AA4"))}catch(t){alert("\u8F09\u5165\u660E\u7D30\u5931\u6557: "+t?.message),console.error("Error loading payables details:",t)}finally{this.payablesDetailsLoading.set(!1)}}closePayablesDetailModal(){this.payablesDetailModalVisible.set(!1),this.payablesDetails.set(null)}calculateTotalSalary(e){return e.reduce((t,i)=>t+i.total_salary,0)}calculateTotalPaid(e){return e.reduce((t,i)=>t+i.paid_amount,0)}};ja.\u0275fac=function(t){return new(t||ja)},ja.\u0275cmp=re({type:ja,selectors:[["app-payroll"]],decls:31,vars:33,consts:[["specialDate",""],["specialName",""],["specialMultiplier",""],["specialActive",""],["specialNotes",""],[1,"space-y-6"],[1,"flex","flex-col","sm:flex-row","items-start","sm:items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-white","p-4","rounded-xl","shadow-md","border","border-gray-200","w-full","sm:w-auto"],[1,"flex","flex-col","sm:flex-row","items-center","gap-3"],[1,"flex","items-center","gap-2"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"flex","gap-4","border-b","border-gray-200"],[1,"px-4","py-3","text-sm","font-medium","text-gray-600","hover:text-gray-900","transition-colors",3,"click"],["name","calendar-outline",1,"text-base","align-middle","mr-2"],["name","people-outline",1,"text-base","align-middle","mr-2"],["name","star-outline",1,"text-base","align-middle","mr-2"],["name","wallet-outline",1,"text-base","align-middle","mr-2"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50","p-4"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"text-sm","font-medium","text-gray-600","whitespace-nowrap"],[1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100",3,"ngModelChange","change","ngModel"],[3,"value"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-4"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4"],[1,"text-center","py-8"],[1,"bg-gray-50","rounded-lg","p-8","text-center"],[1,"bg-white","p-4","rounded-lg","shadow-md","border","border-gray-200"],[1,"text-xs","text-gray-500","mb-1"],[1,"text-2xl","font-semibold","text-gray-900"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-2xl","font-semibold","text-green-600"],[1,"text-2xl","font-semibold","text-blue-600"],[1,"text-sm","text-red-700"],[1,"text-gray-500"],[1,"bg-white","rounded-lg","shadow-md","overflow-hidden","mb-6"],[1,"bg-white","rounded-lg","shadow-md","overflow-hidden"],[1,"bg-blue-50","border-b","border-blue-200","px-4","py-2"],[1,"text-sm","font-semibold","text-blue-900"],[1,"overflow-x-auto"],[1,"w-full","text-sm"],[1,"bg-gray-100","border-b","border-gray-200"],[1,"px-4","py-3","text-left","font-semibold","text-gray-700"],[1,"px-4","py-3","text-right","font-semibold","text-gray-700"],[1,"px-4","py-3","text-center","font-semibold","text-gray-700"],[1,"divide-y","divide-gray-200"],["title","\u9EDE\u64CA\u67E5\u770B\u660E\u7D30",1,"hover:bg-indigo-50","transition-colors","cursor-pointer"],["title","\u9EDE\u64CA\u67E5\u770B\u660E\u7D30",1,"hover:bg-indigo-50","transition-colors","cursor-pointer",3,"click"],[1,"px-4","py-3"],[1,"px-4","py-3","font-medium"],[1,"px-4","py-3","text-right"],[1,"px-4","py-3","text-right","font-semibold"],[1,"px-4","py-3","text-center"],[1,"text-red-600","font-medium"],[1,"text-green-600"],[1,"text-gray-700"],[1,"text-gray-400"],["title","\u4E0B\u8F09\u52DE\u5831\u55AE",1,"px-3","py-1","bg-blue-500","text-white","text-xs","rounded","hover:bg-blue-600","disabled:bg-gray-300","disabled:cursor-not-allowed","transition-colors",3,"click","disabled"],[1,"bg-green-50","border-b","border-green-200","px-4","py-2"],[1,"text-sm","font-semibold","text-green-900"],[1,"hover:bg-gray-50","transition-colors"],["title","\u8ABF\u6574\u7576\u6708\u85AA\u8CC7",1,"px-3","py-1","bg-gray-100","text-gray-700","rounded","text-xs","hover:bg-gray-200","disabled:bg-gray-300","disabled:text-gray-500","disabled:cursor-not-allowed","transition-colors",3,"click","disabled"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-green-100","text-green-800"],["title","\u6838\u5C0D\u6B64\u54E1\u5DE5\u85AA\u8CC7",1,"px-3","py-1","bg-green-600","text-white","rounded","text-xs","hover:bg-green-700","transition-colors"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-blue-100","text-blue-800"],["title","\u767C\u653E\u6B64\u54E1\u5DE5\u85AA\u8CC7\uFF08\u9700\u5148\u6838\u5C0D\uFF09",1,"px-3","py-1","bg-blue-600","text-white","rounded","text-xs","hover:bg-blue-700","disabled:bg-gray-300","disabled:cursor-not-allowed","transition-colors",3,"disabled"],["name","checkmark-done-outline",1,"mr-1"],["title","\u6838\u5C0D\u6B64\u54E1\u5DE5\u85AA\u8CC7",1,"px-3","py-1","bg-green-600","text-white","rounded","text-xs","hover:bg-green-700","transition-colors",3,"click"],["name","cash-outline",1,"mr-1"],["title","\u767C\u653E\u6B64\u54E1\u5DE5\u85AA\u8CC7\uFF08\u9700\u5148\u6838\u5C0D\uFF09",1,"px-3","py-1","bg-blue-600","text-white","rounded","text-xs","hover:bg-blue-700","disabled:bg-gray-300","disabled:cursor-not-allowed","transition-colors",3,"click","disabled"],[1,"text-gray-500","mb-4"],[1,"bg-white","rounded-lg","shadow-lg","max-w-6xl","w-full","max-h-[90vh]","overflow-y-auto"],[1,"sticky","top-0","bg-white","border-b","p-4","flex","justify-between","items-center"],[1,"text-lg","font-semibold"],[1,"text-gray-500","hover:text-gray-700",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6"],[1,"mb-4","flex","gap-4","items-center","bg-gray-50","p-4","rounded-lg"],[1,"flex-1","text-sm","text-gray-600"],[1,"flex","gap-2"],[1,"px-4","py-2","bg-indigo-600","text-white","rounded-lg","hover:bg-indigo-700","disabled:bg-gray-300","disabled:cursor-not-allowed","transition-colors","flex","items-center","gap-2",3,"click","disabled"],["name","add-outline"],[1,"px-4","py-2","bg-green-600","text-white","rounded-lg","hover:bg-green-700","disabled:bg-gray-300","disabled:cursor-not-allowed","transition-colors","flex","items-center","gap-2",3,"click","disabled"],["name","checkmark-done-outline"],[1,"px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","disabled:bg-gray-300","disabled:cursor-not-allowed","transition-colors","flex","items-center","gap-2",3,"click","disabled"],["name","cash-outline"],["type","checkbox",1,"rounded","border-gray-300","text-indigo-600","focus:ring-indigo-500",3,"change"],[1,"hover:bg-gray-50","transition-colors",3,"bg-green-50","opacity-60"],["type","checkbox",1,"rounded","border-gray-300","text-indigo-600","focus:ring-indigo-500","disabled:opacity-50",3,"change","checked","disabled"],["type","time",1,"w-36","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-indigo-500","text-base","disabled:bg-gray-100","disabled:cursor-not-allowed",3,"ngModelChange","change","ngModel","disabled"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-yellow-100","text-yellow-800"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-gray-100","text-gray-600"],[1,"flex","items-center","justify-center","gap-2"],["title","\u4FDD\u5B58\u6253\u5361\u6642\u9593",1,"text-indigo-600","hover:text-indigo-800","transition-colors","disabled:text-gray-300","disabled:cursor-not-allowed",3,"click","disabled"],["name","save-outline",1,"text-xl"],["title","\u522A\u9664\u6253\u5361\u8A18\u9304",1,"text-red-600","hover:text-red-800","transition-colors","disabled:text-gray-300","disabled:cursor-not-allowed",3,"click","disabled"],["name","trash-outline",1,"text-xl"],[1,"flex","justify-end"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2",3,"click"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-green-100","text-green-800"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-gray-100","text-gray-800"],["title","\u7DE8\u8F2F",1,"text-indigo-600","hover:text-indigo-800","transition-colors","mr-2",3,"click"],["name","pencil-outline"],["title","\u522A\u9664",1,"text-red-600","hover:text-red-800","transition-colors",3,"click"],["name","trash-outline"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors",3,"click"],[1,"bg-white","rounded-lg","shadow-lg","max-w-2xl","w-full"],[1,"bg-white","border-b","p-4","flex","justify-between","items-center"],[1,"p-6","space-y-4",3,"formGroup"],[1,"grid","grid-cols-2","gap-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["formControlName","user_id","type","number",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500",3,"readonly"],["formControlName","display_name","type","text",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500"],["formControlName","hourly_rate","type","number","step","0.01",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500"],["formControlName","wage_type",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500"],["value","hourly"],["value","monthly"],["formControlName","effective_from","type","date",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500"],["formControlName","effective_to","type","date",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500"],["formControlName","notes","rows","2",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500"],[1,"flex","justify-end","gap-3","pt-6","border-t"],["type","button",1,"px-4","py-2","border","border-gray-300","rounded-lg","text-gray-700","hover:bg-gray-50","transition-colors",3,"click"],["type","button",1,"px-4","py-2","bg-indigo-600","text-white","rounded-lg","hover:bg-indigo-700","transition-colors",3,"click"],[1,"flex","justify-between","items-center"],[1,"text-xl","font-semibold","text-gray-900"],[1,"px-4","py-2","bg-indigo-600","text-white","rounded-lg","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2",3,"click"],[1,"bg-red-50","text-red-600","p-4","rounded-lg"],[1,"bg-white","rounded-xl","shadow-md","overflow-hidden"],[1,"w-full"],[1,"bg-gray-50","border-b","border-gray-200"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"px-6","py-3","text-center","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],[1,"hover:bg-gray-50"],["colspan","6",1,"px-6","py-8","text-center","text-gray-500"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-900"],[1,"px-6","py-4","text-sm","text-gray-900"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-center"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-yellow-100","text-yellow-800"],[1,"px-6","py-4","text-sm","text-gray-500"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-center","space-x-2"],["title","\u7DE8\u8F2F",1,"text-indigo-600","hover:text-indigo-900",3,"click"],["name","create-outline",1,"text-lg","align-middle"],["title","\u522A\u9664",1,"text-red-600","hover:text-red-900",3,"click"],["name","trash-outline",1,"text-lg","align-middle"],[1,"bg-white","rounded-lg","shadow-xl","max-w-md","w-full"],[1,"text-lg","font-semibold","text-gray-900","mb-4"],[1,"space-y-4"],["type","date","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500",3,"value"],["type","text","placeholder","\u4F8B\u5982\uFF1A\u6625\u7BC0\u3001\u570B\u6176\u65E5","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500",3,"value"],["type","number","step","0.1","min","1","max","10","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500",3,"value"],[1,"flex","items-center"],["type","checkbox",1,"rounded","border-gray-300","text-indigo-600","focus:ring-indigo-500",3,"checked"],[1,"ml-2","text-sm","text-gray-700"],["rows","3","placeholder","\u9078\u586B",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500",3,"value"],[1,"flex","justify-end","gap-3","mt-6","pt-6","border-t"],[1,"bg-gradient-to-r","from-red-500","to-pink-600","rounded-xl","shadow-lg","p-6","text-white"],[1,"text-sm","uppercase","tracking-wide","opacity-90","mb-2"],[1,"text-3xl","font-bold"],[1,"text-4xl","font-bold"],[1,"text-sm","mt-2","opacity-90"],[1,"px-6","py-4","border-b","border-gray-200"],[1,"px-6","py-3","text-right","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"hover:bg-gray-50","cursor-pointer","transition-colors"],["colspan","3",1,"px-6","py-8","text-center","text-gray-500"],[1,"hover:bg-gray-50","cursor-pointer","transition-colors",3,"click"],[1,"px-6","py-4","whitespace-nowrap"],[1,"flex-shrink-0","h-10","w-10","bg-indigo-100","rounded-full","flex","items-center","justify-center"],["name","person-outline",1,"text-indigo-600","text-xl"],[1,"ml-4"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-xs","text-gray-500"],[1,"px-6","py-4","whitespace-nowrap","text-right"],[1,"text-sm","font-semibold","text-red-600"],[1,"px-6","py-4","whitespace-nowrap","text-center"],[1,"text-indigo-600","hover:text-indigo-900","font-medium","text-sm",3,"click"],["name","chevron-forward-outline",1,"align-middle"],[1,"bg-white","rounded-lg","shadow-xl","max-w-5xl","w-full","max-h-[90vh]","overflow-hidden","flex","flex-col"],[1,"px-6","py-4","border-b","border-gray-200","flex","justify-between","items-center"],[1,"text-sm","text-gray-500","mt-1"],[1,"font-semibold","text-red-600"],[1,"text-gray-400","hover:text-gray-600","transition-colors",3,"click"],[1,"flex-1","overflow-y-auto","p-6"],[1,"px-6","py-4","border-t","border-gray-200","flex","justify-end"],[1,"px-4","py-2","bg-gray-600","text-white","rounded-lg","hover:bg-gray-700","transition-colors",3,"click"],[1,"text-center","py-8","text-gray-500"],[1,"w-full","border-collapse"],[1,"bg-gradient-to-r","from-indigo-50","to-blue-50","border-b-2","border-indigo-200"],[1,"px-4","py-3","text-left","text-sm","font-semibold","text-gray-700"],[1,"px-4","py-3","text-right","text-sm","font-semibold","text-gray-700"],[1,"bg-gradient-to-r","from-gray-50","to-gray-100","border-t-2","border-gray-300"],[1,"px-4","py-3","text-sm","font-bold","text-gray-900"],[1,"px-4","py-3","text-sm","text-right","font-bold","text-gray-900"],[1,"px-4","py-3","text-sm","text-right","font-bold","text-green-600"],[1,"px-4","py-3","text-sm","text-right","font-bold","text-red-600"],[1,"border-b","border-gray-200","hover:bg-gray-50","transition-colors"],[1,"px-4","py-3","text-sm","text-gray-900"],[1,"px-4","py-3","text-sm","text-right","font-medium","text-gray-900"],[1,"px-4","py-3","text-sm","text-right","text-green-600","font-medium"],[1,"px-4","py-3","text-sm","text-right","font-semibold"],[1,"bg-gray-50"],["colspan","4",1,"px-4","py-2"],[1,"text-xs","text-gray-600"],[1,"cursor-pointer","hover:text-indigo-600","font-medium"],[1,"mt-2","pl-4","space-y-1"],[1,"flex","justify-between","items-center","py-1","border-b","border-gray-200","last:border-0"],[1,"flex-1"],[1,"ml-2","text-gray-400"],[1,"text-right"],[1,"font-mono"],[1,"bg-white","rounded-lg","shadow-lg","p-6","w-96"],[1,"text-lg","font-bold","mb-4"],[3,"ngSubmit","formGroup"],[1,"mb-4"],["for","adjustTotalWage",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","adjustTotalWage","type","number","formControlName","total_wage","step","0.01","min","0","placeholder","\u8F38\u5165\u8ABF\u6574\u5F8C\u85AA\u8CC7",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500"],[1,"text-red-600","text-sm","mt-1"],[1,"flex","justify-end","gap-3"],["type","button",1,"px-4","py-2","bg-gray-300","text-gray-800","rounded-lg","hover:bg-gray-400","transition-colors",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-lg","hover:bg-indigo-700","disabled:bg-gray-300","disabled:cursor-not-allowed","transition-colors",3,"disabled"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"text-2xl","font-bold","text-blue-600","mb-4"],["for","releaseAmount",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","releaseAmount","type","number","formControlName","release_amount","step","0.01","min","0","placeholder","\u8F38\u5165\u767C\u653E\u91D1\u984D",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"max"],[1,"mb-4","p-3","bg-orange-50","border","border-orange-200","rounded-lg"],[1,"text-sm","text-gray-700"],["type","submit",1,"px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","disabled:bg-gray-300","disabled:cursor-not-allowed","transition-colors",3,"disabled"],[1,"bg-white","rounded-lg","shadow-lg","max-w-2xl","w-full","max-h-[90vh]","overflow-y-auto"],[1,"p-6","space-y-4",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["type","number","formControlName","user_id","readonly","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","bg-gray-100","text-gray-600"],["type","text","formControlName","display_name","readonly","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","bg-gray-100","text-gray-600"],["type","date","formControlName","work_date",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500"],["type","time","formControlName","clock_in_time",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500"],["type","time","formControlName","clock_out_time",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500"],["type","number","formControlName","base_wage","step","0.01",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500"],["type","number","formControlName","multiplier","step","0.01","min","0.5",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500"],["type","number","formControlName","special_bonus","step","0.01",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500"],["type","checkbox","formControlName","is_special_day","id","is_special_day",1,"rounded","border-gray-300","text-indigo-600","focus:ring-indigo-500"],["for","is_special_day",1,"ml-2","text-sm","font-medium","text-gray-700"],["formControlName","notes","rows","3",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500"],[1,"flex","justify-end","gap-3","pt-4","border-t"]],template:function(t,i){t&1&&(l(0,"div",5)(1,"div",6)(2,"h1",7),d(3,"\u85AA\u8CC7\u7BA1\u7406"),s(),l(4,"div",8)(5,"div",9),M(6,Q9,6,2,"div",10)(7,eO,9,4,"div",10),l(8,"button",11),b("click",function(){return i.resetFilter()}),x(9,"ion-icon",12),s()()()(),l(10,"div",13)(11,"button",14),b("click",function(){return i.activeTab.set("daily")}),x(12,"ion-icon",15),d(13," \u6BCF\u6708\u85AA\u8CC7 "),s(),l(14,"button",14),b("click",function(){return i.activeTab.set("wages")}),x(15,"ion-icon",16),d(16," \u54E1\u5DE5\u85AA\u8CC7\u8A2D\u5B9A "),s(),l(17,"button",14),b("click",function(){return i.activeTab.set("special")}),x(18,"ion-icon",17),d(19," \u7279\u6B8A\u5DE5\u4F5C\u65E5 "),s(),l(20,"button",14),b("click",function(){return i.activeTab.set("payables")}),x(21,"ion-icon",18),d(22," \u61C9\u4ED8\u85AA\u8CC7 "),s()(),M(23,PO,7,6,"div",5),M(24,GO,10,5,"div",5),M(25,ZO,11,4,"div",5),M(26,aL,9,4,"div",5),M(27,gL,18,3,"div",19),M(28,_L,16,5,"div",20),M(29,EL,27,8,"div",20),M(30,wL,58,6,"div",19),s()),t&2&&(f(6),A(i.activeTab()==="special"?6:7),f(5),W("border-b-2",i.activeTab()==="daily")("border-indigo-600",i.activeTab()==="daily")("text-indigo-600",i.activeTab()==="daily"),f(3),W("border-b-2",i.activeTab()==="wages")("border-indigo-600",i.activeTab()==="wages")("text-indigo-600",i.activeTab()==="wages"),f(3),W("border-b-2",i.activeTab()==="special")("border-indigo-600",i.activeTab()==="special")("text-indigo-600",i.activeTab()==="special"),f(3),W("border-b-2",i.activeTab()==="payables")("border-indigo-600",i.activeTab()==="payables")("text-indigo-600",i.activeTab()==="payables"),f(3),A(i.activeTab()==="daily"?23:-1),f(),A(i.activeTab()==="wages"?24:-1),f(),A(i.activeTab()==="special"?25:-1),f(),A(i.activeTab()==="payables"?26:-1),f(),A(i.payablesDetailModalVisible()?27:-1),f(),A(i.monthlySalaryAdjustModalVisible()?28:-1),f(),A(i.monthlySalaryReleaseModalVisible()?29:-1),f(),A(i.dailyFormVisible()?30:-1))},dependencies:[oe,Se,Be,Fe,Pe,xe,kt,mo,Re,me,Le,po,Gl,Ie,ke,Ue,Ge],encapsulation:2,changeDetection:0});var ap=ja;function TL(n,e){if(n&1){let t=B();l(0,"tr",16)(1,"td",23)(2,"button",24),b("click",function(){let r=D(t).$index,o=_();return w(o.clearRecord(r))}),x(3,"ion-icon",25),s()(),l(4,"td",26),d(5),s(),l(6,"td",27),x(7,"input",28),s(),l(8,"td",27),x(9,"input",29),s(),l(10,"td",30),d(11),Gt(12,"number"),s(),l(13,"td",31),x(14,"input",32),s(),l(15,"td",33),d(16),Gt(17,"currency"),s()()}if(n&2){let t,i=e.$implicit,r=e.$index,o=_();I("formGroupName",r),f(5),Ke(" ",(t=i.get("date"))==null?null:t.value," (",o.getWeekday((t=i.get("date"))==null?null:t.value),") "),f(6),k(" ",sn(12,5,o.calculateWorkHours(i),"1.2-2")," "),f(5),k(" ",Kd(17,8,o.calculateSalary(i),"TWD","symbol","1.0-0")," ")}}var za=class za{constructor(){this.fb=P(je);this.dataService=P(Bt);this.router=P(Ve);this.route=P(un);this.employee=S(null);this.year=S(0);this.month=S(0);this.payrollForm=this.fb.group({records:this.fb.array([])});this.initialFormValue="";this.totalHours=H(()=>this.records.controls.reduce((e,t)=>e+this.calculateWorkHours(t),0));this.totalSalary=H(()=>this.records.controls.reduce((e,t)=>e+this.calculateSalary(t),0));this.route.paramMap.pipe(et(e=>{let t=e.get("employeeId"),i=Number(e.get("year")),r=Number(e.get("month"));if(!t||!i||!r){alert("\u7121\u6548\u7684\u7DB2\u5740\u53C3\u6578"),this.router.navigate(["/payroll"]);return}let o=this.dataService.getEmployeeById(t);if(!o){alert("\u627E\u4E0D\u5230\u54E1\u5DE5"),this.router.navigate(["/payroll"]);return}this.employee.set(o),this.year.set(i),this.month.set(r),this.buildForm(t,i,r)})).subscribe()}get records(){return this.payrollForm.get("records")}buildForm(e,t,i){let r=this.records;r.clear();let o=this.dataService.getPunchRecordsForMonth(e,t,i),a=new Date(t,i,0).getDate();for(let u=1;u<=a;u++){let c=`${t}-${String(i).padStart(2,"0")}-${String(u).padStart(2,"0")}`,m=o.find(y=>y.date===c),h=this.fb.group({date:[c],clockIn:[m?.clockIn||null],clockOut:[m?.clockOut||null],isDoublePay:[m?.isDoublePay||!1]});r.push(h)}this.initialFormValue=JSON.stringify(this.payrollForm.value)}getWeekday(e){return e?new Date(e+"T00:00:00").toLocaleDateString("zh-TW",{weekday:"short"}).replace("\u9031",""):""}calculateWorkHours(e){let{clockIn:t,clockOut:i}=e.value;if(!t||!i)return 0;let[r,o,a]=t.split(":").map(Number),[u,c,m]=i.split(":").map(Number),h=new Date(0,0,0,r,o,a||0),y=new Date(0,0,0,u,c,m||0);if(isNaN(h.getTime())||isNaN(y.getTime())||y<h)return 0;let C=(y.getTime()-h.getTime())/(1e3*60*60);return Math.floor(C*100)/100}calculateSalary(e){let t=this.calculateWorkHours(e),i=this.employee()?.hourlyRate||0,r=e.get("isDoublePay")?.value,o=t*i;return r&&(o*=2),o}onSave(){let e=this.employee()?.id;if(!e)return;let i=(this.payrollForm.value.records||[]).map(r=>({employeeId:e,date:r.date,clockIn:r.clockIn||null,clockOut:r.clockOut||null,isDoublePay:r.isDoublePay||!1}));this.dataService.updatePunchRecords(e,this.year(),this.month(),i),this.initialFormValue=JSON.stringify(this.payrollForm.value),alert("\u6253\u5361\u7D00\u9304\u5DF2\u5132\u5B58\uFF01"),this.router.navigate(["/payroll"])}goBack(){this.router.navigate(["/payroll"])}onCancel(){let e=JSON.stringify(this.payrollForm.value);this.initialFormValue===e?this.router.navigate(["/payroll"]):confirm("\u60A8\u6709\u672A\u5132\u5B58\u7684\u8B8A\u66F4\uFF0C\u78BA\u5B9A\u8981\u96E2\u958B\u55CE\uFF1F")&&this.router.navigate(["/payroll"])}clearRecord(e){confirm("\u662F\u5426\u6E05\u9664\u7576\u5929\u6253\u5361\u8CC7\u6599\uFF1F")&&this.records.at(e).patchValue({clockIn:null,clockOut:null,isDoublePay:!1})}};za.\u0275fac=function(t){return new(t||za)},za.\u0275cmp=re({type:za,selectors:[["app-payroll-detail"]],decls:47,vars:14,consts:[[1,"space-y-6","max-w-5xl","mx-auto"],[1,"flex","items-center","gap-4"],[1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","arrow-back-outline",1,"text-2xl"],[1,"text-3xl","font-bold","text-gray-900"],[1,"text-lg","text-indigo-600","font-semibold"],[1,"bg-white","p-6","rounded-xl","shadow-md"],["novalidate","",3,"ngSubmit","formGroup"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-2","py-3","w-12"],[1,"px-3","py-3"],[1,"px-3","py-3","text-center"],[1,"px-3","py-3","text-right"],["formArrayName","records"],[1,"border-b","hover:bg-gray-50",3,"formGroupName"],[1,"font-bold","bg-gray-100","text-base"],[1,"border-t-2"],["colspan","4",1,"px-3","py-3"],[1,"flex","items-center","justify-end","gap-4","pt-6","mt-6","border-t"],["type","button",1,"px-4","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],["type","submit",1,"px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-indigo-600","hover:bg-indigo-700"],[1,"px-2","py-2","text-center"],["type","button","title","\u6E05\u9664\u6B64\u884C",1,"text-red-500","hover:text-red-700","p-1","rounded-full","hover:bg-red-100","transition-colors",3,"click"],["name","close-circle-outline",1,"text-lg","align-middle"],[1,"px-3","py-2","font-medium"],[1,"px-3","py-2"],["type","time","step","1","formControlName","clockIn",1,"w-full","border-gray-200","rounded-md","shadow-sm","p-1","bg-gray-50","text-sm"],["type","time","step","1","formControlName","clockOut",1,"w-full","border-gray-200","rounded-md","shadow-sm","p-1","bg-gray-50","text-sm"],[1,"px-3","py-2","text-center","font-medium"],[1,"px-3","py-2","text-center"],["type","checkbox","formControlName","isDoublePay",1,"rounded","h-4","w-4","text-indigo-600","focus:ring-indigo-500","border-gray-300"],[1,"px-3","py-2","text-right","font-semibold"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"button",2),b("click",function(){return i.goBack()}),x(3,"ion-icon",3),s(),l(4,"div")(5,"h1",4),d(6),s(),l(7,"p",5),d(8),s()()(),l(9,"div",6)(10,"form",7),b("ngSubmit",function(){return i.onSave()}),l(11,"div",8)(12,"table",9)(13,"thead",10)(14,"tr"),x(15,"th",11),l(16,"th",12),d(17,"\u65E5\u671F"),s(),l(18,"th",12),d(19,"\u4E0A\u73ED"),s(),l(20,"th",12),d(21,"\u4E0B\u73ED"),s(),l(22,"th",13),d(23,"\u5DE5\u6642"),s(),l(24,"th",13),d(25,"\u96D9\u500D\u85AA\u8CC7"),s(),l(26,"th",14),d(27,"\u85AA\u8CC7"),s()()(),l(28,"tbody",15),O(29,TL,18,13,"tr",16,j),s(),l(31,"tfoot",17)(32,"tr",18)(33,"td",19),d(34,"\u7E3D\u8A08"),s(),l(35,"td",13),d(36),Gt(37,"number"),s(),x(38,"td",12),l(39,"td",14),d(40),Gt(41,"currency"),s()()()()(),l(42,"div",20)(43,"button",21),b("click",function(){return i.onCancel()}),d(44," \u53D6\u6D88 "),s(),l(45,"button",22),d(46," \u5132\u5B58\u8B8A\u66F4 "),s()()()()()),t&2){let r;f(6),k(" ",(r=i.employee())==null?null:r.name," - \u6253\u5361\u8A73\u7D30\u8CC7\u8A0A "),f(2),Ke("",i.year(),"\u5E74 ",i.month(),"\u6708"),f(2),I("formGroup",i.payrollForm),f(19),L(i.records.controls),f(7),E(sn(37,6,i.totalHours(),"1.2-2")),f(4),E(Kd(41,9,i.totalSalary(),"TWD","symbol","1.0-0"))}},dependencies:[oe,ke,Be,xe,mo,me,Le,Ue,Ge,wi,Ti,rl,qg],encapsulation:2,changeDetection:0});var sp=za;function IL(n,e){n&1&&(l(0,"div",13)(1,"div",14),d(2,"\u8F09\u5165\u4E2D..."),s()())}function ML(n,e){if(n&1&&(l(0,"div",15),d(1),s()),n&2){let t=_();f(),k(" ",t.error()," ")}}function AL(n,e){if(n&1){let t=B();l(0,"tr",24),b("click",function(){let r=D(t).$implicit,o=_(2);return w(o.openEditModal(r))}),l(1,"td",25),d(2),s(),l(3,"td",26)(4,"div",27)(5,"div",28),d(6),s()()(),l(7,"td",29),d(8),s(),l(9,"td",30)(10,"button",31),b("click",function(r){let o=D(t).$implicit;return _(2).openEditModal(o),w(r.stopPropagation())}),d(11," \u7DE8\u8F2F "),s()()()}if(n&2){let t=e.$implicit;f(2),E(t.id),f(4),E(t.employee_name),f(2),E(t.position||"-")}}function RL(n,e){n&1&&(l(0,"tr")(1,"td",32),d(2," \u76EE\u524D\u6C92\u6709\u54E1\u5DE5\u8CC7\u6599 "),s()())}function NL(n,e){if(n&1&&(l(0,"div",16)(1,"table",17)(2,"thead",18)(3,"tr")(4,"th",19),d(5,"ID"),s(),l(6,"th",19),d(7,"\u54E1\u5DE5\u59D3\u540D"),s(),l(8,"th",19),d(9,"\u8077\u7A31"),s(),l(10,"th",20),d(11,"\u64CD\u4F5C"),s()()(),l(12,"tbody",21),vt(13,AL,12,3,"tr",22)(14,RL,3,0,"tr",23),s()()()),n&2){let t=_();f(13),I("ngForOf",t.employees()),f(),I("ngIf",t.employees().length===0)}}function FL(n,e){if(n&1&&(l(0,"option",77),d(1),s()),n&2){let t,i=e.$implicit,r=_(2);I("ngValue",i.id)("disabled",((t=r.selectedEmployee())==null?null:t.id)===i.id),f(),Ke(" ",i.employee_name," (ID: ",i.id,") ")}}function PL(n,e){if(n&1){let t=B();l(0,"div",88)(1,"img",89),b("error",function(){D(t);let r=_(3);return w(r.onImageLoadError("front"))}),s(),l(2,"a",90),d(3," \u9810\u89BD\u5927\u5716 "),s()()}if(n&2){let t,i,r=_(3);f(),I("src",r.getImageUrl((t=r.selectedEmployee())==null?null:t.id_card_front),Ft),f(),I("href",r.getImageUrl((i=r.selectedEmployee())==null?null:i.id_card_front),Ft)}}function kL(n,e){if(n&1&&(l(0,"p",91),d(1),s()),n&2){let t,i=_(3);f(),k(" \u5DF2\u9078\u64C7: ",(t=i.selectedFrontFile())==null?null:t.name," ")}}function VL(n,e){if(n&1){let t=B();l(0,"button",92),b("click",function(){D(t);let r=_(3);return w(r.uploadFront())}),d(1),s()}if(n&2){let t=_(3);I("disabled",t.uploadingFront()),f(),k(" ",t.uploadingFront()?"\u4E0A\u50B3\u4E2D...":"\u78BA\u8A8D\u4E0A\u50B3\u6B63\u9762"," ")}}function OL(n,e){if(n&1&&(l(0,"p",93),d(1),s()),n&2){let t=_(3);f(),k("\u2713 ",t.uploadSuccessFront())}}function LL(n,e){if(n&1&&(l(0,"p",94),d(1),s()),n&2){let t=_(3);f(),E(t.uploadErrorFront())}}function BL(n,e){if(n&1){let t=B();l(0,"div",88)(1,"img",95),b("error",function(){D(t);let r=_(3);return w(r.onImageLoadError("back"))}),s(),l(2,"a",90),d(3," \u9810\u89BD\u5927\u5716 "),s()()}if(n&2){let t,i,r=_(3);f(),I("src",r.getImageUrl((t=r.selectedEmployee())==null?null:t.id_card_back),Ft),f(),I("href",r.getImageUrl((i=r.selectedEmployee())==null?null:i.id_card_back),Ft)}}function UL(n,e){if(n&1&&(l(0,"p",91),d(1),s()),n&2){let t,i=_(3);f(),k(" \u5DF2\u9078\u64C7: ",(t=i.selectedBackFile())==null?null:t.name," ")}}function $L(n,e){if(n&1){let t=B();l(0,"button",92),b("click",function(){D(t);let r=_(3);return w(r.uploadBack())}),d(1),s()}if(n&2){let t=_(3);I("disabled",t.uploadingBack()),f(),k(" ",t.uploadingBack()?"\u4E0A\u50B3\u4E2D...":"\u78BA\u8A8D\u4E0A\u50B3\u53CD\u9762"," ")}}function HL(n,e){if(n&1&&(l(0,"p",93),d(1),s()),n&2){let t=_(3);f(),k("\u2713 ",t.uploadSuccessBack())}}function GL(n,e){if(n&1&&(l(0,"p",94),d(1),s()),n&2){let t=_(3);f(),E(t.uploadErrorBack())}}function qL(n,e){if(n&1){let t=B();l(0,"div",40)(1,"h4",41)(2,"span",42),d(3,"4"),s(),d(4," \u8EAB\u4EFD\u8B49\u5716\u7247 "),s(),l(5,"div",78)(6,"div",79)(7,"label",80),d(8,"\u8EAB\u4EFD\u8B49\u6B63\u9762"),s(),vt(9,PL,4,2,"div",81),l(10,"input",82,0),b("change",function(r){D(t);let o=_(2);return w(o.onFrontFileSelected(r))}),s(),l(12,"button",83),b("click",function(){D(t);let r=wn(11);return w(r.click())}),d(13),s(),vt(14,kL,2,1,"p",84)(15,VL,2,2,"button",85)(16,OL,2,1,"p",86)(17,LL,2,1,"p",87),s(),l(18,"div",79)(19,"label",80),d(20,"\u8EAB\u4EFD\u8B49\u53CD\u9762"),s(),vt(21,BL,4,2,"div",81),l(22,"input",82,1),b("change",function(r){D(t);let o=_(2);return w(o.onBackFileSelected(r))}),s(),l(24,"button",83),b("click",function(){D(t);let r=wn(23);return w(r.click())}),d(25),s(),vt(26,UL,2,1,"p",84)(27,$L,2,2,"button",85)(28,HL,2,1,"p",86)(29,GL,2,1,"p",87),s()()()}if(n&2){let t,i,r,o,a=_(2);f(9),I("ngIf",(t=a.selectedEmployee())==null?null:t.id_card_front),f(4),k(" ",(i=a.selectedEmployee())!=null&&i.id_card_front?"\u91CD\u65B0\u4E0A\u50B3\u6B63\u9762":"\u4E0A\u50B3\u6B63\u9762"," "),f(),I("ngIf",a.selectedFrontFile()),f(),I("ngIf",a.selectedFrontFile()),f(),I("ngIf",a.uploadSuccessFront()),f(),I("ngIf",a.uploadErrorFront()),f(4),I("ngIf",(r=a.selectedEmployee())==null?null:r.id_card_back),f(4),k(" ",(o=a.selectedEmployee())!=null&&o.id_card_back?"\u91CD\u65B0\u4E0A\u50B3\u53CD\u9762":"\u4E0A\u50B3\u53CD\u9762"," "),f(),I("ngIf",a.selectedBackFile()),f(),I("ngIf",a.selectedBackFile()),f(),I("ngIf",a.uploadSuccessBack()),f(),I("ngIf",a.uploadErrorBack())}}function WL(n,e){n&1&&(l(0,"div",96),d(1," \u65B0\u589E\u5B8C\u6210\u5F8C\uFF0C\u53EF\u5728\u300C\u7DE8\u8F2F\u300D\u6A21\u5F0F\u4E0A\u50B3\u8EAB\u4EFD\u8B49\u5716\u7247\u3002 "),s())}function jL(n,e){if(n&1&&(l(0,"div",6),d(1),Gt(2,"date"),s()),n&2){let t,i=_(2);f(),k(" \u6700\u5F8C\u66F4\u65B0: ",sn(2,1,(t=i.selectedEmployee())==null?null:t.updated_at,"yyyy-MM-dd HH:mm")," ")}}function zL(n,e){if(n&1){let t=B();l(0,"div",33),b("click",function(){D(t);let r=_();return w(r.closeEditModal())}),l(1,"div",34),b("click",function(r){return D(t),w(r.stopPropagation())}),l(2,"div",35)(3,"h3",36),d(4),s(),l(5,"button",37),b("click",function(){D(t);let r=_();return w(r.closeEditModal())}),d(6," \xD7 "),s()(),l(7,"div",38)(8,"form",39)(9,"div",40)(10,"h4",41)(11,"span",42),d(12,"1"),s(),d(13," \u57FA\u672C\u8CC7\u8A0A "),s(),l(14,"div",43)(15,"div")(16,"label",44),d(17,"\u54E1\u5DE5\u7DE8\u865F"),s(),x(18,"input",45),s(),l(19,"div")(20,"label",44),d(21,"\u54E1\u5DE5\u59D3\u540D "),l(22,"span",46),d(23,"*"),s()(),x(24,"input",47),s(),l(25,"div")(26,"label",44),d(27,"\u8077\u7A31"),s(),x(28,"input",48),s(),l(29,"div")(30,"label",44),d(31,"\u8EAB\u4EFD\u8B49\u5B57\u865F"),s(),x(32,"input",49),s(),l(33,"div")(34,"label",44),d(35,"\u4EE3\u7406\u4EBA"),s(),l(36,"select",50)(37,"option",51),d(38,"\u7121\u4EE3\u7406\u4EBA"),s(),vt(39,FL,2,4,"option",52),s()()()(),l(40,"div",40)(41,"h4",41)(42,"span",42),d(43,"2"),s(),d(44," \u806F\u7D61\u65B9\u5F0F "),s(),l(45,"div",43)(46,"div")(47,"label",44),d(48,"\u806F\u7D61\u96FB\u8A71"),s(),x(49,"input",53),s(),l(50,"div")(51,"label",44),d(52,"Email"),s(),x(53,"input",54),s(),l(54,"div",55)(55,"label",44),d(56,"\u6236\u7C4D\u5730\u5740"),s(),x(57,"input",56),s(),l(58,"div",55)(59,"label",44),d(60,"\u901A\u8A0A\u5730\u5740"),s(),x(61,"input",57),s()()(),l(62,"div",40)(63,"h4",41)(64,"span",42),d(65,"3"),s(),d(66," \u9280\u884C\u8CC7\u8A0A "),s(),l(67,"div",43)(68,"div")(69,"label",44),d(70,"\u4ED8\u6B3E\u65B9\u5F0F"),s(),l(71,"select",58)(72,"option",59),d(73,"\u8ACB\u9078\u64C7"),s(),l(74,"option",60),d(75,"\u73FE\u91D1"),s(),l(76,"option",61),d(77,"\u8F49\u5E33"),s(),l(78,"option",62),d(79,"\u652F\u7968"),s()()(),l(80,"div")(81,"label",44),d(82,"\u9280\u884C"),s(),x(83,"input",63),s(),l(84,"div")(85,"label",44),d(86,"\u5206\u884C"),s(),x(87,"input",64),s(),l(88,"div")(89,"label",44),d(90,"\u9280\u884C\u5E33\u865F"),s(),x(91,"input",65),s(),l(92,"div")(93,"label",44),d(94,"\u6236\u540D"),s(),x(95,"input",66),s()()(),vt(96,qL,30,12,"div",67)(97,WL,2,0,"div",68),l(98,"div",40)(99,"h4",41)(100,"span",42),d(101,"5"),s(),d(102," \u5176\u4ED6\u8CC7\u8A0A "),s(),l(103,"div",69)(104,"div")(105,"label",44),d(106,"\u8077\u52D9\u5167\u5BB9"),s(),x(107,"textarea",70),s(),l(108,"div")(109,"label",44),d(110,"\u5099\u8A3B"),s(),x(111,"textarea",71),s()()()()(),l(112,"div",72),vt(113,jL,3,4,"div",73),l(114,"div",74)(115,"button",75),b("click",function(){D(t);let r=_();return w(r.closeEditModal())}),d(116," \u53D6\u6D88 "),s(),l(117,"button",76),b("click",function(){D(t);let r=_();return w(r.submitEmployee())}),d(118),s()()()()()}if(n&2){let t,i=_();f(4),k(" ",i.isCreateMode()?"\u65B0\u589E\u54E1\u5DE5\u8CC7\u6599":"\u7DE8\u8F2F\u54E1\u5DE5\u8CC7\u6599 - "+((t=i.selectedEmployee())==null?null:t.employee_name)," "),f(4),I("formGroup",i.employeeForm),f(10),W("bg-gray-100",!i.isCreateMode())("text-gray-600",!i.isCreateMode())("cursor-not-allowed",!i.isCreateMode()),I("disabled",!i.isCreateMode()),f(6),W("bg-gray-100",!i.isCreateMode())("text-gray-600",!i.isCreateMode())("cursor-not-allowed",!i.isCreateMode()),I("disabled",!i.isCreateMode()),f(13),I("ngValue",null),f(2),I("ngForOf",i.employees()),f(57),I("ngIf",!i.isCreateMode()),f(),I("ngIf",i.isCreateMode()),f(16),I("ngIf",!i.isCreateMode()),f(4),I("disabled",i.saving()||!i.employeeForm.valid),f(),k(" ",i.saving()?"\u8655\u7406\u4E2D...":i.isCreateMode()?"\u65B0\u589E":"\u5132\u5B58"," ")}}function YL(n,e){n&1&&(l(0,"div",97),d(1," \u2713 \u5132\u5B58\u6210\u529F\uFF01 "),s())}var Ya=class Ya{constructor(){this.apiService=P(Xe);this.fb=P(je);this.employees=S([]);this.loading=S(!1);this.error=S("");this.editModalOpen=S(!1);this.selectedEmployee=S(null);this.isCreateMode=S(!1);this.saving=S(!1);this.saveSuccess=S(!1);this.selectedFrontFile=S(null);this.selectedBackFile=S(null);this.uploadingFront=S(!1);this.uploadingBack=S(!1);this.uploadErrorFront=S("");this.uploadErrorBack=S("");this.uploadSuccessFront=S("");this.uploadSuccessBack=S("");this.employeeForm=this.fb.group({employee_number:["",U.required],employee_name:["",U.required],position:[""],id_number:[""],phone:[""],email:["",U.email],registered_address:[""],mailing_address:[""],job_description:[""],payment_method:[""],bank:[""],branch:[""],account_number:[""],account_holder:[""],notes:[""],agent_id:[null]})}ngOnInit(){this.loadEmployees()}async loadEmployees(){this.loading.set(!0),this.error.set("");try{let e=await this.apiService.getEmployeeInfo();e.success&&e.data?this.employees.set(e.data):this.error.set("\u8F09\u5165\u54E1\u5DE5\u8CC7\u6599\u5931\u6557")}catch(e){console.error("Error loading employees:",e),this.error.set("\u7121\u6CD5\u8F09\u5165\u54E1\u5DE5\u8CC7\u6599\uFF0C\u8ACB\u6AA2\u67E5\u7DB2\u8DEF\u9023\u7DDA")}finally{this.loading.set(!1)}}openEditModal(e){this.selectedEmployee.set(e),this.employeeForm.patchValue(e),this.editModalOpen.set(!0),this.isCreateMode.set(!1),this.employeeForm.get("employee_number")?.disable(),this.employeeForm.get("employee_name")?.disable(),this.selectedFrontFile.set(null),this.selectedBackFile.set(null),this.uploadErrorFront.set(""),this.uploadErrorBack.set(""),this.uploadSuccessFront.set(""),this.uploadSuccessBack.set("")}closeEditModal(){this.editModalOpen.set(!1),this.selectedEmployee.set(null),this.isCreateMode.set(!1),this.employeeForm.reset()}openCreateModal(){this.isCreateMode.set(!0),this.selectedEmployee.set(null),this.employeeForm.reset({employee_number:"",employee_name:"",position:"",id_number:"",phone:"",email:"",registered_address:"",mailing_address:"",job_description:"",payment_method:"",bank:"",branch:"",account_number:"",account_holder:"",notes:"",agent_id:null}),this.employeeForm.get("employee_number")?.enable(),this.employeeForm.get("employee_name")?.enable(),this.editModalOpen.set(!0),this.selectedFrontFile.set(null),this.selectedBackFile.set(null),this.uploadErrorFront.set(""),this.uploadErrorBack.set(""),this.uploadSuccessFront.set(""),this.uploadSuccessBack.set("")}submitEmployee(){this.isCreateMode()?this.createEmployee():this.saveEmployee()}async createEmployee(){if(this.employeeForm.valid){this.saving.set(!0),this.error.set("");try{let e=this.employeeForm.getRawValue(),t=await this.apiService.createEmployeeInfo(e);t.success?(this.saveSuccess.set(!0),setTimeout(()=>this.saveSuccess.set(!1),3e3),this.closeEditModal(),await this.loadEmployees()):this.error.set(t.error||"\u65B0\u589E\u5931\u6557\uFF0C\u8ACB\u91CD\u8A66")}catch(e){console.error("Error creating employee:",e),this.error.set(e?.error?.error||"\u65B0\u589E\u5931\u6557\uFF0C\u8ACB\u91CD\u8A66")}finally{this.saving.set(!1)}}}async saveEmployee(){if(!(!this.employeeForm.valid||!this.selectedEmployee())){this.saving.set(!0);try{let e=this.employeeForm.value,t=this.selectedEmployee();if((await this.apiService.updateEmployeeInfo(t.employee_number,e)).success){let r=this.employees().map(o=>o.id===t.id?G(V(V({},o),e),{updated_at:new Date().toISOString()}):o);this.employees.set(r),this.saveSuccess.set(!0),setTimeout(()=>this.saveSuccess.set(!1),3e3),this.closeEditModal(),await this.loadEmployees()}}catch(e){console.error("Error saving employee:",e),this.error.set("\u5132\u5B58\u5931\u6557\uFF0C\u8ACB\u91CD\u8A66")}finally{this.saving.set(!1)}}}onFrontFileSelected(e){let t=e.target;t.files?.length&&(this.selectedFrontFile.set(t.files[0]),this.uploadErrorFront.set(""),this.uploadSuccessFront.set(""))}onBackFileSelected(e){let t=e.target;t.files?.length&&(this.selectedBackFile.set(t.files[0]),this.uploadErrorBack.set(""),this.uploadSuccessBack.set(""))}onImageLoadError(e){console.error(`Failed to load ID card ${e} image`)}async uploadFront(){let e=this.selectedFrontFile(),t=this.selectedEmployee();if(!(!e||!t)){this.uploadingFront.set(!0),this.uploadErrorFront.set("");try{let i=await this.apiService.uploadIdCardImage(e,t.employee_number,"front");if(i.success){await this.apiService.updateEmployeeIdCardPath(Number(t.employee_number),"front",i.filepath);let r=await this.apiService.getEmployeeInfo();if(r.success&&r.data){this.employees.set(r.data);let o=r.data.find(a=>a.id===t.id);o&&this.selectedEmployee.set(o)}this.uploadSuccessFront.set("\u6B63\u9762\u5716\u7247\u4E0A\u50B3\u6210\u529F\uFF01"),this.selectedFrontFile.set(null),setTimeout(()=>this.uploadSuccessFront.set(""),3e3)}}catch(i){this.uploadErrorFront.set(i?.error?.error||"\u4E0A\u50B3\u5931\u6557\uFF0C\u8ACB\u91CD\u8A66"),console.error("Upload error:",i)}finally{this.uploadingFront.set(!1)}}}async uploadBack(){let e=this.selectedBackFile(),t=this.selectedEmployee();if(!(!e||!t)){this.uploadingBack.set(!0),this.uploadErrorBack.set("");try{let i=await this.apiService.uploadIdCardImage(e,t.employee_number,"back");if(i.success){await this.apiService.updateEmployeeIdCardPath(Number(t.employee_number),"back",i.filepath);let r=await this.apiService.getEmployeeInfo();if(r.success&&r.data){this.employees.set(r.data);let o=r.data.find(a=>a.id===t.id);o&&this.selectedEmployee.set(o)}this.uploadSuccessBack.set("\u53CD\u9762\u5716\u7247\u4E0A\u50B3\u6210\u529F\uFF01"),this.selectedBackFile.set(null),setTimeout(()=>this.uploadSuccessBack.set(""),3e3)}}catch(i){this.uploadErrorBack.set(i?.error?.error||"\u4E0A\u50B3\u5931\u6557\uFF0C\u8ACB\u91CD\u8A66"),console.error("Upload error:",i)}finally{this.uploadingBack.set(!1)}}}getImageUrl(e){return e?e.startsWith("http://")||e.startsWith("https://")?e:e.startsWith("/")?"http://localhost:3000"+e:e:null}};Ya.\u0275fac=function(t){return new(t||Ya)},Ya.\u0275cmp=re({type:Ya,selectors:[["app-company-profile"]],decls:14,vars:6,consts:[["frontFileInput",""],["backFileInput",""],[1,"p-6","space-y-6"],[1,"flex","justify-between","items-center"],[1,"text-2xl","font-bold","text-gray-800"],[1,"flex","items-center","gap-3"],[1,"text-sm","text-gray-500"],["type","button",1,"px-4","py-2","bg-green-500","text-white","text-sm","rounded-lg","hover:bg-green-600","transition-colors",3,"click"],["class","flex justify-center items-center py-12",4,"ngIf"],["class","bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",4,"ngIf"],["class","bg-white rounded-lg shadow overflow-hidden",4,"ngIf"],["class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",3,"click",4,"ngIf"],["class","fixed bottom-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-fade-in",4,"ngIf"],[1,"flex","justify-center","items-center","py-12"],[1,"text-gray-500"],[1,"bg-red-50","border","border-red-200","text-red-700","px-4","py-3","rounded"],[1,"bg-white","rounded-lg","shadow","overflow-hidden"],[1,"w-full"],[1,"bg-gray-50","border-b-2","border-gray-200"],[1,"px-6","py-4","text-left","text-sm","font-semibold","text-gray-700"],[1,"px-6","py-4","text-center","text-sm","font-semibold","text-gray-700"],[1,"divide-y","divide-gray-200"],["class","hover:bg-gray-50 transition-colors cursor-pointer",3,"click",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"hover:bg-gray-50","transition-colors","cursor-pointer",3,"click"],[1,"px-6","py-4","text-sm","text-gray-900"],[1,"px-6","py-4"],[1,"flex","items-center"],[1,"text-sm","font-medium","text-gray-900"],[1,"px-6","py-4","text-sm","text-gray-600"],[1,"px-6","py-4","text-center"],[1,"px-3","py-1","bg-blue-500","text-white","text-sm","rounded","hover:bg-blue-600","transition-colors",3,"click"],["colspan","4",1,"px-6","py-12","text-center","text-gray-500"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50","p-4",3,"click"],[1,"bg-white","rounded-lg","shadow-2xl","max-w-4xl","w-full","max-h-[90vh]","overflow-hidden","flex","flex-col",3,"click"],[1,"bg-gradient-to-r","from-blue-500","to-blue-600","px-6","py-4","flex","justify-between","items-center","text-white"],[1,"text-xl","font-bold"],[1,"text-white","hover:text-gray-200","text-3xl","leading-none",3,"click"],[1,"flex-1","overflow-y-auto","p-6"],[1,"space-y-6",3,"formGroup"],[1,"bg-gray-50","p-4","rounded-lg"],[1,"text-lg","font-semibold","text-gray-800","mb-4","flex","items-center"],[1,"bg-blue-500","text-white","rounded-full","w-8","h-8","flex","items-center","justify-center","mr-2","text-sm"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","formControlName","employee_number","placeholder","\u8ACB\u8F38\u5165\u54E1\u5DE5\u7DE8\u865F",1,"w-full","px-3","py-2","border","border-gray-300","rounded",3,"disabled"],[1,"text-red-500"],["type","text","formControlName","employee_name","placeholder","\u8ACB\u8F38\u5165\u54E1\u5DE5\u59D3\u540D",1,"w-full","px-3","py-2","border","border-gray-300","rounded",3,"disabled"],["type","text","formControlName","position","placeholder","\u8ACB\u8F38\u5165\u8077\u7A31",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["type","text","formControlName","id_number","placeholder","\u8ACB\u8F38\u5165\u8EAB\u4EFD\u8B49\u5B57\u865F",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["formControlName","agent_id",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],[3,"ngValue"],[3,"ngValue","disabled",4,"ngFor","ngForOf"],["type","tel","formControlName","phone","placeholder","\u8ACB\u8F38\u5165\u806F\u7D61\u96FB\u8A71",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["type","email","formControlName","email","placeholder","\u8ACB\u8F38\u5165 Email",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],[1,"md:col-span-2"],["type","text","formControlName","registered_address","placeholder","\u8ACB\u8F38\u5165\u6236\u7C4D\u5730\u5740",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["type","text","formControlName","mailing_address","placeholder","\u8ACB\u8F38\u5165\u901A\u8A0A\u5730\u5740\uFF08\u540C\u6236\u7C4D\u5730\u5740\u53EF\u7559\u7A7A\uFF09",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["formControlName","payment_method",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["value",""],["value","\u73FE\u91D1"],["value","\u8F49\u5E33"],["value","\u652F\u7968"],["type","text","formControlName","bank","placeholder","\u8ACB\u8F38\u5165\u9280\u884C\u540D\u7A31",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["type","text","formControlName","branch","placeholder","\u8ACB\u8F38\u5165\u5206\u884C\u540D\u7A31",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["type","text","formControlName","account_number","placeholder","\u8ACB\u8F38\u5165\u9280\u884C\u5E33\u865F",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["type","text","formControlName","account_holder","placeholder","\u8ACB\u8F38\u5165\u6236\u540D",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["class","bg-gray-50 p-4 rounded-lg",4,"ngIf"],["class","bg-blue-50 border border-blue-100 p-4 rounded-lg text-sm text-blue-700",4,"ngIf"],[1,"space-y-4"],["formControlName","job_description","rows","3","placeholder","\u8ACB\u8F38\u5165\u8077\u52D9\u5167\u5BB9\u63CF\u8FF0",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["formControlName","notes","rows","3","placeholder","\u8ACB\u8F38\u5165\u5099\u8A3B",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],[1,"bg-gray-50","border-t","border-gray-200","px-6","py-4","flex","justify-between","items-center"],["class","text-sm text-gray-500",4,"ngIf"],[1,"flex","gap-3"],["type","button",1,"px-6","py-2","border","border-gray-300","rounded-lg","hover:bg-gray-50","transition-colors",3,"click"],["type","button",1,"px-6","py-2","bg-blue-500","text-white","rounded-lg","hover:bg-blue-600","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors",3,"click","disabled"],[3,"ngValue","disabled"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"space-y-3"],[1,"block","text-sm","font-medium","text-gray-700"],["class","mb-3",4,"ngIf"],["type","file","accept","image/jpeg,image/png",1,"hidden",3,"change"],["type","button",1,"w-full","px-4","py-2","border-2","border-dashed","border-blue-300","text-blue-600","rounded","hover:bg-blue-50","transition-colors",3,"click"],["class","text-sm text-gray-600",4,"ngIf"],["type","button","class","w-full px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 disabled:opacity-50",3,"disabled","click",4,"ngIf"],["class","text-sm text-green-600",4,"ngIf"],["class","text-sm text-red-600",4,"ngIf"],[1,"mb-3"],["alt","\u8EAB\u4EFD\u8B49\u6B63\u9762",1,"w-full","h-48","object-contain","border-2","border-gray-200","rounded","bg-gray-100",3,"error","src"],["target","_blank",1,"text-xs","text-blue-500","hover:underline","mt-1","inline-block",3,"href"],[1,"text-sm","text-gray-600"],["type","button",1,"w-full","px-4","py-2","bg-green-500","text-white","rounded","hover:bg-green-600","disabled:opacity-50",3,"click","disabled"],[1,"text-sm","text-green-600"],[1,"text-sm","text-red-600"],["alt","\u8EAB\u4EFD\u8B49\u53CD\u9762",1,"w-full","h-48","object-contain","border-2","border-gray-200","rounded","bg-gray-100",3,"error","src"],[1,"bg-blue-50","border","border-blue-100","p-4","rounded-lg","text-sm","text-blue-700"],[1,"fixed","bottom-4","right-4","bg-green-500","text-white","px-6","py-3","rounded-lg","shadow-lg","z-50","animate-fade-in"]],template:function(t,i){t&1&&(l(0,"div",2)(1,"div",3)(2,"h2",4),d(3,"\u516C\u53F8\u500B\u4EBA\u8CC7\u6599"),s(),l(4,"div",5)(5,"div",6),d(6),s(),l(7,"button",7),b("click",function(){return i.openCreateModal()}),d(8," \u65B0\u589E\u54E1\u5DE5 "),s()()(),vt(9,IL,3,0,"div",8)(10,ML,2,1,"div",9)(11,NL,15,2,"div",10)(12,zL,119,23,"div",11)(13,YL,2,0,"div",12),s()),t&2&&(f(6),k(" \u5171 ",i.employees().length," \u4F4D\u54E1\u5DE5 "),f(3),I("ngIf",i.loading()),f(),I("ngIf",i.error()),f(),I("ngIf",!i.loading()),f(),I("ngIf",i.editModalOpen()),f(),I("ngIf",i.saveSuccess()))},dependencies:[oe,na,ji,Se,Be,Fe,Pe,xe,Re,me,Le,ke,Ue,Ge,eo],styles:["@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.animate-fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}"],changeDetection:0});var lp=Ya;var eu=(n,e)=>e.id;function JL(n,e){if(n&1&&(l(0,"option",16),d(1),s()),n&2){let t=e.$implicit;I("value",t.id),f(),E(t.name)}}function KL(n,e){if(n&1&&(l(0,"option",16),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),E(t)}}function QL(n,e){if(n&1){let t=B();l(0,"tr",27)(1,"td",29),d(2),s(),l(3,"td",30),d(4),s(),l(5,"td",29),d(6),s(),l(7,"td",29),d(8),s(),l(9,"td",31),d(10),s(),l(11,"td",29),d(12),s(),l(13,"td",29),d(14),s(),l(15,"td",31),d(16),s(),l(17,"td",32),d(18),s(),l(19,"td",33),d(20),s(),l(21,"td",29)(22,"div",34)(23,"button",35),b("click",function(){let r=D(t).$implicit,o=_(2);return w(o.openModal(r))}),x(24,"ion-icon",36),s(),l(25,"button",37),b("click",function(){let r=D(t).$implicit,o=_(2);return w(o.deleteItem(r.id))}),x(26,"ion-icon",38),s()()()()}if(n&2){let t=e.$implicit,i=_(2);f(2),E(t.productId),f(2),E(t.productName),f(2),E(i.getVendorName(t.vendorId)),f(2),E(t.category),f(2),E(t.itemQuantity),f(2),E(t.itemUnit),f(2),E(t.totalUnit),f(2),E(i.formatCurrency(t.price)),f(2),E(i.formatCurrency(i.calculateItemCost(t.price,t.itemQuantity))),f(2),E(t.notes)}}function ZL(n,e){n&1&&(l(0,"tr")(1,"td",39),d(2,"\u7121\u7B26\u5408\u689D\u4EF6\u7684\u5546\u54C1\u6210\u672C\u8CC7\u6599\u3002"),s()())}function XL(n,e){if(n&1){let t=B();l(0,"div",28)(1,"span",40),d(2),s(),l(3,"div",34)(4,"button",41),b("click",function(){D(t);let r=_(2);return w(r.goToPage(r.groceriesCurrentPage()-1,"groceries"))}),x(5,"ion-icon",42),s(),l(6,"span",43),d(7),s(),l(8,"button",41),b("click",function(){D(t);let r=_(2);return w(r.goToPage(r.groceriesCurrentPage()+1,"groceries"))}),x(9,"ion-icon",44),s()()()}if(n&2){let t=_(2);f(2),Kt("\u986F\u793A\u7B2C ",(t.groceriesCurrentPage()-1)*t.groceriesPageSize+1," \u81F3 ",t.Math.min(t.groceriesCurrentPage()*t.groceriesPageSize,t.filteredGroceries().length)," \u7B46\uFF0C\u5171 ",t.filteredGroceries().length," \u7B46"),f(2),I("disabled",t.groceriesCurrentPage()===1),f(3),Ke("\u7B2C ",t.groceriesCurrentPage()," \u9801 / \u5171 ",t.groceriesTotalPages()," \u9801"),f(),I("disabled",t.groceriesCurrentPage()===t.groceriesTotalPages())}}function eB(n,e){if(n&1){let t=B();l(0,"div",11)(1,"div",12)(2,"input",13),b("ngModelChange",function(r){D(t);let o=_();return o.groceriesSearchTerm.set(r),w(o.applyFilters("groceries"))}),s()(),l(3,"div")(4,"select",14),b("ngModelChange",function(r){D(t);let o=_();return o.groceriesSelectedVendor.set(r),w(o.applyFilters("groceries"))}),l(5,"option",15),d(6,"\u6240\u6709\u4F9B\u61C9\u5546"),s(),O(7,JL,2,2,"option",16,eu),s()(),l(9,"div")(10,"select",14),b("ngModelChange",function(r){D(t);let o=_();return o.groceriesSelectedCategory.set(r),w(o.applyFilters("groceries"))}),l(11,"option",15),d(12,"\u6240\u6709\u54C1\u9805"),s(),O(13,KL,2,2,"option",16,j),s()(),l(15,"div",17)(16,"button",18),b("click",function(){D(t);let r=_();return w(r.resetFilters("groceries"))}),x(17,"ion-icon",19),s()()(),l(18,"div",20)(19,"table",21)(20,"thead",22)(21,"tr")(22,"th",23),b("click",function(){D(t);let r=_();return w(r.sortData("productId"))}),d(23,"\u5546\u54C1\u7DE8\u865F"),s(),l(24,"th",23),b("click",function(){D(t);let r=_();return w(r.sortData("productName"))}),d(25,"\u5546\u54C1\u540D\u7A31"),s(),l(26,"th",23),b("click",function(){D(t);let r=_();return w(r.sortData("vendorId"))}),d(27,"\u4F9B\u61C9\u5546"),s(),l(28,"th",23),b("click",function(){D(t);let r=_();return w(r.sortData("category"))}),d(29,"\u54C1\u9805"),s(),l(30,"th",24),b("click",function(){D(t);let r=_();return w(r.sortData("itemQuantity"))}),d(31,"\u7D30\u9805\u6578\u91CF"),s(),l(32,"th",23),b("click",function(){D(t);let r=_();return w(r.sortData("itemUnit"))}),d(33,"\u7D30\u9805\u55AE\u4F4D"),s(),l(34,"th",23),b("click",function(){D(t);let r=_();return w(r.sortData("totalUnit"))}),d(35,"\u7E3D\u55AE\u4F4D"),s(),l(36,"th",24),b("click",function(){D(t);let r=_();return w(r.sortData("price"))}),d(37,"\u50F9\u683C(\u5143)"),s(),l(38,"th",25),d(39,"\u7D30\u9805\u55AE\u4F4D\u6210\u672C"),s(),l(40,"th",26),d(41,"\u5099\u8A3B"),s(),l(42,"th",26),d(43,"\u64CD\u4F5C"),s()()(),l(44,"tbody"),O(45,QL,27,10,"tr",27,eu,!1,ZL,3,0,"tr"),s()()(),M(48,XL,10,7,"div",28)}if(n&2){let t=_();f(2),I("ngModel",t.groceriesSearchTerm()),f(2),I("ngModel",t.groceriesSelectedVendor()),f(3),L(t.allVendors()),f(3),I("ngModel",t.groceriesSelectedCategory()),f(3),L(t.groceriesProductCategories()),f(32),L(t.paginatedGroceries()),f(3),A(t.groceriesTotalPages()>1?48:-1)}}function tB(n,e){if(n&1&&(l(0,"option",16),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),E(t)}}function nB(n,e){if(n&1&&(l(0,"option",16),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),E(t)}}function iB(n,e){if(n&1){let t=B();l(0,"tr",27)(1,"td",29),d(2),s(),l(3,"td",30),d(4),s(),l(5,"td",29),d(6),s(),l(7,"td",31),d(8),s(),l(9,"td",31),d(10),s(),l(11,"td",32),d(12),s(),l(13,"td",29)(14,"div",34)(15,"button",35),b("click",function(){let r=D(t).$implicit,o=_(2);return w(o.openModal(r))}),x(16,"ion-icon",36),s(),l(17,"button",37),b("click",function(){let r=D(t).$implicit,o=_(2);return w(o.deleteItem(r.id))}),x(18,"ion-icon",38),s()()()()}if(n&2){let t=e.$implicit,i=_(2);f(2),E(t.vendor),f(2),E(t.productName),f(2),E(t.type),f(2),E(i.formatCurrency(t.cost)),f(2),E(i.formatCurrency(t.sellingPrice)),f(2),k("",i.calculateMargin(t.cost,t.sellingPrice).toFixed(2),"%")}}function rB(n,e){n&1&&(l(0,"tr")(1,"td",46),d(2,"\u7121\u8CC7\u6599\u3002"),s()())}function oB(n,e){if(n&1){let t=B();l(0,"div",28)(1,"span",40),d(2),s(),l(3,"div",34)(4,"button",41),b("click",function(){D(t);let r=_(2);return w(r.goToPage(r.wineCurrentPage()-1,"wines"))}),x(5,"ion-icon",42),s(),l(6,"span",43),d(7),s(),l(8,"button",41),b("click",function(){D(t);let r=_(2);return w(r.goToPage(r.wineCurrentPage()+1,"wines"))}),x(9,"ion-icon",44),s()()()}if(n&2){let t=_(2);f(2),Kt("\u986F\u793A\u7B2C ",(t.wineCurrentPage()-1)*t.winePageSize+1," \u81F3 ",t.Math.min(t.wineCurrentPage()*t.winePageSize,t.filteredWines().length)," \u7B46\uFF0C\u5171 ",t.filteredWines().length," \u7B46"),f(2),I("disabled",t.wineCurrentPage()===1),f(3),Ke("\u7B2C ",t.wineCurrentPage()," \u9801 / \u5171 ",t.wineTotalPages()," \u9801"),f(),I("disabled",t.wineCurrentPage()===t.wineTotalPages())}}function aB(n,e){if(n&1){let t=B();l(0,"div",11)(1,"div",12)(2,"input",45),b("ngModelChange",function(r){D(t);let o=_();return o.wineSearchTerm.set(r),w(o.applyFilters("wines"))}),s()(),l(3,"div")(4,"select",14),b("ngModelChange",function(r){D(t);let o=_();return o.wineSelectedVendor.set(r),w(o.applyFilters("wines"))}),l(5,"option",15),d(6,"\u6240\u6709\u5EE0\u5546"),s(),O(7,tB,2,2,"option",16,j),s()(),l(9,"div")(10,"select",14),b("ngModelChange",function(r){D(t);let o=_();return o.wineSelectedType.set(r),w(o.applyFilters("wines"))}),l(11,"option",15),d(12,"\u6240\u6709\u985E\u578B"),s(),O(13,nB,2,2,"option",16,j),s()(),l(15,"div",17)(16,"button",18),b("click",function(){D(t);let r=_();return w(r.resetFilters("wines"))}),x(17,"ion-icon",19),s()()(),l(18,"div",20)(19,"table",21)(20,"thead",22)(21,"tr")(22,"th",23),b("click",function(){D(t);let r=_();return w(r.sortData("vendor"))}),d(23,"\u5EE0\u5546"),s(),l(24,"th",23),b("click",function(){D(t);let r=_();return w(r.sortData("productName"))}),d(25,"\u5546\u54C1"),s(),l(26,"th",23),b("click",function(){D(t);let r=_();return w(r.sortData("type"))}),d(27,"\u985E\u578B"),s(),l(28,"th",24),b("click",function(){D(t);let r=_();return w(r.sortData("cost"))}),d(29,"\u9032\u8CA8\u6210\u672C"),s(),l(30,"th",24),b("click",function(){D(t);let r=_();return w(r.sortData("sellingPrice"))}),d(31,"\u552E\u50F9"),s(),l(32,"th",25),d(33,"\u6BDB\u5229\u7387"),s(),l(34,"th",26),d(35,"\u64CD\u4F5C"),s()()(),l(36,"tbody"),O(37,iB,19,6,"tr",27,eu,!1,rB,3,0,"tr"),s()()(),M(40,oB,10,7,"div",28)}if(n&2){let t=_();f(2),I("ngModel",t.wineSearchTerm()),f(2),I("ngModel",t.wineSelectedVendor()),f(3),L(t.wineVendors()),f(3),I("ngModel",t.wineSelectedType()),f(3),L(t.wineTypes()),f(24),L(t.paginatedWines()),f(3),A(t.wineTotalPages()>1?40:-1)}}function sB(n,e){if(n&1&&(l(0,"option",16),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),E(t)}}function lB(n,e){if(n&1){let t=B();l(0,"tr",27)(1,"td",30),d(2),s(),l(3,"td",29),d(4),s(),l(5,"td",29),d(6),s(),l(7,"td",31),d(8),s(),l(9,"td",31),d(10),s(),l(11,"td",31),d(12),s(),l(13,"td",31),d(14),s(),l(15,"td",32),d(16),s(),l(17,"td",29)(18,"div",34)(19,"button",35),b("click",function(){let r=D(t).$implicit,o=_(2);return w(o.openModal(r))}),x(20,"ion-icon",36),s(),l(21,"button",37),b("click",function(){let r=D(t).$implicit,o=_(2);return w(o.deleteItem(r.id))}),x(22,"ion-icon",38),s()()()()}if(n&2){let t=e.$implicit,i=_(2);f(2),E(t.brand),f(2),E(t.productName),f(2),E(t.size),f(2),E(t.quantityPerBox),f(2),E(i.formatCurrency(t.lishengCost)),f(2),E(i.formatCurrency(t.baijiaCost)),f(2),E(i.formatCurrency(t.sellingPrice)),f(2),k("",i.calculateMargin(t.baijiaCost,t.sellingPrice).toFixed(2),"%")}}function uB(n,e){n&1&&(l(0,"tr")(1,"td",50),d(2,"\u7121\u8CC7\u6599\u3002"),s()())}function dB(n,e){if(n&1){let t=B();l(0,"div",28)(1,"span",40),d(2),s(),l(3,"div",34)(4,"button",41),b("click",function(){D(t);let r=_(2);return w(r.goToPage(r.cigarCurrentPage()-1,"cigars"))}),x(5,"ion-icon",42),s(),l(6,"span",43),d(7),s(),l(8,"button",41),b("click",function(){D(t);let r=_(2);return w(r.goToPage(r.cigarCurrentPage()+1,"cigars"))}),x(9,"ion-icon",44),s()()()}if(n&2){let t=_(2);f(2),Kt("\u986F\u793A\u7B2C ",(t.cigarCurrentPage()-1)*t.cigarPageSize+1," \u81F3 ",t.Math.min(t.cigarCurrentPage()*t.cigarPageSize,t.filteredCigars().length)," \u7B46\uFF0C\u5171 ",t.filteredCigars().length," \u7B46"),f(2),I("disabled",t.cigarCurrentPage()===1),f(3),Ke("\u7B2C ",t.cigarCurrentPage()," \u9801 / \u5171 ",t.cigarTotalPages()," \u9801"),f(),I("disabled",t.cigarCurrentPage()===t.cigarTotalPages())}}function cB(n,e){if(n&1){let t=B();l(0,"div",47)(1,"div",12)(2,"input",48),b("ngModelChange",function(r){D(t);let o=_();return o.cigarSearchTerm.set(r),w(o.applyFilters("cigars"))}),s()(),l(3,"div")(4,"select",14),b("ngModelChange",function(r){D(t);let o=_();return o.cigarSelectedBrand.set(r),w(o.applyFilters("cigars"))}),l(5,"option",15),d(6,"\u6240\u6709\u54C1\u724C"),s(),O(7,sB,2,2,"option",16,j),s()(),l(9,"div",49)(10,"button",18),b("click",function(){D(t);let r=_();return w(r.resetFilters("cigars"))}),x(11,"ion-icon",19),s()()(),l(12,"div",20)(13,"table",21)(14,"thead",22)(15,"tr")(16,"th",23),b("click",function(){D(t);let r=_();return w(r.sortData("brand"))}),d(17,"\u54C1\u724C"),s(),l(18,"th",23),b("click",function(){D(t);let r=_();return w(r.sortData("productName"))}),d(19,"\u5546\u54C1\u540D\u7A31"),s(),l(20,"th",23),b("click",function(){D(t);let r=_();return w(r.sortData("size"))}),d(21,"\u5C3A\u5BF8"),s(),l(22,"th",24),b("click",function(){D(t);let r=_();return w(r.sortData("quantityPerBox"))}),d(23,"\u6BCF\u76D2\u6578\u91CF"),s(),l(24,"th",24),b("click",function(){D(t);let r=_();return w(r.sortData("lishengCost"))}),d(25,"\u7406\u665F\u6210\u672C(\u652F)"),s(),l(26,"th",24),b("click",function(){D(t);let r=_();return w(r.sortData("baijiaCost"))}),d(27,"\u767E\u6CC7\u6210\u672C(\u652F)"),s(),l(28,"th",24),b("click",function(){D(t);let r=_();return w(r.sortData("sellingPrice"))}),d(29,"\u8CE3\u50F9"),s(),l(30,"th",25),d(31,"\u6BDB\u5229\u7387"),s(),l(32,"th",26),d(33,"\u64CD\u4F5C"),s()()(),l(34,"tbody"),O(35,lB,23,8,"tr",27,eu,!1,uB,3,0,"tr"),s()()(),M(38,dB,10,7,"div",28)}if(n&2){let t=_();f(2),I("ngModel",t.cigarSearchTerm()),f(2),I("ngModel",t.cigarSelectedBrand()),f(3),L(t.cigarBrands()),f(28),L(t.paginatedCigars()),f(3),A(t.cigarTotalPages()>1?38:-1)}}function mB(n,e){if(n&1&&d(0),n&2){let t=_(2);k(" ",t.editingProductCost()?"\u7DE8\u8F2F\u5546\u54C1\u6210\u672C":"\u65B0\u589E\u5546\u54C1\u6210\u672C"," ")}}function pB(n,e){if(n&1&&d(0),n&2){let t=_(2);k(" ",t.editingWineCost()?"\u7DE8\u8F2F\u9152\u985E\u6210\u672C":"\u65B0\u589E\u9152\u985E\u6210\u672C"," ")}}function fB(n,e){if(n&1&&d(0),n&2){let t=_(2);k(" ",t.editingCigarCost()?"\u7DE8\u8F2F\u96EA\u8304\u6210\u672C":"\u65B0\u589E\u96EA\u8304\u6210\u672C"," ")}}function gB(n,e){if(n&1&&x(0,"option",16),n&2){let t=e.$implicit;I("value",t)}}function hB(n,e){if(n&1&&(l(0,"option",16),d(1),s()),n&2){let t=e.$implicit;I("value",t.id),f(),E(t.name)}}function yB(n,e){if(n&1&&(l(0,"div",58)(1,"div",62)(2,"label",63)(3,"span",64),d(4,"\u5546\u54C1\u7DE8\u865F*"),s(),x(5,"input",65),s(),l(6,"label",63)(7,"span",64),d(8,"\u5546\u54C1\u540D\u7A31*"),s(),x(9,"input",66),s(),l(10,"label",63)(11,"span",64),d(12,"\u54C1\u9805*"),s(),x(13,"input",67),l(14,"datalist",68),O(15,gB,1,1,"option",16,j),s()(),l(17,"label",63)(18,"span",64),d(19,"\u4F9B\u61C9\u5546*"),s(),l(20,"select",69)(21,"option",70),d(22,"\u9078\u64C7\u4F9B\u61C9\u5546"),s(),O(23,hB,2,2,"option",16,eu),s()(),l(25,"label",63)(26,"span",64),d(27,"\u7D30\u9805\u6578\u91CF*"),s(),x(28,"input",71),s(),l(29,"label",63)(30,"span",64),d(31,"\u7D30\u9805\u55AE\u4F4D*"),s(),x(32,"input",72),s(),l(33,"label",63)(34,"span",64),d(35,"\u7E3D\u55AE\u4F4D*"),s(),x(36,"input",73),s(),l(37,"label",63)(38,"span",64),d(39,"\u50F9\u683C(\u5143)*"),s(),x(40,"input",74),s()(),l(41,"label",63)(42,"span",64),d(43,"\u5099\u8A3B"),s(),x(44,"textarea",75),s()()),n&2){let t=_(2);I("formGroup",t.productCostForm),f(15),L(t.groceriesProductCategories()),f(8),L(t.allVendors())}}function _B(n,e){if(n&1&&(l(0,"div",58)(1,"div",62)(2,"label",63)(3,"span",64),d(4,"\u5EE0\u5546*"),s(),x(5,"input",76),s(),l(6,"label",63)(7,"span",64),d(8,"\u5546\u54C1\u540D\u7A31*"),s(),x(9,"input",66),s(),l(10,"label",63)(11,"span",64),d(12,"\u985E\u578B*"),s(),x(13,"input",77),s(),l(14,"label",63)(15,"span",64),d(16,"\u9032\u8CA8\u6210\u672C*"),s(),x(17,"input",78),s(),l(18,"label",79)(19,"span",64),d(20,"\u552E\u50F9*"),s(),x(21,"input",80),s()()()),n&2){let t=_(2);I("formGroup",t.wineCostForm)}}function vB(n,e){if(n&1&&(l(0,"div",58)(1,"div",62)(2,"label",63)(3,"span",64),d(4,"\u54C1\u724C*"),s(),x(5,"input",81),s(),l(6,"label",63)(7,"span",64),d(8,"\u5546\u54C1\u540D\u7A31*"),s(),x(9,"input",66),s(),l(10,"label",63)(11,"span",64),d(12,"\u5C3A\u5BF8*"),s(),x(13,"input",82),s(),l(14,"label",63)(15,"span",64),d(16,"\u6BCF\u76D2\u6578\u91CF*"),s(),x(17,"input",83),s(),l(18,"label",63)(19,"span",64),d(20,"\u7406\u665F\u6210\u672C(\u652F)*"),s(),x(21,"input",84),s(),l(22,"label",63)(23,"span",64),d(24,"\u767E\u6CC7\u6210\u672C(\u652F)*"),s(),x(25,"input",85),s(),l(26,"label",79)(27,"span",64),d(28,"\u8CE3\u50F9*"),s(),x(29,"input",80),s()()()),n&2){let t=_(2);I("formGroup",t.cigarCostForm)}}function CB(n,e){if(n&1){let t=B();l(0,"div",10)(1,"div",51)(2,"div",52)(3,"h3",53),M(4,mB,1,1)(5,pB,1,1)(6,fB,1,1),s(),l(7,"button",54),b("click",function(){D(t);let r=_();return w(r.closeModal())}),x(8,"ion-icon",55),s()(),l(9,"div",56)(10,"form",57),b("ngSubmit",function(){D(t);let r=_();return w(r.handleFormSubmit())}),M(11,yB,45,1,"div",58)(12,_B,22,1,"div",58)(13,vB,30,1,"div",58),l(14,"div",59)(15,"button",60),b("click",function(){D(t);let r=_();return w(r.closeModal())}),d(16,"\u53D6\u6D88"),s(),l(17,"button",61),d(18,"\u5132\u5B58"),s()()()()()()}if(n&2){let t,i,r=_();f(4),A((t=r.activeView())==="groceries"?4:t==="wines"?5:t==="cigars"?6:-1),f(7),A((i=r.activeView())==="groceries"?11:i==="wines"?12:i==="cigars"?13:-1)}}var Ja=class Ja{constructor(){this.dataService=P(Bt);this.fb=P(je);this.activeView=S("groceries");this.isModalOpen=S(!1);this.Math=Math;this.allVendors=S([]);this.allProductCosts=S([]);this.editingProductCost=S(null);this.allCigarCosts=S([]);this.editingCigarCost=S(null);this.allWineCosts=S([]);this.editingWineCost=S(null);this.productCostForm=this.fb.group({id:[""],productId:["",U.required],productName:["",U.required],vendorId:["",U.required],category:["",U.required],itemQuantity:[null,[U.required,U.min(.01)]],itemUnit:["",U.required],totalUnit:["",U.required],price:[null,[U.required,U.min(0)]],notes:[""]});this.cigarCostForm=this.fb.group({id:[""],brand:["",U.required],productName:["",U.required],size:["",U.required],quantityPerBox:[null,[U.required,U.min(1)]],lishengCost:[null,[U.required,U.min(0)]],baijiaCost:[null,[U.required,U.min(0)]],sellingPrice:[null,[U.required,U.min(0)]]});this.wineCostForm=this.fb.group({id:[""],vendor:["",U.required],productName:["",U.required],type:["",U.required],cost:[null,[U.required,U.min(0)]],sellingPrice:[null,[U.required,U.min(0)]]});this.groceriesSearchTerm=S("");this.groceriesSelectedVendor=S("");this.groceriesSelectedCategory=S("");this.groceriesSortColumn=S("productName");this.groceriesSortDirection=S("asc");this.groceriesCurrentPage=S(1);this.groceriesPageSize=10;this.cigarSearchTerm=S("");this.cigarSelectedBrand=S("");this.cigarSortColumn=S("brand");this.cigarSortDirection=S("asc");this.cigarCurrentPage=S(1);this.cigarPageSize=10;this.wineSearchTerm=S("");this.wineSelectedVendor=S("");this.wineSelectedType=S("");this.wineSortColumn=S("vendor");this.wineSortDirection=S("asc");this.wineCurrentPage=S(1);this.winePageSize=10;this.groceriesProductCategories=H(()=>[...new Set(this.allProductCosts().map(e=>e.category))].sort());this.filteredGroceries=H(()=>this.filterAndSort(this.allProductCosts(),this.groceriesSearchTerm(),{vendorId:this.groceriesSelectedVendor(),category:this.groceriesSelectedCategory()},["productName","productId"],this.groceriesSortColumn(),this.groceriesSortDirection()));this.paginatedGroceries=H(()=>this.paginate(this.filteredGroceries(),this.groceriesCurrentPage(),this.groceriesPageSize));this.groceriesTotalPages=H(()=>Math.ceil(this.filteredGroceries().length/this.groceriesPageSize));this.cigarBrands=H(()=>[...new Set(this.allCigarCosts().map(e=>e.brand))].sort());this.filteredCigars=H(()=>this.filterAndSort(this.allCigarCosts(),this.cigarSearchTerm(),{brand:this.cigarSelectedBrand()},["productName","brand"],this.cigarSortColumn(),this.cigarSortDirection()));this.paginatedCigars=H(()=>this.paginate(this.filteredCigars(),this.cigarCurrentPage(),this.cigarPageSize));this.cigarTotalPages=H(()=>Math.ceil(this.filteredCigars().length/this.cigarPageSize));this.wineVendors=H(()=>[...new Set(this.allWineCosts().map(e=>e.vendor))].sort());this.wineTypes=H(()=>[...new Set(this.allWineCosts().map(e=>e.type))].sort());this.filteredWines=H(()=>this.filterAndSort(this.allWineCosts(),this.wineSearchTerm(),{vendor:this.wineSelectedVendor(),type:this.wineSelectedType()},["productName","vendor","type"],this.wineSortColumn(),this.wineSortDirection()));this.paginatedWines=H(()=>this.paginate(this.filteredWines(),this.wineCurrentPage(),this.winePageSize));this.wineTotalPages=H(()=>Math.ceil(this.filteredWines().length/this.winePageSize));this.loadData()}loadData(){this.allProductCosts.set(this.dataService.getProductCosts()),this.allCigarCosts.set(this.dataService.getCigarCosts()),this.allWineCosts.set(this.dataService.getWineCosts()),this.allVendors.set(this.dataService.getVendors())}changeView(e){this.activeView.set(e)}filterAndSort(e,t,i,r,o,a){let u=t.toLowerCase(),c=e.filter(m=>Object.entries(i).every(([y,v])=>!v||m[y]===v)?u?r.some(y=>String(m[y]).toLowerCase().includes(u)):!0:!1);return o&&(c=[...c].sort((m,h)=>{let y=m[o],v=h[o];return y<v?a==="asc"?-1:1:y>v?a==="asc"?1:-1:0})),c}paginate(e,t,i){let r=(t-1)*i;return e.slice(r,r+i)}openModal(e=null){let t=this.activeView();t==="groceries"?(this.editingProductCost.set(e),this.productCostForm.reset(),e&&this.productCostForm.patchValue(e)):t==="cigars"?(this.editingCigarCost.set(e),this.cigarCostForm.reset(),e&&this.cigarCostForm.patchValue(e)):t==="wines"&&(this.editingWineCost.set(e),this.wineCostForm.reset(),e&&this.wineCostForm.patchValue(e)),this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1)}handleFormSubmit(){let e=this.activeView();e==="groceries"?this.handleGroceriesSubmit():e==="cigars"?this.handleCigarSubmit():e==="wines"&&this.handleWineSubmit(),this.loadData(),this.closeModal()}handleGroceriesSubmit(){if(this.productCostForm.invalid)return;let e=this.productCostForm.value;this.editingProductCost()?this.dataService.updateProductCost(G(V({},e),{id:this.editingProductCost().id})):this.dataService.addProductCost(e)}handleCigarSubmit(){if(this.cigarCostForm.invalid)return;let e=this.cigarCostForm.value;this.editingCigarCost()?this.dataService.updateCigarCost(G(V({},e),{id:this.editingCigarCost().id})):this.dataService.addCigarCost(e)}handleWineSubmit(){if(this.wineCostForm.invalid)return;let e=this.wineCostForm.value;this.editingWineCost()?this.dataService.updateWineCost(G(V({},e),{id:this.editingWineCost().id})):this.dataService.addWineCost(e)}deleteItem(e){if(!confirm("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u6B64\u9805\u5546\u54C1\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"))return;let t=this.activeView();t==="groceries"?this.dataService.deleteProductCost(e):t==="cigars"?this.dataService.deleteCigarCost(e):t==="wines"&&this.dataService.deleteWineCost(e),this.loadData()}sortData(e){let t=this.activeView(),i=t==="groceries"?this.groceriesSortColumn:t==="cigars"?this.cigarSortColumn:this.wineSortColumn,r=t==="groceries"?this.groceriesSortDirection:t==="cigars"?this.cigarSortDirection:this.wineSortDirection;i()===e?r.update(o=>o==="asc"?"desc":"asc"):(i.set(e),r.set("asc"))}resetFilters(e){e==="groceries"?(this.groceriesSearchTerm.set(""),this.groceriesSelectedVendor.set(""),this.groceriesSelectedCategory.set("")):e==="cigars"?(this.cigarSearchTerm.set(""),this.cigarSelectedBrand.set("")):e==="wines"&&(this.wineSearchTerm.set(""),this.wineSelectedVendor.set(""),this.wineSelectedType.set("")),this.goToPage(1,e)}applyFilters(e){this.goToPage(1,e)}goToPage(e,t){let i=t==="groceries"?this.groceriesCurrentPage:t==="cigars"?this.cigarCurrentPage:this.wineCurrentPage,r=t==="groceries"?this.groceriesTotalPages():t==="cigars"?this.cigarTotalPages():this.wineTotalPages();e>=1&&e<=r&&i.set(e)}getVendorName(e){return this.allVendors().find(t=>t.id===e)?.name||"N/A"}calculateItemCost(e,t){return!e||!t?0:e/t}calculateMargin(e,t){return!e||!t?0:(t-e)/t*100}formatCurrency(e){return e?.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})||""}};Ja.\u0275fac=function(t){return new(t||Ja)},Ja.\u0275cmp=re({type:Ja,selectors:[["app-product-cost"]],decls:22,vars:8,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","add-outline"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"border-b","border-gray-200"],["aria-label","Tabs",1,"-mb-px","flex","space-x-6"],[1,"whitespace-nowrap","py-4","px-1","border-b-2","font-medium","text-sm",3,"click"],[1,"pt-6"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","p-4","bg-gray-50","rounded-lg","mb-6"],[1,"md:col-span-2"],["type","text","placeholder","\u641C\u5C0B\u5546\u54C1\u540D\u7A31\u6216\u7DE8\u865F...",1,"w-full","border-gray-300","rounded-lg","shadow-sm","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"w-full","border-gray-300","rounded-lg","shadow-sm","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"flex","items-center","gap-2","md:col-span-4","justify-end"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-4","py-3","cursor-pointer",3,"click"],[1,"px-4","py-3","cursor-pointer","text-right",3,"click"],[1,"px-4","py-3","text-right"],[1,"px-4","py-3"],[1,"border-b","hover:bg-gray-50"],[1,"flex","justify-between","items-center","pt-4","border-t","mt-4"],[1,"px-4","py-2"],[1,"px-4","py-2","font-medium"],[1,"px-4","py-2","text-right"],[1,"px-4","py-2","text-right","font-semibold","bg-green-50"],[1,"px-4","py-2","truncate","max-w-xs"],[1,"flex","items-center","gap-2"],["title","\u7DE8\u8F2F",1,"text-indigo-600","hover:text-indigo-800","p-1",3,"click"],["name","create-outline",1,"text-lg"],["title","\u522A\u9664",1,"text-red-500","hover:text-red-700","p-1",3,"click"],["name","trash-outline",1,"text-lg"],["colspan","11",1,"text-center","py-8","text-gray-500"],[1,"text-sm","text-gray-600"],[1,"px-3","py-1","border","rounded-md","disabled:opacity-50",3,"click","disabled"],["name","chevron-back-outline"],[1,"text-sm"],["name","chevron-forward-outline"],["type","text","placeholder","\u641C\u5C0B\u5546\u54C1\u3001\u5EE0\u5546\u3001\u985E\u578B...",1,"w-full","border-gray-300","rounded-lg","shadow-sm","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["colspan","7",1,"text-center","py-8","text-gray-500"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","p-4","bg-gray-50","rounded-lg","mb-6"],["type","text","placeholder","\u641C\u5C0B\u54C1\u724C\u6216\u5546\u54C1\u540D\u7A31...",1,"w-full","border-gray-300","rounded-lg","shadow-sm","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"flex","items-center","gap-2","md:col-span-3","justify-end"],["colspan","9",1,"text-center","py-8","text-gray-500"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-2xl","max-h-[90vh]","flex","flex-col"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],["novalidate","",1,"space-y-4",3,"ngSubmit"],[1,"space-y-4",3,"formGroup"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"block"],[1,"text-gray-700"],["formControlName","productId",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","productName",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","category","list","productCategoriesList","placeholder","\u9078\u64C7\u6216\u8F38\u5165\u65B0\u54C1\u9805",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["id","productCategoriesList"],["formControlName","vendorId",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["value","","disabled",""],["type","number","formControlName","itemQuantity",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","itemUnit","placeholder","\u4F8B\u5982: ml, g, \u9846",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","totalUnit","placeholder","\u4F8B\u5982: \u74F6, \u5305, \u7F50",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["type","number","formControlName","price",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","notes","rows","3",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","vendor",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","type",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["type","number","formControlName","cost",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"block","md:col-span-2"],["type","number","formControlName","sellingPrice",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","brand",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","size",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["type","number","formControlName","quantityPerBox",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["type","number","formControlName","lishengCost",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["type","number","formControlName","baijiaCost",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),d(3,"\u5546\u54C1\u6210\u672C\u7BA1\u7406"),s(),l(4,"button",3),b("click",function(){return i.openModal()}),x(5,"ion-icon",4),l(6,"span"),d(7,"\u65B0\u589E\u9805\u76EE"),s()()(),l(8,"div",5)(9,"div",6)(10,"nav",7)(11,"button",8),b("click",function(){return i.changeView("groceries")}),d(12,"\u9910\u98F2&\u96DC\u8CA8"),s(),l(13,"button",8),b("click",function(){return i.changeView("wines")}),d(14,"\u5A01&\u7D05\u767D\u9152"),s(),l(15,"button",8),b("click",function(){return i.changeView("cigars")}),d(16,"\u96EA\u8304"),s()()(),l(17,"div",9),M(18,eB,49,5)(19,aB,41,5)(20,cB,39,4),s()()(),M(21,CB,19,2,"div",10)),t&2){let r;f(11),De(i.activeView()==="groceries"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),f(2),De(i.activeView()==="wines"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),f(2),De(i.activeView()==="cigars"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),f(3),A((r=i.activeView())==="groceries"?18:r==="wines"?19:r==="cigars"?20:-1),f(3),A(i.isModalOpen()?21:-1)}},dependencies:[oe,ke,Be,Fe,Pe,xe,kt,Re,me,Le,Ue,Ge,Se,Ie,$l],encapsulation:2,changeDetection:0});var up=Ja;var xB=(n,e)=>e.vendor_id||e.id;function bB(n,e){n&1&&(l(0,"div",1),x(1,"ion-icon",29),l(2,"span",30),d(3,"\u6B63\u5728\u52A0\u8F09\u6578\u64DA..."),s()())}function EB(n,e){if(n&1&&(l(0,"div",2),x(1,"ion-icon",31),l(2,"span",32),d(3),s()()),n&2){let t=_();f(3),E(t.errorMessage())}}function SB(n,e){if(n&1&&(l(0,"option",14),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),E(t)}}function DB(n,e){if(n&1&&d(0),n&2){let t=_().$implicit;k(" ",t.rest_days.join(", ")," ")}}function wB(n,e){if(n&1&&d(0),n&2){let t=_().$implicit;k(" ",t.restDays||"-"," ")}}function TB(n,e){if(n&1){let t=B();l(0,"tr",33),b("click",function(){let r=D(t).$implicit,o=_();return w(o.openModal(r))}),l(1,"td",34),d(2),s(),l(3,"td",35),d(4),s(),l(5,"td",34),d(6),s(),l(7,"td",34),M(8,DB,1,1)(9,wB,1,1),s()()}if(n&2){let t=e.$implicit;f(2),E(t.category),f(2),E(t.vendor_name||t.name),f(2),E(t.contact_info||t.contactInfo),f(2),A(t.rest_days&&t.rest_days.length>0?8:9)}}function IB(n,e){n&1&&(l(0,"tr")(1,"td",36),d(2,"\u7121\u7B26\u5408\u689D\u4EF6\u7684\u5EE0\u5546\u8CC7\u6599\u3002"),s()())}function MB(n,e){if(n&1&&(l(0,"div",52),x(1,"ion-icon",56),l(2,"span",57),d(3),s()()),n&2){let t=_(2);f(3),E(t.errorMessage())}}function AB(n,e){n&1&&(x(0,"ion-icon",58),l(1,"span"),d(2,"\u5132\u5B58\u4E2D..."),s())}function RB(n,e){n&1&&(l(0,"span"),d(1,"\u5132\u5B58"),s())}function NB(n,e){if(n&1){let t=B();l(0,"div",28)(1,"div",37)(2,"div",38)(3,"h3",39),d(4),s(),l(5,"button",40),b("click",function(){D(t);let r=_();return w(r.closeModal())}),x(6,"ion-icon",41),s()(),l(7,"div",42)(8,"form",43),b("ngSubmit",function(){D(t);let r=_();return w(r.handleVendorSubmit())}),x(9,"input",44),l(10,"label",45)(11,"span",46),d(12,"\u985E\u5225*"),s(),x(13,"input",47),s(),l(14,"label",45)(15,"span",46),d(16,"\u5EE0\u5546\u540D\u7A31*"),s(),x(17,"input",48),s(),l(18,"label",45)(19,"span",46),d(20,"\u7D71\u4E00\u7DE8\u865F"),s(),x(21,"input",49),s(),l(22,"label",45)(23,"span",46),d(24,"\u806F\u7D61\u65B9\u5F0F"),s(),x(25,"input",50),s(),l(26,"label",45)(27,"span",46),d(28,"\u4F11\u606F\u6642\u9593"),s(),x(29,"input",51),s(),M(30,MB,4,1,"div",52),l(31,"div",53)(32,"button",54),b("click",function(){D(t);let r=_();return w(r.closeModal())}),d(33,"\u53D6\u6D88"),s(),l(34,"button",55),M(35,AB,3,0)(36,RB,2,0,"span"),s()()()()()()}if(n&2){let t=_();f(4),E(t.editingVendor()?"\u7DE8\u8F2F\u5EE0\u5546":"\u65B0\u589E\u5EE0\u5546"),f(4),I("formGroup",t.vendorForm),f(22),A(t.errorMessage()?30:-1),f(2),I("disabled",t.isLoading()),f(2),I("disabled",t.isLoading()),f(),A(t.isLoading()?35:36)}}var Ka=class Ka{constructor(){this.apiService=P(Xe);this.fb=P(je);this.isModalOpen=S(!1);this.isLoading=S(!1);this.errorMessage=S(null);this.allVendors=S([]);this.editingVendor=S(null);this.vendorForm=this.fb.group({vendor_id:[""],category:["",U.required],vendor_name:["",U.required],tax_id:[""],contact_info:[""],rest_days:[""]});this.vendorSearchTerm=S("");this.selectedVendorCategory=S("");this.vendorTaxIdFilter=S("");this.pageSize=20;this.currentPage=S(1);this.vendorCategories=H(()=>{let e=this.allVendors();return[...new Set(e.map(i=>i.category))].sort()});this.filteredVendors=H(()=>{let e=this.vendorSearchTerm().toLowerCase(),t=this.selectedVendorCategory(),i=this.vendorTaxIdFilter(),r=this.allVendors();return t&&(r=r.filter(o=>o.category===t)),i&&(r=r.filter(o=>(o.tax_id||o.taxId||"").includes(i))),e&&(r=r.filter(o=>(o.vendor_name||o.name||"").toLowerCase().includes(e)||(o.category||"").toLowerCase().includes(e)||(o.contact_info||o.contactInfo||"").toLowerCase().includes(e))),r});this.pagedVendors=H(()=>{let e=this.filteredVendors(),t=(this.currentPage()-1)*this.pageSize;return e.slice(t,t+this.pageSize)});this.totalPages=H(()=>{let e=this.filteredVendors().length;return Math.max(1,Math.ceil(e/this.pageSize))});this.totalRecords=H(()=>this.filteredVendors().length);this.loadData()}async loadData(){this.isLoading.set(!0),this.errorMessage.set(null);try{let e=await this.apiService.getVendors();e.success&&e.data?this.allVendors.set(e.data):this.errorMessage.set(e.error||"\u7121\u6CD5\u53D6\u5F97\u5EE0\u5546\u8CC7\u6599")}catch(e){console.error("Error loading vendors:",e),this.errorMessage.set("\u53D6\u5F97\u5EE0\u5546\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoading.set(!1)}}resetVendorFilters(){this.vendorSearchTerm.set(""),this.selectedVendorCategory.set(""),this.vendorTaxIdFilter.set(""),this.currentPage.set(1)}goToPage(e){let t=this.totalPages(),i=Math.min(Math.max(e,1),t);i!==this.currentPage()&&this.currentPage.set(i)}goToPrevPage(){this.goToPage(this.currentPage()-1)}goToNextPage(){this.goToPage(this.currentPage()+1)}onTaxIdInput(e){let t=e.target,i=t.value.replace(/\D/g,"").slice(0,8);this.vendorTaxIdFilter.set(i),t.value=i,this.currentPage.set(1)}openModal(e=null){this.editingVendor.set(e),this.vendorForm.reset(),e&&this.vendorForm.patchValue(e),this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1),this.editingVendor.set(null)}async handleVendorSubmit(){if(this.vendorForm.invalid){this.errorMessage.set("\u8ACB\u586B\u5BEB\u6240\u6709\u5FC5\u586B\u6B04\u4F4D");return}this.isLoading.set(!0),this.errorMessage.set(null);try{let e=this.vendorForm.value,t={vendor_id:e.vendor_id?Number(e.vendor_id):void 0,category:e.category||"",vendor_name:e.vendor_name||"",tax_id:e.tax_id||void 0,contact_info:e.contact_info||"",rest_days:e.rest_days?e.rest_days.split(",").map(i=>i.trim()).filter(i=>i):[]};if(this.editingVendor()&&t.vendor_id){let i=await this.apiService.updateVendor(t);if(!i.success){this.errorMessage.set(i.error||"\u66F4\u65B0\u5EE0\u5546\u5931\u6557");return}let o=this.allVendors().map(a=>(a.vendor_id||a.id)==t.vendor_id?V(G(V({},a),{vendor_id:t.vendor_id,category:t.category,vendor_name:t.vendor_name,tax_id:t.tax_id,contact_info:t.contact_info,rest_days:t.rest_days}),i.data||{}):a);this.allVendors.set(o),alert("\u5EE0\u5546\u8CC7\u6599\u5DF2\u6210\u529F\u66F4\u65B0"),this.closeModal()}else this.errorMessage.set("\u65B0\u589E\u5EE0\u5546\u529F\u80FD\u5C1A\u672A\u5BE6\u4F5C"),console.warn("\u65B0\u589E\u5EE0\u5546\u529F\u80FD\u9700\u8981\u5F8C\u7AEF\u652F\u6301")}catch(e){console.error("Error submitting vendor:",e),this.errorMessage.set("\u63D0\u4EA4\u5EE0\u5546\u8CC7\u6599\u5931\u6557\uFF1A"+(e instanceof Error?e.message:"\u672A\u77E5\u932F\u8AA4"))}finally{this.isLoading.set(!1)}}async deleteVendor(e){let t=e.vendor_name||e.name||"\u672A\u77E5\u5EE0\u5546";if(!confirm(`\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u5EE0\u5546 "${t}" \u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002`))return;let i=e.vendor_id||e.id;if(!i){this.errorMessage.set("\u5EE0\u5546 ID \u4E0D\u5B58\u5728\uFF0C\u7121\u6CD5\u522A\u9664");return}this.isLoading.set(!0),this.errorMessage.set(null);try{let r=await this.apiService.deleteVendor(i);r.success?await this.loadData():this.errorMessage.set(r.error||"\u522A\u9664\u5EE0\u5546\u5931\u6557")}catch(r){console.error("Error deleting vendor:",r),this.errorMessage.set("\u522A\u9664\u5EE0\u5546\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoading.set(!1)}}formatCurrency(e){return e==null?"":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}};Ka.\u0275fac=function(t){return new(t||Ka)},Ka.\u0275cmp=re({type:Ka,selectors:[["app-vendors"]],decls:51,vars:13,consts:[[1,"space-y-6"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-4","flex","items-center","gap-3"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4","flex","items-center","gap-3"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["name","add-outline"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"space-y-4"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4","p-4","bg-gray-50","rounded-lg"],[1,"lg:col-span-2"],["type","text","placeholder","\u641C\u5C0B\u5EE0\u5546\u540D\u7A31\u3001\u985E\u5225\u6216\u806F\u7D61\u65B9\u5F0F...",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["value",""],[3,"value"],["type","text","placeholder","\u7D71\u4E00\u7DE8\u865F (8\u78BC)","maxlength","8","pattern","\\d*",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"input","value"],[1,"flex","items-center","gap-2","lg:col-span-4","justify-end"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-4","py-3"],[1,"border-b","hover:bg-gray-50","cursor-pointer","transition-colors"],[1,"flex","flex-col","sm:flex-row","items-center","justify-between","gap-3","pt-4"],[1,"text-sm","text-gray-600"],[1,"flex","items-center","gap-2"],["type","button",1,"px-3","py-1.5","text-sm","border","rounded-md","disabled:opacity-50","disabled:cursor-not-allowed","hover:bg-gray-50",3,"click","disabled"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],["name","hourglass-outline",1,"text-blue-600","text-xl","animate-spin"],[1,"text-blue-700"],["name","alert-circle-outline",1,"text-red-600","text-xl"],[1,"text-red-700"],[1,"border-b","hover:bg-gray-50","cursor-pointer","transition-colors",3,"click"],[1,"px-4","py-2"],[1,"px-4","py-2","font-medium"],["colspan","4",1,"text-center","py-8","text-gray-500"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-lg","max-h-[90vh]","flex","flex-col"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],[1,"space-y-4",3,"ngSubmit","formGroup"],["type","hidden","formControlName","vendor_id"],[1,"block"],[1,"text-gray-700"],["formControlName","category",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","vendor_name",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","tax_id","type","text","maxlength","8","pattern","\\d*","placeholder","8\u4F4D\u6578\u5B57",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","contact_info",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","rest_days","placeholder","\u4F8B\uFF1A\u5468\u4E00,\u5468\u4E8C",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-3","flex","items-center","gap-2"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md","disabled:opacity-50","disabled:cursor-not-allowed","hover:bg-gray-50",3,"click","disabled"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","hover:bg-indigo-700","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","gap-2",3,"disabled"],["name","alert-circle-outline",1,"text-red-600","text-lg"],[1,"text-red-700","text-sm"],["name","hourglass-outline",1,"animate-spin"]],template:function(t,i){t&1&&(l(0,"div",0),M(1,bB,4,0,"div",1),M(2,EB,4,1,"div",2),l(3,"div",3)(4,"h1",4),d(5,"\u5EE0\u5546\u7BA1\u7406"),s(),l(6,"button",5),b("click",function(){return i.openModal()}),x(7,"ion-icon",6),l(8,"span"),d(9,"\u65B0\u589E\u5EE0\u5546"),s()()(),l(10,"div",7)(11,"div",8)(12,"div",9)(13,"div",10)(14,"input",11),b("ngModelChange",function(o){return i.vendorSearchTerm.set(o),i.currentPage.set(1)}),s()(),l(15,"div")(16,"select",12),b("ngModelChange",function(o){return i.selectedVendorCategory.set(o),i.currentPage.set(1)}),l(17,"option",13),d(18,"\u6240\u6709\u985E\u5225"),s(),O(19,SB,2,2,"option",14,j),s()(),l(21,"div")(22,"input",15),b("input",function(o){return i.onTaxIdInput(o)}),s()(),l(23,"div",16)(24,"button",17),b("click",function(){return i.resetVendorFilters()}),x(25,"ion-icon",18),s()()(),l(26,"div",19)(27,"table",20)(28,"thead",21)(29,"tr")(30,"th",22),d(31,"\u985E\u5225"),s(),l(32,"th",22),d(33,"\u5EE0\u5546"),s(),l(34,"th",22),d(35,"\u806F\u7D61\u65B9\u5F0F"),s(),l(36,"th",22),d(37,"\u4F11\u606F\u6642\u9593"),s()()(),l(38,"tbody"),O(39,TB,10,4,"tr",23,xB,!1,IB,3,0,"tr"),s()()(),l(42,"div",24)(43,"div",25),d(44),s(),l(45,"div",26)(46,"button",27),b("click",function(){return i.goToPrevPage()}),d(47," \u4E0A\u4E00\u9801 "),s(),l(48,"button",27),b("click",function(){return i.goToNextPage()}),d(49," \u4E0B\u4E00\u9801 "),s()()()()()(),M(50,NB,37,6,"div",28)),t&2&&(f(),A(i.isLoading()?1:-1),f(),A(i.errorMessage()?2:-1),f(4),I("disabled",i.isLoading()),f(8),I("ngModel",i.vendorSearchTerm()),f(2),I("ngModel",i.selectedVendorCategory()),f(3),L(i.vendorCategories()),f(3),I("value",i.vendorTaxIdFilter()),f(17),L(i.pagedVendors()),f(5),Kt(" \u7B2C ",i.currentPage()," / ",i.totalPages()," \u9801\uFF0C\u5171 ",i.totalRecords()," \u7B46 "),f(2),I("disabled",i.currentPage()===1),f(2),I("disabled",i.currentPage()===i.totalPages()),f(2),A(i.isModalOpen()?50:-1))},dependencies:[oe,ke,Be,Fe,Pe,xe,Re,me,Le,ql,Wl,Ue,Ge,Se,Ie],encapsulation:2,changeDetection:0});var dp=Ka;var j2=(n,e)=>e.id,t_=(n,e)=>e.name;function FB(n,e){if(n&1&&(l(0,"option",18),d(1),s()),n&2){let t=e.$implicit;I("value",t.id),f(),E(t.name)}}function PB(n,e){n&1&&(l(0,"div",26),x(1,"ion-icon",34),l(2,"span"),d(3,"\u8F09\u5165\u9032\u8CA8\u55AE\u8CC7\u6599\u4E2D..."),s()())}function kB(n,e){if(n&1&&(l(0,"div",27)(1,"div",10),x(2,"ion-icon",35),l(3,"span"),d(4),s()()()),n&2){let t=_(2);f(4),E(t.shipmentError())}}function VB(n,e){if(n&1&&(d(0),Gt(1,"number")),n&2){let t=_().$implicit;k(" ",sn(1,1,t.qty,"1.2-2")," ")}}function OB(n,e){n&1&&d(0," - ")}function LB(n,e){if(n&1&&d(0),n&2){let t=_().$implicit,i=_(2);k(" ",i.formatCurrency(t.unitPrice)," ")}}function BB(n,e){n&1&&d(0," - ")}function UB(n,e){if(n&1&&d(0),n&2){let t=_().$implicit,i=_(2);k(" ",i.formatCurrency(t.lineAmount)," ")}}function $B(n,e){n&1&&d(0," - ")}function HB(n,e){if(n&1){let t=B();l(0,"tr",36),b("click",function(){let r=D(t).$implicit,o=_(2);return w(o.openShipmentEditModal(r))}),l(1,"td",37),d(2),s(),l(3,"td",38),d(4),s(),l(5,"td",37),d(6),s(),l(7,"td",39),M(8,VB,2,4)(9,OB,1,0),s(),l(10,"td",39),d(11),s(),l(12,"td",39),M(13,LB,1,1)(14,BB,1,0),s(),l(15,"td",40),M(16,UB,1,1)(17,$B,1,0),s(),l(18,"td",41),d(19),s()()}if(n&2){let t=e.$implicit,i=_(2);f(2),E(i.formatDate(t.issueDate)),f(2),E(t.vendorName),f(2),E(t.itemName),f(2),A(t.qty!==null?8:9),f(3),E(t.unit||"-"),f(2),A(t.unitPrice!==null?13:14),f(3),A(t.lineAmount!==null?16:17),f(3),E(t.remark||"-")}}function GB(n,e){n&1&&(l(0,"tr")(1,"td",42),d(2,"\u672A\u627E\u5230\u9032\u8CA8\u55AE\u8CC7\u6599\u3002"),s()())}function qB(n,e){if(n&1&&(l(0,"div",4),M(1,PB,4,0,"div",26),M(2,kB,5,1,"div",27),l(3,"div",28)(4,"table",29)(5,"thead",30)(6,"tr")(7,"th",31),d(8,"\u958B\u7ACB\u65E5\u671F"),s(),l(9,"th",31),d(10,"\u5EE0\u5546"),s(),l(11,"th",31),d(12,"\u54C1\u9805\u540D\u7A31"),s(),l(13,"th",32),d(14,"\u6578\u91CF"),s(),l(15,"th",32),d(16,"\u55AE\u4F4D"),s(),l(17,"th",32),d(18,"\u55AE\u50F9"),s(),l(19,"th",32),d(20,"\u5C0F\u8A08"),s(),l(21,"th",31),d(22,"\u5099\u8A3B"),s()()(),l(23,"tbody"),O(24,HB,20,8,"tr",33,Sn,!1,GB,3,0,"tr"),s()()()()),n&2){let t=_();f(),A(t.isLoadingShipments()?1:-1),f(),A(!t.isLoadingShipments()&&t.shipmentError()?2:-1),f(22),L(t.pagedShipments())}}function WB(n,e){if(n&1){let t=B();Li(),l(0,"g",59),b("mouseenter",function(){D(t);let r=_().$implicit,o=_(4);return w(o.hoveredVendor.set(r.name))})("mouseleave",function(){D(t);let r=_(5);return w(r.hoveredVendor.set(null))}),x(1,"path",60),s()}if(n&2){let t=_(),i=t.$implicit,r=t.$index,o=_(4);f(),dt("d",o.getPieSlicePath(r,o.pieChartData()))("fill",o.getPieColor(r,o.pieChartData().length))("opacity",o.hoveredVendor()===i.name?"1":"0.8")("stroke",o.hoveredVendor()===i.name?"#000":"none")}}function jB(n,e){if(n&1&&M(0,WB,2,4,":svg:g"),n&2){let t=e.$implicit;A(t.percentage>0?0:-1)}}function zB(n,e){if(n&1&&(l(0,"div",61)(1,"div",62),d(2),s(),l(3,"div",63),d(4),s(),l(5,"div",64),d(6),Gt(7,"number"),s()()),n&2){let t=_().$implicit,i=_(5);f(2),E(t.name),f(2),E(i.formatCurrency(t.amount)),f(2),k("",sn(7,3,t.percentage,"1.1-1"),"%")}}function YB(n,e){if(n&1&&M(0,zB,8,6,"div",61),n&2){let t=e.$implicit,i=_(5);A(t.name===i.hoveredVendor()?0:-1)}}function JB(n,e){if(n&1&&O(0,YB,1,1,null,null,t_),n&2){let t=_(4);L(t.pieChartData())}}function KB(n,e){n&1&&(l(0,"div",57),d(1,"\u6ED1\u9F20\u79FB\u5230\u5713\u9905\u5716\u5207\u7247\u4EE5\u67E5\u770B\u660E\u7D30"),s())}function QB(n,e){if(n&1&&(l(0,"div",10),x(1,"div",65),l(2,"div",66)(3,"div",67),d(4),s(),l(5,"div",68),d(6),s()()()),n&2){let t=e.$implicit,i=_(4);f(),gn("background-color",i.getVendorColor(t.name)),f(3),E(t.name),f(2),E(i.formatCurrency(t.amount))}}function ZB(n,e){if(n&1&&(l(0,"div",51)(1,"div",52),d(2,"\u5EE0\u5546\u9032\u8CA8\u91D1\u984D\u5206\u4F48"),s(),l(3,"div",53)(4,"div",54),Li(),l(5,"svg",55),O(6,jB,1,1,null,null,t_),s()(),Hr(),l(8,"div",56),M(9,JB,2,0)(10,KB,2,0,"div",57),s()(),l(11,"div",58),O(12,QB,7,4,"div",10,t_),s()()),n&2){let t=_(3);f(6),L(t.pieChartData()),f(3),A(t.hoveredVendor()?9:10),f(3),L(t.vendorAmountEntries())}}function XB(n,e){if(n&1&&(l(0,"div",44)(1,"div",45)(2,"div",46),d(3,"\u9032\u8CA8\u9805\u76EE\u6578"),s(),l(4,"div",47),d(5),s()(),l(6,"div",48)(7,"div",49),d(8,"\u9032\u8CA8\u7E3D\u91D1\u984D"),s(),l(9,"div",50),d(10),s()()(),M(11,ZB,14,1,"div",51)),n&2){let t=_(2);f(5),E(t.shipmentStats().totalItems),f(5),E(t.formatCurrency(t.shipmentStats().totalAmount)),f(),A(t.vendorAmountEntries().length>0&&t.shipmentStats().totalAmount>0?11:-1)}}function eU(n,e){n&1&&(l(0,"div",43),d(1,"\u5C1A\u7121\u53EF\u5206\u6790\u7684\u9032\u8CA8\u55AE\u8CC7\u6599\u3002"),s())}function tU(n,e){if(n&1&&(l(0,"div",4),M(1,XB,12,3)(2,eU,2,0,"div",43),s()),n&2){let t=_();f(),A(!t.isLoadingShipments()&&!t.shipmentError()&&t.filteredShipments().length>0?1:2)}}function nU(n,e){if(n&1){let t=B();l(0,"div",24)(1,"div",64),d(2),s(),l(3,"div",10)(4,"button",70),b("click",function(){D(t);let r=_(2);return w(r.setShipmentPage(r.shipmentPage()-1))}),d(5,"\u4E0A\u4E00\u9801"),s(),l(6,"button",70),b("click",function(){D(t);let r=_(2);return w(r.setShipmentPage(r.shipmentPage()+1))}),d(7,"\u4E0B\u4E00\u9801"),s()()()}if(n&2){let t=_(2);f(2),Kt(" \u7B2C ",t.shipmentPage()," / ",t.shipmentTotalPages()," \u9801\uFF0C\u5171 ",t.filteredShipments().length," \u7B46 "),f(2),W("text-gray-400",t.shipmentPage()===1),I("disabled",t.shipmentPage()===1),f(2),W("text-gray-400",t.shipmentPage()===t.shipmentTotalPages()),I("disabled",t.shipmentPage()===t.shipmentTotalPages())}}function iU(n,e){if(n&1&&vt(0,nU,8,9,"div",69),n&2){let t=_();I("ngIf",t.shipmentTotalPages()>1)}}function rU(n,e){if(n&1&&(l(0,"option",18),d(1),s()),n&2){let t=e.$implicit;I("value",t.id),f(),E(t.name)}}function oU(n,e){if(n&1){let t=B();l(0,"div",91),x(1,"input",97)(2,"input",98)(3,"input",99),l(4,"span",88),d(5),s(),l(6,"button",100),b("click",function(){let r=D(t).$index,o=_(2);return w(o.removeItem(r))}),x(7,"ion-icon",101),s()()}if(n&2){let t,i=e.$implicit,r=e.$index,o=_(2);I("formGroupName",r),f(5),E(o.formatCurrency((t=i.get("total"))==null?null:t.value))}}function aU(n,e){if(n&1){let t=B();l(0,"div",25)(1,"div",71)(2,"div",72)(3,"h3",73),d(4),s(),l(5,"button",74),b("click",function(){D(t);let r=_();return w(r.closeModal())}),x(6,"ion-icon",75),s()(),l(7,"div",76)(8,"form",77),b("ngSubmit",function(){D(t);let r=_();return w(r.handlePOSubmit())}),l(9,"div",78)(10,"label",79)(11,"span",80),d(12,"\u9032\u8CA8\u55AE\u865F*"),s(),x(13,"input",81),s(),l(14,"label",79)(15,"span",80),d(16,"\u65E5\u671F*"),s(),x(17,"input",82),s()(),l(18,"label",79)(19,"span",80),d(20,"\u5EE0\u5546*"),s(),l(21,"select",83)(22,"option",84),d(23,"\u9078\u64C7\u5EE0\u5546"),s(),O(24,rU,2,2,"option",18,j2),s()(),l(26,"h4",85),d(27,"\u54C1\u9805"),s(),l(28,"div",86)(29,"div",87),d(30,"\u54C1\u9805\u540D\u7A31"),s(),l(31,"div",88),d(32,"\u6578\u91CF"),s(),l(33,"div",88),d(34,"\u55AE\u50F9"),s(),l(35,"div",88),d(36,"\u5C0F\u8A08"),s(),x(37,"div",89),s(),l(38,"div",90),O(39,oU,8,2,"div",91,Sn),s(),l(41,"button",92),b("click",function(){D(t);let r=_();return w(r.addItem())}),d(42,"+ \u65B0\u589E\u54C1\u9805"),s(),l(43,"div",93),d(44),s(),l(45,"div",94)(46,"button",95),b("click",function(){D(t);let r=_();return w(r.closeModal())}),d(47,"\u53D6\u6D88"),s(),l(48,"button",96),d(49,"\u5132\u5B58"),s()()()()()()}if(n&2){let t,i=_();f(4),E(i.editingPO()?"\u7DE8\u8F2F\u9032\u8CA8\u55AE":"\u65B0\u589E\u9032\u8CA8\u55AE"),f(4),I("formGroup",i.poForm),f(16),L(i.allVendors()),f(15),L(i.poItems.controls),f(5),k("\u7E3D\u8A08: ",i.formatCurrency((t=i.poForm.get("totalAmount"))==null?null:t.value))}}function sU(n,e){if(n&1){let t=B();l(0,"div",4)(1,"div",78)(2,"label",79)(3,"span",102),d(4,"\u958B\u7ACB\u65E5\u671F*"),s(),l(5,"input",103),J("ngModelChange",function(r){D(t);let o=_(2);return K(o.editingShipmentItem().issueDate,r)||(o.editingShipmentItem().issueDate=r),w(r)}),s()(),l(6,"label",79)(7,"span",102),d(8,"\u5EE0\u5546*"),s(),l(9,"input",104),J("ngModelChange",function(r){D(t);let o=_(2);return K(o.editingShipmentItem().vendorName,r)||(o.editingShipmentItem().vendorName=r),w(r)}),s()()(),l(10,"label",79)(11,"span",102),d(12,"\u54C1\u9805\u540D\u7A31*"),s(),l(13,"input",105),J("ngModelChange",function(r){D(t);let o=_(2);return K(o.editingShipmentItem().itemName,r)||(o.editingShipmentItem().itemName=r),w(r)}),s()(),l(14,"div",106)(15,"label",79)(16,"span",102),d(17,"\u6578\u91CF"),s(),l(18,"input",107),J("ngModelChange",function(r){D(t);let o=_(2);return K(o.editingShipmentItem().qty,r)||(o.editingShipmentItem().qty=r),w(r)}),s()(),l(19,"label",79)(20,"span",102),d(21,"\u55AE\u4F4D"),s(),l(22,"input",105),J("ngModelChange",function(r){D(t);let o=_(2);return K(o.editingShipmentItem().unit,r)||(o.editingShipmentItem().unit=r),w(r)}),s()(),l(23,"label",79)(24,"span",102),d(25,"\u55AE\u50F9"),s(),l(26,"input",107),J("ngModelChange",function(r){D(t);let o=_(2);return K(o.editingShipmentItem().unitPrice,r)||(o.editingShipmentItem().unitPrice=r),w(r)}),s()()(),l(27,"label",79)(28,"span",102),d(29,"\u5C0F\u8A08"),s(),l(30,"input",108),J("ngModelChange",function(r){D(t);let o=_(2);return K(o.editingShipmentItem().lineAmount,r)||(o.editingShipmentItem().lineAmount=r),w(r)}),s()(),l(31,"label",79)(32,"span",102),d(33,"\u5099\u8A3B"),s(),l(34,"textarea",109),J("ngModelChange",function(r){D(t);let o=_(2);return K(o.editingShipmentItem().remark,r)||(o.editingShipmentItem().remark=r),w(r)}),s()()(),l(35,"div",94)(36,"button",110),b("click",function(){D(t);let r=_(2);return w(r.closeShipmentEditModal())}),d(37," \u53D6\u6D88 "),s(),l(38,"button",111),b("click",function(){D(t);let r=_(2);return w(r.saveShipmentEdit())}),d(39),s()()}if(n&2){let t=_(2);f(5),Y("ngModel",t.editingShipmentItem().issueDate),f(4),Y("ngModel",t.editingShipmentItem().vendorName),f(4),Y("ngModel",t.editingShipmentItem().itemName),f(5),Y("ngModel",t.editingShipmentItem().qty),f(4),Y("ngModel",t.editingShipmentItem().unit),f(4),Y("ngModel",t.editingShipmentItem().unitPrice),f(4),Y("ngModel",t.editingShipmentItem().lineAmount),f(4),Y("ngModel",t.editingShipmentItem().remark),f(4),I("disabled",t.isLoadingShipments()),f(),k(" ",t.isLoadingShipments()?"\u4FDD\u5B58\u4E2D...":"\u4FDD\u5B58"," ")}}function lU(n,e){if(n&1){let t=B();l(0,"div",25)(1,"div",71)(2,"div",72)(3,"h3",73),d(4,"\u7DE8\u8F2F\u9032\u8CA8\u55AE\u9805\u76EE"),s(),l(5,"button",74),b("click",function(){D(t);let r=_();return w(r.closeShipmentEditModal())}),x(6,"ion-icon",75),s()(),l(7,"div",76),M(8,sU,40,10),s()()()}if(n&2){let t=_();f(8),A(t.editingShipmentItem()?8:-1)}}var Qa=class Qa{constructor(){this.dataService=P(Bt);this.apiService=P(Xe);this.fb=P(je);this.isModalOpen=S(!1);this.isEditModalOpen=S(!1);this.editingShipmentItem=S(null);this.allVendors=S([]);this.allPOs=S([]);this.editingPO=S(null);this.shipmentItems=S([]);this.isLoadingShipments=S(!1);this.shipmentError=S(null);this.poForm=this.fb.group({id:[""],poNumber:["",U.required],vendorId:["",U.required],date:["",U.required],items:this.fb.array([]),totalAmount:[0]});this.poSearchTerm=S("");this.selectedPOVendor=S("");this.today=new Date;this.firstDayOfMonth=new Date(this.today.getFullYear(),this.today.getMonth(),1);this.poStartDate=S(this.formatDateToISO(this.firstDayOfMonth));this.poEndDate=S(this.formatDateToISO(this.today));this.currentTab=S("api");this.shipmentPage=S(1);this.pageSize=20;this.pagedShipments=H(()=>{let e=this.filteredShipments(),t=(this.shipmentPage()-1)*this.pageSize;return e.slice(t,t+this.pageSize)});this.shipmentTotalPages=H(()=>{let e=this.filteredShipments().length;return Math.max(1,Math.ceil(e/this.pageSize))});this.filteredPOs=H(()=>{let e=this.poSearchTerm().toLowerCase(),t=this.selectedPOVendor(),i=this.poStartDate(),r=this.poEndDate(),o=this.allPOs();return t&&(o=o.filter(a=>a.vendorId===t)),i&&(o=o.filter(a=>a.date>=i)),r&&(o=o.filter(a=>a.date<=r)),e&&(o=o.filter(a=>a.poNumber.toLowerCase().includes(e)||this.getVendorName(a.vendorId).toLowerCase().includes(e))),o});this.filteredShipments=H(()=>{let e=this.poSearchTerm().toLowerCase(),t=this.selectedPOVendor(),i=this.poStartDate(),r=this.poEndDate(),o=this.shipmentItems();return t&&(o=o.filter(a=>a.vendorId.toString()===t)),i&&(o=o.filter(a=>a.issueDate>=i)),r&&(o=o.filter(a=>a.issueDate<=r)),e&&(o=o.filter(a=>(a.documentNo?.toLowerCase().includes(e)??!1)||a.itemName.toLowerCase().includes(e)||a.vendorName.toLowerCase().includes(e))),o});this.shipmentStats=H(()=>{let e=this.filteredShipments(),t=e.reduce((r,o)=>r+Number(o.lineAmount||0),0),i={};return e.forEach(r=>{let o=r.vendorName;i[o]=(i[o]||0)+Number(r.lineAmount||0)}),{totalAmount:t,totalItems:e.length,vendorAmounts:i}});this.pieChartData=H(()=>{let e=this.shipmentStats(),t=Object.keys(e.vendorAmounts).sort(),i=e.totalAmount;return t.map(r=>({name:r,amount:e.vendorAmounts[r],percentage:i>0?e.vendorAmounts[r]/i*100:0}))});this.hoveredVendor=S(null);this.vendorAmountEntries=H(()=>{let e=this.shipmentStats();return Object.entries(e.vendorAmounts).map(([t,i])=>({name:t,amount:i})).sort((t,i)=>i.amount-t.amount)});this.loadData(),this.loadShipments(),this.poItems.valueChanges.subscribe(e=>{let t=e.reduce((i,r)=>i+(r.quantity||0)*(r.unitPrice||0),0);this.poForm.get("totalAmount")?.setValue(t,{emitEvent:!1})})}setShipmentPage(e){e<1||e>this.shipmentTotalPages()||this.shipmentPage.set(e)}setTab(e){this.currentTab.set(e)}loadData(){this.allVendors.set(this.dataService.getVendors()),this.allPOs.set(this.dataService.getPurchaseOrders())}async loadShipments(){this.isLoadingShipments.set(!0),this.shipmentError.set(null);try{let e={limit:1e3,offset:0};this.poStartDate()&&(e.startDate=this.poStartDate()),this.poEndDate()&&(e.endDate=this.poEndDate());let t=await this.apiService.getShipmentItems(e);t.success&&t.data?this.shipmentItems.set(t.data):this.shipmentError.set(t.error||"\u7121\u6CD5\u7372\u53D6\u9032\u8CA8\u55AE\u8CC7\u6599")}catch(e){console.error("Error loading shipments:",e),this.shipmentError.set("\u8F09\u5165\u9032\u8CA8\u55AE\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoadingShipments.set(!1)}}async applyShipmentFilter(){await this.loadShipments(),this.shipmentPage.set(1)}resetPOFilters(){this.poSearchTerm.set(""),this.selectedPOVendor.set(""),this.poStartDate.set(""),this.poEndDate.set("")}openModal(e=null){this.editingPO.set(e),this.poForm.reset({totalAmount:0}),this.poItems.clear(),e&&(this.poForm.patchValue(e),e.items.forEach(t=>this.addItem(t.productName,t.quantity,t.unitPrice))),this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1),this.editingPO.set(null)}openShipmentEditModal(e){this.editingShipmentItem.set(e),this.isEditModalOpen.set(!0)}closeShipmentEditModal(){this.isEditModalOpen.set(!1),this.editingShipmentItem.set(null)}async saveShipmentEdit(){let e=this.editingShipmentItem();if(e)try{this.isLoadingShipments.set(!0);let t=await this.apiService.updateShipmentItem(e.shipment_id,{itemName:e.itemName,qty:e.qty||void 0,unitPrice:e.unitPrice||void 0,unit:e.unit||void 0,remark:e.remark||void 0});if(t.success&&t.data){let i=this.shipmentItems().map(r=>r.shipment_id===e.shipment_id?t.data:r);this.shipmentItems.set(i),this.shipmentPage.set(1),this.closeShipmentEditModal(),alert("\u9032\u8CA8\u55AE\u9805\u76EE\u5DF2\u6210\u529F\u66F4\u65B0")}else throw new Error(t.error||"\u66F4\u65B0\u5931\u6557")}catch(t){console.error("Error saving shipment item:",t),alert("\u4FDD\u5B58\u9032\u8CA8\u55AE\u9805\u76EE\u5931\u6557\uFF1A"+(t instanceof Error?t.message:"\u672A\u77E5\u932F\u8AA4"))}finally{this.isLoadingShipments.set(!1)}}createItem(e="",t=1,i=0){let r=this.fb.group({productName:[e,U.required],quantity:[t,[U.required,U.min(1)]],unitPrice:[i,[U.required,U.min(0)]],total:[t*i]});return r.get("quantity")?.valueChanges.subscribe(()=>this.updateItemTotal(r)),r.get("unitPrice")?.valueChanges.subscribe(()=>this.updateItemTotal(r)),r}updateItemTotal(e){let t=e.get("quantity")?.value||0,i=e.get("unitPrice")?.value||0;e.get("total")?.setValue(t*i,{emitEvent:!1})}addItem(e="",t=1,i=0){this.poItems.push(this.createItem(e,t,i))}removeItem(e){this.poItems.removeAt(e)}handlePOSubmit(){if(this.poForm.invalid)return;let e=this.poForm.getRawValue(),t={poNumber:e.poNumber,vendorId:e.vendorId,date:e.date,items:e.items,totalAmount:e.totalAmount};this.editingPO()?this.dataService.updatePurchaseOrder(G(V({},t),{id:this.editingPO().id})):this.dataService.addPurchaseOrder(t),this.loadData(),this.closeModal()}deletePurchaseOrder(e){confirm("\u78BA\u5B9A\u8981\u522A\u9664\u6B64\u9032\u8CA8\u55AE\u55CE\uFF1F")&&(this.dataService.deletePurchaseOrder(e),this.loadData())}getVendorName(e){let t=e.toString();return this.allVendors().find(i=>i.id===t)?.name||"N/A"}formatCurrency(e){return e==null?"":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}formatDate(e){if(!e)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;let t=new Date(e);return Number.isNaN(t.getTime())?"":this.formatDateToISO(t)}formatDateToISO(e){let t=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return`${t}-${i}-${r}`}get poItems(){return this.poForm.get("items")}getPieColor(e,t){let i=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#EC4899","#14B8A6","#F97316","#6366F1","#06B6D4","#84CC16","#D946EF"];return i[e%i.length]}getVendorColor(e){let t=this.pieChartData(),i=t.findIndex(r=>r.name===e);return i<0?"#9CA3AF":this.getPieColor(i,t.length)}getPieSlicePath(e,t){let a=0;for(let N=0;N<e;N++)a+=t[N].percentage*360/100;let u=t[e].percentage*360/100,c=a+u,m=a*Math.PI/180,h=c*Math.PI/180,y=200+120*Math.cos(m),v=200+120*Math.sin(m),C=200+120*Math.cos(h),T=200+120*Math.sin(h),R=u>180?1:0;return`M 200 200 L ${y} ${v} A 120 120 0 ${R} 1 ${C} ${T} Z`}};Qa.\u0275fac=function(t){return new(t||Qa)},Qa.\u0275cmp=re({type:Qa,selectors:[["app-purchase-orders"]],decls:39,vars:17,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"space-y-4"],[1,"flex","border-b","border-gray-200","gap-2","mb-4"],["type","button",1,"pb-2","px-4","font-medium","border-b-2","border-transparent","hover:text-indigo-600",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4","p-4","bg-gray-50","rounded-lg"],[1,"lg:col-span-4"],["type","text","placeholder","\u641C\u5C0B\u9032\u8CA8\u55AE\u865F\u3001\u54C1\u9805\u6216\u5EE0\u5546...",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"flex","items-center","gap-2"],["for","poStartDate",1,"text-sm","font-medium","text-gray-600","shrink-0"],["type","date","id","poStartDate",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["for","poEndDate",1,"text-sm","font-medium","text-gray-600","shrink-0"],["type","date","id","poEndDate",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"lg:col-span-2"],[1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"flex","items-center","gap-2","lg:col-span-4","justify-end","gap-2"],["title","\u5957\u7528\u7BE9\u9078",1,"bg-indigo-600","text-white","px-3","py-1","rounded","text-sm","hover:bg-indigo-700","transition-colors","flex","items-center","gap-1",3,"click"],["name","checkmark-outline"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"flex","flex-col","sm:flex-row","justify-between","items-center","gap-3","mt-4"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"flex","items-center","justify-center","py-12","text-gray-500"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4","text-red-700"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-4","py-3"],[1,"px-4","py-3","text-right"],[1,"border-b","hover:bg-gray-50","cursor-pointer"],["name","refresh-outline",1,"text-3xl","animate-spin","mr-2"],["name","alert-circle-outline",1,"text-xl"],[1,"border-b","hover:bg-gray-50","cursor-pointer",3,"click"],[1,"px-4","py-2"],[1,"px-4","py-2","font-medium"],[1,"px-4","py-2","text-right"],[1,"px-4","py-2","text-right","font-semibold"],[1,"px-4","py-2","text-gray-600","text-xs"],["colspan","8",1,"text-center","py-8","text-gray-500"],[1,"text-center","py-8","text-gray-500"],[1,"grid","grid-cols-2","gap-4","mb-4"],[1,"bg-blue-50","p-3","rounded-lg"],[1,"text-xs","text-blue-600","font-medium"],[1,"text-xl","font-bold","text-blue-900"],[1,"bg-purple-50","p-3","rounded-lg"],[1,"text-xs","text-purple-600","font-medium"],[1,"text-xl","font-bold","text-purple-900"],[1,"bg-gray-50","p-4","rounded-lg"],[1,"text-xs","text-gray-600","font-medium","mb-4"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-4","items-center"],[1,"flex","items-center","justify-center","lg:col-span-2"],["viewBox","0 0 400 400",1,"w-64","h-64"],[1,"lg:col-span-1"],[1,"text-sm","text-gray-500"],[1,"mt-4","grid","grid-cols-2","md:grid-cols-3","gap-2","text-xs"],[3,"mouseenter","mouseleave"],["stroke-width","2",1,"cursor-pointer","transition-opacity"],[1,"bg-white","border","border-gray-200","rounded-lg","p-3","shadow-sm"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-lg","font-bold","text-blue-600"],[1,"text-sm","text-gray-600"],[1,"w-3","h-3","rounded-full"],[1,"truncate"],[1,"font-medium"],[1,"text-gray-600"],["class","flex flex-col sm:flex-row justify-between items-center gap-3 mt-4",4,"ngIf"],[1,"px-2","py-1","rounded","border","text-sm",3,"click","disabled"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-2xl","max-h-[90vh]","flex","flex-col"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"block"],[1,"text-gray-700"],["formControlName","poNumber",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["type","date","formControlName","date",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","vendorId",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["value","","disabled",""],[1,"font-semibold","pt-4","border-t"],[1,"grid","grid-cols-12","gap-2","px-2","pb-1","text-xs","font-medium","text-gray-500"],[1,"col-span-5"],[1,"col-span-2","text-right"],[1,"col-span-1"],["formArrayName","items",1,"space-y-2"],[1,"grid","grid-cols-12","gap-2","items-center","p-2","rounded-md","bg-gray-50",3,"formGroupName"],["type","button",1,"text-indigo-600","text-sm",3,"click"],[1,"text-right","font-bold","text-lg"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md"],["formControlName","productName","placeholder","\u54C1\u9805\u540D\u7A31",1,"col-span-5","p-1","border","border-gray-300","bg-white","rounded-md","shadow-sm"],["type","number","formControlName","quantity","placeholder","\u6578\u91CF",1,"col-span-2","p-1","border","border-gray-300","bg-white","rounded-md","shadow-sm","text-right"],["type","number","formControlName","unitPrice","placeholder","\u55AE\u50F9",1,"col-span-2","p-1","border","border-gray-300","bg-white","rounded-md","shadow-sm","text-right"],["type","button",1,"col-span-1","text-red-500",3,"click"],["name","remove-circle-outline"],[1,"text-gray-700","text-sm"],["type","date","disabled","",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","bg-gray-100","p-2","cursor-not-allowed","text-gray-600",3,"ngModelChange","ngModel"],["type","text","disabled","",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","bg-gray-100","p-2","cursor-not-allowed","text-gray-600",3,"ngModelChange","ngModel"],["type","text",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","bg-white","p-2",3,"ngModelChange","ngModel"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],["type","number",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","bg-white","p-2","text-right",3,"ngModelChange","ngModel"],["type","number","disabled","",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","bg-gray-100","p-2","text-right","cursor-not-allowed","text-gray-600",3,"ngModelChange","ngModel"],["rows","3",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","bg-white","p-2",3,"ngModelChange","ngModel"],["type","button",1,"px-4","py-2","border","border-gray-300","rounded-md","hover:bg-gray-50",3,"click"],["type","button",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","hover:bg-indigo-700","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"]],template:function(t,i){t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),d(3,"\u9032\u8CA8\u55AE\u7BA1\u7406"),s()(),l(4,"div",3)(5,"div",4)(6,"div",5)(7,"button",6),b("click",function(){return i.setTab("api")}),d(8," \u9032\u8CA8\u55AE\u8CC7\u6599 "),s(),l(9,"button",6),b("click",function(){return i.setTab("analysis")}),d(10," \u9032\u8CA8\u5206\u6790 "),s()(),l(11,"div",7)(12,"div",8)(13,"input",9),b("ngModelChange",function(o){return i.poSearchTerm.set(o)}),s()(),l(14,"div",10)(15,"label",11),d(16,"\u5F9E:"),s(),l(17,"input",12),b("ngModelChange",function(o){return i.poStartDate.set(o)}),s()(),l(18,"div",10)(19,"label",13),d(20,"\u81F3:"),s(),l(21,"input",14),b("ngModelChange",function(o){return i.poEndDate.set(o)}),s()(),l(22,"div",15)(23,"select",16),b("ngModelChange",function(o){return i.selectedPOVendor.set(o)}),l(24,"option",17),d(25,"\u6240\u6709\u5EE0\u5546"),s(),O(26,FB,2,2,"option",18,j2),s()(),l(28,"div",19)(29,"button",20),b("click",function(){return i.applyShipmentFilter()}),x(30,"ion-icon",21),d(31," \u5957\u7528 "),s(),l(32,"button",22),b("click",function(){return i.resetPOFilters()}),x(33,"ion-icon",23),s()()(),M(34,qB,27,3,"div",4),M(35,tU,3,1,"div",4),M(36,iU,1,1,"div",24),s()()(),M(37,aU,50,3,"div",25),M(38,lU,9,1,"div",25)),t&2&&(f(7),W("border-indigo-600",i.currentTab()==="api")("text-indigo-600",i.currentTab()==="api"),f(2),W("border-indigo-600",i.currentTab()==="analysis")("text-indigo-600",i.currentTab()==="analysis"),f(4),I("ngModel",i.poSearchTerm()),f(4),I("ngModel",i.poStartDate()),f(4),I("ngModel",i.poEndDate()),f(2),I("ngModel",i.selectedPOVendor()),f(3),L(i.allVendors()),f(8),A(i.currentTab()==="api"?34:-1),f(),A(i.currentTab()==="analysis"?35:-1),f(),A(i.currentTab()==="api"?36:-1),f(),A(i.isModalOpen()?37:-1),f(),A(i.isEditModalOpen()?38:-1))},dependencies:[oe,ji,ke,Be,Fe,Pe,xe,kt,Re,me,Le,Ue,Ge,wi,Ti,Se,Ie,rl],encapsulation:2,changeDetection:0});var cp=Qa;var uU=()=>[1,2,3,4,5,6,7,8,9,10,11,12],z2=(n,e)=>e.employee_id,dU=(n,e)=>e.record_id,cU=(n,e)=>e.payable_id;function mU(n,e){if(n&1&&(l(0,"option",16),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),k("",t,"\u6708")}}function pU(n,e){if(n&1){let t=B();l(0,"div",3)(1,"div",10)(2,"label",11),d(3,"\u6642\u9593:"),s(),l(4,"select",12),J("ngModelChange",function(r){D(t);let o=_();return K(o.selectedYear,r)||(o.selectedYear=r),w(r)}),b("change",function(){D(t);let r=_();return w(r.onMonthChange())}),l(5,"option",13),d(6,"2024\u5E74"),s(),l(7,"option",14),d(8,"2025\u5E74"),s(),l(9,"option",15),d(10,"2026\u5E74"),s()(),l(11,"select",12),J("ngModelChange",function(r){D(t);let o=_();return K(o.selectedMonth,r)||(o.selectedMonth=r),w(r)}),b("change",function(){D(t);let r=_();return w(r.onMonthChange())}),O(12,mU,2,2,"option",16,j),s()(),l(14,"div",17)(15,"button",18),b("click",function(){D(t);let r=_();return w(r.resetFilter())}),x(16,"ion-icon",19),s()()()}if(n&2){let t=_();f(4),Y("ngModel",t.selectedYear),f(7),Y("ngModel",t.selectedMonth),f(),L(wt(2,uU))}}function fU(n,e){n&1&&(l(0,"div",31)(1,"p",35),d(2,"\u8F09\u5165\u4E2D..."),s()())}function gU(n,e){if(n&1&&(l(0,"div",32)(1,"p",36),d(2),s()()),n&2){let t=_(2);f(2),E(t.monthlyError())}}function hU(n,e){n&1&&(l(0,"span",50),x(1,"ion-icon",58),d(2," \u5DF2\u6838\u5C0D "),s())}function yU(n,e){if(n&1){let t=B();l(0,"button",59),b("click",function(r){D(t);let o=_().$implicit;return _(3).verifyMonthlyShareholder(o),w(r.stopPropagation())}),d(1," \u6838\u5C0D "),s()}}function _U(n,e){n&1&&(l(0,"span",52),x(1,"ion-icon",60),d(2," \u5DF2\u767C\u653E "),s())}function vU(n,e){if(n&1){let t=B();l(0,"button",61),b("click",function(r){D(t);let o=_().$implicit;return _(3).releaseMonthlyShareholder(o),w(r.stopPropagation())}),d(1," \u767C\u653E "),s()}if(n&2){let t=_().$implicit,i=_(3);I("disabled",!i.isMonthlyVerified(t))}}function CU(n,e){if(n&1){let t=B();l(0,"a",62),b("click",function(r){return D(t),w(r.stopPropagation())}),x(1,"ion-icon",63),d(2),s()}if(n&2){let t=_().$implicit;I("href",hn("/ledger?entry_id=",t.entry_id),Ft),f(2),k(" #",t.entry_id," ")}}function xU(n,e){n&1&&(l(0,"span",55),d(1,"-"),s())}function bU(n,e){n&1&&(l(0,"span",57),x(1,"ion-icon",64),d(2," \u4E0B\u8F09\u4E2D "),s())}function EU(n,e){n&1&&(l(0,"span",57),x(1,"ion-icon",65),d(2," \u52DE\u5831\u55AE "),s())}function SU(n,e){if(n&1){let t=B();l(0,"tr",44),b("click",function(){let r=D(t).$implicit,o=_(3);return w(o.openMonthlyDetail(r))}),l(1,"td",45),d(2),s(),l(3,"td",46),d(4),s(),l(5,"td",47),d(6),s(),l(7,"td",48),d(8),s(),l(9,"td",49),M(10,hU,3,0,"span",50)(11,yU,2,0,"button",51),s(),l(12,"td",49),M(13,_U,3,0,"span",52)(14,vU,2,1,"button",53),s(),l(15,"td",49),M(16,CU,3,3,"a",54)(17,xU,2,0,"span",55),s(),l(18,"td",49)(19,"button",56),b("click",function(r){let o=D(t).$implicit,a=_(3);return w(a.downloadLaborReport(o,r))}),M(20,bU,3,0,"span",57)(21,EU,3,0,"span",57),s()()()}if(n&2){let t=e.$implicit,i=_(3);f(2),E(i.formatYearMonth(t.due_month)),f(2),E(t.employee_name),f(2),E(t.phone),f(2),E(i.formatCurrency(t.total_rebate)),f(2),A(i.isMonthlyVerified(t)?10:11),f(3),A(i.isMonthlyReleased(t)?13:14),f(3),A(t.entry_id?16:17),f(3),W("bg-green-600",!i.isDownloadingReport(t))("text-white",!i.isDownloadingReport(t))("hover:bg-green-700",!i.isDownloadingReport(t))("bg-gray-300",i.isDownloadingReport(t))("text-gray-600",i.isDownloadingReport(t))("cursor-not-allowed",i.isDownloadingReport(t)),I("disabled",i.isDownloadingReport(t)),f(),A(i.isDownloadingReport(t)?20:21)}}function DU(n,e){if(n&1&&(l(0,"div",33)(1,"div",37)(2,"table",38)(3,"thead",39)(4,"tr")(5,"th",40),d(6,"\u6708\u4EFD"),s(),l(7,"th",40),d(8,"\u80A1\u6771\u540D\u7A31"),s(),l(9,"th",41),d(10,"\u96FB\u8A71"),s(),l(11,"th",42),d(12,"\u7E3D\u56DE\u994B\u91D1"),s(),l(13,"th",41),d(14,"\u6838\u5C0D"),s(),l(15,"th",41),d(16,"\u767C\u653E"),s(),l(17,"th",41),d(18,"\u6D41\u6C34\u5E33"),s(),l(19,"th",41),d(20,"\u52DE\u5831\u55AE"),s()()(),l(21,"tbody"),O(22,SU,22,21,"tr",43,z2),s()()()()),n&2){let t=_(2);f(22),L(t.monthlySummaries())}}function wU(n,e){n&1&&(l(0,"div",34)(1,"p",35),d(2,"\u6B64\u6708\u4EFD\u7121\u80A1\u6771\u56DE\u994B\u91D1\u8CC7\u6599"),s()())}function TU(n,e){if(n&1&&(l(0,"div",0)(1,"div",20)(2,"div",21)(3,"div",22),x(4,"ion-icon",23),s(),l(5,"div")(6,"p",24),d(7,"\u4EBA\u6578"),s(),l(8,"p",25),d(9),s()()(),l(10,"div",21)(11,"div",22),x(12,"ion-icon",26),s(),l(13,"div")(14,"p",24),d(15,"\u7E3D\u56DE\u994B\u91D1"),s(),l(16,"p",25),d(17),s()()(),l(18,"div",21)(19,"div",27),x(20,"ion-icon",28),s(),l(21,"div")(22,"p",24),d(23,"\u5DF2\u6838\u5C0D"),s(),l(24,"p",25),d(25),s()()(),l(26,"div",21)(27,"div",29),x(28,"ion-icon",30),s(),l(29,"div")(30,"p",24),d(31,"\u5DF2\u767C\u653E"),s(),l(32,"p",25),d(33),s()()()(),M(34,fU,3,0,"div",31),M(35,gU,3,1,"div",32),M(36,DU,24,0,"div",33),M(37,wU,3,0,"div",34),s()),n&2){let t=_();f(9),E(t.monthlyStats().transaction_count),f(8),E(t.formatCurrency(t.monthlyStats().total_rebate)),f(8),E(t.monthlyStats().verified_count),f(8),E(t.monthlyStats().released_count),f(),A(t.monthlyLoading()?34:-1),f(),A(t.monthlyError()?35:-1),f(),A(!t.monthlyLoading()&&t.monthlySummaries().length>0?36:-1),f(),A(!t.monthlyLoading()&&t.monthlySummaries().length===0?37:-1)}}function IU(n,e){n&1&&(l(0,"div",31)(1,"p",35),d(2,"\u8F09\u5165\u4E2D..."),s()())}function MU(n,e){if(n&1&&(l(0,"div",32)(1,"p",36),d(2),s()()),n&2){let t=_(2);f(2),E(t.payablesError())}}function AU(n,e){if(n&1){let t=B();l(0,"tr",71)(1,"td",46),d(2),s(),l(3,"td",47),d(4),s(),l(5,"td",48),d(6),s(),l(7,"td",72),d(8),s(),l(9,"td",73),d(10),s(),l(11,"td",49)(12,"button",74),b("click",function(){let r=D(t).$implicit,o=_(3);return w(o.openPayablesDetail(r))}),d(13," \u6708\u5EA6\u660E\u7D30 "),s()()()}if(n&2){let t=e.$implicit,i=_(3);f(2),E(t.employee_name),f(2),E(t.phone),f(2),E(i.formatCurrency(t.total_payable)),f(2),E(i.formatCurrency(t.pending_amount)),f(2),E(i.formatCurrency(t.paid_amount))}}function RU(n,e){if(n&1&&(l(0,"div",33)(1,"div",37)(2,"table",38)(3,"thead",39)(4,"tr")(5,"th",40),d(6,"\u80A1\u6771\u540D\u7A31"),s(),l(7,"th",41),d(8,"\u96FB\u8A71"),s(),l(9,"th",42),d(10,"\u7D2F\u7A4D\u61C9\u4ED8\u56DE\u994B\u91D1"),s(),l(11,"th",42),d(12,"\u5F85\u767C\u653E"),s(),l(13,"th",42),d(14,"\u5DF2\u767C\u653E"),s(),l(15,"th",41),d(16,"\u64CD\u4F5C"),s()()(),l(17,"tbody"),O(18,AU,14,5,"tr",71,z2),s()()()()),n&2){let t=_(2);f(18),L(t.payablesSummary().employees)}}function NU(n,e){n&1&&(l(0,"div",34)(1,"p",35),d(2,"\u76EE\u524D\u7121\u61C9\u4ED8\u56DE\u994B\u91D1"),s()())}function FU(n,e){if(n&1&&(l(0,"div",0)(1,"div",66)(2,"div",67)(3,"div")(4,"p",68),d(5,"\u61C9\u4ED8\u56DE\u994B\u91D1\u7E3D\u984D"),s(),l(6,"p",2),d(7),s()(),l(8,"div",69),x(9,"ion-icon",70),s()()(),M(10,IU,3,0,"div",31),M(11,MU,3,1,"div",32),M(12,RU,20,0,"div",33),M(13,NU,3,0,"div",34),s()),n&2){let t=_();f(7),E(t.formatCurrency(t.payablesSummary().total_payable)),f(3),A(t.payablesLoading()?10:-1),f(),A(t.payablesError()?11:-1),f(),A(!t.payablesLoading()&&t.payablesSummary().employees.length>0?12:-1),f(),A(!t.payablesLoading()&&t.payablesSummary().employees.length===0?13:-1)}}function PU(n,e){n&1&&(l(0,"div",31)(1,"p",35),d(2,"\u8F09\u5165\u4E2D..."),s()())}function kU(n,e){n&1&&d(0," \u65B0\u589E\u4E2D ")}function VU(n,e){n&1&&d(0," \u78BA\u5B9A ")}function OU(n,e){if(n&1){let t=B();l(0,"div",82)(1,"div",86)(2,"div")(3,"label",87),d(4,"\u7D50\u5E33\u6642\u9593"),s(),l(5,"input",88),J("ngModelChange",function(r){D(t);let o=_(2);return K(o.newDetailCheckoutAt,r)||(o.newDetailCheckoutAt=r),w(r)}),s()(),l(6,"div")(7,"label",87),d(8,"\u767C\u7968\u865F\u78BC (\u9078\u586B)"),s(),l(9,"input",89),J("ngModelChange",function(r){D(t);let o=_(2);return K(o.newDetailInvoiceNo,r)||(o.newDetailInvoiceNo=r),w(r)}),s()(),l(10,"div")(11,"label",87),d(12,"\u6298\u6263\u91D1\u984D"),s(),l(13,"input",90),J("ngModelChange",function(r){D(t);let o=_(2);return K(o.newDetailDiscountAmount,r)||(o.newDetailDiscountAmount=r),w(r)}),s()(),l(14,"div")(15,"label",87),d(16,"\u767C\u7968\u91D1\u984D"),s(),l(17,"input",91),J("ngModelChange",function(r){D(t);let o=_(2);return K(o.newDetailInvoiceAmount,r)||(o.newDetailInvoiceAmount=r),w(r)}),s()(),l(18,"div")(19,"label",87),d(20,"\u56DE\u994B%"),s(),l(21,"input",92),J("ngModelChange",function(r){D(t);let o=_(2);return K(o.newDetailRebateRate,r)||(o.newDetailRebateRate=r),w(r)}),s()(),l(22,"div")(23,"label",87),d(24,"\u4F7F\u7528\u6298\u6263"),s(),l(25,"input",93),J("ngModelChange",function(r){D(t);let o=_(2);return K(o.newDetailDiscountNote,r)||(o.newDetailDiscountNote=r),w(r)}),s()(),l(26,"div",94)(27,"button",95),b("click",function(){D(t);let r=_(2);return w(r.submitAddDetail())}),M(28,kU,1,0)(29,VU,1,0),s(),l(30,"button",96),b("click",function(){D(t);let r=_(2);return w(r.closeAddDetail())}),d(31," \u53D6\u6D88 "),s()()()()}if(n&2){let t=_(2);f(5),Y("ngModel",t.newDetailCheckoutAt),f(4),Y("ngModel",t.newDetailInvoiceNo),f(4),Y("ngModel",t.newDetailDiscountAmount),f(4),Y("ngModel",t.newDetailInvoiceAmount),f(4),Y("ngModel",t.newDetailRebateRate),f(4),Y("ngModel",t.newDetailDiscountNote),f(2),I("disabled",t.addDetailSaving()),f(),A(t.addDetailSaving()?28:29)}}function LU(n,e){if(n&1&&(l(0,"div",83)(1,"p",36),d(2),s()()),n&2){let t=_(2);f(2),E(t.addDetailError())}}function BU(n,e){if(n&1&&(l(0,"div",83)(1,"p",36),d(2),s()()),n&2){let t=_(2);f(2),E(t.detailSaveError())}}function UU(n,e){n&1&&d(0," \u5132\u5B58\u4E2D ")}function $U(n,e){n&1&&d(0," \u5132\u5B58 ")}function HU(n,e){n&1&&d(0," \u522A\u9664\u4E2D ")}function GU(n,e){n&1&&d(0," \u522A\u9664 ")}function qU(n,e){if(n&1){let t=B();l(0,"tr",101)(1,"td",105),d(2),s(),l(3,"td",106),d(4),s(),l(5,"td",107),d(6),s(),l(7,"td",108)(8,"input",109),b("ngModelChange",function(r){let o=D(t).$implicit,a=_(3);return w(a.updateDetailInvoiceAmount(o,r))}),s()(),l(9,"td",110)(10,"div",111)(11,"input",112),b("ngModelChange",function(r){let o=D(t).$implicit,a=_(3);return w(a.updateDetailRebateRate(o,r))}),s(),l(12,"span",113),d(13,"%"),s()()(),l(14,"td",114),d(15),s(),l(16,"td",115),d(17),s(),l(18,"td",116)(19,"input",117),b("ngModelChange",function(r){let o=D(t).$implicit,a=_(3);return w(a.updateDetailRemark(o,r))}),s()(),l(20,"td",110)(21,"div",118)(22,"button",119),b("click",function(){let r=D(t).$implicit,o=_(3);return w(o.saveDetailRebate(r))}),M(23,UU,1,0)(24,$U,1,0),s(),l(25,"button",120),b("click",function(){let r=D(t).$implicit,o=_(3);return w(o.deleteDetail(r))}),M(26,HU,1,0)(27,GU,1,0),s()()()()}if(n&2){let t=e.$implicit,i=_(3);f(2),E(i.formatDate(t.checkout_at)),f(2),E(t.invoice_no),f(2),E(i.formatCurrency(t.discount_amount)),f(2),I("ngModel",t.invoice_amount),f(3),I("ngModel",t.rebate_rate),f(4),E(i.formatCurrency(t.rebate_amount)),f(2),E(t.discount_note),f(2),I("ngModel",t.remark||""),f(3),I("disabled",t.record_id<0||i.isDetailSaving(t.record_id)),f(),A(i.isDetailSaving(t.record_id)?23:24),f(2),I("disabled",i.isDetailDeleting(t.record_id)),f(),A(i.isDetailDeleting(t.record_id)?26:27)}}function WU(n,e){if(n&1&&(l(0,"div",37)(1,"table",38)(2,"thead",97)(3,"tr")(4,"th",98),d(5,"\u7D50\u5E33\u6642\u9593"),s(),l(6,"th",98),d(7,"\u767C\u7968\u865F\u78BC"),s(),l(8,"th",99),d(9,"\u6298\u6263\u91D1\u984D"),s(),l(10,"th",99),d(11,"\u767C\u7968\u91D1\u984D"),s(),l(12,"th",100),d(13,"\u56DE\u994B%"),s(),l(14,"th",99),d(15,"\u56DE\u994B\u91D1"),s(),l(16,"th",98),d(17,"\u4F7F\u7528\u6298\u6263"),s(),l(18,"th",98),d(19,"\u5099\u8A3B"),s(),l(20,"th",100),d(21,"\u64CD\u4F5C"),s()()(),l(22,"tbody"),O(23,qU,28,12,"tr",101,dU),s(),l(25,"tfoot",102)(26,"tr")(27,"td",103),d(28,"\u5C0F\u8A08:"),s(),l(29,"td",104),d(30),s(),x(31,"td")(32,"td")(33,"td"),s()()()()),n&2){let t=_(2);f(23),L(t.monthlyDetails()),f(7),k(" ",t.formatCurrency(t.monthlyDetailsTotal())," ")}}function jU(n,e){n&1&&(l(0,"div",31)(1,"p",35),d(2,"\u6B64\u6708\u4EFD\u7121\u56DE\u994B\u91D1\u660E\u7D30"),s()())}function zU(n,e){if(n&1){let t=B();l(0,"div",8)(1,"div",75)(2,"div",76)(3,"h2",77),d(4),s(),l(5,"div",10)(6,"button",78),b("click",function(){D(t);let r=_();return w(r.openAddDetail())}),d(7," \u65B0\u589E\u7D30\u9805 "),s(),l(8,"button",79),b("click",function(){D(t);let r=_();return w(r.closeMonthlyDetail())}),x(9,"ion-icon",80),s()()(),l(10,"div",81),M(11,PU,3,0,"div",31),M(12,OU,32,8,"div",82),M(13,LU,3,1,"div",83),M(14,BU,3,1,"div",83),M(15,WU,34,1,"div",37),M(16,jU,3,0,"div",31),s(),l(17,"div",84)(18,"button",85),b("click",function(){D(t);let r=_();return w(r.closeMonthlyDetail())}),d(19," \u95DC\u9589 "),s()()()()}if(n&2){let t=e,i=_();f(4),Ke("\u56DE\u994B\u91D1\u7D30\u9805 - ",t.employee_name," (",i.formatYearMonth(t.due_month),")"),f(7),A(i.monthlyDetailLoading()?11:-1),f(),A(i.addDetailVisible()?12:-1),f(),A(i.addDetailError()?13:-1),f(),A(i.detailSaveError()?14:-1),f(),A(!i.monthlyDetailLoading()&&i.monthlyDetails().length>0?15:-1),f(),A(!i.monthlyDetailLoading()&&i.monthlyDetails().length===0?16:-1)}}function YU(n,e){n&1&&(l(0,"div",31)(1,"p",35),d(2,"\u8F09\u5165\u4E2D..."),s()())}function JU(n,e){n&1&&(l(0,"span",125),d(1,"\u5DF2\u767C\u653E"),s())}function KU(n,e){n&1&&(l(0,"span",126),d(1,"\u5F85\u767C\u653E"),s())}function QU(n,e){if(n&1&&(l(0,"span",127),d(1),s()),n&2){let t=_().$implicit;f(),E(t.status)}}function ZU(n,e){if(n&1&&(l(0,"tr",101)(1,"td",106),d(2),s(),l(3,"td",114),d(4),s(),l(5,"td",123),d(6),s(),l(7,"td",124),d(8),s(),l(9,"td",110),M(10,JU,2,0,"span",125)(11,KU,2,0,"span",126)(12,QU,2,1,"span",127),s()()),n&2){let t=e.$implicit,i=_(3);f(2),E(i.formatYearMonth(t.due_month)),f(2),E(i.formatCurrency(t.rebate_amount)),f(2),E(i.formatCurrency(t.actual_paid)),f(),W("text-yellow-600",t.pending_balance>0)("text-gray-600",t.pending_balance<=0),f(),k(" ",i.formatCurrency(t.pending_balance)," "),f(2),A(t.status==="paid"?10:t.status==="pending"?11:12)}}function XU(n,e){if(n&1&&(l(0,"div",37)(1,"table",38)(2,"thead",97)(3,"tr")(4,"th",98),d(5,"\u65E5\u671F"),s(),l(6,"th",99),d(7,"\u56DE\u994B\u91D1\u984D"),s(),l(8,"th",99),d(9,"\u5BE6\u969B\u4ED8\u6B3E"),s(),l(10,"th",99),d(11,"\u61C9\u4ED8\u9918\u984D"),s(),l(12,"th",100),d(13,"\u72C0\u614B"),s()()(),l(14,"tbody"),O(15,ZU,13,9,"tr",101,cU),s(),l(17,"tfoot",102)(18,"tr")(19,"td",114),d(20,"\u5408\u8A08:"),s(),l(21,"td",104),d(22),s(),l(23,"td",121),d(24),s(),l(25,"td",122),d(26),s(),x(27,"td"),s()()()()),n&2){let t=_(2);f(15),L(t.payablesDetails()),f(7),k(" ",t.formatCurrency(t.payablesDetailsRebateAmount())," "),f(2),k(" ",t.formatCurrency(t.payablesDetailsActualPaid())," "),f(2),k(" ",t.formatCurrency(t.payablesDetailsPendingBalance())," ")}}function e$(n,e){n&1&&(l(0,"div",31)(1,"p",35),d(2,"\u6B64\u54E1\u5DE5\u7121\u61C9\u4ED8\u56DE\u994B\u91D1\u8A18\u9304"),s()())}function t$(n,e){if(n&1){let t=B();l(0,"div",8)(1,"div",75)(2,"div",76)(3,"h2",77),d(4),s(),l(5,"button",79),b("click",function(){D(t);let r=_();return w(r.closePayablesDetail())}),x(6,"ion-icon",80),s()(),l(7,"div",81),M(8,YU,3,0,"div",31),M(9,XU,28,3,"div",37),M(10,e$,3,0,"div",31),s(),l(11,"div",84)(12,"button",85),b("click",function(){D(t);let r=_();return w(r.closePayablesDetail())}),d(13," \u95DC\u9589 "),s()()()()}if(n&2){let t=_();f(4),k("\u61C9\u4ED8\u56DE\u994B\u91D1\u6708\u5EA6\u660E\u7D30 - ",e.employee_name),f(4),A(t.payablesDetailLoading()?8:-1),f(),A(!t.payablesDetailLoading()&&t.payablesDetails().length>0?9:-1),f(),A(!t.payablesDetailLoading()&&t.payablesDetails().length===0?10:-1)}}function n$(n,e){if(n&1&&(l(0,"div",147)(1,"div",149),x(2,"ion-icon",150),l(3,"div",151)(4,"p",152),d(5,"\u90E8\u5206\u767C\u653E\u901A\u77E5"),s(),l(6,"p",153),d(7),s()()()()),n&2){let t=_(),i=_(2);f(7),Ke(" \u5C07\u767C\u653E ",i.formatCurrency(i.Number(i.releaseAmount)),"\uFF0C\u5269\u9918\u672A\u4ED8 ",i.formatCurrency(t.total_rebate-i.Number(i.releaseAmount))," \u5C07\u8A18\u9304\u70BA\u61C9\u4ED8\u56DE\u994B\u91D1\u3002 ")}}function i$(n,e){if(n&1&&(l(0,"div",148)(1,"div",149),x(2,"ion-icon",154),l(3,"p",155),d(4),s()()()),n&2){let t=_(3);f(4),E(t.releaseError())}}function r$(n,e){if(n&1){let t=B();l(0,"div",133)(1,"div",138)(2,"div",139)(3,"div")(4,"span",113),d(5,"\u54E1\u5DE5\u59D3\u540D\uFF1A"),s(),l(6,"span",140),d(7),s()(),l(8,"div")(9,"span",113),d(10,"\u6708\u4EFD\uFF1A"),s(),l(11,"span",140),d(12),s()(),l(13,"div",141)(14,"span",113),d(15,"\u56DE\u994B\u91D1\u7E3D\u984D\uFF1A"),s(),l(16,"span",142),d(17),s()()()(),l(18,"div")(19,"label",143),d(20," \u767C\u653E\u91D1\u984D "),l(21,"span",144),d(22,"*"),s()(),l(23,"input",145),J("ngModelChange",function(r){D(t);let o=_(2);return K(o.releaseAmount,r)||(o.releaseAmount=r),w(r)}),s(),l(24,"p",146),d(25),s()(),M(26,n$,8,2,"div",147),M(27,i$,5,1,"div",148),s()}if(n&2){let t=e,i=_(2);f(7),E(t.employee_name),f(5),E(i.formatYearMonth(t.due_month)),f(5),E(i.formatCurrency(t.total_rebate)),f(6),Y("ngModel",i.releaseAmount),I("max",t.total_rebate),f(2),k(" \u53EF\u767C\u653E\u91D1\u984D\u6700\u591A\u70BA ",i.formatCurrency(t.total_rebate)," "),f(),A(i.Number(i.releaseAmount)<t.total_rebate&&i.Number(i.releaseAmount)>0?26:-1),f(),A(i.releaseError()?27:-1)}}function o$(n,e){n&1&&(l(0,"span",137),d(1,"\u23F3"),s())}function a$(n,e){if(n&1){let t=B();l(0,"div",9)(1,"div",128)(2,"div",129)(3,"h3",130),x(4,"ion-icon",131),d(5," \u767C\u653E\u80A1\u6771\u56DE\u994B\u91D1 "),s()(),l(6,"div",132),M(7,r$,28,8,"div",133),s(),l(8,"div",134)(9,"button",135),b("click",function(){D(t);let r=_();return w(r.closeReleaseModal())}),d(10," \u53D6\u6D88 "),s(),l(11,"button",136),b("click",function(){D(t);let r=_();return w(r.submitRelease())}),M(12,o$,2,0,"span",137),d(13," \u78BA\u8A8D\u767C\u653E "),s()()()()}if(n&2){let t,i=_();f(7),A((t=i.releasingMonthlySummary())?7:-1,t),f(2),I("disabled",i.releasing()),f(2),I("disabled",i.releasing()),f(),A(i.releasing()?12:-1)}}var Za=class Za{constructor(){this.apiService=P(Xe);this.activeTab=S("monthly");this.currentDate=new Date;this.previousMonth=this.getPreviousMonth();this.selectedYear=S(this.previousMonth.year);this.selectedMonth=S(this.previousMonth.month);this.monthlySummaries=S([]);this.monthlyLoading=S(!1);this.monthlyError=S("");this.monthlyStats=S({transaction_count:0,total_rebate:0,verified_count:0,released_count:0});this.monthlyDetailModalVisible=S(!1);this.currentMonthlySummary=S(null);this.monthlyDetails=S([]);this.monthlyDetailLoading=S(!1);this.addDetailVisible=S(!1);this.detailSavingIds=S([]);this.detailDeletingIds=S([]);this.detailSaveError=S("");this.addDetailError=S("");this.addDetailSaving=S(!1);this.newDetailCheckoutAt="";this.newDetailInvoiceNo="";this.newDetailDiscountAmount="";this.newDetailInvoiceAmount="";this.newDetailRebateRate="";this.newDetailDiscountNote="";this.monthlyDetailsTotal=H(()=>this.monthlyDetails().reduce((e,t)=>e+Number(t.rebate_amount||0),0));this.releaseModalVisible=S(!1);this.releasingMonthlySummary=S(null);this.releaseAmount="";this.releasing=S(!1);this.releaseError=S("");this.downloadingReports=S(new Set);this.payablesSummary=S({total_payable:0,employees:[]});this.payablesLoading=S(!1);this.payablesError=S("");this.payablesDetailModalVisible=S(!1);this.currentPayableEmployee=S(null);this.payablesDetails=S([]);this.payablesDetailLoading=S(!1);this.payablesDetailsRebateAmount=H(()=>this.payablesDetails().reduce((e,t)=>e+t.rebate_amount,0));this.payablesDetailsActualPaid=H(()=>this.payablesDetails().reduce((e,t)=>e+t.actual_paid,0));this.payablesDetailsPendingBalance=H(()=>this.payablesDetails().reduce((e,t)=>e+t.pending_balance,0));$n(()=>{let e=this.activeTab();e==="monthly"?this.loadMonthlySummary():e==="payables"&&this.loadPayablesSummary()})}async loadMonthlySummary(){this.monthlyLoading.set(!0),this.monthlyError.set("");try{let e=await this.apiService.getShareholderMonthlySummary({year:this.selectedYear(),month:this.selectedMonth()});e.success&&e.data?this.monthlySummaries.set(e.data):this.monthlyError.set(e.error||"\u8F09\u5165\u8CC7\u6599\u5931\u6557");let t=await this.apiService.getShareholderMonthlyStats({year:this.selectedYear(),month:this.selectedMonth()});t.success&&t.data&&this.monthlyStats.set(t.data)}catch(e){this.monthlyError.set(e?.message||"\u8F09\u5165\u5931\u6557"),console.error("Error loading monthly summary:",e)}finally{this.monthlyLoading.set(!1)}}async openMonthlyDetail(e){this.currentMonthlySummary.set(e),this.monthlyDetailModalVisible.set(!0),this.monthlyDetailLoading.set(!0),this.addDetailVisible.set(!1);try{let t=await this.apiService.getShareholderMonthlyDetail(e.employee_id,{year:this.selectedYear(),month:this.selectedMonth()});t.success&&t.data&&this.monthlyDetails.set(t.data)}catch(t){console.error("Error loading monthly details:",t)}finally{this.monthlyDetailLoading.set(!1)}}closeMonthlyDetail(){this.monthlyDetailModalVisible.set(!1),this.currentMonthlySummary.set(null),this.monthlyDetails.set([]),this.addDetailVisible.set(!1)}openAddDetail(){this.newDetailCheckoutAt=this.formatDateTimeLocal(new Date),this.newDetailInvoiceNo="",this.newDetailDiscountAmount="",this.newDetailInvoiceAmount="",this.newDetailRebateRate="",this.newDetailDiscountNote="",this.addDetailError.set(""),this.addDetailSaving.set(!1),this.addDetailVisible.set(!0)}closeAddDetail(){this.addDetailVisible.set(!1)}async submitAddDetail(){let e=this.newDetailCheckoutAt,t=this.newDetailInvoiceNo.trim(),i=Number(String(this.newDetailDiscountAmount).replace(/,/g,"")),r=Number(String(this.newDetailInvoiceAmount).replace(/,/g,"")),o=Number(this.newDetailRebateRate);if(!e){this.addDetailError.set("\u8ACB\u586B\u5BEB\u7D50\u5E33\u6642\u9593");return}if(Number.isNaN(r)){this.addDetailError.set("\u8ACB\u586B\u5BEB\u6709\u6548\u7684\u767C\u7968\u91D1\u984D");return}this.addDetailError.set(""),this.addDetailSaving.set(!0);let a=new Date(e).toISOString(),u=Number.isNaN(i)?0:i,c=Number.isNaN(o)?0:o,m={employee_id:this.currentMonthlySummary()?.employee_id||0,checkout_at:a,invoice_no:t||null,invoice_amount:r,taxable_amount:r,discount_amount:u,discount_note:this.newDetailDiscountNote.trim()||"\u7121",rebate_rate:c,rebate_amount:this.roundTo2(r*(c/100))};try{if(!m.employee_id){this.addDetailError.set("\u627E\u4E0D\u5230\u54E1\u5DE5\u8CC7\u6599\uFF0C\u7121\u6CD5\u65B0\u589E");return}let h=await this.apiService.createShareholderRebateRecord(m);if(h.success&&h.data){let y=this.currentMonthlySummary();y&&await this.openMonthlyDetail(y),this.addDetailVisible.set(!1)}else this.addDetailError.set(h.error||"\u65B0\u589E\u5931\u6557")}catch(h){this.addDetailError.set(h?.message||"\u65B0\u589E\u5931\u6557"),console.error("Error creating rebate detail:",h)}finally{this.addDetailSaving.set(!1)}}updateDetailRebateRate(e,t){let i=Number(t),r=Number(e.invoice_amount||0),o=Number.isNaN(i)?0:i;e.rebate_rate=o,e.rebate_amount=this.roundTo2(r*(o/100)),this.monthlyDetails.set([...this.monthlyDetails()])}updateDetailInvoiceAmount(e,t){let i=Number(t),r=Number.isNaN(i)?0:i,o=Number(e.rebate_rate||0);e.invoice_amount=r,e.rebate_amount=this.roundTo2(r*(o/100)),this.monthlyDetails.set([...this.monthlyDetails()])}updateDetailRemark(e,t){e.remark=t,this.monthlyDetails.set([...this.monthlyDetails()])}isDetailSaving(e){return this.detailSavingIds().includes(e)}isDetailDeleting(e){return this.detailDeletingIds().includes(e)}async saveDetailRebate(e){if(!e.record_id||e.record_id<0)return;let t=Number(e.rebate_rate||0),i=Number(e.rebate_amount||0),r=Number(e.invoice_amount||0);if(Number.isNaN(t)||t<0||t>100){this.detailSaveError.set("\u56DE\u994B% \u5FC5\u9808\u4ECB\u65BC 0 \u5230 100");return}if(Number.isNaN(r)||r<0){this.detailSaveError.set("\u767C\u7968\u91D1\u984D\u5FC5\u9808\u70BA\u6B63\u6578");return}this.detailSaveError.set(""),this.detailSavingIds.set([...this.detailSavingIds(),e.record_id]);try{let o=await this.apiService.updateShareholderRebateRecord(e.record_id,{rebate_rate:t,rebate_amount:i,invoice_amount:r,remark:e.remark||null});if(o.success&&o.data){let a=o.data,u=this.monthlyDetails().map(c=>c.record_id===e.record_id?G(V({},c),{rebate_rate:Number(a.rebate_rate??c.rebate_rate),rebate_amount:Number(a.rebate_amount??c.rebate_amount),invoice_amount:Number(a.invoice_amount??c.invoice_amount),remark:a.remark??c.remark}):c);this.monthlyDetails.set(u)}else this.detailSaveError.set(o.error||"\u5132\u5B58\u5931\u6557")}catch(o){this.detailSaveError.set(o?.message||"\u5132\u5B58\u5931\u6557"),console.error("Error saving rebate detail:",o)}finally{this.detailSavingIds.set(this.detailSavingIds().filter(o=>o!==e.record_id))}}async deleteDetail(e){if(!(!e.record_id||!window.confirm("\u78BA\u5B9A\u8981\u522A\u9664\u9019\u7B46\u56DE\u994B\u91D1\u7D30\u9805\u55CE\uFF1F"))){if(e.record_id<0){this.monthlyDetails.set(this.monthlyDetails().filter(i=>i.record_id!==e.record_id));return}this.detailSaveError.set(""),this.detailDeletingIds.set([...this.detailDeletingIds(),e.record_id]);try{let i=await this.apiService.deleteShareholderRebateRecord(e.record_id);if(i.success){let r=this.currentMonthlySummary();r?await this.openMonthlyDetail(r):this.monthlyDetails.set(this.monthlyDetails().filter(o=>o.record_id!==e.record_id))}else this.detailSaveError.set(i.error||"\u522A\u9664\u5931\u6557")}catch(i){this.detailSaveError.set(i?.message||"\u522A\u9664\u5931\u6557"),console.error("Error deleting rebate detail:",i)}finally{this.detailDeletingIds.set(this.detailDeletingIds().filter(i=>i!==e.record_id))}}}onMonthChange(){this.activeTab()==="monthly"&&this.loadMonthlySummary()}async loadPayablesSummary(){this.payablesLoading.set(!0),this.payablesError.set("");try{let e=await this.apiService.getShareholderPayablesSummary();e.success&&e.data?this.payablesSummary.set({total_payable:e.data.total_payable||0,employees:e.data.employees||[]}):this.payablesError.set(e.error||"\u8F09\u5165\u8CC7\u6599\u5931\u6557")}catch(e){this.payablesError.set(e?.message||"\u8F09\u5165\u5931\u6557"),console.error("Error loading payables summary:",e)}finally{this.payablesLoading.set(!1)}}async openPayablesDetail(e){this.currentPayableEmployee.set(e),this.payablesDetailModalVisible.set(!0),this.payablesDetailLoading.set(!0);try{let t=await this.apiService.getShareholderPayablesDetail(e.employee_id);t.success&&t.data&&this.payablesDetails.set(t.data)}catch(t){console.error("Error loading payables details:",t)}finally{this.payablesDetailLoading.set(!1)}}closePayablesDetail(){this.payablesDetailModalVisible.set(!1),this.currentPayableEmployee.set(null),this.payablesDetails.set([])}resetFilter(){this.selectedYear.set(new Date().getFullYear()),this.selectedMonth.set(new Date().getMonth()+1),this.onMonthChange()}formatCurrency(e){return new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e||0)}formatDate(e){return e?new Date(e).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-"}formatYearMonth(e){return e?new Date(e).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit"}):"-"}roundTo2(e){return Math.round((e+Number.EPSILON)*100)/100}formatDateTimeLocal(e){let t=c=>String(c).padStart(2,"0"),i=e.getFullYear(),r=t(e.getMonth()+1),o=t(e.getDate()),a=t(e.getHours()),u=t(e.getMinutes());return`${i}-${r}-${o}T${a}:${u}`}getPreviousMonth(){let e=new Date,t=e.getMonth()+1,i=e.getFullYear();return t===1?(t=12,i--):t--,{year:i,month:t}}async verifyMonthlyShareholder(e){try{console.log("Verifying monthly rebate for employee:",e.employee_id),e.is_verified=!0,await this.loadMonthlySummary()}catch(t){console.error("Error verifying monthly rebate:",t)}}async releaseMonthlyShareholder(e){this.openReleaseModal(e)}isMonthlyVerified(e){return e.verified_amount>0&&e.verified_amount>=e.total_rebate}isMonthlyReleased(e){return e.released_amount>0&&e.released_amount>=e.total_rebate}openReleaseModal(e){this.releasingMonthlySummary.set(e),this.releaseAmount=String(e.total_rebate),this.releaseError.set(""),this.releasing.set(!1),this.releaseModalVisible.set(!0)}closeReleaseModal(){this.releaseModalVisible.set(!1),this.releasingMonthlySummary.set(null),this.releaseAmount="",this.releaseError.set("")}async submitRelease(){let e=this.releasingMonthlySummary();if(!e)return;let t=Number(String(this.releaseAmount).replace(/,/g,""));if(Number.isNaN(t)||t<=0){this.releaseError.set("\u8ACB\u8F38\u5165\u6709\u6548\u7684\u767C\u653E\u91D1\u984D");return}if(t>e.total_rebate){this.releaseError.set("\u767C\u653E\u91D1\u984D\u4E0D\u53EF\u5927\u65BC\u7E3D\u56DE\u994B\u91D1");return}this.releaseError.set(""),this.releasing.set(!0);try{let i=await this.apiService.releaseShareholderRebate({employee_id:e.employee_id,year:this.selectedYear(),month:this.selectedMonth(),employee_name:e.employee_name,total_rebate:e.total_rebate,release_amount:t});i.success?(this.closeReleaseModal(),await this.loadMonthlySummary()):this.releaseError.set(i.error||"\u767C\u653E\u5931\u6557")}catch(i){this.releaseError.set(i?.message||"\u767C\u653E\u5931\u6557"),console.error("Error releasing rebate:",i)}finally{this.releasing.set(!1)}}async downloadLaborReport(e,t){t.stopPropagation();let i=`${e.employee_id}-${this.selectedYear()}-${this.selectedMonth()}`;if(this.downloadingReports().has(i))return;let r=new Set(this.downloadingReports());r.add(i),this.downloadingReports.set(r);try{let o=`${this.selectedYear()}-${String(this.selectedMonth()).padStart(2,"0")}`,a=await this.apiService.downloadLaborReportByEmployeeId(e.employee_id,o),u=a.body||new Blob,c=a.headers.get("Content-Disposition")||"",m=c.match(/filename\*=UTF-8''([^;]+)/i),h=c.match(/filename="?([^";]+)"?/i),y="labor-report.zip";if(m?.[1])try{y=decodeURIComponent(m[1])}catch{y=m[1]}else h?.[1]&&(y=h[1]);let v=window.URL.createObjectURL(u),C=document.createElement("a");C.href=v,C.download=y,document.body.appendChild(C),C.click(),document.body.removeChild(C),window.URL.revokeObjectURL(v)}catch(o){alert("\u4E0B\u8F09\u52DE\u5831\u55AE\u5931\u6557: "+(o?.message||"\u672A\u77E5\u932F\u8AA4")),console.error("Error downloading labor report:",o)}finally{let o=new Set(this.downloadingReports());o.delete(i),this.downloadingReports.set(o)}}isDownloadingReport(e){let t=`${e.employee_id}-${this.selectedYear()}-${this.selectedMonth()}`;return this.downloadingReports().has(t)}};Za.\u0275fac=function(t){return new(t||Za)},Za.\u0275cmp=re({type:Za,selectors:[["app-shareholder-rebates"]],decls:17,vars:18,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-start","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"flex","flex-col","sm:flex-row","items-center","gap-2","bg-white","p-3","rounded-xl","shadow-md","border","border-gray-200"],[1,"flex","gap-4","border-b","border-gray-200"],[1,"px-4","py-3","text-sm","font-medium","text-gray-600","hover:text-gray-900","transition-colors",3,"click"],["name","calendar-outline",1,"text-base","align-middle","mr-2"],["name","wallet-outline",1,"text-base","align-middle","mr-2"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50","p-4"],[1,"fixed","inset-0","bg-black","bg-opacity-50","z-50","flex","items-center","justify-center","p-4"],[1,"flex","items-center","gap-2"],[1,"text-sm","font-medium","text-gray-600"],[1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100","pr-8",3,"ngModelChange","change","ngModel"],["value","2024"],["value","2025"],["value","2026"],[3,"value"],[1,"flex","items-center","gap-2","mt-2","sm:mt-0"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-6"],[1,"bg-white","p-6","rounded-xl","shadow-md","flex","items-center","space-x-4"],[1,"bg-green-100","p-3","rounded-full"],["name","people-outline",1,"text-2xl","text-green-600"],[1,"text-sm","text-gray-500"],[1,"text-2xl","font-semibold","text-gray-900"],["name","cash-outline",1,"text-2xl","text-green-600"],[1,"bg-yellow-100","p-3","rounded-full"],["name","checkmark-circle-outline",1,"text-2xl","text-yellow-600"],[1,"bg-indigo-100","p-3","rounded-full"],["name","send-outline",1,"text-2xl","text-indigo-600"],[1,"text-center","py-8"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4"],[1,"bg-white","rounded-lg","shadow-md","overflow-hidden"],[1,"bg-gray-50","rounded-lg","p-8","text-center"],[1,"text-gray-500"],[1,"text-sm","text-red-700"],[1,"overflow-x-auto"],[1,"w-full","text-sm"],[1,"bg-gray-100","border-b","border-gray-200"],[1,"px-4","py-3","text-left","font-semibold","text-gray-700"],[1,"px-4","py-3","text-center","font-semibold","text-gray-700"],[1,"px-4","py-3","text-right","font-semibold","text-gray-700"],["title","\u9EDE\u64CA\u67E5\u770B\u660E\u7D30",1,"border-b","border-gray-200","hover:bg-indigo-50","transition-colors","cursor-pointer"],["title","\u9EDE\u64CA\u67E5\u770B\u660E\u7D30",1,"border-b","border-gray-200","hover:bg-indigo-50","transition-colors","cursor-pointer",3,"click"],[1,"px-4","py-3","text-gray-700"],[1,"px-4","py-3","font-medium","text-gray-900"],[1,"px-4","py-3","text-center","text-gray-600"],[1,"px-4","py-3","text-right","font-semibold","text-gray-900"],[1,"px-4","py-3","text-center"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-green-100","text-green-800"],["title","\u6838\u5C0D\u6B64\u80A1\u6771\u4E0A\u6708\u56DE\u994B\u91D1",1,"px-3","py-1","bg-green-600","text-white","rounded","text-xs","hover:bg-green-700","transition-colors"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-blue-100","text-blue-800"],["title","\u767C\u653E\u6B64\u80A1\u6771\u4E0A\u6708\u56DE\u994B\u91D1\uFF08\u9700\u5148\u6838\u5C0D\uFF09",1,"px-3","py-1","bg-blue-600","text-white","rounded","text-xs","hover:bg-blue-700","disabled:bg-gray-300","disabled:cursor-not-allowed","transition-colors",3,"disabled"],["target","_blank","title","\u67E5\u770B\u6D41\u6C34\u5E33\u5206\u9304",1,"text-indigo-600","hover:text-indigo-800","hover:underline","text-sm","inline-flex","items-center",3,"href"],[1,"text-gray-400","text-sm"],["title","\u4E0B\u8F09\u52DE\u5831\u55AE\uFF08\u542B Word \u8207 PDF\uFF09",1,"px-3","py-1","rounded","text-xs","transition-colors",3,"click","disabled"],[1,"inline-flex","items-center"],["name","checkmark-done-outline",1,"mr-1"],["title","\u6838\u5C0D\u6B64\u80A1\u6771\u4E0A\u6708\u56DE\u994B\u91D1",1,"px-3","py-1","bg-green-600","text-white","rounded","text-xs","hover:bg-green-700","transition-colors",3,"click"],["name","cash-outline",1,"mr-1"],["title","\u767C\u653E\u6B64\u80A1\u6771\u4E0A\u6708\u56DE\u994B\u91D1\uFF08\u9700\u5148\u6838\u5C0D\uFF09",1,"px-3","py-1","bg-blue-600","text-white","rounded","text-xs","hover:bg-blue-700","disabled:bg-gray-300","disabled:cursor-not-allowed","transition-colors",3,"click","disabled"],["target","_blank","title","\u67E5\u770B\u6D41\u6C34\u5E33\u5206\u9304",1,"text-indigo-600","hover:text-indigo-800","hover:underline","text-sm","inline-flex","items-center",3,"click","href"],["name","link-outline",1,"text-lg","mr-1"],["name","hourglass-outline",1,"animate-spin","mr-1"],["name","download-outline",1,"mr-1"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"flex","items-center","justify-between"],[1,"text-sm","text-gray-500","mb-2"],[1,"bg-red-100","p-4","rounded-full"],["name","wallet-outline",1,"text-4xl","text-red-600"],[1,"border-b","border-gray-200","hover:bg-gray-50","transition-colors"],[1,"px-4","py-3","text-right","text-yellow-600","font-semibold"],[1,"px-4","py-3","text-right","text-green-600","font-semibold"],[1,"text-indigo-600","hover:text-indigo-800","hover:underline","text-sm","font-medium",3,"click"],[1,"bg-white","rounded-lg","shadow-lg","max-w-5xl","w-full","max-h-[90vh]","flex","flex-col"],[1,"bg-white","border-b","p-4","flex","justify-between","items-center","sticky","top-0","z-10"],[1,"text-lg","font-semibold","text-gray-900"],[1,"px-3","py-2","bg-indigo-600","text-white","rounded","text-sm","hover:bg-indigo-700","transition-colors",3,"click"],[1,"text-gray-400","hover:text-gray-600","p-2",3,"click"],["name","close-outline",1,"text-2xl"],[1,"overflow-y-auto","flex-1","p-4"],[1,"mb-4","bg-gray-50","border","border-gray-200","rounded-lg","p-4"],[1,"mb-4","bg-red-50","border","border-red-200","rounded-lg","p-3"],[1,"border-t","p-4","bg-gray-50","flex","justify-end"],[1,"bg-gray-300","text-gray-800","px-4","py-2","rounded-lg","font-medium","hover:bg-gray-400","transition-colors",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-6","gap-3","items-end"],[1,"block","text-xs","font-medium","text-gray-600","mb-1"],["type","datetime-local",1,"w-full","border-gray-300","rounded-lg","text-sm","p-2",3,"ngModelChange","ngModel"],["type","text","placeholder","\u767C\u7968\u865F\u78BC",1,"w-full","border-gray-300","rounded-lg","text-sm","p-2",3,"ngModelChange","ngModel"],["type","number","placeholder","\u6298\u6263\u91D1\u984D",1,"w-full","border-gray-300","rounded-lg","text-sm","p-2",3,"ngModelChange","ngModel"],["type","number","placeholder","\u767C\u7968\u91D1\u984D",1,"w-full","border-gray-300","rounded-lg","text-sm","p-2",3,"ngModelChange","ngModel"],["type","number","min","0","placeholder","\u56DE\u994B%",1,"w-full","border-gray-300","rounded-lg","text-sm","p-2",3,"ngModelChange","ngModel"],["type","text","placeholder","\u4F7F\u7528\u6298\u6263",1,"w-full","border-gray-300","rounded-lg","text-sm","p-2",3,"ngModelChange","ngModel"],[1,"md:col-span-6","flex","gap-2","justify-end"],[1,"px-4","py-2","bg-green-600","text-white","rounded-lg","text-sm","hover:bg-green-700","disabled:bg-gray-300","disabled:cursor-not-allowed","transition-colors",3,"click","disabled"],[1,"px-4","py-2","bg-gray-200","text-gray-700","rounded-lg","text-sm","hover:bg-gray-300","transition-colors",3,"click"],[1,"bg-gray-50","border-b","border-gray-200","sticky","top-0"],[1,"px-3","py-2","text-left","font-semibold","text-gray-700"],[1,"px-3","py-2","text-right","font-semibold","text-gray-700"],[1,"px-3","py-2","text-center","font-semibold","text-gray-700"],[1,"border-b","border-gray-200","hover:bg-gray-50"],[1,"bg-gray-50","border-t-2","border-gray-200"],["colspan","5",1,"px-3","py-2","text-right","font-semibold","text-gray-900"],[1,"px-3","py-2","text-right","font-bold","text-gray-900","text-base"],[1,"px-3","py-2","text-gray-600","text-xs"],[1,"px-3","py-2","font-medium","text-gray-900"],[1,"px-3","py-2","text-right","text-gray-600"],[1,"px-3","py-2","text-right"],["type","number","min","0","step","0.01",1,"w-24","border-gray-300","rounded-md","text-sm","p-1","text-right","font-semibold",3,"ngModelChange","ngModel"],[1,"px-3","py-2","text-center"],[1,"flex","items-center","justify-center","gap-1"],["type","number","min","0",1,"w-20","border-gray-300","rounded-md","text-sm","p-1","text-center",3,"ngModelChange","ngModel"],[1,"text-gray-600"],[1,"px-3","py-2","text-right","font-semibold","text-gray-900"],[1,"px-3","py-2","text-sm","text-gray-600"],[1,"px-3","py-2"],["type","text","placeholder","\u8F38\u5165\u5099\u8A3B",1,"w-full","border-gray-300","rounded-md","text-sm","p-1",3,"ngModelChange","ngModel"],[1,"flex","items-center","justify-center","gap-2"],[1,"px-3","py-1","rounded","text-xs","font-medium","bg-indigo-600","text-white","hover:bg-indigo-700","disabled:bg-gray-300","disabled:cursor-not-allowed","transition-colors",3,"click","disabled"],[1,"px-3","py-1","rounded","text-xs","font-medium","bg-red-600","text-white","hover:bg-red-700","disabled:bg-gray-300","disabled:cursor-not-allowed","transition-colors",3,"click","disabled"],[1,"px-3","py-2","text-right","font-bold","text-green-600","text-base"],[1,"px-3","py-2","text-right","font-bold","text-yellow-600","text-base"],[1,"px-3","py-2","text-right","text-green-600","font-semibold"],[1,"px-3","py-2","text-right","font-semibold"],[1,"inline-block","bg-green-100","text-green-800","px-2","py-1","rounded","text-xs","font-semibold"],[1,"inline-block","bg-yellow-100","text-yellow-800","px-2","py-1","rounded","text-xs","font-semibold"],[1,"inline-block","bg-gray-100","text-gray-800","px-2","py-1","rounded","text-xs","font-semibold"],[1,"bg-white","rounded-lg","shadow-xl","w-full","max-w-md"],[1,"border-b","p-4","bg-indigo-600","text-white","rounded-t-lg"],[1,"text-lg","font-semibold","flex","items-center"],["name","cash-outline",1,"text-xl","mr-2"],[1,"p-6"],[1,"space-y-4"],[1,"border-t","p-4","bg-gray-50","flex","justify-end","space-x-3","rounded-b-lg"],[1,"px-4","py-2","bg-gray-300","text-gray-800","rounded-lg","font-medium","hover:bg-gray-400","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors",3,"click","disabled"],[1,"px-4","py-2","bg-indigo-600","text-white","rounded-lg","font-medium","hover:bg-indigo-700","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors","flex","items-center",3,"click","disabled"],[1,"inline-block","animate-spin","mr-2"],[1,"bg-gray-50","rounded-lg","p-4"],[1,"grid","grid-cols-2","gap-3","text-sm"],[1,"font-medium","text-gray-900"],[1,"col-span-2"],[1,"font-semibold","text-lg","text-indigo-600"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"text-red-500"],["type","number","placeholder","\u8ACB\u8F38\u5165\u767C\u653E\u91D1\u984D","min","0","step","1",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500",3,"ngModelChange","ngModel","max"],[1,"mt-1","text-xs","text-gray-500"],[1,"bg-yellow-50","border-l-4","border-yellow-400","p-3"],[1,"bg-red-50","border-l-4","border-red-400","p-3"],[1,"flex","items-start"],["name","warning-outline",1,"text-yellow-600","text-xl","mr-2","flex-shrink-0","mt-0.5"],[1,"text-sm","text-yellow-800"],[1,"font-medium"],[1,"mt-1"],["name","alert-circle-outline",1,"text-red-600","text-xl","mr-2","flex-shrink-0","mt-0.5"],[1,"text-sm","text-red-800"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),d(3,"\u80A1\u6771\u56DE\u994B\u91D1"),s(),M(4,pU,17,3,"div",3),s(),l(5,"div",4)(6,"button",5),b("click",function(){return i.activeTab.set("monthly")}),x(7,"ion-icon",6),d(8," \u6BCF\u6708\u56DE\u994B\u91D1 "),s(),l(9,"button",5),b("click",function(){return i.activeTab.set("payables")}),x(10,"ion-icon",7),d(11," \u61C9\u4ED8\u56DE\u994B\u91D1 "),s()(),M(12,TU,38,8,"div",0),M(13,FU,14,5,"div",0),s(),M(14,zU,20,8,"div",8),M(15,t$,14,4,"div",8),M(16,a$,14,4,"div",9)),t&2){let r,o;f(4),A(i.activeTab()==="monthly"?4:-1),f(2),W("border-b-2",i.activeTab()==="monthly")("border-indigo-600",i.activeTab()==="monthly")("text-indigo-600",i.activeTab()==="monthly"),f(3),W("border-b-2",i.activeTab()==="payables")("border-indigo-600",i.activeTab()==="payables")("text-indigo-600",i.activeTab()==="payables"),f(3),A(i.activeTab()==="monthly"?12:-1),f(),A(i.activeTab()==="payables"?13:-1),f(),A((r=i.monthlyDetailModalVisible()&&i.currentMonthlySummary())?14:-1,r),f(),A((o=i.payablesDetailModalVisible()&&i.currentPayableEmployee())?15:-1,o),f(),A(i.releaseModalVisible()?16:-1)}},dependencies:[oe,Se,Fe,Pe,xe,kt,Re,me,po,Gl,Ie,ke],encapsulation:2,changeDetection:0});var mp=Za;var s$=(n,e)=>e.id;function l$(n,e){if(n&1&&(l(0,"li"),d(1),s()),n&2){let t=_().$implicit;f(),E(t)}}function u$(n,e){if(n&1&&M(0,l$,2,1,"li"),n&2){let t=e.$implicit;A(t.trim()?0:-1)}}function d$(n,e){if(n&1&&(l(0,"div",28)(1,"h4",31),x(2,"ion-icon",32),d(3,"\u884C\u52D5\u4E8B\u9805"),s(),l(4,"ul",33),O(5,u$,1,1,null,null,j),s()()),n&2){let t=_(2).$implicit;f(5),L(t.actionItems.split(`
`))}}function c$(n,e){if(n&1&&(l(0,"li"),d(1),s()),n&2){let t=_().$implicit;f(),E(t)}}function m$(n,e){if(n&1&&M(0,c$,2,1,"li"),n&2){let t=e.$implicit;A(t.trim()?0:-1)}}function p$(n,e){if(n&1&&(l(0,"div",22)(1,"div",23)(2,"div",24)(3,"h4",25),x(4,"ion-icon",26),d(5,"\u8207\u6703\u4EBA\u54E1"),s(),l(6,"p",27),d(7),s()(),M(8,d$,7,0,"div",28),l(9,"div",24)(10,"h4",25),x(11,"ion-icon",29),d(12,"\u6703\u8B70\u8A18\u9304"),s(),l(13,"ul",30),O(14,m$,1,1,null,null,j),s()()()()),n&2){let t=_().$implicit;f(7),E(t.attendees),f(),A(t.actionItems?8:-1),f(6),L(t.notes.split(`
`))}}function f$(n,e){if(n&1){let t=B();l(0,"div",6)(1,"div",9),b("click",function(){let r=D(t).$implicit,o=_();return w(o.toggleMeeting(r.id))}),l(2,"div",10)(3,"div",11)(4,"p",12),d(5),Gt(6,"date"),s(),l(7,"p",13),d(8),Gt(9,"date"),s()(),l(10,"div")(11,"p",14),d(12),Gt(13,"date"),s(),l(14,"h3",15),d(15),s()()(),l(16,"div",16)(17,"button",17),b("click",function(r){let o=D(t).$implicit,a=_();return r.stopPropagation(),w(a.openModal(o))}),x(18,"ion-icon",18),s(),l(19,"button",19),b("click",function(r){let o=D(t).$implicit,a=_();return r.stopPropagation(),w(a.requestDelete(o))}),x(20,"ion-icon",20),s(),x(21,"ion-icon",21),s()(),M(22,p$,16,2,"div",22),s()}if(n&2){let t=e.$implicit,i=_();f(5),E(sn(6,7,t.date,"MMM")),f(3),E(sn(9,10,t.date,"dd")),f(4),E(sn(13,13,t.date,"fullDate")),f(3),E(t.title),f(6),W("rotate-180",i.openMeetingId()===t.id),f(),A(i.openMeetingId()===t.id?22:-1)}}function g$(n,e){n&1&&(l(0,"div",7),d(1," \u5C1A\u7121\u6703\u8B70\u7D00\u9304\uFF0C\u9EDE\u64CA\u300C\u65B0\u589E\u6BCF\u5468\u6703\u8B70\u300D\u4F86\u5EFA\u7ACB\u7B2C\u4E00\u7B46\u7D00\u9304\u3002 "),s())}function h$(n,e){if(n&1){let t=B();l(0,"div",8)(1,"div",34)(2,"div",35)(3,"h3",36),d(4),s(),l(5,"button",37),b("click",function(){D(t);let r=_();return w(r.closeModal())}),x(6,"ion-icon",38),s()(),l(7,"div",39)(8,"form",40),b("ngSubmit",function(){D(t);let r=_();return w(r.handleFormSubmit())}),l(9,"div",23)(10,"div")(11,"label",41),d(12,"\u65E5\u671F*"),s(),x(13,"input",42),s(),l(14,"div",43)(15,"label",44),d(16,"\u6A19\u984C*"),s(),x(17,"input",45),s()(),l(18,"div")(19,"label",46),d(20,"\u8207\u6703\u4EBA\u54E1*"),s(),x(21,"input",47),s(),l(22,"div")(23,"label",48),d(24,"\u6703\u8B70\u8A18\u9304*"),s(),x(25,"textarea",49),s(),l(26,"div")(27,"label",50),d(28,"\u884C\u52D5\u4E8B\u9805"),s(),x(29,"textarea",51),s(),l(30,"div",52)(31,"button",53),b("click",function(){D(t);let r=_();return w(r.closeModal())}),d(32,"\u53D6\u6D88"),s(),l(33,"button",54),d(34,"\u5132\u5B58"),s()()()()()()}if(n&2){let t=_();f(4),E(t.editingMeeting()?"\u7DE8\u8F2F\u6BCF\u5468\u6703\u8B70":"\u65B0\u589E\u6BCF\u5468\u6703\u8B70"),f(4),I("formGroup",t.meetingForm),f(25),I("disabled",t.meetingForm.invalid)}}function y$(n,e){if(n&1){let t=B();l(0,"div",8)(1,"div",55)(2,"div",56)(3,"div",57),x(4,"ion-icon",58),s(),l(5,"h3",59),d(6,"\u78BA\u5B9A\u8981\u522A\u9664\u55CE\uFF1F"),s(),l(7,"p",60),d(8),s()(),l(9,"div",61)(10,"button",53),b("click",function(){D(t);let r=_();return w(r.cancelDelete())}),d(11,"\u53D6\u6D88"),s(),l(12,"button",62),b("click",function(){D(t);let r=_();return w(r.confirmDelete())}),d(13,"\u78BA\u8A8D\u522A\u9664"),s()()()()}n&2&&(f(8),k("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u6BCF\u5468\u6703\u8B70\u7D00\u9304\u300C",e.title,"\u300D\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"))}var Xa=class Xa{constructor(){this.fb=P(je);this.isModalOpen=S(!1);this.editingMeeting=S(null);this.openMeetingId=S(null);this.meetingToDelete=S(null);this.meetings=S([{id:"MEET001",date:"2024-07-30",title:"\u7B2C\u4E09\u5B63\u8CA1\u52D9\u6AA2\u8A0E",attendees:"\u80A1\u6771 A, \u80A1\u6771 B, \u8CA1\u52D9\u9577",notes:`1. \u8A0E\u8AD6\u7B2C\u4E09\u5B63\u5EA6\u7684\u71DF\u6536\u72C0\u6CC1\uFF0C\u6574\u9AD4\u8868\u73FE\u512A\u65BC\u9810\u671F\u3002
2. \u5206\u6790\u5404\u7522\u54C1\u7DDA\u7684\u5229\u6F64\u7387\uFF0C\u767C\u73FE\u96EA\u8304\u7522\u54C1\u7684\u6210\u672C\u6709\u4E0A\u5347\u8DA8\u52E2\u3002`,actionItems:`1. \u8CA1\u52D9\u90E8\u9700\u5728\u4E00\u9031\u5167\u63D0\u4EA4\u96EA\u8304\u6210\u672C\u4E0A\u5347\u7684\u8A73\u7D30\u5206\u6790\u5831\u544A\u3002
2. \u80A1\u6771 B \u8CA0\u8CAC\u7814\u7A76\u65B0\u7684\u4F9B\u61C9\u5546\u4EE5\u964D\u4F4E\u6210\u672C\u3002`},{id:"MEET002",date:"2024-07-25",title:"\u884C\u92B7\u6D3B\u52D5 brainstorm",attendees:"\u80A1\u6771 C, \u884C\u92B7\u5718\u968A",notes:"\u8A0E\u8AD6\u4E0B\u534A\u5E74\u5EA6\u7684\u884C\u92B7\u7B56\u7565\uFF0C\u4E3B\u8981\u96C6\u4E2D\u5728 VIP \u5BA2\u6236\u7684\u7DAD\u7E6B\u3002",actionItems:`1. \u884C\u92B7\u5718\u968A\u63D0\u51FA\u5169\u500B VIP \u5C08\u5C6C\u6D3B\u52D5\u65B9\u6848\u3002
2. \u9810\u7B97\u521D\u4F30\u9700\u5728\u4E0B\u9031\u4E09\u524D\u5B8C\u6210\u3002`}]);this.sortedMeetings=H(()=>this.meetings().sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()));this.meetingForm=this.fb.group({date:["",U.required],title:["",U.required],attendees:["",U.required],notes:["",U.required],actionItems:[""]})}toggleMeeting(e){this.openMeetingId.update(t=>t===e?null:e)}openModal(e=null){this.editingMeeting.set(e),e?this.meetingForm.patchValue(e):this.meetingForm.reset({date:new Date().toISOString().split("T")[0]}),this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1),this.editingMeeting.set(null)}handleFormSubmit(){if(this.meetingForm.invalid)return;let e=this.meetingForm.value,t=this.editingMeeting(),i={date:e.date,title:e.title,attendees:e.attendees,notes:e.notes,actionItems:e.actionItems||""};t?this.meetings.update(r=>r.map(o=>o.id===t.id?V(V({},o),i):o)):this.meetings.update(r=>[...r,V({id:`MEET${Date.now()}`},i)]),this.closeModal()}requestDelete(e){this.meetingToDelete.set(e)}confirmDelete(){if(!this.meetingToDelete())return;let e=this.meetingToDelete().id;this.meetings.update(t=>t.filter(i=>i.id!==e)),this.cancelDelete()}cancelDelete(){this.meetingToDelete.set(null)}};Xa.\u0275fac=function(t){return new(t||Xa)},Xa.\u0275cmp=re({type:Xa,selectors:[["app-meeting"]],decls:14,vars:3,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","add-outline"],[1,"space-y-4"],[1,"bg-white","rounded-xl","shadow-md","overflow-hidden","transition-shadow","hover:shadow-lg"],[1,"bg-white","p-6","rounded-xl","shadow-md","text-center","text-gray-500"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"p-4","flex","justify-between","items-center","cursor-pointer","hover:bg-gray-50",3,"click"],[1,"flex","items-center","gap-4"],[1,"text-center","w-12"],[1,"text-sm","font-semibold","text-red-600"],[1,"text-2xl","font-bold","text-gray-800"],[1,"font-semibold","text-gray-500","text-sm"],[1,"text-lg","font-bold","text-gray-800"],[1,"flex","items-center","gap-2"],["title","\u7DE8\u8F2F",1,"text-gray-500","hover:text-indigo-600","p-2","rounded-full","hover:bg-gray-100",3,"click"],["name","create-outline"],["title","\u522A\u9664",1,"text-gray-500","hover:text-red-600","p-2","rounded-full","hover:bg-gray-100",3,"click"],["name","trash-outline"],["name","chevron-down-outline",1,"text-gray-500","transition-transform"],[1,"p-6","border-t","bg-slate-50","space-y-4","text-sm"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"bg-white","p-4","rounded-lg","border"],[1,"font-semibold","text-gray-600","mb-2","flex","items-center","gap-2"],["name","people-outline"],[1,"text-gray-800","pl-8"],[1,"bg-yellow-50","p-4","rounded-lg","border","border-yellow-200","md:row-span-2"],["name","document-text-outline"],[1,"text-gray-800","whitespace-pre-wrap","pl-8","list-disc","list-outside","space-y-1"],[1,"font-semibold","text-yellow-800","mb-2","flex","items-center","gap-2"],["name","checkbox-outline"],[1,"text-yellow-900","whitespace-pre-wrap","pl-8","list-disc","list-outside","space-y-1"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-2xl","max-h-[90vh]","flex","flex-col","m-4"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],[1,"space-y-4",3,"ngSubmit","formGroup"],["for","date",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","date","formControlName","date",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"md:col-span-2"],["for","title",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","title","formControlName","title",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","attendees",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","attendees","formControlName","attendees","placeholder","\u8ACB\u7528\u9017\u865F\u5206\u9694",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","notes",1,"block","text-sm","font-medium","text-gray-700"],["id","notes","formControlName","notes","rows","5",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","actionItems",1,"block","text-sm","font-medium","text-gray-700"],["id","actionItems","formControlName","actionItems","rows","3",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","disabled:bg-indigo-300",3,"disabled"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","m-4"],[1,"p-6","text-center"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100"],["name","warning-outline",1,"h-6","w-6","text-red-600"],[1,"mt-4","text-lg","font-semibold","text-gray-900"],[1,"mt-2","text-sm","text-gray-500"],[1,"flex","justify-center","gap-4","bg-gray-50","px-6","py-4","rounded-b-xl"],["type","button",1,"px-4","py-2","bg-red-600","text-white","rounded-md","hover:bg-red-700",3,"click"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),d(3,"\u6BCF\u5468\u6703\u8B70\u7D00\u9304"),s(),l(4,"button",3),b("click",function(){return i.openModal(null)}),x(5,"ion-icon",4),l(6,"span"),d(7,"\u65B0\u589E\u6BCF\u5468\u6703\u8B70"),s()()(),l(8,"div",5),O(9,f$,23,16,"div",6,s$,!1,g$,2,0,"div",7),s()(),M(12,h$,35,3,"div",8),M(13,y$,14,1,"div",8)),t&2){let r;f(9),L(i.sortedMeetings()),f(3),A(i.isModalOpen()?12:-1),f(),A((r=i.meetingToDelete())?13:-1,r)}},dependencies:[oe,ke,Be,xe,me,Le,Ue,Ge,eo],encapsulation:2,changeDetection:0});var pp=Xa;var fp=(n,e)=>e.id;function _$(n,e){if(n&1&&(l(0,"option",13),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),E(t)}}function v$(n,e){if(n&1&&(l(0,"option",13),d(1),s()),n&2){let t=e.$implicit;I("value",t.id),f(),E(t.name)}}function C$(n,e){if(n&1){let t=B();l(0,"div",34)(1,"div",36)(2,"span",37),d(3),s(),l(4,"div",38)(5,"button",39),b("click",function(){let r=D(t).$implicit,o=_(2).$implicit,a=_();return w(a.openRecordModal(o.id,r))}),x(6,"ion-icon",28),s(),l(7,"button",40),b("click",function(){let r=D(t).$implicit,o=_(2).$implicit,a=_();return w(a.requestDeleteRecord(o.id,r))}),x(8,"ion-icon",30),s()()(),l(9,"div",41)(10,"div",42),x(11,"ion-icon",43),l(12,"p",44),d(13),s()(),l(14,"div",45),x(15,"ion-icon",46),l(16,"p",47),d(17),s()()(),l(18,"div",48)(19,"div",3),x(20,"img",49),l(21,"span",50),d(22),s()(),l(23,"span",51),d(24),s()()()}if(n&2){let t=e.$implicit,i=_(3);f(2),De(i.getCategoryClass(t.category)),f(),E(t.category),f(10),E(t.goal),f(4),E(t.progress),f(3),I("src",i.getShareholderAvatarUrl(t.assigneeId),Ft),f(2),E(i.getShareholderName(t.assigneeId)),f(2),E(t.lastUpdated.split(" ")[0])}}function x$(n,e){n&1&&(l(0,"div",35),d(1,"\u6B64\u65E5\u671F\u5C1A\u7121\u9032\u5EA6\u5831\u544A\uFF0C\u9EDE\u64CA\u300C\u65B0\u589E\u9032\u5EA6\u300D\u4F86\u5EFA\u7ACB\u7B2C\u4E00\u7B46\u3002"),s())}function b$(n,e){if(n&1&&(l(0,"div",32)(1,"div",33),O(2,C$,25,8,"div",34,fp,!1,x$,2,0,"div",35),s()()),n&2){let t=_().$implicit;f(2),L(t.records)}}function E$(n,e){if(n&1){let t=B();l(0,"div",20)(1,"div",23),b("click",function(){let r=D(t).$implicit,o=_();return w(o.toggleMeeting(r.id))}),l(2,"h3",24),d(3),s(),l(4,"div",3)(5,"button",25),b("click",function(r){let o=D(t).$implicit,a=_();return r.stopPropagation(),w(a.openRecordModal(o.id,null))}),x(6,"ion-icon",26),l(7,"span"),d(8,"\u65B0\u589E\u9032\u5EA6"),s()(),l(9,"button",27),b("click",function(r){let o=D(t).$implicit,a=_();return r.stopPropagation(),w(a.openMeetingModal(o))}),x(10,"ion-icon",28),s(),l(11,"button",29),b("click",function(r){let o=D(t).$implicit,a=_();return r.stopPropagation(),w(a.requestDeleteMeeting(o))}),x(12,"ion-icon",30),s(),x(13,"ion-icon",31),s()(),M(14,b$,5,1,"div",32),s()}if(n&2){let t=e.$implicit,i=_();f(3),E(t.date),f(10),W("rotate-180",i.openMeetingId()===t.id),f(),A(i.openMeetingId()===t.id?14:-1)}}function S$(n,e){n&1&&(l(0,"div",21),d(1,"\u7121\u7B26\u5408\u7BE9\u9078\u689D\u4EF6\u7684\u6703\u8B70\u7D00\u9304\u3002"),s())}function D$(n,e){if(n&1){let t=B();l(0,"div",22)(1,"div",52)(2,"div",53)(3,"h3",54),d(4),s(),l(5,"button",55),b("click",function(){D(t);let r=_();return w(r.closeMeetingModal())}),x(6,"ion-icon",56),s()(),l(7,"div",57)(8,"form",58),b("ngSubmit",function(){D(t);let r=_();return w(r.handleMeetingSubmit())}),l(9,"div")(10,"label",59),d(11,"\u65E5\u671F*"),s(),x(12,"input",60),s(),l(13,"div",61)(14,"button",62),b("click",function(){D(t);let r=_();return w(r.closeMeetingModal())}),d(15,"\u53D6\u6D88"),s(),l(16,"button",63),d(17,"\u5132\u5B58"),s()()()()()()}if(n&2){let t=_();f(4),E(t.editingMeeting()?"\u7DE8\u8F2F\u7D00\u9304\u65E5\u671F":"\u65B0\u589E\u7D00\u9304\u65E5\u671F"),f(4),I("formGroup",t.meetingForm),f(8),I("disabled",t.meetingForm.invalid)}}function w$(n,e){if(n&1&&x(0,"option",13),n&2){let t=e.$implicit;I("value",t)}}function T$(n,e){if(n&1&&(l(0,"option",13),d(1),s()),n&2){let t=e.$implicit;I("value",t.id),f(),E(t.name)}}function I$(n,e){if(n&1){let t=B();l(0,"div",22)(1,"div",64)(2,"div",53)(3,"h3",54),d(4),s(),l(5,"button",55),b("click",function(){D(t);let r=_();return w(r.closeRecordModal())}),x(6,"ion-icon",56),s()(),l(7,"div",65)(8,"form",58),b("ngSubmit",function(){D(t);let r=_();return w(r.handleRecordFormSubmit())}),l(9,"div")(10,"label",66),d(11,"\u5206\u985E*"),s(),x(12,"input",67),l(13,"datalist",68),O(14,w$,1,1,"option",13,j),s()(),l(16,"div")(17,"label",69),d(18,"\u76EE\u6A19*"),s(),x(19,"textarea",70),s(),l(20,"div")(21,"label",71),d(22,"\u9032\u5EA6*"),s(),x(23,"textarea",72),s(),l(24,"div")(25,"label",73),d(26,"\u8CA0\u8CAC\u4EBA*"),s(),l(27,"select",74)(28,"option",75),d(29,"\u8ACB\u9078\u64C7"),s(),O(30,T$,2,2,"option",13,fp),s()(),l(32,"div",61)(33,"button",62),b("click",function(){D(t);let r=_();return w(r.closeRecordModal())}),d(34,"\u53D6\u6D88"),s(),l(35,"button",63),d(36,"\u5132\u5B58"),s()()()()()()}if(n&2){let t,i=_();f(4),E((t=i.editingRecord())!=null&&t.record?"\u7DE8\u8F2F\u9032\u5EA6":"\u65B0\u589E\u9032\u5EA6"),f(4),I("formGroup",i.recordForm),f(6),L(i.categories()),f(16),L(i.shareholders()),f(5),I("disabled",i.recordForm.invalid)}}function M$(n,e){if(n&1){let t=B();l(0,"div",79),x(1,"input",82),l(2,"button",83),b("click",function(){let r=D(t).$index,o=_(2);return w(o.removeShareholder(r))}),x(3,"ion-icon",84),s()()}if(n&2){let t=e.$index;I("formGroupName",t)}}function A$(n,e){if(n&1){let t=B();l(0,"div",22)(1,"div",76)(2,"div",53)(3,"h3",54),d(4,"\u7BA1\u7406\u4EBA\u54E1"),s(),l(5,"button",55),b("click",function(){D(t);let r=_();return w(r.closeShareholderModal())}),x(6,"ion-icon",56),s()(),l(7,"div",65)(8,"form",77),b("ngSubmit",function(){D(t);let r=_();return w(r.saveShareholders())}),l(9,"div",78),O(10,M$,4,1,"div",79,Sn),s(),l(12,"button",80),b("click",function(){D(t);let r=_();return w(r.addShareholder())}),d(13,"+ \u65B0\u589E\u4EBA\u54E1"),s(),l(14,"div",81)(15,"button",62),b("click",function(){D(t);let r=_();return w(r.closeShareholderModal())}),d(16,"\u53D6\u6D88"),s(),l(17,"button",63),d(18,"\u5132\u5B58\u8B8A\u66F4"),s()()()()()()}if(n&2){let t=_();f(8),I("formGroup",t.shareholderForm),f(2),L(t.shareholderControls),f(7),I("disabled",t.shareholderForm.invalid)}}function R$(n,e){if(n&1){let t=B();l(0,"div",22)(1,"div",85)(2,"div",86)(3,"div",87),x(4,"ion-icon",88),s(),l(5,"h3",89),d(6,"\u78BA\u5B9A\u8981\u522A\u9664\u55CE\uFF1F"),s(),l(7,"p",90),d(8),s()(),l(9,"div",91)(10,"button",62),b("click",function(){D(t);let r=_();return w(r.cancelDeleteMeeting())}),d(11,"\u53D6\u6D88"),s(),l(12,"button",92),b("click",function(){D(t);let r=_();return w(r.confirmDeleteMeeting())}),d(13,"\u78BA\u8A8D\u522A\u9664"),s()()()()}n&2&&(f(8),k("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u65E5\u671F\u70BA\u300C",e.date,"\u300D\u7684\u7D00\u9304\u53CA\u5176\u6240\u6709\u9032\u5EA6\u5831\u544A\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"))}function N$(n,e){if(n&1){let t=B();l(0,"div",22)(1,"div",85)(2,"div",86)(3,"div",87),x(4,"ion-icon",88),s(),l(5,"h3",89),d(6,"\u78BA\u5B9A\u8981\u522A\u9664\u55CE\uFF1F"),s(),l(7,"p",90),d(8),s()(),l(9,"div",91)(10,"button",62),b("click",function(){D(t);let r=_();return w(r.cancelDeleteRecord())}),d(11,"\u53D6\u6D88"),s(),l(12,"button",92),b("click",function(){D(t);let r=_();return w(r.confirmDeleteRecord())}),d(13,"\u78BA\u8A8D\u522A\u9664"),s()()()()}n&2&&(f(8),k("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u76EE\u6A19\u70BA\u300C",e.record.goal,"\u300D\u7684\u9019\u7B46\u9032\u5EA6\u5831\u544A\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"))}var es=class es{constructor(){this.fb=P(je);this.isRecordModalOpen=S(!1);this.isShareholderModalOpen=S(!1);this.isMeetingModalOpen=S(!1);this.editingRecord=S(null);this.editingMeeting=S(null);this.openMeetingId=S(null);this.categoryFilter=S("");this.assigneeFilter=S("");this.shareholders=S([{id:"sh1",name:"\u80A1\u6771 A"},{id:"sh2",name:"\u80A1\u6771 B"},{id:"sh3",name:"\u80A1\u6771 C"}]);this.meetingProgresses=S([{id:"MP001",date:"2024-07-29",records:[{id:"REC001",category:"\u8CA1\u52D9",goal:"\u5F59\u6574\u5167\u5916\u8CA1\u5831",progress:"\u6574\u7406\u51FA\u5167\u5916\u5E33\u7684\u5831\u8868",assigneeId:"sh1",lastUpdated:"2024-07-29 11:00:00"},{id:"REC003",category:"\u516C\u95DC",goal:"2026/1/10 \u78BA\u8A8D\u4E00\u6708\u6D3B\u52D5\u5834\u6B21",progress:"\u798F\u59D4\u6703\u806F\u7D6145\u500B (1/5)",assigneeId:"sh2",lastUpdated:"2024-07-29 09:45:00"},{id:"REC005",category:"\u71DF\u904B",goal:"\u627E\u5230\u6709\u6548\u80A1\u6771",progress:"\u5206\u6F64\u6A5F\u5236\u8A0E\u8AD6\u4E2D",assigneeId:"sh2",lastUpdated:"2024-07-29 14:00:00"}]},{id:"MP002",date:"2024-07-22",records:[{id:"REC002",category:"\u8CA1\u52D9",goal:"\u62C9\u878D\u8CC7",progress:"\u88D5\u878D\u878D\u8CC7",assigneeId:"sh1",lastUpdated:"2024-07-28 15:30:00"},{id:"REC004",category:"\u6D3B\u52D5",goal:"\u5361\u724C\u805A\u9910 1/15",progress:"1/15\u5361\u724C\u805A\u6703*10\u4EBA (\u91CD\u9EDE\u4EBA\u7269) 5000\u9910\u8CBB \u4E2D\u9910",assigneeId:"sh3",lastUpdated:"2024-07-27 18:20:00"}]}]);this.categories=H(()=>{let e=this.meetingProgresses().flatMap(t=>t.records);return[...new Set(e.map(t=>t.category))].sort()});this.sortedMeetings=H(()=>this.meetingProgresses().slice().sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()));this.filteredMeetings=H(()=>{let e=this.categoryFilter(),t=this.assigneeFilter(),i=this.sortedMeetings();return!e&&!t?i:i.map(r=>G(V({},r),{records:r.records.filter(o=>!e||o.category===e).filter(o=>!t||o.assigneeId===t)})).filter(r=>r.records.length>0)});this.meetingForm=this.fb.group({date:["",U.required]});this.recordForm=this.fb.group({category:["",U.required],goal:["",U.required],progress:["",U.required],assigneeId:["",U.required]});this.meetingToDelete=S(null);this.recordToDelete=S(null);this.shareholderForm=this.fb.group({shareholders:this.fb.array([])})}getShareholderName(e){return this.shareholders().find(t=>t.id===e)?.name||"\u672A\u77E5"}getShareholderAvatarUrl(e){let t=this.getShareholderName(e);return`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=random&color=fff&font-size=0.5`}getCategoryClass(e){return{\u8CA1\u52D9:"bg-blue-100 text-blue-800",\u516C\u95DC:"bg-purple-100 text-purple-800",\u71DF\u904B:"bg-green-100 text-green-800",\u6D3B\u52D5:"bg-yellow-100 text-yellow-800"}[e]||"bg-gray-100 text-gray-800"}toggleMeeting(e){this.openMeetingId.update(t=>t===e?null:e)}openMeetingModal(e=null){this.editingMeeting.set(e),e?this.meetingForm.setValue({date:e.date}):this.meetingForm.reset({date:new Date().toISOString().split("T")[0]}),this.isMeetingModalOpen.set(!0)}closeMeetingModal(){this.isMeetingModalOpen.set(!1)}handleMeetingSubmit(){if(this.meetingForm.invalid)return;let e=this.meetingForm.value,t=this.editingMeeting();if(t)this.meetingProgresses.update(i=>i.map(r=>r.id===t.id?G(V({},r),{date:e.date}):r));else{let i={id:`MP${Date.now()}`,date:e.date,records:[]};this.meetingProgresses.update(r=>[...r,i])}this.closeMeetingModal()}openRecordModal(e,t=null){t?(this.editingRecord.set({record:t,meetingId:e}),this.recordForm.patchValue(t)):(this.editingRecord.set({record:null,meetingId:e}),this.recordForm.reset({assigneeId:""})),this.isRecordModalOpen.set(!0)}closeRecordModal(){this.isRecordModalOpen.set(!1),this.editingRecord.set(null)}handleRecordFormSubmit(){if(this.recordForm.invalid)return;let e=this.editingRecord();if(!e)return;let{record:t,meetingId:i}=e,r=this.recordForm.value,o={category:r.category,goal:r.goal,progress:r.progress,assigneeId:r.assigneeId,lastUpdated:new Date().toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replace(/\//g,"-")};this.meetingProgresses.update(a=>a.map(u=>{if(u.id===i){let c;return t?c=u.records.map(m=>m.id===t.id?V(V({},m),o):m):c=[...u.records,V({id:`REC${Date.now()}`},o)],G(V({},u),{records:c})}return u})),this.closeRecordModal()}resetFilters(){this.categoryFilter.set(""),this.assigneeFilter.set("")}requestDeleteMeeting(e){this.meetingToDelete.set(e)}confirmDeleteMeeting(){if(!this.meetingToDelete())return;let e=this.meetingToDelete().id;this.meetingProgresses.update(t=>t.filter(i=>i.id!==e)),this.cancelDeleteMeeting()}cancelDeleteMeeting(){this.meetingToDelete.set(null)}requestDeleteRecord(e,t){this.recordToDelete.set({meetingId:e,record:t})}confirmDeleteRecord(){if(!this.recordToDelete())return;let{meetingId:e,record:t}=this.recordToDelete();this.meetingProgresses.update(i=>i.map(r=>r.id===e?G(V({},r),{records:r.records.filter(o=>o.id!==t.id)}):r)),this.cancelDeleteRecord()}cancelDeleteRecord(){this.recordToDelete.set(null)}get shareholderControls(){return this.shareholderForm.get("shareholders").controls}openShareholderModal(){let e=this.shareholderForm.get("shareholders");e.clear(),this.shareholders().map(i=>this.fb.group({id:[i.id],name:[i.name,U.required]})).forEach(i=>e.push(i)),this.isShareholderModalOpen.set(!0)}closeShareholderModal(){this.isShareholderModalOpen.set(!1)}addShareholder(){this.shareholderForm.get("shareholders").push(this.fb.group({id:[`sh${Date.now()}`],name:["",U.required]}))}removeShareholder(e){this.shareholderForm.get("shareholders").removeAt(e)}saveShareholders(){this.shareholderForm.invalid||(this.shareholders.set(this.shareholderForm.value.shareholders),this.closeShareholderModal())}};es.\u0275fac=function(t){return new(t||es)},es.\u0275cmp=re({type:es,selectors:[["app-shareholder-records"]],decls:43,vars:8,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"flex","items-center","gap-2"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","calendar-outline"],[1,"bg-gray-700","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-gray-800","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","people-outline"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","p-4","bg-gray-50","rounded-lg","mb-6"],["for","categoryFilter",1,"text-sm","font-medium","text-gray-600"],["id","categoryFilter",1,"w-full","mt-1","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["value",""],[3,"value"],["for","assigneeFilter",1,"text-sm","font-medium","text-gray-600"],["id","assigneeFilter",1,"w-full","mt-1","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"flex","items-end","justify-end"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"space-y-4"],[1,"bg-white","rounded-xl","border","border-gray-200","overflow-hidden","transition-shadow","hover:shadow-md"],[1,"text-center","py-8","text-gray-500"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"p-4","flex","justify-between","items-center","cursor-pointer","hover:bg-gray-50",3,"click"],[1,"text-lg","font-bold","text-gray-800"],[1,"bg-indigo-500","text-white","px-3","py-1","rounded-md","font-medium","hover:bg-indigo-600","flex","items-center","gap-1","text-xs",3,"click"],["name","add-outline"],["title","\u7DE8\u8F2F\u65E5\u671F",1,"text-gray-500","hover:text-indigo-600","p-2","rounded-full","hover:bg-gray-200",3,"click"],["name","create-outline"],["title","\u522A\u9664\u6B64\u65E5\u671F\u6240\u6709\u7D00\u9304",1,"text-gray-500","hover:text-red-600","p-2","rounded-full","hover:bg-gray-200",3,"click"],["name","trash-outline"],["name","chevron-down-outline",1,"text-gray-500","transition-transform"],[1,"p-4","bg-slate-50","border-t"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-4"],[1,"bg-white","rounded-lg","border","p-4","flex","flex-col","group","relative","hover:border-indigo-300","transition-colors","duration-200"],[1,"md:col-span-2","lg:col-span-3","text-center","py-6","text-gray-500"],[1,"flex","justify-between","items-start"],[1,"px-2","py-1","text-xs","font-semibold","rounded-full"],[1,"flex","items-center","gap-1","opacity-0","group-hover:opacity-100","transition-opacity"],["title","\u7DE8\u8F2F",1,"text-gray-400","hover:text-indigo-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],["title","\u522A\u9664",1,"text-gray-400","hover:text-red-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],[1,"mt-3","flex-grow"],[1,"flex","items-start","gap-2"],["name","golf-outline",1,"text-indigo-500","mt-1"],[1,"font-semibold","text-gray-800"],[1,"flex","items-start","gap-2","mt-2"],["name","analytics-outline",1,"text-gray-500","mt-1"],[1,"text-gray-600","text-sm","flex-grow"],[1,"flex","justify-between","items-center","mt-4","pt-3","border-t"],["alt","avatar",1,"w-6","h-6","rounded-full",3,"src"],[1,"text-xs","font-medium","text-gray-700"],[1,"text-xs","text-gray-400"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-sm","m-4"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6"],[1,"space-y-4",3,"ngSubmit","formGroup"],["for","date",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","date","formControlName","date",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","disabled:bg-indigo-300",3,"disabled"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-lg","max-h-[90vh]","flex","flex-col","m-4"],[1,"p-6","overflow-y-auto"],["for","category",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","category","formControlName","category","list","category-options","placeholder","\u9078\u64C7\u6216\u8F38\u5165\u65B0\u5206\u985E",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["id","category-options"],["for","goal",1,"block","text-sm","font-medium","text-gray-700"],["id","goal","formControlName","goal","rows","2",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","progress",1,"block","text-sm","font-medium","text-gray-700"],["id","progress","formControlName","progress","rows","3",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","assigneeId",1,"block","text-sm","font-medium","text-gray-700"],["id","assigneeId","formControlName","assigneeId",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["value","","disabled",""],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","max-h-[90vh]","flex","flex-col","m-4"],[3,"ngSubmit","formGroup"],["formArrayName","shareholders",1,"space-y-3"],[1,"flex","items-center","gap-2",3,"formGroupName"],["type","button",1,"mt-4","text-sm","text-indigo-600","font-medium",3,"click"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-6"],["formControlName","name",1,"flex-grow","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["type","button","title","\u522A\u9664",1,"text-red-500","p-1","hover:bg-red-100","rounded-full",3,"click"],["name","trash-outline",1,"text-lg"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","m-4"],[1,"p-6","text-center"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100"],["name","warning-outline",1,"h-6","w-6","text-red-600"],[1,"mt-4","text-lg","font-semibold","text-gray-900"],[1,"mt-2","text-sm","text-gray-500"],[1,"flex","justify-center","gap-4","bg-gray-50","px-6","py-4","rounded-b-xl"],["type","button",1,"px-4","py-2","bg-red-600","text-white","rounded-md","hover:bg-red-700",3,"click"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),d(3,"\u500B\u4EBA\u6BCF\u5468\u9032\u5EA6\u7D00\u9304"),s(),l(4,"div",3)(5,"button",4),b("click",function(){return i.openMeetingModal(null)}),x(6,"ion-icon",5),l(7,"span"),d(8,"\u65B0\u589E\u7D00\u9304\u65E5\u671F"),s()(),l(9,"button",6),b("click",function(){return i.openShareholderModal()}),x(10,"ion-icon",7),l(11,"span"),d(12,"\u7BA1\u7406\u4EBA\u54E1"),s()()()(),l(13,"div",8)(14,"div",9)(15,"div")(16,"label",10),d(17,"\u9032\u5EA6\u5206\u985E"),s(),l(18,"select",11),J("ngModelChange",function(o){return K(i.categoryFilter,o)||(i.categoryFilter=o),o}),l(19,"option",12),d(20,"\u6240\u6709\u5206\u985E"),s(),O(21,_$,2,2,"option",13,j),s()(),l(23,"div")(24,"label",14),d(25,"\u8CA0\u8CAC\u4EBA"),s(),l(26,"select",15),J("ngModelChange",function(o){return K(i.assigneeFilter,o)||(i.assigneeFilter=o),o}),l(27,"option",12),d(28,"\u6240\u6709\u8CA0\u8CAC\u4EBA"),s(),O(29,v$,2,2,"option",13,fp),s()(),l(31,"div",16)(32,"button",17),b("click",function(){return i.resetFilters()}),x(33,"ion-icon",18),s()()(),l(34,"div",19),O(35,E$,15,4,"div",20,fp,!1,S$,2,0,"div",21),s()()(),M(38,D$,18,3,"div",22),M(39,I$,37,3,"div",22),M(40,A$,19,2,"div",22),M(41,R$,14,1,"div",22),M(42,N$,14,1,"div",22)),t&2){let r,o;f(18),Y("ngModel",i.categoryFilter),f(3),L(i.categories()),f(5),Y("ngModel",i.assigneeFilter),f(3),L(i.shareholders()),f(6),L(i.filteredMeetings()),f(3),A(i.isMeetingModalOpen()?38:-1),f(),A(i.isRecordModalOpen()?39:-1),f(),A(i.isShareholderModalOpen()?40:-1),f(),A((r=i.meetingToDelete())?41:-1,r),f(),A((o=i.recordToDelete())?42:-1,o)}},dependencies:[oe,ke,Be,Fe,Pe,xe,Re,me,Le,Ue,Ge,wi,Ti,Se,Ie],encapsulation:2,changeDetection:0});var gp=es;var F$=(n,e)=>e.id;function P$(n,e){if(n&1){let t=B();l(0,"div",10)(1,"div",11),x(2,"ion-icon",12),s(),l(3,"div",13)(4,"div",14)(5,"div",15)(6,"div")(7,"p",16),d(8),s(),l(9,"h3",17),d(10),s()(),l(11,"div",18)(12,"button",19),b("click",function(){let r=D(t).$implicit,o=_(2);return w(o.openModal(r))}),x(13,"ion-icon",20),s(),l(14,"button",21),b("click",function(){let r=D(t).$implicit,o=_(2);return w(o.requestDelete(r))}),x(15,"ion-icon",22),s()()(),l(16,"div",23)(17,"div",24)(18,"div",25)(19,"h4",26),x(20,"ion-icon",27),d(21,"\u76F8\u95DC\u4EBA\u54E1"),s(),l(22,"p",28),d(23),s()(),l(24,"div",29)(25,"h4",26),x(26,"ion-icon",30),d(27,"\u80CC\u666F"),s(),l(28,"p",31),d(29),s()(),l(30,"div",25)(31,"h4",26),x(32,"ion-icon",32),d(33,"\u7406\u7531"),s(),l(34,"p",31),d(35),s()()(),l(36,"div",33)(37,"h4",34),x(38,"ion-icon",35),d(39,"\u6700\u7D42\u6C7A\u5B9A"),s(),l(40,"p",36),d(41),s()()()()()()}if(n&2){let t=e.$implicit;f(8),E(t.date),f(2),E(t.title),f(13),E(t.stakeholders),f(6),E(t.background),f(6),E(t.rationale),f(6),E(t.decision)}}function k$(n,e){if(n&1&&(l(0,"div",6),x(1,"div",9),O(2,P$,42,6,"div",10,F$),s()),n&2){let t=_();f(2),L(t.sortedDecisions())}}function V$(n,e){n&1&&(l(0,"div",7),d(1," \u5C1A\u7121\u4F48\u9054\u4E8B\u9805\uFF0C\u9EDE\u64CA\u6309\u9215\u4F86\u5EFA\u7ACB\u7B2C\u4E00\u7B46\u7D00\u9304\u3002 "),s())}function O$(n,e){if(n&1){let t=B();l(0,"div",8)(1,"div",37)(2,"div",38)(3,"h3",39),d(4),s(),l(5,"button",40),b("click",function(){D(t);let r=_();return w(r.closeModal())}),x(6,"ion-icon",41),s()(),l(7,"div",42)(8,"form",43),b("ngSubmit",function(){D(t);let r=_();return w(r.handleFormSubmit())}),l(9,"div",44)(10,"div")(11,"label",45),d(12,"\u65E5\u671F*"),s(),x(13,"input",46),s(),l(14,"div")(15,"label",47),d(16,"\u6A19\u984C*"),s(),x(17,"input",48),s()(),l(18,"div")(19,"label",49),d(20,"\u76F8\u95DC\u4EBA\u54E1*"),s(),x(21,"input",50),s(),l(22,"div")(23,"label",51),d(24,"\u80CC\u666F*"),s(),x(25,"textarea",52),s(),l(26,"div")(27,"label",53),d(28,"\u5167\u5BB9*"),s(),x(29,"textarea",54),s(),l(30,"div")(31,"label",55),d(32,"\u7406\u7531*"),s(),x(33,"textarea",56),s(),l(34,"div",57)(35,"button",58),b("click",function(){D(t);let r=_();return w(r.closeModal())}),d(36,"\u53D6\u6D88"),s(),l(37,"button",59),d(38,"\u5132\u5B58"),s()()()()()()}if(n&2){let t=_();f(4),E(t.editingDecision()?"\u7DE8\u8F2F\u4F48\u9054":"\u65B0\u589E\u4F48\u9054"),f(4),I("formGroup",t.decisionForm),f(29),I("disabled",t.decisionForm.invalid)}}function L$(n,e){if(n&1){let t=B();l(0,"div",8)(1,"div",60)(2,"div",61)(3,"div",62),x(4,"ion-icon",63),s(),l(5,"h3",64),d(6,"\u78BA\u5B9A\u8981\u522A\u9664\u55CE\uFF1F"),s(),l(7,"p",65),d(8),s()(),l(9,"div",66)(10,"button",58),b("click",function(){D(t);let r=_();return w(r.cancelDelete())}),d(11,"\u53D6\u6D88"),s(),l(12,"button",67),b("click",function(){D(t);let r=_();return w(r.confirmDelete())}),d(13,"\u78BA\u8A8D\u522A\u9664"),s()()()()}n&2&&(f(8),k("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u4F48\u9054\u4E8B\u9805\u300C",e.title,"\u300D\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"))}var ts=class ts{constructor(){this.fb=P(je);this.isModalOpen=S(!1);this.editingDecision=S(null);this.decisionToDelete=S(null);this.decisions=S([{id:"DEC001",date:"2024-07-28",title:"\u63A1\u8CFC\u65B0\u7684 POS \u7CFB\u7D71",background:"\u76EE\u524D\u7684 POS \u7CFB\u7D71\u8001\u820A\uFF0C\u7D93\u5E38\u51FA\u932F\uFF0C\u4E14\u7121\u6CD5\u8207\u65B0\u7684\u5EAB\u5B58\u7BA1\u7406\u8EDF\u9AD4\u6574\u5408\u3002",decision:"\u6C7A\u5B9A\u63A1\u8CFC\u300CFuture POS\u300D\u7CFB\u7D71\uFF0C\u4E26\u9810\u8A08\u5728\u7B2C\u56DB\u5B63\u5B8C\u6210\u5C0E\u5165\u3002",rationale:"\u8A72\u7CFB\u7D71\u8A55\u50F9\u826F\u597D\uFF0C\u5177\u5099\u6211\u5011\u9700\u8981\u7684\u6240\u6709\u529F\u80FD\uFF0C\u4E14\u50F9\u683C\u5728\u9810\u7B97\u5167\u3002\u9577\u9060\u4F86\u770B\u80FD\u63D0\u5347\u71DF\u904B\u6548\u7387\u3002",stakeholders:"\u5168\u9AD4\u80A1\u6771, \u71DF\u904B\u7D93\u7406"},{id:"DEC002",date:"2024-07-15",title:"\u8ABF\u6574 VIP \u6703\u54E1\u798F\u5229",background:"VIP \u6703\u54E1\u7684\u6D88\u8CBB\u8A98\u56E0\u4E0D\u8DB3\uFF0C\u7E8C\u6703\u7387\u6709\u4E0B\u964D\u8DA8\u52E2\u3002",decision:"\u65B0\u589E VIP \u6703\u54E1\u751F\u65E5\u7576\u6708\u4EAB\u6709\u7528\u9910 8 \u6298\u512A\u60E0\uFF0C\u4E26\u63D0\u9AD8\u6D88\u8CBB\u7D2F\u7A4D\u9EDE\u6578\u7684\u56DE\u994B\u7387\u3002",rationale:"\u589E\u52A0\u5C0A\u69AE\u611F\u8207\u5BE6\u8CEA\u512A\u60E0\uFF0C\u5E0C\u671B\u80FD\u6709\u6548\u63D0\u5347\u9867\u5BA2\u5FE0\u8AA0\u5EA6\u8207\u6D88\u8CBB\u983B\u7387\u3002",stakeholders:"\u884C\u92B7\u5718\u968A, \u80A1\u6771 C"}]);this.sortedDecisions=H(()=>this.decisions().sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()));this.decisionForm=this.fb.group({date:["",U.required],title:["",U.required],stakeholders:["",U.required],background:["",U.required],decision:["",U.required],rationale:["",U.required]})}openModal(e=null){this.editingDecision.set(e),e?this.decisionForm.patchValue(e):this.decisionForm.reset({date:new Date().toISOString().split("T")[0]}),this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1),this.editingDecision.set(null)}handleFormSubmit(){if(this.decisionForm.invalid)return;let e=this.decisionForm.value,t=this.editingDecision(),i={date:e.date,title:e.title,stakeholders:e.stakeholders,background:e.background,decision:e.decision,rationale:e.rationale};t?this.decisions.update(r=>r.map(o=>o.id===t.id?V(V({},o),i):o)):this.decisions.update(r=>[...r,V({id:`DEC${Date.now()}`},i)]),this.closeModal()}requestDelete(e){this.decisionToDelete.set(e)}confirmDelete(){if(!this.decisionToDelete())return;let e=this.decisionToDelete().id;this.decisions.update(t=>t.filter(i=>i.id!==e)),this.cancelDelete()}cancelDelete(){this.decisionToDelete.set(null)}};ts.\u0275fac=function(t){return new(t||ts)},ts.\u0275cmp=re({type:ts,selectors:[["app-decision-log"]],decls:13,vars:3,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","add-outline"],[1,"max-w-4xl","mx-auto"],[1,"relative","pl-8"],[1,"bg-white","p-6","rounded-xl","shadow-md","text-center","text-gray-500"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"absolute","left-3","top-2","h-full","w-0.5","bg-gray-200"],[1,"relative","mb-8","group"],[1,"absolute","-left-0.5","top-2.5","w-7","h-7","bg-white","border-4","border-indigo-600","rounded-full","flex","items-center","justify-center","transition-transform","group-hover:scale-110"],["name","flag-outline",1,"text-indigo-600"],[1,"ml-12","bg-white","rounded-xl","shadow-md","overflow-hidden","transition-shadow","hover:shadow-lg"],[1,"p-5"],[1,"flex","justify-between","items-start"],[1,"font-semibold","text-indigo-700"],[1,"text-lg","font-bold","text-gray-800"],[1,"flex","items-center","gap-1","opacity-0","group-hover:opacity-100","transition-opacity"],["title","\u7DE8\u8F2F",1,"text-gray-400","hover:text-indigo-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],["name","create-outline"],["title","\u522A\u9664",1,"text-gray-400","hover:text-red-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],["name","trash-outline"],[1,"mt-4","space-y-4","text-sm"],[1,"grid","grid-cols-1","xl:grid-cols-2","gap-4"],[1,"bg-slate-50","p-3","rounded-lg","border"],[1,"font-semibold","text-slate-600","mb-1","flex","items-center","gap-2"],["name","people-outline"],[1,"text-slate-800","pl-8"],[1,"bg-slate-50","p-3","rounded-lg","border","xl:row-span-2"],["name","information-circle-outline"],[1,"text-slate-800","whitespace-pre-wrap","pl-8"],["name","bulb-outline"],[1,"bg-indigo-50","p-4","rounded-lg","border","border-indigo-200"],[1,"font-semibold","text-indigo-800","mb-1","flex","items-center","gap-2"],["name","checkmark-done-circle-outline"],[1,"text-indigo-900","whitespace-pre-wrap","pl-8","font-medium","text-base"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-2xl","max-h-[90vh]","flex","flex-col","m-4"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["for","date",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","date","formControlName","date",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","title",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","title","formControlName","title",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","stakeholders",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","stakeholders","formControlName","stakeholders","placeholder","\u8ACB\u7528\u9017\u865F\u5206\u9694",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","background",1,"block","text-sm","font-medium","text-gray-700"],["id","background","formControlName","background","rows","3",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","decision",1,"block","text-sm","font-medium","text-gray-700"],["id","decision","formControlName","decision","rows","4",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","rationale",1,"block","text-sm","font-medium","text-gray-700"],["id","rationale","formControlName","rationale","rows","3",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","disabled:bg-indigo-300",3,"disabled"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","m-4"],[1,"p-6","text-center"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100"],["name","warning-outline",1,"h-6","w-6","text-red-600"],[1,"mt-4","text-lg","font-semibold","text-gray-900"],[1,"mt-2","text-sm","text-gray-500"],[1,"flex","justify-center","gap-4","bg-gray-50","px-6","py-4","rounded-b-xl"],["type","button",1,"px-4","py-2","bg-red-600","text-white","rounded-md","hover:bg-red-700",3,"click"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),d(3,"\u91CD\u5927\u4E8B\u9805\u4F48\u9054"),s(),l(4,"button",3),b("click",function(){return i.openModal(null)}),x(5,"ion-icon",4),l(6,"span"),d(7,"\u65B0\u589E\u4F48\u9054"),s()()(),l(8,"div",5),M(9,k$,4,0,"div",6)(10,V$,2,0,"div",7),s()(),M(11,O$,39,3,"div",8),M(12,L$,14,1,"div",8)),t&2){let r;f(9),A(i.sortedDecisions().length>0?9:10),f(2),A(i.isModalOpen()?11:-1),f(),A((r=i.decisionToDelete())?12:-1,r)}},dependencies:[oe,ke,Be,xe,me,Le,Ue,Ge],encapsulation:2,changeDetection:0});var hp=ts;var is=(n,e)=>e.id;function B$(n,e){if(n&1&&(l(0,"option",15),d(1),s()),n&2){let t=e.$implicit;I("value",t.id),f(),E(t.name)}}function U$(n,e){if(n&1&&x(0,"div",51),n&2){let t=_().$implicit;gn("width",t.progress,"%")}}function $$(n,e){if(n&1&&x(0,"div",52),n&2){let t=_().$implicit;gn("width",t.progress,"%")}}function H$(n,e){if(n&1){let t=B();l(0,"label",49)(1,"input",53),b("change",function(r){let o=D(t).$index,a=_().$implicit,u=_();return w(u.updateProgress(a,o,r))}),s(),l(2,"span",54),d(3),s()()}if(n&2){let t=e.$implicit;f(),I("checked",t.isCompleted),f(),W("line-through",t.isCompleted)("text-gray-400",t.isCompleted),f(),E(t.description)}}function G$(n,e){n&1&&(l(0,"p",50),d(1,"\u5C1A\u7121\u95DC\u9375\u6210\u679C"),s())}function q$(n,e){if(n&1){let t=B();l(0,"div",23)(1,"div",28)(2,"div",29)(3,"div",30),x(4,"img",31),l(5,"div")(6,"p",32),d(7),s(),l(8,"p",33),d(9),s()()(),l(10,"div",34)(11,"button",35),b("click",function(){let r=D(t).$implicit,o=_();return w(o.openModal(r))}),x(12,"ion-icon",36),s(),l(13,"button",37),b("click",function(){let r=D(t).$implicit,o=_();return w(o.requestDelete(r))}),x(14,"ion-icon",38),s()()(),l(15,"h3",39),d(16),s()(),l(17,"div",40)(18,"div",41)(19,"span",42),d(20),s(),l(21,"span",43),d(22),s()(),l(23,"div",44),M(24,U$,1,2,"div",45)(25,$$,1,2,"div",46),s(),l(26,"div",47)(27,"h4",48),d(28,"\u95DC\u9375\u6210\u679C"),s(),O(29,H$,4,6,"label",49,is,!1,G$,2,0,"p",50),s()()()}if(n&2){let t=e.$implicit,i=_();f(4),I("src",i.getOwnerAvatarUrl(t.ownerId),Ft),f(3),E(i.getOwnerName(t.ownerId)),f(2),k("\u622A\u6B62\u65BC ",t.dueDate),f(7),E(t.title),f(3),I("ngClass",i.getStatusClass(t.status)),f(),E(t.status),f(2),k("",t.progress,"%"),f(2),A(t.progress<100?24:25),f(5),L(t.keyResults)}}function W$(n,e){n&1&&(l(0,"div",24),x(1,"ion-icon",55),l(2,"p",56),d(3,"\u7121\u7B26\u5408\u689D\u4EF6\u7684\u6BCF\u9031\u76EE\u6A19\u3002"),s()())}function j$(n,e){if(n&1&&x(0,"div",58),n&2){let t=_().$implicit;gn("width",t.progress,"%")}}function z$(n,e){if(n&1&&x(0,"div",52),n&2){let t=_().$implicit;gn("width",t.progress,"%")}}function Y$(n,e){if(n&1){let t=B();l(0,"label",49)(1,"input",59),b("change",function(r){let o=D(t).$index,a=_().$implicit,u=_();return w(u.updateProgress(a,o,r))}),s(),l(2,"span",54),d(3),s()()}if(n&2){let t=e.$implicit;f(),I("checked",t.isCompleted),f(),W("line-through",t.isCompleted)("text-gray-400",t.isCompleted),f(),E(t.description)}}function J$(n,e){n&1&&(l(0,"p",50),d(1,"\u5C1A\u7121\u95DC\u9375\u6210\u679C"),s())}function K$(n,e){if(n&1){let t=B();l(0,"div",23)(1,"div",28)(2,"div",29)(3,"div",30),x(4,"img",31),l(5,"div")(6,"p",32),d(7),s(),l(8,"p",33),d(9),s()()(),l(10,"div",34)(11,"button",35),b("click",function(){let r=D(t).$implicit,o=_();return w(o.openModal(r))}),x(12,"ion-icon",36),s(),l(13,"button",37),b("click",function(){let r=D(t).$implicit,o=_();return w(o.requestDelete(r))}),x(14,"ion-icon",38),s()()(),l(15,"h3",39),d(16),s()(),l(17,"div",40)(18,"div",41)(19,"span",42),d(20),s(),l(21,"span",43),d(22),s()(),l(23,"div",44),M(24,j$,1,2,"div",57)(25,z$,1,2,"div",46),s(),l(26,"div",47)(27,"h4",48),d(28,"\u95DC\u9375\u6210\u679C"),s(),O(29,Y$,4,6,"label",49,is,!1,J$,2,0,"p",50),s()()()}if(n&2){let t=e.$implicit,i=_();f(4),I("src",i.getOwnerAvatarUrl(t.ownerId),Ft),f(3),E(i.getOwnerName(t.ownerId)),f(2),k("\u622A\u6B62\u65BC ",t.dueDate),f(7),E(t.title),f(3),I("ngClass",i.getStatusClass(t.status)),f(),E(t.status),f(2),k("",t.progress,"%"),f(2),A(t.progress<100?24:25),f(5),L(t.keyResults)}}function Q$(n,e){n&1&&(l(0,"div",24),x(1,"ion-icon",55),l(2,"p",56),d(3,"\u7121\u7B26\u5408\u689D\u4EF6\u7684\u6708\u5EA6\u76EE\u6A19\u3002"),s()())}function Z$(n,e){if(n&1&&(l(0,"option",15),d(1),s()),n&2){let t=e.$implicit;I("value",t.id),f(),E(t.name)}}function X$(n,e){if(n&1){let t=B();l(0,"div",84),x(1,"input",89),l(2,"button",90),b("click",function(){let r=D(t).$index,o=_(2);return w(o.removeKeyResult(r))}),x(3,"ion-icon",38),s()()}if(n&2){let t=e.$index;I("formGroupName",t)}}function eH(n,e){if(n&1){let t=B();l(0,"div",27)(1,"div",60)(2,"div",61)(3,"h3",62),d(4),s(),l(5,"button",63),b("click",function(){D(t);let r=_();return w(r.closeModal())}),x(6,"ion-icon",64),s()(),l(7,"div",65)(8,"form",66),b("ngSubmit",function(){D(t);let r=_();return w(r.handleFormSubmit())}),l(9,"div")(10,"label",67),d(11,"\u76EE\u6A19*"),s(),x(12,"input",68),s(),l(13,"div",69)(14,"div")(15,"label",70),d(16,"\u8CA0\u8CAC\u4EBA*"),s(),l(17,"select",71)(18,"option",72),d(19,"\u8ACB\u9078\u64C7"),s(),O(20,Z$,2,2,"option",15,is),s()(),l(22,"div")(23,"label",73),d(24,"\u622A\u6B62\u65E5\u671F*"),s(),x(25,"input",74),s()(),l(26,"div",69)(27,"div")(28,"label",75),d(29,"\u9031\u671F*"),s(),l(30,"select",76)(31,"option",77),d(32,"\u6708\u5EA6"),s(),l(33,"option",78),d(34,"\u6BCF\u9031"),s()()(),l(35,"div")(36,"label",79),d(37,"\u72C0\u614B*"),s(),l(38,"select",80)(39,"option",9),d(40,"\u9032\u884C\u4E2D"),s(),l(41,"option",10),d(42,"\u5DF2\u5B8C\u6210"),s(),l(43,"option",11),d(44,"\u843D\u5F8C"),s(),l(45,"option",12),d(46,"\u5DF2\u64F1\u7F6E"),s()()()(),l(47,"div",81)(48,"h4",82),d(49,"\u95DC\u9375\u6210\u679C"),s(),l(50,"div",83),O(51,X$,4,1,"div",84,Sn),s(),l(53,"button",85),b("click",function(){D(t);let r=_();return w(r.addKeyResult())}),d(54,"+ \u65B0\u589E\u95DC\u9375\u6210\u679C"),s()(),l(55,"div",86)(56,"button",87),b("click",function(){D(t);let r=_();return w(r.closeModal())}),d(57,"\u53D6\u6D88"),s(),l(58,"button",88),d(59,"\u5132\u5B58"),s()()()()()()}if(n&2){let t=_();f(4),E(t.editingGoal()?"\u7DE8\u8F2F\u500B\u4EBA\u76EE\u6A19":"\u65B0\u589E\u500B\u4EBA\u76EE\u6A19"),f(4),I("formGroup",t.goalForm),f(12),L(t.shareholders()),f(31),L(t.keyResults.controls),f(7),I("disabled",t.goalForm.invalid)}}function tH(n,e){if(n&1){let t=B();l(0,"div",27)(1,"div",91)(2,"div",92)(3,"div",93),x(4,"ion-icon",94),s(),l(5,"h3",95),d(6,"\u78BA\u5B9A\u8981\u522A\u9664\u76EE\u6A19\u55CE\uFF1F"),s(),l(7,"p",96),d(8),s()(),l(9,"div",97)(10,"button",87),b("click",function(){D(t);let r=_();return w(r.cancelDelete())}),d(11,"\u53D6\u6D88"),s(),l(12,"button",98),b("click",function(){D(t);let r=_();return w(r.confirmDelete())}),d(13,"\u78BA\u8A8D\u522A\u9664"),s()()()()}n&2&&(f(8),k("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u76EE\u6A19\u300C",e.title,"\u300D\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"))}var ns=class ns{constructor(){this.fb=P(je);this.isModalOpen=S(!1);this.editingGoal=S(null);this.goalToDelete=S(null);this.statusFilter=S("");this.ownerFilter=S("");this.shareholders=S([{id:"sh1",name:"\u80A1\u6771 A"},{id:"sh2",name:"\u80A1\u6771 B"},{id:"sh3",name:"\u80A1\u6771 C"},{id:"sh4",name:"\u71DF\u904B\u7D93\u7406"}]);this.goals=S([{id:"GOAL001",title:"\u63D0\u5347 2026 \u5E74 Q3 \u71DF\u6536 20%",ownerId:"sh1",dueDate:"2026-09-30",status:"\u9032\u884C\u4E2D",progress:33,period:"monthly",keyResults:[{id:"KR1-1",description:"\u63A8\u51FA\u4E09\u6B3E\u590F\u5B63\u7279\u8ABF\u98F2\u54C1",isCompleted:!0},{id:"KR1-2",description:"\u8209\u8FA6\u5169\u5834 VIP \u54C1\u9152\u6703",isCompleted:!1},{id:"KR1-3",description:"\u8207\u9644\u8FD1\u5546\u8FA6\u7C3D\u8A02\u4E0B\u5348\u8336\u5408\u4F5C",isCompleted:!1}]},{id:"GOAL002",title:"\u512A\u5316\u96EA\u8304\u5EAB\u5B58\u6210\u672C 15%",ownerId:"sh2",dueDate:"2026-08-31",status:"\u843D\u5F8C",progress:0,period:"monthly",keyResults:[{id:"KR2-1",description:"\u5C0E\u5165\u65B0\u7684\u5EAB\u5B58\u7BA1\u7406\u7CFB\u7D71",isCompleted:!1},{id:"KR2-2",description:"\u958B\u767C\u81F3\u5C11\u5169\u5BB6\u65B0\u7684\u96EA\u8304\u4F9B\u61C9\u5546",isCompleted:!1}]},{id:"GOAL003",title:"\u5B8C\u6210\u7DB2\u7AD9\u6539\u7248\u4E26\u4E0A\u7DDA",ownerId:"sh4",dueDate:"2026-07-31",status:"\u5DF2\u5B8C\u6210",progress:100,period:"monthly",keyResults:[{id:"KR3-1",description:"\u78BA\u8A8D\u65B0\u7DB2\u7AD9 UI/UX \u8A2D\u8A08",isCompleted:!0},{id:"KR3-2",description:"\u5B8C\u6210\u524D\u7AEF\u8207\u5F8C\u7AEF\u958B\u767C",isCompleted:!0},{id:"KR3-3",description:"\u5B8C\u6210\u4F7F\u7528\u8005\u6E2C\u8A66\u4E26\u4FEE\u5FA9 Bug",isCompleted:!0}]},{id:"GOAL004",title:"\u672C\u5468\u5B8C\u6210\u4F9B\u61C9\u5546\u806F\u7E6B",ownerId:"sh2",dueDate:"2024-08-04",status:"\u9032\u884C\u4E2D",progress:50,period:"weekly",keyResults:[{id:"KR4-1",description:"\u806F\u7E6B A \u4F9B\u61C9\u5546",isCompleted:!0},{id:"KR4-2",description:"\u806F\u7E6B B \u4F9B\u61C9\u5546",isCompleted:!1}]},{id:"GOAL005",title:"\u672C\u5468\u5B8C\u6210\u5468\u5831",ownerId:"sh1",dueDate:"2024-08-02",status:"\u5DF2\u5B8C\u6210",progress:100,period:"weekly",keyResults:[{id:"KR5-1",description:"\u6574\u7406\u672C\u5468\u6578\u64DA",isCompleted:!0},{id:"KR5-2",description:"\u64B0\u5BEB\u5831\u544A",isCompleted:!0}]}]);this.baseFilteredGoals=H(()=>{let e=this.statusFilter(),t=this.ownerFilter();return this.goals().filter(i=>!e||i.status===e).filter(i=>!t||i.ownerId===t).sort((i,r)=>new Date(r.dueDate).getTime()-new Date(i.dueDate).getTime())});this.monthlyGoals=H(()=>this.baseFilteredGoals().filter(e=>e.period==="monthly"));this.weeklyGoals=H(()=>this.baseFilteredGoals().filter(e=>e.period==="weekly"));this.goalForm=this.fb.group({title:["",U.required],ownerId:["",U.required],dueDate:["",U.required],period:["monthly",U.required],status:["\u9032\u884C\u4E2D",U.required],keyResults:this.fb.array([])})}get keyResults(){return this.goalForm.get("keyResults")}getOwnerName(e){return this.shareholders().find(t=>t.id===e)?.name||"\u672A\u77E5"}getOwnerAvatarUrl(e){let t=this.getOwnerName(e);return`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=random&color=fff&font-size=0.5`}getStatusClass(e){return{"bg-blue-100 text-blue-800":e==="\u9032\u884C\u4E2D","bg-green-100 text-green-800":e==="\u5DF2\u5B8C\u6210","bg-yellow-100 text-yellow-800":e==="\u843D\u5F8C","bg-gray-100 text-gray-800":e==="\u5DF2\u64F1\u7F6E"}}resetFilters(){this.statusFilter.set(""),this.ownerFilter.set("")}openModal(e=null){this.editingGoal.set(e),this.goalForm.reset({status:"\u9032\u884C\u4E2D",period:"monthly"}),this.keyResults.clear(),e?(this.goalForm.patchValue(e),e.keyResults.forEach(t=>this.addKeyResult(t.description,t.isCompleted))):this.goalForm.patchValue({dueDate:new Date().toISOString().split("T")[0]}),this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1)}addKeyResult(e="",t=!1){let i=this.fb.group({description:[e,U.required],isCompleted:[t]});this.keyResults.push(i)}removeKeyResult(e){this.keyResults.removeAt(e)}handleFormSubmit(){if(this.goalForm.invalid)return;let e=this.goalForm.value,t=this.editingGoal(),i=e.keyResults.map(a=>({id:`KR${Date.now()}-${Math.random()}`,description:a.description,isCompleted:a.isCompleted})),r=i.length>0?i.filter(a=>a.isCompleted).length/i.length*100:0,o={title:e.title,ownerId:e.ownerId,dueDate:e.dueDate,status:e.status,period:e.period,keyResults:i,progress:Math.round(r)};t?this.goals.update(a=>a.map(u=>u.id===t.id?V(V({},u),o):u)):this.goals.update(a=>[...a,V({id:`GOAL${Date.now()}`},o)]),this.closeModal()}updateProgress(e,t,i){let r=i.target.checked;this.goals.update(o=>o.map(a=>{if(a.id===e.id){let u=[...a.keyResults];u[t]=G(V({},u[t]),{isCompleted:r});let c=u.length>0?u.filter(m=>m.isCompleted).length/u.length*100:0;return G(V({},a),{keyResults:u,progress:Math.round(c)})}return a}))}requestDelete(e){this.goalToDelete.set(e)}confirmDelete(){this.goalToDelete()&&(this.goals.update(e=>e.filter(t=>t.id!==this.goalToDelete().id)),this.cancelDelete())}cancelDelete(){this.goalToDelete.set(null)}};ns.\u0275fac=function(t){return new(t||ns)},ns.\u0275cmp=re({type:ns,selectors:[["app-goal-progress"]],decls:53,vars:6,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","add-outline"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","p-4","bg-white","rounded-xl","shadow-md"],["for","statusFilter",1,"text-sm","font-medium","text-gray-600"],["id","statusFilter",1,"w-full","mt-1","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-50",3,"ngModelChange","ngModel"],["value",""],["value","\u9032\u884C\u4E2D"],["value","\u5DF2\u5B8C\u6210"],["value","\u843D\u5F8C"],["value","\u5DF2\u64F1\u7F6E"],["for","ownerFilter",1,"text-sm","font-medium","text-gray-600"],["id","ownerFilter",1,"w-full","mt-1","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-50",3,"ngModelChange","ngModel"],[3,"value"],[1,"flex","items-end","justify-end"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-8","pt-4"],[1,"text-2xl","font-bold","text-gray-800","mb-4","pb-2","border-b-2","border-teal-500","flex","items-center","gap-2"],["name","today-outline"],[1,"space-y-4"],[1,"bg-white","rounded-xl","shadow-md","border","flex","flex-col","group","transition-all","duration-300","hover:shadow-lg","hover:-translate-y-1"],[1,"bg-white","p-6","rounded-xl","border","text-center","text-gray-500"],[1,"text-2xl","font-bold","text-gray-800","mb-4","pb-2","border-b-2","border-indigo-500","flex","items-center","gap-2"],["name","calendar-outline"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"p-4"],[1,"flex","justify-between","items-start"],[1,"flex","items-center","gap-3"],["alt","avatar",1,"w-10","h-10","rounded-full",3,"src"],[1,"font-semibold","text-gray-800"],[1,"text-xs","text-gray-500"],[1,"flex","items-center","gap-1","shrink-0","opacity-0","group-hover:opacity-100","transition-opacity"],["title","\u7DE8\u8F2F",1,"text-gray-400","hover:text-indigo-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],["name","create-outline"],["title","\u522A\u9664",1,"text-gray-400","hover:text-red-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],["name","trash-outline"],[1,"text-base","font-bold","text-gray-800","mt-3"],[1,"p-4","flex-grow","flex","flex-col","justify-end"],[1,"flex","items-center","justify-between","mb-1"],[1,"text-xs","font-semibold","px-2","py-1","rounded-full",3,"ngClass"],[1,"text-sm","font-semibold"],[1,"w-full","bg-slate-100","rounded-full","h-3.5"],[1,"bg-teal-600","h-3.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #5eead4, #0d9488)",3,"width"],[1,"bg-green-500","h-3.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #4ade80, #16a34a)",3,"width"],[1,"mt-4","space-y-1","border-t","pt-4"],[1,"text-xs","font-semibold","text-gray-500","uppercase","px-2"],[1,"flex","items-start","gap-3","text-sm","text-gray-700","cursor-pointer","p-2","rounded-lg","hover:bg-slate-50"],[1,"text-xs","text-gray-400","px-2"],[1,"bg-teal-600","h-3.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #5eead4, #0d9488)"],[1,"bg-green-500","h-3.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #4ade80, #16a34a)"],["type","checkbox",1,"mt-1","h-4","w-4","rounded","border-gray-300","text-teal-600","focus:ring-teal-500","shrink-0",3,"change","checked"],[1,"transition-colors","flex-1"],["name","flag-outline",1,"text-4xl","text-gray-400"],[1,"mt-2"],[1,"bg-indigo-600","h-3.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #818cf8, #4f46e5)",3,"width"],[1,"bg-indigo-600","h-3.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #818cf8, #4f46e5)"],["type","checkbox",1,"mt-1","h-4","w-4","rounded","border-gray-300","text-indigo-600","focus:ring-indigo-500","shrink-0",3,"change","checked"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-2xl","max-h-[90vh]","flex","flex-col","m-4"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],[1,"space-y-4",3,"ngSubmit","formGroup"],["for","title",1,"block","text-sm","font-medium","text-gray-700"],["id","title","formControlName","title",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["for","ownerId",1,"block","text-sm","font-medium","text-gray-700"],["id","ownerId","formControlName","ownerId",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["value","","disabled",""],["for","dueDate",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","dueDate","formControlName","dueDate",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","period",1,"block","text-sm","font-medium","text-gray-700"],["id","period","formControlName","period",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["value","monthly"],["value","weekly"],["for","status",1,"block","text-sm","font-medium","text-gray-700"],["id","status","formControlName","status",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"space-y-2","pt-2"],[1,"text-sm","font-medium","text-gray-700"],["formArrayName","keyResults",1,"space-y-2"],[1,"flex","items-center","gap-2",3,"formGroupName"],["type","button",1,"text-sm","font-medium","text-indigo-600","hover:text-indigo-800",3,"click"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","disabled:bg-indigo-300",3,"disabled"],["formControlName","description","placeholder","\u8F38\u5165\u95DC\u9375\u6210\u679C\u63CF\u8FF0...",1,"flex-grow","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2","text-sm"],["type","button","title","\u522A\u9664",1,"text-red-500","hover:text-red-700","p-1.5","rounded-full","hover:bg-red-100",3,"click"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","m-4"],[1,"p-6","text-center"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100"],["name","warning-outline",1,"h-6","w-6","text-red-600"],[1,"mt-4","text-lg","font-semibold","text-gray-900"],[1,"mt-2","text-sm","text-gray-500"],[1,"flex","justify-center","gap-4","bg-gray-50","px-6","py-4","rounded-b-xl"],["type","button",1,"px-4","py-2","bg-red-600","text-white","rounded-md","hover:bg-red-700",3,"click"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),d(3,"\u500B\u4EBA\u76EE\u6A19\u9032\u5EA6"),s(),l(4,"button",3),b("click",function(){return i.openModal(null)}),x(5,"ion-icon",4),l(6,"span"),d(7,"\u65B0\u589E\u500B\u4EBA\u76EE\u6A19"),s()()(),l(8,"div",5)(9,"div")(10,"label",6),d(11,"\u72C0\u614B"),s(),l(12,"select",7),J("ngModelChange",function(o){return K(i.statusFilter,o)||(i.statusFilter=o),o}),l(13,"option",8),d(14,"\u6240\u6709\u72C0\u614B"),s(),l(15,"option",9),d(16,"\u9032\u884C\u4E2D"),s(),l(17,"option",10),d(18,"\u5DF2\u5B8C\u6210"),s(),l(19,"option",11),d(20,"\u843D\u5F8C"),s(),l(21,"option",12),d(22,"\u5DF2\u64F1\u7F6E"),s()()(),l(23,"div")(24,"label",13),d(25,"\u8CA0\u8CAC\u4EBA"),s(),l(26,"select",14),J("ngModelChange",function(o){return K(i.ownerFilter,o)||(i.ownerFilter=o),o}),l(27,"option",8),d(28,"\u6240\u6709\u8CA0\u8CAC\u4EBA"),s(),O(29,B$,2,2,"option",15,is),s()(),l(31,"div",16)(32,"button",17),b("click",function(){return i.resetFilters()}),x(33,"ion-icon",18),s()()(),l(34,"div",19)(35,"div")(36,"h2",20),x(37,"ion-icon",21),d(38," \u6BCF\u9031\u76EE\u6A19 "),s(),l(39,"div",22),O(40,q$,32,9,"div",23,is,!1,W$,4,0,"div",24),s()(),l(43,"div")(44,"h2",25),x(45,"ion-icon",26),d(46," \u6708\u5EA6\u76EE\u6A19 "),s(),l(47,"div",22),O(48,K$,32,9,"div",23,is,!1,Q$,4,0,"div",24),s()()()(),M(51,eH,60,3,"div",27),M(52,tH,14,1,"div",27)),t&2){let r;f(12),Y("ngModel",i.statusFilter),f(14),Y("ngModel",i.ownerFilter),f(3),L(i.shareholders()),f(11),L(i.weeklyGoals()),f(8),L(i.monthlyGoals()),f(3),A(i.isModalOpen()?51:-1),f(),A((r=i.goalToDelete())?52:-1,r)}},dependencies:[oe,Hg,ke,Be,Fe,Pe,xe,Re,me,Le,Ue,Ge,wi,Ti,Se,Ie],encapsulation:2,changeDetection:0});var yp=ns;var nH=(n,e)=>e.id;function iH(n,e){if(n&1&&(l(0,"option",11),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),E(t)}}function rH(n,e){if(n&1&&(l(0,"option",11),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),E(t)}}function oH(n,e){if(n&1){let t=B();l(0,"tr",19)(1,"td",21),d(2),s(),l(3,"td",22),d(4),s(),l(5,"td",22)(6,"span",23),d(7),s()(),l(8,"td",22)(9,"span",23),d(10),s()(),l(11,"td",24),d(12),s(),l(13,"td",22)(14,"div",25)(15,"button",26),b("click",function(){let r=D(t).$implicit,o=_();return w(o.openModal(r))}),x(16,"ion-icon",27),s(),l(17,"button",28),b("click",function(){let r=D(t).$implicit,o=_();return w(o.requestDelete(r))}),x(18,"ion-icon",29),s()()()()}if(n&2){let t=e.$implicit,i=_();f(2),E(t.name),f(2),E(t.email),f(2),De(i.getRoleClass(t.role)),f(),E(t.role),f(2),De(i.getStatusClass(t.status)),f(),E(t.status),f(2),E(t.lastLogin)}}function aH(n,e){n&1&&(l(0,"tr")(1,"td",30),d(2,"\u7121\u7B26\u5408\u689D\u4EF6\u7684\u4F7F\u7528\u8005\u3002"),s()())}function sH(n,e){if(n&1&&(l(0,"option",11),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),E(t)}}function lH(n,e){if(n&1&&(l(0,"option",11),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),E(t)}}function uH(n,e){if(n&1){let t=B();l(0,"div",20)(1,"div",31)(2,"div",32)(3,"h3",33),d(4),s(),l(5,"button",34),b("click",function(){D(t);let r=_();return w(r.closeModal())}),x(6,"ion-icon",35),s()(),l(7,"div",36)(8,"form",37),b("ngSubmit",function(){D(t);let r=_();return w(r.handleFormSubmit())}),l(9,"label",38)(10,"span",39),d(11,"\u540D\u7A31*"),s(),x(12,"input",40),s(),l(13,"label",38)(14,"span",39),d(15,"Email*"),s(),x(16,"input",41),s(),l(17,"div",42)(18,"label",38)(19,"span",39),d(20,"\u89D2\u8272*"),s(),l(21,"select",43),O(22,sH,2,2,"option",11,j),s()(),l(24,"label",38)(25,"span",39),d(26,"\u72C0\u614B*"),s(),l(27,"select",44),O(28,lH,2,2,"option",11,j),s()()(),l(30,"div",45)(31,"button",46),b("click",function(){D(t);let r=_();return w(r.closeModal())}),d(32,"\u53D6\u6D88"),s(),l(33,"button",47),d(34,"\u5132\u5B58"),s()()()()()()}if(n&2){let t=_();f(4),E(t.editingUser()?"\u7DE8\u8F2F\u4F7F\u7528\u8005":"\u65B0\u589E\u4F7F\u7528\u8005"),f(4),I("formGroup",t.userForm),f(14),L(t.roles()),f(6),L(t.statuses()),f(5),I("disabled",t.userForm.invalid)}}function dH(n,e){if(n&1){let t=B();l(0,"div",20)(1,"div",48)(2,"div",49)(3,"div",50),x(4,"ion-icon",51),s(),l(5,"h3",52),d(6,"\u78BA\u5B9A\u8981\u522A\u9664\u4F7F\u7528\u8005\u55CE\uFF1F"),s(),l(7,"p",53),d(8),s()(),l(9,"div",54)(10,"button",46),b("click",function(){D(t);let r=_();return w(r.cancelDelete())}),d(11,"\u53D6\u6D88"),s(),l(12,"button",55),b("click",function(){D(t);let r=_();return w(r.confirmDelete())}),d(13,"\u78BA\u8A8D\u522A\u9664"),s()()()()}n&2&&(f(8),k("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u300C",e.name,"\u300D\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"))}var rs=class rs{constructor(){this.baseUrl=`${_n.apiUrl}/admin`;this.authService=P(rt);this.fb=P(je);this.http=P(Zt);this.isModalOpen=S(!1);this.editingUser=S(null);this.userToDelete=S(null);this.searchTerm=S("");this.roleFilter=S("");this.statusFilter=S("");this.users=S([]);this.roleOptions=S([]);this.roles=S(["\u8D85\u7D1A\u7BA1\u7406\u54E1","\u7BA1\u7406\u54E1","\u8CA1\u52D9","\u71DF\u904B"]);this.statuses=S(["\u555F\u7528","\u505C\u7528"]);this.isLoading=S(!1);this.error=S(null);this.userForm=this.fb.group({name:["",U.required],email:["",[U.required,U.email]],role:["\u71DF\u904B",U.required],status:["\u555F\u7528",U.required]});this.filteredUsers=H(()=>{let e=this.searchTerm().toLowerCase(),t=this.roleFilter(),i=this.statusFilter();return this.users().filter(r=>!t||r.role===t).filter(r=>!i||r.status===i).filter(r=>!e||r.name.toLowerCase().includes(e)||r.email.toLowerCase().includes(e))})}resetFilters(){this.searchTerm.set(""),this.roleFilter.set(""),this.statusFilter.set("")}ngOnInit(){this.loadRoles(),this.loadUsers()}loadRoles(){let e=this.getAuthHeaders();e&&this.http.get(`${this.baseUrl}/roles?limit=100`,{headers:e}).subscribe({next:t=>{let i=t?.data||[];this.roleOptions.set(i),i.length>0&&this.roles.set(i.map(r=>r.display_name))},error:()=>{}})}loadUsers(){let e=this.getAuthHeaders();if(!e){this.error.set("\u5C1A\u672A\u767B\u5165");return}this.isLoading.set(!0),this.error.set(null);let t=[];this.searchTerm()&&t.push(`search=${encodeURIComponent(this.searchTerm())}`);let i=this.mapRoleToCode(this.roleFilter()||void 0);i&&t.push(`role=${encodeURIComponent(i)}`);let r=t.length?`?${t.join("&")}`:"";this.http.get(`${this.baseUrl}/users${r}`,{headers:e}).subscribe({next:o=>{let u=(o?.data||[]).map(c=>this.mapUser(c));this.users.set(u),this.isLoading.set(!1)},error:o=>{this.error.set(o.error?.error||"\u8F09\u5165\u4F7F\u7528\u8005\u5931\u6557"),this.isLoading.set(!1)}})}openModal(e=null){this.editingUser.set(e),this.userForm.reset({role:"\u71DF\u904B",status:"\u555F\u7528"}),e&&this.userForm.patchValue(e),this.userForm.updateValueAndValidity(),this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1)}handleFormSubmit(){if(this.userForm.invalid)return;let e=this.getAuthHeaders();if(!e){this.error.set("\u5C1A\u672A\u767B\u5165");return}let t=this.userForm.value,i=this.mapRoleToId(t.role),r={name:t.name,email:t.email,status:this.mapStatusToApi(t.status),roleIds:i?[i]:[]};if(this.editingUser()){let o=this.editingUser().id;this.http.put(`${this.baseUrl}/users/${o}`,r,{headers:e}).subscribe({next:()=>{this.closeModal(),this.loadUsers()},error:a=>{this.error.set(a.error?.error||"\u66F4\u65B0\u4F7F\u7528\u8005\u5931\u6557")}});return}this.http.post(`${this.baseUrl}/users`,r,{headers:e}).subscribe({next:()=>{this.closeModal(),this.loadUsers()},error:o=>{this.error.set(o.error?.error||"\u65B0\u589E\u4F7F\u7528\u8005\u5931\u6557")}})}requestDelete(e){this.userToDelete.set(e)}confirmDelete(){if(!this.userToDelete())return;let e=this.getAuthHeaders();if(!e){this.error.set("\u5C1A\u672A\u767B\u5165");return}let t=this.userToDelete().id;this.http.delete(`${this.baseUrl}/users/${t}`,{headers:e}).subscribe({next:()=>{this.cancelDelete(),this.loadUsers()},error:i=>{this.error.set(i.error?.error||"\u522A\u9664\u4F7F\u7528\u8005\u5931\u6557")}})}cancelDelete(){this.userToDelete.set(null)}getRoleClass(e){switch(e){case"\u7BA1\u7406\u54E1":return"bg-red-100 text-red-800";case"\u8CA1\u52D9":return"bg-blue-100 text-blue-800";case"\u71DF\u904B":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}}getStatusClass(e){return e==="\u555F\u7528"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}getAuthHeaders(){let e=this.authService.getToken();return e?new Ot({Authorization:`Bearer ${e}`,"Content-Type":"application/json"}):null}mapUser(e){let t=e.role_names&&e.role_names[0]||e.role_codes&&e.role_codes[0]||"\u71DF\u904B",i=this.normalizeRole(t),r=this.mapStatusFromApi(e.status);return{id:String(e.admin_id),name:e.name,email:e.email,role:i,status:r,lastLogin:this.formatDate(e.last_login_at)}}normalizeRole(e){return e==="super_admin"||e==="\u8D85\u7D1A\u7BA1\u7406\u54E1"?"\u8D85\u7D1A\u7BA1\u7406\u54E1":e==="admin"||e==="\u7BA1\u7406\u54E1"?"\u7BA1\u7406\u54E1":e==="finance"||e==="\u8CA1\u52D9"?"\u8CA1\u52D9":"\u71DF\u904B"}mapRoleToId(e){return e?this.roleOptions().find(i=>i.display_name===e||i.role_name===e)?.role_id??null:null}mapRoleToCode(e){return e?this.roleOptions().find(i=>i.display_name===e||i.role_name===e)?.role_name??null:null}mapStatusToApi(e){if(e)return e==="\u555F\u7528"?"active":"inactive"}mapStatusFromApi(e){return e==="active"?"\u555F\u7528":"\u505C\u7528"}formatDate(e){return e?new Date(e).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-"}};rs.\u0275fac=function(t){return new(t||rs)},rs.\u0275cmp=re({type:rs,selectors:[["app-user-management"]],decls:49,vars:6,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","add-outline"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","p-4","bg-gray-50","rounded-lg","mb-6"],[1,"md:col-span-2"],["type","text","placeholder","\u641C\u5C0B\u540D\u7A31\u6216 Email...",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"flex","items-center","gap-2","md:col-span-4","justify-end"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-4","py-3"],[1,"border-b","hover:bg-gray-50"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"px-4","py-2","font-medium"],[1,"px-4","py-2"],[1,"px-2","py-1","text-xs","font-semibold","rounded-full"],[1,"px-4","py-2","text-gray-500"],[1,"flex","items-center","gap-2"],["title","\u7DE8\u8F2F",1,"text-indigo-600","hover:text-indigo-800","p-1",3,"click"],["name","create-outline",1,"text-lg"],["title","\u522A\u9664",1,"text-red-500","hover:text-red-700","p-1",3,"click"],["name","trash-outline",1,"text-lg"],["colspan","6",1,"text-center","py-8","text-gray-500"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-lg","m-4"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"block"],[1,"text-gray-700"],["formControlName","name",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["type","email","formControlName","email",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"grid","grid-cols-2","gap-4"],["formControlName","role",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","status",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","disabled:bg-indigo-300",3,"disabled"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","m-4"],[1,"p-6","text-center"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100"],["name","warning-outline",1,"h-6","w-6","text-red-600"],[1,"mt-4","text-lg","font-semibold","text-gray-900"],[1,"mt-2","text-sm","text-gray-500"],[1,"flex","justify-center","gap-4","bg-gray-50","px-6","py-4","rounded-b-xl"],["type","button",1,"px-4","py-2","bg-red-600","text-white","rounded-md","hover:bg-red-700",3,"click"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),d(3,"\u4F7F\u7528\u8005\u7BA1\u7406"),s(),l(4,"button",3),b("click",function(){return i.openModal(null)}),x(5,"ion-icon",4),l(6,"span"),d(7,"\u65B0\u589E\u4F7F\u7528\u8005"),s()()(),l(8,"div",5)(9,"div",6)(10,"div",7)(11,"input",8),b("ngModelChange",function(o){return i.searchTerm.set(o)}),s()(),l(12,"div")(13,"select",9),b("ngModelChange",function(o){return i.roleFilter.set(o)}),l(14,"option",10),d(15,"\u6240\u6709\u89D2\u8272"),s(),O(16,iH,2,2,"option",11,j),s()(),l(18,"div")(19,"select",9),b("ngModelChange",function(o){return i.statusFilter.set(o)}),l(20,"option",10),d(21,"\u6240\u6709\u72C0\u614B"),s(),O(22,rH,2,2,"option",11,j),s()(),l(24,"div",12)(25,"button",13),b("click",function(){return i.resetFilters()}),x(26,"ion-icon",14),s()()(),l(27,"div",15)(28,"table",16)(29,"thead",17)(30,"tr")(31,"th",18),d(32,"\u540D\u7A31"),s(),l(33,"th",18),d(34,"Email"),s(),l(35,"th",18),d(36,"\u89D2\u8272"),s(),l(37,"th",18),d(38,"\u72C0\u614B"),s(),l(39,"th",18),d(40,"\u6700\u5F8C\u767B\u5165"),s(),l(41,"th",18),d(42,"\u64CD\u4F5C"),s()()(),l(43,"tbody"),O(44,oH,19,9,"tr",19,nH,!1,aH,3,0,"tr"),s()()()()(),M(47,uH,35,3,"div",20),M(48,dH,14,1,"div",20)),t&2){let r;f(11),I("ngModel",i.searchTerm()),f(2),I("ngModel",i.roleFilter()),f(3),L(i.roles()),f(3),I("ngModel",i.statusFilter()),f(3),L(i.statuses()),f(22),L(i.filteredUsers()),f(3),A(i.isModalOpen()?47:-1),f(),A((r=i.userToDelete())?48:-1,r)}},dependencies:[oe,ke,Be,Fe,Pe,xe,Re,me,Le,Ue,Ge,Se,Ie],encapsulation:2,changeDetection:0});var _p=rs;var vp=(n,e)=>e.id;function cH(n,e){if(n&1&&(l(0,"option",10),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),E(t)}}function mH(n,e){if(n&1&&(l(0,"option",10),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),E(t)}}function pH(n,e){if(n&1&&(l(0,"option",10),d(1),s()),n&2){let t=e.$implicit;I("value",t.id),f(),E(t.name)}}function fH(n,e){if(n&1&&(l(0,"div",45),x(1,"ion-icon",46),l(2,"span"),d(3),s()()),n&2){let t=e,i=_(2);De(i.getDaysLeftClass(t.days,t.label)),f(3),E(t.label==="\u5DF2\u903E\u671F"?t.label+" "+t.days+" \u5929":t.days+" "+t.label)}}function gH(n,e){if(n&1&&x(0,"img",34),n&2){let t=_().$implicit,i=_();I("src",i.getAssigneeAvatarUrl(t.assigneeId),Ft)}}function hH(n,e){n&1&&(l(0,"div",35),x(1,"ion-icon",47),s())}function yH(n,e){if(n&1){let t=B();l(0,"input",55),b("blur",function(r){D(t);let o=_(2).$implicit,a=_();return w(a.finishEditingProgress(o,r))})("keydown.enter",function(r){D(t);let o=_(2).$implicit,a=_();return w(a.finishEditingProgress(o,r))}),s()}if(n&2){let t=_(2).$implicit;I("value",t.currentValue)}}function _H(n,e){if(n&1&&(l(0,"span",51),d(1),s()),n&2){let t=_(2).$implicit,i=_();f(),E(i.formatNumber(t.currentValue))}}function vH(n,e){if(n&1&&x(0,"div",56),n&2){let t=_();gn("width",t,"%")}}function CH(n,e){if(n&1&&x(0,"div",57),n&2){let t=_();gn("width",t,"%")}}function xH(n,e){if(n&1){let t=B();l(0,"div",48)(1,"div",49,0),b("click",function(){D(t);let r=wn(2),o=_().$implicit,a=_();return w(a.startEditingProgress(o.id,r))}),M(3,yH,1,1,"input",50)(4,_H,2,1,"span",51),d(5),s(),l(6,"span"),d(7),s()(),l(8,"div",52),M(9,vH,1,2,"div",53)(10,CH,1,2,"div",54),s()}if(n&2){let t=e,i=_().$implicit,r=_();f(3),A(r.editingProgressId()===i.id?3:4),f(2),Ke(" / ",r.formatNumber(i.targetValue)," ",i.unit," "),f(),De(t<100?"text-indigo-600":"text-green-600"),f(),k("",t.toFixed(0),"%"),f(2),A(t<100?9:10)}}function bH(n,e){if(n&1){let t=B();l(0,"div",23)(1,"div",29)(2,"h3",30),d(3),s(),M(4,fH,4,3,"div",31),s(),l(5,"div",32)(6,"div",33),M(7,gH,1,1,"img",34)(8,hH,2,0,"div",35),l(9,"span",36),d(10),s()(),l(11,"span",37),d(12),s(),l(13,"span",38),d(14),s()(),l(15,"div",39),M(16,xH,11,7),s(),l(17,"div",40)(18,"button",41),b("click",function(){let r=D(t).$implicit,o=_();return w(o.openModal(r))}),x(19,"ion-icon",42),s(),l(20,"button",43),b("click",function(){let r=D(t).$implicit,o=_();return w(o.requestDelete(r))}),x(21,"ion-icon",44),s()()()}if(n&2){let t,i,r=e.$implicit,o=_();f(3),E(r.title),f(),A((t=o.getDaysLeft(r.endDate))?4:-1,t),f(3),A(r.assigneeId?7:8),f(3),E(o.getAssigneeName(r.assigneeId)),f(),De(o.getTypeClass(r.type)),f(),E(r.type),f(),De(o.getStatusClass(r.status)),f(),E(r.status),f(2),A((i=o.getProgressBarWidth(r))?16:-1,i)}}function EH(n,e){n&1&&(l(0,"div",24),x(1,"ion-icon",58),l(2,"p",59),d(3,"\u7121\u7B26\u5408\u689D\u4EF6\u7684\u6708\u5EA6\u76EE\u6A19\u3002"),s()())}function SH(n,e){if(n&1&&(l(0,"div",45),x(1,"ion-icon",46),l(2,"span"),d(3),s()()),n&2){let t=e,i=_(2);De(i.getDaysLeftClass(t.days,t.label)),f(3),E(t.label==="\u5DF2\u903E\u671F"?t.label+" "+t.days+" \u5929":t.days+" "+t.label)}}function DH(n,e){if(n&1&&x(0,"img",34),n&2){let t=_().$implicit,i=_();I("src",i.getAssigneeAvatarUrl(t.assigneeId),Ft)}}function wH(n,e){n&1&&(l(0,"div",35),x(1,"ion-icon",47),s())}function TH(n,e){if(n&1){let t=B();l(0,"input",65),b("blur",function(r){D(t);let o=_(2).$implicit,a=_();return w(a.finishEditingProgress(o,r))})("keydown.enter",function(r){D(t);let o=_(2).$implicit,a=_();return w(a.finishEditingProgress(o,r))}),s()}if(n&2){let t=_(2).$implicit;I("value",t.currentValue)}}function IH(n,e){if(n&1&&(l(0,"span",63),d(1),s()),n&2){let t=_(2).$implicit,i=_();f(),E(i.formatNumber(t.currentValue))}}function MH(n,e){if(n&1&&x(0,"div",66),n&2){let t=_();gn("width",t,"%")}}function AH(n,e){if(n&1&&x(0,"div",57),n&2){let t=_();gn("width",t,"%")}}function RH(n,e){if(n&1){let t=B();l(0,"div",48)(1,"div",49,0),b("click",function(){D(t);let r=wn(2),o=_().$implicit,a=_();return w(a.startEditingProgress(o.id,r))}),M(3,TH,1,1,"input",62)(4,IH,2,1,"span",63),d(5),s(),l(6,"span"),d(7),s()(),l(8,"div",52),M(9,MH,1,2,"div",64)(10,AH,1,2,"div",54),s()}if(n&2){let t=e,i=_().$implicit,r=_();f(3),A(r.editingProgressId()===i.id?3:4),f(2),Ke(" / ",r.formatNumber(i.targetValue)," ",i.unit," "),f(),De(t<100?"text-teal-600":"text-green-600"),f(),k("",t.toFixed(0),"%"),f(2),A(t<100?9:10)}}function NH(n,e){if(n&1){let t=B();l(0,"div",27)(1,"div",29)(2,"h3",60),d(3),s(),M(4,SH,4,3,"div",31),s(),l(5,"div",32)(6,"div",33),M(7,DH,1,1,"img",34)(8,wH,2,0,"div",35),l(9,"span",36),d(10),s()(),l(11,"span",37),d(12),s(),l(13,"span",38),d(14),s()(),l(15,"div",39),M(16,RH,11,7),s(),l(17,"div",40)(18,"button",61),b("click",function(){let r=D(t).$implicit,o=_();return w(o.openModal(r))}),x(19,"ion-icon",42),s(),l(20,"button",43),b("click",function(){let r=D(t).$implicit,o=_();return w(o.requestDelete(r))}),x(21,"ion-icon",44),s()()()}if(n&2){let t,i,r=e.$implicit,o=_();f(3),E(r.title),f(),A((t=o.getDaysLeft(r.endDate))?4:-1,t),f(3),A(r.assigneeId?7:8),f(3),E(o.getAssigneeName(r.assigneeId)),f(),De(o.getTypeClass(r.type)),f(),E(r.type),f(),De(o.getStatusClass(r.status)),f(),E(r.status),f(2),A((i=o.getProgressBarWidth(r))?16:-1,i)}}function FH(n,e){n&1&&(l(0,"div",24),x(1,"ion-icon",58),l(2,"p",59),d(3,"\u7121\u7B26\u5408\u689D\u4EF6\u7684\u5E74\u5EA6\u76EE\u6A19\u3002"),s()())}function PH(n,e){if(n&1&&(l(0,"option",10),d(1),s()),n&2){let t=e.$implicit;I("value",t),f(),E(t)}}function kH(n,e){if(n&1&&(l(0,"option",10),d(1),s()),n&2){let t=e.$implicit;I("value",t.id),f(),E(t.name)}}function VH(n,e){if(n&1){let t=B();l(0,"div",28)(1,"div",67)(2,"div",68)(3,"h3",69),d(4),s(),l(5,"button",70),b("click",function(){D(t);let r=_();return w(r.closeModal())}),x(6,"ion-icon",71),s()(),l(7,"div",72)(8,"form",73),b("ngSubmit",function(){D(t);let r=_();return w(r.handleFormSubmit())}),l(9,"div")(10,"label",74),d(11,"\u76EE\u6A19\u540D\u7A31*"),s(),x(12,"input",75),s(),l(13,"div",76)(14,"div")(15,"label",77),d(16,"\u985E\u578B*"),s(),l(17,"select",78),O(18,PH,2,2,"option",10,j),s()(),l(20,"div")(21,"label",79),d(22,"\u9031\u671F*"),s(),l(23,"select",80)(24,"option",81),d(25,"\u6708\u5EA6"),s(),l(26,"option",82),d(27,"\u5E74\u5EA6"),s()()(),l(28,"div")(29,"label",83),d(30,"\u55AE\u4F4D*"),s(),x(31,"input",84),s()(),l(32,"div",85)(33,"div")(34,"label",86),d(35,"\u76EE\u524D\u9032\u5EA6*"),s(),x(36,"input",87),s(),l(37,"div")(38,"label",88),d(39,"\u76EE\u6A19\u503C*"),s(),x(40,"input",89),s()(),l(41,"div",85)(42,"div")(43,"label",90),d(44,"\u958B\u59CB\u65E5\u671F*"),s(),x(45,"input",91),s(),l(46,"div")(47,"label",92),d(48,"\u7D50\u675F\u65E5\u671F*"),s(),x(49,"input",93),s()(),l(50,"div")(51,"label",94),d(52,"\u8CA0\u8CAC\u4EBA"),s(),l(53,"select",95)(54,"option",9),d(55,"\u5718\u968A\u76EE\u6A19 (\u7121\u6307\u5B9A\u8CA0\u8CAC\u4EBA)"),s(),O(56,kH,2,2,"option",10,vp),s()(),l(58,"div",96)(59,"button",97),b("click",function(){D(t);let r=_();return w(r.closeModal())}),d(60,"\u53D6\u6D88"),s(),l(61,"button",98),d(62,"\u5132\u5B58"),s()()()()()()}if(n&2){let t=_();f(4),E(t.editingGoal()?"\u7DE8\u8F2F\u5718\u968A\u76EE\u6A19":"\u65B0\u589E\u5718\u968A\u76EE\u6A19"),f(4),I("formGroup",t.goalForm),f(10),L(t.goalTypes),f(38),L(t.users()),f(5),I("disabled",t.goalForm.invalid)}}function OH(n,e){if(n&1){let t=B();l(0,"div",28)(1,"div",99)(2,"div",100)(3,"div",101),x(4,"ion-icon",102),s(),l(5,"h3",103),d(6,"\u78BA\u5B9A\u8981\u522A\u9664\u5718\u968A\u76EE\u6A19\u55CE\uFF1F"),s(),l(7,"p",104),d(8),s()(),l(9,"div",105)(10,"button",97),b("click",function(){D(t);let r=_();return w(r.cancelDelete())}),d(11,"\u53D6\u6D88"),s(),l(12,"button",106),b("click",function(){D(t);let r=_();return w(r.confirmDelete())}),d(13,"\u78BA\u8A8D\u522A\u9664"),s()()()()}n&2&&(f(8),k("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u5718\u968A\u76EE\u6A19\u300C",e.title,"\u300D\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"))}var os=class os{constructor(){this.dataService=P(Bt);this.authService=P(rt);this.fb=P(je);this.isModalOpen=S(!1);this.editingGoal=S(null);this.goalToDelete=S(null);this.editingProgressId=S(null);this.statusFilter=S("");this.typeFilter=S("");this.assigneeFilter=S("");this.allGoals=S([]);this.users=S([]);this.goalTypes=["\u71DF\u6536","\u6D3B\u52D5","\u9867\u5BA2","\u5176\u4ED6"];this.goalStatuses=["\u9032\u884C\u4E2D","\u5DF2\u9054\u6210","\u672A\u9054\u6210"];this.goalForm=this.fb.group({title:["",U.required],type:["\u71DF\u6536",U.required],period:["monthly",U.required],targetValue:[null,[U.required,U.min(1)]],currentValue:[0,[U.required,U.min(0)]],unit:["\u5143",U.required],startDate:["",U.required],endDate:["",U.required],assigneeId:[""]});this.baseFilteredGoals=H(()=>{let e=this.statusFilter(),t=this.typeFilter(),i=this.assigneeFilter();return this.allGoals().filter(r=>!e||r.status===e).filter(r=>!t||r.type===t).filter(r=>!i||i==="all"?!0:i==="team"?!r.assigneeId:r.assigneeId===i).sort((r,o)=>new Date(o.startDate).getTime()-new Date(r.startDate).getTime())});this.monthlyGoals=H(()=>this.baseFilteredGoals().filter(e=>e.period==="monthly"));this.yearlyGoals=H(()=>this.baseFilteredGoals().filter(e=>e.period==="yearly"));this.loadData()}loadData(){this.allGoals.set(this.dataService.getTargetGoals()),this.users.set([])}resetFilters(){this.statusFilter.set(""),this.typeFilter.set(""),this.assigneeFilter.set("")}openModal(e=null){if(this.editingGoal.set(e),e)this.goalForm.patchValue(e);else{let t=new Date,i=new Date(t.getFullYear(),t.getMonth(),1).toISOString().split("T")[0],r=new Date(t.getFullYear(),t.getMonth()+1,0).toISOString().split("T")[0];this.goalForm.reset({type:"\u71DF\u6536",period:"monthly",currentValue:0,unit:"\u5143",startDate:i,endDate:r,assigneeId:""})}this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1)}handleFormSubmit(){if(this.goalForm.invalid)return;let e=this.goalForm.value,t=this.editingGoal(),i={title:e.title,type:e.type,targetValue:e.targetValue,currentValue:e.currentValue,unit:e.unit,startDate:e.startDate,endDate:e.endDate,assigneeId:e.assigneeId||void 0,status:e.currentValue>=e.targetValue?"\u5DF2\u9054\u6210":"\u9032\u884C\u4E2D",period:e.period};t?this.dataService.updateTargetGoal(G(V({},i),{id:t.id})):this.dataService.addTargetGoal(i),this.loadData(),this.closeModal()}startEditingProgress(e,t){this.editingProgressId.set(e),setTimeout(()=>{t.querySelector("input")?.select()},0)}finishEditingProgress(e,t){let i=t.target,r=parseFloat(i.value);if(!isNaN(r)&&r!==e.currentValue){let o=G(V({},e),{currentValue:r});if(o.currentValue>=o.targetValue)o.status="\u5DF2\u9054\u6210";else{let a=new Date().toISOString().split("T")[0];o.status=a>o.endDate?"\u672A\u9054\u6210":"\u9032\u884C\u4E2D"}this.dataService.updateTargetGoal(o),this.loadData()}this.editingProgressId.set(null)}requestDelete(e){this.goalToDelete.set(e)}confirmDelete(){this.goalToDelete()&&(this.dataService.deleteTargetGoal(this.goalToDelete().id),this.loadData(),this.cancelDelete())}cancelDelete(){this.goalToDelete.set(null)}getProgressBarWidth(e){return e.targetValue===0?0:Math.min(e.currentValue/e.targetValue*100,100)}getAssigneeName(e){return e?this.users().find(t=>t.id===e)?.name||"\u672A\u77E5\u4F7F\u7528\u8005":"\u5718\u968A\u76EE\u6A19"}getAssigneeAvatarUrl(e){let t=this.getAssigneeName(e);return`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=random&color=fff&font-size=0.5`}getDaysLeft(e){let t=new Date(e),i=new Date;t.setHours(0,0,0,0),i.setHours(0,0,0,0);let r=t.getTime()-i.getTime(),o=Math.ceil(r/(1e3*60*60*24));return o<0?{days:Math.abs(o),label:"\u5DF2\u903E\u671F"}:{days:o,label:"\u5929\u5269\u9918"}}getDaysLeftClass(e,t){return t==="\u5DF2\u903E\u671F"?"text-red-500":e<=7?"text-yellow-600":"text-gray-500"}getGoalTypeIcon(e){switch(e){case"\u71DF\u6536":return"cash-outline";case"\u6D3B\u52D5":return"calendar-outline";case"\u9867\u5BA2":return"people-outline";default:return"trophy-outline"}}getTypeClass(e){switch(e){case"\u71DF\u6536":return"bg-green-100 text-green-800";case"\u6D3B\u52D5":return"bg-purple-100 text-purple-800";case"\u9867\u5BA2":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}}getStatusClass(e){switch(e){case"\u9032\u884C\u4E2D":return"bg-blue-100 text-blue-800";case"\u5DF2\u9054\u6210":return"bg-green-100 text-green-800";case"\u672A\u9054\u6210":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}formatNumber(e){return e.toLocaleString("en-US")}};os.\u0275fac=function(t){return new(t||os)},os.\u0275cmp=re({type:os,selectors:[["app-goal-setting"]],decls:57,vars:7,consts:[["progressEditor",""],[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","add-outline"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","p-4","bg-white","rounded-xl","shadow-md"],["for","typeFilter",1,"text-sm","font-medium","text-gray-600"],["id","typeFilter",1,"w-full","mt-1","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-50",3,"ngModelChange","ngModel"],["value",""],[3,"value"],["for","statusFilter",1,"text-sm","font-medium","text-gray-600"],["id","statusFilter",1,"w-full","mt-1","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-50",3,"ngModelChange","ngModel"],["for","assigneeFilter",1,"text-sm","font-medium","text-gray-600"],["id","assigneeFilter",1,"w-full","mt-1","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-50",3,"ngModelChange","ngModel"],["value","team"],[1,"flex","items-end","justify-end"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-8","pt-4"],[1,"text-2xl","font-bold","text-gray-800","mb-4","pb-2","border-b-2","border-indigo-500","flex","items-center","gap-2"],["name","calendar-outline"],[1,"space-y-4"],[1,"bg-white","rounded-lg","shadow-sm","border","p-4","flex","flex-col","group","relative","transition-all","duration-300","hover:shadow-md","hover:border-indigo-300"],[1,"bg-white","p-6","rounded-xl","border","text-center","text-gray-500"],[1,"text-2xl","font-bold","text-gray-800","mb-4","pb-2","border-b-2","border-teal-500","flex","items-center","gap-2"],["name","podium-outline"],[1,"bg-white","rounded-lg","shadow-sm","border","p-4","flex","flex-col","group","relative","transition-all","duration-300","hover:shadow-md","hover:border-teal-300"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"flex","justify-between","items-start","gap-2"],[1,"font-bold","text-gray-800","group-hover:text-indigo-600","transition-colors"],[1,"flex","items-center","text-xs","font-medium","shrink-0",3,"class"],[1,"flex","items-center","gap-4","text-sm","text-gray-500","mt-2"],[1,"flex","items-center","gap-2"],["alt","avatar",1,"w-5","h-5","rounded-full",3,"src"],[1,"w-5","h-5","rounded-full","bg-gray-200","flex","items-center","justify-center"],[1,"font-medium","text-xs"],[1,"text-xs","font-semibold","px-2","py-0.5","rounded-full"],[1,"text-xs","font-semibold","px-2","py-1","rounded-full"],[1,"mt-3"],[1,"absolute","top-2","right-2","flex","items-center","gap-1","bg-white/50","backdrop-blur-sm","rounded-full","p-1","opacity-0","group-hover:opacity-100","transition-opacity","duration-300"],["title","\u7DE8\u8F2F",1,"text-gray-500","hover:text-indigo-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],["name","create-outline"],["title","\u522A\u9664",1,"text-gray-500","hover:text-red-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],["name","trash-outline"],[1,"flex","items-center","text-xs","font-medium","shrink-0"],["name","time-outline",1,"mr-1"],["name","people-outline",1,"text-gray-500","text-xs"],[1,"flex","justify-between","items-center","mb-1","text-xs","font-medium"],[1,"text-gray-600",3,"click"],["type","number",1,"w-20","p-0.5","text-center","border","border-indigo-500","rounded-md","bg-white","text-xs",3,"value"],[1,"font-semibold","text-indigo-600","p-1","cursor-pointer","hover:bg-gray-100","rounded-md"],[1,"w-full","bg-slate-100","rounded-full","h-1.5"],[1,"bg-indigo-600","h-1.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #818cf8, #4f46e5)",3,"width"],[1,"bg-green-500","h-1.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #4ade80, #16a34a)",3,"width"],["type","number",1,"w-20","p-0.5","text-center","border","border-indigo-500","rounded-md","bg-white","text-xs",3,"blur","keydown.enter","value"],[1,"bg-indigo-600","h-1.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #818cf8, #4f46e5)"],[1,"bg-green-500","h-1.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #4ade80, #16a34a)"],["name","trophy-outline",1,"text-4xl","text-gray-400"],[1,"mt-2"],[1,"font-bold","text-gray-800","group-hover:text-teal-600","transition-colors"],["title","\u7DE8\u8F2F",1,"text-gray-500","hover:text-teal-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],["type","number",1,"w-20","p-0.5","text-center","border","border-teal-500","rounded-md","bg-white","text-xs",3,"value"],[1,"font-semibold","text-teal-600","p-1","cursor-pointer","hover:bg-gray-100","rounded-md"],[1,"bg-teal-600","h-1.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #5eead4, #0d9488)",3,"width"],["type","number",1,"w-20","p-0.5","text-center","border","border-teal-500","rounded-md","bg-white","text-xs",3,"blur","keydown.enter","value"],[1,"bg-teal-600","h-1.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #5eead4, #0d9488)"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-lg","max-h-[90vh]","flex","flex-col","m-4"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],[1,"space-y-4",3,"ngSubmit","formGroup"],["for","title",1,"block","text-sm","font-medium","text-gray-700"],["id","title","formControlName","title",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],["for","type",1,"block","text-sm","font-medium","text-gray-700"],["id","type","formControlName","type",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","period",1,"block","text-sm","font-medium","text-gray-700"],["id","period","formControlName","period",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["value","monthly"],["value","yearly"],["for","unit",1,"block","text-sm","font-medium","text-gray-700"],["id","unit","formControlName","unit","placeholder","\u5143, \u5834, \u4EBA",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["for","currentValue",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","currentValue","formControlName","currentValue",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","targetValue",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","targetValue","formControlName","targetValue",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","startDate",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","startDate","formControlName","startDate",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","endDate",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","endDate","formControlName","endDate",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","assigneeId",1,"block","text-sm","font-medium","text-gray-700"],["id","assigneeId","formControlName","assigneeId",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","disabled:bg-indigo-300",3,"disabled"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","m-4"],[1,"p-6","text-center"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100"],["name","warning-outline",1,"h-6","w-6","text-red-600"],[1,"mt-4","text-lg","font-semibold","text-gray-900"],[1,"mt-2","text-sm","text-gray-500"],[1,"flex","justify-center","gap-4","bg-gray-50","px-6","py-4","rounded-b-xl"],["type","button",1,"px-4","py-2","bg-red-600","text-white","rounded-md","hover:bg-red-700",3,"click"]],template:function(t,i){if(t&1&&(l(0,"div",1)(1,"div",2)(2,"h1",3),d(3,"\u5718\u968A\u76EE\u6A19\u8A2D\u5B9A"),s(),l(4,"button",4),b("click",function(){return i.openModal(null)}),x(5,"ion-icon",5),l(6,"span"),d(7,"\u65B0\u589E\u5718\u968A\u76EE\u6A19"),s()()(),l(8,"div",6)(9,"div")(10,"label",7),d(11,"\u985E\u578B"),s(),l(12,"select",8),J("ngModelChange",function(o){return K(i.typeFilter,o)||(i.typeFilter=o),o}),l(13,"option",9),d(14,"\u6240\u6709\u985E\u578B"),s(),O(15,cH,2,2,"option",10,j),s()(),l(17,"div")(18,"label",11),d(19,"\u72C0\u614B"),s(),l(20,"select",12),J("ngModelChange",function(o){return K(i.statusFilter,o)||(i.statusFilter=o),o}),l(21,"option",9),d(22,"\u6240\u6709\u72C0\u614B"),s(),O(23,mH,2,2,"option",10,j),s()(),l(25,"div")(26,"label",13),d(27,"\u8CA0\u8CAC\u4EBA"),s(),l(28,"select",14),J("ngModelChange",function(o){return K(i.assigneeFilter,o)||(i.assigneeFilter=o),o}),l(29,"option",9),d(30,"\u6240\u6709\u4EBA"),s(),l(31,"option",15),d(32,"\u5718\u968A\u76EE\u6A19"),s(),O(33,pH,2,2,"option",10,vp),s()(),l(35,"div",16)(36,"button",17),b("click",function(){return i.resetFilters()}),x(37,"ion-icon",18),s()()(),l(38,"div",19)(39,"div")(40,"h2",20),x(41,"ion-icon",21),d(42," \u6708\u5EA6\u76EE\u6A19 "),s(),l(43,"div",22),O(44,bH,22,11,"div",23,vp,!1,EH,4,0,"div",24),s()(),l(47,"div")(48,"h2",25),x(49,"ion-icon",26),d(50," \u5E74\u5EA6\u76EE\u6A19 "),s(),l(51,"div",22),O(52,NH,22,11,"div",27,vp,!1,FH,4,0,"div",24),s()()()(),M(55,VH,63,3,"div",28),M(56,OH,14,1,"div",28)),t&2){let r;f(12),Y("ngModel",i.typeFilter),f(3),L(i.goalTypes),f(5),Y("ngModel",i.statusFilter),f(3),L(i.goalStatuses),f(5),Y("ngModel",i.assigneeFilter),f(5),L(i.users()),f(11),L(i.monthlyGoals()),f(8),L(i.yearlyGoals()),f(3),A(i.isModalOpen()?55:-1),f(),A((r=i.goalToDelete())?56:-1,r)}},dependencies:[oe,ke,Be,Fe,Pe,xe,kt,Re,me,Le,Ue,Ge,Se,Ie],encapsulation:2,changeDetection:0});var Cp=os;var LH=(n,e)=>e.targetId;function BH(n,e){if(n&1&&(l(0,"div",5)(1,"div",12),x(2,"ion-icon",13),l(3,"p",14),d(4),s()()()),n&2){let t=_();f(4),E(t.successMessage())}}function UH(n,e){if(n&1&&(l(0,"div",6)(1,"div",12),x(2,"ion-icon",15),l(3,"p",16),d(4),s()()()),n&2){let t=_();f(4),E(t.error())}}function $H(n,e){n&1&&(l(0,"div",8)(1,"div",17),x(2,"div",18),l(3,"p",19),d(4,"\u8F09\u5165\u8CC7\u6599\u4E2D..."),s()()())}function HH(n,e){if(n&1){let t=B();l(0,"tr",25)(1,"td",26),d(2),s(),l(3,"td",23),d(4),s(),l(5,"td",23),d(6),s(),l(7,"td",27),d(8),s(),l(9,"td",28),d(10),s(),l(11,"td",29),d(12),s(),l(13,"td",22)(14,"div",30)(15,"button",31),b("click",function(){let r=D(t).$implicit,o=_(2);return w(o.openEditForm(r))}),x(16,"ion-icon",32),s(),l(17,"button",33),b("click",function(){let r=D(t).$implicit,o=_(2);return w(o.deleteTarget(r))}),x(18,"ion-icon",34),s()()()()}if(n&2){let t=e.$implicit,i=_(2);f(2),k(" ",i.formatMonth(t.targetMonth)," "),f(2),k(" ",i.formatCurrency(t.monthlyRevenueTarget)," "),f(2),k(" ",i.formatCurrency(t.eventRevenueTarget)," "),f(2),k(" ",i.formatCurrency(t.totalTarget)," "),f(2),k(" ",i.formatCurrency(t.dailyAvgTarget)," "),f(2),k(" ",t.remark||"-"," ")}}function GH(n,e){n&1&&(l(0,"tr")(1,"td",35),d(2," \u5C1A\u7121\u8CC7\u6599 "),s()())}function qH(n,e){if(n&1&&(l(0,"div",9)(1,"table",20)(2,"thead",21)(3,"tr")(4,"th",22),d(5,"\u6708\u4EFD"),s(),l(6,"th",23),d(7,"\u6708\u71DF\u696D\u76EE\u6A19"),s(),l(8,"th",23),d(9,"\u6D3B\u52D5\u71DF\u6536\u76EE\u6A19"),s(),l(10,"th",23),d(11,"\u7E3D\u76EE\u6A19"),s(),l(12,"th",23),d(13,"\u65E5\u5747\u76EE\u6A19"),s(),l(14,"th",22),d(15,"\u5099\u8A3B"),s(),l(16,"th",24),d(17,"\u64CD\u4F5C"),s()()(),l(18,"tbody"),O(19,HH,19,6,"tr",25,LH,!1,GH,3,0,"tr"),s()()()),n&2){let t=_();f(19),L(t.targets())}}function WH(n,e){n&1&&(l(0,"div",10),x(1,"ion-icon",36),l(2,"p",37),d(3,"\u5C1A\u7121\u71DF\u6536\u76EE\u6A19\u8CC7\u6599"),s(),l(4,"p",38),d(5,"\u9EDE\u64CA\u4E0A\u65B9\u300C\u65B0\u589E\u76EE\u6A19\u300D\u6309\u9215\u958B\u59CB\u8A2D\u5B9A"),s()())}function jH(n,e){if(n&1&&(l(0,"div",6)(1,"div",12),x(2,"ion-icon",57),l(3,"p",58),d(4),s()()()),n&2){let t=_(2);f(4),E(t.formError())}}function zH(n,e){n&1&&(l(0,"p",48),d(1,"\u6708\u4EFD\u4E0D\u53EF\u4FEE\u6539"),s())}function YH(n,e){n&1&&(x(0,"div",59),l(1,"span"),d(2,"\u8655\u7406\u4E2D..."),s())}function JH(n,e){if(n&1&&(x(0,"ion-icon",60),l(1,"span"),d(2),s()),n&2){let t=_(2);f(2),E(t.isEditing()?"\u66F4\u65B0":"\u65B0\u589E")}}function KH(n,e){if(n&1){let t=B();l(0,"div",11)(1,"div",39)(2,"div",40)(3,"h2",41),d(4),s(),l(5,"button",42),b("click",function(){D(t);let r=_();return w(r.closeForm())}),x(6,"ion-icon",43),s()(),l(7,"div",44),M(8,jH,5,1,"div",6),l(9,"div")(10,"label",45),d(11," \u6708\u4EFD "),l(12,"span",46),d(13,"*"),s()(),l(14,"input",47),b("ngModelChange",function(r){D(t);let o=_();return w(o.updateTargetMonth(r))}),s(),M(15,zH,2,0,"p",48),s(),l(16,"div")(17,"label",45),d(18," \u6708\u71DF\u696D\u76EE\u6A19 "),l(19,"span",46),d(20,"*"),s()(),l(21,"div",49)(22,"span",50),d(23,"NT$"),s(),l(24,"input",51),b("ngModelChange",function(r){D(t);let o=_();return w(o.updateMonthlyRevenueTarget(r))}),s()()(),l(25,"div")(26,"label",45),d(27," \u6D3B\u52D5\u71DF\u6536\u76EE\u6A19 "),s(),l(28,"div",49)(29,"span",50),d(30,"NT$"),s(),l(31,"input",52),b("ngModelChange",function(r){D(t);let o=_();return w(o.updateEventRevenueTarget(r))}),s()(),l(32,"p",48),d(33,"\u7279\u6B8A\u6D3B\u52D5\u6216\u4FC3\u92B7\u7684\u9810\u671F\u71DF\u6536\uFF08\u53EF\u9078\uFF09"),s()(),l(34,"div")(35,"label",45),d(36," \u5099\u8A3B "),s(),l(37,"textarea",53),b("ngModelChange",function(r){D(t);let o=_();return w(o.updateRemark(r))}),s()()(),l(38,"div",54)(39,"button",55),b("click",function(){D(t);let r=_();return w(r.closeForm())}),d(40," \u53D6\u6D88 "),s(),l(41,"button",56),b("click",function(){D(t);let r=_();return w(r.submitForm())}),M(42,YH,3,0)(43,JH,3,1),s()()()()}if(n&2){let t=_();f(4),k(" ",t.isEditing()?"\u7DE8\u8F2F\u71DF\u6536\u76EE\u6A19":"\u65B0\u589E\u71DF\u6536\u76EE\u6A19"," "),f(4),A(t.formError()?8:-1),f(6),I("ngModel",t.formData().targetMonth)("disabled",t.isEditing()),f(),A(t.isEditing()?15:-1),f(9),I("ngModel",t.formData().monthlyRevenueTarget),f(7),I("ngModel",t.formData().eventRevenueTarget),f(6),I("ngModel",t.formData().remark),f(2),I("disabled",t.isSaving()),f(2),I("disabled",t.isSaving()),f(),A(t.isSaving()?42:43)}}var as=class as{constructor(){this.apiService=P(Xe);this.targets=S([]);this.isLoading=S(!1);this.error=S(null);this.showForm=S(!1);this.isEditing=S(!1);this.formData=S({targetId:null,targetMonth:"",monthlyRevenueTarget:0,eventRevenueTarget:0,remark:""});this.formError=S(null);this.isSaving=S(!1);this.successMessage=S(null)}ngOnInit(){this.loadTargets()}async loadTargets(){this.isLoading.set(!0),this.error.set(null);try{let e=await this.apiService.getMonthlyTargets();if(e.success)this.targets.set(e.data||[]),console.log("\u2713 \u8F09\u5165\u6708\u5EA6\u71DF\u6536\u76EE\u6A19\u6210\u529F:",e.data.length,"\u7B46\u8A18\u9304");else throw new Error(e.error||"\u8F09\u5165\u5931\u6557")}catch(e){console.error("\u274C \u8F09\u5165\u6708\u5EA6\u71DF\u6536\u76EE\u6A19\u5931\u6557:",e);let t=e instanceof Error?e.message:"\u8F09\u5165\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66";this.error.set(t)}finally{this.isLoading.set(!1)}}openAddForm(){this.isEditing.set(!1),this.formData.set({targetId:null,targetMonth:"",monthlyRevenueTarget:0,eventRevenueTarget:0,remark:""}),this.formError.set(null),this.showForm.set(!0)}openEditForm(e){this.isEditing.set(!0),this.formData.set({targetId:e.targetId,targetMonth:e.targetMonth.substring(0,7),monthlyRevenueTarget:e.monthlyRevenueTarget,eventRevenueTarget:e.eventRevenueTarget,remark:e.remark||""}),this.formError.set(null),this.showForm.set(!0)}closeForm(){this.showForm.set(!1),this.formError.set(null),this.formData.set({targetId:null,targetMonth:"",monthlyRevenueTarget:0,eventRevenueTarget:0,remark:""})}validateForm(){let e=this.formData();return e.targetMonth?e.monthlyRevenueTarget<0?"\u6708\u71DF\u696D\u76EE\u6A19\u4E0D\u53EF\u70BA\u8CA0\u6578":e.eventRevenueTarget<0?"\u6D3B\u52D5\u71DF\u6536\u76EE\u6A19\u4E0D\u53EF\u70BA\u8CA0\u6578":null:"\u8ACB\u9078\u64C7\u6708\u4EFD"}async submitForm(){let e=this.validateForm();if(e){this.formError.set(e);return}this.isSaving.set(!0),this.formError.set(null),this.successMessage.set(null);try{let t=this.formData(),i={targetMonth:`${t.targetMonth}-01`,monthlyRevenueTarget:t.monthlyRevenueTarget,eventRevenueTarget:t.eventRevenueTarget,remark:t.remark||null},r;if(this.isEditing()&&t.targetId?(r=await this.apiService.updateMonthlyTarget(V({targetId:t.targetId},i)),this.successMessage.set("\u66F4\u65B0\u6210\u529F\uFF01")):(r=await this.apiService.createMonthlyTarget(i),this.successMessage.set("\u65B0\u589E\u6210\u529F\uFF01")),r.success)await this.loadTargets(),this.closeForm(),setTimeout(()=>this.successMessage.set(null),3e3);else throw new Error(r.error||"\u64CD\u4F5C\u5931\u6557")}catch(t){console.error("\u274C \u63D0\u4EA4\u8868\u55AE\u5931\u6557:",t);let i=t instanceof Error?t.message:"\u64CD\u4F5C\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66";t.message?.includes("\u5DF2\u5B58\u5728")&&(i="\u8A72\u6708\u4EFD\u7684\u71DF\u6536\u76EE\u6A19\u5DF2\u5B58\u5728\uFF0C\u8ACB\u4F7F\u7528\u7DE8\u8F2F\u529F\u80FD\u9032\u884C\u4FEE\u6539"),this.formError.set(i)}finally{this.isSaving.set(!1)}}async deleteTarget(e){if(confirm(`\u78BA\u5B9A\u8981\u522A\u9664 ${this.formatMonth(e.targetMonth)} \u7684\u71DF\u6536\u76EE\u6A19\u55CE\uFF1F`)){this.isLoading.set(!0),this.error.set(null),this.successMessage.set(null);try{let i=await this.apiService.deleteMonthlyTarget(e.targetId);if(i.success)this.successMessage.set("\u522A\u9664\u6210\u529F\uFF01"),await this.loadTargets(),setTimeout(()=>this.successMessage.set(null),3e3);else throw new Error(i.error||"\u522A\u9664\u5931\u6557")}catch(i){console.error("\u274C \u522A\u9664\u5931\u6557:",i);let r=i instanceof Error?i.message:"\u522A\u9664\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66";this.error.set(r)}finally{this.isLoading.set(!1)}}}formatMonth(e){if(!e)return"";let t=new Date(e),i=t.getFullYear(),r=t.getMonth()+1;return`${i}\u5E74${r}\u6708`}formatCurrency(e){return e==null?"NT$0":`NT$${e.toLocaleString("zh-TW",{minimumFractionDigits:0,maximumFractionDigits:0})}`}updateTargetMonth(e){this.formData.update(t=>G(V({},t),{targetMonth:e}))}updateMonthlyRevenueTarget(e){this.formData.update(t=>G(V({},t),{monthlyRevenueTarget:+e}))}updateEventRevenueTarget(e){this.formData.update(t=>G(V({},t),{eventRevenueTarget:+e}))}updateRemark(e){this.formData.update(t=>G(V({},t),{remark:e}))}};as.\u0275fac=function(t){return new(t||as)},as.\u0275cmp=re({type:as,selectors:[["app-monthly-targets"]],decls:15,vars:6,consts:[[1,"space-y-8"],[1,"flex","items-center","justify-between"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2",3,"click"],["name","add-outline",1,"text-xl"],[1,"bg-green-50","border-l-4","border-green-500","p-4","rounded-lg"],[1,"bg-red-50","border-l-4","border-red-500","p-4","rounded-lg"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"flex","items-center","justify-center","h-64"],[1,"overflow-x-auto"],[1,"flex","flex-col","items-center","justify-center","h-64","text-gray-500"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50","p-4"],[1,"flex","items-center","gap-3"],["name","checkmark-circle",1,"text-2xl","text-green-600"],[1,"text-green-900","font-medium"],["name","alert-circle-outline",1,"text-2xl","text-red-600"],[1,"text-red-900","font-medium"],[1,"flex","flex-col","items-center","space-y-2"],[1,"w-8","h-8","border-3","border-indigo-200","border-t-indigo-600","rounded-full","animate-spin"],[1,"text-sm","text-gray-500"],[1,"w-full","text-sm","text-left"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50"],[1,"py-3","px-4"],[1,"py-3","px-4","text-right"],[1,"py-3","px-4","text-center"],[1,"border-b","hover:bg-gray-50","transition-colors"],[1,"py-3","px-4","font-medium","text-gray-900"],[1,"py-3","px-4","text-right","font-semibold","text-indigo-600"],[1,"py-3","px-4","text-right","text-gray-600"],[1,"py-3","px-4","text-gray-600"],[1,"flex","items-center","justify-center","gap-2"],["title","\u7DE8\u8F2F",1,"text-indigo-600","hover:text-indigo-800","p-1","rounded","transition-colors",3,"click"],["name","create-outline",1,"text-xl"],["title","\u522A\u9664",1,"text-red-600","hover:text-red-800","p-1","rounded","transition-colors",3,"click"],["name","trash-outline",1,"text-xl"],["colspan","7",1,"py-8","text-center","text-gray-500"],["name","document-text-outline",1,"text-6xl","mb-4"],[1,"text-lg","font-medium"],[1,"text-sm","mt-2"],[1,"bg-white","rounded-xl","shadow-xl","max-w-2xl","w-full","max-h-[90vh]","overflow-y-auto"],[1,"flex","items-center","justify-between","p-6","border-b"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-400","hover:text-gray-600","transition-colors",3,"click"],["name","close-outline",1,"text-3xl"],[1,"p-6","space-y-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"text-red-500"],["type","month","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500","disabled:bg-gray-100","disabled:cursor-not-allowed",3,"ngModelChange","ngModel","disabled"],[1,"mt-1","text-xs","text-gray-500"],[1,"relative"],[1,"absolute","left-3","top-1/2","-translate-y-1/2","text-gray-500"],["type","number","min","0","step","1000","placeholder","0","required","",1,"w-full","pl-12","pr-3","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500",3,"ngModelChange","ngModel"],["type","number","min","0","step","1000","placeholder","0",1,"w-full","pl-12","pr-3","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500",3,"ngModelChange","ngModel"],["rows","3","placeholder","\u8F38\u5165\u5099\u8A3B\uFF08\u53EF\u9078\uFF09",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500","resize-none",3,"ngModelChange","ngModel"],[1,"flex","items-center","justify-end","gap-3","p-6","border-t","bg-gray-50"],[1,"px-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","hover:bg-gray-50","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"px-4","py-2","bg-indigo-600","text-white","rounded-lg","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["name","alert-circle-outline",1,"text-2xl","text-red-600","flex-shrink-0"],[1,"text-red-900","text-sm"],[1,"w-4","h-4","border-2","border-white","border-t-transparent","rounded-full","animate-spin"],["name","checkmark-outline",1,"text-xl"]],template:function(t,i){t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),d(3,"\u71DF\u6536\u76EE\u6A19"),s(),l(4,"button",3),b("click",function(){return i.openAddForm()}),x(5,"ion-icon",4),l(6,"span"),d(7,"\u65B0\u589E\u76EE\u6A19"),s()()(),M(8,BH,5,1,"div",5),M(9,UH,5,1,"div",6),l(10,"div",7),M(11,$H,5,0,"div",8),M(12,qH,22,1,"div",9),M(13,WH,6,0,"div",10),s(),M(14,KH,44,11,"div",11),s()),t&2&&(f(8),A(i.successMessage()?8:-1),f(),A(i.error()?9:-1),f(2),A(i.isLoading()?11:-1),f(),A(!i.isLoading()&&i.targets().length>0?12:-1),f(),A(!i.isLoading()&&i.targets().length===0&&!i.error()?13:-1),f(),A(i.showForm()?14:-1))},dependencies:[oe,Se,xe,kt,me,jh,po,Ie],encapsulation:2});var xp=as;function QH(n,e){if(n&1&&(tt(0,"div",4),d(1),nt()),n&2){let t=_();f(),k(" ",t.error()," ")}}var ss=class ss{constructor(e,t){this.authService=e;this.router=t;this.error=S(null)}ngOnInit(){this.authService.isAuthenticated()&&this.router.navigate(["/dashboard"]),this.loadGoogleSignInScript()}loadGoogleSignInScript(){if(window.google){this.initializeGoogleSignIn();return}let e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.onload=()=>this.initializeGoogleSignIn(),document.head.appendChild(e)}initializeGoogleSignIn(){let e="957974561982-c8gfted5logjoglj8hspaiad8q8jpl1g.apps.googleusercontent.com";if(!e||e.includes("YOUR_")){console.warn("Google Client ID not configured. Please set VITE_GOOGLE_CLIENT_ID environment variable."),this.error.set("\u7CFB\u7D71\u672A\u6B63\u78BA\u914D\u7F6E Google OAuth\u3002\u8ACB\u806F\u7D61\u7BA1\u7406\u54E1\u3002");return}try{window.google.accounts.id.initialize({client_id:e,callback:i=>this.handleGoogleLogin(i)});let t=document.getElementById("google-signin-button");t&&window.google.accounts.id.renderButton(t,{theme:"outline",size:"large",width:"100%"})}catch(t){console.error("Failed to initialize Google Sign-In:",t),this.error.set("\u7121\u6CD5\u521D\u59CB\u5316 Google \u767B\u5165")}}async handleGoogleLogin(e){try{e.credential&&(await this.authService.loginWithGoogle(e.credential)?this.router.navigate(["/dashboard"]):this.error.set(this.authService.error()||"Google \u767B\u5165\u5931\u6557"))}catch(t){console.error("Login error:",t),this.error.set("\u767B\u5165\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}}};ss.\u0275fac=function(t){return new(t||ss)(X(rt),X(Ve))},ss.\u0275cmp=re({type:ss,selectors:[["app-login"]],decls:15,vars:1,consts:[[1,"login-container"],[1,"login-box"],[1,"login-header"],[1,"subtitle"],[1,"error-message"],[1,"login-method"],["id","google-signin-button",1,"google-button-container"],[1,"footer-info"]],template:function(t,i){t&1&&(tt(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),d(4,"Galaxy House Finance"),nt(),tt(5,"p",3),d(6,"\u7BA1\u7406\u7CFB\u7D71\u767B\u5165"),nt()(),M(7,QH,2,1,"div",4),tt(8,"div",5),qi(9,"div",6),nt(),tt(10,"div",7)(11,"p"),d(12,"\u6B64\u7CFB\u7D71\u9700\u8981\u4F7F\u7528 Google \u5E33\u865F\u767B\u5165"),nt(),tt(13,"p"),d(14,"\u5982\u6709\u554F\u984C\uFF0C\u8ACB\u806F\u7D61\u7BA1\u7406\u54E1"),nt()()()()),t&2&&(f(7),A(i.error()?7:-1))},dependencies:[oe,Se],styles:[".login-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background:linear-gradient(135deg,#8c4f28,#000);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;padding:20px}.login-box[_ngcontent-%COMP%]{background:#efd07f;padding:40px;border-radius:12px;box-shadow:0 10px 40px #0000001a;width:100%;max-width:400px}.login-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:30px}h1[_ngcontent-%COMP%]{color:#333;margin:0 0 8px;font-size:28px;font-weight:700}.subtitle[_ngcontent-%COMP%]{color:#666;margin:0;font-size:14px}.login-method[_ngcontent-%COMP%]{margin-bottom:20px}.google-button-container[_ngcontent-%COMP%]{margin-bottom:15px}.google-login-btn[_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid #ddd;border-radius:6px;background:#fff;color:#333;font-size:14px;font-weight:500;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:10px;transition:all .3s ease}.google-login-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#f8f8f8;border-color:#ccc;box-shadow:0 2px 8px #0000001a}.error-message[_ngcontent-%COMP%]{background-color:#fee;color:#c00;padding:12px;border-radius:6px;font-size:13px;margin-bottom:20px;border:1px solid #fcc}.footer-info[_ngcontent-%COMP%]{text-align:center;margin-top:30px;color:#999;font-size:12px;line-height:1.6}.footer-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0}"]});var bp=ss;function ZH(n,e){if(n&1&&(l(0,"div",29),d(1),s()),n&2){let t=_();f(),k(" ",t.successMessage()," ")}}function XH(n,e){if(n&1&&(l(0,"span",30),d(1),s()),n&2){let t=e.$implicit;f(),k(" ",t.display_name," ")}}function eG(n,e){if(n&1&&(l(0,"div",31)(1,"span",32),d(2),s()()),n&2){let t=e.$implicit;f(2),E(t)}}function tG(n,e){n&1&&(l(0,"div",33),d(1,"\u8F09\u5165\u4E2D..."),s())}function nG(n,e){if(n&1&&(l(0,"div",34),d(1),s()),n&2){let t=_();f(),E(t.error())}}var ls=class ls{constructor(e,t){this.http=e;this.authService=t;this.baseUrl=`${_n.apiUrl}/admin`;this.profileData=S(null);this.isLoading=S(!1);this.isUpdating=S(!1);this.error=S(null);this.successMessage=S(null);this.formData={name:"",avatarUrl:""}}ngOnInit(){this.loadProfile()}loadProfile(){this.isLoading.set(!0),this.error.set(null);let e=this.getAuthHeaders();if(!e){this.error.set("\u5C1A\u672A\u767B\u5165\uFF0C\u8ACB\u91CD\u65B0\u767B\u5165"),this.isLoading.set(!1);return}this.http.get(`${this.baseUrl}/profile`,{headers:e}).subscribe({next:t=>{this.profileData.set(t.data),this.formData={name:t.data.name,avatarUrl:t.data.avatarUrl||""},this.isLoading.set(!1)},error:t=>{console.error("Profile load error:",t);let i="\u8F09\u5165\u500B\u4EBA\u8CC7\u6599\u5931\u6557";t.status===401?i="\u8A8D\u8B49\u5931\u6557\uFF0C\u8ACB\u91CD\u65B0\u767B\u5165":t.status===404?i="\u627E\u4E0D\u5230\u5E33\u865F\u8CC7\u8A0A":t.error?.error&&(i=t.error.error),this.error.set(i),this.isLoading.set(!1)}})}updateProfile(){this.isUpdating.set(!0),this.successMessage.set(null);let e=this.getAuthHeaders();if(!e){this.error.set("\u5C1A\u672A\u767B\u5165"),this.isUpdating.set(!1);return}this.http.put(`${this.baseUrl}/profile`,this.formData,{headers:e}).subscribe({next:()=>{this.successMessage.set("\u500B\u4EBA\u8CC7\u6599\u5DF2\u6210\u529F\u66F4\u65B0"),this.isUpdating.set(!1),this.loadProfile(),setTimeout(()=>{this.successMessage.set(null)},3e3)},error:t=>{this.error.set(t.error?.error||"\u66F4\u65B0\u5931\u6557"),this.isUpdating.set(!1)}})}getStatusLabel(e){return{active:"\u555F\u7528",inactive:"\u505C\u7528",suspended:"\u66AB\u505C"}[e||""]||e||"-"}formatDate(e){return e?new Date(e).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-"}getAuthHeaders(){let e=this.authService.getToken();return e?new Ot({Authorization:`Bearer ${e}`,"Content-Type":"application/json"}):null}};ls.\u0275fac=function(t){return new(t||ls)(X(Zt),X(rt))},ls.\u0275cmp=re({type:ls,selectors:[["app-account"]],decls:69,vars:20,consts:[[1,"account-container"],[1,"account-layout"],[1,"profile-section"],[1,"profile-header"],[1,"profile-avatar"],["alt","Avatar",3,"src"],[1,"profile-info"],[1,"status"],[1,"profile-details"],[1,"detail-row"],[1,"value"],[1,"edit-section"],[3,"ngSubmit"],[1,"form-group"],["type","text","name","name","placeholder","\u8F38\u5165\u60A8\u7684\u59D3\u540D",3,"ngModelChange","ngModel"],["type","url","name","avatarUrl","placeholder","https://...",3,"ngModelChange","ngModel"],["type","submit",3,"disabled"],["class","success-message",4,"ngIf"],[1,"roles-section"],[1,"roles-container"],[1,"role-list"],["class","role-badge",4,"ngFor","ngForOf"],[1,"permissions-container"],[1,"permissions-grid"],["class","permission-item",4,"ngFor","ngForOf"],[1,"activity-section"],[1,"activity-info"],["class","loading",4,"ngIf"],["class","error-message",4,"ngIf"],[1,"success-message"],[1,"role-badge"],[1,"permission-item"],[1,"permission-code"],[1,"loading"],[1,"error-message"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"h2"),d(2,"\u6211\u7684\u5E33\u865F"),s(),l(3,"div",1)(4,"div",2)(5,"div",3)(6,"div",4),x(7,"img",5),s(),l(8,"div",6)(9,"h3"),d(10),s(),l(11,"p"),d(12),s(),l(13,"p",7),d(14),s()()(),l(15,"div",8)(16,"div",9)(17,"label"),d(18,"\u5E33\u865F\u72C0\u614B\uFF1A"),s(),l(19,"span",10),d(20),s()(),l(21,"div",9)(22,"label"),d(23,"\u5EFA\u7ACB\u6642\u9593\uFF1A"),s(),l(24,"span",10),d(25),s()(),l(26,"div",9)(27,"label"),d(28,"\u6700\u5F8C\u767B\u5165\uFF1A"),s(),l(29,"span",10),d(30),s()()()(),l(31,"div",11)(32,"h3"),d(33,"\u7DE8\u8F2F\u500B\u4EBA\u8CC7\u6599"),s(),l(34,"form",12),b("ngSubmit",function(){return i.updateProfile()}),l(35,"div",13)(36,"label"),d(37,"\u59D3\u540D"),s(),l(38,"input",14),J("ngModelChange",function(o){return K(i.formData.name,o)||(i.formData.name=o),o}),s()(),l(39,"div",13)(40,"label"),d(41,"\u982D\u50CF URL"),s(),l(42,"input",15),J("ngModelChange",function(o){return K(i.formData.avatarUrl,o)||(i.formData.avatarUrl=o),o}),s()(),l(43,"button",16),d(44),s(),vt(45,ZH,2,1,"div",17),s()(),l(46,"div",18)(47,"h3"),d(48,"\u89D2\u8272\u548C\u6B0A\u9650"),s(),l(49,"div",19)(50,"h4"),d(51,"\u6211\u7684\u89D2\u8272"),s(),l(52,"div",20),vt(53,XH,2,1,"span",21),s()(),l(54,"div",22)(55,"h4"),d(56,"\u6211\u7684\u6B0A\u9650"),s(),l(57,"div",23),vt(58,eG,3,1,"div",24),s()()(),l(59,"div",25)(60,"h3"),d(61,"\u6700\u8FD1\u6D3B\u52D5"),s(),l(62,"div",26)(63,"p"),d(64),s(),l(65,"p"),d(66),s()()()(),vt(67,tG,2,0,"div",27)(68,nG,2,1,"div",28),s()),t&2){let r,o,a,u,c,m,h,y,v,C,T,R;f(7),I("src",((r=i.profileData())==null?null:r.avatarUrl)||"https://via.placeholder.com/100",Ft),f(3),E((o=i.profileData())==null?null:o.name),f(2),E((a=i.profileData())==null?null:a.email),f(),De("status-"+((u=i.profileData())==null?null:u.status)),f(),k(" ",i.getStatusLabel((c=i.profileData())==null?null:c.status)," "),f(6),E(i.getStatusLabel((m=i.profileData())==null?null:m.status)),f(5),E(i.formatDate((h=i.profileData())==null?null:h.createdAt)),f(5),E(i.formatDate((y=i.profileData())==null?null:y.lastLoginAt)),f(8),Y("ngModel",i.formData.name),f(4),Y("ngModel",i.formData.avatarUrl),f(),I("disabled",i.isUpdating()),f(),k(" ",i.isUpdating()?"\u4FDD\u5B58\u4E2D...":"\u4FDD\u5B58\u4FEE\u6539"," "),f(),I("ngIf",i.successMessage()),f(8),I("ngForOf",(v=i.profileData())==null?null:v.roles),f(5),I("ngForOf",(C=i.profileData())==null?null:C.permissions),f(6),k("\u6700\u5F8C\u767B\u5165\u6642\u9593\uFF1A",i.formatDate((T=i.profileData())==null?null:T.lastLoginAt)),f(2),k("\u5E33\u865F\u5EFA\u7ACB\u6642\u9593\uFF1A",i.formatDate((R=i.profileData())==null?null:R.createdAt)),f(),I("ngIf",i.isLoading()),f(),I("ngIf",i.error())}},dependencies:[oe,na,ji,Se,Be,xe,me,Le,Ie,$l],styles:[".account-container[_ngcontent-%COMP%]{padding:20px;max-width:1000px;margin:0 auto}h2[_ngcontent-%COMP%]{margin-bottom:30px;color:#333}.account-layout[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:30px}.profile-section[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:8px;box-shadow:0 2px 8px #0000001a}.profile-header[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:20px;padding-bottom:20px;border-bottom:1px solid #eee}.profile-avatar[_ngcontent-%COMP%]{width:100px;height:100px;border-radius:50%;overflow:hidden;flex-shrink:0}.profile-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.profile-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 5px;color:#333}.profile-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#666;font-size:13px}.status[_ngcontent-%COMP%]{padding:4px 8px;border-radius:4px;font-size:12px;display:inline-block;margin-top:8px}.status-active[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724}.status-inactive[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24}.status-suspended[_ngcontent-%COMP%]{background-color:#fff3cd;color:#856404}.profile-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.detail-row[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#333}.detail-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#666}.edit-section[_ngcontent-%COMP%], .roles-section[_ngcontent-%COMP%], .activity-section[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:8px;box-shadow:0 2px 8px #0000001a}h3[_ngcontent-%COMP%]{margin-top:0;margin-bottom:15px;color:#333;font-size:16px}h4[_ngcontent-%COMP%]{margin-bottom:10px;color:#333;font-size:14px}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:5px;font-weight:600;color:#333;font-size:13px}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ddd;border-radius:4px;font-size:13px;box-sizing:border-box}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3f51b5;box-shadow:0 0 0 3px #3f51b51a}button[type=submit][_ngcontent-%COMP%]{background-color:#3f51b5;color:#fff;padding:10px 20px;border:none;border-radius:4px;cursor:pointer;font-size:13px;font-weight:600}button[type=submit][_ngcontent-%COMP%]:hover:not(:disabled){background-color:#303c7e}button[type=submit][_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.role-badge[_ngcontent-%COMP%]{display:inline-block;background-color:#e0e7ff;color:#3f51b5;padding:6px 12px;border-radius:4px;font-size:12px;margin-right:8px;margin-bottom:8px}.role-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.permissions-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:10px}.permission-item[_ngcontent-%COMP%]{background-color:#f5f5f5;padding:8px;border-radius:4px;border-left:3px solid #3f51b5;font-size:12px}.permission-code[_ngcontent-%COMP%]{font-family:Courier New,monospace;color:#333}.success-message[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724;padding:10px;border-radius:4px;font-size:12px;margin-top:10px;border:1px solid #c3e6cb}.error-message[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24;padding:10px;border-radius:4px;font-size:12px;margin-top:10px;border:1px solid #f5c6cb}.activity-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.activity-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#666;font-size:13px}.loading[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#666}@media (max-width: 768px){.account-layout[_ngcontent-%COMP%]{grid-template-columns:1fr}.profile-header[_ngcontent-%COMP%]{flex-direction:column;align-items:center;text-align:center}.permissions-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]});var Ep=ls;var iG=(n,e)=>e.role_id,rG=(n,e)=>e.permission_id;function oG(n,e){if(n&1&&(l(0,"div",4)(1,"p",23),d(2),s()()),n&2){let t=_();f(2),E(t.error())}}function aG(n,e){if(n&1&&(l(0,"div",5)(1,"p",24),d(2),s()()),n&2){let t=_();f(2),E(t.successMessage())}}function sG(n,e){n&1&&(l(0,"div",18),d(1,"\u8F09\u5165\u4E2D..."),s())}function lG(n,e){n&1&&(l(0,"div",18),d(1,"\u6C92\u6709\u53EF\u7DE8\u8F2F\u7684\u89D2\u8272"),s())}function uG(n,e){if(n&1){let t=B();l(0,"div",26)(1,"div",27)(2,"button",28),b("click",function(){let r=D(t).$implicit,o=_(2);return w(o.selectRole(r))}),l(3,"div",29),d(4),s(),l(5,"div",30),d(6),s(),l(7,"div",31),d(8),s()(),l(9,"div",32)(10,"button",33),b("click",function(){let r=D(t).$implicit,o=_(2);return w(o.openEditRoleDialog(r))}),Li(),l(11,"svg",34),x(12,"path",35),s()(),Hr(),l(13,"button",36),b("click",function(){let r=D(t).$implicit,o=_(2);return w(o.openDeleteDialog(r))}),Li(),l(14,"svg",34),x(15,"path",37),s()()()()()}if(n&2){let t,i,r,o=e.$implicit,a=_(2);W("bg-blue-50",((t=a.selectedRole())==null?null:t.role_id)===o.role_id)("border-l-4",((i=a.selectedRole())==null?null:i.role_id)===o.role_id)("border-l-blue-500",((r=a.selectedRole())==null?null:r.role_id)===o.role_id),f(4),E(o.display_name),f(2),E(o.role_name),f(2),k(" ",o.permission_count||0," \u500B\u6B0A\u9650\u5DF2\u914D\u7F6E ")}}function dG(n,e){if(n&1&&O(0,uG,16,9,"div",25,iG),n&2){let t=_();L(t.filteredRoles())}}function cG(n,e){n&1&&(l(0,"div",20)(1,"p",38),d(2,"\u8ACB\u9078\u64C7\u4E00\u500B\u89D2\u8272\u958B\u59CB\u914D\u7F6E\u6B0A\u9650"),s()())}function mG(n,e){n&1&&(l(0,"div",48),d(1,"\u8F09\u5165\u6B0A\u9650\u4E2D..."),s())}function pG(n,e){n&1&&(l(0,"div",48),d(1,"\u6C92\u6709\u53EF\u7528\u7684\u6B0A\u9650"),s())}function fG(n,e){if(n&1){let t=B();l(0,"div",60)(1,"input",61),b("change",function(){let r=D(t).$implicit,o=_(5);return w(o.togglePermission(r.permission_id,o.selectedPermissions().has(r.permission_id)))}),s(),l(2,"div",62)(3,"label",63),d(4),s(),l(5,"p",64),d(6),s(),l(7,"code",65),d(8),s()()()}if(n&2){let t=e.$implicit,i=_(5);f(),I("checked",i.selectedPermissions().has(t.permission_id))("disabled",i.isSaving()),f(3),k(" ",t.display_name," "),f(2),k(" ",t.description," "),f(2),k(" ",t.permission_code," ")}}function gG(n,e){if(n&1&&O(0,fG,9,5,"div",60,rG),n&2){let t=_().$implicit,i=_(3);L(i.permissionsByCategory()[t])}}function hG(n,e){n&1&&(l(0,"div",59),d(1,"\u6B64\u5206\u985E\u6C92\u6709\u6B0A\u9650"),s())}function yG(n,e){if(n&1){let t=B();l(0,"div",52)(1,"div",53)(2,"div",54)(3,"input",55),b("change",function(){let r=D(t).$implicit,o=_(3);return w(o.isCategoryFullySelected(r)?o.deselectAllInCategory(r):o.selectAllInCategory(r))}),s(),l(4,"div")(5,"h3",56),d(6),s(),l(7,"p",57),d(8),s()()()(),l(9,"div",58),M(10,gG,2,0)(11,hG,2,0,"div",59),s()()}if(n&2){let t=e.$implicit,i=_(3);f(3),I("checked",i.isCategoryFullySelected(t)),f(3),k(" ",t," "),f(2),Ke(" ",i.getCategoryAssignedCount(t)," / ",i.permissionsByCategory()[t].length," "),f(2),A(i.permissionsByCategory()[t]&&i.permissionsByCategory()[t].length>0?10:11)}}function _G(n,e){if(n&1&&O(0,yG,12,5,"div",52,j),n&2){let t=_(2);L(t.categoryCount().categories)}}function vG(n,e){if(n&1){let t=B();l(0,"div",8)(1,"div",39)(2,"div",10)(3,"div")(4,"h2",40),d(5),s(),l(6,"p",12),d(7),s()(),l(8,"div",41)(9,"div",42),d(10),s()()()(),l(11,"div",43)(12,"button",44),b("click",function(){D(t);let r=_();return w(r.selectAllPermissions())}),d(13," \u5168\u9078\u6240\u6709 "),s(),l(14,"button",45),b("click",function(){D(t);let r=_();return w(r.clearAllPermissions())}),d(15," \u5168\u4E0D\u9078 "),s(),l(16,"button",46),b("click",function(){D(t);let r=_();return w(r.resetPermissions())}),d(17," \u91CD\u7F6E "),s()(),l(18,"div",47),M(19,mG,2,0,"div",48)(20,pG,2,0,"div",48)(21,_G,2,0),s(),l(22,"div",49)(23,"button",50),b("click",function(){D(t);let r=_();return w(r.resetPermissions())}),d(24," \u53D6\u6D88 "),s(),l(25,"button",51),b("click",function(){D(t);let r=_();return w(r.savePermissions())}),d(26),s()()()}if(n&2){let t=_();f(5),k(" ",t.selectedRole().display_name," "),f(2),Ke(" \u5DF2\u914D\u7F6E ",t.assignedCount()," / ",t.categoryCount().total*5," \u500B\u6B0A\u9650 "),f(3),k(" ",(t.Object.keys(t.permissionsByCategory()).length>0?t.Math.round(t.assignedCount()/(t.Object.keys(t.permissionsByCategory()).length*5)*100):0)||0,"% "),f(6),I("disabled",t.isSaving()),f(3),A(t.isLoading()?19:t.Object.keys(t.permissionsByCategory()).length===0?20:21),f(4),I("disabled",t.isSaving()),f(2),I("disabled",t.isSaving()),f(),k(" ",t.isSaving()?"\u4FDD\u5B58\u4E2D...":"\u4FDD\u5B58\u6B0A\u9650"," ")}}function CG(n,e){if(n&1&&(l(0,"div",68)(1,"p",23),d(2),s()()),n&2){let t=_(2);f(2),E(t.error())}}function xG(n,e){if(n&1){let t=B();l(0,"div",21)(1,"div",66)(2,"div",39)(3,"h3",40),d(4),s()(),l(5,"div",67),M(6,CG,3,1,"div",68),l(7,"div")(8,"label",69),d(9," \u89D2\u8272\u540D\u7A31 "),l(10,"span",70),d(11,"*"),s()(),l(12,"input",71),b("input",function(r){D(t);let o=_();return w(o.updateRoleDisplayName(r.target.value))}),s()(),l(13,"div")(14,"label",69),d(15," \u8AAA\u660E "),s(),l(16,"textarea",72),b("input",function(r){D(t);let o=_();return w(o.updateRoleDescription(r.target.value))}),s()()(),l(17,"div",73)(18,"button",50),b("click",function(){D(t);let r=_();return w(r.closeRoleDialog())}),d(19," \u53D6\u6D88 "),s(),l(20,"button",74),b("click",function(){D(t);let r=_();return w(r.saveRole())}),d(21),s()()()()}if(n&2){let t=_();f(4),k(" ",t.editingRole()?"\u7DE8\u8F2F\u89D2\u8272":"\u65B0\u589E\u89D2\u8272"," "),f(2),A(t.error()?6:-1),f(6),I("value",t.roleFormData().displayName)("disabled",t.isSaving()),f(4),I("value",t.roleFormData().description)("disabled",t.isSaving()),f(2),I("disabled",t.isSaving()),f(2),I("disabled",t.isSaving()),f(),k(" ",t.isSaving()?"\u4FDD\u5B58\u4E2D...":"\u4FDD\u5B58"," ")}}function bG(n,e){if(n&1&&(l(0,"div",76)(1,"p",23),d(2),s()()),n&2){let t=_(2);f(2),E(t.error())}}function EG(n,e){if(n&1){let t=B();l(0,"div",21)(1,"div",66)(2,"div",39)(3,"h3",40),d(4,"\u522A\u9664\u89D2\u8272\u78BA\u8A8D"),s()(),l(5,"div",75),M(6,bG,3,1,"div",76),l(7,"p",77),d(8," \u78BA\u5B9A\u8981\u522A\u9664\u89D2\u8272 "),l(9,"strong",78),d(10),s(),d(11," \u55CE\uFF1F "),s(),l(12,"p",79),d(13," \u6CE8\u610F\uFF1A\u5982\u679C\u6B64\u89D2\u8272\u5DF2\u5206\u914D\u7D66\u4F7F\u7528\u8005\uFF0C\u5C07\u7121\u6CD5\u522A\u9664\u3002 "),s()(),l(14,"div",73)(15,"button",50),b("click",function(){D(t);let r=_();return w(r.closeDeleteDialog())}),d(16," \u53D6\u6D88 "),s(),l(17,"button",80),b("click",function(){D(t);let r=_();return w(r.deleteRole())}),d(18),s()()()()}if(n&2){let t,i=_();f(6),A(i.error()?6:-1),f(4),E((t=i.roleToDelete())==null?null:t.display_name),f(5),I("disabled",i.isSaving()),f(2),I("disabled",i.isSaving()),f(),k(" ",i.isSaving()?"\u522A\u9664\u4E2D...":"\u78BA\u5B9A\u522A\u9664"," ")}}function SG(n,e){if(n&1&&(zd(0),d(1),Yd()),n&2){let t=_();f(),k(" ",t.Math,`
`)}}var us=class us{constructor(){this.baseUrl=`${_n.apiUrl}/admin`;this.authService=P(rt);this.http=P(Zt);this.roles=S([]);this.selectedRole=S(null);this.permissions=S({});this.selectedPermissions=S(new Set);this.isLoading=S(!1);this.isSaving=S(!1);this.error=S(null);this.successMessage=S(null);this.showRoleDialog=S(!1);this.showDeleteDialog=S(!1);this.editingRole=S(null);this.roleToDelete=S(null);this.roleFormData=S({displayName:"",description:""});this.searchTerm=S("");this.Object=Object;this.Math=Math;this.filteredRoles=H(()=>{let e=this.searchTerm().toLowerCase();return this.roles().filter(t=>t.role_name!=="super_admin").filter(t=>t.display_name.toLowerCase().includes(e))});this.permissionsByCategory=H(()=>this.permissions());this.categoryCount=H(()=>{let e=Object.keys(this.permissionsByCategory());return{total:e.length,categories:e}});this.assignedCount=H(()=>this.selectedPermissions().size)}ngOnInit(){this.loadRoles()}getAuthHeaders(){let e=this.authService.getToken();return e?new Ot({Authorization:`Bearer ${e}`,"Content-Type":"application/json"}):(this.error.set("\u5C1A\u672A\u767B\u5165"),null)}loadRoles(){let e=this.getAuthHeaders();if(!e)return;this.isLoading.set(!0),this.error.set(null);let t=`${this.baseUrl}/roles?limit=100`;console.log("Loading roles from:",t),console.log("Headers:",e),this.http.get(t,{headers:e}).subscribe({next:i=>{console.log("Roles response:",i);let r=i?.data||[];console.log("Filtered roles:",r),console.log("Non-system roles:",r.filter(a=>!a.is_system)),this.roles.set(r),this.isLoading.set(!1);let o=r.find(a=>!a.is_system);o?(console.log("Auto-selecting role:",o),this.selectRole(o)):console.warn("No editable roles found")},error:i=>{console.error("Error loading roles:",i);let r=i.error?.error||i.message||"\u8F09\u5165\u89D2\u8272\u5931\u6557";this.error.set(r),this.isLoading.set(!1)}})}selectRole(e){this.selectedRole.set(e),this.selectedPermissions.set(new Set),this.error.set(null);let t=this.getAuthHeaders();t&&(this.isLoading.set(!0),this.http.get(`${this.baseUrl}/role-permissions?roleId=${e.role_id}`,{headers:t}).subscribe({next:i=>{console.log("Role permissions response:",i);let r=i?.permissions||{};console.log("Permissions data:",r);let o=new Set;Object.values(r).forEach(a=>{console.log("Category perms:",a),a.forEach(u=>{console.log("Permission:",u,"is_assigned:",u.is_assigned,"type:",typeof u.is_assigned),u.is_assigned&&o.add(u.permission_id)})}),console.log("Assigned permissions:",o),this.permissions.set(r),this.selectedPermissions.set(o),this.isLoading.set(!1)},error:i=>{console.error("Error loading permissions:",i),this.error.set(i.error?.error||"\u8F09\u5165\u6B0A\u9650\u5931\u6557"),this.isLoading.set(!1)}}))}togglePermission(e,t){let i=new Set(this.selectedPermissions());t?i.delete(e):i.add(e),this.selectedPermissions.set(i)}selectAllInCategory(e){let t=this.permissions()[e]||[],i=new Set(this.selectedPermissions());t.forEach(r=>{i.add(r.permission_id)}),this.selectedPermissions.set(i)}deselectAllInCategory(e){let t=this.permissions()[e]||[],i=new Set(this.selectedPermissions());t.forEach(r=>{i.delete(r.permission_id)}),this.selectedPermissions.set(i)}getCategoryAssignedCount(e){let t=this.permissions()[e]||[],i=0;return t.forEach(r=>{this.selectedPermissions().has(r.permission_id)&&i++}),i}isCategoryFullySelected(e){let t=this.permissions()[e]||[];return t.length===0?!1:t.every(i=>this.selectedPermissions().has(i.permission_id))}savePermissions(){let e=this.selectedRole();if(!e){this.error.set("\u672A\u9078\u64C7\u89D2\u8272");return}let t=this.getAuthHeaders();if(!t)return;this.isSaving.set(!0),this.error.set(null),this.successMessage.set(null);let i={roleId:e.role_id,permissionIds:Array.from(this.selectedPermissions())};this.http.post(`${this.baseUrl}/role-permissions`,i,{headers:t}).subscribe({next:r=>{this.isSaving.set(!1),this.successMessage.set(`\u6210\u529F\u66F4\u65B0\u89D2\u8272 "${e.display_name}" \u7684\u6B0A\u9650 (${this.assignedCount()} \u500B\u6B0A\u9650)`),setTimeout(()=>{this.loadRoles()},1500)},error:r=>{this.isSaving.set(!1),this.error.set(r.error?.error||"\u4FDD\u5B58\u6B0A\u9650\u5931\u6557")}})}resetPermissions(){let e=this.selectedRole();e&&this.selectRole(e)}selectAllPermissions(){let e=new Set;Object.values(this.permissions()).forEach(t=>{t.forEach(i=>{e.add(i.permission_id)})}),this.selectedPermissions.set(e)}clearAllPermissions(){this.selectedPermissions.set(new Set)}openCreateRoleDialog(){this.editingRole.set(null),this.roleFormData.set({displayName:"",description:""}),this.showRoleDialog.set(!0),this.error.set(null)}openEditRoleDialog(e){this.editingRole.set(e),this.roleFormData.set({displayName:e.display_name,description:e.description||""}),this.showRoleDialog.set(!0),this.error.set(null)}closeRoleDialog(){this.showRoleDialog.set(!1),this.editingRole.set(null),this.roleFormData.set({displayName:"",description:""}),this.error.set(null)}saveRole(){let e=this.roleFormData();if(!e.displayName.trim()){this.error.set("\u89D2\u8272\u540D\u7A31\u4E0D\u80FD\u70BA\u7A7A");return}let t=this.getAuthHeaders();if(!t)return;this.isSaving.set(!0),this.error.set(null);let i=this.editingRole();if(i)this.http.put(`${this.baseUrl}/roles/${i.role_id}`,{displayName:e.displayName.trim(),description:e.description.trim()||null},{headers:t}).subscribe({next:r=>{this.isSaving.set(!1),this.successMessage.set(`\u6210\u529F\u66F4\u65B0\u89D2\u8272 "${e.displayName}"`),this.closeRoleDialog(),this.loadRoles(),setTimeout(()=>{this.successMessage.set(null)},3e3)},error:r=>{this.isSaving.set(!1),this.error.set(r.error?.error||"\u66F4\u65B0\u89D2\u8272\u5931\u6557")}});else{let r=new Date,o=r.getFullYear().toString()+(r.getMonth()+1).toString().padStart(2,"0")+r.getDate().toString().padStart(2,"0")+r.getHours().toString().padStart(2,"0")+r.getMinutes().toString().padStart(2,"0")+r.getSeconds().toString().padStart(2,"0"),a=Math.floor(Math.random()*65536).toString(16).padStart(4,"0"),u=`role_${o}_${a}`;this.http.post(`${this.baseUrl}/roles`,{roleName:u,displayName:e.displayName.trim(),description:e.description.trim()||null},{headers:t}).subscribe({next:c=>{this.isSaving.set(!1),this.successMessage.set(`\u6210\u529F\u5275\u5EFA\u89D2\u8272 "${e.displayName}"`),this.closeRoleDialog(),this.loadRoles(),setTimeout(()=>{this.successMessage.set(null)},3e3)},error:c=>{this.isSaving.set(!1),this.error.set(c.error?.error||"\u5275\u5EFA\u89D2\u8272\u5931\u6557")}})}}openDeleteDialog(e){this.roleToDelete.set(e),this.showDeleteDialog.set(!0),this.error.set(null)}closeDeleteDialog(){this.showDeleteDialog.set(!1),this.roleToDelete.set(null),this.error.set(null)}deleteRole(){let e=this.roleToDelete();if(!e)return;let t=this.getAuthHeaders();t&&(this.isSaving.set(!0),this.error.set(null),this.http.delete(`${this.baseUrl}/roles/${e.role_id}`,{headers:t}).subscribe({next:i=>{this.isSaving.set(!1),this.successMessage.set(`\u6210\u529F\u522A\u9664\u89D2\u8272 "${e.display_name}"`),this.closeDeleteDialog(),this.selectedRole()?.role_id===e.role_id&&(this.selectedRole.set(null),this.permissions.set({}),this.selectedPermissions.set(new Set)),this.loadRoles(),setTimeout(()=>{this.successMessage.set(null)},3e3)},error:i=>{this.isSaving.set(!1),this.error.set(i.error?.error||"\u522A\u9664\u89D2\u8272\u5931\u6557")}}))}updateRoleDisplayName(e){let t=this.roleFormData();this.roleFormData.set({displayName:e,description:t.description})}updateRoleDescription(e){let t=this.roleFormData();this.roleFormData.set({displayName:t.displayName,description:e})}};us.\u0275fac=function(t){return new(t||us)},us.\u0275cmp=re({type:us,selectors:[["app-role-permission-management"]],decls:33,vars:8,consts:[[1,"min-h-screen","bg-gray-50","p-6"],[1,"mb-8"],[1,"text-3xl","font-bold","text-gray-900"],[1,"mt-2","text-gray-600"],[1,"mb-6","rounded-md","bg-red-50","p-4","border","border-red-200"],[1,"mb-6","rounded-md","bg-green-50","p-4","border","border-green-200"],[1,"grid","grid-cols-1","gap-6","lg:grid-cols-3"],[1,"lg:col-span-1"],[1,"rounded-lg","bg-white","shadow"],[1,"border-b","border-gray-200","p-4"],[1,"flex","items-center","justify-between"],[1,"text-lg","font-semibold","text-gray-900"],[1,"mt-1","text-sm","text-gray-600"],["title","\u65B0\u589E\u89D2\u8272",1,"px-3","py-2","text-sm","font-medium","rounded-md","bg-blue-600","text-white","hover:bg-blue-700",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],["type","text","placeholder","\u641C\u5C0B\u89D2\u8272...",1,"block","w-full","rounded-md","border","border-gray-300","px-3","py-2","text-gray-900","placeholder-gray-500","focus:border-blue-500","focus:ring-blue-500",3,"input","value"],[1,"divide-y","divide-gray-200","max-h-96","overflow-y-auto"],[1,"p-4","text-center","text-gray-500"],[1,"lg:col-span-2"],[1,"rounded-lg","bg-white","shadow","p-12","text-center"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[4,"ngIf"],[1,"text-sm","font-medium","text-red-800"],[1,"text-sm","font-medium","text-green-800"],[1,"hover:bg-gray-50","transition",3,"bg-blue-50","border-l-4","border-l-blue-500"],[1,"hover:bg-gray-50","transition"],[1,"flex","items-center"],[1,"flex-1","text-left","p-4",3,"click"],[1,"font-semibold","text-gray-900"],[1,"text-sm","text-gray-600"],[1,"mt-1","text-xs","text-gray-500"],[1,"flex","gap-1","pr-2"],["title","\u7DE8\u8F2F\u89D2\u8272",1,"p-2","text-blue-600","hover:bg-blue-100","rounded",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["title","\u522A\u9664\u89D2\u8272",1,"p-2","text-red-600","hover:bg-red-100","rounded",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"text-gray-600"],[1,"border-b","border-gray-200","p-6"],[1,"text-xl","font-semibold","text-gray-900"],[1,"text-right"],[1,"text-3xl","font-bold","text-blue-600"],[1,"border-b","border-gray-200","p-4","bg-gray-50","flex","gap-2"],[1,"px-3","py-2","text-sm","font-medium","rounded-md","bg-blue-600","text-white","hover:bg-blue-700",3,"click"],[1,"px-3","py-2","text-sm","font-medium","rounded-md","bg-gray-400","text-white","hover:bg-gray-500",3,"click"],[1,"px-3","py-2","text-sm","font-medium","rounded-md","bg-gray-200","text-gray-900","hover:bg-gray-300","disabled:opacity-50",3,"click","disabled"],[1,"divide-y","divide-gray-200","max-h-screen","overflow-y-auto"],[1,"p-8","text-center","text-gray-500"],[1,"border-t","border-gray-200","p-6","bg-gray-50","flex","gap-3","justify-end"],[1,"px-4","py-2","text-sm","font-medium","rounded-md","bg-gray-200","text-gray-900","hover:bg-gray-300","disabled:opacity-50",3,"click","disabled"],[1,"px-4","py-2","text-sm","font-medium","rounded-md","bg-green-600","text-white","hover:bg-green-700","disabled:opacity-50",3,"click","disabled"],[1,"border-b","border-gray-200"],[1,"bg-gray-50","p-4","flex","items-center","justify-between"],[1,"flex","items-center","gap-3","flex-1"],["type","checkbox",1,"w-5","h-5","text-blue-600","rounded","cursor-pointer",3,"change","checked"],[1,"font-semibold","text-gray-900","capitalize"],[1,"text-xs","text-gray-600"],[1,"p-4","space-y-3"],[1,"text-sm","text-gray-500","py-2"],[1,"flex","items-start","gap-3"],["type","checkbox",1,"w-5","h-5","text-blue-600","rounded","cursor-pointer","mt-0.5",3,"change","checked","disabled"],[1,"flex-1"],[1,"block","text-sm","font-medium","text-gray-900","cursor-pointer"],[1,"text-xs","text-gray-600","mt-1"],[1,"text-xs","bg-gray-100","px-2","py-1","rounded","text-gray-700","inline-block","mt-1"],[1,"bg-white","rounded-lg","shadow-xl","max-w-md","w-full","m-4"],[1,"p-6","space-y-4"],[1,"rounded-md","bg-red-50","p-4","border","border-red-200"],[1,"block","text-sm","font-medium","text-gray-900","mb-2"],[1,"text-red-500"],["type","text","placeholder","\u8ACB\u8F38\u5165\u89D2\u8272\u540D\u7A31",1,"block","w-full","rounded-md","border","border-gray-300","px-3","py-2","text-gray-900","placeholder-gray-500","focus:border-blue-500","focus:ring-blue-500",3,"input","value","disabled"],["placeholder","\u8ACB\u8F38\u5165\u89D2\u8272\u8AAA\u660E\uFF08\u9078\u586B\uFF09","rows","3",1,"block","w-full","rounded-md","border","border-gray-300","px-3","py-2","text-gray-900","placeholder-gray-500","focus:border-blue-500","focus:ring-blue-500",3,"input","value","disabled"],[1,"border-t","border-gray-200","p-6","flex","gap-3","justify-end"],[1,"px-4","py-2","text-sm","font-medium","rounded-md","bg-blue-600","text-white","hover:bg-blue-700","disabled:opacity-50",3,"click","disabled"],[1,"p-6"],[1,"rounded-md","bg-red-50","p-4","border","border-red-200","mb-4"],[1,"text-gray-700"],[1,"text-gray-900"],[1,"text-sm","text-red-600","mt-2"],[1,"px-4","py-2","text-sm","font-medium","rounded-md","bg-red-600","text-white","hover:bg-red-700","disabled:opacity-50",3,"click","disabled"]],template:function(t,i){t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),d(3,"\u89D2\u8272\u6B0A\u9650\u63A7\u7BA1"),s(),l(4,"p",3),d(5,"\u8A2D\u5B9A\u6BCF\u500B\u89D2\u8272\u7684\u6B0A\u9650\uFF0C\u6C7A\u5B9A\u4ED6\u5011\u53EF\u4EE5\u57F7\u884C\u7684\u64CD\u4F5C"),s()(),M(6,oG,3,1,"div",4),M(7,aG,3,1,"div",5),l(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"div",10)(13,"div")(14,"h2",11),d(15,"\u53EF\u7DE8\u8F2F\u7684\u89D2\u8272"),s(),l(16,"p",12),d(17," \u8D85\u7D1A\u7BA1\u7406\u54E1\u89D2\u8272\u7121\u6CD5\u7DE8\u8F2F "),s()(),l(18,"button",13),b("click",function(){return i.openCreateRoleDialog()}),Li(),l(19,"svg",14),x(20,"path",15),s()()()(),Hr(),l(21,"div",9)(22,"input",16),b("input",function(o){return i.searchTerm.set(o.target.value)}),s()(),l(23,"div",17),M(24,sG,2,0,"div",18)(25,lG,2,0,"div",18)(26,dG,2,0),s()()(),l(27,"div",19),M(28,cG,3,0,"div",20)(29,vG,27,9,"div",8),s()()(),M(30,xG,22,9,"div",21),M(31,EG,19,5,"div",21),vt(32,SG,2,1,"ng-container",22)),t&2&&(f(6),A(i.error()?6:-1),f(),A(i.successMessage()?7:-1),f(15),I("value",i.searchTerm()),f(2),A(i.isLoading()?24:i.filteredRoles().length===0?25:26),f(4),A(i.selectedRole()?29:28),f(2),A(i.showRoleDialog()?30:-1),f(),A(i.showDeleteDialog()?31:-1),f(),I("ngIf",!1))},dependencies:[oe,ji,ke,Se],styles:["[_nghost-%COMP%]{--color-primary: #3b82f6;--color-success: #10b981;--color-danger: #ef4444;--color-warning: #f59e0b;--color-gray-50: #f9fafb;--color-gray-100: #f3f4f6;--color-gray-200: #e5e7eb;--color-gray-300: #d1d5db;--color-gray-600: #4b5563;--color-gray-900: #111827}[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:var(--color-gray-100)}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--color-gray-300);border-radius:4px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:var(--color-gray-400)}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}[class*=bg-green-50][_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideIn .3s ease-out}button[_ngcontent-%COMP%], input[type=checkbox][_ngcontent-%COMP%]{transition:all .2s ease-out}.role-item[_ngcontent-%COMP%]:hover{transform:translate(2px)}"],changeDetection:0});var Sp=us;var Qe=(n,e)=>{let t=P(rt),i=P(Ve);if(!t.isAuthenticated())return i.navigate(["/login"],{queryParams:{returnUrl:e.url}}),!1;let r=t.getTokenExpiry(),o=new Date().getTime();return r&&o>=r?(t.logout(),i.navigate(["/login"],{queryParams:{returnUrl:e.url,expired:!0}}),!1):!0};var Co=class Co{constructor(){this.baseUrl=`${_n.apiUrl}/admin`;this.authService=P(rt);this.http=P(Zt);this.router=P(Ve)}async checkSuperAdmin(){try{let e=this.authService.getToken();if(!e)return!1;let t=new Ot({Authorization:`Bearer ${e}`,"Content-Type":"application/json"}),i=await te(this.http.get(`${this.baseUrl}/profile`,{headers:t}));return i?.data?.roles&&Array.isArray(i.data.roles)?i.data.roles.some(r=>r.role_name==="super_admin"):!1}catch(e){return console.error("Error checking super admin status:",e),!1}}};Co.\u0275fac=function(t){return new(t||Co)},Co.\u0275prov=Z({token:Co,factory:Co.\u0275fac,providedIn:"root"});var n_=Co,Y2=async(n,e)=>{let t=P(n_),i=P(Ve);return await t.checkSuperAdmin()?!0:(console.warn("Access denied: User is not a super admin"),i.navigate(["/dashboard"],{queryParams:{error:"insufficient-permissions"}}),!1)};var J2=[{path:"login",component:bp,title:"\u767B\u5165"},{path:"dashboard",component:cm,title:"Dashboard",canActivate:[Qe]},{path:"financial-statements",component:mm,title:"Financial Statements",canActivate:[Qe]},{path:"customer-analysis",component:Zm,title:"\u9867\u5BA2\u7BA1\u7406",canActivate:[Qe]},{path:"product-analysis",component:Xm,title:"Product Analysis",canActivate:[Qe]},{path:"product-cost",component:up,title:"Product Cost",canActivate:[Qe]},{path:"ledger",component:ep,title:"Ledger",canActivate:[Qe]},{path:"vendors",component:dp,title:"\u5EE0\u5546\u7BA1\u7406",canActivate:[Qe]},{path:"purchase-orders",component:cp,title:"\u9032\u8CA8\u55AE\u7BA1\u7406",canActivate:[Qe]},{path:"events",component:ip,title:"\u6D3B\u52D5\u7BA1\u7406",canActivate:[Qe]},{path:"events/new",component:Xl,title:"\u65B0\u589E\u6D3B\u52D5",canActivate:[Qe]},{path:"events/edit/:id",component:Xl,title:"\u7DE8\u8F2F\u6D3B\u52D5",canActivate:[Qe]},{path:"daily-revenue",component:rp,title:"Daily Revenue",canActivate:[Qe]},{path:"daily-revenue/:date",component:op,title:"Edit Daily Revenue",canActivate:[Qe]},{path:"payroll",component:ap,title:"\u85AA\u8CC7\u7BA1\u7406",canActivate:[Qe]},{path:"payroll/:employeeId/:year/:month",component:sp,title:"Payroll Details",canActivate:[Qe]},{path:"company-profile",component:lp,title:"\u516C\u53F8\u500B\u4EBA\u8CC7\u6599",canActivate:[Qe]},{path:"shareholder-rebates",component:mp,title:"\u80A1\u6771\u56DE\u994B\u91D1",canActivate:[Qe]},{path:"meeting",component:pp,title:"\u6BCF\u5468\u6703\u8B70\u7D00\u9304",canActivate:[Qe]},{path:"shareholder-records",component:gp,title:"\u500B\u4EBA\u6BCF\u5468\u9032\u5EA6\u7D00\u9304",canActivate:[Qe]},{path:"goal-progress",component:yp,title:"\u500B\u4EBA\u76EE\u6A19\u9032\u5EA6",canActivate:[Qe]},{path:"goal-setting",component:Cp,title:"\u5718\u968A\u76EE\u6A19\u8A2D\u5B9A",canActivate:[Qe]},{path:"monthly-targets",component:xp,title:"\u71DF\u6536\u76EE\u6A19",canActivate:[Qe]},{path:"decision-log",component:hp,title:"\u91CD\u5927\u4E8B\u9805\u4F48\u9054",canActivate:[Qe]},{path:"user-management",component:_p,title:"\u4F7F\u7528\u8005\u7BA1\u7406",canActivate:[Qe]},{path:"role-permissions",component:Sp,title:"\u89D2\u8272\u6B0A\u9650\u63A7\u7BA1",canActivate:[Qe,Y2]},{path:"account",component:Ep,title:"\u5E33\u865F\u8A2D\u5B9A",canActivate:[Qe]},{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"**",redirectTo:"login"}];var K2=()=>{};var Q2=async(n,e)=>{if(!(typeof window>"u"))return await K2(),o_([["ion-icon",[[1,"ion-icon",{mode:[1025],color:[1],ios:[1],md:[1],flipRtl:[4,"flip-rtl"],name:[513],src:[1],icon:[8],size:[1],lazy:[4],sanitize:[4],svgContent:[32],isVisible:[32]},null,{name:["loadIcon"],src:["loadIcon"],icon:["loadIcon"],ios:["loadIcon"],md:["loadIcon"]}]]]],e)};var xo=class xo{constructor(e,t){this.authService=e;this.router=t}intercept(e,t){let i=this.authService.getToken();if(i){let r=this.authService.getTokenExpiry(),o=new Date().getTime();if(r&&o>=r)return console.warn("Token \u5DF2\u8FC7\u671F\uFF0C\u5F3A\u5236\u91CD\u65B0\u767B\u5165"),this.authService.logout(),this.router.navigate(["/login"],{queryParams:{expired:!0}}),Mi(()=>new Error("Token expired"));e=this.addToken(e,i)}return t.handle(e).pipe(zn(r=>{if(r.status===401){let o=this.authService.getTokenExpiry(),a=new Date().getTime();o&&a>=o?(console.warn("\u6536\u5230 401 Unauthorized \u4E14 Token \u5DF2\u8FC7\u671F\uFF0C\u5F3A\u5236\u91CD\u65B0\u767B\u5165"),this.authService.logout(),this.router.navigate(["/login"],{queryParams:{expired:!0,returnUrl:this.router.url}})):console.warn("\u6536\u5230 401 Unauthorized\uFF0C\u4F46 Token \u4ECD\u6709\u6548\uFF0C\u4FDD\u7559\u767B\u5165\u72C0\u614B")}return Mi(()=>r)}))}addToken(e,t){return e.clone({setHeaders:{Authorization:`Bearer ${t}`}})}};xo.\u0275fac=function(t){return new(t||xo)(ae(rt),ae(Ve))},xo.\u0275prov=Z({token:xo,factory:xo.\u0275fac});var Dp=xo;Xg(Qc,{providers:[Eg(),Nh(J2,Fh()),oh(ah()),{provide:bc,useClass:Dp,multi:!0}]}).catch(n=>console.error(n));Q2(window);
