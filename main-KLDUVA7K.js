import{a as k,b as q,h as r_}from"./chunk-FU26YZD3.js";var Dp;function Zl(){return Dp}function ci(n){let e=Dp;return Dp=n,e}var o_=Symbol("NotFound");function Co(n){return n===o_||n?.name==="\u0275NotFound"}var jt=null,Xl=!1,wp=1,zb=null,zt=Symbol("SIGNAL");function fe(n){let e=jt;return jt=n,e}function iu(){return jt}var Sr={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function xo(n){if(Xl)throw new Error("");if(jt===null)return;jt.consumerOnSignalRead(n);let e=jt.producersTail;if(e!==void 0&&e.producer===n)return;let t,i=jt.recomputing;if(i&&(t=e!==void 0?e.nextProducer:jt.producers,t!==void 0&&t.producer===n)){jt.producersTail=t,t.lastReadVersion=n.version;return}let r=n.consumersTail;if(r!==void 0&&r.consumer===jt&&(!i||Jb(r,jt)))return;let o=So(jt),s={producer:n,consumer:jt,nextProducer:t,prevConsumer:r,lastReadVersion:n.version,nextConsumer:void 0};jt.producersTail=s,e!==void 0?e.nextProducer=s:jt.producers=s,o&&u_(n,s)}function s_(){wp++}function ru(n){if(!(So(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===wp)){if(!n.producerMustRecompute(n)&&!bo(n)){nu(n);return}n.producerRecomputeValue(n),nu(n)}}function Tp(n){if(n.consumers===void 0)return;let e=Xl;Xl=!0;try{for(let t=n.consumers;t!==void 0;t=t.nextConsumer){let i=t.consumer;i.dirty||Yb(i)}}finally{Xl=e}}function Ip(){return jt?.consumerAllowSignalWrites!==!1}function Yb(n){n.dirty=!0,Tp(n),n.consumerMarkedDirty?.(n)}function nu(n){n.dirty=!1,n.lastCleanEpoch=wp}function Dr(n){return n&&a_(n),fe(n)}function a_(n){n.producersTail=void 0,n.recomputing=!0}function Eo(n,e){fe(e),n&&l_(n)}function l_(n){n.recomputing=!1;let e=n.producersTail,t=e!==void 0?e.nextProducer:n.producers;if(t!==void 0){if(So(n))do t=Mp(t);while(t!==void 0);e!==void 0?e.nextProducer=void 0:n.producers=void 0}}function bo(n){for(let e=n.producers;e!==void 0;e=e.nextProducer){let t=e.producer,i=e.lastReadVersion;if(i!==t.version||(ru(t),i!==t.version))return!0}return!1}function wr(n){if(So(n)){let e=n.producers;for(;e!==void 0;)e=Mp(e)}n.producers=void 0,n.producersTail=void 0,n.consumers=void 0,n.consumersTail=void 0}function u_(n,e){let t=n.consumersTail,i=So(n);if(t!==void 0?(e.nextConsumer=t.nextConsumer,t.nextConsumer=e):(e.nextConsumer=void 0,n.consumers=e),e.prevConsumer=t,n.consumersTail=e,!i)for(let r=n.producers;r!==void 0;r=r.nextProducer)u_(r.producer,r)}function Mp(n){let e=n.producer,t=n.nextProducer,i=n.nextConsumer,r=n.prevConsumer;if(n.nextConsumer=void 0,n.prevConsumer=void 0,i!==void 0?i.prevConsumer=r:e.consumersTail=r,r!==void 0)r.nextConsumer=i;else if(e.consumers=i,!So(e)){let o=e.producers;for(;o!==void 0;)o=Mp(o)}return t}function So(n){return n.consumerIsAlwaysLive||n.consumers!==void 0}function ou(n){zb?.(n)}function Jb(n,e){let t=e.producersTail;if(t!==void 0){let i=e.producers;do{if(i===n)return!0;if(i===t)break;i=i.nextProducer}while(i!==void 0)}return!1}function su(n,e){return Object.is(n,e)}function au(n,e){let t=Object.create(Kb);t.computation=n,e!==void 0&&(t.equal=e);let i=()=>{if(ru(t),xo(t),t.value===la)throw t.error;return t.value};return i[zt]=t,ou(t),i}var eu=Symbol("UNSET"),tu=Symbol("COMPUTING"),la=Symbol("ERRORED"),Kb=q(k({},Sr),{value:eu,dirty:!0,error:null,equal:su,kind:"computed",producerMustRecompute(n){return n.value===eu||n.value===tu},producerRecomputeValue(n){if(n.value===tu)throw new Error("");let e=n.value;n.value=tu;let t=Dr(n),i,r=!1;try{i=n.computation(),fe(null),r=e!==eu&&e!==la&&i!==la&&n.equal(e,i)}catch(o){i=la,n.error=o}finally{Eo(n,t)}if(r){n.value=e;return}n.value=i,n.version++}});function Qb(){throw new Error}var d_=Qb;function c_(n){d_(n)}function Ap(n){d_=n}var Zb=null;function Np(n,e){let t=Object.create(lu);t.value=n,e!==void 0&&(t.equal=e);let i=()=>m_(t);return i[zt]=t,ou(t),[i,s=>Do(t,s),s=>Rp(t,s)]}function m_(n){return xo(n),n.value}function Do(n,e){Ip()||c_(n),n.equal(n.value,e)||(n.value=e,Xb(n))}function Rp(n,e){Ip()||c_(n),Do(n,e(n.value))}var lu=q(k({},Sr),{equal:su,value:void 0,kind:"signal"});function Xb(n){n.version++,s_(),Tp(n),Zb?.(n)}function xe(n){return typeof n=="function"}function wo(n){let t=n(i=>{Error.call(i),i.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var uu=wo(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((i,r)=>`${r+1}) ${i.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function ua(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var vt=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:i}=this;if(xe(i))try{i()}catch(o){e=o instanceof uu?o.errors:[o]}let{_finalizers:r}=this;if(r){this._finalizers=null;for(let o of r)try{p_(o)}catch(s){e=e??[],s instanceof uu?e=[...e,...s.errors]:e.push(s)}}if(e)throw new uu(e)}}add(e){var t;if(e&&e!==this)if(this.closed)p_(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&ua(t,e)}remove(e){let{_finalizers:t}=this;t&&ua(t,e),e instanceof n&&e._removeParent(this)}};vt.EMPTY=(()=>{let n=new vt;return n.closed=!0,n})();var Fp=vt.EMPTY;function du(n){return n instanceof vt||n&&"closed"in n&&xe(n.remove)&&xe(n.add)&&xe(n.unsubscribe)}function p_(n){xe(n)?n():n.unsubscribe()}var qn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var To={setTimeout(n,e,...t){let{delegate:i}=To;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=To;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function cu(n){To.setTimeout(()=>{let{onUnhandledError:e}=qn;if(e)e(n);else throw n})}function da(){}var f_=Pp("C",void 0,void 0);function g_(n){return Pp("E",void 0,n)}function h_(n){return Pp("N",n,void 0)}function Pp(n,e,t){return{kind:n,value:e,error:t}}var Tr=null;function Io(n){if(qn.useDeprecatedSynchronousErrorHandling){let e=!Tr;if(e&&(Tr={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:i}=Tr;if(Tr=null,t)throw i}}else n()}function y_(n){qn.useDeprecatedSynchronousErrorHandling&&Tr&&(Tr.errorThrown=!0,Tr.error=n)}var Ir=class extends vt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,du(e)&&e.add(this)):this.destination=nS}static create(e,t,i){return new Zi(e,t,i)}next(e){this.isStopped?Vp(h_(e),this):this._next(e)}error(e){this.isStopped?Vp(g_(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Vp(f_,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},eS=Function.prototype.bind;function kp(n,e){return eS.call(n,e)}var Op=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){mu(i)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){mu(i)}else mu(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){mu(t)}}},Zi=class extends Ir{constructor(e,t,i){super();let r;if(xe(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let o;this&&qn.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&kp(e.next,o),error:e.error&&kp(e.error,o),complete:e.complete&&kp(e.complete,o)}):r=e}this.destination=new Op(r)}};function mu(n){qn.useDeprecatedSynchronousErrorHandling?y_(n):cu(n)}function tS(n){throw n}function Vp(n,e){let{onStoppedNotification:t}=qn;t&&To.setTimeout(()=>t(n,e))}var nS={closed:!0,next:da,error:tS,complete:da};var Mo=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Cn(n){return n}function Lp(...n){return Bp(n)}function Bp(n){return n.length===0?Cn:n.length===1?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}var Te=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){let o=rS(t)?t:new Zi(t,i,r);return Io(()=>{let{operator:s,source:u}=this;o.add(s?s.call(o,u):u?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return i=__(i),new i((r,o)=>{let s=new Zi({next:u=>{try{t(u)}catch(d){o(d),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(t){var i;return(i=this.source)===null||i===void 0?void 0:i.subscribe(t)}[Mo](){return this}pipe(...t){return Bp(t)(this)}toPromise(t){return t=__(t),new t((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return n.create=e=>new n(e),n})();function __(n){var e;return(e=n??qn.Promise)!==null&&e!==void 0?e:Promise}function iS(n){return n&&xe(n.next)&&xe(n.error)&&xe(n.complete)}function rS(n){return n&&n instanceof Ir||iS(n)&&du(n)}function Up(n){return xe(n?.lift)}function Re(n){return e=>{if(Up(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Me(n,e,t,i,r){return new $p(n,e,t,i,r)}var $p=class extends Ir{constructor(e,t,i,r,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(u){try{t(u)}catch(d){e.error(d)}}:super._next,this._error=r?function(u){try{r(u)}catch(d){e.error(d)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Ao(){return Re((n,e)=>{let t=null;n._refCount++;let i=Me(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let r=n._connection,o=t;t=null,r&&(!o||r===o)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}var No=class extends Te{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Up(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new vt;let t=this.getSubject();e.add(this.source.subscribe(Me(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=vt.EMPTY)}return e}refCount(){return Ao()(this)}};var v_=wo(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var gt=(()=>{class n extends Te{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let i=new pu(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new v_}next(t){Io(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let i of this.currentObservers)i.next(t)}})}error(t){Io(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Io(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:i,isStopped:r,observers:o}=this;return i||r?Fp:(this.currentObservers=null,o.push(t),new vt(()=>{this.currentObservers=null,ua(o,t)}))}_checkFinalizedStatuses(t){let{hasError:i,thrownError:r,isStopped:o}=this;i?t.error(r):o&&t.complete()}asObservable(){let t=new Te;return t.source=this,t}}return n.create=(e,t)=>new pu(e,t),n})(),pu=class extends gt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.next)===null||i===void 0||i.call(t,e)}error(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.error)===null||i===void 0||i.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,i;return(i=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&i!==void 0?i:Fp}};var Bt=class extends gt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}};var mn=new Te(n=>n.complete());function C_(n){return n&&xe(n.schedule)}function x_(n){return n[n.length-1]}function fu(n){return xe(x_(n))?n.pop():void 0}function Xi(n){return C_(x_(n))?n.pop():void 0}function b_(n,e,t,i){function r(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function u(h){try{m(i.next(h))}catch(y){s(y)}}function d(h){try{m(i.throw(h))}catch(y){s(y)}}function m(h){h.done?o(h.value):r(h.value).then(u,d)}m((i=i.apply(n,e||[])).next())})}function E_(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Mr(n){return this instanceof Mr?(this.v=n,this):new Mr(n)}function S_(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,o=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",s),r[Symbol.asyncIterator]=function(){return this},r;function s(C){return function(D){return Promise.resolve(D).then(C,y)}}function u(C,D){i[C]&&(r[C]=function(I){return new Promise(function(R,F){o.push([C,I,R,F])>1||d(C,I)})},D&&(r[C]=D(r[C])))}function d(C,D){try{m(i[C](D))}catch(I){_(o[0][3],I)}}function m(C){C.value instanceof Mr?Promise.resolve(C.value.v).then(h,y):_(o[0][2],C)}function h(C){d("next",C)}function y(C){d("throw",C)}function _(C,D){C(D),o.shift(),o.length&&d(o[0][0],o[0][1])}}function D_(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof E_=="function"?E_(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=n[o]&&function(s){return new Promise(function(u,d){s=n[o](s),r(u,d,s.done,s.value)})}}function r(o,s,u,d){Promise.resolve(d).then(function(m){o({value:m,done:u})},s)}}var gu=n=>n&&typeof n.length=="number"&&typeof n!="function";function hu(n){return xe(n?.then)}function yu(n){return xe(n[Mo])}function _u(n){return Symbol.asyncIterator&&xe(n?.[Symbol.asyncIterator])}function vu(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function oS(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Cu=oS();function xu(n){return xe(n?.[Cu])}function Eu(n){return S_(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:i,done:r}=yield Mr(t.read());if(r)return yield Mr(void 0);yield yield Mr(i)}}finally{t.releaseLock()}})}function bu(n){return xe(n?.getReader)}function Ct(n){if(n instanceof Te)return n;if(n!=null){if(yu(n))return sS(n);if(gu(n))return aS(n);if(hu(n))return lS(n);if(_u(n))return w_(n);if(xu(n))return uS(n);if(bu(n))return dS(n)}throw vu(n)}function sS(n){return new Te(e=>{let t=n[Mo]();if(xe(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function aS(n){return new Te(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function lS(n){return new Te(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,cu)})}function uS(n){return new Te(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function w_(n){return new Te(e=>{cS(n,e).catch(t=>e.error(t))})}function dS(n){return w_(Eu(n))}function cS(n,e){var t,i,r,o;return b_(this,void 0,void 0,function*(){try{for(t=D_(n);i=yield t.next(),!i.done;){let s=i.value;if(e.next(s),e.closed)return}}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=t.return)&&(yield o.call(t))}finally{if(r)throw r.error}}e.complete()})}function pn(n,e,t,i=0,r=!1){let o=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(o),!r)return o}function Su(n,e=0){return Re((t,i)=>{t.subscribe(Me(i,r=>pn(i,n,()=>i.next(r),e),()=>pn(i,n,()=>i.complete(),e),r=>pn(i,n,()=>i.error(r),e)))})}function Du(n,e=0){return Re((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function T_(n,e){return Ct(n).pipe(Du(e),Su(e))}function I_(n,e){return Ct(n).pipe(Du(e),Su(e))}function M_(n,e){return new Te(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}function A_(n,e){return new Te(t=>{let i;return pn(t,e,()=>{i=n[Cu](),pn(t,e,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){t.error(s);return}o?t.complete():t.next(r)},0,!0)}),()=>xe(i?.return)&&i.return()})}function wu(n,e){if(!n)throw new Error("Iterable cannot be null");return new Te(t=>{pn(t,e,()=>{let i=n[Symbol.asyncIterator]();pn(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function N_(n,e){return wu(Eu(n),e)}function R_(n,e){if(n!=null){if(yu(n))return T_(n,e);if(gu(n))return M_(n,e);if(hu(n))return I_(n,e);if(_u(n))return wu(n,e);if(xu(n))return A_(n,e);if(bu(n))return N_(n,e)}throw vu(n)}function ot(n,e){return e?R_(n,e):Ct(n)}function ue(...n){let e=Xi(n);return ot(n,e)}function Mi(n,e){let t=xe(n)?n:()=>n,i=r=>r.error(t());return new Te(e?r=>e.schedule(i,0,r):i)}function Hp(n){return!!n&&(n instanceof Te||xe(n.lift)&&xe(n.subscribe))}var Wn=wo(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function se(n,e){let t=typeof e=="object";return new Promise((i,r)=>{let o=new Zi({next:s=>{i(s),o.unsubscribe()},error:r,complete:()=>{t?i(e.defaultValue):r(new Wn)}});n.subscribe(o)})}function he(n,e){return Re((t,i)=>{let r=0;t.subscribe(Me(i,o=>{i.next(n.call(e,o,r++))}))})}var{isArray:mS}=Array;function pS(n,e){return mS(e)?n(...e):n(e)}function Tu(n){return he(e=>pS(n,e))}var{isArray:fS}=Array,{getPrototypeOf:gS,prototype:hS,keys:yS}=Object;function Iu(n){if(n.length===1){let e=n[0];if(fS(e))return{args:e,keys:null};if(_S(e)){let t=yS(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}function _S(n){return n&&typeof n=="object"&&gS(n)===hS}function Mu(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function Au(...n){let e=Xi(n),t=fu(n),{args:i,keys:r}=Iu(n);if(i.length===0)return ot([],e);let o=new Te(vS(i,e,r?s=>Mu(r,s):Cn));return t?o.pipe(Tu(t)):o}function vS(n,e,t=Cn){return i=>{F_(e,()=>{let{length:r}=n,o=new Array(r),s=r,u=r;for(let d=0;d<r;d++)F_(e,()=>{let m=ot(n[d],e),h=!1;m.subscribe(Me(i,y=>{o[d]=y,h||(h=!0,u--),u||i.next(t(o.slice()))},()=>{--s||i.complete()}))},i)},i)}}function F_(n,e,t){n?pn(t,n,e):e()}function P_(n,e,t,i,r,o,s,u){let d=[],m=0,h=0,y=!1,_=()=>{y&&!d.length&&!m&&e.complete()},C=I=>m<i?D(I):d.push(I),D=I=>{o&&e.next(I),m++;let R=!1;Ct(t(I,h++)).subscribe(Me(e,F=>{r?.(F),o?C(F):e.next(F)},()=>{R=!0},void 0,()=>{if(R)try{for(m--;d.length&&m<i;){let F=d.shift();s?pn(e,s,()=>D(F)):D(F)}_()}catch(F){e.error(F)}}))};return n.subscribe(Me(e,C,()=>{y=!0,_()})),()=>{u?.()}}function xt(n,e,t=1/0){return xe(e)?xt((i,r)=>he((o,s)=>e(i,o,r,s))(Ct(n(i,r))),t):(typeof e=="number"&&(t=e),Re((i,r)=>P_(i,r,n,t)))}function Ro(n=1/0){return xt(Cn,n)}function k_(){return Ro(1)}function Fo(...n){return k_()(ot(n,Xi(n)))}function ca(n){return new Te(e=>{Ct(n()).subscribe(e)})}function Gp(...n){let e=fu(n),{args:t,keys:i}=Iu(n),r=new Te(o=>{let{length:s}=t;if(!s){o.complete();return}let u=new Array(s),d=s,m=s;for(let h=0;h<s;h++){let y=!1;Ct(t[h]).subscribe(Me(o,_=>{y||(y=!0,m--),u[h]=_},()=>d--,void 0,()=>{(!d||!y)&&(m||o.next(i?Mu(i,u):u),o.complete())}))}});return e?r.pipe(Tu(e)):r}function It(n,e){return Re((t,i)=>{let r=0;t.subscribe(Me(i,o=>n.call(e,o,r++)&&i.next(o)))})}function jn(n){return Re((e,t)=>{let i=null,r=!1,o;i=e.subscribe(Me(t,void 0,void 0,s=>{o=Ct(n(s,jn(n)(e))),i?(i.unsubscribe(),i=null,o.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,o.subscribe(t))})}function V_(n,e,t,i,r){return(o,s)=>{let u=t,d=e,m=0;o.subscribe(Me(s,h=>{let y=m++;d=u?n(d,h,y):(u=!0,h),i&&s.next(d)},r&&(()=>{u&&s.next(d),s.complete()})))}}function Ai(n,e){return xe(e)?xt(n,e,1):xt(n,1)}function er(n){return Re((e,t)=>{let i=!1;e.subscribe(Me(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function Ni(n){return n<=0?()=>mn:Re((e,t)=>{let i=0;e.subscribe(Me(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function Nu(n=CS){return Re((e,t)=>{let i=!1;e.subscribe(Me(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function CS(){return new Wn}function tr(n){return Re((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Ri(n,e){let t=arguments.length>=2;return i=>i.pipe(n?It((r,o)=>n(r,o,i)):Cn,Ni(1),t?er(e):Nu(()=>new Wn))}function Po(n){return n<=0?()=>mn:Re((e,t)=>{let i=[];e.subscribe(Me(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(let r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function qp(n,e){let t=arguments.length>=2;return i=>i.pipe(n?It((r,o)=>n(r,o,i)):Cn,Po(1),t?er(e):Nu(()=>new Wn))}function Wp(n,e){return Re(V_(n,e,arguments.length>=2,!0))}function jp(...n){let e=Xi(n);return Re((t,i)=>{(e?Fo(n,t,e):Fo(n,t)).subscribe(i)})}function Yt(n,e){return Re((t,i)=>{let r=null,o=0,s=!1,u=()=>s&&!r&&i.complete();t.subscribe(Me(i,d=>{r?.unsubscribe();let m=0,h=o++;Ct(n(d,h)).subscribe(r=Me(i,y=>i.next(e?e(d,y,h,m++):y),()=>{r=null,u()}))},()=>{s=!0,u()}))})}function Ru(n){return Re((e,t)=>{Ct(n).subscribe(Me(t,()=>t.complete(),da)),!t.closed&&e.subscribe(t)})}function Ze(n,e,t){let i=xe(n)||e||t?{next:n,error:e,complete:t}:n;return i?Re((r,o)=>{var s;(s=i.subscribe)===null||s===void 0||s.call(i);let u=!0;r.subscribe(Me(o,d=>{var m;(m=i.next)===null||m===void 0||m.call(i,d),o.next(d)},()=>{var d;u=!1,(d=i.complete)===null||d===void 0||d.call(i),o.complete()},d=>{var m;u=!1,(m=i.error)===null||m===void 0||m.call(i,d),o.error(d)},()=>{var d,m;u&&((d=i.unsubscribe)===null||d===void 0||d.call(i)),(m=i.finalize)===null||m===void 0||m.call(i)}))}):Cn}function O_(n){let e=fe(null);try{return n()}finally{fe(e)}}var L_=q(k({},Sr),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!0,dirty:!0,kind:"effect"});function B_(n){if(n.dirty=!1,n.version>0&&!bo(n))return;n.version++;let e=Dr(n);try{n.cleanup(),n.fn()}finally{Eo(n,e)}}var Vu="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",j=class extends Error{code;constructor(e,t){super(rr(e,t)),this.code=e}};function xS(n){return`NG0${Math.abs(n)}`}function rr(n,e){return`${xS(n)}${e?": "+e:""}`}var ki=globalThis;function We(n){for(let e in n)if(n[e]===We)return e;throw Error("")}function H_(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Pi(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(Pi).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let i=t.indexOf(`
`);return i>=0?t.slice(0,i):t}function Ou(n,e){return n?e?`${n} ${e}`:n:e||""}var ES=We({__forward_ref__:We});function bt(n){return n.__forward_ref__=bt,n.toString=function(){return Pi(this())},n}function Ut(n){return rf(n)?n():n}function rf(n){return typeof n=="function"&&n.hasOwnProperty(ES)&&n.__forward_ref__===bt}function J(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Nn(n){return{providers:n.providers||[],imports:n.imports||[]}}function ha(n){return bS(n,Lu)}function of(n){return ha(n)!==null}function bS(n,e){return n.hasOwnProperty(e)&&n[e]||null}function SS(n){let e=n?.[Lu]??null;return e||null}function Yp(n){return n&&n.hasOwnProperty(Pu)?n[Pu]:null}var Lu=We({\u0275prov:We}),Pu=We({\u0275inj:We}),te=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=J({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function sf(n){return n&&!!n.\u0275providers}var af=We({\u0275cmp:We}),lf=We({\u0275dir:We}),uf=We({\u0275pipe:We}),df=We({\u0275mod:We}),pa=We({\u0275fac:We}),Pr=We({__NG_ELEMENT_ID__:We}),U_=We({__NG_ENV_ID__:We});function mi(n){return typeof n=="string"?n:n==null?"":String(n)}function G_(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():mi(n)}var q_=We({ngErrorCode:We}),DS=We({ngErrorMessage:We}),wS=We({ngTokenPath:We});function cf(n,e){return W_("",-200,e)}function Bu(n,e){throw new j(-201,!1)}function W_(n,e,t){let i=new j(e,n);return i[q_]=e,i[DS]=n,t&&(i[wS]=t),i}function TS(n){return n[q_]}var Jp;function j_(){return Jp}function Xt(n){let e=Jp;return Jp=n,e}function mf(n,e,t){let i=ha(n);if(i&&i.providedIn=="root")return i.value===void 0?i.value=i.factory():i.value;if(t&8)return null;if(e!==void 0)return e;Bu(n,"Injector")}var IS={},Ar=IS,MS="__NG_DI_FLAG__",Kp=class{injector;constructor(e){this.injector=e}retrieve(e,t){let i=Nr(t)||0;try{return this.injector.get(e,i&8?null:Ar,i)}catch(r){if(Co(r))return r;throw r}}};function AS(n,e=0){let t=Zl();if(t===void 0)throw new j(-203,!1);if(t===null)return mf(n,void 0,e);{let i=NS(e),r=t.retrieve(n,i);if(Co(r)){if(i.optional)return null;throw r}return r}}function oe(n,e=0){return(j_()||AS)(Ut(n),e)}function P(n,e){return oe(n,Nr(e))}function Nr(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function NS(n){return{optional:!!(n&8),host:!!(n&1),self:!!(n&2),skipSelf:!!(n&4)}}function Qp(n){let e=[];for(let t=0;t<n.length;t++){let i=Ut(n[t]);if(Array.isArray(i)){if(i.length===0)throw new j(900,!1);let r,o=0;for(let s=0;s<i.length;s++){let u=i[s],d=RS(u);typeof d=="number"?d===-1?r=u.token:o|=d:r=u}e.push(oe(r,o))}else e.push(oe(i))}return e}function RS(n){return n[MS]}function nr(n,e){let t=n.hasOwnProperty(pa);return t?n[pa]:null}function z_(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],o=e[i];if(t&&(r=t(r),o=t(o)),o!==r)return!1}return!0}function Y_(n){return n.flat(Number.POSITIVE_INFINITY)}function Uu(n,e){n.forEach(t=>Array.isArray(t)?Uu(t,e):e(t))}function pf(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function ya(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function J_(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(r===1)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;){let o=r-2;n[r]=n[o],r--}n[e]=t,n[e+1]=i}}function $u(n,e,t){let i=Vo(n,e);return i>=0?n[i|1]=t:(i=~i,J_(n,i,e,t)),i}function Hu(n,e){let t=Vo(n,e);if(t>=0)return n[t|1]}function Vo(n,e){return FS(n,e,1)}function FS(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){let o=i+(r-i>>1),s=n[o<<t];if(e===s)return o<<t;s>e?r=o:i=o+1}return~(r<<t)}var or={},en=[],sr=new te(""),ff=new te("",-1),gf=new te(""),fa=class{get(e,t=Ar){if(t===Ar){let r=W_("",-201);throw r.name="\u0275NotFound",r}return t}};function hf(n){return n[df]||null}function ar(n){return n[af]||null}function yf(n){return n[lf]||null}function K_(n){return n[uf]||null}function kr(n){return{\u0275providers:n}}function Q_(...n){return{\u0275providers:_f(!0,n),\u0275fromNgModule:!0}}function _f(n,...e){let t=[],i=new Set,r,o=s=>{t.push(s)};return Uu(e,s=>{let u=s;ku(u,o,[],i)&&(r||=[],r.push(u))}),r!==void 0&&Z_(r,o),t}function Z_(n,e){for(let t=0;t<n.length;t++){let{ngModule:i,providers:r}=n[t];vf(r,o=>{e(o,i)})}}function ku(n,e,t,i){if(n=Ut(n),!n)return!1;let r=null,o=Yp(n),s=!o&&ar(n);if(!o&&!s){let d=n.ngModule;if(o=Yp(d),o)r=d;else return!1}else{if(s&&!s.standalone)return!1;r=n}let u=i.has(r);if(s){if(u)return!1;if(i.add(r),s.dependencies){let d=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let m of d)ku(m,e,t,i)}}else if(o){if(o.imports!=null&&!u){i.add(r);let m;try{Uu(o.imports,h=>{ku(h,e,t,i)&&(m||=[],m.push(h))})}finally{}m!==void 0&&Z_(m,e)}if(!u){let m=nr(r)||(()=>new r);e({provide:r,useFactory:m,deps:en},r),e({provide:gf,useValue:r,multi:!0},r),e({provide:sr,useValue:()=>oe(r),multi:!0},r)}let d=o.providers;if(d!=null&&!u){let m=n;vf(d,h=>{e(h,m)})}}else return!1;return r!==n&&n.providers!==void 0}function vf(n,e){for(let t of n)sf(t)&&(t=t.\u0275providers),Array.isArray(t)?vf(t,e):e(t)}var PS=We({provide:String,useValue:We});function X_(n){return n!==null&&typeof n=="object"&&PS in n}function kS(n){return!!(n&&n.useExisting)}function VS(n){return!!(n&&n.useFactory)}function Rr(n){return typeof n=="function"}function ev(n){return!!n.useClass}var _a=new te(""),Fu={},$_={},zp;function va(){return zp===void 0&&(zp=new fa),zp}var Et=class{},Fr=class extends Et{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,Xp(e,s=>this.processProvider(s)),this.records.set(ff,ko(void 0,this)),r.has("environment")&&this.records.set(Et,ko(void 0,this));let o=this.records.get(_a);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(gf,en,{self:!0}))}retrieve(e,t){let i=Nr(t)||0;try{return this.get(e,Ar,i)}catch(r){if(Co(r))return r;throw r}}destroy(){ma(this),this._destroyed=!0;let e=fe(null);try{for(let i of this._ngOnDestroyHooks)i.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let i of t)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),fe(e)}}onDestroy(e){return ma(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){ma(this);let t=ci(this),i=Xt(void 0),r;try{return e()}finally{ci(t),Xt(i)}}get(e,t=Ar,i){if(ma(this),e.hasOwnProperty(U_))return e[U_](this);let r=Nr(i),o,s=ci(this),u=Xt(void 0);try{if(!(r&4)){let m=this.records.get(e);if(m===void 0){let h=$S(e)&&ha(e);h&&this.injectableDefInScope(h)?m=ko(Zp(e),Fu):m=null,this.records.set(e,m)}if(m!=null)return this.hydrate(e,m,r)}let d=r&2?va():this.parent;return t=r&8&&t===Ar?null:t,d.get(e,t)}catch(d){let m=TS(d);throw m===-200||m===-201?new j(m,null):d}finally{Xt(u),ci(s)}}resolveInjectorInitializers(){let e=fe(null),t=ci(this),i=Xt(void 0),r;try{let o=this.get(sr,en,{self:!0});for(let s of o)s()}finally{ci(t),Xt(i),fe(e)}}toString(){let e=[],t=this.records;for(let i of t.keys())e.push(Pi(i));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=Ut(e);let t=Rr(e)?e:Ut(e&&e.provide),i=LS(e);if(!Rr(e)&&e.multi===!0){let r=this.records.get(t);r||(r=ko(void 0,Fu,!0),r.factory=()=>Qp(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t,i){let r=fe(null);try{if(t.value===$_)throw cf(Pi(e));return t.value===Fu&&(t.value=$_,t.value=t.factory(void 0,i)),typeof t.value=="object"&&t.value&&US(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{fe(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Ut(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Zp(n){let e=ha(n),t=e!==null?e.factory:nr(n);if(t!==null)return t;if(n instanceof te)throw new j(204,!1);if(n instanceof Function)return OS(n);throw new j(204,!1)}function OS(n){if(n.length>0)throw new j(204,!1);let t=SS(n);return t!==null?()=>t.factory(n):()=>new n}function LS(n){if(X_(n))return ko(void 0,n.useValue);{let e=Cf(n);return ko(e,Fu)}}function Cf(n,e,t){let i;if(Rr(n)){let r=Ut(n);return nr(r)||Zp(r)}else if(X_(n))i=()=>Ut(n.useValue);else if(VS(n))i=()=>n.useFactory(...Qp(n.deps||[]));else if(kS(n))i=(r,o)=>oe(Ut(n.useExisting),o!==void 0&&o&8?8:void 0);else{let r=Ut(n&&(n.useClass||n.provide));if(BS(n))i=()=>new r(...Qp(n.deps));else return nr(r)||Zp(r)}return i}function ma(n){if(n.destroyed)throw new j(205,!1)}function ko(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function BS(n){return!!n.deps}function US(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function $S(n){return typeof n=="function"||typeof n=="object"&&n.ngMetadataName==="InjectionToken"}function Xp(n,e){for(let t of n)Array.isArray(t)?Xp(t,e):t&&sf(t)?Xp(t.\u0275providers,e):e(t)}function At(n,e){let t;n instanceof Fr?(ma(n),t=n):t=new Kp(n);let i,r=ci(t),o=Xt(void 0);try{return e()}finally{ci(r),Xt(o)}}function tv(){return j_()!==void 0||Zl()!=null}var zn=0,ae=1,ge=2,Mt=3,Rn=4,Fn=5,Oo=6,Lo=7,ht=8,Vi=9,pi=10,Je=11,Bo=12,xf=13,Vr=14,xn=15,lr=16,Or=17,fi=18,Ca=19,Ef=20,Fi=21,Gu=22,Oi=23,En=24,Lr=25,Br=26,st=27,nv=1,bf=6,ur=7,xa=8,Ur=9,mt=10;function gi(n){return Array.isArray(n)&&typeof n[nv]=="object"}function Yn(n){return Array.isArray(n)&&n[nv]===!0}function Sf(n){return(n.flags&4)!==0}function dr(n){return n.componentOffset>-1}function Uo(n){return(n.flags&1)===1}function hi(n){return!!n.template}function $o(n){return(n[ge]&512)!==0}function $r(n){return(n[ge]&256)===256}var Df="svg",iv="math";function Pn(n){for(;Array.isArray(n);)n=n[zn];return n}function wf(n,e){return Pn(e[n])}function Jn(n,e){return Pn(e[n.index])}function Ea(n,e){return n.data[e]}function qu(n,e){return n[e]}function Tf(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}function kn(n,e){let t=e[n];return gi(t)?t:t[zn]}function rv(n){return(n[ge]&4)===4}function Wu(n){return(n[ge]&128)===128}function ov(n){return Yn(n[Mt])}function Vn(n,e){return e==null?null:n[e]}function If(n){n[Or]=0}function Mf(n){n[ge]&1024||(n[ge]|=1024,Wu(n)&&cr(n))}function sv(n,e){for(;n>0;)e=e[Vr],n--;return e}function ba(n){return!!(n[ge]&9216||n[En]?.dirty)}function ju(n){n[pi].changeDetectionScheduler?.notify(8),n[ge]&64&&(n[ge]|=1024),ba(n)&&cr(n)}function cr(n){n[pi].changeDetectionScheduler?.notify(0);let e=ir(n);for(;e!==null&&!(e[ge]&8192||(e[ge]|=8192,!Wu(e)));)e=ir(e)}function Af(n,e){if($r(n))throw new j(911,!1);n[Fi]===null&&(n[Fi]=[]),n[Fi].push(e)}function av(n,e){if(n[Fi]===null)return;let t=n[Fi].indexOf(e);t!==-1&&n[Fi].splice(t,1)}function ir(n){let e=n[Mt];return Yn(e)?e[Mt]:e}function Nf(n){return n[Lo]??=[]}function Rf(n){return n.cleanup??=[]}function lv(n,e,t,i){let r=Nf(e);r.push(t),n.firstCreatePass&&Rf(n).push(i,r.length-1)}var Ee={lFrame:xv(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var ef=!1;function uv(){return Ee.lFrame.elementDepthCount}function dv(){Ee.lFrame.elementDepthCount++}function Ff(){Ee.lFrame.elementDepthCount--}function zu(){return Ee.bindingsEnabled}function cv(){return Ee.skipHydrationRootTNode!==null}function Pf(n){return Ee.skipHydrationRootTNode===n}function kf(){Ee.skipHydrationRootTNode=null}function ce(){return Ee.lFrame.lView}function tt(){return Ee.lFrame.tView}function w(n){return Ee.lFrame.contextLView=n,n[ht]}function T(n){return Ee.lFrame.contextLView=null,n}function St(){let n=Vf();for(;n!==null&&n.type===64;)n=n.parent;return n}function Vf(){return Ee.lFrame.currentTNode}function mv(){let n=Ee.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function Ho(n,e){let t=Ee.lFrame;t.currentTNode=n,t.isParent=e}function Of(){return Ee.lFrame.isParent}function pv(){Ee.lFrame.isParent=!1}function fv(){return Ee.lFrame.contextLView}function Lf(){return ef}function Go(n){let e=ef;return ef=n,e}function Yu(){let n=Ee.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function Bf(){return Ee.lFrame.bindingIndex}function gv(n){return Ee.lFrame.bindingIndex=n}function mr(){return Ee.lFrame.bindingIndex++}function Sa(n){let e=Ee.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function hv(){return Ee.lFrame.inI18n}function yv(n,e){let t=Ee.lFrame;t.bindingIndex=t.bindingRootIndex=n,Ju(e)}function _v(){return Ee.lFrame.currentDirectiveIndex}function Ju(n){Ee.lFrame.currentDirectiveIndex=n}function vv(n){let e=Ee.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function Uf(){return Ee.lFrame.currentQueryIndex}function Ku(n){Ee.lFrame.currentQueryIndex=n}function HS(n){let e=n[ae];return e.type===2?e.declTNode:e.type===1?n[Fn]:null}function $f(n,e,t){if(t&4){let r=e,o=n;for(;r=r.parent,r===null&&!(t&1);)if(r=HS(o),r===null||(o=o[Vr],r.type&10))break;if(r===null)return!1;e=r,n=o}let i=Ee.lFrame=Cv();return i.currentTNode=e,i.lView=n,!0}function Qu(n){let e=Cv(),t=n[ae];Ee.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function Cv(){let n=Ee.lFrame,e=n===null?null:n.child;return e===null?xv(n):e}function xv(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function Ev(){let n=Ee.lFrame;return Ee.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var Hf=Ev;function Zu(){let n=Ev();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function bv(n){return(Ee.lFrame.contextLView=sv(n,Ee.lFrame.contextLView))[ht]}function Kn(){return Ee.lFrame.selectedIndex}function pr(n){Ee.lFrame.selectedIndex=n}function Da(){let n=Ee.lFrame;return Ea(n.tView,n.selectedIndex)}function Li(){Ee.lFrame.currentNamespace=Df}function Hr(){GS()}function GS(){Ee.lFrame.currentNamespace=null}function Sv(){return Ee.lFrame.currentNamespace}var Dv=!0;function Xu(){return Dv}function wa(n){Dv=n}function tf(n,e=null,t=null,i){let r=Gf(n,e,t,i);return r.resolveInjectorInitializers(),r}function Gf(n,e=null,t=null,i,r=new Set){let o=[t||en,Q_(n)];return i=i||(typeof n=="object"?void 0:Pi(n)),new Fr(o,e||va(),i||null,r)}var Jt=class n{static THROW_IF_NOT_FOUND=Ar;static NULL=new fa;static create(e,t){if(Array.isArray(e))return tf({name:""},t,e,"");{let i=e.name??"";return tf({name:i},e.parent,e.providers,i)}}static \u0275prov=J({token:n,providedIn:"any",factory:()=>oe(ff)});static __NG_ELEMENT_ID__=-1},Nt=new te(""),On=(()=>{class n{static __NG_ELEMENT_ID__=qS;static __NG_ENV_ID__=t=>t}return n})(),ga=class extends On{_lView;constructor(e){super(),this._lView=e}get destroyed(){return $r(this._lView)}onDestroy(e){let t=this._lView;return Af(t,e),()=>av(t,e)}};function qS(){return new ga(ce())}var Mn=class{_console=console;handleError(e){this._console.error("ERROR",e)}},fn=new te("",{providedIn:"root",factory:()=>{let n=P(Et),e;return t=>{n.destroyed&&!e?setTimeout(()=>{throw t}):(e??=n.get(Mn),e.handleError(t))}}}),wv={provide:sr,useValue:()=>void P(Mn),multi:!0};function qf(n){return typeof n=="function"&&n[zt]!==void 0}function S(n,e){let[t,i,r]=Np(n,e?.equal),o=t,s=o[zt];return o.set=i,o.update=r,o.asReadonly=Wf.bind(o),o}function Wf(){let n=this[zt];if(n.readonlyFn===void 0){let e=()=>this();e[zt]=n,n.readonlyFn=e}return n.readonlyFn}function jf(n){return qf(n)&&typeof n.set=="function"}var qo=(()=>{class n{view;node;constructor(t,i){this.view=t,this.node=i}static __NG_ELEMENT_ID__=WS}return n})();function WS(){return new qo(ce(),St())}var An=class{},Ta=new te("",{providedIn:"root",factory:()=>!1});var zf=new te(""),ed=new te(""),yi=(()=>{class n{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new Bt(!1);get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new Te(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=J({token:n,providedIn:"root",factory:()=>new n})}return n})(),Wo=(()=>{class n{internalPendingTasks=P(yi);scheduler=P(An);errorHandler=P(fn);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(t))}}run(t){let i=this.add();t().catch(this.errorHandler).finally(i)}static \u0275prov=J({token:n,providedIn:"root",factory:()=>new n})}return n})();function Gr(...n){}var Ia=(()=>{class n{static \u0275prov=J({token:n,providedIn:"root",factory:()=>new nf})}return n})(),nf=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let t=e.zone,i=this.queues.get(t);i.has(e)&&(i.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let i=this.queues.get(t);i.has(e)||i.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[t,i]of this.queues)t===null?e||=this.flushQueue(i):e||=t.run(()=>this.flushQueue(i));e||(this.dirtyEffectCount=0)}}flushQueue(e){let t=!1;for(let i of e)i.dirty&&(this.dirtyEffectCount--,t=!0,i.run());return t}};function Ba(n){return{toString:n}.toString()}function QS(n){return typeof n=="function"}var ud=class{previousValue;currentValue;firstChange;constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}};function i1(n,e,t,i){e!==null?e.applyValueToInputSignal(e,i):n[t]=i}var Bn=(()=>{let n=()=>r1;return n.ngInherit=!0,n})();function r1(n){return n.type.prototype.ngOnChanges&&(n.setInput=XS),ZS}function ZS(){let n=s1(this),e=n?.current;if(e){let t=n.previous;if(t===or)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function XS(n,e,t,i,r){let o=this.declaredInputs[i],s=s1(n)||eD(n,{previous:or,current:null}),u=s.current||(s.current={}),d=s.previous,m=d[o];u[o]=new ud(m&&m.currentValue,t,d===or),i1(n,e,r,t)}var o1="__ngSimpleChanges__";function s1(n){return n[o1]||null}function eD(n,e){return n[o1]=e}var Tv=[];var ze=function(n,e=null,t){for(let i=0;i<Tv.length;i++){let r=Tv[i];r(n,e,t)}};function tD(n,e,t){let{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=e.type.prototype;if(i){let s=r1(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}r&&(t.preOrderHooks??=[]).push(0-n,r),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function a1(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:u,ngAfterViewInit:d,ngAfterViewChecked:m,ngOnDestroy:h}=o;s&&(n.contentHooks??=[]).push(-t,s),u&&((n.contentHooks??=[]).push(t,u),(n.contentCheckHooks??=[]).push(t,u)),d&&(n.viewHooks??=[]).push(-t,d),m&&((n.viewHooks??=[]).push(t,m),(n.viewCheckHooks??=[]).push(t,m)),h!=null&&(n.destroyHooks??=[]).push(t,h)}}function rd(n,e,t){l1(n,e,3,t)}function od(n,e,t,i){(n[ge]&3)===t&&l1(n,e,t,i)}function Yf(n,e){let t=n[ge];(t&3)===e&&(t&=16383,t+=1,n[ge]=t)}function l1(n,e,t,i){let r=i!==void 0?n[Or]&65535:0,o=i??-1,s=e.length-1,u=0;for(let d=r;d<s;d++)if(typeof e[d+1]=="number"){if(u=e[d],i!=null&&u>=i)break}else e[d]<0&&(n[Or]+=65536),(u<o||o==-1)&&(nD(n,t,e,d),n[Or]=(n[Or]&4294901760)+d+2),d++}function Iv(n,e){ze(4,n,e);let t=fe(null);try{e.call(n)}finally{fe(t),ze(5,n,e)}}function nD(n,e,t,i){let r=t[i]<0,o=t[i+1],s=r?-t[i]:t[i],u=n[s];r?n[ge]>>14<n[Or]>>16&&(n[ge]&3)===e&&(n[ge]+=16384,Iv(u,o)):Iv(u,o)}var zo=-1,Wr=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,i,r){this.factory=e,this.name=r,this.canSeeViewProviders=t,this.injectImpl=i}};function iD(n){return(n.flags&8)!==0}function rD(n){return(n.flags&16)!==0}function oD(n,e,t){let i=0;for(;i<t.length;){let r=t[i];if(typeof r=="number"){if(r!==0)break;i++;let o=t[i++],s=t[i++],u=t[i++];n.setAttribute(e,s,u,o)}else{let o=r,s=t[++i];sD(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),i++}}return i}function u1(n){return n===3||n===4||n===6}function sD(n){return n.charCodeAt(0)===64}function Yo(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){let r=e[i];typeof r=="number"?t=r:t===0||(t===-1||t===2?Mv(n,t,r,null,e[++i]):Mv(n,t,r,null,null))}}return n}function Mv(n,e,t,i,r){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let u=n[o++];if(typeof u=="number"){if(u===e){s=-1;break}else if(u>e){s=o-1;break}}}for(;o<n.length;){let u=n[o];if(typeof u=="number")break;if(u===t){r!==null&&(n[o+1]=r);return}o++,r!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),r!==null&&n.splice(o++,0,r)}function d1(n){return n!==zo}function dd(n){return n&32767}function aD(n){return n>>16}function cd(n,e){let t=aD(n),i=e;for(;t>0;)i=i[Vr],t--;return i}var o0=!0;function md(n){let e=o0;return o0=n,e}var lD=256,c1=lD-1,m1=5,uD=0,_i={};function dD(n,e,t){let i;typeof t=="string"?i=t.charCodeAt(0)||0:t.hasOwnProperty(Pr)&&(i=t[Pr]),i==null&&(i=t[Pr]=uD++);let r=i&c1,o=1<<r;e.data[n+(r>>m1)]|=o}function pd(n,e){let t=p1(n,e);if(t!==-1)return t;let i=e[ae];i.firstCreatePass&&(n.injectorIndex=e.length,Jf(i.data,n),Jf(e,null),Jf(i.blueprint,null));let r=V0(n,e),o=n.injectorIndex;if(d1(r)){let s=dd(r),u=cd(r,e),d=u[ae].data;for(let m=0;m<8;m++)e[o+m]=u[s+m]|d[s+m]}return e[o+8]=r,o}function Jf(n,e){n.push(0,0,0,0,0,0,0,0,e)}function p1(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function V0(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;r!==null;){if(i=_1(r),i===null)return zo;if(t++,r=r[Vr],i.injectorIndex!==-1)return i.injectorIndex|t<<16}return zo}function s0(n,e,t){dD(n,e,t)}function cD(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let i=t.length,r=0;for(;r<i;){let o=t[r];if(u1(o))break;if(o===0)r=r+2;else if(typeof o=="number")for(r++;r<i&&typeof t[r]=="string";)r++;else{if(o===e)return t[r+1];r=r+2}}}return null}function f1(n,e,t){if(t&8||n!==void 0)return n;Bu(e,"NodeInjector")}function g1(n,e,t,i){if(t&8&&i===void 0&&(i=null),(t&3)===0){let r=n[Vi],o=Xt(void 0);try{return r?r.get(e,i,t&8):mf(e,i,t&8)}finally{Xt(o)}}return f1(i,e,t)}function h1(n,e,t,i=0,r){if(n!==null){if(e[ge]&2048&&!(i&2)){let s=gD(n,e,t,i,_i);if(s!==_i)return s}let o=y1(n,e,t,i,_i);if(o!==_i)return o}return g1(e,t,i,r)}function y1(n,e,t,i,r){let o=pD(t);if(typeof o=="function"){if(!$f(e,n,i))return i&1?f1(r,t,i):g1(e,t,i,r);try{let s;if(s=o(i),s==null&&!(i&8))Bu(t);else return s}finally{Hf()}}else if(typeof o=="number"){let s=null,u=p1(n,e),d=zo,m=i&1?e[xn][Fn]:null;for((u===-1||i&4)&&(d=u===-1?V0(n,e):e[u+8],d===zo||!Nv(i,!1)?u=-1:(s=e[ae],u=dd(d),e=cd(d,e)));u!==-1;){let h=e[ae];if(Av(o,u,h.data)){let y=mD(u,e,t,s,i,m);if(y!==_i)return y}d=e[u+8],d!==zo&&Nv(i,e[ae].data[u+8]===m)&&Av(o,u,e)?(s=h,u=dd(d),e=cd(d,e)):u=-1}}return r}function mD(n,e,t,i,r,o){let s=e[ae],u=s.data[n+8],d=i==null?dr(u)&&o0:i!=s&&(u.type&3)!==0,m=r&1&&o===u,h=sd(u,s,t,d,m);return h!==null?Na(e,s,h,u,r):_i}function sd(n,e,t,i,r){let o=n.providerIndexes,s=e.data,u=o&1048575,d=n.directiveStart,m=n.directiveEnd,h=o>>20,y=i?u:u+h,_=r?u+h:m;for(let C=y;C<_;C++){let D=s[C];if(C<d&&t===D||C>=d&&D.type===t)return C}if(r){let C=s[d];if(C&&hi(C)&&C.type===t)return d}return null}function Na(n,e,t,i,r){let o=n[t],s=e.data;if(o instanceof Wr){let u=o;if(u.resolving){let C=G_(s[t]);throw cf(C)}let d=md(u.canSeeViewProviders);u.resolving=!0;let m=s[t].type||s[t],h,y=u.injectImpl?Xt(u.injectImpl):null,_=$f(n,i,0);try{o=n[t]=u.factory(void 0,r,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&tD(t,s[t],e)}finally{y!==null&&Xt(y),md(d),u.resolving=!1,Hf()}}return o}function pD(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(Pr)?n[Pr]:void 0;return typeof e=="number"?e>=0?e&c1:fD:e}function Av(n,e,t){let i=1<<n;return!!(t[e+(n>>m1)]&i)}function Nv(n,e){return!(n&2)&&!(n&1&&e)}var qr=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return h1(this._tNode,this._lView,e,Nr(i),t)}};function fD(){return new qr(St(),ce())}function tn(n){return Ba(()=>{let e=n.prototype.constructor,t=e[pa]||a0(e),i=Object.prototype,r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){let o=r[pa]||a0(r);if(o&&o!==t)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function a0(n){return rf(n)?()=>{let e=a0(Ut(n));return e&&e()}:nr(n)}function gD(n,e,t,i,r){let o=n,s=e;for(;o!==null&&s!==null&&s[ge]&2048&&!$o(s);){let u=y1(o,s,t,i|2,_i);if(u!==_i)return u;let d=o.parent;if(!d){let m=s[Ef];if(m){let h=m.get(t,_i,i);if(h!==_i)return h}d=_1(s),s=s[Vr]}o=d}return r}function _1(n){let e=n[ae],t=e.type;return t===2?e.declTNode:t===1?n[Fn]:null}function Ua(n){return cD(St(),n)}function hD(){return Zo(St(),ce())}function Zo(n,e){return new nn(Jn(n,e))}var nn=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=hD}return n})();function yD(n){return n instanceof nn?n.nativeElement:n}function _D(){return this._results[Symbol.iterator]()}var fd=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new gt}constructor(e=!1){this._emitDistinctChangesOnly=e}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let i=Y_(e);(this._changesDetected=!z_(this._results,i,t))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=_D};function v1(n){return(n.flags&128)===128}var O0=(function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n})(O0||{}),C1=new Map,vD=0;function CD(){return vD++}function xD(n){C1.set(n[Ca],n)}function l0(n){C1.delete(n[Ca])}var Rv="__ngContext__";function Jo(n,e){gi(e)?(n[Rv]=e[Ca],xD(e)):n[Rv]=e}function x1(n){return b1(n[Bo])}function E1(n){return b1(n[Rn])}function b1(n){for(;n!==null&&!Yn(n);)n=n[Rn];return n}var u0;function L0(n){u0=n}function S1(){if(u0!==void 0)return u0;if(typeof document<"u")return document;throw new j(210,!1)}var Ad=new te("",{providedIn:"root",factory:()=>ED}),ED="ng",Nd=new te(""),$a=new te("",{providedIn:"platform",factory:()=>"unknown"});var Rd=new te("",{providedIn:"root",factory:()=>S1().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var bD="h",SD="b";var D1="r";var w1="di";var T1=!1,I1=new te("",{providedIn:"root",factory:()=>T1});var DD=(n,e,t,i)=>{};function wD(n,e,t,i){DD(n,e,t,i)}function B0(n){return(n.flags&32)===32}var TD=()=>null;function M1(n,e,t=!1){return TD(n,e,t)}function A1(n,e){let t=n.contentQueries;if(t!==null){let i=fe(null);try{for(let r=0;r<t.length;r+=2){let o=t[r],s=t[r+1];if(s!==-1){let u=n.data[s];Ku(o),u.contentQueries(2,e[s],s)}}}finally{fe(i)}}}function d0(n,e,t){Ku(0);let i=fe(null);try{e(n,t)}finally{fe(i)}}function U0(n,e,t){if(Sf(e)){let i=fe(null);try{let r=e.directiveStart,o=e.directiveEnd;for(let s=r;s<o;s++){let u=n.data[s];if(u.contentQueries){let d=t[s];u.contentQueries(1,d,s)}}}finally{fe(i)}}}var Bi=(function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n})(Bi||{});var td;function ID(){if(td===void 0&&(td=null,ki.trustedTypes))try{td=ki.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return td}function Fv(n){return ID()?.createScriptURL(n)||n}var gd=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Vu})`}};function Ha(n){return n instanceof gd?n.changingThisBreaksApplicationSecurity:n}function $0(n,e){let t=N1(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${Vu})`)}return t===e}function N1(n){return n instanceof gd&&n.getTypeName()||null}var MD=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function R1(n){return n=String(n),n.match(MD)?n:"unsafe:"+n}var AD=/^>|^->|<!--|-->|--!>|<!-$/g,ND=/(<|>)/g,RD="\u200B$1\u200B";function FD(n){return n.replace(AD,e=>e.replace(ND,RD))}function PD(n,e){return n.createText(e)}function kD(n,e,t){n.setValue(e,t)}function VD(n,e){return n.createComment(FD(e))}function F1(n,e,t){return n.createElement(e,t)}function hd(n,e,t,i,r){n.insertBefore(e,t,i,r)}function P1(n,e,t){n.appendChild(e,t)}function Pv(n,e,t,i,r){i!==null?hd(n,e,t,i,r):P1(n,e,t)}function k1(n,e,t,i){n.removeChild(null,e,t,i)}function OD(n,e,t){n.setAttribute(e,"style",t)}function LD(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function V1(n,e,t){let{mergedAttrs:i,classes:r,styles:o}=t;i!==null&&oD(n,e,i),r!==null&&LD(n,e,r),o!==null&&OD(n,e,o)}var Fd=(function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n})(Fd||{});function $t(n){let e=L1();return e?e.sanitize(Fd.URL,n)||"":$0(n,"URL")?Ha(n):R1(mi(n))}function O1(n){let e=L1();if(e)return Fv(e.sanitize(Fd.RESOURCE_URL,n)||"");if($0(n,"ResourceURL"))return Fv(Ha(n));throw new j(904,!1)}var BD=new Set(["embed","frame","iframe","media","script"]),UD=new Set(["base","link","script"]);function $D(n,e){return e==="src"&&BD.has(n)||e==="href"&&UD.has(n)||e==="xlink:href"&&n==="script"?O1:$t}function H0(n,e,t){return $D(e,t)(n)}function L1(){let n=ce();return n&&n[pi].sanitizer}function B1(n){return n instanceof Function?n():n}function HD(n,e,t){let i=n.length;for(;;){let r=n.indexOf(e,t);if(r===-1)return r;if(r===0||n.charCodeAt(r-1)<=32){let o=e.length;if(r+o===i||n.charCodeAt(r+o)<=32)return r}t=r+1}}var U1="ng-template";function GD(n,e,t,i){let r=0;if(i){for(;r<e.length&&typeof e[r]=="string";r+=2)if(e[r]==="class"&&HD(e[r+1].toLowerCase(),t,0)!==-1)return!0}else if(G0(n))return!1;if(r=e.indexOf(1,r),r>-1){let o;for(;++r<e.length&&typeof(o=e[r])=="string";)if(o.toLowerCase()===t)return!0}return!1}function G0(n){return n.type===4&&n.value!==U1}function qD(n,e,t){let i=n.type===4&&!t?U1:n.value;return e===i}function WD(n,e,t){let i=4,r=n.attrs,o=r!==null?YD(r):0,s=!1;for(let u=0;u<e.length;u++){let d=e[u];if(typeof d=="number"){if(!s&&!Qn(i)&&!Qn(d))return!1;if(s&&Qn(d))continue;s=!1,i=d|i&1;continue}if(!s)if(i&4){if(i=2|i&1,d!==""&&!qD(n,d,t)||d===""&&e.length===1){if(Qn(i))return!1;s=!0}}else if(i&8){if(r===null||!GD(n,r,d,t)){if(Qn(i))return!1;s=!0}}else{let m=e[++u],h=jD(d,r,G0(n),t);if(h===-1){if(Qn(i))return!1;s=!0;continue}if(m!==""){let y;if(h>o?y="":y=r[h+1].toLowerCase(),i&2&&m!==y){if(Qn(i))return!1;s=!0}}}}return Qn(i)||s}function Qn(n){return(n&1)===0}function jD(n,e,t,i){if(e===null)return-1;let r=0;if(i||!t){let o=!1;for(;r<e.length;){let s=e[r];if(s===n)return r;if(s===3||s===6)o=!0;else if(s===1||s===2){let u=e[++r];for(;typeof u=="string";)u=e[++r];continue}else{if(s===4)break;if(s===0){r+=4;continue}}r+=o?1:2}return-1}else return JD(e,n)}function zD(n,e,t=!1){for(let i=0;i<e.length;i++)if(WD(n,e[i],t))return!0;return!1}function YD(n){for(let e=0;e<n.length;e++){let t=n[e];if(u1(t))return e}return n.length}function JD(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let i=n[t];if(typeof i=="number")return-1;if(i===e)return t;t++}return-1}function kv(n,e){return n?":not("+e.trim()+")":e}function KD(n){let e=n[0],t=1,i=2,r="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(i&2){let u=n[++t];r+="["+s+(u.length>0?'="'+u+'"':"")+"]"}else i&8?r+="."+s:i&4&&(r+=" "+s);else r!==""&&!Qn(s)&&(e+=kv(o,r),r=""),i=s,o=o||!Qn(i);t++}return r!==""&&(e+=kv(o,r)),e}function QD(n){return n.map(KD).join(",")}function ZD(n){let e=[],t=[],i=1,r=2;for(;i<n.length;){let o=n[i];if(typeof o=="string")r===2?o!==""&&e.push(o,n[++i]):r===8&&t.push(o);else{if(!Qn(r))break;r=o}i++}return t.length&&e.push(1,...t),e}var Ht={};function q0(n,e,t,i,r,o,s,u,d,m,h){let y=st+i,_=y+r,C=XD(y,_),D=typeof m=="function"?m():m;return C[ae]={type:n,blueprint:C,template:t,queries:null,viewQuery:u,declTNode:e,data:C.slice().fill(null,y),bindingStartIndex:y,expandoStartIndex:_,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:d,consts:D,incompleteFirstPass:!1,ssrId:h}}function XD(n,e){let t=[];for(let i=0;i<e;i++)t.push(i<n?null:Ht);return t}function ew(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=q0(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function W0(n,e,t,i,r,o,s,u,d,m,h){let y=e.blueprint.slice();return y[zn]=r,y[ge]=i|4|128|8|64|1024,(m!==null||n&&n[ge]&2048)&&(y[ge]|=2048),If(y),y[Mt]=y[Vr]=n,y[ht]=t,y[pi]=s||n&&n[pi],y[Je]=u||n&&n[Je],y[Vi]=d||n&&n[Vi]||null,y[Fn]=o,y[Ca]=CD(),y[Oo]=h,y[Ef]=m,y[xn]=e.type==2?n[xn]:y,y}function tw(n,e,t){let i=Jn(e,n),r=ew(t),o=n[pi].rendererFactory,s=j0(n,W0(n,r,null,$1(t),i,e,null,o.createRenderer(i,t),null,null,null));return n[e.index]=s}function $1(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function H1(n,e,t,i){if(t===0)return-1;let r=e.length;for(let o=0;o<t;o++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function j0(n,e){return n[Bo]?n[xf][Rn]=e:n[Bo]=e,n[xf]=e,e}function f(n=1){G1(tt(),ce(),Kn()+n,!1)}function G1(n,e,t,i){if(!i)if((e[ge]&3)===3){let o=n.preOrderCheckHooks;o!==null&&rd(e,o,t)}else{let o=n.preOrderHooks;o!==null&&od(e,o,0,t)}pr(t)}var Pd=(function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n})(Pd||{});function c0(n,e,t,i){let r=fe(null);try{let[o,s,u]=n.inputs[t],d=null;(s&Pd.SignalBased)!==0&&(d=e[o][zt]),d!==null&&d.transformFn!==void 0?i=d.transformFn(i):u!==null&&(i=u.call(e,i)),n.setInput!==null?n.setInput(e,d,i,t,o):i1(e,d,o,i)}finally{fe(r)}}var vi=(function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n})(vi||{}),nw;function z0(n,e){return nw(n,e)}var jr=new Set,kd=(function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n})(kd||{}),Kr=new te(""),Vv=new Set;function Ui(n){Vv.has(n)||(Vv.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var q1=!1,m0=class extends gt{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,tv()&&(this.destroyRef=P(On,{optional:!0})??void 0,this.pendingTasks=P(yi,{optional:!0})??void 0)}emit(e){let t=fe(null);try{super.next(e)}finally{fe(t)}}subscribe(e,t,i){let r=e,o=t||(()=>null),s=i;if(e&&typeof e=="object"){let d=e;r=d.next?.bind(d),o=d.error?.bind(d),s=d.complete?.bind(d)}this.__isAsync&&(o=this.wrapInTimeout(o),r&&(r=this.wrapInTimeout(r)),s&&(s=this.wrapInTimeout(s)));let u=super.subscribe({next:r,error:o,complete:s});return e instanceof vt&&e.add(u),u}wrapInTimeout(e){return t=>{let i=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{i!==void 0&&this.pendingTasks?.remove(i)}})}}},at=m0;function W1(n){let e,t;function i(){n=Gr;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),i()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),i()})),()=>i()}function Ov(n){return queueMicrotask(()=>n()),()=>{n=Gr}}var Y0="isAngularZone",yd=Y0+"_ID",iw=0,yt=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new at(!1);onMicrotaskEmpty=new at(!1);onStable=new at(!1);onError=new at(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:o=q1}=e;if(typeof Zone>"u")throw new j(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!r&&i,s.shouldCoalesceRunChangeDetection=r,s.callbackScheduled=!1,s.scheduleInRootZone=o,sw(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(Y0)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new j(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new j(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,e,rw,Gr,Gr);try{return o.runTask(s,t,i)}finally{o.cancelTask(s)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}},rw={};function J0(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function ow(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){W1(()=>{n.callbackScheduled=!1,p0(n),n.isCheckStableRunning=!0,J0(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),p0(n)}function sw(n){let e=()=>{ow(n)},t=iw++;n._inner=n._inner.fork({name:"angular",properties:{[Y0]:!0,[yd]:t,[yd+t]:!0},onInvokeTask:(i,r,o,s,u,d)=>{if(aw(d))return i.invokeTask(o,s,u,d);try{return Lv(n),i.invokeTask(o,s,u,d)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),Bv(n)}},onInvoke:(i,r,o,s,u,d,m)=>{try{return Lv(n),i.invoke(o,s,u,d,m)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!lw(d)&&e(),Bv(n)}},onHasTask:(i,r,o,s)=>{i.hasTask(o,s),r===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,p0(n),J0(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(i,r,o,s)=>(i.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function p0(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function Lv(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function Bv(n){n._nesting--,J0(n)}var Ra=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new at;onMicrotaskEmpty=new at;onStable=new at;onError=new at;run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}};function aw(n){return j1(n,"__ignore_ng_zone__")}function lw(n){return j1(n,"__scheduler_tick__")}function j1(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var K0=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=J({token:n,providedIn:"root",factory:()=>new n})}return n})(),z1=[0,1,2,3],Y1=(()=>{class n{ngZone=P(yt);scheduler=P(An);errorHandler=P(Mn,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){P(Kr,{optional:!0})}execute(){let t=this.sequences.size>0;t&&ze(16),this.executing=!0;for(let i of z1)for(let r of this.sequences)if(!(r.erroredOrDestroyed||!r.hooks[i]))try{r.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let o=r.hooks[i];return o(r.pipelinedValue)},r.snapshot))}catch(o){r.erroredOrDestroyed=!0,this.errorHandler?.handleError(o)}this.executing=!1;for(let i of this.sequences)i.afterRun(),i.once&&(this.sequences.delete(i),i.destroy());for(let i of this.deferredRegistrations)this.sequences.add(i);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),t&&ze(17)}register(t){let{view:i}=t;i!==void 0?((i[Lr]??=[]).push(t),cr(i),i[ge]|=8192):this.executing?this.deferredRegistrations.add(t):this.addSequence(t)}addSequence(t){this.sequences.add(t),this.scheduler.notify(7)}unregister(t){this.executing&&this.sequences.has(t)?(t.erroredOrDestroyed=!0,t.pipelinedValue=void 0,t.once=!0):(this.sequences.delete(t),this.deferredRegistrations.delete(t))}maybeTrace(t,i){return i?i.run(kd.AFTER_NEXT_RENDER,t):t()}static \u0275prov=J({token:n,providedIn:"root",factory:()=>new n})}return n})(),_d=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(e,t,i,r,o,s=null){this.impl=e,this.hooks=t,this.view=i,this.once=r,this.snapshot=s,this.unregisterOnDestroy=o?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let e=this.view?.[Lr];e&&(this.view[Lr]=e.filter(t=>t!==this))}};function $i(n,e){let t=e?.injector??P(Jt);return Ui("NgAfterNextRender"),dw(n,t,e,!0)}function uw(n){return n instanceof Function?[void 0,void 0,n,void 0]:[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function dw(n,e,t,i){let r=e.get(K0);r.impl??=e.get(Y1);let o=e.get(Kr,null,{optional:!0}),s=t?.manualCleanup!==!0?e.get(On):null,u=e.get(qo,null,{optional:!0}),d=new _d(r.impl,uw(n),u?.view,i,s,o?.snapshot(null));return r.impl.register(d),d}var J1=new te("",{providedIn:"root",factory:()=>({queue:new Set,isScheduled:!1,scheduler:null})});function K1(n,e,t){let i=n.get(J1);if(Array.isArray(e))for(let r of e)i.queue.add(r),t?.detachedLeaveAnimationFns?.push(r);else i.queue.add(e),t?.detachedLeaveAnimationFns?.push(e);i.scheduler&&i.scheduler(n)}function cw(n,e){let t=n.get(J1);if(e.detachedLeaveAnimationFns){for(let i of e.detachedLeaveAnimationFns)t.queue.delete(i);e.detachedLeaveAnimationFns=void 0}}function mw(n,e){for(let[t,i]of e)K1(n,i.animateFns)}function Uv(n,e,t,i){let r=n?.[Br]?.enter;e!==null&&r&&r.has(t.index)&&mw(i,r)}function jo(n,e,t,i,r,o,s,u){if(r!=null){let d,m=!1;Yn(r)?d=r:gi(r)&&(m=!0,r=r[zn]);let h=Pn(r);n===0&&i!==null?(Uv(u,i,o,t),s==null?P1(e,i,h):hd(e,i,h,s||null,!0)):n===1&&i!==null?(Uv(u,i,o,t),hd(e,i,h,s||null,!0)):n===2?$v(u,o,t,y=>{k1(e,h,m,y)}):n===3&&$v(u,o,t,()=>{e.destroyNode(h)}),d!=null&&Dw(e,n,t,d,o,i,s)}}function pw(n,e){Q1(n,e),e[zn]=null,e[Fn]=null}function fw(n,e,t,i,r,o){i[zn]=r,i[Fn]=e,Od(n,i,t,1,r,o)}function Q1(n,e){e[pi].changeDetectionScheduler?.notify(9),Od(n,e,e[Je],2,null,null)}function gw(n){let e=n[Bo];if(!e)return Kf(n[ae],n);for(;e;){let t=null;if(gi(e))t=e[Bo];else{let i=e[mt];i&&(t=i)}if(!t){for(;e&&!e[Rn]&&e!==n;)gi(e)&&Kf(e[ae],e),e=e[Mt];e===null&&(e=n),gi(e)&&Kf(e[ae],e),t=e&&e[Rn]}e=t}}function Q0(n,e){let t=n[Ur],i=t.indexOf(e);t.splice(i,1)}function Vd(n,e){if($r(e))return;let t=e[Je];t.destroyNode&&Od(n,e,t,3,null,null),gw(e)}function Kf(n,e){if($r(e))return;let t=fe(null);try{e[ge]&=-129,e[ge]|=256,e[En]&&wr(e[En]),_w(n,e),yw(n,e),e[ae].type===1&&e[Je].destroy();let i=e[lr];if(i!==null&&Yn(e[Mt])){i!==e[Mt]&&Q0(i,e);let r=e[fi];r!==null&&r.detachView(n)}l0(e)}finally{fe(t)}}function $v(n,e,t,i){let r=n?.[Br];if(r==null||r.leave==null||!r.leave.has(e.index))return i(!1);n&&jr.add(n),K1(t,()=>{if(r.leave&&r.leave.has(e.index)){let s=r.leave.get(e.index),u=[];if(s){for(let d=0;d<s.animateFns.length;d++){let m=s.animateFns[d],{promise:h}=m();u.push(h)}r.detachedLeaveAnimationFns=void 0}r.running=Promise.allSettled(u),hw(n,i)}else n&&jr.delete(n),i(!1)},r)}function hw(n,e){let t=n[Br]?.running;if(t){t.then(()=>{n[Br].running=void 0,jr.delete(n),e(!0)});return}e(!1)}function yw(n,e){let t=n.cleanup,i=e[Lo];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let u=t[s+3];u>=0?i[u]():i[-u].unsubscribe(),s+=2}else{let u=i[t[s+1]];t[s].call(u)}i!==null&&(e[Lo]=null);let r=e[Fi];if(r!==null){e[Fi]=null;for(let s=0;s<r.length;s++){let u=r[s];u()}}let o=e[Oi];if(o!==null){e[Oi]=null;for(let s of o)s.destroy()}}function _w(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let i=0;i<t.length;i+=2){let r=e[t[i]];if(!(r instanceof Wr)){let o=t[i+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let u=r[o[s]],d=o[s+1];ze(4,u,d);try{d.call(u)}finally{ze(5,u,d)}}else{ze(4,r,o);try{o.call(r)}finally{ze(5,r,o)}}}}}function vw(n,e,t){return Cw(n,e.parent,t)}function Cw(n,e,t){let i=e;for(;i!==null&&i.type&168;)e=i,i=e.parent;if(i===null)return t[zn];if(dr(i)){let{encapsulation:r}=n.data[i.directiveStart+i.componentOffset];if(r===Bi.None||r===Bi.Emulated)return null}return Jn(i,t)}function xw(n,e,t){return bw(n,e,t)}function Ew(n,e,t){return n.type&40?Jn(n,t):null}var bw=Ew,Hv;function Z0(n,e,t,i){let r=vw(n,i,e),o=e[Je],s=i.parent||e[Fn],u=xw(s,i,e);if(r!=null)if(Array.isArray(t))for(let d=0;d<t.length;d++)Pv(o,r,t[d],u,!1);else Pv(o,r,t,u,!1);Hv!==void 0&&Hv(o,i,e,t,r)}function Ma(n,e){if(e!==null){let t=e.type;if(t&3)return Jn(e,n);if(t&4)return f0(-1,n[e.index]);if(t&8){let i=e.child;if(i!==null)return Ma(n,i);{let r=n[e.index];return Yn(r)?f0(-1,r):Pn(r)}}else{if(t&128)return Ma(n,e.next);if(t&32)return z0(e,n)()||Pn(n[e.index]);{let i=Z1(n,e);if(i!==null){if(Array.isArray(i))return i[0];let r=ir(n[xn]);return Ma(r,i)}else return Ma(n,e.next)}}}return null}function Z1(n,e){if(e!==null){let i=n[xn][Fn],r=e.projection;return i.projection[r]}return null}function f0(n,e){let t=mt+n+1;if(t<e.length){let i=e[t],r=i[ae].firstChild;if(r!==null)return Ma(i,r)}return e[ur]}function X0(n,e,t,i,r,o,s){for(;t!=null;){let u=i[Vi];if(t.type===128){t=t.next;continue}let d=i[t.index],m=t.type;if(s&&e===0&&(d&&Jo(Pn(d),i),t.flags|=2),!B0(t))if(m&8)X0(n,e,t.child,i,r,o,!1),jo(e,n,u,r,d,t,o,i);else if(m&32){let h=z0(t,i),y;for(;y=h();)jo(e,n,u,r,y,t,o,i);jo(e,n,u,r,d,t,o,i)}else m&16?Sw(n,e,i,t,r,o):jo(e,n,u,r,d,t,o,i);t=s?t.projectionNext:t.next}}function Od(n,e,t,i,r,o){X0(t,i,n.firstChild,e,r,o,!1)}function Sw(n,e,t,i,r,o){let s=t[xn],d=s[Fn].projection[i.projection];if(Array.isArray(d))for(let m=0;m<d.length;m++){let h=d[m];jo(e,n,t[Vi],r,h,i,o,t)}else{let m=d,h=s[Mt];v1(i)&&(m.flags|=128),X0(n,e,m,h,r,o,!0)}}function Dw(n,e,t,i,r,o,s){let u=i[ur],d=Pn(i);u!==d&&jo(e,n,t,o,u,r,s);for(let m=mt;m<i.length;m++){let h=i[m];Od(h[ae],h,n,e,o,u)}}function ww(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let o=i.indexOf("-")===-1?void 0:vi.DashCase;r==null?n.removeStyle(t,i,o):(typeof r=="string"&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=vi.Important),n.setStyle(t,i,r,o))}}function X1(n,e,t,i,r){let o=Kn(),s=i&2;try{pr(-1),s&&e.length>st&&G1(n,e,st,!1),ze(s?2:0,r,t),t(i,r)}finally{pr(o),ze(s?3:1,r,t)}}function Ld(n,e,t){Rw(n,e,t),(t.flags&64)===64&&Fw(n,e,t)}function Ga(n,e,t=Jn){let i=e.localNames;if(i!==null){let r=e.index+1;for(let o=0;o<i.length;o+=2){let s=i[o+1],u=s===-1?t(e,n):n[s];n[r++]=u}}}function Tw(n,e,t,i){let o=i.get(I1,T1)||t===Bi.ShadowDom,s=n.selectRootElement(e,o);return Iw(s),s}function Iw(n){Mw(n)}var Mw=()=>null;function Aw(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function eC(n,e,t,i,r,o){let s=e[ae];if(ig(n,s,e,t,i)){dr(n)&&Nw(e,n.index);return}n.type&3&&(t=Aw(t)),tC(n,e,t,i,r,o)}function tC(n,e,t,i,r,o){if(n.type&3){let s=Jn(n,e);i=o!=null?o(i,n.value||"",t):i,r.setProperty(s,t,i)}else n.type&12}function Nw(n,e){let t=kn(e,n);t[ge]&16||(t[ge]|=64)}function Rw(n,e,t){let i=t.directiveStart,r=t.directiveEnd;dr(t)&&tw(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||pd(t,e);let o=t.initialInputs;for(let s=i;s<r;s++){let u=n.data[s],d=Na(e,n,s,t);if(Jo(d,e),o!==null&&Ow(e,s-i,d,u,t,o),hi(u)){let m=kn(t.index,e);m[ht]=Na(e,n,s,t)}}}function Fw(n,e,t){let i=t.directiveStart,r=t.directiveEnd,o=t.index,s=_v();try{pr(o);for(let u=i;u<r;u++){let d=n.data[u],m=e[u];Ju(u),(d.hostBindings!==null||d.hostVars!==0||d.hostAttrs!==null)&&Pw(d,m)}}finally{pr(-1),Ju(s)}}function Pw(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function eg(n,e){let t=n.directiveRegistry,i=null;if(t)for(let r=0;r<t.length;r++){let o=t[r];zD(e,o.selectors,!1)&&(i??=[],hi(o)?i.unshift(o):i.push(o))}return i}function kw(n,e,t,i,r,o){let s=Jn(n,e);Vw(e[Je],s,o,n.value,t,i,r)}function Vw(n,e,t,i,r,o,s){if(o==null)n.removeAttribute(e,r,t);else{let u=s==null?mi(o):s(o,i||"",r);n.setAttribute(e,r,u,t)}}function Ow(n,e,t,i,r,o){let s=o[e];if(s!==null)for(let u=0;u<s.length;u+=2){let d=s[u],m=s[u+1];c0(i,t,d,m)}}function tg(n,e,t,i,r){let o=st+t,s=e[ae],u=r(s,e,n,i,t);e[o]=u,Ho(n,!0);let d=n.type===2;return d?(V1(e[Je],u,n),(uv()===0||Uo(n))&&Jo(u,e),dv()):Jo(u,e),Xu()&&(!d||!B0(n))&&Z0(s,e,u,n),n}function ng(n){let e=n;return Of()?pv():(e=e.parent,Ho(e,!1)),e}function Lw(n,e){let t=n[Vi];if(!t)return;let i;try{i=t.get(fn,null)}catch{i=null}i?.(e)}function ig(n,e,t,i,r){let o=n.inputs?.[i],s=n.hostDirectiveInputs?.[i],u=!1;if(s)for(let d=0;d<s.length;d+=2){let m=s[d],h=s[d+1],y=e.data[m];c0(y,t[m],h,r),u=!0}if(o)for(let d of o){let m=t[d],h=e.data[d];c0(h,m,i,r),u=!0}return u}function Bw(n,e){let t=kn(e,n),i=t[ae];Uw(i,t);let r=t[zn];r!==null&&t[Oo]===null&&(t[Oo]=M1(r,t[Vi])),ze(18),rg(i,t,t[ht]),ze(19,t[ht])}function Uw(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function rg(n,e,t){Qu(e);try{let i=n.viewQuery;i!==null&&d0(1,i,t);let r=n.template;r!==null&&X1(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[fi]?.finishViewCreation(n),n.staticContentQueries&&A1(n,e),n.staticViewQueries&&d0(2,n.viewQuery,t);let o=n.components;o!==null&&$w(e,o)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[ge]&=-5,Zu()}}function $w(n,e){for(let t=0;t<e.length;t++)Bw(n,e[t])}function Bd(n,e,t,i){let r=fe(null);try{let o=e.tView,u=n[ge]&4096?4096:16,d=W0(n,o,t,u,null,e,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null),m=n[e.index];d[lr]=m;let h=n[fi];return h!==null&&(d[fi]=h.createEmbeddedView(o)),rg(o,d,t),d}finally{fe(r)}}function Fa(n,e){return!e||e.firstChild===null||v1(n)}function Pa(n,e,t,i,r=!1){for(;t!==null;){if(t.type===128){t=r?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&i.push(Pn(o)),Yn(o)&&nC(o,i);let s=t.type;if(s&8)Pa(n,e,t.child,i);else if(s&32){let u=z0(t,e),d;for(;d=u();)i.push(d)}else if(s&16){let u=Z1(e,t);if(Array.isArray(u))i.push(...u);else{let d=ir(e[xn]);Pa(d[ae],d,u,i,!0)}}t=r?t.projectionNext:t.next}return i}function nC(n,e){for(let t=mt;t<n.length;t++){let i=n[t],r=i[ae].firstChild;r!==null&&Pa(i[ae],i,r,e)}n[ur]!==n[zn]&&e.push(n[ur])}function iC(n){if(n[Lr]!==null){for(let e of n[Lr])e.impl.addSequence(e);n[Lr].length=0}}var rC=[];function Hw(n){return n[En]??Gw(n)}function Gw(n){let e=rC.pop()??Object.create(Ww);return e.lView=n,e}function qw(n){n.lView[En]!==n&&(n.lView=null,rC.push(n))}var Ww=q(k({},Sr),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{cr(n.lView)},consumerOnSignalRead(){this.lView[En]=this}});function jw(n){let e=n[En]??Object.create(zw);return e.lView=n,e}var zw=q(k({},Sr),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=ir(n.lView);for(;e&&!oC(e[ae]);)e=ir(e);e&&Mf(e)},consumerOnSignalRead(){this.lView[En]=this}});function oC(n){return n.type!==2}function sC(n){if(n[Oi]===null)return;let e=!0;for(;e;){let t=!1;for(let i of n[Oi])i.dirty&&(t=!0,i.zone===null||Zone.current===i.zone?i.run():i.zone.run(()=>i.run()));e=t&&!!(n[ge]&8192)}}var Yw=100;function aC(n,e=0){let i=n[pi].rendererFactory,r=!1;r||i.begin?.();try{Jw(n,e)}finally{r||i.end?.()}}function Jw(n,e){let t=Lf();try{Go(!0),g0(n,e);let i=0;for(;ba(n);){if(i===Yw)throw new j(103,!1);i++,g0(n,1)}}finally{Go(t)}}function Kw(n,e,t,i){if($r(e))return;let r=e[ge],o=!1,s=!1;Qu(e);let u=!0,d=null,m=null;o||(oC(n)?(m=Hw(e),d=Dr(m)):iu()===null?(u=!1,m=jw(e),d=Dr(m)):e[En]&&(wr(e[En]),e[En]=null));try{If(e),gv(n.bindingStartIndex),t!==null&&X1(n,e,t,2,i);let h=(r&3)===3;if(!o)if(h){let C=n.preOrderCheckHooks;C!==null&&rd(e,C,null)}else{let C=n.preOrderHooks;C!==null&&od(e,C,0,null),Yf(e,0)}if(s||Qw(e),sC(e),lC(e,0),n.contentQueries!==null&&A1(n,e),!o)if(h){let C=n.contentCheckHooks;C!==null&&rd(e,C)}else{let C=n.contentHooks;C!==null&&od(e,C,1),Yf(e,1)}Xw(n,e);let y=n.components;y!==null&&dC(e,y,0);let _=n.viewQuery;if(_!==null&&d0(2,_,i),!o)if(h){let C=n.viewCheckHooks;C!==null&&rd(e,C)}else{let C=n.viewHooks;C!==null&&od(e,C,2),Yf(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Gu]){for(let C of e[Gu])C();e[Gu]=null}o||(iC(e),e[ge]&=-73)}catch(h){throw o||cr(e),h}finally{m!==null&&(Eo(m,d),u&&qw(m)),Zu()}}function lC(n,e){for(let t=x1(n);t!==null;t=E1(t))for(let i=mt;i<t.length;i++){let r=t[i];uC(r,e)}}function Qw(n){for(let e=x1(n);e!==null;e=E1(e)){if(!(e[ge]&2))continue;let t=e[Ur];for(let i=0;i<t.length;i++){let r=t[i];Mf(r)}}}function Zw(n,e,t){ze(18);let i=kn(e,n);uC(i,t),ze(19,i[ht])}function uC(n,e){Wu(n)&&g0(n,e)}function g0(n,e){let i=n[ae],r=n[ge],o=n[En],s=!!(e===0&&r&16);if(s||=!!(r&64&&e===0),s||=!!(r&1024),s||=!!(o?.dirty&&bo(o)),s||=!1,o&&(o.dirty=!1),n[ge]&=-9217,s)Kw(i,n,i.template,n[ht]);else if(r&8192){let u=fe(null);try{sC(n),lC(n,1);let d=i.components;d!==null&&dC(n,d,1),iC(n)}finally{fe(u)}}}function dC(n,e,t){for(let i=0;i<e.length;i++)Zw(n,e[i],t)}function Xw(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let i=0;i<t.length;i++){let r=t[i];if(r<0)pr(~r);else{let o=r,s=t[++i],u=t[++i];yv(s,o);let d=e[o];ze(24,d),u(2,d),ze(25,d)}}}finally{pr(-1)}}function og(n,e){let t=Lf()?64:1088;for(n[pi].changeDetectionScheduler?.notify(e);n;){n[ge]|=t;let i=ir(n);if($o(n)&&!i)return n;n=i}return null}function cC(n,e,t,i){return[n,!0,0,e,null,i,null,t,null,null]}function mC(n,e){let t=mt+e;if(t<n.length)return n[t]}function Ud(n,e,t,i=!0){let r=e[ae];if(eT(r,e,n,t),i){let s=f0(t,n),u=e[Je],d=u.parentNode(n[ur]);d!==null&&fw(r,n[Fn],u,e,d,s)}let o=e[Oo];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function pC(n,e){let t=ka(n,e);return t!==void 0&&Vd(t[ae],t),t}function ka(n,e){if(n.length<=mt)return;let t=mt+e,i=n[t];if(i){let r=i[lr];r!==null&&r!==n&&Q0(r,i),e>0&&(n[t-1][Rn]=i[Rn]);let o=ya(n,mt+e);pw(i[ae],i);let s=o[fi];s!==null&&s.detachView(o[ae]),i[Mt]=null,i[Rn]=null,i[ge]&=-129}return i}function eT(n,e,t,i){let r=mt+i,o=t.length;i>0&&(t[r-1][Rn]=e),i<o-mt?(e[Rn]=t[r],pf(t,mt+i,e)):(t.push(e),e[Rn]=null),e[Mt]=t;let s=e[lr];s!==null&&t!==s&&fC(s,e);let u=e[fi];u!==null&&u.insertView(n),ju(e),e[ge]|=128}function fC(n,e){let t=n[Ur],i=e[Mt];if(gi(i))n[ge]|=2;else{let r=i[Mt][xn];e[xn]!==r&&(n[ge]|=2)}t===null?n[Ur]=[e]:t.push(e)}var fr=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,t=e[ae];return Pa(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t}get context(){return this._lView[ht]}set context(e){this._lView[ht]=e}get destroyed(){return $r(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Mt];if(Yn(e)){let t=e[xa],i=t?t.indexOf(this):-1;i>-1&&(ka(e,i),ya(t,i))}this._attachedToViewContainer=!1}Vd(this._lView[ae],this._lView)}onDestroy(e){Af(this._lView,e)}markForCheck(){og(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[ge]&=-129}reattach(){ju(this._lView),this._lView[ge]|=128}detectChanges(){this._lView[ge]|=1024,aC(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new j(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=$o(this._lView),t=this._lView[lr];t!==null&&!e&&Q0(t,this._lView),Q1(this._lView[ae],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new j(902,!1);this._appRef=e;let t=$o(this._lView),i=this._lView[lr];i!==null&&!t&&fC(i,this._lView),ju(this._lView)}};var gr=(()=>{class n{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=tT;constructor(t,i,r){this._declarationLView=t,this._declarationTContainer=i,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,i){return this.createEmbeddedViewImpl(t,i)}createEmbeddedViewImpl(t,i,r){let o=Bd(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:i,dehydratedView:r});return new fr(o)}}return n})();function tT(){return sg(St(),ce())}function sg(n,e){return n.type&4?new gr(e,n,Zo(n,e)):null}function qa(n,e,t,i,r){let o=n.data[e];if(o===null)o=nT(n,e,t,i,r),hv()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=i,o.attrs=r;let s=mv();o.injectorIndex=s===null?-1:s.injectorIndex}return Ho(o,!0),o}function nT(n,e,t,i,r){let o=Vf(),s=Of(),u=s?o:o&&o.parent,d=n.data[e]=rT(n,u,t,e,i,r);return iT(n,d,o,s),d}function iT(n,e,t,i){n.firstChild===null&&(n.firstChild=e),t!==null&&(i?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function rT(n,e,t,i,r,o){let s=e?e.injectorIndex:-1,u=0;return cv()&&(u|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:u,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var hJ=new RegExp(`^(\\d+)*(${SD}|${bD})*(.*)`);function oT(n){let e=n[bf]??[],i=n[Mt][Je],r=[];for(let o of e)o.data[w1]!==void 0?r.push(o):sT(o,i);n[bf]=r}function sT(n,e){let t=0,i=n.firstChild;if(i){let r=n.data[D1];for(;t<r;){let o=i.nextSibling;k1(e,i,!1),i=o,t++}}}var aT=()=>null,lT=()=>null;function h0(n,e){return aT(n,e)}function gC(n,e,t){return lT(n,e,t)}var hC=class{},$d=class{},y0=class{resolveComponentFactory(e){throw new j(917,!1)}},Wa=class{static NULL=new y0},zr=class{},Xn=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>uT()}return n})();function uT(){let n=ce(),e=St(),t=kn(e.index,n);return(gi(t)?t:n)[Je]}var yC=(()=>{class n{static \u0275prov=J({token:n,providedIn:"root",factory:()=>null})}return n})();var ad={},_0=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){let r=this.injector.get(e,ad,i);return r!==ad||t===ad?r:this.parentInjector.get(e,t,i)}};function vd(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let u=e[s];if(typeof u=="number")o=u;else if(o==1)r=Ou(r,u);else if(o==2){let d=u,m=e[++s];i=Ou(i,d+": "+m+";")}}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function K(n,e=0){let t=ce();if(t===null)return oe(n,e);let i=St();return h1(i,t,Ut(n),e)}function _C(n,e,t,i,r){let o=i===null?null:{"":-1},s=r(n,t);if(s!==null){let u=s,d=null,m=null;for(let h of s)if(h.resolveHostDirectives!==null){[u,d,m]=h.resolveHostDirectives(s);break}mT(n,e,t,u,o,d,m)}o!==null&&i!==null&&dT(t,i,o)}function dT(n,e,t){let i=n.localNames=[];for(let r=0;r<e.length;r+=2){let o=t[e[r+1]];if(o==null)throw new j(-301,!1);i.push(e[r],o)}}function cT(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function mT(n,e,t,i,r,o,s){let u=i.length,d=!1;for(let _=0;_<u;_++){let C=i[_];!d&&hi(C)&&(d=!0,cT(n,t,_)),s0(pd(t,e),n,C.type)}_T(t,n.data.length,u);for(let _=0;_<u;_++){let C=i[_];C.providersResolver&&C.providersResolver(C)}let m=!1,h=!1,y=H1(n,e,u,null);u>0&&(t.directiveToIndex=new Map);for(let _=0;_<u;_++){let C=i[_];if(t.mergedAttrs=Yo(t.mergedAttrs,C.hostAttrs),fT(n,t,e,y,C),yT(y,C,r),s!==null&&s.has(C)){let[I,R]=s.get(C);t.directiveToIndex.set(C.type,[y,I+t.directiveStart,R+t.directiveStart])}else(o===null||!o.has(C))&&t.directiveToIndex.set(C.type,y);C.contentQueries!==null&&(t.flags|=4),(C.hostBindings!==null||C.hostAttrs!==null||C.hostVars!==0)&&(t.flags|=64);let D=C.type.prototype;!m&&(D.ngOnChanges||D.ngOnInit||D.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),m=!0),!h&&(D.ngOnChanges||D.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),h=!0),y++}pT(n,t,o)}function pT(n,e,t){for(let i=e.directiveStart;i<e.directiveEnd;i++){let r=n.data[i];if(t===null||!t.has(r))Gv(0,e,r,i),Gv(1,e,r,i),Wv(e,i,!1);else{let o=t.get(r);qv(0,e,o,i),qv(1,e,o,i),Wv(e,i,!0)}}}function Gv(n,e,t,i){let r=n===0?t.inputs:t.outputs;for(let o in r)if(r.hasOwnProperty(o)){let s;n===0?s=e.inputs??={}:s=e.outputs??={},s[o]??=[],s[o].push(i),vC(e,o)}}function qv(n,e,t,i){let r=n===0?t.inputs:t.outputs;for(let o in r)if(r.hasOwnProperty(o)){let s=r[o],u;n===0?u=e.hostDirectiveInputs??={}:u=e.hostDirectiveOutputs??={},u[s]??=[],u[s].push(i,o),vC(e,s)}}function vC(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function Wv(n,e,t){let{attrs:i,inputs:r,hostDirectiveInputs:o}=n;if(i===null||!t&&r===null||t&&o===null||G0(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let s=null,u=0;for(;u<i.length;){let d=i[u];if(d===0){u+=4;continue}else if(d===5){u+=2;continue}else if(typeof d=="number")break;if(!t&&r.hasOwnProperty(d)){let m=r[d];for(let h of m)if(h===e){s??=[],s.push(d,i[u+1]);break}}else if(t&&o.hasOwnProperty(d)){let m=o[d];for(let h=0;h<m.length;h+=2)if(m[h]===e){s??=[],s.push(m[h+1],i[u+1]);break}}u+=2}n.initialInputs??=[],n.initialInputs.push(s)}function fT(n,e,t,i,r){n.data[i]=r;let o=r.factory||(r.factory=nr(r.type,!0)),s=new Wr(o,hi(r),K,null);n.blueprint[i]=s,t[i]=s,gT(n,e,i,H1(n,t,r.hostVars,Ht),r)}function gT(n,e,t,i,r){let o=r.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let u=~e.index;hT(s)!=u&&s.push(u),s.push(t,i,o)}}function hT(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function yT(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;hi(e)&&(t[""]=n)}}function _T(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function ag(n,e,t,i,r,o,s,u){let d=e[ae],m=d.consts,h=Vn(m,s),y=qa(d,n,t,i,h);return o&&_C(d,e,y,Vn(m,u),r),y.mergedAttrs=Yo(y.mergedAttrs,y.attrs),y.attrs!==null&&vd(y,y.attrs,!1),y.mergedAttrs!==null&&vd(y,y.mergedAttrs,!0),d.queries!==null&&d.queries.elementStart(d,y),y}function lg(n,e){a1(n,e),Sf(e)&&n.queries.elementEnd(e)}function vT(n,e,t,i,r,o){let s=e.consts,u=Vn(s,r),d=qa(e,n,t,i,u);if(d.mergedAttrs=Yo(d.mergedAttrs,d.attrs),o!=null){let m=Vn(s,o);d.localNames=[];for(let h=0;h<m.length;h+=2)d.localNames.push(m[h],-1)}return d.attrs!==null&&vd(d,d.attrs,!1),d.mergedAttrs!==null&&vd(d,d.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,d),d}function ug(n){return xC(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function CC(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),i;for(;!(i=t.next()).done;)e(i.value)}}function xC(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function dg(n,e,t){return n[e]=t}function CT(n,e){return n[e]}function Ln(n,e,t){if(t===Ht)return!1;let i=n[e];return Object.is(i,t)?!1:(n[e]=t,!0)}function Va(n,e,t,i){let r=Ln(n,e,t);return Ln(n,e+1,i)||r}function xT(n,e,t,i,r){let o=Va(n,e,t,i);return Ln(n,e+2,r)||o}function ET(n,e,t,i,r,o){let s=Va(n,e,t,i);return Va(n,e+2,r,o)||s}function ld(n,e,t){return function i(r){let o=dr(n)?kn(n.index,e):e;og(o,5);let s=e[ht],u=jv(e,s,t,r),d=i.__ngNextListenerFn__;for(;d;)u=jv(e,s,d,r)&&u,d=d.__ngNextListenerFn__;return u}}function jv(n,e,t,i){let r=fe(null);try{return ze(6,e,t),t(i)!==!1}catch(o){return Lw(n,o),!1}finally{ze(7,e,t),fe(r)}}function EC(n,e,t,i,r,o,s,u){let d=Uo(n),m=!1,h=null;if(!i&&d&&(h=ST(e,t,o,n.index)),h!==null){let y=h.__ngLastListenerFn__||h;y.__ngNextListenerFn__=s,h.__ngLastListenerFn__=s,m=!0}else{let y=Jn(n,t),_=i?i(y):y;wD(t,_,o,u);let C=r.listen(_,o,u);if(!bT(o)){let D=i?I=>i(Pn(I[n.index])):n.index;bC(D,e,t,o,u,C,!1)}}return m}function bT(n){return n.startsWith("animation")||n.startsWith("transition")}function ST(n,e,t,i){let r=n.cleanup;if(r!=null)for(let o=0;o<r.length-1;o+=2){let s=r[o];if(s===t&&r[o+1]===i){let u=e[Lo],d=r[o+2];return u&&u.length>d?u[d]:null}typeof s=="string"&&(o+=2)}return null}function bC(n,e,t,i,r,o,s){let u=e.firstCreatePass?Rf(e):null,d=Nf(t),m=d.length;d.push(r,o),u&&u.push(i,n,m,(m+1)*(s?-1:1))}function zv(n,e,t,i,r,o){let s=e[t],u=e[ae],m=u.data[t].outputs[i],y=s[m].subscribe(o);bC(n.index,u,e,r,o,y,!0)}var v0=Symbol("BINDING");var Cd=class extends Wa{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=ar(e);return new Ko(t,this.ngModule)}};function DT(n){return Object.keys(n).map(e=>{let[t,i,r]=n[e],o={propName:t,templateName:e,isSignal:(i&Pd.SignalBased)!==0};return r&&(o.transform=r),o})}function wT(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function TT(n,e,t){let i=e instanceof Et?e:e?.injector;return i&&n.getStandaloneInjector!==null&&(i=n.getStandaloneInjector(i)||i),i?new _0(t,i):t}function IT(n){let e=n.get(zr,null);if(e===null)throw new j(407,!1);let t=n.get(yC,null),i=n.get(An,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:i,ngReflect:!1}}function MT(n,e){let t=SC(n);return F1(e,t,t==="svg"?Df:t==="math"?iv:null)}function SC(n){return(n.selectors[0][0]||"div").toLowerCase()}var Ko=class extends $d{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=DT(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=wT(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=QD(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,i,r,o,s){ze(22);let u=fe(null);try{let d=this.componentDef,m=AT(i,d,s,o),h=TT(d,r||this.ngModule,e),y=IT(h),_=y.rendererFactory.createRenderer(null,d),C=i?Tw(_,i,d.encapsulation,h):MT(d,_),D=s?.some(Yv)||o?.some(F=>typeof F!="function"&&F.bindings.some(Yv)),I=W0(null,m,null,512|$1(d),null,null,y,_,h,null,M1(C,h,!0));I[st]=C,Qu(I);let R=null;try{let F=ag(st,I,2,"#host",()=>m.directiveRegistry,!0,0);V1(_,C,F),Jo(C,I),Ld(m,I,F),U0(m,F,I),lg(m,F),t!==void 0&&RT(F,this.ngContentSelectors,t),R=kn(F.index,I),I[ht]=R[ht],rg(m,I,null)}catch(F){throw R!==null&&l0(R),l0(I),F}finally{ze(23),Zu()}return new xd(this.componentType,I,!!D)}finally{fe(u)}}};function AT(n,e,t,i){let r=n?["ng-version","20.3.16"]:ZD(e.selectors[0]),o=null,s=null,u=0;if(t)for(let h of t)u+=h[v0].requiredVars,h.create&&(h.targetIdx=0,(o??=[]).push(h)),h.update&&(h.targetIdx=0,(s??=[]).push(h));if(i)for(let h=0;h<i.length;h++){let y=i[h];if(typeof y!="function")for(let _ of y.bindings){u+=_[v0].requiredVars;let C=h+1;_.create&&(_.targetIdx=C,(o??=[]).push(_)),_.update&&(_.targetIdx=C,(s??=[]).push(_))}}let d=[e];if(i)for(let h of i){let y=typeof h=="function"?h:h.type,_=yf(y);d.push(_)}return q0(0,null,NT(o,s),1,u,d,null,null,null,[r],null)}function NT(n,e){return!n&&!e?null:t=>{if(t&1&&n)for(let i of n)i.create();if(t&2&&e)for(let i of e)i.update()}}function Yv(n){let e=n[v0].kind;return e==="input"||e==="twoWay"}var xd=class extends hC{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t,i){super(),this._rootLView=t,this._hasInputBindings=i,this._tNode=Ea(t[ae],st),this.location=Zo(this._tNode,t),this.instance=kn(this._tNode.index,t)[ht],this.hostView=this.changeDetectorRef=new fr(t,void 0),this.componentType=e}setInput(e,t){this._hasInputBindings;let i=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let r=this._rootLView,o=ig(i,r[ae],r,e,t);this.previousInputValues.set(e,t);let s=kn(i.index,r);og(s,1)}get injector(){return new qr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function RT(n,e,t){let i=n.projection=[];for(let r=0;r<e.length;r++){let o=t[r];i.push(o!=null&&o.length?Array.from(o):null)}}var Hi=(()=>{class n{static __NG_ELEMENT_ID__=FT}return n})();function FT(){let n=St();return wC(n,ce())}var PT=Hi,DC=class extends PT{_lContainer;_hostTNode;_hostLView;constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Zo(this._hostTNode,this._hostLView)}get injector(){return new qr(this._hostTNode,this._hostLView)}get parentInjector(){let e=V0(this._hostTNode,this._hostLView);if(d1(e)){let t=cd(e,this._hostLView),i=dd(e),r=t[ae].data[i+8];return new qr(r,t)}else return new qr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=Jv(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-mt}createEmbeddedView(e,t,i){let r,o;typeof i=="number"?r=i:i!=null&&(r=i.index,o=i.injector);let s=h0(this._lContainer,e.ssrId),u=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(u,r,Fa(this._hostTNode,s)),u}createComponent(e,t,i,r,o,s,u){let d=e&&!QS(e),m;if(d)m=t;else{let R=t||{};m=R.index,i=R.injector,r=R.projectableNodes,o=R.environmentInjector||R.ngModuleRef,s=R.directives,u=R.bindings}let h=d?e:new Ko(ar(e)),y=i||this.parentInjector;if(!o&&h.ngModule==null){let F=(d?y:this.parentInjector).get(Et,null);F&&(o=F)}let _=ar(h.componentType??{}),C=h0(this._lContainer,_?.id??null),D=C?.firstChild??null,I=h.create(y,r,D,o,s,u);return this.insertImpl(I.hostView,m,Fa(this._hostTNode,C)),I}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){let r=e._lView;if(ov(r)){let u=this.indexOf(e);if(u!==-1)this.detach(u);else{let d=r[Mt],m=new DC(d,d[Fn],d[Mt]);m.detach(m.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return Ud(s,r,o,i),e.attachToViewContainerRef(),pf(Qf(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=Jv(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),i=ka(this._lContainer,t);i&&(ya(Qf(this._lContainer),t),Vd(i[ae],i))}detach(e){let t=this._adjustIndex(e,-1),i=ka(this._lContainer,t);return i&&ya(Qf(this._lContainer),t)!=null?new fr(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function Jv(n){return n[xa]}function Qf(n){return n[xa]||(n[xa]=[])}function wC(n,e){let t,i=e[n.index];return Yn(i)?t=i:(t=cC(i,e,null,n),e[n.index]=t,j0(e,t)),VT(t,e,n,i),new DC(t,n,e)}function kT(n,e){let t=n[Je],i=t.createComment(""),r=Jn(e,n),o=t.parentNode(r);return hd(t,o,i,t.nextSibling(r),!1),i}var VT=BT,OT=()=>!1;function LT(n,e,t){return OT(n,e,t)}function BT(n,e,t,i){if(n[ur])return;let r;t.type&8?r=Pn(i):r=kT(e,t),n[ur]=r}var C0=class n{queryList;matches=null;constructor(e){this.queryList=e}clone(){return new n(this.queryList)}setDirty(){this.queryList.setDirty()}},x0=class n{queries;constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let i=e.contentQueries!==null?e.contentQueries[0]:t.length,r=[];for(let o=0;o<i;o++){let s=t.getByIndex(o),u=this.queries[s.indexInDeclarationView];r.push(u.clone())}return new n(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)cg(e,t).matches!==null&&this.queries[t].setDirty()}},Ed=class{flags;read;predicate;constructor(e,t,i=null){this.flags=t,this.read=i,typeof e=="string"?this.predicate=zT(e):this.predicate=e}},E0=class n{queries;constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){let r=t!==null?t.length:0,o=this.getByIndex(i).embeddedTView(e,r);o&&(o.indexInDeclarationView=i,t!==null?t.push(o):t=[o])}return t!==null?new n(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},b0=class n{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(e,t=-1){this.metadata=e,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new n(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,i=e.parent;for(;i!==null&&i.type&8&&i.index!==t;)i=i.parent;return t===(i!==null?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){let o=i[r];this.matchTNodeWithReadOption(e,t,UT(t,o)),this.matchTNodeWithReadOption(e,t,sd(t,e,o,!1,!1))}else i===gr?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,sd(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(i!==null){let r=this.metadata.read;if(r!==null)if(r===nn||r===Hi||r===gr&&t.type&4)this.addMatch(t.index,-2);else{let o=sd(t,e,r,!1,!1);o!==null&&this.addMatch(t.index,o)}else this.addMatch(t.index,i)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function UT(n,e){let t=n.localNames;if(t!==null){for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1]}return null}function $T(n,e){return n.type&11?Zo(n,e):n.type&4?sg(n,e):null}function HT(n,e,t,i){return t===-1?$T(e,n):t===-2?GT(n,e,i):Na(n,n[ae],t,e)}function GT(n,e,t){if(t===nn)return Zo(e,n);if(t===gr)return sg(e,n);if(t===Hi)return wC(e,n)}function TC(n,e,t,i){let r=e[fi].queries[i];if(r.matches===null){let o=n.data,s=t.matches,u=[];for(let d=0;s!==null&&d<s.length;d+=2){let m=s[d];if(m<0)u.push(null);else{let h=o[m];u.push(HT(e,h,s[d+1],t.metadata.read))}}r.matches=u}return r.matches}function S0(n,e,t,i){let r=n.queries.getByIndex(t),o=r.matches;if(o!==null){let s=TC(n,e,r,t);for(let u=0;u<o.length;u+=2){let d=o[u];if(d>0)i.push(s[u/2]);else{let m=o[u+1],h=e[-d];for(let y=mt;y<h.length;y++){let _=h[y];_[lr]===_[Mt]&&S0(_[ae],_,m,i)}if(h[Ur]!==null){let y=h[Ur];for(let _=0;_<y.length;_++){let C=y[_];S0(C[ae],C,m,i)}}}}}return i}function qT(n,e){return n[fi].queries[e].queryList}function IC(n,e,t){let i=new fd((t&4)===4);return lv(n,e,i,i.destroy),(e[fi]??=new x0).queries.push(new C0(i))-1}function WT(n,e,t){let i=tt();return i.firstCreatePass&&(MC(i,new Ed(n,e,t),-1),(e&2)===2&&(i.staticViewQueries=!0)),IC(i,ce(),e)}function jT(n,e,t,i){let r=tt();if(r.firstCreatePass){let o=St();MC(r,new Ed(e,t,i),o.index),YT(r,n),(t&2)===2&&(r.staticContentQueries=!0)}return IC(r,ce(),t)}function zT(n){return n.split(",").map(e=>e.trim())}function MC(n,e,t){n.queries===null&&(n.queries=new E0),n.queries.track(new b0(e,t))}function YT(n,e){let t=n.contentQueries||(n.contentQueries=[]),i=t.length?t[t.length-1]:-1;e!==i&&t.push(n.queries.length-1,e)}function cg(n,e){return n.queries.getByIndex(e)}function JT(n,e){let t=n[ae],i=cg(t,e);return i.crossesNgTemplate?S0(t,n,e,[]):TC(t,n,i,e)}var Yr=class{},Hd=class{};var bd=class extends Yr{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new Cd(this);constructor(e,t,i,r=!0){super(),this.ngModuleType=e,this._parent=t;let o=hf(e);this._bootstrapComponents=B1(o.bootstrap),this._r3Injector=Gf(e,t,[{provide:Yr,useValue:this},{provide:Wa,useValue:this.componentFactoryResolver},...i],Pi(e),new Set(["environment"])),r&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Sd=class extends Hd{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new bd(this.moduleType,e,[])}};var Oa=class extends Yr{injector;componentFactoryResolver=new Cd(this);instance=null;constructor(e){super();let t=new Fr([...e.providers,{provide:Yr,useValue:this},{provide:Wa,useValue:this.componentFactoryResolver}],e.parent||va(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function ja(n,e,t=null){return new Oa({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var KT=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let i=_f(!1,t.type),r=i.length>0?ja([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=J({token:n,providedIn:"environment",factory:()=>new n(oe(Et))})}return n})();function ie(n){return Ba(()=>{let e=AC(n),t=q(k({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===O0.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?r=>r.get(KT).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Bi.Emulated,styles:n.styles||en,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&Ui("NgStandalone"),NC(t);let i=n.dependencies;return t.directiveDefs=Kv(i,QT),t.pipeDefs=Kv(i,K_),t.id=eI(t),t})}function QT(n){return ar(n)||yf(n)}function ei(n){return Ba(()=>({type:n.type,bootstrap:n.bootstrap||en,declarations:n.declarations||en,imports:n.imports||en,exports:n.exports||en,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function ZT(n,e){if(n==null)return or;let t={};for(let i in n)if(n.hasOwnProperty(i)){let r=n[i],o,s,u,d;Array.isArray(r)?(u=r[0],o=r[1],s=r[2]??o,d=r[3]||null):(o=r,s=r,u=Pd.None,d=null),t[o]=[i,u,d],e[o]=s}return t}function XT(n){if(n==null)return or;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function Ne(n){return Ba(()=>{let e=AC(n);return NC(e),e})}function za(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function AC(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||or,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||en,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:ZT(n.inputs,e),outputs:XT(n.outputs),debugInfo:null}}function NC(n){n.features?.forEach(e=>e(n))}function Kv(n,e){return n?()=>{let t=typeof n=="function"?n():n,i=[];for(let r of t){let o=e(r);o!==null&&i.push(o)}return i}:null}function eI(n){let e=0,t=typeof n.consts=="function"?"":n.consts,i=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of i.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function tI(n){return Object.getPrototypeOf(n.prototype).constructor}function pt(n){let e=tI(n.type),t=!0,i=[n];for(;e;){let r;if(hi(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new j(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);let s=n;s.inputs=Zf(n.inputs),s.declaredInputs=Zf(n.declaredInputs),s.outputs=Zf(n.outputs);let u=r.hostBindings;u&&sI(n,u);let d=r.viewQuery,m=r.contentQueries;if(d&&rI(n,d),m&&oI(n,m),nI(n,r),H_(n.outputs,r.outputs),hi(r)&&r.data.animation){let h=n.data;h.animation=(h.animation||[]).concat(r.data.animation)}}let o=r.features;if(o)for(let s=0;s<o.length;s++){let u=o[s];u&&u.ngInherit&&u(n),u===pt&&(t=!1)}}e=Object.getPrototypeOf(e)}iI(i)}function nI(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let i=e.inputs[t];i!==void 0&&(n.inputs[t]=i,n.declaredInputs[t]=e.declaredInputs[t])}}function iI(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){let r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Yo(r.hostAttrs,t=Yo(t,r.hostAttrs))}}function Zf(n){return n===or?{}:n===en?[]:n}function rI(n,e){let t=n.viewQuery;t?n.viewQuery=(i,r)=>{e(i,r),t(i,r)}:n.viewQuery=e}function oI(n,e){let t=n.contentQueries;t?n.contentQueries=(i,r,o)=>{e(i,r,o),t(i,r,o)}:n.contentQueries=e}function sI(n,e){let t=n.hostBindings;t?n.hostBindings=(i,r)=>{e(i,r),t(i,r)}:n.hostBindings=e}function RC(n,e,t,i,r,o,s,u){if(t.firstCreatePass){n.mergedAttrs=Yo(n.mergedAttrs,n.attrs);let h=n.tView=q0(2,n,r,o,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,t.consts,null);t.queries!==null&&(t.queries.template(t,n),h.queries=t.queries.embeddedTView(n))}u&&(n.flags|=u),Ho(n,!1);let d=lI(t,e,n,i);Xu()&&Z0(t,e,d,n),Jo(d,e);let m=cC(d,e,d,n);e[i+st]=m,j0(e,m),LT(m,n,e)}function aI(n,e,t,i,r,o,s,u,d,m,h){let y=t+st,_;return e.firstCreatePass?(_=qa(e,y,4,s||null,u||null),zu()&&_C(e,n,_,Vn(e.consts,m),eg),a1(e,_)):_=e.data[y],RC(_,n,e,t,i,r,o,d),Uo(_)&&Ld(e,n,_),m!=null&&Ga(n,_,h),_}function Dd(n,e,t,i,r,o,s,u,d,m,h){let y=t+st,_;if(e.firstCreatePass){if(_=qa(e,y,4,s||null,u||null),m!=null){let C=Vn(e.consts,m);_.localNames=[];for(let D=0;D<C.length;D+=2)_.localNames.push(C[D],-1)}}else _=e.data[y];return RC(_,n,e,t,i,r,o,d),m!=null&&Ga(n,_,h),_}function Pt(n,e,t,i,r,o,s,u){let d=ce(),m=tt(),h=Vn(m.consts,o);return aI(d,m,n,e,t,i,r,h,void 0,s,u),Pt}var lI=uI;function uI(n,e,t,i){return wa(!0),e[Je].createComment("")}var mg=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var pg=new te("");function hr(n){return!!n&&typeof n.then=="function"}function fg(n){return!!n&&typeof n.subscribe=="function"}var FC=new te("");var gg=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i});appInits=P(FC,{optional:!0})??[];injector=P(Jt);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let r of this.appInits){let o=At(this.injector,r);if(hr(o))t.push(o);else if(fg(o)){let s=new Promise((u,d)=>{o.subscribe({complete:u,error:d})});t.push(s)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),t.length===0&&i(),this.initialized=!0}static \u0275fac=function(i){return new(i||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Gd=new te("");function PC(){Ap(()=>{let n="";throw new j(600,n)})}function kC(n){return n.isBoundToModule}var dI=10;var Gi=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=P(fn);afterRenderManager=P(K0);zonelessEnabled=P(Ta);rootEffectScheduler=P(Ia);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new gt;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=P(yi);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(he(t=>!t))}constructor(){P(Kr,{optional:!0})}whenStable(){let t;return new Promise(i=>{t=this.isStable.subscribe({next:r=>{r&&i()}})}).finally(()=>{t.unsubscribe()})}_injector=P(Et);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,i){return this.bootstrapImpl(t,i)}bootstrapImpl(t,i,r=Jt.NULL){return this._injector.get(yt).run(()=>{ze(10);let s=t instanceof $d;if(!this._injector.get(gg).done){let D="";throw new j(405,D)}let d;s?d=t:d=this._injector.get(Wa).resolveComponentFactory(t),this.componentTypes.push(d.componentType);let m=kC(d)?void 0:this._injector.get(Yr),h=i||d.selector,y=d.create(r,[],h,m),_=y.location.nativeElement,C=y.injector.get(pg,null);return C?.registerApplication(_),y.onDestroy(()=>{this.detachView(y.hostView),Aa(this.components,y),C?.unregisterApplication(_)}),this._loadComponent(y),ze(11,y),y})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){ze(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(kd.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new j(101,!1);let t=fe(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,fe(t),this.afterTick.next(),ze(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(zr,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<dI;)ze(14),this.synchronizeOnce(),ze(15)}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let i=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r}of this.allViews){if(!i&&!ba(r))continue;let o=i&&!this.zonelessEnabled?0:1;aC(r,o),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>ba(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){let i=t;Aa(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(r){this.internalErrorHandler(r)}this.components.push(t),this._injector.get(Gd,[]).forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Aa(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new j(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(i){return new(i||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Aa(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function ft(n,e,t,i){let r=ce(),o=mr();if(Ln(r,o,e)){let s=tt(),u=Da();kw(u,r,n,e,t,i)}return ft}var bJ=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";var D0=class{destroy(e){}updateValue(e,t){}swap(e,t){let i=Math.min(e,t),r=Math.max(e,t),o=this.detach(r);if(r-i>1){let s=this.detach(i);this.attach(i,o),this.attach(r,s)}else this.attach(i,o)}move(e,t){this.attach(t,this.detach(e))}};function Xf(n,e,t,i,r){return n===t&&Object.is(e,i)?1:Object.is(r(n,e),r(t,i))?-1:0}function cI(n,e,t){let i,r,o=0,s=n.length-1,u=void 0;if(Array.isArray(e)){let d=e.length-1;for(;o<=s&&o<=d;){let m=n.at(o),h=e[o],y=Xf(o,m,o,h,t);if(y!==0){y<0&&n.updateValue(o,h),o++;continue}let _=n.at(s),C=e[d],D=Xf(s,_,d,C,t);if(D!==0){D<0&&n.updateValue(s,C),s--,d--;continue}let I=t(o,m),R=t(s,_),F=t(o,h);if(Object.is(F,R)){let $=t(d,C);Object.is($,I)?(n.swap(o,s),n.updateValue(s,C),d--,s--):n.move(s,o),n.updateValue(o,h),o++;continue}if(i??=new wd,r??=Zv(n,o,s,t),w0(n,i,o,F))n.updateValue(o,h),o++,s++;else if(r.has(F))i.set(I,n.detach(o)),s--;else{let $=n.create(o,e[o]);n.attach(o,$),o++,s++}}for(;o<=d;)Qv(n,i,t,o,e[o]),o++}else if(e!=null){let d=e[Symbol.iterator](),m=d.next();for(;!m.done&&o<=s;){let h=n.at(o),y=m.value,_=Xf(o,h,o,y,t);if(_!==0)_<0&&n.updateValue(o,y),o++,m=d.next();else{i??=new wd,r??=Zv(n,o,s,t);let C=t(o,y);if(w0(n,i,o,C))n.updateValue(o,y),o++,s++,m=d.next();else if(!r.has(C))n.attach(o,n.create(o,y)),o++,s++,m=d.next();else{let D=t(o,h);i.set(D,n.detach(o)),s--}}}for(;!m.done;)Qv(n,i,t,n.length,m.value),m=d.next()}for(;o<=s;)n.destroy(n.detach(s--));i?.forEach(d=>{n.destroy(d)})}function w0(n,e,t,i){return e!==void 0&&e.has(i)?(n.attach(t,e.get(i)),e.delete(i),!0):!1}function Qv(n,e,t,i,r){if(w0(n,e,i,t(i,r)))n.updateValue(i,r);else{let o=n.create(i,r);n.attach(i,o)}}function Zv(n,e,t,i){let r=new Set;for(let o=e;o<=t;o++)r.add(i(o,n.at(o)));return r}var wd=class{kvMap=new Map;_vMap=void 0;has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let t=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let i=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let r=this._vMap;for(;r.has(i);)i=r.get(i);r.set(i,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,i]of this.kvMap)if(e(i,t),this._vMap!==void 0){let r=this._vMap;for(;r.has(i);)i=r.get(i),e(i,t)}}};function A(n,e,t,i,r,o,s,u){Ui("NgControlFlow");let d=ce(),m=tt(),h=Vn(m.consts,o);return Dd(d,m,n,e,t,i,r,h,256,s,u),hg}function hg(n,e,t,i,r,o,s,u){Ui("NgControlFlow");let d=ce(),m=tt(),h=Vn(m.consts,o);return Dd(d,m,n,e,t,i,r,h,512,s,u),hg}function N(n,e){Ui("NgControlFlow");let t=ce(),i=mr(),r=t[i]!==Ht?t[i]:-1,o=r!==-1?Td(t,st+r):void 0,s=0;if(Ln(t,i,n)){let u=fe(null);try{if(o!==void 0&&pC(o,s),n!==-1){let d=st+n,m=Td(t,d),h=A0(t[ae],d),y=gC(m,h,t),_=Bd(t,h,e,{dehydratedView:y});Ud(m,_,s,Fa(h,y))}}finally{fe(u)}}else if(o!==void 0){let u=mC(o,s);u!==void 0&&(u[ht]=e)}}var T0=class{lContainer;$implicit;$index;constructor(e,t,i){this.lContainer=e,this.$implicit=t,this.$index=i}get $count(){return this.lContainer.length-mt}};function bn(n){return n}function W(n,e){return e}var I0=class{hasEmptyBlock;trackByFn;liveCollection;constructor(e,t,i){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=i}};function O(n,e,t,i,r,o,s,u,d,m,h,y,_){Ui("NgControlFlow");let C=ce(),D=tt(),I=d!==void 0,R=ce(),F=u?s.bind(R[xn][ht]):s,$=new I0(I,F);R[st+n]=$,Dd(C,D,n+1,e,t,i,r,Vn(D.consts,o),256),I&&Dd(C,D,n+2,d,m,h,y,Vn(D.consts,_),512)}var M0=class extends D0{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(e,t,i){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=i}get length(){return this.lContainer.length-mt}at(e){return this.getLView(e)[ht].$implicit}attach(e,t){let i=t[Oo];this.needsIndexUpdate||=e!==this.length,Ud(this.lContainer,t,e,Fa(this.templateTNode,i)),mI(this.lContainer,e)}detach(e){return this.needsIndexUpdate||=e!==this.length-1,pI(this.lContainer,e),fI(this.lContainer,e)}create(e,t){let i=h0(this.lContainer,this.templateTNode.tView.ssrId),r=Bd(this.hostLView,this.templateTNode,new T0(this.lContainer,t,e),{dehydratedView:i});return this.operationsCounter?.recordCreate(),r}destroy(e){Vd(e[ae],e),this.operationsCounter?.recordDestroy()}updateValue(e,t){this.getLView(e)[ht].$implicit=t}reset(){this.needsIndexUpdate=!1,this.operationsCounter?.reset()}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[ht].$index=e}getLView(e){return gI(this.lContainer,e)}};function L(n){let e=fe(null),t=Kn();try{let i=ce(),r=i[ae],o=i[t],s=t+1,u=Td(i,s);if(o.liveCollection===void 0){let m=A0(r,s);o.liveCollection=new M0(u,i,m)}else o.liveCollection.reset();let d=o.liveCollection;if(cI(d,n,o.trackByFn),d.updateIndexes(),o.hasEmptyBlock){let m=mr(),h=d.length===0;if(Ln(i,m,h)){let y=t+2,_=Td(i,y);if(h){let C=A0(r,y),D=gC(_,C,i),I=Bd(i,C,void 0,{dehydratedView:D});Ud(_,I,0,Fa(C,D))}else r.firstUpdatePass&&oT(_),pC(_,0)}}}finally{fe(e)}}function Td(n,e){return n[e]}function mI(n,e){if(n.length<=mt)return;let t=mt+e,i=n[t],r=i?i[Br]:void 0;if(i&&r&&r.detachedLeaveAnimationFns&&r.detachedLeaveAnimationFns.length>0){let o=i[Vi];cw(o,r),jr.delete(i),r.detachedLeaveAnimationFns=void 0}}function pI(n,e){if(n.length<=mt)return;let t=mt+e,i=n[t],r=i?i[Br]:void 0;r&&r.leave&&r.leave.size>0&&(r.detachedLeaveAnimationFns=[])}function fI(n,e){return ka(n,e)}function gI(n,e){return mC(n,e)}function A0(n,e){return Ea(n,e)}function M(n,e,t){let i=ce(),r=mr();if(Ln(i,r,e)){let o=tt(),s=Da();eC(s,i,n,e,i[Je],t)}return M}function N0(n,e,t,i,r){ig(e,n,t,r?"class":"style",i)}function l(n,e,t,i){let r=ce(),o=r[ae],s=n+st,u=o.firstCreatePass?ag(s,r,2,e,eg,zu(),t,i):o.data[s];if(tg(u,r,n,e,VC),Uo(u)){let d=r[ae];Ld(d,r,u),U0(d,u,r)}return i!=null&&Ga(r,u),l}function a(){let n=tt(),e=St(),t=ng(e);return n.firstCreatePass&&lg(n,t),Pf(t)&&kf(),Ff(),t.classesWithoutHost!=null&&iD(t)&&N0(n,t,ce(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&rD(t)&&N0(n,t,ce(),t.stylesWithoutHost,!1),a}function x(n,e,t,i){return l(n,e,t,i),a(),x}function Xe(n,e,t,i){let r=ce(),o=r[ae],s=n+st,u=o.firstCreatePass?vT(s,o,2,e,t,i):o.data[s];return tg(u,r,n,e,VC),i!=null&&Ga(r,u),Xe}function et(){let n=St(),e=ng(n);return Pf(e)&&kf(),Ff(),et}function qi(n,e,t,i){return Xe(n,e,t,i),et(),qi}var VC=(n,e,t,i,r)=>(wa(!0),F1(e[Je],i,Sv()));function qd(n,e,t){let i=ce(),r=i[ae],o=n+st,s=r.firstCreatePass?ag(o,i,8,"ng-container",eg,zu(),e,t):r.data[o];if(tg(s,i,n,"ng-container",hI),Uo(s)){let u=i[ae];Ld(u,i,s),U0(u,s,i)}return t!=null&&Ga(i,s),qd}function Wd(){let n=tt(),e=St(),t=ng(e);return n.firstCreatePass&&lg(n,t),Wd}var hI=(n,e,t,i,r)=>(wa(!0),VD(e[Je],""));function B(){return ce()}function jd(n,e,t){let i=ce(),r=mr();if(Ln(i,r,e)){let o=tt(),s=Da();tC(s,i,n,e,i[Je],t)}return jd}var nd=void 0;function yI(n){let e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return e===1&&t===0?1:5}var _I=["en",[["a","p"],["AM","PM"]],[["AM","PM"]],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],nd,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],nd,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",nd,"{1} 'at' {0}",nd],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",yI],e0={};function rn(n){let e=vI(n),t=Xv(e);if(t)return t;let i=e.split("-")[0];if(t=Xv(i),t)return t;if(i==="en")return _I;throw new j(701,!1)}function Xv(n){return n in e0||(e0[n]=ki.ng&&ki.ng.common&&ki.ng.common.locales&&ki.ng.common.locales[n]),e0[n]}var lt=(function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n})(lt||{});function vI(n){return n.toLowerCase().replace(/_/g,"-")}var Ya="en-US",CI="USD";var xI=Ya;function OC(n){typeof n=="string"&&(xI=n.toLowerCase().replace(/_/g,"-"))}function b(n,e,t){let i=ce(),r=tt(),o=St();return LC(r,i,i[Je],o,n,e,t),b}function Xo(n,e,t){let i=ce(),r=tt(),o=St();return(o.type&3||t)&&EC(o,r,i,t,i[Je],n,e,ld(o,i,e)),Xo}function LC(n,e,t,i,r,o,s){let u=!0,d=null;if((i.type&3||s)&&(d??=ld(i,e,o),EC(i,n,e,s,t,r,o,d)&&(u=!1)),u){let m=i.outputs?.[r],h=i.hostDirectiveOutputs?.[r];if(h&&h.length)for(let y=0;y<h.length;y+=2){let _=h[y],C=h[y+1];d??=ld(i,e,o),zv(i,e,_,C,r,d)}if(m&&m.length)for(let y of m)d??=ld(i,e,o),zv(i,e,y,r,r,d)}}function v(n=1){return bv(n)}function yg(n,e,t,i){jT(n,e,t,i)}function Sn(n,e,t){WT(n,e,t)}function on(n){let e=ce(),t=tt(),i=Uf();Ku(i+1);let r=cg(t,i);if(n.dirty&&rv(e)===((r.metadata.flags&2)===2)){if(r.matches===null)n.reset([]);else{let o=JT(e,i);n.reset(o,yD),n.notifyOnChanges()}return!0}return!1}function sn(){return qT(ce(),Uf())}function Dn(n){let e=fv();return qu(e,st+n)}function id(n,e){return n<<17|e<<2}function Jr(n){return n>>17&32767}function EI(n){return(n&2)==2}function bI(n,e){return n&131071|e<<17}function R0(n){return n|2}function Qo(n){return(n&131068)>>2}function t0(n,e){return n&-131069|e<<2}function SI(n){return(n&1)===1}function F0(n){return n|1}function DI(n,e,t,i,r,o){let s=o?e.classBindings:e.styleBindings,u=Jr(s),d=Qo(s);n[i]=t;let m=!1,h;if(Array.isArray(t)){let y=t;h=y[1],(h===null||Vo(y,h)>0)&&(m=!0)}else h=t;if(r)if(d!==0){let _=Jr(n[u+1]);n[i+1]=id(_,u),_!==0&&(n[_+1]=t0(n[_+1],i)),n[u+1]=bI(n[u+1],i)}else n[i+1]=id(u,0),u!==0&&(n[u+1]=t0(n[u+1],i)),u=i;else n[i+1]=id(d,0),u===0?u=i:n[d+1]=t0(n[d+1],i),d=i;m&&(n[i+1]=R0(n[i+1])),e1(n,h,i,!0),e1(n,h,i,!1),wI(e,h,n,i,o),s=id(u,d),o?e.classBindings=s:e.styleBindings=s}function wI(n,e,t,i,r){let o=r?n.residualClasses:n.residualStyles;o!=null&&typeof e=="string"&&Vo(o,e)>=0&&(t[i+1]=F0(t[i+1]))}function e1(n,e,t,i){let r=n[t+1],o=e===null,s=i?Jr(r):Qo(r),u=!1;for(;s!==0&&(u===!1||o);){let d=n[s],m=n[s+1];TI(d,e)&&(u=!0,n[s+1]=i?F0(m):R0(m)),s=i?Jr(m):Qo(m)}u&&(n[t+1]=i?R0(r):F0(r))}function TI(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?Vo(n,e)>=0:!1}var Zn={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function II(n){return n.substring(Zn.key,Zn.keyEnd)}function MI(n){return AI(n),BC(n,UC(n,0,Zn.textEnd))}function BC(n,e){let t=Zn.textEnd;return t===e?-1:(e=Zn.keyEnd=NI(n,Zn.key=e,t),UC(n,e,t))}function AI(n){Zn.key=0,Zn.keyEnd=0,Zn.value=0,Zn.valueEnd=0,Zn.textEnd=n.length}function UC(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function NI(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}function gn(n,e,t){return $C(n,e,t,!1),gn}function z(n,e){return $C(n,e,null,!0),z}function De(n){FI(BI,RI,n,!0)}function RI(n,e){for(let t=MI(e);t>=0;t=BC(e,t))$u(n,II(e),!0)}function $C(n,e,t,i){let r=ce(),o=tt(),s=Sa(2);if(o.firstUpdatePass&&GC(o,n,s,i),e!==Ht&&Ln(r,s,e)){let u=o.data[Kn()];qC(o,u,r,r[Je],n,r[s+1]=$I(e,t),i,s)}}function FI(n,e,t,i){let r=tt(),o=Sa(2);r.firstUpdatePass&&GC(r,null,o,i);let s=ce();if(t!==Ht&&Ln(s,o,t)){let u=r.data[Kn()];if(WC(u,i)&&!HC(r,o)){let d=i?u.classesWithoutHost:u.stylesWithoutHost;d!==null&&(t=Ou(d,t||"")),N0(r,u,s,t,i)}else UI(r,u,s,s[Je],s[o+1],s[o+1]=LI(n,e,t),i,o)}}function HC(n,e){return e>=n.expandoStartIndex}function GC(n,e,t,i){let r=n.data;if(r[t+1]===null){let o=r[Kn()],s=HC(n,t);WC(o,i)&&e===null&&!s&&(e=!1),e=PI(r,o,e,i),DI(r,o,e,t,s,i)}}function PI(n,e,t,i){let r=vv(n),o=i?e.residualClasses:e.residualStyles;if(r===null)(i?e.classBindings:e.styleBindings)===0&&(t=n0(null,n,e,t,i),t=La(t,e.attrs,i),o=null);else{let s=e.directiveStylingLast;if(s===-1||n[s]!==r)if(t=n0(r,n,e,t,i),o===null){let d=kI(n,e,i);d!==void 0&&Array.isArray(d)&&(d=n0(null,n,e,d[1],i),d=La(d,e.attrs,i),VI(n,e,i,d))}else o=OI(n,e,i)}return o!==void 0&&(i?e.residualClasses=o:e.residualStyles=o),t}function kI(n,e,t){let i=t?e.classBindings:e.styleBindings;if(Qo(i)!==0)return n[Jr(i)]}function VI(n,e,t,i){let r=t?e.classBindings:e.styleBindings;n[Jr(r)]=i}function OI(n,e,t){let i,r=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<r;o++){let s=n[o].hostAttrs;i=La(i,s,t)}return La(i,e.attrs,t)}function n0(n,e,t,i,r){let o=null,s=t.directiveEnd,u=t.directiveStylingLast;for(u===-1?u=t.directiveStart:u++;u<s&&(o=e[u],i=La(i,o.hostAttrs,r),o!==n);)u++;return n!==null&&(t.directiveStylingLast=u),i}function La(n,e,t){let i=t?1:2,r=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?r=s:r===i&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),$u(n,s,t?!0:e[++o]))}return n===void 0?null:n}function LI(n,e,t){if(t==null||t==="")return en;let i=[],r=Ha(t);if(Array.isArray(r))for(let o=0;o<r.length;o++)n(i,r[o],!0);else if(typeof r=="object")for(let o in r)r.hasOwnProperty(o)&&n(i,o,r[o]);else typeof r=="string"&&e(i,r);return i}function BI(n,e,t){let i=String(e);i!==""&&!i.includes(" ")&&$u(n,i,t)}function UI(n,e,t,i,r,o,s,u){r===Ht&&(r=en);let d=0,m=0,h=0<r.length?r[0]:null,y=0<o.length?o[0]:null;for(;h!==null||y!==null;){let _=d<r.length?r[d+1]:void 0,C=m<o.length?o[m+1]:void 0,D=null,I;h===y?(d+=2,m+=2,_!==C&&(D=y,I=C)):y===null||h!==null&&h<y?(d+=2,D=h):(m+=2,D=y,I=C),D!==null&&qC(n,e,t,i,D,I,s,u),h=d<r.length?r[d]:null,y=m<o.length?o[m]:null}}function qC(n,e,t,i,r,o,s,u){if(!(e.type&3))return;let d=n.data,m=d[u+1],h=SI(m)?t1(d,e,t,r,Qo(m),s):void 0;if(!Id(h)){Id(o)||EI(m)&&(o=t1(d,null,t,r,u,s));let y=wf(Kn(),t);ww(i,s,y,r,o)}}function t1(n,e,t,i,r,o){let s=e===null,u;for(;r>0;){let d=n[r],m=Array.isArray(d),h=m?d[1]:d,y=h===null,_=t[r+1];_===Ht&&(_=y?en:void 0);let C=y?Hu(_,i):h===i?_:void 0;if(m&&!Id(C)&&(C=Hu(d,i)),Id(C)&&(u=C,s))return u;let D=n[r+1];r=s?Jr(D):Qo(D)}if(e!==null){let d=o?e.residualClasses:e.residualStyles;d!=null&&(u=Hu(d,i))}return u}function Id(n){return n!==void 0}function $I(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=Pi(Ha(n)))),n}function WC(n,e){return(n.flags&(e?8:16))!==0}function c(n,e=""){let t=ce(),i=tt(),r=n+st,o=i.firstCreatePass?qa(i,r,1,e,null):i.data[r],s=HI(i,t,o,e,n);t[r]=s,Xu()&&Z0(i,t,s,o),Ho(o,!1)}var HI=(n,e,t,i,r)=>(wa(!0),PD(e[Je],i));function jC(n,e,t,i=""){return Ln(n,mr(),t)?e+mi(t)+i:Ht}function GI(n,e,t,i,r,o=""){let s=Bf(),u=Va(n,s,t,r);return Sa(2),u?e+mi(t)+i+mi(r)+o:Ht}function qI(n,e,t,i,r,o,s,u=""){let d=Bf(),m=xT(n,d,t,r,s);return Sa(3),m?e+mi(t)+i+mi(r)+o+mi(s)+u:Ht}function E(n){return V("",n),E}function V(n,e,t){let i=ce(),r=jC(i,n,e,t);return r!==Ht&&_g(i,Kn(),r),V}function ut(n,e,t,i,r){let o=ce(),s=GI(o,n,e,t,i,r);return s!==Ht&&_g(o,Kn(),s),ut}function kt(n,e,t,i,r,o,s){let u=ce(),d=qI(u,n,e,t,i,r,o,s);return d!==Ht&&_g(u,Kn(),d),kt}function _g(n,e,t){let i=wf(e,n);kD(n[Je],i,t)}function Q(n,e,t){jf(e)&&(e=e());let i=ce(),r=mr();if(Ln(i,r,e)){let o=tt(),s=Da();eC(s,i,n,e,i[Je],t)}return Q}function ee(n,e){let t=jf(n);return t&&n.set(e),t}function Z(n,e){let t=ce(),i=tt(),r=St();return LC(i,t,t[Je],r,n,e),Z}function Un(n,e,t=""){return jC(ce(),n,e,t)}function WI(n,e,t){let i=tt();if(i.firstCreatePass){let r=hi(n);P0(t,i.data,i.blueprint,r,!0),P0(e,i.data,i.blueprint,r,!1)}}function P0(n,e,t,i,r){if(n=Ut(n),Array.isArray(n))for(let o=0;o<n.length;o++)P0(n[o],e,t,i,r);else{let o=tt(),s=ce(),u=St(),d=Rr(n)?n:Ut(n.provide),m=Cf(n),h=u.providerIndexes&1048575,y=u.directiveStart,_=u.providerIndexes>>20;if(Rr(n)||!n.multi){let C=new Wr(m,r,K,null),D=r0(d,e,r?h:h+_,y);D===-1?(s0(pd(u,s),o,d),i0(o,n,e.length),e.push(d),u.directiveStart++,u.directiveEnd++,r&&(u.providerIndexes+=1048576),t.push(C),s.push(C)):(t[D]=C,s[D]=C)}else{let C=r0(d,e,h+_,y),D=r0(d,e,h,h+_),I=C>=0&&t[C],R=D>=0&&t[D];if(r&&!R||!r&&!I){s0(pd(u,s),o,d);let F=YI(r?zI:jI,t.length,r,i,m,n);!r&&R&&(t[D].providerFactory=F),i0(o,n,e.length,0),e.push(d),u.directiveStart++,u.directiveEnd++,r&&(u.providerIndexes+=1048576),t.push(F),s.push(F)}else{let F=zC(t[r?D:C],m,!r&&i);i0(o,n,C>-1?C:D,F)}!r&&i&&R&&t[D].componentProviders++}}}function i0(n,e,t,i){let r=Rr(e),o=ev(e);if(r||o){let d=(o?Ut(e.useClass):e).prototype.ngOnDestroy;if(d){let m=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){let h=m.indexOf(t);h===-1?m.push(t,[i,d]):m[h+1].push(i,d)}else m.push(t,d)}}}function zC(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function r0(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function jI(n,e,t,i,r){return k0(this.multi,[])}function zI(n,e,t,i,r){let o=this.multi,s;if(this.providerFactory){let u=this.providerFactory.componentProviders,d=Na(i,i[ae],this.providerFactory.index,r);s=d.slice(0,u),k0(o,s);for(let m=u;m<d.length;m++)s.push(d[m])}else s=[],k0(o,s);return s}function k0(n,e){for(let t=0;t<n.length;t++){let i=n[t];e.push(i())}return e}function YI(n,e,t,i,r,o){let s=new Wr(n,t,K,null);return s.multi=[],s.index=e,s.componentProviders=0,zC(s,r,i&&!t),s}function Gt(n,e=[]){return t=>{t.providersResolver=(i,r)=>WI(i,r?r(n):n,e)}}function Vt(n,e,t){let i=Yu()+n,r=ce();return r[i]===Ht?dg(r,i,t?e.call(t):e()):CT(r,i)}function YC(n,e){let t=n[e];return t===Ht?void 0:t}function JI(n,e,t,i,r,o,s){let u=e+t;return Va(n,u,r,o)?dg(n,u+2,s?i.call(s,r,o):i(r,o)):YC(n,u+2)}function KI(n,e,t,i,r,o,s,u,d){let m=e+t;return ET(n,m,r,o,s,u)?dg(n,m+4,d?i.call(d,r,o,s,u):i(r,o,s,u)):YC(n,m+4)}function qt(n,e){let t=tt(),i,r=n+st;t.firstCreatePass?(i=QI(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??=[]).push(r,i.onDestroy)):i=t.data[r];let o=i.factory||(i.factory=nr(i.type,!0)),s,u=Xt(K);try{let d=md(!1),m=o();return md(d),Tf(t,ce(),r,m),m}finally{Xt(u)}}function QI(n,e){if(e)for(let t=e.length-1;t>=0;t--){let i=e[t];if(n===i.name)return i}}function an(n,e,t,i){let r=n+st,o=ce(),s=qu(o,r);return JC(o,r)?JI(o,Yu(),e,s.transform,t,i,s):s.transform(t,i)}function zd(n,e,t,i,r,o){let s=n+st,u=ce(),d=qu(u,s);return JC(u,s)?KI(u,Yu(),e,d.transform,t,i,r,o,d):d.transform(t,i,r,o)}function JC(n,e){return n[ae].data[e].pure}var Md=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},vg=(()=>{class n{compileModuleSync(t){return new Sd(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let i=this.compileModuleSync(t),r=hf(t),o=B1(r.declarations).reduce((s,u)=>{let d=ar(u);return d&&s.push(new Ko(d)),s},[]);return new Md(i,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var ZI=(()=>{class n{zone=P(yt);changeDetectionScheduler=P(An);applicationRef=P(Gi);applicationErrorHandler=P(fn);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{try{this.applicationRef.dirtyFlags|=1,this.applicationRef._tick()}catch(t){this.applicationErrorHandler(t)}})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function KC({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new yt(q(k({},QC()),{scheduleInRootZone:t})),[{provide:yt,useFactory:n},{provide:sr,multi:!0,useFactory:()=>{let i=P(ZI,{optional:!0});return()=>i.initialize()}},{provide:sr,multi:!0,useFactory:()=>{let i=P(XI);return()=>{i.initialize()}}},e===!0?{provide:zf,useValue:!0}:[],{provide:ed,useValue:t??q1},{provide:fn,useFactory:()=>{let i=P(yt),r=P(Et),o;return s=>{i.runOutsideAngular(()=>{r.destroyed&&!o?setTimeout(()=>{throw s}):(o??=r.get(Mn),o.handleError(s))})}}}]}function QC(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var XI=(()=>{class n{subscription=new vt;initialized=!1;zone=P(yt);pendingTasks=P(yi);initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{yt.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{yt.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Cg=(()=>{class n{applicationErrorHandler=P(fn);appRef=P(Gi);taskService=P(yi);ngZone=P(yt);zonelessEnabled=P(Ta);tracing=P(Kr,{optional:!0});disableScheduling=P(zf,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new vt;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(yd):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(P(ed,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Ra||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;let i=!1;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2,i=!0;break}case 12:{this.appRef.dirtyFlags|=16,i=!0;break}case 13:{this.appRef.dirtyFlags|=2,i=!0;break}case 11:{i=!0;break}case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(i))return;let r=this.useMicrotaskScheduler?Ov:W1;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(t){return!(this.disableScheduling&&!t||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(yd+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(i){this.taskService.remove(t),this.applicationErrorHandler(i)}finally{this.cleanup()}this.useMicrotaskScheduler=!0,Ov(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(i){return new(i||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function xg(){return Ui("NgZoneless"),kr([{provide:An,useExisting:Cg},{provide:yt,useClass:Ra},{provide:Ta,useValue:!0},{provide:ed,useValue:!1},[]])}function eM(){return typeof $localize<"u"&&$localize.locale||Ya}var Qr=new te("",{providedIn:"root",factory:()=>P(Qr,{optional:!0,skipSelf:!0})||eM()}),Eg=new te("",{providedIn:"root",factory:()=>CI});function Rt(n){return O_(n)}function H(n,e){return au(n,e?.equal)}var bg=class{[zt];constructor(e){this[zt]=e}destroy(){this[zt].destroy()}};function Ci(n,e){let t=e?.injector??P(Jt),i=e?.manualCleanup!==!0?t.get(On):null,r,o=t.get(qo,null,{optional:!0}),s=t.get(An);return o!==null?(r=iM(o.view,s,n),i instanceof ga&&i._lView===o.view&&(i=null)):r=rM(n,t.get(Ia),s),r.injector=t,i!==null&&(r.onDestroyFn=i.onDestroy(()=>r.destroy())),new bg(r)}var ZC=q(k({},L_),{cleanupFns:void 0,zone:null,onDestroyFn:Gr,run(){let n=Go(!1);try{B_(this)}finally{Go(n)}},cleanup(){if(!this.cleanupFns?.length)return;let n=fe(null);try{for(;this.cleanupFns.length;)this.cleanupFns.pop()()}finally{this.cleanupFns=[],fe(n)}}}),tM=q(k({},ZC),{consumerMarkedDirty(){this.scheduler.schedule(this),this.notifier.notify(12)},destroy(){wr(this),this.onDestroyFn(),this.cleanup(),this.scheduler.remove(this)}}),nM=q(k({},ZC),{consumerMarkedDirty(){this.view[ge]|=8192,cr(this.view),this.notifier.notify(13)},destroy(){wr(this),this.onDestroyFn(),this.cleanup(),this.view[Oi]?.delete(this)}});function iM(n,e,t){let i=Object.create(nM);return i.view=n,i.zone=typeof Zone<"u"?Zone.current:null,i.notifier=e,i.fn=XC(i,t),n[Oi]??=new Set,n[Oi].add(i),i.consumerMarkedDirty(i),i}function rM(n,e,t){let i=Object.create(tM);return i.fn=XC(i,n),i.scheduler=e,i.notifier=t,i.zone=typeof Zone<"u"?Zone.current:null,i.scheduler.add(i),i.notifier.notify(12),i}function XC(n,e){return()=>{e(t=>(n.cleanupFns??=[]).push(t))}}var ix=Symbol("InputSignalNode#UNSET"),_M=q(k({},lu),{transformFn:void 0,applyValueToInputSignal(n,e){Do(n,e)}});function rx(n,e){let t=Object.create(_M);t.value=n,t.transformFn=e?.transform;function i(){if(xo(t),t.value===ix){let r=null;throw new j(-950,r)}return t.value}return i[zt]=t,i}var Jd=class{attributeName;constructor(e){this.attributeName=e}__NG_ELEMENT_ID__=()=>Ua(this.attributeName);toString(){return`HostAttributeToken ${this.attributeName}`}},vM=new te("");vM.__NG_ELEMENT_ID__=n=>{let e=St();if(e===null)throw new j(204,!1);if(e.type&2)return e.value;if(n&8)return null;throw new j(204,!1)};function ex(n,e){return rx(n,e)}function CM(n){return rx(ix,n)}var Qd=(ex.required=CM,ex);var Sg=new te(""),xM=new te("");function Ja(n){return!n.moduleRef}function EM(n){let e=Ja(n)?n.r3Injector:n.moduleRef.injector,t=e.get(yt);return t.run(()=>{Ja(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let i=e.get(fn),r;if(t.runOutsideAngular(()=>{r=t.onError.subscribe({next:i})}),Ja(n)){let o=()=>e.destroy(),s=n.platformInjector.get(Sg);s.add(o),e.onDestroy(()=>{r.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(Sg);s.add(o),n.moduleRef.onDestroy(()=>{Aa(n.allPlatformModules,n.moduleRef),r.unsubscribe(),s.delete(o)})}return SM(i,t,()=>{let o=e.get(yi),s=o.add(),u=e.get(gg);return u.runInitializers(),u.donePromise.then(()=>{let d=e.get(Qr,Ya);if(OC(d||Ya),!e.get(xM,!0))return Ja(n)?e.get(Gi):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(Ja(n)){let h=e.get(Gi);return n.rootComponent!==void 0&&h.bootstrap(n.rootComponent),h}else return bM?.(n.moduleRef,n.allPlatformModules),n.moduleRef}).finally(()=>void o.remove(s))})})}var bM;function SM(n,e,t){try{let i=t();return hr(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n(i)),i}}var Yd=null;function DM(n=[],e){return Jt.create({name:e,providers:[{provide:_a,useValue:"platform"},{provide:Sg,useValue:new Set([()=>Yd=null])},...n]})}function wM(n=[]){if(Yd)return Yd;let e=DM(n);return Yd=e,PC(),TM(e),e}function TM(n){let e=n.get(Nd,null);At(n,()=>{e?.forEach(t=>t())})}var yr=(()=>{class n{static __NG_ELEMENT_ID__=IM}return n})();function IM(n){return MM(St(),ce(),(n&16)===16)}function MM(n,e,t){if(dr(n)&&!t){let i=kn(n.index,e);return new fr(i,i)}else if(n.type&175){let i=e[xn];return new fr(i,e)}return null}var Dg=class{constructor(){}supports(e){return ug(e)}create(e){return new wg(e)}},AM=(n,e)=>e,wg=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||AM}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,o=null;for(;t||i;){let s=!i||t&&t.currentIndex<tx(i,r,o)?t:i,u=tx(s,r,o),d=s.currentIndex;if(s===i)r--,i=i._nextRemoved;else if(t=t._next,s.previousIndex==null)r++;else{o||(o=[]);let m=u-r,h=d-r;if(m!=h){for(let _=0;_<m;_++){let C=_<o.length?o[_]:o[_]=0,D=C+_;h<=D&&D<m&&(o[_]=C+1)}let y=s.previousIndex;o[y]=h-m}}u!==d&&e(s,u,d)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!ug(e))throw new j(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,i=!1,r,o,s;if(Array.isArray(e)){this.length=e.length;for(let u=0;u<this.length;u++)o=e[u],s=this._trackByFn(u,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,u),i=!0):(i&&(t=this._verifyReinsertion(t,o,s,u)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else r=0,CC(e,u=>{s=this._trackByFn(r,u),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,u,s,r),i=!0):(i&&(t=this._verifyReinsertion(t,u,s,r)),Object.is(t.item,u)||this._addIdentityChange(t,u)),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,r)):(e=this._linkedRecords===null?null:this._linkedRecords.get(i,r),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,r)):e=this._addAfter(new Tg(t,i),o,r)),e}_verifyReinsertion(e,t,i,r){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null);return o!==null?e=this._reinsertAfter(o,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let r=e._prevRemoved,o=e._nextRemoved;return r===null?this._removalsHead=o:r._nextRemoved=o,o===null?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){let r=t===null?this._itHead:t._next;return e._next=r,e._prev=t,r===null?this._itTail=e:r._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new Kd),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,i=e._next;return t===null?this._itHead=i:t._next=i,i===null?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Kd),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},Tg=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},Ig=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;i!==null;i=i._nextDup)if((t===null||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){let t=e._prevDup,i=e._nextDup;return t===null?this._head=i:t._nextDup=i,i===null?this._tail=t:i._prevDup=t,this._head===null}},Kd=class{map=new Map;put(e){let t=e.trackById,i=this.map.get(t);i||(i=new Ig,this.map.set(t,i)),i.add(e)}get(e,t){let i=e,r=this.map.get(i);return r?r.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function tx(n,e,t){let i=n.previousIndex;if(i===null)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}function nx(){return new Mg([new Dg])}var Mg=(()=>{class n{factories;static \u0275prov=J({token:n,providedIn:"root",factory:nx});constructor(t){this.factories=t}static create(t,i){if(i!=null){let r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:()=>{let i=P(n,{optional:!0,skipSelf:!0});return n.create(t,i||nx())}}}find(t){let i=this.factories.find(r=>r.supports(t));if(i!=null)return i;throw new j(901,!1)}}return n})();function ox(n){let{rootComponent:e,appProviders:t,platformProviders:i,platformRef:r}=n;ze(8);try{let o=r?.injector??wM(i),s=[KC({}),{provide:An,useExisting:Cg},wv,...t||[]],u=new Oa({providers:s,parent:o,debugName:"",runEnvironmentInitializers:!1});return EM({r3Injector:u.injector,platformInjector:o,rootComponent:e})}catch(o){return Promise.reject(o)}finally{ze(9)}}function Zr(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}var lx=null;function $n(){return lx}function Ag(n){lx??=n}var Ka=class{},Qa=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=J({token:n,factory:()=>P(ux),providedIn:"platform"})}return n})();var ux=(()=>{class n extends Qa{_location;_history;_doc=P(Nt);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return $n().getBaseHref(this._doc)}onPopState(t){let i=$n().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){let i=$n().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(i){return new(i||n)};static \u0275prov=J({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function Zd(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function sx(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function ti(n){return n&&n[0]!=="?"?`?${n}`:n}var xi=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=J({token:n,factory:()=>P(Ng),providedIn:"root"})}return n})(),Xd=new te(""),Ng=(()=>{class n extends xi{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,i){super(),this._platformLocation=t,this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??P(Nt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Zd(this._baseHref,t)}path(t=!1){let i=this._platformLocation.pathname+ti(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,o){let s=this.prepareExternalUrl(r+ti(o));this._platformLocation.pushState(t,i,s)}replaceState(t,i,r,o){let s=this.prepareExternalUrl(r+ti(o));this._platformLocation.replaceState(t,i,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(i){return new(i||n)(oe(Qa),oe(Xd,8))};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Xr=(()=>{class n{_subject=new gt;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let i=this._locationStrategy.getBaseHref();this._basePath=FM(sx(ax(i))),this._locationStrategy.onPopState(r=>{this._subject.next({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+ti(i))}normalize(t){return n.stripTrailingSlash(RM(this._basePath,ax(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ti(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ti(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i??void 0,complete:r??void 0})}static normalizeQueryParams=ti;static joinWithSlash=Zd;static stripTrailingSlash=sx;static \u0275fac=function(i){return new(i||n)(oe(xi))};static \u0275prov=J({token:n,factory:()=>NM(),providedIn:"root"})}return n})();function NM(){return new Xr(oe(xi))}function RM(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function ax(n){return n.replace(/\/index.html$/,"")}function FM(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var Lg=(()=>{class n extends xi{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(t,i){super(),this._platformLocation=t,i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(t){let i=Zd(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,o){let s=this.prepareExternalUrl(r+ti(o))||this._platformLocation.pathname;this._platformLocation.pushState(t,i,s)}replaceState(t,i,r,o){let s=this.prepareExternalUrl(r+ti(o))||this._platformLocation.pathname;this._platformLocation.replaceState(t,i,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(i){return new(i||n)(oe(Qa),oe(Xd,8))};static \u0275prov=J({token:n,factory:n.\u0275fac})}return n})(),hx={ADP:[void 0,void 0,0],AFN:[void 0,"\u060B",0],ALL:[void 0,void 0,0],AMD:[void 0,"\u058F",2],AOA:[void 0,"Kz"],ARS:[void 0,"$"],AUD:["A$","$"],AZN:[void 0,"\u20BC"],BAM:[void 0,"KM"],BBD:[void 0,"$"],BDT:[void 0,"\u09F3"],BHD:[void 0,void 0,3],BIF:[void 0,void 0,0],BMD:[void 0,"$"],BND:[void 0,"$"],BOB:[void 0,"Bs"],BRL:["R$"],BSD:[void 0,"$"],BWP:[void 0,"P"],BYN:[void 0,void 0,2],BYR:[void 0,void 0,0],BZD:[void 0,"$"],CAD:["CA$","$",2],CHF:[void 0,void 0,2],CLF:[void 0,void 0,4],CLP:[void 0,"$",0],CNY:["CN\xA5","\xA5"],COP:[void 0,"$",2],CRC:[void 0,"\u20A1",2],CUC:[void 0,"$"],CUP:[void 0,"$"],CZK:[void 0,"K\u010D",2],DJF:[void 0,void 0,0],DKK:[void 0,"kr",2],DOP:[void 0,"$"],EGP:[void 0,"E\xA3"],ESP:[void 0,"\u20A7",0],EUR:["\u20AC"],FJD:[void 0,"$"],FKP:[void 0,"\xA3"],GBP:["\xA3"],GEL:[void 0,"\u20BE"],GHS:[void 0,"GH\u20B5"],GIP:[void 0,"\xA3"],GNF:[void 0,"FG",0],GTQ:[void 0,"Q"],GYD:[void 0,"$",2],HKD:["HK$","$"],HNL:[void 0,"L"],HRK:[void 0,"kn"],HUF:[void 0,"Ft",2],IDR:[void 0,"Rp",2],ILS:["\u20AA"],INR:["\u20B9"],IQD:[void 0,void 0,0],IRR:[void 0,void 0,0],ISK:[void 0,"kr",0],ITL:[void 0,void 0,0],JMD:[void 0,"$"],JOD:[void 0,void 0,3],JPY:["\xA5",void 0,0],KHR:[void 0,"\u17DB"],KMF:[void 0,"CF",0],KPW:[void 0,"\u20A9",0],KRW:["\u20A9",void 0,0],KWD:[void 0,void 0,3],KYD:[void 0,"$"],KZT:[void 0,"\u20B8"],LAK:[void 0,"\u20AD",0],LBP:[void 0,"L\xA3",0],LKR:[void 0,"Rs"],LRD:[void 0,"$"],LTL:[void 0,"Lt"],LUF:[void 0,void 0,0],LVL:[void 0,"Ls"],LYD:[void 0,void 0,3],MGA:[void 0,"Ar",0],MGF:[void 0,void 0,0],MMK:[void 0,"K",0],MNT:[void 0,"\u20AE",2],MRO:[void 0,void 0,0],MUR:[void 0,"Rs",2],MXN:["MX$","$"],MYR:[void 0,"RM"],NAD:[void 0,"$"],NGN:[void 0,"\u20A6"],NIO:[void 0,"C$"],NOK:[void 0,"kr",2],NPR:[void 0,"Rs"],NZD:["NZ$","$"],OMR:[void 0,void 0,3],PHP:["\u20B1"],PKR:[void 0,"Rs",2],PLN:[void 0,"z\u0142"],PYG:[void 0,"\u20B2",0],RON:[void 0,"lei"],RSD:[void 0,void 0,0],RUB:[void 0,"\u20BD"],RWF:[void 0,"RF",0],SBD:[void 0,"$"],SEK:[void 0,"kr",2],SGD:[void 0,"$"],SHP:[void 0,"\xA3"],SLE:[void 0,void 0,2],SLL:[void 0,void 0,0],SOS:[void 0,void 0,0],SRD:[void 0,"$"],SSP:[void 0,"\xA3"],STD:[void 0,void 0,0],STN:[void 0,"Db"],SYP:[void 0,"\xA3",0],THB:[void 0,"\u0E3F"],TMM:[void 0,void 0,0],TND:[void 0,void 0,3],TOP:[void 0,"T$"],TRL:[void 0,void 0,0],TRY:[void 0,"\u20BA"],TTD:[void 0,"$"],TWD:["NT$","$",2],TZS:[void 0,void 0,2],UAH:[void 0,"\u20B4"],UGX:[void 0,void 0,0],USD:["$"],UYI:[void 0,void 0,0],UYU:[void 0,"$"],UYW:[void 0,void 0,4],UZS:[void 0,void 0,2],VEF:[void 0,"Bs",2],VND:["\u20AB",void 0,0],VUV:[void 0,void 0,0],XAF:["FCFA",void 0,0],XCD:["EC$","$"],XOF:["F\u202FCFA",void 0,0],XPF:["CFPF",void 0,0],XXX:["\xA4"],YER:[void 0,void 0,0],ZAR:[void 0,"R"],ZMK:[void 0,void 0,0],ZMW:[void 0,"ZK"],ZWD:[void 0,void 0,0]},uc=(function(n){return n[n.Decimal=0]="Decimal",n[n.Percent=1]="Percent",n[n.Currency=2]="Currency",n[n.Scientific=3]="Scientific",n})(uc||{});var Kt=(function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n})(Kt||{}),Ye=(function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n})(Ye||{}),hn=(function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n})(hn||{}),Wt={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function yx(n){return rn(n)[lt.LocaleId]}function _x(n,e,t){let i=rn(n),r=[i[lt.DayPeriodsFormat],i[lt.DayPeriodsStandalone]],o=Hn(r,e);return Hn(o,t)}function vx(n,e,t){let i=rn(n),r=[i[lt.DaysFormat],i[lt.DaysStandalone]],o=Hn(r,e);return Hn(o,t)}function Cx(n,e,t){let i=rn(n),r=[i[lt.MonthsFormat],i[lt.MonthsStandalone]],o=Hn(r,e);return Hn(o,t)}function xx(n,e){let i=rn(n)[lt.Eras];return Hn(i,e)}function Za(n,e){let t=rn(n);return Hn(t[lt.DateFormat],e)}function Xa(n,e){let t=rn(n);return Hn(t[lt.TimeFormat],e)}function el(n,e){let i=rn(n)[lt.DateTimeFormat];return Hn(i,e)}function ii(n,e){let t=rn(n),i=t[lt.NumberSymbols][e];if(typeof i>"u"){if(e===Wt.CurrencyDecimal)return t[lt.NumberSymbols][Wt.Decimal];if(e===Wt.CurrencyGroup)return t[lt.NumberSymbols][Wt.Group]}return i}function Bg(n,e){return rn(n)[lt.NumberFormats][e]}function PM(n){return rn(n)[lt.Currencies]}function Ex(n){if(!n[lt.ExtraData])throw new j(2303,!1)}function bx(n){let e=rn(n);return Ex(e),(e[lt.ExtraData][2]||[]).map(i=>typeof i=="string"?Rg(i):[Rg(i[0]),Rg(i[1])])}function Sx(n,e,t){let i=rn(n);Ex(i);let r=[i[lt.ExtraData][0],i[lt.ExtraData][1]],o=Hn(r,e)||[];return Hn(o,t)||[]}function Hn(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new j(2304,!1)}function Rg(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}function Dx(n,e,t="en"){let i=PM(t)[n]||hx[n]||[],r=i[1];return e==="narrow"&&typeof r=="string"?r:i[0]||n}var kM=2;function wx(n){let e,t=hx[n];return t&&(e=t[2]),typeof e=="number"?e:kM}var VM=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,ec={},OM=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function Tx(n,e,t,i){let r=jM(n);e=Wi(t,e)||e;let s=[],u;for(;e;)if(u=OM.exec(e),u){s=s.concat(u.slice(1));let h=s.pop();if(!h)break;e=h}else{s.push(e);break}let d=r.getTimezoneOffset();i&&(d=Mx(i,d),r=WM(r,i));let m="";return s.forEach(h=>{let y=GM(h);m+=y?y(r,t,d):h==="''"?"'":h.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),m}function oc(n,e,t){let i=new Date(0);return i.setFullYear(n,e,t),i.setHours(0,0,0),i}function Wi(n,e){let t=yx(n);if(ec[t]??={},ec[t][e])return ec[t][e];let i="";switch(e){case"shortDate":i=Za(n,hn.Short);break;case"mediumDate":i=Za(n,hn.Medium);break;case"longDate":i=Za(n,hn.Long);break;case"fullDate":i=Za(n,hn.Full);break;case"shortTime":i=Xa(n,hn.Short);break;case"mediumTime":i=Xa(n,hn.Medium);break;case"longTime":i=Xa(n,hn.Long);break;case"fullTime":i=Xa(n,hn.Full);break;case"short":let r=Wi(n,"shortTime"),o=Wi(n,"shortDate");i=tc(el(n,hn.Short),[r,o]);break;case"medium":let s=Wi(n,"mediumTime"),u=Wi(n,"mediumDate");i=tc(el(n,hn.Medium),[s,u]);break;case"long":let d=Wi(n,"longTime"),m=Wi(n,"longDate");i=tc(el(n,hn.Long),[d,m]);break;case"full":let h=Wi(n,"fullTime"),y=Wi(n,"fullDate");i=tc(el(n,hn.Full),[h,y]);break}return i&&(ec[t][e]=i),i}function tc(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,i){return e!=null&&i in e?e[i]:t})),n}function ni(n,e,t="-",i,r){let o="";(n<0||r&&n<=0)&&(r?n=-n+1:(n=-n,o=t));let s=String(n);for(;s.length<e;)s="0"+s;return i&&(s=s.slice(s.length-e)),o+s}function LM(n,e){return ni(n,3).substring(0,e)}function Dt(n,e,t=0,i=!1,r=!1){return function(o,s){let u=BM(n,o);if((t>0||u>-t)&&(u+=t),n===3)u===0&&t===-12&&(u=12);else if(n===6)return LM(u,e);let d=ii(s,Wt.MinusSign);return ni(u,e,d,i,r)}}function BM(n,e){switch(n){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();case 3:return e.getHours();case 4:return e.getMinutes();case 5:return e.getSeconds();case 6:return e.getMilliseconds();case 7:return e.getDay();default:throw new j(2301,!1)}}function Qe(n,e,t=Kt.Format,i=!1){return function(r,o){return UM(r,o,n,e,t,i)}}function UM(n,e,t,i,r,o){switch(t){case 2:return Cx(e,r,i)[n.getMonth()];case 1:return vx(e,r,i)[n.getDay()];case 0:let s=n.getHours(),u=n.getMinutes();if(o){let m=bx(e),h=Sx(e,r,i),y=m.findIndex(_=>{if(Array.isArray(_)){let[C,D]=_,I=s>=C.hours&&u>=C.minutes,R=s<D.hours||s===D.hours&&u<D.minutes;if(C.hours<D.hours){if(I&&R)return!0}else if(I||R)return!0}else if(_.hours===s&&_.minutes===u)return!0;return!1});if(y!==-1)return h[y]}return _x(e,r,i)[s<12?0:1];case 3:return xx(e,i)[n.getFullYear()<=0?0:1];default:let d=t;throw new j(2302,!1)}}function nc(n){return function(e,t,i){let r=-1*i,o=ii(t,Wt.MinusSign),s=r>0?Math.floor(r/60):Math.ceil(r/60);switch(n){case 0:return(r>=0?"+":"")+ni(s,2,o)+ni(Math.abs(r%60),2,o);case 1:return"GMT"+(r>=0?"+":"")+ni(s,1,o);case 2:return"GMT"+(r>=0?"+":"")+ni(s,2,o)+":"+ni(Math.abs(r%60),2,o);case 3:return i===0?"Z":(r>=0?"+":"")+ni(s,2,o)+":"+ni(Math.abs(r%60),2,o);default:throw new j(2310,!1)}}}var $M=0,rc=4;function HM(n){let e=oc(n,$M,1).getDay();return oc(n,0,1+(e<=rc?rc:rc+7)-e)}function Ix(n){let e=n.getDay(),t=e===0?-3:rc-e;return oc(n.getFullYear(),n.getMonth(),n.getDate()+t)}function Fg(n,e=!1){return function(t,i){let r;if(e){let o=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,s=t.getDate();r=1+Math.floor((s+o)/7)}else{let o=Ix(t),s=HM(o.getFullYear()),u=o.getTime()-s.getTime();r=1+Math.round(u/6048e5)}return ni(r,n,ii(i,Wt.MinusSign))}}function ic(n,e=!1){return function(t,i){let o=Ix(t).getFullYear();return ni(o,n,ii(i,Wt.MinusSign),e)}}var Pg={};function GM(n){if(Pg[n])return Pg[n];let e;switch(n){case"G":case"GG":case"GGG":e=Qe(3,Ye.Abbreviated);break;case"GGGG":e=Qe(3,Ye.Wide);break;case"GGGGG":e=Qe(3,Ye.Narrow);break;case"y":e=Dt(0,1,0,!1,!0);break;case"yy":e=Dt(0,2,0,!0,!0);break;case"yyy":e=Dt(0,3,0,!1,!0);break;case"yyyy":e=Dt(0,4,0,!1,!0);break;case"Y":e=ic(1);break;case"YY":e=ic(2,!0);break;case"YYY":e=ic(3);break;case"YYYY":e=ic(4);break;case"M":case"L":e=Dt(1,1,1);break;case"MM":case"LL":e=Dt(1,2,1);break;case"MMM":e=Qe(2,Ye.Abbreviated);break;case"MMMM":e=Qe(2,Ye.Wide);break;case"MMMMM":e=Qe(2,Ye.Narrow);break;case"LLL":e=Qe(2,Ye.Abbreviated,Kt.Standalone);break;case"LLLL":e=Qe(2,Ye.Wide,Kt.Standalone);break;case"LLLLL":e=Qe(2,Ye.Narrow,Kt.Standalone);break;case"w":e=Fg(1);break;case"ww":e=Fg(2);break;case"W":e=Fg(1,!0);break;case"d":e=Dt(2,1);break;case"dd":e=Dt(2,2);break;case"c":case"cc":e=Dt(7,1);break;case"ccc":e=Qe(1,Ye.Abbreviated,Kt.Standalone);break;case"cccc":e=Qe(1,Ye.Wide,Kt.Standalone);break;case"ccccc":e=Qe(1,Ye.Narrow,Kt.Standalone);break;case"cccccc":e=Qe(1,Ye.Short,Kt.Standalone);break;case"E":case"EE":case"EEE":e=Qe(1,Ye.Abbreviated);break;case"EEEE":e=Qe(1,Ye.Wide);break;case"EEEEE":e=Qe(1,Ye.Narrow);break;case"EEEEEE":e=Qe(1,Ye.Short);break;case"a":case"aa":case"aaa":e=Qe(0,Ye.Abbreviated);break;case"aaaa":e=Qe(0,Ye.Wide);break;case"aaaaa":e=Qe(0,Ye.Narrow);break;case"b":case"bb":case"bbb":e=Qe(0,Ye.Abbreviated,Kt.Standalone,!0);break;case"bbbb":e=Qe(0,Ye.Wide,Kt.Standalone,!0);break;case"bbbbb":e=Qe(0,Ye.Narrow,Kt.Standalone,!0);break;case"B":case"BB":case"BBB":e=Qe(0,Ye.Abbreviated,Kt.Format,!0);break;case"BBBB":e=Qe(0,Ye.Wide,Kt.Format,!0);break;case"BBBBB":e=Qe(0,Ye.Narrow,Kt.Format,!0);break;case"h":e=Dt(3,1,-12);break;case"hh":e=Dt(3,2,-12);break;case"H":e=Dt(3,1);break;case"HH":e=Dt(3,2);break;case"m":e=Dt(4,1);break;case"mm":e=Dt(4,2);break;case"s":e=Dt(5,1);break;case"ss":e=Dt(5,2);break;case"S":e=Dt(6,1);break;case"SS":e=Dt(6,2);break;case"SSS":e=Dt(6,3);break;case"Z":case"ZZ":case"ZZZ":e=nc(0);break;case"ZZZZZ":e=nc(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=nc(1);break;case"OOOO":case"ZZZZ":case"zzzz":e=nc(2);break;default:return null}return Pg[n]=e,e}function Mx(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function qM(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function WM(n,e,t){let r=n.getTimezoneOffset(),o=Mx(e,r);return qM(n,-1*(o-r))}function jM(n){if(dx(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[r,o=1,s=1]=n.split("-").map(u=>+u);return oc(r,o-1,s)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let i;if(i=n.match(VM))return zM(i)}let e=new Date(n);if(!dx(e))throw new j(2311,!1);return e}function zM(n){let e=new Date(0),t=0,i=0,r=n[8]?e.setUTCFullYear:e.setFullYear,o=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),i=Number(n[9]+n[11])),r.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let s=Number(n[4]||0)-t,u=Number(n[5]||0)-i,d=Number(n[6]||0),m=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return o.call(e,s,u,d,m),e}function dx(n){return n instanceof Date&&!isNaN(n.valueOf())}var YM=/^(\d+)?\.((\d+)(-(\d+))?)?$/,cx=22,sc=".",tl="0",JM=";",KM=",",kg="#",mx="\xA4";function Ax(n,e,t,i,r,o,s=!1){let u="",d=!1;if(!isFinite(n))u=ii(t,Wt.Infinity);else{let m=ZM(n);s&&(m=QM(m));let h=e.minInt,y=e.minFrac,_=e.maxFrac;if(o){let $=o.match(YM);if($===null)throw new j(2306,!1);let G=$[1],Y=$[3],ne=$[5];G!=null&&(h=Vg(G)),Y!=null&&(y=Vg(Y)),ne!=null?_=Vg(ne):Y!=null&&y>_&&(_=y)}XM(m,y,_);let C=m.digits,D=m.integerLen,I=m.exponent,R=[];for(d=C.every($=>!$);D<h;D++)C.unshift(0);for(;D<0;D++)C.unshift(0);D>0?R=C.splice(D,C.length):(R=C,C=[0]);let F=[];for(C.length>=e.lgSize&&F.unshift(C.splice(-e.lgSize,C.length).join(""));C.length>e.gSize;)F.unshift(C.splice(-e.gSize,C.length).join(""));C.length&&F.unshift(C.join("")),u=F.join(ii(t,i)),R.length&&(u+=ii(t,r)+R.join("")),I&&(u+=ii(t,Wt.Exponential)+"+"+I)}return n<0&&!d?u=e.negPre+u+e.negSuf:u=e.posPre+u+e.posSuf,u}function Nx(n,e,t,i,r){let o=Bg(e,uc.Currency),s=Fx(o,ii(e,Wt.MinusSign));return s.minFrac=wx(i),s.maxFrac=s.minFrac,Ax(n,s,e,Wt.CurrencyGroup,Wt.CurrencyDecimal,r).replace(mx,t).replace(mx,"").trim()}function Rx(n,e,t){let i=Bg(e,uc.Decimal),r=Fx(i,ii(e,Wt.MinusSign));return Ax(n,r,e,Wt.Group,Wt.Decimal,t)}function Fx(n,e="-"){let t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},i=n.split(JM),r=i[0],o=i[1],s=r.indexOf(sc)!==-1?r.split(sc):[r.substring(0,r.lastIndexOf(tl)+1),r.substring(r.lastIndexOf(tl)+1)],u=s[0],d=s[1]||"";t.posPre=u.substring(0,u.indexOf(kg));for(let h=0;h<d.length;h++){let y=d.charAt(h);y===tl?t.minFrac=t.maxFrac=h+1:y===kg?t.maxFrac=h+1:t.posSuf+=y}let m=u.split(KM);if(t.gSize=m[1]?m[1].length:0,t.lgSize=m[2]||m[1]?(m[2]||m[1]).length:0,o){let h=r.length-t.posPre.length-t.posSuf.length,y=o.indexOf(kg);t.negPre=o.substring(0,y).replace(/'/g,""),t.negSuf=o.slice(y+h).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}function QM(n){if(n.digits[0]===0)return n;let e=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(e===0?n.digits.push(0,0):e===1&&n.digits.push(0),n.integerLen+=2),n}function ZM(n){let e=Math.abs(n)+"",t=0,i,r,o,s,u;for((r=e.indexOf(sc))>-1&&(e=e.replace(sc,"")),(o=e.search(/e/i))>0?(r<0&&(r=o),r+=+e.slice(o+1),e=e.substring(0,o)):r<0&&(r=e.length),o=0;e.charAt(o)===tl;o++);if(o===(u=e.length))i=[0],r=1;else{for(u--;e.charAt(u)===tl;)u--;for(r-=o,i=[],s=0;o<=u;o++,s++)i[s]=Number(e.charAt(o))}return r>cx&&(i=i.splice(0,cx-1),t=r-1,r=1),{digits:i,exponent:t,integerLen:r}}function XM(n,e,t){if(e>t)throw new j(2307,!1);let i=n.digits,r=i.length-n.integerLen,o=Math.min(Math.max(e,r),t),s=o+n.integerLen,u=i[s];if(s>0){i.splice(Math.max(n.integerLen,s));for(let y=s;y<i.length;y++)i[y]=0}else{r=Math.max(0,r),n.integerLen=1,i.length=Math.max(1,s=o+1),i[0]=0;for(let y=1;y<s;y++)i[y]=0}if(u>=5)if(s-1<0){for(let y=0;y>s;y--)i.unshift(0),n.integerLen++;i.unshift(1),n.integerLen++}else i[s-1]++;for(;r<Math.max(0,o);r++)i.push(0);let d=o!==0,m=e+n.integerLen,h=i.reduceRight(function(y,_,C,D){return _=_+y,D[C]=_<10?_:_-10,d&&(D[C]===0&&C>=m?D.pop():d=!1),_>=10?1:0},0);h&&(i.unshift(h),n.integerLen++)}function Vg(n){let e=parseInt(n);if(isNaN(e))throw new j(2305,!1);return e}var Og=/\s+/,px=[],Ug=(()=>{class n{_ngEl;_renderer;initialClasses=px;rawClass;stateMap=new Map;constructor(t,i){this._ngEl=t,this._renderer=i}set klass(t){this.initialClasses=t!=null?t.trim().split(Og):px}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(Og):t}ngDoCheck(){for(let i of this.initialClasses)this._updateState(i,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let i of t)this._updateState(i,!0);else if(t!=null)for(let i of Object.keys(t))this._updateState(i,!!t[i]);this._applyStateDiff()}_updateState(t,i){let r=this.stateMap.get(t);r!==void 0?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){t=t.trim(),t.length>0&&t.split(Og).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static \u0275fac=function(i){return new(i||n)(K(nn),K(Xn))};static \u0275dir=Ne({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return n})();var ac=class{$implicit;ngForOf;index;count;constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},es=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let i=this._viewContainer;t.forEachOperation((r,o,s)=>{if(r.previousIndex==null)i.createEmbeddedView(this._template,new ac(r.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)i.remove(o===null?void 0:o);else if(o!==null){let u=i.get(o);i.move(u,s),fx(u,r)}});for(let r=0,o=i.length;r<o;r++){let u=i.get(r).context;u.index=r,u.count=o,u.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{let o=i.get(r.currentIndex);fx(o,r)})}static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(K(Hi),K(gr),K(Mg))};static \u0275dir=Ne({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function fx(n,e){n.context.$implicit=e.item}var ji=(()=>{class n{_viewContainer;_context=new lc;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,i){this._viewContainer=t,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){gx(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){gx(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(K(Hi),K(gr))};static \u0275dir=Ne({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),lc=class{$implicit=null;ngIf=null};function gx(n,e){if(n&&!n.createEmbeddedView)throw new j(2020,!1)}function $g(n,e){return new j(2100,!1)}var eA="mediumDate",Px=new te(""),kx=new te(""),eo=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(t,i,r){this.locale=t,this.defaultTimezone=i,this.defaultOptions=r}transform(t,i,r,o){if(t==null||t===""||t!==t)return null;try{let s=i??this.defaultOptions?.dateFormat??eA,u=r??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return Tx(t,s,o||this.locale,u)}catch(s){throw $g(n,s.message)}}static \u0275fac=function(i){return new(i||n)(K(Qr,16),K(Px,24),K(kx,24))};static \u0275pipe=za({name:"date",type:n,pure:!0})}return n})();var nl=(()=>{class n{_locale;constructor(t){this._locale=t}transform(t,i,r){if(!Vx(t))return null;r||=this._locale;try{let o=Ox(t);return Rx(o,r,i)}catch(o){throw $g(n,o.message)}}static \u0275fac=function(i){return new(i||n)(K(Qr,16))};static \u0275pipe=za({name:"number",type:n,pure:!0})}return n})();var Hg=(()=>{class n{_locale;_defaultCurrencyCode;constructor(t,i="USD"){this._locale=t,this._defaultCurrencyCode=i}transform(t,i=this._defaultCurrencyCode,r="symbol",o,s){if(!Vx(t))return null;s||=this._locale,typeof r=="boolean"&&(r=r?"symbol":"code");let u=i||this._defaultCurrencyCode;r!=="code"&&(r==="symbol"||r==="symbol-narrow"?u=Dx(u,r==="symbol"?"wide":"narrow",s):u=r);try{let d=Ox(t);return Nx(d,s,u,i,o)}catch(d){throw $g(n,d.message)}}static \u0275fac=function(i){return new(i||n)(K(Qr,16),K(Eg,16))};static \u0275pipe=za({name:"currency",type:n,pure:!0})}return n})();function Vx(n){return!(n==null||n===""||n!==n)}function Ox(n){if(typeof n=="string"&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if(typeof n!="number")throw new j(2309,!1);return n}var re=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=ei({type:n});static \u0275inj=Nn({})}return n})();function il(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let i=t.indexOf("="),[r,o]=i==-1?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(o)}return null}var to=class{};var Lx="browser";var rl=class{_doc;constructor(e){this._doc=e}manager},dc=(()=>{class n extends rl{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r,o){return t.addEventListener(i,r,o),()=>this.removeEventListener(t,i,r,o)}removeEventListener(t,i,r,o){return t.removeEventListener(i,r,o)}static \u0275fac=function(i){return new(i||n)(oe(Nt))};static \u0275prov=J({token:n,factory:n.\u0275fac})}return n})(),mc=new te(""),zg=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,i){this._zone=i,t.forEach(s=>{s.manager=this});let r=t.filter(s=>!(s instanceof dc));this._plugins=r.slice().reverse();let o=t.find(s=>s instanceof dc);o&&this._plugins.push(o)}addEventListener(t,i,r,o){return this._findPluginFor(i).addEventListener(t,i,r,o)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(o=>o.supports(t)),!i)throw new j(5101,!1);return this._eventNameToPlugin.set(t,i),i}static \u0275fac=function(i){return new(i||n)(oe(mc),oe(yt))};static \u0275prov=J({token:n,factory:n.\u0275fac})}return n})(),Gg="ng-app-id";function Bx(n){for(let e of n)e.remove()}function Ux(n,e){let t=e.createElement("style");return t.textContent=n,t}function nA(n,e,t,i){let r=n.head?.querySelectorAll(`style[${Gg}="${e}"],link[${Gg}="${e}"]`);if(r)for(let o of r)o.removeAttribute(Gg),o instanceof HTMLLinkElement?i.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function Wg(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var Yg=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,i,r,o={}){this.doc=t,this.appId=i,this.nonce=r,nA(t,i,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,i){for(let r of t)this.addUsage(r,this.inline,Ux);i?.forEach(r=>this.addUsage(r,this.external,Wg))}removeStyles(t,i){for(let r of t)this.removeUsage(r,this.inline);i?.forEach(r=>this.removeUsage(r,this.external))}addUsage(t,i,r){let o=i.get(t);o?o.usage++:i.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,r(t,this.doc)))})}removeUsage(t,i){let r=i.get(t);r&&(r.usage--,r.usage<=0&&(Bx(r.elements),i.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])Bx(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[i,{elements:r}]of this.inline)r.push(this.addElement(t,Ux(i,this.doc)));for(let[i,{elements:r}]of this.external)r.push(this.addElement(t,Wg(i,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,i){return this.nonce&&i.setAttribute("nonce",this.nonce),t.appendChild(i)}static \u0275fac=function(i){return new(i||n)(oe(Nt),oe(Ad),oe(Rd,8),oe($a))};static \u0275prov=J({token:n,factory:n.\u0275fac})}return n})(),qg={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Jg=/%COMP%/g;var Hx="%COMP%",iA=`_nghost-${Hx}`,rA=`_ngcontent-${Hx}`,oA=!0,sA=new te("",{providedIn:"root",factory:()=>oA});function aA(n){return rA.replace(Jg,n)}function lA(n){return iA.replace(Jg,n)}function Gx(n,e){return e.map(t=>t.replace(Jg,n))}var Kg=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,i,r,o,s,u,d=null,m=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=o,this.doc=s,this.ngZone=u,this.nonce=d,this.tracingService=m,this.platformIsServer=!1,this.defaultRenderer=new ol(t,s,u,this.platformIsServer,this.tracingService)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;let r=this.getOrCreateRenderer(t,i);return r instanceof cc?r.applyToHost(t):r instanceof sl&&r.applyStyles(),r}getOrCreateRenderer(t,i){let r=this.rendererByCompId,o=r.get(i.id);if(!o){let s=this.doc,u=this.ngZone,d=this.eventManager,m=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,y=this.platformIsServer,_=this.tracingService;switch(i.encapsulation){case Bi.Emulated:o=new cc(d,m,i,this.appId,h,s,u,y,_);break;case Bi.ShadowDom:return new jg(d,m,t,i,s,u,this.nonce,y,_);default:o=new sl(d,m,i,h,s,u,y,_);break}r.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(i){return new(i||n)(oe(zg),oe(Yg),oe(Ad),oe(sA),oe(Nt),oe(yt),oe(Rd),oe(Kr,8))};static \u0275prov=J({token:n,factory:n.\u0275fac})}return n})(),ol=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,i,r,o){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.tracingService=o}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(qg[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){($x(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&($x(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){t.remove()}selectRootElement(e,t){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new j(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;let o=qg[r];o?e.setAttributeNS(o,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){let r=qg[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(vi.DashCase|vi.Important)?e.style.setProperty(t,i,r&vi.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&vi.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e!=null&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i,r){if(typeof e=="string"&&(e=$n().getGlobalEventTarget(this.doc,e),!e))throw new j(5102,!1);let o=this.decoratePreventDefault(i);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,r)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function $x(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var jg=class extends ol{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,i,r,o,s,u,d,m){super(e,o,s,d,m),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let h=r.styles;h=Gx(r.id,h);for(let _ of h){let C=document.createElement("style");u&&C.setAttribute("nonce",u),C.textContent=_,this.shadowRoot.appendChild(C)}let y=r.getExternalStyles?.();if(y)for(let _ of y){let C=Wg(_,o);u&&C.setAttribute("nonce",u),this.shadowRoot.appendChild(C)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},sl=class extends ol{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,i,r,o,s,u,d,m){super(e,o,s,u,d),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r;let h=i.styles;this.styles=m?Gx(m,h):h,this.styleUrls=i.getExternalStyles?.(m)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&jr.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},cc=class extends sl{contentAttr;hostAttr;constructor(e,t,i,r,o,s,u,d,m){let h=r+"-"+i.id;super(e,t,i,o,s,u,d,m,h),this.contentAttr=aA(h),this.hostAttr=lA(h)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}};var pc=class n extends Ka{supportsDOMEvents=!0;static makeCurrent(){Ag(new n)}onAndCancel(e,t,i,r){return e.addEventListener(t,i,r),()=>{e.removeEventListener(t,i,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=uA();return t==null?null:dA(t)}resetBaseElement(){al=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return il(document.cookie,e)}},al=null;function uA(){return al=al||document.head.querySelector("base"),al?al.getAttribute("href"):null}function dA(n){return new URL(n,document.baseURI).pathname}var cA=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(i){return new(i||n)};static \u0275prov=J({token:n,factory:n.\u0275fac})}return n})(),qx=["alt","control","meta","shift"],mA={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},pA={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},Wx=(()=>{class n extends rl{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,i,r,o){let s=n.parseEventName(i),u=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>$n().onAndCancel(t,s.domEventName,u,o))}static parseEventName(t){let i=t.toLowerCase().split("."),r=i.shift();if(i.length===0||!(r==="keydown"||r==="keyup"))return null;let o=n._normalizeKey(i.pop()),s="",u=i.indexOf("code");if(u>-1&&(i.splice(u,1),s="code."),qx.forEach(m=>{let h=i.indexOf(m);h>-1&&(i.splice(h,1),s+=m+".")}),s+=o,i.length!=0||o.length===0)return null;let d={};return d.domEventName=r,d.fullKey=s,d}static matchEventFullKeyCode(t,i){let r=mA[t.key]||t.key,o="";return i.indexOf("code.")>-1&&(r=t.code,o="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),qx.forEach(s=>{if(s!==r){let u=pA[s];u(t)&&(o+=s+".")}}),o+=r,o===i)}static eventCallback(t,i,r){return o=>{n.matchEventFullKeyCode(o,t)&&r.runGuarded(()=>i(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(i){return new(i||n)(oe(Nt))};static \u0275prov=J({token:n,factory:n.\u0275fac})}return n})();function Qg(n,e,t){let i=k({rootComponent:n,platformRef:t?.platformRef},fA(e));return ox(i)}function fA(n){return{appProviders:[...vA,...n?.providers??[]],platformProviders:_A}}function gA(){pc.makeCurrent()}function hA(){return new Mn}function yA(){return L0(document),document}var _A=[{provide:$a,useValue:Lx},{provide:Nd,useValue:gA,multi:!0},{provide:Nt,useFactory:yA}];var vA=[{provide:_a,useValue:"root"},{provide:Mn,useFactory:hA},{provide:mc,useClass:dc,multi:!0,deps:[Nt]},{provide:mc,useClass:Wx,multi:!0,deps:[Nt]},Kg,Yg,zg,{provide:zr,useExisting:Kg},{provide:to,useClass:cA},[]];var is=class{},ll=class{},Ot=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let i=t.indexOf(":");if(i>0){let r=t.slice(0,i),o=t.slice(i+1).trim();this.addHeaderEntry(r,o)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.addHeaderEntry(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if(typeof i=="string"&&(i=[i]),i.length===0)return;this.maybeSetNormalizedName(e.name,t);let r=(e.op==="a"?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":let o=e.value;if(!o)this.headers.delete(t),this.normalizedNames.delete(t);else{let s=this.headers.get(t);if(!s)return;s=s.filter(u=>o.indexOf(u)===-1),s.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,s)}break}}addHeaderEntry(e,t){let i=e.toLowerCase();this.maybeSetNormalizedName(e,i),this.headers.has(i)?this.headers.get(i).push(t):this.headers.set(i,[t])}setHeaderEntries(e,t){let i=(Array.isArray(t)?t:[t]).map(o=>o.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var gc=class{encodeKey(e){return jx(e)}encodeValue(e){return jx(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function CA(n,e){let t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{let o=r.indexOf("="),[s,u]=o==-1?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,o)),e.decodeValue(r.slice(o+1))],d=t.get(s)||[];d.push(u),t.set(s,d)}),t}var xA=/%(\d[a-f0-9])/gi,EA={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function jx(n){return encodeURIComponent(n).replace(xA,(e,t)=>EA[t]??e)}function fc(n){return`${n}`}var Se=class n{map;encoder;updates=null;cloneFrom=null;constructor(e={}){if(this.encoder=e.encoder||new gc,e.fromString){if(e.fromObject)throw new j(2805,!1);this.map=CA(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let i=e.fromObject[t],r=Array.isArray(i)?i.map(fc):[fc(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(i=>{let r=e[i];Array.isArray(r)?r.forEach(o=>{t.push({param:i,value:o,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new n({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(fc(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let i=this.map.get(e.param)||[],r=i.indexOf(fc(e.value));r!==-1&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var hc=class{map=new Map;set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function bA(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function zx(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function Yx(n){return typeof Blob<"u"&&n instanceof Blob}function Jx(n){return typeof FormData<"u"&&n instanceof FormData}function SA(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var Kx="Content-Type",Qx="Accept",Xx="X-Request-URL",eE="text/plain",tE="application/json",DA=`${tE}, ${eE}, */*`,ts=class n{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;credentials;keepalive=!1;cache;priority;mode;redirect;referrer;integrity;responseType="json";method;params;urlWithParams;transferCache;timeout;constructor(e,t,i,r){this.url=t,this.method=e.toUpperCase();let o;if(bA(this.method)||r?(this.body=i!==void 0?i:null,o=r):o=i,o){if(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,this.keepalive=!!o.keepalive,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params),o.priority&&(this.priority=o.priority),o.cache&&(this.cache=o.cache),o.credentials&&(this.credentials=o.credentials),typeof o.timeout=="number"){if(o.timeout<1||!Number.isInteger(o.timeout))throw new j(2822,"");this.timeout=o.timeout}o.mode&&(this.mode=o.mode),o.redirect&&(this.redirect=o.redirect),o.integrity&&(this.integrity=o.integrity),o.referrer&&(this.referrer=o.referrer),this.transferCache=o.transferCache}if(this.headers??=new Ot,this.context??=new hc,!this.params)this.params=new Se,this.urlWithParams=t;else{let s=this.params.toString();if(s.length===0)this.urlWithParams=t;else{let u=t.indexOf("?"),d=u===-1?"?":u<t.length-1?"&":"";this.urlWithParams=t+d+s}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||zx(this.body)||Yx(this.body)||Jx(this.body)||SA(this.body)?this.body:this.body instanceof Se?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||Jx(this.body)?null:Yx(this.body)?this.body.type||null:zx(this.body)?null:typeof this.body=="string"?eE:this.body instanceof Se?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?tE:null}clone(e={}){let t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,o=e.keepalive??this.keepalive,s=e.priority||this.priority,u=e.cache||this.cache,d=e.mode||this.mode,m=e.redirect||this.redirect,h=e.credentials||this.credentials,y=e.referrer||this.referrer,_=e.integrity||this.integrity,C=e.transferCache??this.transferCache,D=e.timeout??this.timeout,I=e.body!==void 0?e.body:this.body,R=e.withCredentials??this.withCredentials,F=e.reportProgress??this.reportProgress,$=e.headers||this.headers,G=e.params||this.params,Y=e.context??this.context;return e.setHeaders!==void 0&&($=Object.keys(e.setHeaders).reduce((ne,de)=>ne.set(de,e.setHeaders[de]),$)),e.setParams&&(G=Object.keys(e.setParams).reduce((ne,de)=>ne.set(de,e.setParams[de]),G)),new n(t,i,I,{params:G,headers:$,context:Y,reportProgress:F,responseType:r,withCredentials:R,transferCache:C,keepalive:o,cache:u,priority:s,timeout:D,mode:d,redirect:m,credentials:h,referrer:y,integrity:_})}},no=(function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n})(no||{}),rs=class{headers;status;statusText;url;ok;type;redirected;constructor(e,t=200,i="OK"){this.headers=e.headers||new Ot,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.redirected=e.redirected,this.ok=this.status>=200&&this.status<300}},yc=class n extends rs{constructor(e={}){super(e)}type=no.ResponseHeader;clone(e={}){return new n({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},ul=class n extends rs{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=no.Response;clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0,redirected:e.redirected??this.redirected})}},ns=class extends rs{name="HttpErrorResponse";message;error;ok=!1;constructor(e){super(e,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},wA=200,TA=204;function Zg(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,credentials:n.credentials,transferCache:n.transferCache,timeout:n.timeout,keepalive:n.keepalive,priority:n.priority,cache:n.cache,mode:n.mode,redirect:n.redirect,integrity:n.integrity,referrer:n.referrer}}var Qt=(()=>{class n{handler;constructor(t){this.handler=t}request(t,i,r={}){let o;if(t instanceof ts)o=t;else{let d;r.headers instanceof Ot?d=r.headers:d=new Ot(r.headers);let m;r.params&&(r.params instanceof Se?m=r.params:m=new Se({fromObject:r.params})),o=new ts(t,i,r.body!==void 0?r.body:null,{headers:d,context:r.context,params:m,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials,transferCache:r.transferCache,keepalive:r.keepalive,priority:r.priority,cache:r.cache,mode:r.mode,redirect:r.redirect,credentials:r.credentials,referrer:r.referrer,integrity:r.integrity,timeout:r.timeout})}let s=ue(o).pipe(Ai(d=>this.handler.handle(d)));if(t instanceof ts||r.observe==="events")return s;let u=s.pipe(It(d=>d instanceof ul));switch(r.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return u.pipe(he(d=>{if(d.body!==null&&!(d.body instanceof ArrayBuffer))throw new j(2806,!1);return d.body}));case"blob":return u.pipe(he(d=>{if(d.body!==null&&!(d.body instanceof Blob))throw new j(2807,!1);return d.body}));case"text":return u.pipe(he(d=>{if(d.body!==null&&typeof d.body!="string")throw new j(2808,!1);return d.body}));case"json":default:return u.pipe(he(d=>d.body))}case"response":return u;default:throw new j(2809,!1)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:new Se().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,Zg(r,i))}post(t,i,r={}){return this.request("POST",t,Zg(r,i))}put(t,i,r={}){return this.request("PUT",t,Zg(r,i))}static \u0275fac=function(i){return new(i||n)(oe(is))};static \u0275prov=J({token:n,factory:n.\u0275fac})}return n})();var IA=new te("");function nE(n,e){return e(n)}function MA(n,e){return(t,i)=>e.intercept(t,{handle:r=>n(r,i)})}function AA(n,e,t){return(i,r)=>At(t,()=>e(i,o=>n(o,r)))}var vc=new te(""),eh=new te(""),iE=new te(""),th=new te("",{providedIn:"root",factory:()=>!0});function NA(){let n=null;return(e,t)=>{n===null&&(n=(P(vc,{optional:!0})??[]).reduceRight(MA,nE));let i=P(Wo);if(P(th)){let o=i.add();return n(e,t).pipe(tr(o))}else return n(e,t)}}var _c=(()=>{class n extends is{backend;injector;chain=null;pendingTasks=P(Wo);contributeToStability=P(th);constructor(t,i){super(),this.backend=t,this.injector=i}handle(t){if(this.chain===null){let i=Array.from(new Set([...this.injector.get(eh),...this.injector.get(iE,[])]));this.chain=i.reduceRight((r,o)=>AA(r,o,this.injector),nE)}if(this.contributeToStability){let i=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(tr(i))}else return this.chain(t,i=>this.backend.handle(i))}static \u0275fac=function(i){return new(i||n)(oe(ll),oe(Et))};static \u0275prov=J({token:n,factory:n.\u0275fac})}return n})();var RA=/^\)\]\}',?\n/,FA=RegExp(`^${Xx}:`,"m");function PA(n){return"responseURL"in n&&n.responseURL?n.responseURL:FA.test(n.getAllResponseHeaders())?n.getResponseHeader(Xx):null}var Xg=(()=>{class n{xhrFactory;constructor(t){this.xhrFactory=t}handle(t){if(t.method==="JSONP")throw new j(-2800,!1);let i=this.xhrFactory;return ue(null).pipe(Yt(()=>new Te(o=>{let s=i.build();if(s.open(t.method,t.urlWithParams),t.withCredentials&&(s.withCredentials=!0),t.headers.forEach((R,F)=>s.setRequestHeader(R,F.join(","))),t.headers.has(Qx)||s.setRequestHeader(Qx,DA),!t.headers.has(Kx)){let R=t.detectContentTypeHeader();R!==null&&s.setRequestHeader(Kx,R)}if(t.timeout&&(s.timeout=t.timeout),t.responseType){let R=t.responseType.toLowerCase();s.responseType=R!=="json"?R:"text"}let u=t.serializeBody(),d=null,m=()=>{if(d!==null)return d;let R=s.statusText||"OK",F=new Ot(s.getAllResponseHeaders()),$=PA(s)||t.url;return d=new yc({headers:F,status:s.status,statusText:R,url:$}),d},h=()=>{let{headers:R,status:F,statusText:$,url:G}=m(),Y=null;F!==TA&&(Y=typeof s.response>"u"?s.responseText:s.response),F===0&&(F=Y?wA:0);let ne=F>=200&&F<300;if(t.responseType==="json"&&typeof Y=="string"){let de=Y;Y=Y.replace(RA,"");try{Y=Y!==""?JSON.parse(Y):null}catch(le){Y=de,ne&&(ne=!1,Y={error:le,text:Y})}}ne?(o.next(new ul({body:Y,headers:R,status:F,statusText:$,url:G||void 0})),o.complete()):o.error(new ns({error:Y,headers:R,status:F,statusText:$,url:G||void 0}))},y=R=>{let{url:F}=m(),$=new ns({error:R,status:s.status||0,statusText:s.statusText||"Unknown Error",url:F||void 0});o.error($)},_=y;t.timeout&&(_=R=>{let{url:F}=m(),$=new ns({error:new DOMException("Request timed out","TimeoutError"),status:s.status||0,statusText:s.statusText||"Request timeout",url:F||void 0});o.error($)});let C=!1,D=R=>{C||(o.next(m()),C=!0);let F={type:no.DownloadProgress,loaded:R.loaded};R.lengthComputable&&(F.total=R.total),t.responseType==="text"&&s.responseText&&(F.partialText=s.responseText),o.next(F)},I=R=>{let F={type:no.UploadProgress,loaded:R.loaded};R.lengthComputable&&(F.total=R.total),o.next(F)};return s.addEventListener("load",h),s.addEventListener("error",y),s.addEventListener("timeout",_),s.addEventListener("abort",y),t.reportProgress&&(s.addEventListener("progress",D),u!==null&&s.upload&&s.upload.addEventListener("progress",I)),s.send(u),o.next({type:no.Sent}),()=>{s.removeEventListener("error",y),s.removeEventListener("abort",y),s.removeEventListener("load",h),s.removeEventListener("timeout",_),t.reportProgress&&(s.removeEventListener("progress",D),u!==null&&s.upload&&s.upload.removeEventListener("progress",I)),s.readyState!==s.DONE&&s.abort()}})))}static \u0275fac=function(i){return new(i||n)(oe(to))};static \u0275prov=J({token:n,factory:n.\u0275fac})}return n})(),rE=new te(""),kA="XSRF-TOKEN",VA=new te("",{providedIn:"root",factory:()=>kA}),OA="X-XSRF-TOKEN",LA=new te("",{providedIn:"root",factory:()=>OA}),dl=class{},BA=(()=>{class n{doc;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(t,i){this.doc=t,this.cookieName=i}getToken(){let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=il(t,this.cookieName),this.lastCookieString=t),this.lastToken}static \u0275fac=function(i){return new(i||n)(oe(Nt),oe(VA))};static \u0275prov=J({token:n,factory:n.\u0275fac})}return n})(),UA=/^(?:https?:)?\/\//i;function $A(n,e){if(!P(rE)||n.method==="GET"||n.method==="HEAD"||UA.test(n.url))return e(n);let t=P(dl).getToken(),i=P(LA);return t!=null&&!n.headers.has(i)&&(n=n.clone({headers:n.headers.set(i,t)})),e(n)}var nh=(function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n})(nh||{});function HA(n,e){return{\u0275kind:n,\u0275providers:e}}function ih(...n){let e=[Qt,Xg,_c,{provide:is,useExisting:_c},{provide:ll,useFactory:()=>P(IA,{optional:!0})??P(Xg)},{provide:eh,useValue:$A,multi:!0},{provide:rE,useValue:!0},{provide:dl,useClass:BA}];for(let t of n)e.push(...t.\u0275providers);return kr(e)}var Zx=new te("");function rh(){return HA(nh.LegacyInterceptors,[{provide:Zx,useFactory:NA},{provide:eh,useExisting:Zx,multi:!0}])}var oE=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(i){return new(i||n)(oe(Nt))};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var ve="primary",Dl=Symbol("RouteTitle"),dh=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function oo(n){return new dh(n)}function pE(n,e,t){let i=t.path.split("/");if(i.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||i.length<n.length))return null;let r={};for(let o=0;o<i.length;o++){let s=i[o],u=n[o];if(s[0]===":")r[s.substring(1)]=u;else if(s!==u.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function qA(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Ei(n[t],e[t]))return!1;return!0}function Ei(n,e){let t=n?ch(n):void 0,i=e?ch(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let o=0;o<t.length;o++)if(r=t[o],!fE(n[r],e[r]))return!1;return!0}function ch(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function fE(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),i=[...e].sort();return t.every((r,o)=>i[o]===r)}else return n===e}function gE(n){return n.length>0?n[n.length-1]:null}function Ji(n){return Hp(n)?n:hr(n)?ot(Promise.resolve(n)):ue(n)}var WA={exact:yE,subset:_E},hE={exact:jA,subset:zA,ignored:()=>!0};function sE(n,e,t){return WA[t.paths](n.root,e.root,t.matrixParams)&&hE[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function jA(n,e){return Ei(n,e)}function yE(n,e,t){if(!io(n.segments,e.segments)||!Ec(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let i in e.children)if(!n.children[i]||!yE(n.children[i],e.children[i],t))return!1;return!0}function zA(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>fE(n[t],e[t]))}function _E(n,e,t){return vE(n,e,e.segments,t)}function vE(n,e,t,i){if(n.segments.length>t.length){let r=n.segments.slice(0,t.length);return!(!io(r,t)||e.hasChildren()||!Ec(r,t,i))}else if(n.segments.length===t.length){if(!io(n.segments,t)||!Ec(n.segments,t,i))return!1;for(let r in e.children)if(!n.children[r]||!_E(n.children[r],e.children[r],i))return!1;return!0}else{let r=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!io(n.segments,r)||!Ec(n.segments,r,i)||!n.children[ve]?!1:vE(n.children[ve],e,o,i)}}function Ec(n,e,t){return e.every((i,r)=>hE[t](n[r].parameters,i.parameters))}var Si=class{root;queryParams;fragment;_queryParamMap;constructor(e=new qe([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=oo(this.queryParams),this._queryParamMap}toString(){return KA.serialize(this)}},qe=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return bc(this)}},_r=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=oo(this.parameters),this._parameterMap}toString(){return xE(this)}};function YA(n,e){return io(n,e)&&n.every((t,i)=>Ei(t.parameters,e[i].parameters))}function io(n,e){return n.length!==e.length?!1:n.every((t,i)=>t.path===e[i].path)}function JA(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===ve&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==ve&&(t=t.concat(e(r,i)))}),t}var wl=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=J({token:n,factory:()=>new so,providedIn:"root"})}return n})(),so=class{parse(e){let t=new ph(e);return new Si(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${cl(e.root,!0)}`,i=XA(e.queryParams),r=typeof e.fragment=="string"?`#${QA(e.fragment)}`:"";return`${t}${i}${r}`}},KA=new so;function bc(n){return n.segments.map(e=>xE(e)).join("/")}function cl(n,e){if(!n.hasChildren())return bc(n);if(e){let t=n.children[ve]?cl(n.children[ve],!1):"",i=[];return Object.entries(n.children).forEach(([r,o])=>{r!==ve&&i.push(`${r}:${cl(o,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}else{let t=JA(n,(i,r)=>r===ve?[cl(n.children[ve],!1)]:[`${r}:${cl(i,!1)}`]);return Object.keys(n.children).length===1&&n.children[ve]!=null?`${bc(n)}/${t[0]}`:`${bc(n)}/(${t.join("//")})`}}function CE(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Cc(n){return CE(n).replace(/%3B/gi,";")}function QA(n){return encodeURI(n)}function mh(n){return CE(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Sc(n){return decodeURIComponent(n)}function aE(n){return Sc(n.replace(/\+/g,"%20"))}function xE(n){return`${mh(n.path)}${ZA(n.parameters)}`}function ZA(n){return Object.entries(n).map(([e,t])=>`;${mh(e)}=${mh(t)}`).join("")}function XA(n){let e=Object.entries(n).map(([t,i])=>Array.isArray(i)?i.map(r=>`${Cc(t)}=${Cc(r)}`).join("&"):`${Cc(t)}=${Cc(i)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var e5=/^[^\/()?;#]+/;function sh(n){let e=n.match(e5);return e?e[0]:""}var t5=/^[^\/()?;=#]+/;function n5(n){let e=n.match(t5);return e?e[0]:""}var i5=/^[^=?&#]+/;function r5(n){let e=n.match(i5);return e?e[0]:""}var o5=/^[^&#]+/;function s5(n){let e=n.match(o5);return e?e[0]:""}var ph=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new qe([],{}):new qe([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[ve]=new qe(e,t)),i}parseSegment(){let e=sh(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new j(4009,!1);return this.capture(e),new _r(Sc(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=n5(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let r=sh(this.remaining);r&&(i=r,this.capture(i))}e[Sc(t)]=Sc(i)}parseQueryParam(e){let t=r5(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let s=s5(this.remaining);s&&(i=s,this.capture(i))}let r=aE(t),o=aE(i);if(e.hasOwnProperty(r)){let s=e[r];Array.isArray(s)||(s=[s],e[r]=s),s.push(o)}else e[r]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=sh(this.remaining),r=this.remaining[i.length];if(r!=="/"&&r!==")"&&r!==";")throw new j(4010,!1);let o;i.indexOf(":")>-1?(o=i.slice(0,i.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=ve);let s=this.parseChildren();t[o??ve]=Object.keys(s).length===1&&s[ve]?s[ve]:new qe([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new j(4011,!1)}};function EE(n){return n.segments.length>0?new qe([],{[ve]:n}):n}function bE(n){let e={};for(let[i,r]of Object.entries(n.children)){let o=bE(r);if(i===ve&&o.segments.length===0&&o.hasChildren())for(let[s,u]of Object.entries(o.children))e[s]=u;else(o.segments.length>0||o.hasChildren())&&(e[i]=o)}let t=new qe(n.segments,e);return a5(t)}function a5(n){if(n.numberOfChildren===1&&n.children[ve]){let e=n.children[ve];return new qe(n.segments.concat(e.segments),e.children)}return n}function vr(n){return n instanceof Si}function SE(n,e,t=null,i=null){let r=DE(n);return wE(r,e,t,i)}function DE(n){let e;function t(o){let s={};for(let d of o.children){let m=t(d);s[d.outlet]=m}let u=new qe(o.url,s);return o===n&&(e=u),u}let i=t(n.root),r=EE(i);return e??r}function wE(n,e,t,i){let r=n;for(;r.parent;)r=r.parent;if(e.length===0)return ah(r,r,r,t,i);let o=l5(e);if(o.toRoot())return ah(r,r,new qe([],{}),t,i);let s=u5(o,r,n),u=s.processChildren?pl(s.segmentGroup,s.index,o.commands):IE(s.segmentGroup,s.index,o.commands);return ah(r,s.segmentGroup,u,t,i)}function Dc(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function hl(n){return typeof n=="object"&&n!=null&&n.outlets}function ah(n,e,t,i,r){let o={};i&&Object.entries(i).forEach(([d,m])=>{o[d]=Array.isArray(m)?m.map(h=>`${h}`):`${m}`});let s;n===e?s=t:s=TE(n,e,t);let u=EE(bE(s));return new Si(u,o,r)}function TE(n,e,t){let i={};return Object.entries(n.children).forEach(([r,o])=>{o===e?i[r]=t:i[r]=TE(o,e,t)}),new qe(n.segments,i)}var wc=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Dc(i[0]))throw new j(4003,!1);let r=i.find(hl);if(r&&r!==gE(i))throw new j(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function l5(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new wc(!0,0,n);let e=0,t=!1,i=n.reduce((r,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let u={};return Object.entries(o.outlets).forEach(([d,m])=>{u[d]=typeof m=="string"?m.split("/"):m}),[...r,{outlets:u}]}if(o.segmentPath)return[...r,o.segmentPath]}return typeof o!="string"?[...r,o]:s===0?(o.split("/").forEach((u,d)=>{d==0&&u==="."||(d==0&&u===""?t=!0:u===".."?e++:u!=""&&r.push(u))}),r):[...r,o]},[]);return new wc(t,e,i)}var as=class{segmentGroup;processChildren;index;constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}};function u5(n,e,t){if(n.isAbsolute)return new as(e,!0,0);if(!t)return new as(e,!1,NaN);if(t.parent===null)return new as(t,!0,0);let i=Dc(n.commands[0])?0:1,r=t.segments.length-1+i;return d5(t,r,n.numberOfDoubleDots)}function d5(n,e,t){let i=n,r=e,o=t;for(;o>r;){if(o-=r,i=i.parent,!i)throw new j(4005,!1);r=i.segments.length}return new as(i,!1,r-o)}function c5(n){return hl(n[0])?n[0].outlets:{[ve]:n}}function IE(n,e,t){if(n??=new qe([],{}),n.segments.length===0&&n.hasChildren())return pl(n,e,t);let i=m5(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){let o=new qe(n.segments.slice(0,i.pathIndex),{});return o.children[ve]=new qe(n.segments.slice(i.pathIndex),n.children),pl(o,0,r)}else return i.match&&r.length===0?new qe(n.segments,{}):i.match&&!n.hasChildren()?fh(n,e,t):i.match?pl(n,0,r):fh(n,e,t)}function pl(n,e,t){if(t.length===0)return new qe(n.segments,{});{let i=c5(t),r={};if(Object.keys(i).some(o=>o!==ve)&&n.children[ve]&&n.numberOfChildren===1&&n.children[ve].segments.length===0){let o=pl(n.children[ve],e,t);return new qe(n.segments,o.children)}return Object.entries(i).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(r[o]=IE(n.children[o],e,s))}),Object.entries(n.children).forEach(([o,s])=>{i[o]===void 0&&(r[o]=s)}),new qe(n.segments,r)}}function m5(n,e,t){let i=0,r=e,o={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return o;let s=n.segments[r],u=t[i];if(hl(u))break;let d=`${u}`,m=i<t.length-1?t[i+1]:null;if(r>0&&d===void 0)break;if(d&&m&&typeof m=="object"&&m.outlets===void 0){if(!uE(d,m,s))return o;i+=2}else{if(!uE(d,{},s))return o;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}function fh(n,e,t){let i=n.segments.slice(0,e),r=0;for(;r<t.length;){let o=t[r];if(hl(o)){let d=p5(o.outlets);return new qe(i,d)}if(r===0&&Dc(t[0])){let d=n.segments[e];i.push(new _r(d.path,lE(t[0]))),r++;continue}let s=hl(o)?o.outlets[ve]:`${o}`,u=r<t.length-1?t[r+1]:null;s&&u&&Dc(u)?(i.push(new _r(s,lE(u))),r+=2):(i.push(new _r(s,{})),r++)}return new qe(i,{})}function p5(n){let e={};return Object.entries(n).forEach(([t,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(e[t]=fh(new qe([],{}),0,i))}),e}function lE(n){let e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function uE(n,e,t){return n==t.path&&Ei(e,t.parameters)}var fl="imperative",Lt=(function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n})(Lt||{}),Tn=class{id;url;constructor(e,t){this.id=e,this.url=t}},ao=class extends Tn{type=Lt.NavigationStart;navigationTrigger;restoredState;constructor(e,t,i="imperative",r=null){super(e,t),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},In=class extends Tn{urlAfterRedirects;type=Lt.NavigationEnd;constructor(e,t,i){super(e,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},ln=(function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n[n.Aborted=4]="Aborted",n})(ln||{}),yl=(function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n})(yl||{}),bi=class extends Tn{reason;code;type=Lt.NavigationCancel;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Yi=class extends Tn{reason;code;type=Lt.NavigationSkipped;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}},us=class extends Tn{error;target;type=Lt.NavigationError;constructor(e,t,i,r){super(e,t),this.error=i,this.target=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},_l=class extends Tn{urlAfterRedirects;state;type=Lt.RoutesRecognized;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Tc=class extends Tn{urlAfterRedirects;state;type=Lt.GuardsCheckStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ic=class extends Tn{urlAfterRedirects;state;shouldActivate;type=Lt.GuardsCheckEnd;constructor(e,t,i,r,o){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Mc=class extends Tn{urlAfterRedirects;state;type=Lt.ResolveStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ac=class extends Tn{urlAfterRedirects;state;type=Lt.ResolveEnd;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Nc=class{route;type=Lt.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Rc=class{route;type=Lt.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Fc=class{snapshot;type=Lt.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Pc=class{snapshot;type=Lt.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},kc=class{snapshot;type=Lt.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Vc=class{snapshot;type=Lt.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var vl=class{},ds=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function f5(n){return!(n instanceof vl)&&!(n instanceof ds)}function g5(n,e){return n.providers&&!n._injector&&(n._injector=ja(n.providers,e,`Route: ${n.path}`)),n._injector??e}function ri(n){return n.outlet||ve}function h5(n,e){let t=n.filter(i=>ri(i)===e);return t.push(...n.filter(i=>ri(i)!==e)),t}function ps(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Oc=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return ps(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new fs(this.rootInjector)}},fs=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,i){let r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){let i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new Oc(this.rootInjector),this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(i){return new(i||n)(oe(Et))};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Lc=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=gh(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){let t=gh(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=hh(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return hh(e,this._root).map(t=>t.value)}};function gh(n,e){if(n===e.value)return e;for(let t of e.children){let i=gh(n,t);if(i)return i}return null}function hh(n,e){if(n===e.value)return[e];for(let t of e.children){let i=hh(n,t);if(i.length)return i.unshift(e),i}return[]}var wn=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function ss(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Cl=class extends Lc{snapshot;constructor(e,t){super(e),this.snapshot=t,Sh(this,e)}toString(){return this.snapshot.toString()}};function ME(n){let e=y5(n),t=new Bt([new _r("",{})]),i=new Bt({}),r=new Bt({}),o=new Bt({}),s=new Bt(""),u=new un(t,i,o,s,r,ve,n,e.root);return u.snapshot=e.root,new Cl(new wn(u,[]),e)}function y5(n){let e={},t={},i={},o=new ro([],e,i,"",t,ve,n,null,{});return new xl("",new wn(o,[]))}var un=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,i,r,o,s,u,d){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=o,this.outlet=s,this.component=u,this._futureSnapshot=d,this.title=this.dataSubject?.pipe(he(m=>m[Dl]))??ue(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(he(e=>oo(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(he(e=>oo(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Bc(n,e,t="emptyOnly"){let i,{routeConfig:r}=n;return e!==null&&(t==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?i={params:k(k({},e.params),n.params),data:k(k({},e.data),n.data),resolve:k(k(k(k({},n.data),e.data),r?.data),n._resolvedData)}:i={params:k({},n.params),data:k({},n.data),resolve:k(k({},n.data),n._resolvedData??{})},r&&NE(r)&&(i.resolve[Dl]=r.title),i}var ro=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Dl]}constructor(e,t,i,r,o,s,u,d,m){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o,this.outlet=s,this.component=u,this.routeConfig=d,this._resolve=m}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=oo(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=oo(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(i=>i.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},xl=class extends Lc{url;constructor(e,t){super(t),this.url=e,Sh(this,t)}toString(){return AE(this._root)}};function Sh(n,e){e.value._routerState=n,e.children.forEach(t=>Sh(n,t))}function AE(n){let e=n.children.length>0?` { ${n.children.map(AE).join(", ")} } `:"";return`${n.value}${e}`}function lh(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Ei(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Ei(e.params,t.params)||n.paramsSubject.next(t.params),qA(e.url,t.url)||n.urlSubject.next(t.url),Ei(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function yh(n,e){let t=Ei(n.params,e.params)&&YA(n.url,e.url),i=!n.parent!=!e.parent;return t&&!i&&(!n.parent||yh(n.parent,e.parent))}function NE(n){return typeof n.title=="string"||n.title===null}var RE=new te(""),Tl=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=ve;activateEvents=new at;deactivateEvents=new at;attachEvents=new at;detachEvents=new at;routerOutletData=Qd();parentContexts=P(fs);location=P(Hi);changeDetector=P(yr);inputBinder=P(Gc,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new j(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new j(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new j(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new j(4013,!1);this._activatedRoute=t;let r=this.location,s=t.snapshot.component,u=this.parentContexts.getOrCreateContext(this.name).children,d=new _h(t,u,r.injector,this.routerOutletData);this.activated=r.createComponent(s,{index:r.length,injector:d,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(i){return new(i||n)};static \u0275dir=Ne({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Bn]})}return n})(),_h=class{route;childContexts;parent;outletData;constructor(e,t,i,r){this.route=e,this.childContexts=t,this.parent=i,this.outletData=r}get(e,t){return e===un?this.route:e===fs?this.childContexts:e===RE?this.outletData:this.parent.get(e,t)}},Gc=new te("");var Dh=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=ie({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(i,r){i&1&&x(0,"router-outlet")},dependencies:[Tl],encapsulation:2})}return n})();function wh(n){let e=n.children&&n.children.map(wh),t=e?q(k({},n),{children:e}):k({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==ve&&(t.component=Dh),t}function _5(n,e,t){let i=El(n,e._root,t?t._root:void 0);return new Cl(i,e)}function El(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let i=t.value;i._futureSnapshot=e.value;let r=v5(n,e,t);return new wn(i,r)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(u=>El(n,u)),s}}let i=C5(e.value),r=e.children.map(o=>El(n,o));return new wn(i,r)}}function v5(n,e,t){return e.children.map(i=>{for(let r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return El(n,i,r);return El(n,i)})}function C5(n){return new un(new Bt(n.url),new Bt(n.params),new Bt(n.queryParams),new Bt(n.fragment),new Bt(n.data),n.outlet,n.component,n)}var cs=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},FE="ngNavigationCancelingError";function Uc(n,e){let{redirectTo:t,navigationBehaviorOptions:i}=vr(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=PE(!1,ln.Redirect);return r.url=t,r.navigationBehaviorOptions=i,r}function PE(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[FE]=!0,t.cancellationCode=e,t}function x5(n){return kE(n)&&vr(n.url)}function kE(n){return!!n&&n[FE]}var E5=(n,e,t,i)=>he(r=>(new vh(e,r.targetRouterState,r.currentRouterState,t,i).activate(n),r)),vh=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,i,r,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),lh(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){let r=ss(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,r[s],i),delete r[s]}),Object.values(r).forEach(o=>{this.deactivateRouteAndItsChildren(o,i)})}deactivateRoutes(e,t,i){let r=e.value,o=t?t.value:null;if(r===o)if(r.component){let s=i.getContext(r.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,i);else o&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=ss(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);if(i&&i.outlet){let s=i.outlet.detach(),u=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:u})}}deactivateRouteAndOutlet(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=ss(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){let r=ss(t);e.children.forEach(o=>{this.activateRoutes(o,r[o.value.outlet],i),this.forwardEvent(new Vc(o.value.snapshot))}),e.children.length&&this.forwardEvent(new Pc(e.value.snapshot))}activateRoutes(e,t,i){let r=e.value,o=t?t.value:null;if(lh(r),r===o)if(r.component){let s=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,i);else if(r.component){let s=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let u=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),s.children.onOutletReAttached(u.contexts),s.attachRef=u.componentRef,s.route=u.route.value,s.outlet&&s.outlet.attach(u.componentRef,u.route.value),lh(u.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=r,s.outlet&&s.outlet.activateWith(r,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,i)}},$c=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},ls=class{component;route;constructor(e,t){this.component=e,this.route=t}};function b5(n,e,t){let i=n._root,r=e?e._root:null;return ml(i,r,t,[i.value])}function S5(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function gs(n,e){let t=Symbol(),i=e.get(n,t);return i===t?typeof n=="function"&&!of(n)?n:e.get(n):i}function ml(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=ss(e);return n.children.forEach(s=>{D5(s,o[s.value.outlet],t,i.concat([s.value]),r),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,u])=>gl(u,t.getContext(s),r)),r}function D5(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,s=e?e.value:null,u=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let d=w5(s,o,o.routeConfig.runGuardsAndResolvers);d?r.canActivateChecks.push(new $c(i)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?ml(n,e,u?u.children:null,i,r):ml(n,e,t,i,r),d&&u&&u.outlet&&u.outlet.isActivated&&r.canDeactivateChecks.push(new ls(u.outlet.component,s))}else s&&gl(e,u,r),r.canActivateChecks.push(new $c(i)),o.component?ml(n,null,u?u.children:null,i,r):ml(n,null,t,i,r);return r}function w5(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!io(n.url,e.url);case"pathParamsOrQueryParamsChange":return!io(n.url,e.url)||!Ei(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!yh(n,e)||!Ei(n.queryParams,e.queryParams);case"paramsChange":default:return!yh(n,e)}}function gl(n,e,t){let i=ss(n),r=n.value;Object.entries(i).forEach(([o,s])=>{r.component?e?gl(s,e.children.getContext(o),t):gl(s,null,t):gl(s,e,t)}),r.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new ls(e.outlet.component,r)):t.canDeactivateChecks.push(new ls(null,r)):t.canDeactivateChecks.push(new ls(null,r))}function Il(n){return typeof n=="function"}function T5(n){return typeof n=="boolean"}function I5(n){return n&&Il(n.canLoad)}function M5(n){return n&&Il(n.canActivate)}function A5(n){return n&&Il(n.canActivateChild)}function N5(n){return n&&Il(n.canDeactivate)}function R5(n){return n&&Il(n.canMatch)}function VE(n){return n instanceof Wn||n?.name==="EmptyError"}var xc=Symbol("INITIAL_VALUE");function ms(){return Yt(n=>Au(n.map(e=>e.pipe(Ni(1),jp(xc)))).pipe(he(e=>{for(let t of e)if(t!==!0){if(t===xc)return xc;if(t===!1||F5(t))return t}return!0}),It(e=>e!==xc),Ni(1)))}function F5(n){return vr(n)||n instanceof cs}function P5(n,e){return xt(t=>{let{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return s.length===0&&o.length===0?ue(q(k({},t),{guardsResult:!0})):k5(s,i,r,n).pipe(xt(u=>u&&T5(u)?V5(i,o,n,e):ue(u)),he(u=>q(k({},t),{guardsResult:u})))})}function k5(n,e,t,i){return ot(n).pipe(xt(r=>$5(r.component,r.route,t,e,i)),Ri(r=>r!==!0,!0))}function V5(n,e,t,i){return ot(e).pipe(Ai(r=>Fo(L5(r.route.parent,i),O5(r.route,i),U5(n,r.path,t),B5(n,r.route,t))),Ri(r=>r!==!0,!0))}function O5(n,e){return n!==null&&e&&e(new kc(n)),ue(!0)}function L5(n,e){return n!==null&&e&&e(new Fc(n)),ue(!0)}function B5(n,e,t){let i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||i.length===0)return ue(!0);let r=i.map(o=>ca(()=>{let s=ps(e)??t,u=gs(o,s),d=M5(u)?u.canActivate(e,n):At(s,()=>u(e,n));return Ji(d).pipe(Ri())}));return ue(r).pipe(ms())}function U5(n,e,t){let i=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>S5(s)).filter(s=>s!==null).map(s=>ca(()=>{let u=s.guards.map(d=>{let m=ps(s.node)??t,h=gs(d,m),y=A5(h)?h.canActivateChild(i,n):At(m,()=>h(i,n));return Ji(y).pipe(Ri())});return ue(u).pipe(ms())}));return ue(o).pipe(ms())}function $5(n,e,t,i,r){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return ue(!0);let s=o.map(u=>{let d=ps(e)??r,m=gs(u,d),h=N5(m)?m.canDeactivate(n,e,t,i):At(d,()=>m(n,e,t,i));return Ji(h).pipe(Ri())});return ue(s).pipe(ms())}function H5(n,e,t,i){let r=e.canLoad;if(r===void 0||r.length===0)return ue(!0);let o=r.map(s=>{let u=gs(s,n),d=I5(u)?u.canLoad(e,t):At(n,()=>u(e,t));return Ji(d)});return ue(o).pipe(ms(),OE(i))}function OE(n){return Lp(Ze(e=>{if(typeof e!="boolean")throw Uc(n,e)}),he(e=>e===!0))}function G5(n,e,t,i){let r=e.canMatch;if(!r||r.length===0)return ue(!0);let o=r.map(s=>{let u=gs(s,n),d=R5(u)?u.canMatch(e,t):At(n,()=>u(e,t));return Ji(d)});return ue(o).pipe(ms(),OE(i))}var bl=class{segmentGroup;constructor(e){this.segmentGroup=e||null}},Sl=class extends Error{urlTree;constructor(e){super(),this.urlTree=e}};function os(n){return Mi(new bl(n))}function q5(n){return Mi(new j(4e3,!1))}function W5(n){return Mi(PE(!1,ln.GuardRejected))}var Ch=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),r.numberOfChildren===0)return ue(i);if(r.numberOfChildren>1||!r.children[ve])return q5(`${e.redirectTo}`);r=r.children[ve]}}applyRedirectCommands(e,t,i,r,o){return j5(t,r,o).pipe(he(s=>{if(s instanceof Si)throw new Sl(s);let u=this.applyRedirectCreateUrlTree(s,this.urlSerializer.parse(s),e,i);if(s[0]==="/")throw new Sl(u);return u}))}applyRedirectCreateUrlTree(e,t,i,r){let o=this.createSegmentGroup(e,t.root,i,r);return new Si(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let i={};return Object.entries(e).forEach(([r,o])=>{if(typeof o=="string"&&o[0]===":"){let u=o.substring(1);i[r]=t[u]}else i[r]=o}),i}createSegmentGroup(e,t,i,r){let o=this.createSegments(e,t.segments,i,r),s={};return Object.entries(t.children).forEach(([u,d])=>{s[u]=this.createSegmentGroup(e,d,i,r)}),new qe(o,s)}createSegments(e,t,i,r){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,r):this.findOrReturn(o,i))}findPosParam(e,t,i){let r=i[t.path.substring(1)];if(!r)throw new j(4001,!1);return r}findOrReturn(e,t){let i=0;for(let r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}};function j5(n,e,t){if(typeof n=="string")return ue(n);let i=n,{queryParams:r,fragment:o,routeConfig:s,url:u,outlet:d,params:m,data:h,title:y}=e;return Ji(At(t,()=>i({params:m,data:h,queryParams:r,fragment:o,routeConfig:s,url:u,outlet:d,title:y})))}var xh={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function z5(n,e,t,i,r){let o=LE(n,e,t);return o.matched?(i=g5(e,i),G5(i,e,t,r).pipe(he(s=>s===!0?o:k({},xh)))):ue(o)}function LE(n,e,t){if(e.path==="**")return Y5(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?k({},xh):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let r=(e.matcher||pE)(t,n,e);if(!r)return k({},xh);let o={};Object.entries(r.posParams??{}).forEach(([u,d])=>{o[u]=d.path});let s=r.consumed.length>0?k(k({},o),r.consumed[r.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:s,positionalParamSegments:r.posParams??{}}}function Y5(n){return{matched:!0,parameters:n.length>0?gE(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function dE(n,e,t,i){return t.length>0&&Q5(n,t,i)?{segmentGroup:new qe(e,K5(i,new qe(t,n.children))),slicedSegments:[]}:t.length===0&&Z5(n,t,i)?{segmentGroup:new qe(n.segments,J5(n,t,i,n.children)),slicedSegments:t}:{segmentGroup:new qe(n.segments,n.children),slicedSegments:t}}function J5(n,e,t,i){let r={};for(let o of t)if(qc(n,e,o)&&!i[ri(o)]){let s=new qe([],{});r[ri(o)]=s}return k(k({},i),r)}function K5(n,e){let t={};t[ve]=e;for(let i of n)if(i.path===""&&ri(i)!==ve){let r=new qe([],{});t[ri(i)]=r}return t}function Q5(n,e,t){return t.some(i=>qc(n,e,i)&&ri(i)!==ve)}function Z5(n,e,t){return t.some(i=>qc(n,e,i))}function qc(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function X5(n,e,t){return e.length===0&&!n.children[t]}var Eh=class{};function eN(n,e,t,i,r,o,s="emptyOnly"){return new bh(n,e,t,i,r,s,o).recognize()}var tN=31,bh=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,i,r,o,s,u){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=u,this.applyRedirects=new Ch(this.urlSerializer,this.urlTree)}noMatchError(e){return new j(4002,`'${e.segmentGroup}'`)}recognize(){let e=dE(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(he(({children:t,rootSnapshot:i})=>{let r=new wn(i,t),o=new xl("",r),s=SE(i,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}))}match(e){let t=new ro([],Object.freeze({}),Object.freeze(k({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),ve,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,ve,t).pipe(he(i=>({children:i,rootSnapshot:t})),jn(i=>{if(i instanceof Sl)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof bl?this.noMatchError(i):i}))}processSegmentGroup(e,t,i,r,o){return i.segments.length===0&&i.hasChildren()?this.processChildren(e,t,i,o):this.processSegment(e,t,i,i.segments,r,!0,o).pipe(he(s=>s instanceof wn?[s]:[]))}processChildren(e,t,i,r){let o=[];for(let s of Object.keys(i.children))s==="primary"?o.unshift(s):o.push(s);return ot(o).pipe(Ai(s=>{let u=i.children[s],d=h5(t,s);return this.processSegmentGroup(e,d,u,s,r)}),Wp((s,u)=>(s.push(...u),s)),er(null),qp(),xt(s=>{if(s===null)return os(i);let u=BE(s);return nN(u),ue(u)}))}processSegment(e,t,i,r,o,s,u){return ot(t).pipe(Ai(d=>this.processSegmentAgainstRoute(d._injector??e,t,d,i,r,o,s,u).pipe(jn(m=>{if(m instanceof bl)return ue(null);throw m}))),Ri(d=>!!d),jn(d=>{if(VE(d))return X5(i,r,o)?ue(new Eh):os(i);throw d}))}processSegmentAgainstRoute(e,t,i,r,o,s,u,d){return ri(i)!==s&&(s===ve||!qc(r,o,i))?os(r):i.redirectTo===void 0?this.matchSegmentAgainstRoute(e,r,i,o,s,d):this.allowRedirects&&u?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,o,s,d):os(r)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,o,s,u){let{matched:d,parameters:m,consumedSegments:h,positionalParamSegments:y,remainingSegments:_}=LE(t,r,o);if(!d)return os(t);typeof r.redirectTo=="string"&&r.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>tN&&(this.allowRedirects=!1));let C=new ro(o,m,Object.freeze(k({},this.urlTree.queryParams)),this.urlTree.fragment,cE(r),ri(r),r.component??r._loadedComponent??null,r,mE(r)),D=Bc(C,u,this.paramsInheritanceStrategy);return C.params=Object.freeze(D.params),C.data=Object.freeze(D.data),this.applyRedirects.applyRedirectCommands(h,r.redirectTo,y,C,e).pipe(Yt(R=>this.applyRedirects.lineralizeSegments(r,R)),xt(R=>this.processSegment(e,i,t,R.concat(_),s,!1,u)))}matchSegmentAgainstRoute(e,t,i,r,o,s){let u=z5(t,i,r,e,this.urlSerializer);return i.path==="**"&&(t.children={}),u.pipe(Yt(d=>d.matched?(e=i._injector??e,this.getChildConfig(e,i,r).pipe(Yt(({routes:m})=>{let h=i._loadedInjector??e,{parameters:y,consumedSegments:_,remainingSegments:C}=d,D=new ro(_,y,Object.freeze(k({},this.urlTree.queryParams)),this.urlTree.fragment,cE(i),ri(i),i.component??i._loadedComponent??null,i,mE(i)),I=Bc(D,s,this.paramsInheritanceStrategy);D.params=Object.freeze(I.params),D.data=Object.freeze(I.data);let{segmentGroup:R,slicedSegments:F}=dE(t,_,C,m);if(F.length===0&&R.hasChildren())return this.processChildren(h,m,R,D).pipe(he(G=>new wn(D,G)));if(m.length===0&&F.length===0)return ue(new wn(D,[]));let $=ri(i)===o;return this.processSegment(h,m,R,F,$?ve:o,!0,D).pipe(he(G=>new wn(D,G instanceof wn?[G]:[])))}))):os(t)))}getChildConfig(e,t,i){return t.children?ue({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?ue({routes:t._loadedRoutes,injector:t._loadedInjector}):H5(e,t,i,this.urlSerializer).pipe(xt(r=>r?this.configLoader.loadChildren(e,t).pipe(Ze(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):W5(t))):ue({routes:[],injector:e})}};function nN(n){n.sort((e,t)=>e.value.outlet===ve?-1:t.value.outlet===ve?1:e.value.outlet.localeCompare(t.value.outlet))}function iN(n){let e=n.value.routeConfig;return e&&e.path===""}function BE(n){let e=[],t=new Set;for(let i of n){if(!iN(i)){e.push(i);continue}let r=e.find(o=>i.value.routeConfig===o.value.routeConfig);r!==void 0?(r.children.push(...i.children),t.add(r)):e.push(i)}for(let i of t){let r=BE(i.children);e.push(new wn(i.value,r))}return e.filter(i=>!t.has(i))}function cE(n){return n.data||{}}function mE(n){return n.resolve||{}}function rN(n,e,t,i,r,o){return xt(s=>eN(n,e,t,i,s.extractedUrl,r,o).pipe(he(({state:u,tree:d})=>q(k({},s),{targetSnapshot:u,urlAfterRedirects:d}))))}function oN(n,e){return xt(t=>{let{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return ue(t);let o=new Set(r.map(d=>d.route)),s=new Set;for(let d of o)if(!s.has(d))for(let m of UE(d))s.add(m);let u=0;return ot(s).pipe(Ai(d=>o.has(d)?sN(d,i,n,e):(d.data=Bc(d,d.parent,n).resolve,ue(void 0))),Ze(()=>u++),Po(1),xt(d=>u===s.size?ue(t):mn))})}function UE(n){let e=n.children.map(t=>UE(t)).flat();return[n,...e]}function sN(n,e,t,i){let r=n.routeConfig,o=n._resolve;return r?.title!==void 0&&!NE(r)&&(o[Dl]=r.title),ca(()=>(n.data=Bc(n,n.parent,t).resolve,aN(o,n,e,i).pipe(he(s=>(n._resolvedData=s,n.data=k(k({},n.data),s),null)))))}function aN(n,e,t,i){let r=ch(n);if(r.length===0)return ue({});let o={};return ot(r).pipe(xt(s=>lN(n[s],e,t,i).pipe(Ri(),Ze(u=>{if(u instanceof cs)throw Uc(new so,u);o[s]=u}))),Po(1),he(()=>o),jn(s=>VE(s)?mn:Mi(s)))}function lN(n,e,t,i){let r=ps(e)??i,o=gs(n,r),s=o.resolve?o.resolve(e,t):At(r,()=>o(e,t));return Ji(s)}function uh(n){return Yt(e=>{let t=n(e);return t?ot(t).pipe(he(()=>e)):ue(e)})}var Th=(()=>{class n{buildTitle(t){let i,r=t.root;for(;r!==void 0;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(o=>o.outlet===ve);return i}getResolvedTitleForRoute(t){return t.data[Dl]}static \u0275fac=function(i){return new(i||n)};static \u0275prov=J({token:n,factory:()=>P($E),providedIn:"root"})}return n})(),$E=(()=>{class n extends Th{title;constructor(t){super(),this.title=t}updateTitle(t){let i=this.buildTitle(t);i!==void 0&&this.title.setTitle(i)}static \u0275fac=function(i){return new(i||n)(oe(oE))};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),hs=new te("",{providedIn:"root",factory:()=>({})}),Ml=new te(""),HE=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=P(vg);loadComponent(t,i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return ue(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);let r=Ji(At(t,()=>i.loadComponent())).pipe(he(qE),Yt(WE),Ze(s=>{this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=s}),tr(()=>{this.componentLoaders.delete(i)})),o=new No(r,()=>new gt).pipe(Ao());return this.componentLoaders.set(i,o),o}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return ue({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=GE(i,this.compiler,t,this.onLoadEndListener).pipe(tr(()=>{this.childrenLoaders.delete(i)})),s=new No(o,()=>new gt).pipe(Ao());return this.childrenLoaders.set(i,s),s}static \u0275fac=function(i){return new(i||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function GE(n,e,t,i){return Ji(At(t,()=>n.loadChildren())).pipe(he(qE),Yt(WE),xt(r=>r instanceof Hd||Array.isArray(r)?ue(r):ot(e.compileModuleAsync(r))),he(r=>{i&&i(n);let o,s,u=!1;return Array.isArray(r)?(s=r,u=!0):(o=r.create(t).injector,s=o.get(Ml,[],{optional:!0,self:!0}).flat()),{routes:s.map(wh),injector:o}}))}function uN(n){return n&&typeof n=="object"&&"default"in n}function qE(n){return uN(n)?n.default:n}function WE(n){return ue(n)}var Wc=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=J({token:n,factory:()=>P(dN),providedIn:"root"})}return n})(),dN=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static \u0275fac=function(i){return new(i||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),jE=new te("");var zE=new te(""),YE=(()=>{class n{currentNavigation=S(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=null;events=new gt;transitionAbortWithErrorSubject=new gt;configLoader=P(HE);environmentInjector=P(Et);destroyRef=P(On);urlSerializer=P(wl);rootContexts=P(fs);location=P(Xr);inputBindingEnabled=P(Gc,{optional:!0})!==null;titleStrategy=P(Th);options=P(hs,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=P(Wc);createViewTransition=P(jE,{optional:!0});navigationErrorHandler=P(zE,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>ue(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=r=>this.events.next(new Nc(r)),i=r=>this.events.next(new Rc(r));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let i=++this.navigationId;Rt(()=>{this.transitions?.next(q(k({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,abortController:new AbortController,id:i}))})}setupNavigations(t){return this.transitions=new Bt(null),this.transitions.pipe(It(i=>i!==null),Yt(i=>{let r=!1;return ue(i).pipe(Yt(o=>{if(this.navigationId>i.id)return this.cancelNavigationTransition(i,"",ln.SupersededByNewNavigation),mn;this.currentTransition=i,this.currentNavigation.set({id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,targetBrowserUrl:typeof o.extras.browserUrl=="string"?this.urlSerializer.parse(o.extras.browserUrl):o.extras.browserUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?q(k({},this.lastSuccessfulNavigation),{previousNavigation:null}):null,abort:()=>o.abortController.abort()});let s=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),u=o.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!s&&u!=="reload")return this.events.next(new Yi(o.id,this.urlSerializer.serialize(o.rawUrl),"",yl.IgnoredSameUrlNavigation)),o.resolve(!1),mn;if(this.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return ue(o).pipe(Yt(d=>(this.events.next(new ao(d.id,this.urlSerializer.serialize(d.extractedUrl),d.source,d.restoredState)),d.id!==this.navigationId?mn:Promise.resolve(d))),rN(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),Ze(d=>{i.targetSnapshot=d.targetSnapshot,i.urlAfterRedirects=d.urlAfterRedirects,this.currentNavigation.update(h=>(h.finalUrl=d.urlAfterRedirects,h));let m=new _l(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(m)}));if(s&&this.urlHandlingStrategy.shouldProcessUrl(o.currentRawUrl)){let{id:d,extractedUrl:m,source:h,restoredState:y,extras:_}=o,C=new ao(d,this.urlSerializer.serialize(m),h,y);this.events.next(C);let D=ME(this.rootComponentType).snapshot;return this.currentTransition=i=q(k({},o),{targetSnapshot:D,urlAfterRedirects:m,extras:q(k({},_),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(I=>(I.finalUrl=m,I)),ue(i)}else return this.events.next(new Yi(o.id,this.urlSerializer.serialize(o.extractedUrl),"",yl.IgnoredByUrlHandlingStrategy)),o.resolve(!1),mn}),Ze(o=>{let s=new Tc(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(s)}),he(o=>(this.currentTransition=i=q(k({},o),{guards:b5(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),i)),P5(this.environmentInjector,o=>this.events.next(o)),Ze(o=>{if(i.guardsResult=o.guardsResult,o.guardsResult&&typeof o.guardsResult!="boolean")throw Uc(this.urlSerializer,o.guardsResult);let s=new Ic(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(s)}),It(o=>o.guardsResult?!0:(this.cancelNavigationTransition(o,"",ln.GuardRejected),!1)),uh(o=>{if(o.guards.canActivateChecks.length!==0)return ue(o).pipe(Ze(s=>{let u=new Mc(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot);this.events.next(u)}),Yt(s=>{let u=!1;return ue(s).pipe(oN(this.paramsInheritanceStrategy,this.environmentInjector),Ze({next:()=>u=!0,complete:()=>{u||this.cancelNavigationTransition(s,"",ln.NoDataFromResolver)}}))}),Ze(s=>{let u=new Ac(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot);this.events.next(u)}))}),uh(o=>{let s=u=>{let d=[];if(u.routeConfig?.loadComponent){let m=ps(u)??this.environmentInjector;d.push(this.configLoader.loadComponent(m,u.routeConfig).pipe(Ze(h=>{u.component=h}),he(()=>{})))}for(let m of u.children)d.push(...s(m));return d};return Au(s(o.targetSnapshot.root)).pipe(er(null),Ni(1))}),uh(()=>this.afterPreactivation()),Yt(()=>{let{currentSnapshot:o,targetSnapshot:s}=i,u=this.createViewTransition?.(this.environmentInjector,o.root,s.root);return u?ot(u).pipe(he(()=>i)):ue(i)}),he(o=>{let s=_5(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return this.currentTransition=i=q(k({},o),{targetRouterState:s}),this.currentNavigation.update(u=>(u.targetRouterState=s,u)),i}),Ze(()=>{this.events.next(new vl)}),E5(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o),this.inputBindingEnabled),Ni(1),Ru(new Te(o=>{let s=i.abortController.signal,u=()=>o.next();return s.addEventListener("abort",u),()=>s.removeEventListener("abort",u)}).pipe(It(()=>!r&&!i.targetRouterState),Ze(()=>{this.cancelNavigationTransition(i,i.abortController.signal.reason+"",ln.Aborted)}))),Ze({next:o=>{r=!0,this.lastSuccessfulNavigation=Rt(this.currentNavigation),this.events.next(new In(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects))),this.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{r=!0}}),Ru(this.transitionAbortWithErrorSubject.pipe(Ze(o=>{throw o}))),tr(()=>{r||this.cancelNavigationTransition(i,"",ln.SupersededByNewNavigation),this.currentTransition?.id===i.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),jn(o=>{if(this.destroyed)return i.resolve(!1),mn;if(r=!0,kE(o))this.events.next(new bi(i.id,this.urlSerializer.serialize(i.extractedUrl),o.message,o.cancellationCode)),x5(o)?this.events.next(new ds(o.url,o.navigationBehaviorOptions)):i.resolve(!1);else{let s=new us(i.id,this.urlSerializer.serialize(i.extractedUrl),o,i.targetSnapshot??void 0);try{let u=At(this.environmentInjector,()=>this.navigationErrorHandler?.(s));if(u instanceof cs){let{message:d,cancellationCode:m}=Uc(this.urlSerializer,u);this.events.next(new bi(i.id,this.urlSerializer.serialize(i.extractedUrl),d,m)),this.events.next(new ds(u.redirectTo,u.navigationBehaviorOptions))}else throw this.events.next(s),o}catch(u){this.options.resolveNavigationPromiseOnError?i.resolve(!1):i.reject(u)}}return mn}))}))}cancelNavigationTransition(t,i,r){let o=new bi(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=Rt(this.currentNavigation),r=i?.targetBrowserUrl??i?.extractedUrl;return t.toString()!==r?.toString()&&!i?.extras.skipLocationChange}static \u0275fac=function(i){return new(i||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function cN(n){return n!==fl}var JE=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=J({token:n,factory:()=>P(mN),providedIn:"root"})}return n})(),Hc=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},mN=(()=>{class n extends Hc{static \u0275fac=(()=>{let t;return function(r){return(t||(t=tn(n)))(r||n)}})();static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),KE=(()=>{class n{urlSerializer=P(wl);options=P(hs,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=P(Xr);urlHandlingStrategy=P(Wc);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new Si;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:i,targetBrowserUrl:r}){let o=t!==void 0?this.urlHandlingStrategy.merge(t,i):i,s=r??o;return s instanceof Si?this.urlSerializer.serialize(s):s}commitTransition({targetRouterState:t,finalUrl:i,initialUrl:r}){i&&t?(this.currentUrlTree=i,this.rawUrlTree=this.urlHandlingStrategy.merge(i,r),this.routerState=t):this.rawUrlTree=r}routerState=ME(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=J({token:n,factory:()=>P(pN),providedIn:"root"})}return n})(),pN=(()=>{class n extends KE{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{i.type==="popstate"&&setTimeout(()=>{t(i.url,i.state,"popstate")})})}handleRouterEvent(t,i){t instanceof ao?this.updateStateMemento():t instanceof Yi?this.commitTransition(i):t instanceof _l?this.urlUpdateStrategy==="eager"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof vl?(this.commitTransition(i),this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof bi&&t.code!==ln.SupersededByNewNavigation&&t.code!==ln.Redirect?this.restoreHistory(i):t instanceof us?this.restoreHistory(i,!0):t instanceof In&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:i,id:r}){let{replaceUrl:o,state:s}=i;if(this.location.isCurrentPathEqualTo(t)||o){let u=this.browserPageId,d=k(k({},s),this.generateNgRouterState(r,u));this.location.replaceState(t,"",d)}else{let u=k(k({},s),this.generateNgRouterState(r,this.browserPageId+1));this.location.go(t,"",u)}}restoreHistory(t,i=!1){if(this.canceledNavigationResolution==="computed"){let r=this.browserPageId,o=this.currentPageId-r;o!==0?this.location.historyGo(o):this.getCurrentUrlTree()===t.finalUrl&&o===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=tn(n)))(r||n)}})();static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Ih(n,e){n.events.pipe(It(t=>t instanceof In||t instanceof bi||t instanceof us||t instanceof Yi),he(t=>t instanceof In||t instanceof Yi?0:(t instanceof bi?t.code===ln.Redirect||t.code===ln.SupersededByNewNavigation:!1)?2:1),It(t=>t!==2),Ni(1)).subscribe(()=>{e()})}var fN={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},gN={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Le=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=P(mg);stateManager=P(KE);options=P(hs,{optional:!0})||{};pendingTasks=P(yi);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=P(YE);urlSerializer=P(wl);location=P(Xr);urlHandlingStrategy=P(Wc);injector=P(Et);_events=new gt;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=P(JE);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=P(Ml,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!P(Gc,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new vt;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(i=>{try{let r=this.navigationTransitions.currentTransition,o=Rt(this.navigationTransitions.currentNavigation);if(r!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof bi&&i.code!==ln.Redirect&&i.code!==ln.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof In)this.navigated=!0;else if(i instanceof ds){let s=i.navigationBehaviorOptions,u=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),d=k({browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||this.urlUpdateStrategy==="eager"||cN(r.source)},s);this.scheduleNavigation(u,fl,null,d,{resolve:r.resolve,reject:r.reject,promise:r.promise})}}f5(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortWithErrorSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),fl,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i,r)=>{this.navigateToSyncWithBrowser(t,r,i)})}navigateToSyncWithBrowser(t,i,r){let o={replaceUrl:!0},s=r?.navigationId?r:null;if(r){let d=k({},r);delete d.navigationId,delete d.\u0275routerPageId,Object.keys(d).length!==0&&(o.state=d)}let u=this.parseUrl(t);this.scheduleNavigation(u,i,s,o).catch(d=>{this.disposed||this.injector.get(fn)(d)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return Rt(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(wh),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){let{relativeTo:r,queryParams:o,fragment:s,queryParamsHandling:u,preserveFragment:d}=i,m=d?this.currentUrlTree.fragment:s,h=null;switch(u??this.options.defaultQueryParamsHandling){case"merge":h=k(k({},this.currentUrlTree.queryParams),o);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=o||null}h!==null&&(h=this.removeEmptyProps(h));let y;try{let _=r?r.snapshot:this.routerState.snapshot.root;y=DE(_)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),y=this.currentUrlTree.root}return wE(y,t,h,m??null)}navigateByUrl(t,i={skipLocationChange:!1}){let r=vr(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(o,fl,null,i)}navigate(t,i={skipLocationChange:!1}){return hN(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.console.warn(rr(4018,!1)),this.urlSerializer.parse("/")}}isActive(t,i){let r;if(i===!0?r=k({},fN):i===!1?r=k({},gN):r=i,vr(t))return sE(this.currentUrlTree,t,r);let o=this.parseUrl(t);return sE(this.currentUrlTree,o,r)}removeEmptyProps(t){return Object.entries(t).reduce((i,[r,o])=>(o!=null&&(i[r]=o),i),{})}scheduleNavigation(t,i,r,o,s){if(this.disposed)return Promise.resolve(!1);let u,d,m;s?(u=s.resolve,d=s.reject,m=s.promise):m=new Promise((y,_)=>{u=y,d=_});let h=this.pendingTasks.add();return Ih(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:u,reject:d,promise:m,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),m.catch(y=>Promise.reject(y))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function hN(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new j(4008,!1)}var Cr=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;reactiveHref=S(null);get href(){return Rt(this.reactiveHref)}set href(t){this.reactiveHref.set(t)}target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new gt;applicationErrorHandler=P(fn);options=P(hs,{optional:!0});constructor(t,i,r,o,s,u){this.router=t,this.route=i,this.tabIndexAttribute=r,this.renderer=o,this.el=s,this.locationStrategy=u,this.reactiveHref.set(P(new Jd("href"),{optional:!0}));let d=s.nativeElement.tagName?.toLowerCase();this.isAnchorElement=d==="a"||d==="area"||!!(typeof customElements=="object"&&customElements.get(d)?.observedAttributes?.includes?.("href")),this.isAnchorElement?this.setTabIndexIfNotOnNativeEl("0"):this.subscribeToNavigationEventsIfNecessary()}subscribeToNavigationEventsIfNecessary(){if(this.subscription!==void 0||!this.isAnchorElement)return;let t=this.preserveFragment,i=r=>r==="merge"||r==="preserve";t||=i(this.queryParamsHandling),t||=!this.queryParamsHandling&&!i(this.options?.defaultQueryParamsHandling),t&&(this.subscription=this.router.events.subscribe(r=>{r instanceof In&&this.updateHref()}))}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&(this.updateHref(),this.subscribeToNavigationEventsIfNecessary()),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(vr(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,i,r,o,s){let u=this.urlTree;if(u===null||this.isAnchorElement&&(t!==0||i||r||o||s||typeof this.target=="string"&&this.target!="_self"))return!0;let d={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(u,d)?.catch(m=>{this.applicationErrorHandler(m)}),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.reactiveHref.set(t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t))??"":null)}applyAttributeValue(t,i){let r=this.renderer,o=this.el.nativeElement;i!==null?r.setAttribute(o,t,i):r.removeAttribute(o,t)}get urlTree(){return this.routerLinkInput===null?null:vr(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(i){return new(i||n)(K(Le),K(un),Ua("tabindex"),K(Xn),K(nn),K(xi))};static \u0275dir=Ne({type:n,selectors:[["","routerLink",""]],hostVars:2,hostBindings:function(i,r){i&1&&b("click",function(s){return r.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),i&2&&ft("href",r.reactiveHref(),H0)("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",Zr],skipLocationChange:[2,"skipLocationChange","skipLocationChange",Zr],replaceUrl:[2,"replaceUrl","replaceUrl",Zr],routerLink:"routerLink"},features:[Bn]})}return n})(),Mh=(()=>{class n{router;element;renderer;cdr;link;links;classes=[];routerEventsSubscription;linkInputChangesSubscription;_isActive=!1;get isActive(){return this._isActive}routerLinkActiveOptions={exact:!1};ariaCurrentWhenActive;isActiveChange=new at;constructor(t,i,r,o,s){this.router=t,this.element=i,this.renderer=r,this.cdr=o,this.link=s,this.routerEventsSubscription=t.events.subscribe(u=>{u instanceof In&&this.update()})}ngAfterContentInit(){ue(this.links.changes,ue(null)).pipe(Ro()).subscribe(t=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();let t=[...this.links.toArray(),this.link].filter(i=>!!i).map(i=>i.onChanges);this.linkInputChangesSubscription=ot(t).pipe(Ro()).subscribe(i=>{this._isActive!==this.isLinkActive(this.router)(i)&&this.update()})}set routerLinkActive(t){let i=Array.isArray(t)?t:t.split(" ");this.classes=i.filter(r=>!!r)}ngOnChanges(t){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{let t=this.hasActiveLinks();this.classes.forEach(i=>{t?this.renderer.addClass(this.element.nativeElement,i):this.renderer.removeClass(this.element.nativeElement,i)}),t&&this.ariaCurrentWhenActive!==void 0?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this._isActive!==t&&(this._isActive=t,this.cdr.markForCheck(),this.isActiveChange.emit(t))})}isLinkActive(t){let i=_N(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return r=>{let o=r.urlTree;return o?t.isActive(o,i):!1}}hasActiveLinks(){let t=this.isLinkActive(this.router);return this.link&&t(this.link)||this.links.some(t)}static \u0275fac=function(i){return new(i||n)(K(Le),K(nn),K(Xn),K(yr),K(Cr,8))};static \u0275dir=Ne({type:n,selectors:[["","routerLinkActive",""]],contentQueries:function(i,r,o){if(i&1&&yg(o,Cr,5),i&2){let s;on(s=sn())&&(r.links=s)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],features:[Bn]})}return n})();function _N(n){return!!n.paths}var vN=new te("");function Ah(n,...e){return kr([{provide:Ml,multi:!0,useValue:n},[],{provide:un,useFactory:CN,deps:[Le]},{provide:Gd,multi:!0,useFactory:EN},e.map(t=>t.\u0275providers)])}function CN(n){return n.routerState.root}function xN(n,e){return{\u0275kind:n,\u0275providers:e}}function EN(){let n=P(Jt);return e=>{let t=n.get(Gi);if(e!==t.components[0])return;let i=n.get(Le),r=n.get(bN);n.get(SN)===1&&i.initialNavigation(),n.get(DN,null,{optional:!0})?.setUpPreloading(),n.get(vN,null,{optional:!0})?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var bN=new te("",{factory:()=>new gt}),SN=new te("",{providedIn:"root",factory:()=>1});var DN=new te("");function Nh(){return xN(6,[{provide:xi,useClass:Lg}])}var yn={production:!1,apiUrl:"https://galaxyhouse-finance.zeabur.app/api"};var lo=class lo{constructor(e,t){this.http=e;this.router=t;this.baseUrl=`${yn.apiUrl}/admin`;this.tokenKey="gh_finance_auth_token";this.adminKey="gh_finance_admin_data";this.expiryKey="gh_finance_token_expiry";this.currentAdmin=S(null);this.isAuthenticated=S(!1);this.isLoading=S(!1);this.error=S(null);this.isSuperAdmin=H(()=>this.currentAdmin()?.roles.some(t=>t.role_name==="super_admin")??!1);this.isManagedAdmin=H(()=>this.currentAdmin()?.roles.some(t=>["super_admin","user_manager"].includes(t.role_name))??!1);this.initializeAuth()}initializeAuth(){let e=this.getToken(),t=this.getTokenExpiry();if(e&&t)if(new Date().getTime()<t){let i=localStorage.getItem(this.adminKey);i&&(this.currentAdmin.set(JSON.parse(i)),this.isAuthenticated.set(!0))}else this.clearAuth()}async loginWithGoogle(e){try{this.isLoading.set(!0),this.error.set(null);let t=await se(this.http.post(`${this.baseUrl}/auth/google`,{idToken:e}));if(t.success&&t.data){let{token:i,admin:r}=t.data;return this.saveToken(i),this.saveAdmin(r),this.currentAdmin.set(r),this.isAuthenticated.set(!0),!0}else return this.error.set(t.error||"Login failed"),!1}catch(t){let i=t.error?.error||"Authentication failed";return this.error.set(i),!1}finally{this.isLoading.set(!1)}}logout(){this.clearAuth(),this.router.navigate(["/login"])}hasPermission(e){return this.currentAdmin()?.permissions.includes(e)??!1}hasRole(e){return this.currentAdmin()?.roles.some(i=>i.role_name===e)??!1}hasAnyRole(e){return this.currentAdmin()?.roles.some(i=>e.includes(i.role_name))??!1}getToken(){return localStorage.getItem(this.tokenKey)}getTokenExpiry(){let e=localStorage.getItem(this.expiryKey);return e?parseInt(e):null}saveToken(e){let t=new Date().getTime()+6048e5;localStorage.setItem(this.tokenKey,e),localStorage.setItem(this.expiryKey,t.toString())}saveAdmin(e){localStorage.setItem(this.adminKey,JSON.stringify(e))}clearAuth(){localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.adminKey),localStorage.removeItem(this.expiryKey),this.currentAdmin.set(null),this.isAuthenticated.set(!1)}refreshTokenExpiry(){let e=this.getToken();e&&this.saveToken(e)}getCurrentAdmin(){return this.currentAdmin()}isTokenExpiringSoon(){let e=this.getTokenExpiry();if(!e)return!0;let t=new Date().getTime(),i=3600*1e3;return e-t<i}};lo.\u0275fac=function(t){return new(t||lo)(oe(Qt),oe(Le))},lo.\u0275prov=J({token:lo,factory:lo.\u0275fac,providedIn:"root"});var nt=lo;var QE=()=>({exact:!0}),wN=(n,e)=>e.name,TN=(n,e)=>e.path;function IN(n,e){if(n&1&&(l(0,"a",16),x(1,"ion-icon",17),l(2,"span",18),c(3),a()()),n&2){let t=e.$implicit;M("routerLink",t.path)("routerLinkActiveOptions",Vt(4,QE)),f(),M("name",t.icon),f(2),E(t.name)}}function MN(n,e){if(n&1&&(l(0,"div",15),O(1,IN,4,5,"a",16,TN),a()),n&2){let t=v(2).$implicit;f(),L(t.children)}}function AN(n,e){if(n&1){let t=B();l(0,"div")(1,"button",10),b("click",function(){w(t);let r=v().$implicit,o=v();return T(o.toggleMenu(r.name))}),l(2,"div",11),x(3,"ion-icon",12),l(4,"span",13),c(5),a()(),x(6,"ion-icon",14),a(),A(7,MN,3,0,"div",15),a()}if(n&2){let t=v().$implicit,i=v();f(),z("text-indigo-600",i.isMenuActive(t.children))("font-semibold",i.isMenuActive(t.children)),f(2),M("name",t.icon),f(2),E(t.name),f(),z("rotate-180",i.openMenu()===t.name),f(),N(i.openMenu()===t.name?7:-1)}}function NN(n,e){if(n&1&&(l(0,"a",9),x(1,"ion-icon",12),l(2,"span",13),c(3),a()()),n&2){let t=v().$implicit;M("routerLink",t.path)("routerLinkActiveOptions",Vt(4,QE)),f(),M("name",t.icon),f(2),E(t.name)}}function RN(n,e){if(n&1&&A(0,AN,8,9,"div")(1,NN,4,5,"a",9),n&2){let t=e.$implicit;N(t.children&&t.children.length>0?0:1)}}var ys=class ys{constructor(){this.router=P(Le);this.authService=P(nt);this.http=P(Qt);this.openMenu=S(null);this.isSuperAdmin=S(!1);this.allNavLinks=[{path:"/dashboard",icon:"grid-outline",name:"\u5100\u8868\u677F"},{name:"\u8CA1\u52D9\u8207\u5206\u6790",icon:"analytics-outline",children:[{path:"/daily-revenue",icon:"stats-chart-outline",name:"\u7576\u65E5\u71DF\u6536"},{path:"/financial-statements",icon:"document-text-outline",name:"\u8CA1\u52D9\u5831\u8868"},{path:"/customer-analysis",icon:"people-outline",name:"\u9867\u5BA2\u7BA1\u7406"},{path:"/product-analysis",icon:"cube-outline",name:"\u5546\u54C1\u5206\u6790"},{path:"/monthly-targets",icon:"trending-up-outline",name:"\u71DF\u6536\u76EE\u6A19"}]},{name:"\u6210\u672C\u8207\u5EE0\u5546",icon:"wallet-outline",children:[{path:"/product-cost",icon:"pricetags-outline",name:"\u5546\u54C1\u6210\u672C"},{path:"/purchase-orders",icon:"receipt-outline",name:"\u9032\u8CA8\u55AE\u7BA1\u7406"},{path:"/vendors",icon:"briefcase-outline",name:"\u5EE0\u5546\u7BA1\u7406"}]},{name:"\u4EA4\u6613\u8207\u5E33\u52D9",icon:"reader-outline",children:[{path:"/ledger",icon:"reader-outline",name:"\u6D41\u6C34\u5E33"}]},{name:"\u884C\u92B7\u8207\u6D3B\u52D5",icon:"megaphone-outline",children:[{path:"/events",icon:"calendar-outline",name:"\u6D3B\u52D5\u7BA1\u7406"}]},{name:"\u80A1\u6771\u8207\u85AA\u8CC7",icon:"people-circle-outline",children:[{path:"/payroll",icon:"card-outline",name:"\u6253\u5361\u85AA\u8CC7"},{path:"/company-profile",icon:"person-outline",name:"\u516C\u53F8\u500B\u4EBA\u8CC7\u6599"},{path:"/shareholder-rebates",icon:"diamond-outline",name:"\u80A1\u6771\u56DE\u994B\u91D1"}]},{name:"\u5354\u4F5C\u7A7A\u9593",icon:"people-outline",children:[{path:"/goal-setting",icon:"trophy-outline",name:"\u5718\u968A\u76EE\u6A19\u8A2D\u5B9A"},{path:"/goal-progress",icon:"flag-outline",name:"\u500B\u4EBA\u76EE\u6A19\u9032\u5EA6"},{path:"/shareholder-records",icon:"document-text-outline",name:"\u500B\u4EBA\u6BCF\u5468\u9032\u5EA6\u7D00\u9304"},{path:"/meeting",icon:"chatbubbles-outline",name:"\u6BCF\u5468\u6703\u8B70\u7D00\u9304"},{path:"/decision-log",icon:"key-outline",name:"\u91CD\u5927\u4E8B\u9805\u4F48\u9054"}]},{name:"\u5E33\u865F\u7BA1\u7406",icon:"person-circle-outline",children:[{path:"/account",icon:"settings-outline",name:"\u5E33\u865F\u8A2D\u5B9A"},{path:"/user-management",icon:"shield-checkmark-outline",name:"\u4F7F\u7528\u8005\u7BA1\u7406"}]}];this.navLinks=H(()=>{if(!this.authService.isAuthenticated())return[];let e=this.allNavLinks;return this.isSuperAdmin()&&(e=[...e.slice(0,e.length-1),{name:"\u5E33\u865F\u7BA1\u7406",icon:"person-circle-outline",children:[{path:"/account",icon:"settings-outline",name:"\u5E33\u865F\u8A2D\u5B9A"},{path:"/user-management",icon:"shield-checkmark-outline",name:"\u4F7F\u7528\u8005\u7BA1\u7406"},{path:"/role-permissions",icon:"lock-closed-outline",name:"\u89D2\u8272\u6B0A\u9650\u63A7\u7BA1"}]}]),e})}ngOnInit(){this.checkSuperAdminStatus(),this.router.events.pipe(It(e=>e instanceof In)).subscribe(()=>{let e=this.navLinks().find(t=>this.isMenuActive(t.children));e&&this.openMenu.set(e.name)})}checkSuperAdminStatus(){try{let e=this.authService.getToken();if(!e){this.isSuperAdmin.set(!1);return}let t=new Ot({Authorization:`Bearer ${e}`,"Content-Type":"application/json"});this.http.get(`${yn.apiUrl}/admin/profile`,{headers:t}).subscribe({next:i=>{if(i?.data?.roles&&Array.isArray(i.data.roles)){let r=i.data.roles.some(o=>o.role_name==="super_admin");this.isSuperAdmin.set(r)}},error:()=>{this.isSuperAdmin.set(!1)}})}catch{this.isSuperAdmin.set(!1)}}toggleMenu(e){this.openMenu.update(t=>t===e?null:e)}isMenuActive(e){return e?e.some(t=>t.path&&this.router.isActive(t.path,{paths:"exact",queryParams:"subset",fragment:"ignored",matrixParams:"ignored"})):!1}};ys.\u0275fac=function(t){return new(t||ys)},ys.\u0275cmp=ie({type:ys,selectors:[["app-sidebar"]],decls:13,vars:0,consts:[[1,"w-64","flex-shrink-0","bg-white","border-r","border-gray-200","flex","flex-col"],[1,"h-16","flex","items-center","justify-center","border-b","border-gray-200"],[1,"flex","items-center","space-x-2"],["name","pulse-outline",1,"text-3xl","text-indigo-600"],[1,"text-xl","font-semibold","text-gray-800"],[1,"flex-1","flex","flex-col","overflow-y-auto"],[1,"flex-1","px-4","py-6","space-y-1"],[1,"px-4","py-6","border-t","border-gray-200"],[1,"text-xs","text-center","text-gray-500"],["routerLinkActive","bg-indigo-50 text-indigo-600",1,"flex","items-center","px-4","py-2.5","text-gray-600","transition-colors","duration-200","transform","rounded-lg","hover:bg-gray-100","hover:text-gray-800",3,"routerLink","routerLinkActiveOptions"],[1,"w-full","flex","items-center","justify-between","px-4","py-2.5","text-gray-600","transition-colors","duration-200","transform","rounded-lg","hover:bg-gray-100","hover:text-gray-800",3,"click"],[1,"flex","items-center"],[1,"text-xl",3,"name"],[1,"mx-4","font-medium"],["name","chevron-down-outline",1,"text-sm","transition-transform","duration-300"],[1,"mt-1","ml-4","pl-2","space-y-1","border-l","border-gray-200"],["routerLinkActive","bg-indigo-50 text-indigo-600 font-semibold",1,"flex","items-center","w-full","px-4","py-2","text-sm","text-gray-600","transition-colors","duration-200","transform","rounded-lg","hover:bg-gray-100","hover:text-gray-800",3,"routerLink","routerLinkActiveOptions"],[1,"text-lg",3,"name"],[1,"mx-4","font-normal"]],template:function(t,i){t&1&&(l(0,"aside",0)(1,"div",1)(2,"div",2),x(3,"ion-icon",3),l(4,"h1",4),c(5,"\u8CA1\u52D9 AI"),a()()(),l(6,"div",5)(7,"nav",6),O(8,RN,2,1,null,null,wN),a()(),l(10,"div",7)(11,"p",8),c(12,"\xA9 2024 \u5167\u90E8\u7CFB\u7D71"),a()()()),t&2&&(f(8),L(i.navLinks()))},dependencies:[Cr,Mh],encapsulation:2,changeDetection:0});var jc=ys;function FN(n,e){if(n&1&&(Xe(0,"div",1)(1,"div",2)(2,"p",3),c(3),et(),Xe(4,"p",4),c(5),et()(),Xe(6,"div",5),qi(7,"ion-icon",6),et()()),n&2){let t=e,i=v();f(3),E(t.name),f(),De(i.getRoleClass((t.roles[0]==null?null:t.roles[0].role_name)||"")),f(),V(" ",(t.roles[0]==null?null:t.roles[0].display_name)||"User"," ")}}var _s=class _s{constructor(){this.authService=P(nt)}getRoleClass(e){switch(e){case"super_admin":return"bg-red-100 text-red-800";case"user_manager":return"bg-blue-100 text-blue-800";case"finance_manager":return"bg-green-100 text-green-800";case"operation_manager":return"bg-yellow-100 text-yellow-800";case"viewer":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}}};_s.\u0275fac=function(t){return new(t||_s)},_s.\u0275cmp=ie({type:_s,selectors:[["app-header"]],decls:2,vars:1,consts:[[1,"h-16","flex-shrink-0","bg-white","border-b","border-gray-200","flex","items-center","justify-end","px-6"],[1,"flex","items-center","gap-4"],[1,"text-right"],[1,"text-sm","font-semibold","text-gray-800"],[1,"text-xs","font-medium","px-2","py-0.5","rounded-full","inline-block"],[1,"flex","items-center","gap-2"],["name","person-circle-outline",1,"text-3xl","text-gray-500"]],template:function(t,i){if(t&1&&(Xe(0,"header",0),A(1,FN,8,4,"div",1),et()),t&2){let r;f(),N((r=i.authService.currentAdmin())?1:-1,r)}},dependencies:[re],encapsulation:2,changeDetection:0});var zc=_s;function PN(n,e){n&1&&(l(0,"div",0),x(1,"app-sidebar"),l(2,"div",1),x(3,"app-header"),l(4,"main",2)(5,"div",3),x(6,"router-outlet"),a()()()())}function kN(n,e){n&1&&x(0,"router-outlet")}var vs=class vs{constructor(){this.authService=P(nt)}};vs.\u0275fac=function(t){return new(t||vs)},vs.\u0275cmp=ie({type:vs,selectors:[["app-root"]],decls:2,vars:1,consts:[[1,"flex","h-screen","bg-gray-100"],[1,"flex-1","flex","flex-col","overflow-hidden"],[1,"flex-1","overflow-x-hidden","overflow-y-auto","bg-gray-50"],[1,"container","mx-auto","px-6","py-8"]],template:function(t,i){t&1&&A(0,PN,7,0,"div",0)(1,kN,1,0,"router-outlet"),t&2&&N(i.authService.isAuthenticated()?0:1)},dependencies:[Tl,jc,zc,re],encapsulation:2,changeDetection:0});var Yc=vs;var a2=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,i){this._renderer=t,this._elementRef=i}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(i){return new(i||n)(K(Xn),K(nn))};static \u0275dir=Ne({type:n})}return n})(),Ol=(()=>{class n extends a2{static \u0275fac=(()=>{let t;return function(r){return(t||(t=tn(n)))(r||n)}})();static \u0275dir=Ne({type:n,features:[pt]})}return n})(),co=new te(""),VN={provide:co,useExisting:bt(()=>Ll),multi:!0},Ll=(()=>{class n extends Ol{writeValue(t){this.setProperty("checked",t)}static \u0275fac=(()=>{let t;return function(r){return(t||(t=tn(n)))(r||n)}})();static \u0275dir=Ne({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(i,r){i&1&&b("change",function(s){return r.onChange(s.target.checked)})("blur",function(){return r.onTouched()})},standalone:!1,features:[Gt([VN]),pt]})}return n})(),ON={provide:co,useExisting:bt(()=>Ce),multi:!0};function LN(){let n=$n()?$n().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var BN=new te(""),Ce=(()=>{class n extends a2{_compositionMode;_composing=!1;constructor(t,i,r){super(t,i),this._compositionMode=r,this._compositionMode==null&&(this._compositionMode=!LN())}writeValue(t){let i=t??"";this.setProperty("value",i)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(i){return new(i||n)(K(Xn),K(nn),K(BN,8))};static \u0275dir=Ne({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){i&1&&b("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},standalone:!1,features:[Gt([ON]),pt]})}return n})();function Oh(n){return n==null||Lh(n)===0}function Lh(n){return n==null?null:Array.isArray(n)||typeof n=="string"?n.length:n instanceof Set?n.size:null}var Di=new te(""),Ss=new te(""),UN=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,U=class{static min(e){return l2(e)}static max(e){return $N(e)}static required(e){return u2(e)}static requiredTrue(e){return HN(e)}static email(e){return GN(e)}static minLength(e){return qN(e)}static maxLength(e){return d2(e)}static pattern(e){return c2(e)}static nullValidator(e){return Kc()}static compose(e){return y2(e)}static composeAsync(e){return _2(e)}};function l2(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function $N(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function u2(n){return Oh(n.value)?{required:!0}:null}function HN(n){return n.value===!0?null:{required:!0}}function GN(n){return Oh(n.value)||UN.test(n.value)?null:{email:!0}}function qN(n){return e=>{let t=e.value?.length??Lh(e.value);return t===null||t===0?null:t<n?{minlength:{requiredLength:n,actualLength:t}}:null}}function d2(n){return e=>{let t=e.value?.length??Lh(e.value);return t!==null&&t>n?{maxlength:{requiredLength:n,actualLength:t}}:null}}function c2(n){if(!n)return Kc;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),i=>{if(Oh(i.value))return null;let r=i.value;return e.test(r)?null:{pattern:{requiredPattern:t,actualValue:r}}}}function Kc(n){return null}function m2(n){return n!=null}function p2(n){return hr(n)?ot(n):n}function f2(n){let e={};return n.forEach(t=>{e=t!=null?k(k({},e),t):e}),Object.keys(e).length===0?null:e}function g2(n,e){return e.map(t=>t(n))}function WN(n){return!n.validate}function h2(n){return n.map(e=>WN(e)?e:t=>e.validate(t))}function y2(n){if(!n)return null;let e=n.filter(m2);return e.length==0?null:function(t){return f2(g2(t,e))}}function Bh(n){return n!=null?y2(h2(n)):null}function _2(n){if(!n)return null;let e=n.filter(m2);return e.length==0?null:function(t){let i=g2(t,e).map(p2);return Gp(i).pipe(he(f2))}}function Uh(n){return n!=null?_2(h2(n)):null}function ZE(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function v2(n){return n._rawValidators}function C2(n){return n._rawAsyncValidators}function Ph(n){return n?Array.isArray(n)?n:[n]:[]}function Qc(n,e){return Array.isArray(n)?n.includes(e):n===e}function XE(n,e){let t=Ph(e);return Ph(n).forEach(r=>{Qc(t,r)||t.push(r)}),t}function e2(n,e){return Ph(e).filter(t=>!Qc(n,t))}var Zc=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Bh(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Uh(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},dn=class extends Zc{name;get formDirective(){return null}get path(){return null}},uo=class extends Zc{_parent=null;name=null;valueAccessor=null},Xc=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},jN={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},koe=q(k({},jN),{"[class.ng-submitted]":"isSubmitted"}),me=(()=>{class n extends Xc{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(K(uo,2))};static \u0275dir=Ne({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){i&2&&z("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},standalone:!1,features:[pt]})}return n})(),Fe=(()=>{class n extends Xc{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(K(dn,10))};static \u0275dir=Ne({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,r){i&2&&z("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},standalone:!1,features:[pt]})}return n})();var Al="VALID",Jc="INVALID",Cs="PENDING",Nl="DISABLED",xr=class{},em=class extends xr{value;source;constructor(e,t){super(),this.value=e,this.source=t}},Fl=class extends xr{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},Pl=class extends xr{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},xs=class extends xr{status;source;constructor(e,t){super(),this.status=e,this.source=t}},tm=class extends xr{source;constructor(e){super(),this.source=e}},Vl=class extends xr{source;constructor(e){super(),this.source=e}};function $h(n){return(om(n)?n.validators:n)||null}function zN(n){return Array.isArray(n)?Bh(n):n||null}function Hh(n,e){return(om(e)?e.asyncValidators:n)||null}function YN(n){return Array.isArray(n)?Uh(n):n||null}function om(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function x2(n,e,t){let i=n.controls;if(!(e?Object.keys(i):i).length)throw new j(1e3,"");if(!i[t])throw new j(1001,"")}function E2(n,e,t){n._forEachChild((i,r)=>{if(t[r]===void 0)throw new j(1002,"")})}var Es=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return Rt(this.statusReactive)}set status(e){Rt(()=>this.statusReactive.set(e))}_status=H(()=>this.statusReactive());statusReactive=S(void 0);get valid(){return this.status===Al}get invalid(){return this.status===Jc}get pending(){return this.status==Cs}get disabled(){return this.status===Nl}get enabled(){return this.status!==Nl}errors;get pristine(){return Rt(this.pristineReactive)}set pristine(e){Rt(()=>this.pristineReactive.set(e))}_pristine=H(()=>this.pristineReactive());pristineReactive=S(!0);get dirty(){return!this.pristine}get touched(){return Rt(this.touchedReactive)}set touched(e){Rt(()=>this.touchedReactive.set(e))}_touched=H(()=>this.touchedReactive());touchedReactive=S(!1);get untouched(){return!this.touched}_events=new gt;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(XE(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(XE(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(e2(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(e2(e,this._rawAsyncValidators))}hasValidator(e){return Qc(this._rawValidators,e)}hasAsyncValidator(e){return Qc(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(q(k({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new Pl(!0,i))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:i})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,i),t&&e.emitEvent!==!1&&this._events.next(new Pl(!1,i))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(q(k({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new Fl(!1,i))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,i),t&&e.emitEvent!==!1&&this._events.next(new Fl(!0,i))}markAsPending(e={}){this.status=Cs;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new xs(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(q(k({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Nl,this.errors=null,this._forEachChild(r=>{r.disable(q(k({},e),{onlySelf:!0}))}),this._updateValue();let i=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new em(this.value,i)),this._events.next(new xs(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(q(k({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Al,this._forEachChild(i=>{i.enable(q(k({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(q(k({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Al||this.status===Cs)&&this._runAsyncValidator(i,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new em(this.value,t)),this._events.next(new xs(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(q(k({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Nl:Al}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=Cs,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:e!==!1};let i=p2(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){let i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,i){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||i)&&this._events.next(new xs(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,i)}_initObservables(){this.valueChanges=new at,this.statusChanges=new at}_calculateStatus(){return this._allControlsDisabled()?Nl:this.errors?Jc:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Cs)?Cs:this._anyControlsHaveStatus(Jc)?Jc:Al}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let i=!this._anyControlsDirty(),r=this.pristine!==i;this.pristine=i,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),r&&this._events.next(new Fl(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new Pl(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){om(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=zN(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=YN(this._rawAsyncValidators)}},bs=class extends Es{constructor(e,t,i){super($h(t),Hh(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,i={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){E2(this,!0,e),Object.keys(e).forEach(i=>{x2(this,!0,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(i=>{let r=this.controls[i];r&&r.patchValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((i,r)=>{i.reset(e?e[r]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new Vl(this))}getRawValue(){return this._reduceChildren({},(e,t,i)=>(e[i]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,i)=>i._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let i=this.controls[t];i&&e(i,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,i]of Object.entries(this.controls))if(this.contains(t)&&e(i))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,i,r)=>((i.enabled||this.disabled)&&(t[r]=i.value),t))}_reduceChildren(e,t){let i=e;return this._forEachChild((r,o)=>{i=t(i,r,o)}),i}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var kh=class extends bs{};var Bl=new te("",{providedIn:"root",factory:()=>sm}),sm="always";function am(n,e){return[...e.path,n]}function nm(n,e,t=sm){Gh(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),KN(n,e),ZN(n,e),QN(n,e),JN(n,e)}function t2(n,e,t=!0){let i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),rm(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function im(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function JN(n,e){if(e.valueAccessor.setDisabledState){let t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function Gh(n,e){let t=v2(n);e.validator!==null?n.setValidators(ZE(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let i=C2(n);e.asyncValidator!==null?n.setAsyncValidators(ZE(i,e.asyncValidator)):typeof i=="function"&&n.setAsyncValidators([i]);let r=()=>n.updateValueAndValidity();im(e._rawValidators,r),im(e._rawAsyncValidators,r)}function rm(n,e){let t=!1;if(n!==null){if(e.validator!==null){let r=v2(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(s=>s!==e.validator);o.length!==r.length&&(t=!0,n.setValidators(o))}}if(e.asyncValidator!==null){let r=C2(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(s=>s!==e.asyncValidator);o.length!==r.length&&(t=!0,n.setAsyncValidators(o))}}}let i=()=>{};return im(e._rawValidators,i),im(e._rawAsyncValidators,i),t}function KN(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&b2(n,e)})}function QN(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&b2(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function b2(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function ZN(n,e){let t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function S2(n,e){n==null,Gh(n,e)}function XN(n,e){return rm(n,e)}function D2(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function eR(n){return Object.getPrototypeOf(n.constructor)===Ol}function w2(n,e){n._syncPendingControls(),e.forEach(t=>{let i=t.control;i.updateOn==="submit"&&i._pendingChange&&(t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}function T2(n,e){if(!e)return null;Array.isArray(e);let t,i,r;return e.forEach(o=>{o.constructor===Ce?t=o:eR(o)?i=o:r=o}),r||i||t||null}function tR(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}var nR={provide:dn,useExisting:bt(()=>Ul)},Rl=Promise.resolve(),Ul=(()=>{class n extends dn{callSetDisabledState;get submitted(){return Rt(this.submittedReactive)}_submitted=H(()=>this.submittedReactive());submittedReactive=S(!1);_directives=new Set;form;ngSubmit=new at;options;constructor(t,i,r){super(),this.callSetDisabledState=r,this.form=new bs({},Bh(t),Uh(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){Rl.then(()=>{let i=this._findContainer(t.path);t.control=i.registerControl(t.name,t.control),nm(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){Rl.then(()=>{let i=this._findContainer(t.path);i&&i.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){Rl.then(()=>{let i=this._findContainer(t.path),r=new bs({});S2(r,t),i.registerControl(t.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){Rl.then(()=>{let i=this._findContainer(t.path);i&&i.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,i){Rl.then(()=>{this.form.get(t.path).setValue(i)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submittedReactive.set(!0),w2(this.form,this._directives),this.ngSubmit.emit(t),this.form._events.next(new tm(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static \u0275fac=function(i){return new(i||n)(K(Di,10),K(Ss,10),K(Bl,8))};static \u0275dir=Ne({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,r){i&1&&b("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Gt([nR]),pt]})}return n})();function n2(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function i2(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var kl=class extends Es{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,i){super($h(t),Hh(i,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),om(t)&&(t.nonNullable||t.initialValueIsDefault)&&(i2(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1,t?.emitEvent!==!1&&this._events.next(new Vl(this))}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){n2(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){n2(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){i2(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var iR=n=>n instanceof kl,rR=(()=>{class n extends dn{_parent;ngOnInit(){this._checkParentType(),this.formDirective.addFormGroup(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormGroup(this)}get control(){return this.formDirective.getFormGroup(this)}get path(){return am(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}static \u0275fac=(()=>{let t;return function(r){return(t||(t=tn(n)))(r||n)}})();static \u0275dir=Ne({type:n,standalone:!1,features:[pt]})}return n})();var oR={provide:uo,useExisting:bt(()=>Ie)},r2=Promise.resolve(),Ie=(()=>{class n extends uo{_changeDetectorRef;callSetDisabledState;control=new kl;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new at;constructor(t,i,r,o,s,u){super(),this._changeDetectorRef=s,this.callSetDisabledState=u,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=T2(this,o)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),D2(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){nm(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){r2.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let i=t.isDisabled.currentValue,r=i!==0&&Zr(i);r2.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?am(t,this._parent):[t]}static \u0275fac=function(i){return new(i||n)(K(dn,9),K(Di,10),K(Ss,10),K(co,10),K(yr,8),K(Bl,8))};static \u0275dir=Ne({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Gt([oR]),pt,Bn]})}return n})();var $e=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275dir=Ne({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})(),sR={provide:co,useExisting:bt(()=>Ft),multi:!0},Ft=(()=>{class n extends Ol{writeValue(t){let i=t??"";this.setProperty("value",i)}registerOnChange(t){this.onChange=i=>{t(i==""?null:parseFloat(i))}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=tn(n)))(r||n)}})();static \u0275dir=Ne({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,r){i&1&&b("input",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},standalone:!1,features:[Gt([sR]),pt]})}return n})();var I2=new te("");var aR={provide:dn,useExisting:bt(()=>Pe)},Pe=(()=>{class n extends dn{callSetDisabledState;get submitted(){return Rt(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}_submitted=H(()=>this._submittedReactive());_submittedReactive=S(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];form=null;ngSubmit=new at;constructor(t,i,r){super(),this.callSetDisabledState=r,this._setValidators(t),this._setAsyncValidators(i)}ngOnChanges(t){t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(rm(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){let i=this.form.get(t.path);return nm(i,t,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),i}getControl(t){return this.form.get(t.path)}removeControl(t){t2(t.control||null,t,!1),tR(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,i){this.form.get(t.path).setValue(i)}onSubmit(t){return this._submittedReactive.set(!0),w2(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new tm(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0,i={}){this.form.reset(t,i),this._submittedReactive.set(!1)}_updateDomValue(){this.directives.forEach(t=>{let i=t.control,r=this.form.get(t.path);i!==r&&(t2(i||null,t),iR(r)&&(nm(r,t,this.callSetDisabledState),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let i=this.form.get(t.path);S2(i,t),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let i=this.form.get(t.path);i&&XN(i,t)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Gh(this.form,this),this._oldForm&&rm(this._oldForm,this)}static \u0275fac=function(i){return new(i||n)(K(Di,10),K(Ss,10),K(Bl,8))};static \u0275dir=Ne({type:n,selectors:[["","formGroup",""]],hostBindings:function(i,r){i&1&&b("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Gt([aR]),pt,Bn]})}return n})(),lR={provide:dn,useExisting:bt(()=>wi)},wi=(()=>{class n extends rR{name=null;constructor(t,i,r){super(),this._parent=t,this._setValidators(i),this._setAsyncValidators(r)}_checkParentType(){M2(this._parent)}static \u0275fac=function(i){return new(i||n)(K(dn,13),K(Di,10),K(Ss,10))};static \u0275dir=Ne({type:n,selectors:[["","formGroupName",""]],inputs:{name:[0,"formGroupName","name"]},standalone:!1,features:[Gt([lR]),pt]})}return n})(),uR={provide:dn,useExisting:bt(()=>Ti)},Ti=(()=>{class n extends dn{_parent;name=null;constructor(t,i,r){super(),this._parent=t,this._setValidators(i),this._setAsyncValidators(r)}ngOnInit(){M2(this._parent),this.formDirective.addFormArray(this)}ngOnDestroy(){this.formDirective?.removeFormArray(this)}get control(){return this.formDirective.getFormArray(this)}get formDirective(){return this._parent?this._parent.formDirective:null}get path(){return am(this.name==null?this.name:this.name.toString(),this._parent)}static \u0275fac=function(i){return new(i||n)(K(dn,13),K(Di,10),K(Ss,10))};static \u0275dir=Ne({type:n,selectors:[["","formArrayName",""]],inputs:{name:[0,"formArrayName","name"]},standalone:!1,features:[Gt([uR]),pt]})}return n})();function M2(n){return!(n instanceof wi)&&!(n instanceof Pe)&&!(n instanceof Ti)}var dR={provide:uo,useExisting:bt(()=>Be)},Be=(()=>{class n extends uo{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(t){}model;update=new at;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(t,i,r,o,s){super(),this._ngModelWarningConfig=s,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=T2(this,o)}ngOnChanges(t){this._added||this._setUpControl(),D2(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return am(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(i){return new(i||n)(K(dn,13),K(Di,10),K(Ss,10),K(co,10),K(I2,8))};static \u0275dir=Ne({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Gt([dR]),pt,Bn]})}return n})();var cR={provide:co,useExisting:bt(()=>Ae),multi:!0};function A2(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function mR(n){return n.split(":")[0]}var Ae=(()=>{class n extends Ol{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;appRefInjector=P(Gi).injector;destroyRef=P(On);cdr=P(yr);_queuedWrite=!1;_writeValueAfterRender(){this._queuedWrite||this.appRefInjector.destroyed||(this._queuedWrite=!0,$i({write:()=>{this.destroyRef.destroyed||(this._queuedWrite=!1,this.writeValue(this.value))}},{injector:this.appRefInjector}))}writeValue(t){this.cdr.markForCheck(),this.value=t;let i=this._getOptionId(t),r=A2(i,t);this.setProperty("value",r)}registerOnChange(t){this.onChange=i=>{this.value=this._getOptionValue(i),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),t))return i;return null}_getOptionValue(t){let i=mR(t);return this._optionMap.has(i)?this._optionMap.get(i):t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=tn(n)))(r||n)}})();static \u0275dir=Ne({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,r){i&1&&b("change",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Gt([cR]),pt]})}return n})(),ke=(()=>{class n{_element;_renderer;_select;id;constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(A2(this.id,t)),this._select._writeValueAfterRender())}set value(t){this._setElementValue(t),this._select&&this._select._writeValueAfterRender()}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select._writeValueAfterRender())}static \u0275fac=function(i){return new(i||n)(K(nn),K(Xn),K(Ae,9))};static \u0275dir=Ne({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})(),pR={provide:co,useExisting:bt(()=>N2),multi:!0};function o2(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function fR(n){return n.split(":")[0]}var N2=(()=>{class n extends Ol{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let i;if(Array.isArray(t)){let r=t.map(o=>this._getOptionId(o));i=(o,s)=>{o._setSelected(r.indexOf(s.toString())>-1)}}else i=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(t){this.onChange=i=>{let r=[],o=i.selectedOptions;if(o!==void 0){let s=o;for(let u=0;u<s.length;u++){let d=s[u],m=this._getOptionValue(d.value);r.push(m)}}else{let s=i.options;for(let u=0;u<s.length;u++){let d=s[u];if(d.selected){let m=this._getOptionValue(d.value);r.push(m)}}}this.value=r,t(r)}}_registerOption(t){let i=(this._idCounter++).toString();return this._optionMap.set(i,t),i}_getOptionId(t){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,t))return i;return null}_getOptionValue(t){let i=fR(t);return this._optionMap.has(i)?this._optionMap.get(i)._value:t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=tn(n)))(r||n)}})();static \u0275dir=Ne({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,r){i&1&&b("change",function(s){return r.onChange(s.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Gt([pR]),pt]})}return n})(),Ve=(()=>{class n{_element;_renderer;_select;id;_value;constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(o2(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(o2(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(i){return new(i||n)(K(nn),K(Xn),K(N2,9))};static \u0275dir=Ne({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})();function gR(n){return typeof n=="number"?n:parseInt(n,10)}function hR(n){return typeof n=="number"?n:parseFloat(n)}var lm=(()=>{class n{_validator=Kc;_onChange;_enabled;ngOnChanges(t){if(this.inputName in t){let i=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):Kc,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static \u0275fac=function(i){return new(i||n)};static \u0275dir=Ne({type:n,features:[Bn]})}return n})();var yR={provide:Di,useExisting:bt(()=>qh),multi:!0},qh=(()=>{class n extends lm{min;inputName="min";normalizeInput=t=>hR(t);createValidator=t=>l2(t);static \u0275fac=(()=>{let t;return function(r){return(t||(t=tn(n)))(r||n)}})();static \u0275dir=Ne({type:n,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(i,r){i&2&&ft("min",r._enabled?r.min:null)},inputs:{min:"min"},standalone:!1,features:[Gt([yR]),pt]})}return n})(),_R={provide:Di,useExisting:bt(()=>Wh),multi:!0};var Wh=(()=>{class n extends lm{required;inputName="required";normalizeInput=Zr;createValidator=t=>u2;enabled(t){return t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=tn(n)))(r||n)}})();static \u0275dir=Ne({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,r){i&2&&ft("required",r._enabled?"":null)},inputs:{required:"required"},standalone:!1,features:[Gt([_R]),pt]})}return n})();var vR={provide:Di,useExisting:bt(()=>$l),multi:!0},$l=(()=>{class n extends lm{maxlength;inputName="maxlength";normalizeInput=t=>gR(t);createValidator=t=>d2(t);static \u0275fac=(()=>{let t;return function(r){return(t||(t=tn(n)))(r||n)}})();static \u0275dir=Ne({type:n,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(i,r){i&2&&ft("maxlength",r._enabled?r.maxlength:null)},inputs:{maxlength:"maxlength"},standalone:!1,features:[Gt([vR]),pt]})}return n})(),CR={provide:Di,useExisting:bt(()=>Hl),multi:!0},Hl=(()=>{class n extends lm{pattern;inputName="pattern";normalizeInput=t=>t;createValidator=t=>c2(t);static \u0275fac=(()=>{let t;return function(r){return(t||(t=tn(n)))(r||n)}})();static \u0275dir=Ne({type:n,selectors:[["","pattern","","formControlName",""],["","pattern","","formControl",""],["","pattern","","ngModel",""]],hostVars:1,hostBindings:function(i,r){i&2&&ft("pattern",r._enabled?r.pattern:null)},inputs:{pattern:"pattern"},standalone:!1,features:[Gt([CR]),pt]})}return n})();var R2=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=ei({type:n});static \u0275inj=Nn({})}return n})(),Vh=class extends Es{constructor(e,t,i){super($h(t),Hh(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){Array.isArray(e)?e.forEach(i=>{this.controls.push(i),this._registerControl(i)}):(this.controls.push(e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,i={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(e,t={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,i={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),t&&(this.controls.splice(r,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){E2(this,!1,e),e.forEach((i,r)=>{x2(this,!1,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((i,r)=>{i.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new Vl(this))}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,i)=>i._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,i)=>{e(t,i)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function s2(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var He=(()=>{class n{useNonNullable=!1;get nonNullable(){let t=new n;return t.useNonNullable=!0,t}group(t,i=null){let r=this._reduceControls(t),o={};return s2(i)?o=i:i!==null&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new bs(r,o)}record(t,i=null){let r=this._reduceControls(t);return new kh(r,i)}control(t,i,r){let o={};return this.useNonNullable?(s2(i)?o=i:(o.validators=i,o.asyncValidators=r),new kl(t,q(k({},o),{nonNullable:!0}))):new kl(t,i,r)}array(t,i,r){let o=t.map(s=>this._createControl(s));return new Vh(o,i,r)}_reduceControls(t){let i={};return Object.keys(t).forEach(r=>{i[r]=this._createControl(t[r])}),i}_createControl(t){if(t instanceof kl)return t;if(t instanceof Es)return t;if(Array.isArray(t)){let i=t[0],r=t.length>1?t[1]:null,o=t.length>2?t[2]:null;return this.control(i,r,o)}else return this.control(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var be=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Bl,useValue:t.callSetDisabledState??sm}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=ei({type:n});static \u0275inj=Nn({imports:[R2]})}return n})(),Oe=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:I2,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:Bl,useValue:t.callSetDisabledState??sm}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=ei({type:n});static \u0275inj=Nn({imports:[R2]})}return n})();var mo=class mo{constructor(e){this.http=e;this.baseUrl=yn.apiUrl}getLedgerEntries(e){let t=new Se;return e&&Object.entries(e).forEach(([i,r])=>{r!=null&&r!==""&&(t=t.set(i,r.toString()))}),se(this.http.get(`${this.baseUrl}/ledger`,{params:t}))}createLedgerEntry(e){return se(this.http.post(`${this.baseUrl}/ledger`,e))}updateLedgerEntry(e){return se(this.http.put(`${this.baseUrl}/ledger`,e))}deleteLedgerEntry(e){let t=new Se().set("id",e.toString());return se(this.http.delete(`${this.baseUrl}/ledger`,{params:t}))}checkLedgerShipmentItems(e){let t=new Se().set("id",e.toString());return se(this.http.get(`${this.baseUrl}/ledger/check-shipment`,{params:t}))}getVendors(){return se(this.http.get(`${this.baseUrl}/vendors`))}updateVendor(e){return se(this.http.put(`${this.baseUrl}/vendors`,e))}deleteVendor(e){let t=new Se().set("id",e.toString());return se(this.http.delete(`${this.baseUrl}/vendors`,{params:t}))}getVendorByTaxId(e){let t=new Se().set("tax_id",e);return se(this.http.get(`${this.baseUrl}/vendors`,{params:t}))}getGLAccounts(e){let t=new Se;return e&&Object.entries(e).forEach(([i,r])=>{r!=null&&(t=t.set(i,r.toString()))}),se(this.http.get(`${this.baseUrl}/gl-accounts`,{params:t}))}resolveGLAccount(e,t){let i=new Se().set("itemGroup",e).set("subjectName",t);return se(this.http.get(`${this.baseUrl}/gl-accounts/resolve`,{params:i}))}async getAnnualSummary(e,t){let i=new Se().set("type","summary").set("startYear",e.toString()).set("endYear",t.toString()),r=await se(this.http.get(`${this.baseUrl}/financial-statements`,{params:i}));return r.success&&r.data&&(r.data=this.normalizeAnnualSummary(r.data)),r}getIncomeStatement(e,t){let i=new Se().set("type","income").set("year",e.toString()).set("quarter",t.toString());return se(this.http.get(`${this.baseUrl}/financial-statements`,{params:i}))}getBalanceSheet(e,t){let i=new Se().set("type","balance").set("year",e.toString()).set("quarter",t.toString());return se(this.http.get(`${this.baseUrl}/financial-statements`,{params:i}))}async getFinancialStatementsDetails(e,t){let i=new Se().set("year",e.toString()).set("type",t),r=await se(this.http.get(`${this.baseUrl}/financial-statements/details`,{params:i}));return r.success&&r.data&&(r.data=this.normalizeMonthlyDetail(r.data)),r}parseNumeric(e){if(e==null)return 0;let t=typeof e=="string"?parseFloat(e):e;return isNaN(t)?0:t}convertYearTotalsToNumbers(e){let t={};return Object.entries(e).forEach(([i,r])=>{if(i==="total")t.total=this.parseNumeric(r);else{let o=parseInt(i);isNaN(o)||(t[o]=this.parseNumeric(r))}}),t}normalizeAnnualSummary(e){return{years:e.years||[],revenue:this.convertYearTotalsToNumbers(e.revenue||{total:0}),expense:this.convertYearTotalsToNumbers(e.expense||{total:0}),net:this.convertYearTotalsToNumbers(e.net||{total:0}),unpaid:this.convertYearTotalsToNumbers(e.unpaid||{total:0})}}normalizeMonthlyDetail(e){let t=(e.data||[]).map(i=>({month:i.month,total:this.parseNumeric(i.total),items:(i.items||[]).map(r=>({name:r.name,amount:this.parseNumeric(r.amount)}))}));return{year:e.year,type:e.type,data:t}}createCustomer(e){return se(this.http.post(`${this.baseUrl}/customers`,e))}updateCustomer(e){return se(this.http.put(`${this.baseUrl}/customers`,e))}deleteCustomer(e){let t=new Se().set("id",e);return se(this.http.delete(`${this.baseUrl}/customers`,{params:t}))}getDailyRevenue(e){let t=new Se().set("date",e);return se(this.http.get(`${this.baseUrl}/daily-revenue`,{params:t}))}getMonthlyRevenue(e,t){let i=new Se().set("year",e.toString()).set("month",t.toString());return se(this.http.get(`${this.baseUrl}/daily-revenue`,{params:i}))}getCustomers(e){let t=new Se;return e?.search&&(t=t.set("search",e.search)),e?.limit&&(t=t.set("limit",e.limit.toString())),e?.offset&&(t=t.set("offset",e.offset.toString())),se(this.http.get(`${this.baseUrl}/customers`,{params:t}))}getProductSales(e){let t=new Se().set("startMonth",e.startMonth).set("endMonth",e.endMonth);return e.category&&(t=t.set("category",e.category)),e.limit&&(t=t.set("limit",e.limit.toString())),e.offset&&(t=t.set("offset",e.offset.toString())),se(this.http.get(`${this.baseUrl}/product-sales`,{params:t}))}getPurchaseCosts(e){let t=new Se().set("startMonth",e.startMonth).set("endMonth",e.endMonth);return se(this.http.get(`${this.baseUrl}/purchase-costs`,{params:t}))}getShipmentItems(e){let t=new Se;return e?.startDate&&(t=t.set("startDate",e.startDate)),e?.endDate&&(t=t.set("endDate",e.endDate)),e?.vendorId&&(t=t.set("vendorId",e.vendorId.toString())),e?.entryId&&(t=t.set("entryId",e.entryId.toString())),e?.documentNo&&(t=t.set("documentNo",e.documentNo)),e?.itemName&&(t=t.set("itemName",e.itemName)),e?.limit&&(t=t.set("limit",e.limit.toString())),e?.offset&&(t=t.set("offset",e.offset.toString())),se(this.http.get(`${this.baseUrl}/shipment-items`,{params:t}))}updateShipmentItem(e,t){let i=k({shipmentId:e},t);return se(this.http.put(`${this.baseUrl}/shipment-items`,i))}createShipmentItem(e){return se(this.http.post(`${this.baseUrl}/shipment-items`,e))}deleteShipmentItem(e){let t=new Se().set("id",e.toString());return se(this.http.delete(`${this.baseUrl}/shipment-items`,{params:t}))}getMonthlyTargets(e){let t=new Se;return e?.startMonth&&(t=t.set("startMonth",e.startMonth)),e?.endMonth&&(t=t.set("endMonth",e.endMonth)),se(this.http.get(`${this.baseUrl}/monthly-targets`,{params:t}))}createMonthlyTarget(e){return se(this.http.post(`${this.baseUrl}/monthly-targets`,e))}updateMonthlyTarget(e){return se(this.http.put(`${this.baseUrl}/monthly-targets`,e))}deleteMonthlyTarget(e){let t=new Se().set("targetId",e.toString());return se(this.http.delete(`${this.baseUrl}/monthly-targets`,{params:t}))}getDailySummaries(e){let t=new Se;return e&&Object.entries(e).forEach(([i,r])=>{r!=null&&(t=t.set(i,r.toString()))}),se(this.http.get(`${this.baseUrl}/payroll/daily-summaries`,{params:t}))}createDailySummary(e){return se(this.http.post(`${this.baseUrl}/payroll/daily-summaries`,e))}updateDailySummary(e,t){return se(this.http.put(`${this.baseUrl}/payroll/daily-summaries`,k({id:e},t)))}deleteDailySummary(e){let t=new Se().set("id",e.toString());return se(this.http.delete(`${this.baseUrl}/payroll/daily-summaries`,{params:t}))}getEmployeeWages(e){let t=new Se;return e&&Object.entries(e).forEach(([i,r])=>{r!=null&&(t=t.set(i,r.toString()))}),se(this.http.get(`${this.baseUrl}/payroll/employee-wages`,{params:t}))}createEmployeeWage(e){return se(this.http.post(`${this.baseUrl}/payroll/employee-wages`,e))}updateEmployeeWage(e,t){return se(this.http.put(`${this.baseUrl}/payroll/employee-wages`,k({id:e},t)))}deleteEmployeeWage(e){let t=new Se().set("id",e.toString());return se(this.http.delete(`${this.baseUrl}/payroll/employee-wages`,{params:t}))}getSpecialDates(e){let t=new Se;return e&&Object.entries(e).forEach(([i,r])=>{r!=null&&(t=t.set(i,r.toString()))}),se(this.http.get(`${this.baseUrl}/payroll/special-dates`,{params:t}))}createSpecialDate(e){return se(this.http.post(`${this.baseUrl}/payroll/special-dates`,e))}updateSpecialDate(e,t){return se(this.http.put(`${this.baseUrl}/payroll/special-dates`,k({id:e},t)))}deleteSpecialDate(e){let t=new Se().set("id",e.toString());return se(this.http.delete(`${this.baseUrl}/payroll/special-dates`,{params:t}))}async downloadLaborReport(e,t){let i=new Se().set("user_id",e.toString()).set("year_month",t);return se(this.http.get(`${this.baseUrl}/payroll/labor-report`,{params:i,responseType:"blob"}))}getEmployeeInfo(){return se(this.http.get(`${this.baseUrl}/payroll/employee-info`))}updateEmployeeInfo(e,t){let i=new Se().set("employee_number",e.toString());return se(this.http.put(`${this.baseUrl}/payroll/employee-info`,t,{params:i}))}uploadIdCardImage(e,t,i){let r=new FormData;return r.append("file",e),r.append("employee_id",t.toString()),r.append("card_side",i),se(this.http.post(`${this.baseUrl}/payroll/upload-id-card`,r))}updateEmployeeIdCardPath(e,t,i){let r=t==="front"?"id_card_front":"id_card_back",o=new Se().set("employee_number",e.toString());return se(this.http.put(`${this.baseUrl}/payroll/employee-info`,{[r]:i},{params:o}))}};mo.\u0275fac=function(t){return new(t||mo)(oe(Qt))},mo.\u0275prov=J({token:mo,factory:mo.\u0275fac,providedIn:"root"});var rt=mo;var xR=["monthlyChart"],ER=["purchaseChart"],Ds=()=>({style:"currency",currency:"TWD",minimumFractionDigits:0});function bR(n,e){if(n&1&&(l(0,"div",16)(1,"div",23)(2,"div",24),x(3,"ion-icon",25),a(),l(4,"div")(5,"p",26),c(6,"\u6536\u5165"),a(),l(7,"p",27),c(8),a()()(),l(9,"div",23)(10,"div",28),x(11,"ion-icon",29),a(),l(12,"div")(13,"p",26),c(14,"\u5E73\u5747\u6BCF\u65E5\u6536\u5165"),a(),l(15,"p",27),c(16),a()()(),l(17,"div",23)(18,"div",30),x(19,"ion-icon",31),a(),l(20,"div")(21,"p",26),c(22,"\u8CBB\u7528"),a(),l(23,"p",27),c(24),a()()(),l(25,"div",23)(26,"div",32),x(27,"ion-icon",33),a(),l(28,"div")(29,"p",26),c(30,"\u6298\u8B93"),a(),l(31,"p",27),c(32),a()()(),l(33,"div",23)(34,"div",34),x(35,"ion-icon",35),a(),l(36,"div")(37,"p",26),c(38,"\u9032\u8CA8"),a(),l(39,"p",27),c(40),a()()(),l(41,"div",23)(42,"div",36),x(43,"ion-icon",37),a(),l(44,"div")(45,"p",26),c(46,"\u6BDB\u5229"),a(),l(47,"p",27),c(48),a()()()()),n&2){let t=e,i=v();f(8),E(t.revenue.toLocaleString("zh-TW",Vt(6,Ds))),f(8),E(i.averageDailyRevenue().toLocaleString("zh-TW",Vt(7,Ds))),f(8),E(t.expenses.toLocaleString("zh-TW",Vt(8,Ds))),f(8),E(t.allowance.toLocaleString("zh-TW",Vt(9,Ds))),f(8),E(t.purchases.toLocaleString("zh-TW",Vt(10,Ds))),f(8),E(i.grossProfit().toLocaleString("zh-TW",Vt(11,Ds)))}}function SR(n,e){n&1&&(l(0,"div",17),c(1,"\u5728\u6B64\u65E5\u671F\u7BC4\u570D\u5167\u6C92\u6709\u6578\u64DA\u3002"),a())}var ws=class ws{constructor(){this.apiService=P(rt);this.formatDate=e=>{let t=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return`${t}-${i}-${r}`};this.today=new Date;this.firstDayOfMonth=new Date(this.today.getFullYear(),this.today.getMonth(),1);this.startDate=S(this.formatDate(this.firstDayOfMonth));this.endDate=S(this.formatDate(this.today));this.filterStartDate=this.formatDate(this.firstDayOfMonth);this.filterEndDate=this.formatDate(this.today);this.dashboardData=S(null);this.monthlyPerformance=S([]);this.isLoading=S(!1);this.errorMessage=S(null);this.averageDailyRevenue=H(()=>{let e=this.dashboardData();if(!e||!this.startDate()||!this.endDate())return 0;let t=new Date(this.startDate()),i=new Date(this.endDate());if(isNaN(t.getTime())||isNaN(i.getTime())||t>i)return 0;let r=i.getTime()-t.getTime(),o=Math.round(r/(1e3*60*60*24))+1;return o<=0?e.revenue:e.revenue/o});this.grossProfit=H(()=>{let e=this.dashboardData();return e?e.revenue-e.purchases-e.allowance-e.expenses:0});this.purchaseChartData=H(()=>{let e=this.dashboardData();return e?[{category:"\u9152\u6C34",amount:e.beveragePurchase},{category:"\u9910\u98F2",amount:e.foodPurchase},{category:"\u96EA\u8304(\u542B\u61C9\u4ED8)",amount:e.cigarPurchase}]:[]});this.loadData(this.startDate(),this.endDate()),Ci(()=>{let e=this.monthlyPerformance(),t=this.purchaseChartData();this.monthlyChart&&this.purchaseChart&&this.updateCharts(e,t)}),$i(()=>{this.createCharts()})}async loadData(e,t){this.isLoading.set(!0),this.errorMessage.set(null);try{let i=e||this.startDate(),r=t||this.endDate(),[o,s]=await Promise.all([this.apiService.getLedgerEntries({startDate:i,endDate:r,limit:1e4}),this.apiService.getLedgerEntries({startDate:this.calculateMonthsBack(12),endDate:r,limit:1e4})]);o.success&&o.data&&this.dashboardData.set(this.calculateDashboardMetrics(o.data)),s.success&&s.data&&this.monthlyPerformance.set(this.calculateMonthlyPerformance(s.data))}catch(i){console.error("\u8F09\u5165\u5100\u8868\u677F\u6578\u64DA\u6642\u767C\u751F\u932F\u8AA4:",i);let r=i instanceof Error?i.message:"\u7121\u6CD5\u8F09\u5165\u6578\u64DA\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66";this.errorMessage.set(r)}finally{this.isLoading.set(!1)}}calculateMonthsBack(e){let t=new Date(this.endDate()),i=new Date(t.getFullYear(),t.getMonth()-e,1);return this.formatDate(i)}calculateDashboardMetrics(e){let t={revenue:0,expenses:0,allowance:0,purchases:0,beveragePurchase:0,foodPurchase:0,cigarPurchase:0};console.log("=== \u8A08\u7B97\u5100\u8868\u677F\u6307\u6A19 ==="),console.log("\u6D41\u6C34\u5E33\u7B46\u6578:",e.length),console.log("\u6D41\u6C34\u5E33\u6A23\u672C\u524D3\u7B46:"),e.slice(0,3).forEach((y,_)=>{console.log(`  [${_}]`,{amount:y.amount,item_group:y.item_group,subject_name:y.subject_name})});let i=0,r=0,o=0,s=0,u=0,d=0,m=0,h=0;return e.forEach((y,_)=>{let C=Math.abs(Number(y.amount)||0),D=y.item_group||"",I=y.subject_name||"";h+=C,I==="\u92B7\u8CA8\u6536\u5165"&&(t.revenue+=C,i++,i<=3&&console.log(`\u6536\u5165[${i}]: amount=${C}, subject=${I}`)),D==="\u71DF\u696D\u8CBB\u7528"&&(t.expenses+=C,r++,r<=3&&console.log(`\u8CBB\u7528[${r}]: amount=${C}, itemGroup=${D}`)),I==="-\u92B7\u6216\u6298\u8B93"&&(t.allowance+=C,o++,o<=3&&console.log(`\u6298\u8B93[${o}]: amount=${C}, subject=${I}`)),I==="\u5B58\u8CA8-\u9910\u98F2"?(t.foodPurchase+=C,t.purchases+=C,d++):I==="\u5B58\u8CA8-\u9152\u6C34"?(t.beveragePurchase+=C,t.purchases+=C,u++):(I==="\u5B58\u8CA8-\u96EA\u8304"||I==="\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8")&&(t.cigarPurchase+=C,t.purchases+=C,m++)}),console.log("=== \u6700\u7D42\u8A08\u7B97\u7D50\u679C ==="),console.log("\u6536\u5165\u8A08\u6578:",i,"\u7E3D\u984D:",t.revenue),console.log("\u8CBB\u7528\u8A08\u6578:",r,"\u7E3D\u984D:",t.expenses),console.log("\u6298\u8B93\u8A08\u6578:",o,"\u7E3D\u984D:",t.allowance),console.log("\u9032\u8CA8\u8A08\u6578 - \u98DF\u54C1:",d,"\u9152\u6C34:",u,"\u96EA\u8304:",m),console.log("\u9032\u8CA8\u7E3D\u984D:",t.purchases),console.log("\u6BDB\u5229:",t.revenue-t.purchases-t.allowance-t.expenses),console.log("\u9A57\u8B49 - \u7E3D\u8655\u7406\u91D1\u984D:",h),console.log("\u6700\u7D42\u6307\u6A19:",t),t}calculateMonthlyPerformance(e){let t=new Map;for(let i=11;i>=0;i--){let r=new Date(new Date(this.endDate()).getFullYear(),new Date(this.endDate()).getMonth()-i,1),o=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`;t.set(o,{revenue:0,expenses:0,allowance:0,purchases:0,beveragePurchase:0,foodPurchase:0,cigarPurchase:0})}return e.forEach(i=>{if(!i.entry_date)return;let r=new Date(i.entry_date),o=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`;if(!t.has(o))return;let s=Math.abs(Number(i.amount)||0),u=i.item_group||"",d=i.subject_name||"",m=t.get(o);d==="\u92B7\u8CA8\u6536\u5165"&&(m.revenue+=s),u==="\u71DF\u696D\u8CBB\u7528"&&(m.expenses+=s),d==="-\u92B7\u6216\u6298\u8B93"&&(m.allowance+=s),(d==="\u5B58\u8CA8-\u9910\u98F2"||d==="\u5B58\u8CA8-\u9152\u6C34"||d==="\u5B58\u8CA8-\u96EA\u8304"||d==="\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8")&&(m.purchases+=s)}),Array.from(t.entries()).map(([i,r])=>({month:i,revenue:r.revenue,expenses:r.expenses,allowance:r.allowance,purchases:r.purchases}))}applyFilter(){let e=this.filterStartDate,t=this.filterEndDate;if(e&&t&&e>t){alert("\u8D77\u59CB\u65E5\u671F\u4E0D\u80FD\u665A\u65BC\u7D50\u675F\u65E5\u671F\u3002");return}this.startDate.set(e),this.endDate.set(t),this.loadData(e,t)}resetFilter(){let e=this.formatDate(this.firstDayOfMonth),t=this.formatDate(this.today);this.filterStartDate=e,this.filterEndDate=t,this.startDate.set(e),this.endDate.set(t),this.loadData(e,t)}formatCurrency(e){return e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}createCharts(){let e=this.monthlyChartRef.nativeElement.getContext("2d"),t=this.monthlyPerformance();this.monthlyChart=new Chart(e,{type:"line",data:{labels:t.map(o=>o.month),datasets:[{label:"\u92B7\u8CA8\u6536\u5165",data:t.map(o=>o.revenue),borderColor:"#4f46e5",backgroundColor:"rgba(79, 70, 229, 0.1)",fill:!0,tension:.4},{label:"\u8CBB\u7528",data:t.map(o=>o.expenses),borderColor:"#f43f5e",backgroundColor:"rgba(244, 63, 94, 0.1)",fill:!0,tension:.4},{label:"\u6298\u8B93",data:t.map(o=>o.allowance),borderColor:"#f59e0b",backgroundColor:"rgba(245, 158, 11, 0.1)",fill:!0,tension:.4},{label:"\u9032\u8CA8",data:t.map(o=>o.purchases),borderColor:"#8b5cf6",backgroundColor:"rgba(139, 92, 246, 0.1)",fill:!0,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{callback:o=>this.formatCurrency(o)}}}}});let i=this.purchaseChartRef.nativeElement.getContext("2d"),r=this.purchaseChartData();this.purchaseChart=new Chart(i,{type:"doughnut",data:{labels:r.map(o=>o.category),datasets:[{label:"\u9032\u8CA8\u5206\u985E",data:r.map(o=>o.amount),backgroundColor:["#3b82f6","#10b981","#f59e0b"],hoverOffset:4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{tooltip:{callbacks:{label:o=>{let s=o.label||"",u=o.raw||0,d=r.reduce((h,y)=>h+y.amount,0);if(d===0)return`${s}: ${this.formatCurrency(u)} (0.00%)`;let m=(u/d*100).toFixed(2);return`${s}: ${this.formatCurrency(u)} (${m}%)`}}}}}})}updateCharts(e,t){this.monthlyChart&&(this.monthlyChart.data.labels=e.map(i=>i.month),this.monthlyChart.data.datasets[0].data=e.map(i=>i.revenue),this.monthlyChart.data.datasets[1].data=e.map(i=>i.expenses),this.monthlyChart.data.datasets[2].data=e.map(i=>i.allowance),this.monthlyChart.data.datasets[3].data=e.map(i=>i.purchases),this.monthlyChart.update()),this.purchaseChart&&(this.purchaseChart.data.labels=t.map(i=>i.category),this.purchaseChart.data.datasets[0].data=t.map(i=>i.amount),this.purchaseChart.update())}};ws.\u0275fac=function(t){return new(t||ws)},ws.\u0275cmp=ie({type:ws,selectors:[["app-dashboard"]],viewQuery:function(t,i){if(t&1&&(Sn(xR,5),Sn(ER,5)),t&2){let r;on(r=sn())&&(i.monthlyChartRef=r.first),on(r=sn())&&(i.purchaseChartRef=r.first)}},decls:35,vars:3,consts:[["monthlyChart",""],["purchaseChart",""],[1,"space-y-8"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"flex","flex-col","sm:flex-row","items-center","gap-2","bg-white","p-3","rounded-xl","shadow-md","border","border-gray-200"],[1,"flex","items-center","gap-2"],["for","startDate",1,"text-sm","font-medium","text-gray-600"],["type","date","id","startDate",1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100",3,"ngModelChange","ngModel"],["for","endDate",1,"text-sm","font-medium","text-gray-600"],["type","date","id","endDate",1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100",3,"ngModelChange","ngModel"],[1,"flex","items-center","gap-2","mt-2","sm:mt-0"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","filter-outline"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-3","gap-6"],[1,"text-center","py-8","text-gray-500"],[1,"grid","grid-cols-1","lg:grid-cols-5","gap-6"],[1,"lg:col-span-3","bg-white","p-6","rounded-xl","shadow-md"],[1,"text-lg","font-semibold","text-gray-800","mb-4"],[1,"h-80"],[1,"lg:col-span-2","bg-white","p-6","rounded-xl","shadow-md"],[1,"bg-white","p-6","rounded-xl","shadow-md","flex","items-center","space-x-4"],[1,"bg-green-100","p-3","rounded-full"],["name","cash-outline",1,"text-2xl","text-green-600"],[1,"text-sm","text-gray-500"],[1,"text-2xl","font-semibold","text-gray-900"],[1,"bg-blue-100","p-3","rounded-full"],["name","calendar-outline",1,"text-2xl","text-blue-600"],[1,"bg-red-100","p-3","rounded-full"],["name","trending-down-outline",1,"text-2xl","text-red-600"],[1,"bg-yellow-100","p-3","rounded-full"],["name","pricetag-outline",1,"text-2xl","text-yellow-600"],[1,"bg-purple-100","p-3","rounded-full"],["name","cart-outline",1,"text-2xl","text-purple-600"],[1,"bg-indigo-100","p-3","rounded-full"],["name","pie-chart-outline",1,"text-2xl","text-indigo-600"]],template:function(t,i){if(t&1){let r=B();l(0,"div",2)(1,"div",3)(2,"h1",4),c(3,"\u5100\u8868\u677F"),a(),l(4,"div",5)(5,"div",6)(6,"label",7),c(7,"\u5F9E:"),a(),l(8,"input",8),Z("ngModelChange",function(s){return w(r),ee(i.filterStartDate,s)||(i.filterStartDate=s),T(s)}),a()(),l(9,"div",6)(10,"label",9),c(11,"\u81F3:"),a(),l(12,"input",10),Z("ngModelChange",function(s){return w(r),ee(i.filterEndDate,s)||(i.filterEndDate=s),T(s)}),a()(),l(13,"div",11)(14,"button",12),b("click",function(){return w(r),T(i.applyFilter())}),x(15,"ion-icon",13),l(16,"span"),c(17,"\u5957\u7528"),a()(),l(18,"button",14),b("click",function(){return w(r),T(i.resetFilter())}),x(19,"ion-icon",15),a()()()(),A(20,bR,49,12,"div",16)(21,SR,2,0,"div",17),l(22,"div",18)(23,"div",19)(24,"h3",20),c(25,"\u6708\u5EA6\u8868\u73FE"),a(),l(26,"div",21),x(27,"canvas",null,0),a()(),l(29,"div",22)(30,"h3",20),c(31,"\u7E3D\u9032\u8CA8\u5206\u6790"),a(),l(32,"div",21),x(33,"canvas",null,1),a()()()()}if(t&2){let r;f(8),Q("ngModel",i.filterStartDate),f(4),Q("ngModel",i.filterEndDate),f(8),N((r=i.dashboardData())?20:21,r)}},dependencies:[re,be,Ce,me,Ie],encapsulation:2,changeDetection:0});var um=ws;var DR=["detailChart"],wR=(n,e)=>e.value,Gl=(n,e)=>e.account,jh=(n,e)=>e.name,cm=(n,e)=>e.month;function TR(n,e){n&1&&(l(0,"div",2),x(1,"ion-icon",13),l(2,"span",14),c(3,"\u6B63\u5728\u52A0\u8F09\u6578\u64DA..."),a()())}function IR(n,e){if(n&1&&(l(0,"div",3),x(1,"ion-icon",15),l(2,"span",16),c(3),a()()),n&2){let t=v();f(3),E(t.errorMessage())}}function MR(n,e){if(n&1&&(l(0,"option",20),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),V("",t,"\u5E74")}}function AR(n,e){if(n&1&&(l(0,"option",20),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),V("",t,"\u5E74")}}function NR(n,e){n&1&&(x(0,"ion-icon",27),l(1,"span"),c(2,"\u5957\u7528\u4E2D..."),a())}function RR(n,e){n&1&&(x(0,"ion-icon",28),l(1,"span"),c(2,"\u5957\u7528"),a())}function FR(n,e){if(n&1){let t=B();l(0,"div",6)(1,"div",17)(2,"label",18),c(3,"\u5F9E:"),a(),l(4,"select",19),Z("ngModelChange",function(r){w(t);let o=v();return ee(o.selectedStartYearSummary,r)||(o.selectedStartYearSummary=r),T(r)}),O(5,MR,2,2,"option",20,W),a()(),l(7,"div",17)(8,"label",21),c(9,"\u81F3:"),a(),l(10,"select",22),Z("ngModelChange",function(r){w(t);let o=v();return ee(o.selectedEndYearSummary,r)||(o.selectedEndYearSummary=r),T(r)}),O(11,AR,2,2,"option",20,W),a()(),l(13,"div",23)(14,"button",24),b("click",function(){w(t);let r=v();return T(r.applySummaryFilter())}),A(15,NR,3,0)(16,RR,3,0),a(),l(17,"button",25),b("click",function(){w(t);let r=v();return T(r.resetSummaryFilter())}),x(18,"ion-icon",26),a()()()}if(n&2){let t=v();f(4),Q("ngModel",t.selectedStartYearSummary),f(),L(t.years()),f(5),Q("ngModel",t.selectedEndYearSummary),f(),L(t.years()),f(3),M("disabled",t.isLoading()),f(),N(t.isLoading()?15:16)}}function PR(n,e){if(n&1&&(l(0,"option",20),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),E(t)}}function kR(n,e){if(n&1&&(l(0,"option",20),c(1),a()),n&2){let t=e.$implicit;M("value",t.value),f(),E(t.label)}}function VR(n,e){n&1&&(x(0,"ion-icon",27),l(1,"span"),c(2,"\u5957\u7528\u4E2D..."),a())}function OR(n,e){n&1&&(x(0,"ion-icon",28),l(1,"span"),c(2,"\u5957\u7528"),a())}function LR(n,e){if(n&1){let t=B();l(0,"div",6)(1,"div",17)(2,"label",29),c(3,"\u5E74\u5EA6:"),a(),l(4,"select",30),Z("ngModelChange",function(r){w(t);let o=v();return ee(o.selectedYear,r)||(o.selectedYear=r),T(r)}),O(5,PR,2,2,"option",20,W),a()(),l(7,"div",17)(8,"label",31),c(9,"\u5B63\u5EA6:"),a(),l(10,"select",32),Z("ngModelChange",function(r){w(t);let o=v();return ee(o.selectedQuarter,r)||(o.selectedQuarter=r),T(r)}),O(11,kR,2,2,"option",20,wR),a()(),l(13,"div",23)(14,"button",24),b("click",function(){w(t);let r=v();return T(r.applyFilter())}),A(15,VR,3,0)(16,OR,3,0),a(),l(17,"button",25),b("click",function(){w(t);let r=v();return T(r.resetFilter())}),x(18,"ion-icon",26),a()()()}if(n&2){let t=v();f(4),Q("ngModel",t.selectedYear),f(),L(t.years()),f(5),Q("ngModel",t.selectedQuarter),f(),L(t.quarters()),f(3),M("disabled",t.isLoading()),f(),N(t.isLoading()?15:16)}}function BR(n,e){if(n&1&&(l(0,"th",37),c(1),a()),n&2){let t=e.$implicit;f(),V("",t,"\u5E74")}}function UR(n,e){if(n&1){let t=B();l(0,"td",51),b("click",function(){let r=w(t).$implicit,o=v(3);return T(o.openDetailModal(r,"revenue"))}),c(1),a()}if(n&2){let t=e.$implicit,i=v(),r=v(2);f(),E(r.formatCurrency(i.revenue[t]))}}function $R(n,e){if(n&1&&(l(0,"td",54),c(1),a()),n&2){let t=e.$implicit,i=v(2),r=v(2);f(),V(" (",r.formatCurrency(i.salesDiscount[t]),") ")}}function HR(n,e){if(n&1&&(l(0,"tr",43)(1,"td",52),x(2,"ion-icon",53),c(3,"-\u92B7\u8CA8\u6298\u8B93 "),a(),O(4,$R,2,1,"td",54,W),l(6,"td",55),c(7),a()()),n&2){let t=v(),i=v(2);f(4),L(t.years),f(3),V(" (",i.formatCurrency(t.salesDiscount.total),") ")}}function GR(n,e){if(n&1){let t=B();l(0,"td",56),b("click",function(){let r=w(t).$implicit,o=v(3);return T(o.openDetailModal(r,"expense"))}),c(1),a()}if(n&2){let t=e.$implicit,i=v(),r=v(2);f(),E(r.formatCurrency(i.expense[t]))}}function qR(n,e){if(n&1&&(l(0,"td",37),c(1),a()),n&2){let t=e.$implicit,i=v(),r=v(2);z("text-red-600",i.net[t]<0),f(),E(r.formatCurrency(i.net[t]))}}function WR(n,e){if(n&1){let t=B();l(0,"td",57),b("click",function(){let r=w(t).$implicit,o=v(3);return T(o.openDetailModal(r,"unpaid"))}),c(1),a()}if(n&2){let t=e.$implicit,i=v(),r=v(2);f(),E(r.formatCurrency(i.unpaid[t]))}}function jR(n,e){if(n&1&&(l(0,"table",33)(1,"thead",35)(2,"tr")(3,"th",36),c(4,"\u9805\u76EE"),a(),O(5,BR,2,1,"th",37,W),l(7,"th",37),c(8,"\u7E3D\u8A08"),a()()(),l(9,"tbody")(10,"tr",38)(11,"td",39),x(12,"ion-icon",40),c(13,"\u6536\u5165 "),a(),O(14,UR,2,1,"td",41,W),l(16,"td",42),c(17),a()(),A(18,HR,8,1,"tr",43),l(19,"tr",44)(20,"td",39),x(21,"ion-icon",40),c(22,"\u652F\u51FA "),a(),O(23,GR,2,1,"td",45,W),l(25,"td",42),c(26),a()(),l(27,"tr",46)(28,"td",36),c(29,"\u7E3D\u8A08"),a(),O(30,qR,2,3,"td",47,W),l(32,"td",37),c(33),a()(),l(34,"tr",48)(35,"td",39),x(36,"ion-icon",40),c(37,"\u672A\u4ED8 "),a(),O(38,WR,2,1,"td",49,W),l(40,"td",50),c(41),a()()()()),n&2){let t=e,i=v(2);f(5),L(t.years),f(9),L(t.years),f(3),E(i.formatCurrency(t.revenue.total)),f(),N(t.salesDiscount?18:-1),f(5),L(t.years),f(3),E(i.formatCurrency(t.expense.total)),f(4),L(t.years),f(2),z("text-red-600",t.net.total<0),f(),E(i.formatCurrency(t.net.total)),f(5),L(t.years),f(3),E(i.formatCurrency(t.unpaid.total))}}function zR(n,e){n&1&&(l(0,"div",34),c(1,"\u7121\u6CD5\u8F09\u5165\u7E3D\u8868\u6578\u64DA\u3002"),a())}function YR(n,e){if(n&1&&A(0,jR,42,7,"table",33)(1,zR,2,0,"div",34),n&2){let t,i=v();N((t=i.annualSummary())?0:1,t)}}function JR(n,e){if(n&1&&(l(0,"th",63),c(1),a()),n&2){let t=e.$implicit,i=v(3);f(),E(i.formatMonth(t))}}function KR(n,e){if(n&1&&(l(0,"td",82),c(1),a()),n&2){let t=e.$implicit,i=v().$implicit,r=v(3);f(),E(r.formatCurrency(i.monthlyAmounts[t]||0))}}function QR(n,e){if(n&1&&(l(0,"tr",66),x(1,"td",78),l(2,"td",79),c(3),a(),l(4,"td",80),c(5),a(),l(6,"td",81),c(7),a(),O(8,KR,2,1,"td",82,W),a()),n&2){let t=e.$implicit,i=v(),r=v(2);f(3),E(t.account),f(2),E(r.formatCurrency(t.total)),f(2),V("",t.percentage==null?null:t.percentage.toFixed(2),"%"),f(),L(i.months)}}function ZR(n,e){if(n&1&&(l(0,"td",71),c(1),a()),n&2){let t=e.$implicit,i=v(),r=v(2);f(),E(r.formatCurrency(i.operatingRevenue.monthlyTotals[t]||0))}}function XR(n,e){if(n&1&&(l(0,"td",82),c(1),a()),n&2){let t=e.$implicit,i=v().$implicit,r=v(3);f(),E(r.formatCurrency(i.monthlyAmounts[t]||0))}}function e6(n,e){if(n&1&&(l(0,"tr",66),x(1,"td",78),l(2,"td",79),c(3),a(),l(4,"td",80),c(5),a(),l(6,"td",81),c(7),a(),O(8,XR,2,1,"td",82,W),a()),n&2){let t=e.$implicit,i=v(),r=v(2);f(3),E(t.account),f(2),E(r.formatCurrency(t.total)),f(2),V("",t.percentage==null?null:t.percentage.toFixed(2),"%"),f(),L(i.months)}}function t6(n,e){if(n&1&&(l(0,"td",71),c(1),a()),n&2){let t=e.$implicit,i=v(),r=v(2);f(),E(r.formatCurrency(i.operatingExpenses.monthlyTotals[t]||0))}}function n6(n,e){if(n&1&&(l(0,"td",77),c(1),a()),n&2){let t=e.$implicit,i=v(),r=v(2);f(),E(r.formatCurrency(i.netIncome.monthlyTotals[t]||0))}}function i6(n,e){if(n&1&&(l(0,"div",58)(1,"table",33)(2,"thead",35)(3,"tr")(4,"th",59),c(5,"\u9805\u76EE"),a(),l(6,"th",60),c(7,"\u79D1\u76EE"),a(),l(8,"th",61),c(9,"\u7E3D\u8A08"),a(),l(10,"th",62),c(11,"%"),a(),O(12,JR,2,1,"th",63,W),a()(),l(14,"tbody")(15,"tr",64)(16,"td",65),c(17,"\u71DF\u696D\u6536\u5165"),a(),x(18,"td"),a(),O(19,QR,10,3,"tr",66,Gl),l(21,"tr",67)(22,"td",68),c(23,"\u71DF\u696D\u6536\u5165\u5C0F\u8A08"),a(),l(24,"td",69),c(25),a(),l(26,"td",70),c(27,"100.00%"),a(),O(28,ZR,2,1,"td",71,W),a(),l(30,"tr"),x(31,"td",72),a(),l(32,"tr",64)(33,"td",65),c(34,"\u71DF\u696D\u8CBB\u7528"),a(),x(35,"td"),a(),O(36,e6,10,3,"tr",66,Gl),l(38,"tr",67)(39,"td",68),c(40,"\u71DF\u696D\u8CBB\u7528\u5C0F\u8A08"),a(),l(41,"td",69),c(42),a(),l(43,"td",70),c(44,"100.00%"),a(),O(45,t6,2,1,"td",71,W),a(),l(47,"tr"),x(48,"td",72),a(),l(49,"tr",73)(50,"td",74),c(51,"\u7E3D\u8A08 (\u672C\u671F\u640D\u76CA)"),a(),l(52,"td",75),c(53),a(),x(54,"td",76),O(55,n6,2,1,"td",77,W),a()()()()),n&2){let t=e,i=v(2);f(12),L(t.months),f(6),ft("colspan",t.months.length+1),f(),L(t.operatingRevenue.items),f(6),E(i.formatCurrency(t.operatingRevenue.grandTotal)),f(3),L(t.months),f(3),ft("colspan",t.months.length+4),f(4),ft("colspan",t.months.length+1),f(),L(t.operatingExpenses.items),f(6),E(i.formatCurrency(t.operatingExpenses.grandTotal)),f(3),L(t.months),f(3),ft("colspan",t.months.length+4),f(5),E(i.formatCurrency(t.netIncome.grandTotal)),f(2),L(t.months)}}function r6(n,e){n&1&&(l(0,"div",34),c(1,"\u7121\u6CD5\u8F09\u5165\u640D\u76CA\u8868\u6578\u64DA\u3002"),a())}function o6(n,e){if(n&1&&A(0,i6,57,7,"div",58)(1,r6,2,0,"div",34),n&2){let t,i=v();N((t=i.monthlyIncomeStatement())?0:1,t)}}function s6(n,e){if(n&1&&(l(0,"th",63),c(1),a()),n&2){let t=e.$implicit,i=v(3);f(),E(i.formatMonth(t))}}function a6(n,e){if(n&1&&(l(0,"td",82),c(1),a()),n&2){let t=e.$implicit,i=v().$implicit,r=v(3);f(),E(r.formatCurrency(i.monthlyAmounts[t]||0))}}function l6(n,e){if(n&1&&(l(0,"tr",66),x(1,"td",78),l(2,"td",79),c(3),a(),l(4,"td",80),c(5),a(),l(6,"td",81),c(7),a(),O(8,a6,2,1,"td",82,W),a()),n&2){let t=e.$implicit,i=v(),r=v(2);f(3),E(t.account),f(2),E(r.formatCurrency(t.total)),f(2),V("",t.percentage==null?null:t.percentage.toFixed(2),"%"),f(),L(i.months)}}function u6(n,e){if(n&1&&(l(0,"td",71),c(1),a()),n&2){let t=e.$implicit,i=v(),r=v(2);f(),E(r.formatCurrency(i.assets.monthlyTotals[t]||0))}}function d6(n,e){if(n&1&&(l(0,"td",82),c(1),a()),n&2){let t=e.$implicit,i=v().$implicit,r=v(3);f(),E(r.formatCurrency(i.monthlyAmounts[t]||0))}}function c6(n,e){if(n&1&&(l(0,"tr",66),x(1,"td",78),l(2,"td",79),c(3),a(),l(4,"td",80),c(5),a(),l(6,"td",81),c(7),a(),O(8,d6,2,1,"td",82,W),a()),n&2){let t=e.$implicit,i=v(),r=v(2);f(3),E(t.account),f(2),E(r.formatCurrency(t.total)),f(2),V("",t.percentage==null?null:t.percentage.toFixed(2),"%"),f(),L(i.months)}}function m6(n,e){if(n&1&&(l(0,"td",71),c(1),a()),n&2){let t=e.$implicit,i=v(),r=v(2);f(),E(r.formatCurrency(i.liabilities.monthlyTotals[t]||0))}}function p6(n,e){if(n&1&&(l(0,"td",82),c(1),a()),n&2){let t=e.$implicit,i=v().$implicit,r=v(3);f(),E(r.formatCurrency(i.monthlyAmounts[t]||0))}}function f6(n,e){if(n&1&&(l(0,"tr",66),x(1,"td",78),l(2,"td",79),c(3),a(),l(4,"td",80),c(5),a(),l(6,"td",81),c(7),a(),O(8,p6,2,1,"td",82,W),a()),n&2){let t=e.$implicit,i=v(),r=v(2);f(3),E(t.account),f(2),E(r.formatCurrency(t.total)),f(2),V("",t.percentage==null?null:t.percentage.toFixed(2),"%"),f(),L(i.months)}}function g6(n,e){if(n&1&&(l(0,"td",71),c(1),a()),n&2){let t=e.$implicit,i=v(),r=v(2);f(),E(r.formatCurrency(i.equity.monthlyTotals[t]||0))}}function h6(n,e){if(n&1&&(l(0,"td",88),c(1),a()),n&2){let t=e.$implicit,i=v(),r=v(2);f(),E(r.formatCurrency(i.totalLiabilitiesAndEquity.monthlyTotals[t]||0))}}function y6(n,e){if(n&1&&(l(0,"div",58)(1,"table",33)(2,"thead",35)(3,"tr")(4,"th",59),c(5,"\u9805\u76EE"),a(),l(6,"th",60),c(7,"\u79D1\u76EE"),a(),l(8,"th",61),c(9,"\u7E3D\u8A08"),a(),l(10,"th",62),c(11,"%"),a(),O(12,s6,2,1,"th",63,W),a()(),l(14,"tbody")(15,"tr",64)(16,"td",65),c(17,"\u8CC7\u7522"),a(),x(18,"td"),a(),O(19,l6,10,3,"tr",66,Gl),l(21,"tr",67)(22,"td",68),c(23,"\u8CC7\u7522\u5C0F\u8A08"),a(),l(24,"td",83),c(25),a(),l(26,"td",70),c(27,"100.00%"),a(),O(28,u6,2,1,"td",71,W),a(),l(30,"tr"),x(31,"td",72),a(),l(32,"tr",64)(33,"td",65),c(34,"\u8CA0\u50B5"),a(),x(35,"td"),a(),O(36,c6,10,3,"tr",66,Gl),l(38,"tr",84)(39,"td",85),c(40,"\u8CA0\u50B5\u5C0F\u8A08"),a(),l(41,"td",86),c(42),a(),x(43,"td",87),O(44,m6,2,1,"td",71,W),a(),l(46,"tr"),x(47,"td",72),a(),l(48,"tr",64)(49,"td",65),c(50,"\u696D\u4E3B\u6B0A\u76CA"),a(),x(51,"td"),a(),O(52,f6,10,3,"tr",66,Gl),l(54,"tr",84)(55,"td",85),c(56,"\u696D\u4E3B\u6B0A\u76CA\u5C0F\u8A08"),a(),l(57,"td",86),c(58),a(),x(59,"td",87),O(60,g6,2,1,"td",71,W),a(),l(62,"tr"),x(63,"td",72),a(),l(64,"tr",67)(65,"td",68),c(66,"\u8CA0\u50B5\u53CA\u696D\u4E3B\u6B0A\u76CA\u7E3D\u8A08"),a(),l(67,"td",83),c(68),a(),x(69,"td",70),O(70,h6,2,1,"td",88,W),a()()()()),n&2){let t=e,i=v(2);f(12),L(t.months),f(6),ft("colspan",t.months.length+1),f(),L(t.assets.items),f(6),E(i.formatCurrency(t.assets.grandTotal)),f(3),L(t.months),f(3),ft("colspan",t.months.length+4),f(4),ft("colspan",t.months.length+1),f(),L(t.liabilities.items),f(6),E(i.formatCurrency(t.liabilities.grandTotal)),f(2),L(t.months),f(3),ft("colspan",t.months.length+4),f(4),ft("colspan",t.months.length+1),f(),L(t.equity.items),f(6),E(i.formatCurrency(t.equity.grandTotal)),f(2),L(t.months),f(3),ft("colspan",t.months.length+4),f(5),E(i.formatCurrency(t.totalLiabilitiesAndEquity.grandTotal)),f(2),L(t.months)}}function _6(n,e){n&1&&(l(0,"div",34),c(1,"\u7121\u6CD5\u8F09\u5165\u8CC7\u7522\u8CA0\u50B5\u8868\u6578\u64DA\u3002"),a())}function v6(n,e){if(n&1&&A(0,y6,72,10,"div",58)(1,_6,2,0,"div",34),n&2){let t,i=v();N((t=i.monthlyBalanceSheet())?0:1,t)}}function C6(n,e){n&1&&(l(0,"tr")(1,"th",100),c(2,"\u6708\u4EFD"),a(),l(3,"th",101),c(4,"\u7E3D\u8A08\u91D1\u984D"),a(),l(5,"th",101),c(6,"\u92B7\u8CA8\u6536\u5165"),a(),l(7,"th",101),c(8,"\u5176\u4ED6\u6536\u5165"),a(),l(9,"th",101),c(10,"-\u92B7\u8CA8\u6298\u8B93"),a()())}function x6(n,e){n&1&&(l(0,"tr")(1,"th",100),c(2,"\u6708\u4EFD"),a(),l(3,"th",101),c(4,"\u7E3D\u8A08\u91D1\u984D"),a(),l(5,"th",101),c(6,"\u5546\u54C1"),a(),l(7,"th",101),c(8,"\u96DC\u9805\u8B8A\u52D5"),a()())}function E6(n,e){n&1&&(l(0,"tr")(1,"th",100),c(2,"\u6708\u4EFD"),a(),l(3,"th",101),c(4,"\u7E3D\u8A08\u91D1\u984D"),a(),l(5,"th",101),c(6,"\u61C9\u4ED8\u5E33\u6B3E"),a(),l(7,"th",101),c(8,"\u61C9\u4ED8\u88DD\u6F62\u6B3E"),a(),l(9,"th",101),c(10,"\u61C9\u4ED8\u85AA\u8CC7"),a(),l(11,"th",101),c(12,"\u61C9\u4ED8\u80A1\u6771\u56DE\u994B\u91D1"),a(),l(13,"th",101),c(14,"\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8"),a()())}function b6(n,e){if(n&1&&(l(0,"th",100),c(1),a(),l(2,"th",101),c(3,"\u91D1\u984D"),a()),n&2){let t=e.$implicit;f(),E(t.name)}}function S6(n,e){if(n&1&&(l(0,"tr")(1,"th",100),c(2,"\u6708\u4EFD"),a(),l(3,"th",101),c(4,"\u91D1\u984D"),a(),O(5,b6,4,1,null,null,jh),a()),n&2){let t=v();f(5),L(t.data[0].items)}}function D6(n,e){if(n&1&&(l(0,"tr",102)(1,"td",103),c(2),a(),l(3,"td",104),c(4),a(),l(5,"td",101),c(6),a(),l(7,"td",101),c(8),a(),l(9,"td",105),c(10),a()()),n&2){let t=e.$implicit,i=v(4);f(2),V("",t.month,"\u6708"),f(2),E(i.formatCurrency(t.total)),f(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u92B7\u8CA8\u6536\u5165"))),f(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u5176\u4ED6\u6536\u5165"))),f(2),V(" (",i.formatCurrency(i.getDetailItemAmount(t,"-\u92B7\u8CA8\u6298\u8B93")),") ")}}function w6(n,e){if(n&1&&O(0,D6,11,5,"tr",102,cm),n&2){let t=v();L(t.data)}}function T6(n,e){if(n&1&&(l(0,"tr",102)(1,"td",103),c(2),a(),l(3,"td",104),c(4),a(),l(5,"td",101),c(6),a(),l(7,"td",101),c(8),a()()),n&2){let t=e.$implicit,i=v(4);f(2),V("",t.month,"\u6708"),f(2),E(i.formatCurrency(t.total)),f(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u5546\u54C1"))),f(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u96DC\u9805\u8B8A\u52D5")))}}function I6(n,e){if(n&1&&O(0,T6,9,4,"tr",102,cm),n&2){let t=v();L(t.data)}}function M6(n,e){if(n&1&&(l(0,"tr",102)(1,"td",103),c(2),a(),l(3,"td",104),c(4),a(),l(5,"td",101),c(6),a(),l(7,"td",101),c(8),a(),l(9,"td",101),c(10),a(),l(11,"td",101),c(12),a(),l(13,"td",101),c(14),a()()),n&2){let t=e.$implicit,i=v(4);f(2),V("",t.month,"\u6708"),f(2),E(i.formatCurrency(t.total)),f(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u61C9\u4ED8\u5E33\u6B3E"))),f(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u61C9\u4ED8\u88DD\u6F62\u6B3E"))),f(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u61C9\u4ED8\u85AA\u8CC7"))),f(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u61C9\u4ED8\u80A1\u6771\u56DE\u994B\u91D1"))),f(2),E(i.formatCurrency(i.getDetailItemAmount(t,"\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8")))}}function A6(n,e){if(n&1&&O(0,M6,15,7,"tr",102,cm),n&2){let t=v();L(t.data)}}function N6(n,e){if(n&1&&(l(0,"td",100),c(1),a(),l(2,"td",101),c(3),a()),n&2){let t=e.$implicit,i=v(5);f(),E(t.name),f(2),E(i.formatCurrency(t.amount))}}function R6(n,e){if(n&1&&(l(0,"tr",102)(1,"td",103),c(2),a(),l(3,"td",104),c(4),a(),O(5,N6,4,2,null,null,jh),a()),n&2){let t=e.$implicit,i=v(4);f(2),V("",t.month,"\u6708"),f(2),E(i.formatCurrency(t.total)),f(),L(t.items)}}function F6(n,e){if(n&1&&O(0,R6,7,2,"tr",102,cm),n&2){let t=v();L(t.data)}}function P6(n,e){if(n&1&&(l(0,"tr",99)(1,"td",106),c(2,"\u5C0F\u8A08"),a(),l(3,"td",107),c(4),a(),l(5,"td",107),c(6),a(),l(7,"td",107),c(8),a(),l(9,"td",108),c(10),a()()),n&2){let t=v(3);f(4),E(t.formatCurrency(t.detailModalTotal())),f(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u92B7\u8CA8\u6536\u5165"))),f(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u5176\u4ED6\u6536\u5165"))),f(2),V(" (",t.formatCurrency(t.calculateMonthlyItemTotal("-\u92B7\u8CA8\u6298\u8B93")),") ")}}function k6(n,e){if(n&1&&(l(0,"tr",99)(1,"td",106),c(2,"\u5C0F\u8A08"),a(),l(3,"td",107),c(4),a(),l(5,"td",107),c(6),a(),l(7,"td",107),c(8),a()()),n&2){let t=v(3);f(4),E(t.formatCurrency(t.detailModalTotal())),f(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u5546\u54C1"))),f(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u96DC\u9805\u8B8A\u52D5")))}}function V6(n,e){if(n&1&&(l(0,"tr",99)(1,"td",106),c(2,"\u5C0F\u8A08"),a(),l(3,"td",107),c(4),a(),l(5,"td",107),c(6),a(),l(7,"td",107),c(8),a(),l(9,"td",107),c(10),a(),l(11,"td",107),c(12),a(),l(13,"td",107),c(14),a()()),n&2){let t=v(3);f(4),E(t.formatCurrency(t.detailModalTotal())),f(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u61C9\u4ED8\u5E33\u6B3E"))),f(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u61C9\u4ED8\u88DD\u6F62\u6B3E"))),f(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u61C9\u4ED8\u85AA\u8CC7"))),f(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u61C9\u4ED8\u80A1\u6771\u56DE\u994B\u91D1"))),f(2),E(t.formatCurrency(t.calculateMonthlyItemTotal("\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8")))}}function O6(n,e){if(n&1&&(l(0,"td",106),c(1),a(),l(2,"td",107),c(3),a()),n&2){let t=e.$implicit,i=v(4);f(),E(t.name),f(2),E(i.formatCurrency(i.calculateMonthlyItemTotal(t.name)))}}function L6(n,e){if(n&1&&(l(0,"tr",99)(1,"td",106),c(2,"\u5C0F\u8A08"),a(),l(3,"td",107),c(4),a(),O(5,O6,4,2,null,null,jh),a()),n&2){let t=v(),i=v(2);f(4),E(i.formatCurrency(i.detailModalTotal())),f(),L(t.data[0].items)}}function B6(n,e){if(n&1){let t=B();l(0,"div",89)(1,"div",90)(2,"h3",91),c(3),a(),l(4,"button",92),b("click",function(){w(t);let r=v(2);return T(r.closeDetailModal())}),x(5,"ion-icon",93),a()(),l(6,"div",94)(7,"div",95),x(8,"canvas",null,0),a(),l(10,"div",96)(11,"table",33)(12,"thead",97),A(13,C6,11,0,"tr")(14,x6,9,0,"tr")(15,E6,15,0,"tr")(16,S6,7,0,"tr"),a(),l(17,"tbody"),A(18,w6,2,0)(19,I6,2,0)(20,A6,2,0)(21,F6,2,0),a(),l(22,"tfoot",98),A(23,P6,11,4,"tr",99)(24,k6,9,3,"tr",99)(25,V6,15,6,"tr",99)(26,L6,7,1,"tr",99),a()()()()()}if(n&2){let t=e,i=v(2);f(3),kt("",t.year," \u5E74 ",t.type,"\u660E\u7D30 (\u7E3D\u8A08: ",i.formatCurrency(i.detailModalTotal()),")"),f(10),N(t.type==="\u6536\u5165"?13:t.type==="\u652F\u51FA"?14:t.type==="\u672A\u4ED8"?15:16),f(5),N(t.type==="\u6536\u5165"?18:t.type==="\u652F\u51FA"?19:t.type==="\u672A\u4ED8"?20:21),f(5),N(t.type==="\u6536\u5165"?23:t.type==="\u652F\u51FA"?24:t.type==="\u672A\u4ED8"?25:26)}}function U6(n,e){if(n&1&&(l(0,"div",12),A(1,B6,27,6,"div",89),a()),n&2){let t,i=v();f(),N((t=i.detailModalData())?1:-1,t)}}var Ts=class Ts{constructor(){this.apiService=P(rt);this.activeStatement=S("summary");this.annualSummary=S(null);this.monthlyIncomeStatement=S(null);this.monthlyBalanceSheet=S(null);this.isLoading=S(!1);this.errorMessage=S(null);this.isDetailModalOpen=S(!1);this.detailModalData=S(null);this.years=S([2026,2025,2024]);this.quarters=S([{value:"all",label:"\u5168\u5E74"},{value:1,label:"\u7B2C\u4E00\u5B63"},{value:2,label:"\u7B2C\u4E8C\u5B63"},{value:3,label:"\u7B2C\u4E09\u5B63"},{value:4,label:"\u7B2C\u56DB\u5B63"}]);this.selectedYear=S(2026);this.selectedQuarter=S("all");this.selectedStartYearSummary=S(2024);this.selectedEndYearSummary=S(2026);this.selectedYearForDetail=S(2026);this.detailModalTotal=H(()=>{let e=this.detailModalData();return e?e.data.reduce((t,i)=>t+i.total,0):0});this.applySummaryFilter(),this.applyFilter()}set detailChartRef(e){this.destroyDetailChart(),e&&this.detailModalData()&&this.createDetailChart(e)}setActiveStatement(e){this.activeStatement.set(e)}convertToNumber(e){if(e==null)return 0;if(typeof e=="number")return e;if(typeof e=="string"){let t=parseFloat(e.replace(/[^0-9.-]/g,""));return isNaN(t)?0:t}return 0}normalizeIncomeStatement(e){if(!e)return e;let t=(i,r)=>{let o=i.items.map(h=>{let y={},_=0;return Object.entries(h.monthlyAmounts||{}).forEach(([C,D])=>{let I=this.convertToNumber(D);y[C]=I,_+=I}),q(k({},h),{monthlyAmounts:y,total:_})}),s=0,u={},d=o;if(r==="operatingRevenue"){o.some(D=>D.account?.includes("-\u92B7\u8CA8\u6298\u8B93"))&&(d=o.filter(D=>D.account!=="\u92B7\u8CA8\u6298\u8B93"));let y=d.find(D=>D.account.includes("\u92B7\u8CA8\u6536\u5165")),_=d.find(D=>D.account.includes("\u5176\u4ED6\u6536\u5165")),C=d.find(D=>D.account.includes("\u92B7\u8CA8\u6298\u8B93"));s=(y?.total||0)+(_?.total||0)-(C?.total||0),e.months&&e.months.forEach(D=>{let I=(y?.monthlyAmounts?.[D]||0)+(_?.monthlyAmounts?.[D]||0)-(C?.monthlyAmounts?.[D]||0);u[D]=Math.max(0,I)})}else r==="operatingExpenses"?(s=d.reduce((h,y)=>h+(y.total||0),0),e.months&&e.months.forEach(h=>{let y=d.reduce((_,C)=>_+(C.monthlyAmounts?.[h]||0),0);u[h]=y})):(s=d.reduce((h,y)=>h+(y.total||0),0),e.months&&e.months.forEach(h=>{let y=d.reduce((_,C)=>_+(C.monthlyAmounts?.[h]||0),0);u[h]=y}));let m=d.map(h=>{let y=s>0?h.total/s*100:0;return q(k({},h),{percentage:y})});return q(k({},i),{items:m,monthlyTotals:u,grandTotal:s})};return q(k({},e),{operatingRevenue:t(e.operatingRevenue,"operatingRevenue"),operatingExpenses:t(e.operatingExpenses,"operatingExpenses"),netIncome:{monthlyTotals:Object.entries(e.netIncome.monthlyTotals||{}).reduce((i,[r,o])=>(i[r]=this.convertToNumber(o),i),{}),grandTotal:this.convertToNumber(e.netIncome.grandTotal)}})}normalizeBalanceSheet(e){if(!e)return e;let t=i=>{let r=i.items.map(d=>{let m={},h=0;return Object.entries(d.monthlyAmounts||{}).forEach(([y,_])=>{let C=this.convertToNumber(_);m[y]=C,h+=C}),q(k({},d),{monthlyAmounts:m,total:h})}),o=r.reduce((d,m)=>d+(m.total||0),0),s=r.map(d=>{let m=o>0?d.total/o*100:0;return q(k({},d),{percentage:m})}),u={};return e.months&&e.months.forEach(d=>{let m=r.reduce((h,y)=>h+(y.monthlyAmounts?.[d]||0),0);u[d]=m}),q(k({},i),{items:s,monthlyTotals:u,grandTotal:o})};return q(k({},e),{assets:t(e.assets),liabilities:t(e.liabilities),equity:t(e.equity),totalLiabilitiesAndEquity:t(e.totalLiabilitiesAndEquity)})}async applyFilter(){let e=this.selectedYear(),t=this.selectedQuarter();this.isLoading.set(!0),this.errorMessage.set(null);try{let i=await this.apiService.getIncomeStatement(e,t);if(i.success&&i.data){let o=this.normalizeIncomeStatement(i.data);this.monthlyIncomeStatement.set(o)}else this.errorMessage.set(i.error||"\u7121\u6CD5\u53D6\u5F97\u640D\u76CA\u8868\u8CC7\u6599");let r=await this.apiService.getBalanceSheet(e,t);if(r.success&&r.data){let o=this.normalizeBalanceSheet(r.data);this.monthlyBalanceSheet.set(o)}else this.errorMessage.set(r.error||"\u7121\u6CD5\u53D6\u5F97\u8CC7\u7522\u8CA0\u50B5\u8868\u8CC7\u6599")}catch(i){console.error("Error loading financial statements:",i),this.errorMessage.set("\u53D6\u5F97\u8CA1\u52D9\u5831\u8868\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoading.set(!1)}}resetFilter(){this.selectedYear.set(2026),this.selectedQuarter.set("all"),this.applyFilter()}async applySummaryFilter(){let e=this.selectedStartYearSummary(),t=this.selectedEndYearSummary();e>t&&(this.selectedStartYearSummary.set(t),this.selectedEndYearSummary.set(e)),this.selectedYearForDetail.set(this.selectedEndYearSummary()),this.isLoading.set(!0),this.errorMessage.set(null);try{let i=await this.apiService.getAnnualSummary(this.selectedStartYearSummary(),this.selectedEndYearSummary());if(i.success&&i.data){let r=this.normalizeAnnualSummary(i.data);this.annualSummary.set(r)}else this.errorMessage.set(i.error||"\u7121\u6CD5\u53D6\u5F97\u5E74\u5EA6\u7E3D\u8868\u8CC7\u6599")}catch(i){console.error("Error loading annual summary:",i),this.errorMessage.set("\u53D6\u5F97\u5E74\u5EA6\u7E3D\u8868\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoading.set(!1)}}calculateRevenueBreakdown(e){let t={total:0},i={total:0};return Object.entries(e).forEach(([r,o])=>{if(r!=="total"){let s=parseInt(r,10);if(!isNaN(s)){let u=this.convertToNumber(o),d=Math.round(u*.9),m=u-d;t[s]=d,t.total+=d,i[s]=m,i.total+=m}}}),{salesRevenue:t,otherRevenue:i}}calculateExpenseBreakdown(e){let t={total:0},i={total:0};return Object.entries(e).forEach(([r,o])=>{if(r!=="total"){let s=parseInt(r,10);if(!isNaN(s)){let u=this.convertToNumber(o),d=Math.round(u*.35),m=u-d;t[s]=d,t.total+=d,i[s]=m,i.total+=m}}}),{merchandise:t,miscellaneous:i}}calculateUnpaidBreakdown(e){let t={total:0},i={total:0},r={total:0},o={total:0},s={total:0};return Object.entries(e).forEach(([u,d])=>{if(u!=="total"){let m=parseInt(u,10);if(!isNaN(m)){let h=this.convertToNumber(d),y=Math.round(h/5);t[m]=y,t.total+=y,i[m]=y,i.total+=y,r[m]=y,r.total+=y,o[m]=y,o.total+=y,s[m]=h-y*4,s.total+=h-y*4}}}),{accountsPayable:t,payableForRenovation:i,payableSalary:r,payableShareholderRebate:o,payableForGoods:s}}normalizeAnnualSummary(e){if(!e)return e;let t=q(k({},e),{revenue:Object.entries(e.revenue||{}).reduce((i,[r,o])=>{if(r==="total")i.total=this.convertToNumber(o);else{let s=parseInt(r,10);isNaN(s)||(i[s]=this.convertToNumber(o))}return i},{}),expense:Object.entries(e.expense||{}).reduce((i,[r,o])=>{if(r==="total")i.total=this.convertToNumber(o);else{let s=parseInt(r,10);isNaN(s)||(i[s]=this.convertToNumber(o))}return i},{}),net:Object.entries(e.net||{}).reduce((i,[r,o])=>{if(r==="total")i.total=this.convertToNumber(o);else{let s=parseInt(r,10);isNaN(s)||(i[s]=this.convertToNumber(o))}return i},{}),unpaid:Object.entries(e.unpaid||{}).reduce((i,[r,o])=>{if(r==="total")i.total=this.convertToNumber(o);else{let s=parseInt(r,10);isNaN(s)||(i[s]=this.convertToNumber(o))}return i},{})});return!t.revenueBreakdown&&t.revenue&&(t.revenueBreakdown=this.calculateRevenueBreakdown(t.revenue)),!t.expenseBreakdown&&t.expense&&(t.expenseBreakdown=this.calculateExpenseBreakdown(t.expense)),!t.unpaidBreakdown&&t.unpaid&&(t.unpaidBreakdown=this.calculateUnpaidBreakdown(t.unpaid)),t}resetSummaryFilter(){this.selectedStartYearSummary.set(2024),this.selectedEndYearSummary.set(2026),this.applySummaryFilter()}async openDetailModal(e,t){this.isLoading.set(!0),this.errorMessage.set(null);try{let i=await this.apiService.getFinancialStatementsDetails(e,t);i.success&&i.data?(this.detailModalData.set(i.data),this.isDetailModalOpen.set(!0)):(console.warn(`No detail data available for ${e} - ${t}`),this.errorMessage.set("\u7121\u6CD5\u53D6\u5F97\u660E\u7D30\u8CC7\u6599"))}catch(i){console.error("Error loading detail data:",i),this.errorMessage.set("\u53D6\u5F97\u660E\u7D30\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoading.set(!1)}}closeDetailModal(){this.isDetailModalOpen.set(!1),this.detailModalData.set(null),this.destroyDetailChart()}createDetailChart(e){let t=this.detailModalData();if(!e||!t||t.data.length===0)return;let i=t.data,r=i.map(m=>`${m.month}\u6708`),o=[];t.type==="\u6536\u5165"?o=["\u92B7\u8CA8\u6536\u5165","\u5176\u4ED6\u6536\u5165","-\u92B7\u8CA8\u6298\u8B93"]:t.type==="\u652F\u51FA"?o=["\u5546\u54C1","\u96DC\u9805\u8B8A\u52D5"]:t.type==="\u672A\u4ED8"?o=["\u61C9\u4ED8\u5E33\u6B3E","\u61C9\u4ED8\u88DD\u6F62\u6B3E","\u61C9\u4ED8\u85AA\u8CC7","\u61C9\u4ED8\u80A1\u6771\u56DE\u994B\u91D1","\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8"]:o=t.data[0]?.items.map(m=>m.name)||[];let s=["#4f46e5","#ef4444","#f59e0b","#10b981","#3b82f6","#8b5cf6"],u=[{label:"\u6708\u5EA6\u7E3D\u8A08",data:i.map(m=>m.total),borderColor:s[0],backgroundColor:"rgba(79, 70, 229, 0.1)",fill:!0,tension:.4,borderWidth:3,pointRadius:4}];o.forEach((m,h)=>{let y=i.map(_=>_.items.find(D=>D.name===m)?.amount||0);u.push({label:m,data:y,borderColor:s[(h+1)%s.length],backgroundColor:"transparent",fill:!1,tension:.4,borderDash:[5,5],borderWidth:2,pointRadius:3})});let d=e.nativeElement.getContext("2d");this.detailChart=new Chart(d,{type:"line",data:{labels:r,datasets:u},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!1,ticks:{callback:m=>this.formatCurrency(m)}}},plugins:{tooltip:{callbacks:{label:m=>`${m.dataset.label}: ${this.formatCurrency(m.raw)}`}}}}})}destroyDetailChart(){this.detailChart&&(this.detailChart.destroy(),this.detailChart=null)}calculateMonthlyItemTotal(e){let t=this.detailModalData();return t?t.data.reduce((i,r)=>{let o=r.items.find(s=>s.name===e);return i+(o?.amount||0)},0):0}getDetailItemAmount(e,t){let i=e.items.find(r=>r.name===t);return i?this.convertToNumber(i.amount):0}formatCurrency(e){return e==null?"NT$0":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}formatMonth(e){return`${parseInt(e.split("-")[1],10)}\u6708`}calculateColumnWidth(e){let i=this.formatCurrency(e).length;return`${Math.max(5.5,2+i*.5)}rem`}getMaxMonthColumnWidth(e){let t=6;return e.forEach(r=>{if(r!=null){let o=this.formatCurrency(r);t=Math.max(t,o.length)}}),`${Math.max(5.5,2+t*.5)}rem`}};Ts.\u0275fac=function(t){return new(t||Ts)},Ts.\u0275cmp=ie({type:Ts,selectors:[["app-financial-statements"]],viewQuery:function(t,i){if(t&1&&Sn(DR,5),t&2){let r;on(r=sn())&&(i.detailChartRef=r.first)}},decls:22,vars:12,consts:[["detailChart",""],[1,"space-y-6"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-4","flex","items-center","gap-3"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4","flex","items-center","gap-3"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"flex","flex-col","sm:flex-row","items-center","gap-2","bg-white","p-3","rounded-xl","shadow-md","border","border-gray-200"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"border-b","border-gray-200"],["aria-label","Tabs",1,"-mb-px","flex","space-x-6"],[1,"whitespace-nowrap","py-4","px-1","border-b-2","font-medium","text-sm",3,"click"],[1,"pt-6","overflow-x-auto"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50","transition-opacity"],["name","hourglass-outline",1,"text-blue-600","text-xl","animate-spin"],[1,"text-blue-700"],["name","alert-circle-outline",1,"text-red-600","text-xl"],[1,"text-red-700"],[1,"flex","items-center","gap-2"],["for","startYear",1,"text-sm","font-medium","text-gray-600"],["id","startYear",1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100","pr-8",3,"ngModelChange","ngModel"],[3,"value"],["for","endYear",1,"text-sm","font-medium","text-gray-600"],["id","endYear",1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100","pr-8",3,"ngModelChange","ngModel"],[1,"flex","items-center","gap-2","mt-2","sm:mt-0"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],["name","hourglass-outline",1,"animate-spin"],["name","filter-outline"],["for","year",1,"text-sm","font-medium","text-gray-600"],["id","year",1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100","pr-8",3,"ngModelChange","ngModel"],["for","quarter",1,"text-sm","font-medium","text-gray-600"],["id","quarter",1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100","pr-8",3,"ngModelChange","ngModel"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-center","py-8","text-gray-500"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50"],[1,"py-3","px-4"],[1,"py-3","px-4","text-right"],[1,"border-b","border-gray-100","bg-blue-50","font-semibold"],[1,"py-3","px-4","text-gray-800"],["name","folder-open-outline",1,"align-middle","mr-2"],[1,"py-3","px-4","text-right","font-medium","text-blue-600","cursor-pointer","hover:underline","hover:bg-blue-100"],[1,"py-3","px-4","text-right","font-bold"],[1,"border-b","border-gray-100","bg-red-50"],[1,"border-b","border-gray-100","bg-red-50","font-semibold"],[1,"py-3","px-4","text-right","font-medium","text-red-600","cursor-pointer","hover:underline","hover:bg-red-100"],[1,"border-b-2","border-gray-200","bg-gray-50","font-bold"],[1,"py-3","px-4","text-right",3,"text-red-600"],[1,"border-b","border-gray-100","bg-orange-50","font-semibold"],[1,"py-3","px-4","text-right","font-medium","text-orange-600","cursor-pointer","hover:underline","hover:bg-orange-100"],[1,"py-3","px-4","text-right","font-bold","hover:underline"],[1,"py-3","px-4","text-right","font-medium","text-blue-600","cursor-pointer","hover:underline","hover:bg-blue-100",3,"click"],[1,"py-3","px-4","text-gray-800","pl-8"],["name","remove-circle-outline",1,"align-middle","mr-2","text-red-500"],[1,"py-3","px-4","text-right","font-medium","text-red-600"],[1,"py-3","px-4","text-right","font-bold","text-red-600"],[1,"py-3","px-4","text-right","font-medium","text-red-600","cursor-pointer","hover:underline","hover:bg-red-100",3,"click"],[1,"py-3","px-4","text-right","font-medium","text-orange-600","cursor-pointer","hover:underline","hover:bg-orange-100",3,"click"],[1,"relative","overflow-x-auto"],[1,"py-3","px-2","w-16","sticky","left-0","bg-gray-50","z-20","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]"],[1,"py-3","px-2","w-24","sticky","bg-gray-50","z-20","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","4rem"],[1,"py-3","px-2","w-20","text-right","tabular-nums","sticky","bg-gray-50","z-20","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","10rem"],[1,"py-3","px-2","w-12","text-right","tabular-nums","sticky","bg-gray-50","z-20","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","16rem"],[1,"py-3","px-2","text-right","text-xs","w-fit"],[1,"font-semibold","text-gray-800","bg-gray-100"],["colspan","4",1,"py-2","px-2","sticky","left-0","bg-gray-100","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]"],[1,"border-b","border-gray-100","hover:bg-gray-50"],[1,"font-semibold","text-gray-900","bg-gray-50","border-t-2","border-gray-200"],["colspan","2",1,"py-2","px-2","sticky","left-0","bg-gray-50","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]"],[1,"py-2","px-2","text-right","tabular-nums","font-medium","sticky","bg-gray-50","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","10rem"],[1,"py-2","px-2","text-right","tabular-nums","sticky","bg-gray-50","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","16rem"],[1,"py-2","px-2","text-right","text-xs","font-semibold","w-fit"],[1,"py-2"],[1,"font-bold","text-base","text-white","bg-indigo-600"],["colspan","2",1,"py-3","px-2","sticky","left-0","bg-indigo-600","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.3)]"],[1,"py-3","px-2","text-right","tabular-nums","sticky","bg-indigo-600","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.3)]",2,"left","10rem"],[1,"py-3","px-2","sticky","bg-indigo-600","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.3)]",2,"left","16rem"],[1,"py-3","px-2","text-right","text-xs","font-bold","w-fit"],[1,"py-2","px-2","sticky","left-0","bg-white","hover:bg-gray-50","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]"],[1,"py-2","px-2","sticky","bg-white","hover:bg-gray-50","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","4rem"],[1,"py-2","px-2","text-right","tabular-nums","font-medium","sticky","bg-white","hover:bg-gray-50","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","10rem"],[1,"py-2","px-2","text-right","tabular-nums","sticky","bg-white","hover:bg-gray-50","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","16rem"],[1,"py-2","px-2","text-right","text-xs","w-fit"],[1,"py-2","px-2","text-right","tabular-nums","font-bold","text-indigo-600","sticky","bg-gray-50","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","10rem"],[1,"font-semibold","text-gray-900","border-t-2","border-gray-200"],["colspan","2",1,"py-2","px-2","sticky","left-0","bg-white","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]"],[1,"py-2","px-2","text-right","tabular-nums","font-medium","sticky","bg-white","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","10rem"],[1,"py-2","px-2","text-right","tabular-nums","sticky","bg-white","z-10","shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",2,"left","16rem"],[1,"py-2","px-2","text-right","text-xs","font-bold","w-fit"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-6xl","max-h-[90vh]","flex","flex-col","m-4"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600","p-1","rounded-full","hover:bg-gray-100",3,"click"],["name","close-outline",1,"text-2xl"],[1,"flex-1","flex","flex-col","p-6","overflow-hidden"],[1,"h-64","mb-6"],[1,"flex-1","overflow-y-auto"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50","sticky","top-0"],[1,"font-bold","bg-gray-100","sticky","bottom-0"],[1,"border-t-2"],[1,"px-4","py-2"],[1,"px-4","py-2","text-right"],[1,"border-b","hover:bg-gray-50"],[1,"px-4","py-2","font-medium"],[1,"px-4","py-2","text-right","font-semibold"],[1,"px-4","py-2","text-right","text-red-600"],[1,"px-4","py-3"],[1,"px-4","py-3","text-right"],[1,"px-4","py-3","text-right","text-red-600"]],template:function(t,i){if(t&1&&(l(0,"div",1),A(1,TR,4,0,"div",2),A(2,IR,4,1,"div",3),l(3,"div",4)(4,"h1",5),c(5,"\u8CA1\u52D9\u5831\u8868"),a(),A(6,FR,19,4,"div",6),A(7,LR,19,4,"div",6),a(),l(8,"div",7)(9,"div",8)(10,"nav",9)(11,"button",10),b("click",function(){return i.setActiveStatement("summary")}),c(12," \u7E3D\u8868 "),a(),l(13,"button",10),b("click",function(){return i.setActiveStatement("income")}),c(14," \u640D\u76CA\u8868 "),a(),l(15,"button",10),b("click",function(){return i.setActiveStatement("balance")}),c(16," \u8CC7\u7522\u8CA0\u50B5\u8868 "),a()()(),l(17,"div",11),A(18,YR,2,1)(19,o6,2,1)(20,v6,2,1),a()()(),A(21,U6,2,1,"div",12)),t&2){let r;f(),N(i.isLoading()?1:-1),f(),N(i.errorMessage()?2:-1),f(4),N(i.activeStatement()==="summary"?6:-1),f(),N(i.activeStatement()==="income"||i.activeStatement()==="balance"?7:-1),f(4),De(i.activeStatement()==="summary"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),f(2),De(i.activeStatement()==="income"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),f(2),De(i.activeStatement()==="balance"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),f(3),N((r=i.activeStatement())==="summary"?18:r==="income"?19:r==="balance"?20:-1),f(3),N(i.isDetailModalOpen()?21:-1)}},dependencies:[re,be,ke,Ve,Ae,me,Ie],encapsulation:2,changeDetection:0});var dm=Ts;var $6,H6;function G6(){return{geminiUrl:$6,vertexUrl:H6}}function q6(n,e,t,i){var r,o;if(!n?.baseUrl){let s=G6();return e?(r=s.vertexUrl)!==null&&r!==void 0?r:t:(o=s.geminiUrl)!==null&&o!==void 0?o:i}return n.baseUrl}var ai=class{};function X(n,e){let t=/\{([^}]+)\}/g;return n.replace(t,(i,r)=>{if(Object.prototype.hasOwnProperty.call(e,r)){let o=e[r];return o!=null?String(o):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function g(n,e,t){for(let o=0;o<e.length-1;o++){let s=e[o];if(s.endsWith("[]")){let u=s.slice(0,-2);if(!(u in n))if(Array.isArray(t))n[u]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${s}`);if(Array.isArray(n[u])){let d=n[u];if(Array.isArray(t))for(let m=0;m<d.length;m++){let h=d[m];g(h,e.slice(o+1),t[m])}else for(let m of d)g(m,e.slice(o+1),t)}return}else if(s.endsWith("[0]")){let u=s.slice(0,-3);u in n||(n[u]=[{}]);let d=n[u];g(d[0],e.slice(o+1),t);return}(!n[s]||typeof n[s]!="object")&&(n[s]={}),n=n[s]}let i=e[e.length-1],r=n[i];if(r!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===r)return;if(typeof r=="object"&&typeof t=="object"&&r!==null&&t!==null)Object.assign(r,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[i]=t}function p(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let i=0;i<e.length;i++){if(typeof n!="object"||n===null)return t;let r=e[i];if(r.endsWith("[]")){let o=r.slice(0,-2);if(o in n){let s=n[o];return Array.isArray(s)?s.map(u=>p(u,e.slice(i+1),t)):t}else return t}else n=n[r]}return n}catch(i){if(i instanceof TypeError)return t;throw i}}function W6(n,e){for(let[t,i]of Object.entries(e)){let r=t.split("."),o=i.split("."),s=new Set,u=-1;for(let d=0;d<r.length;d++)if(r[d]==="*"){u=d;break}if(u!==-1&&o.length>u)for(let d=u;d<o.length;d++){let m=o[d];m!=="*"&&!m.endsWith("[]")&&!m.endsWith("[0]")&&s.add(m)}Jh(n,r,o,0,s)}}function Jh(n,e,t,i,r){if(i>=e.length||typeof n!="object"||n===null)return;let o=e[i];if(o.endsWith("[]")){let s=o.slice(0,-2),u=n;if(s in u&&Array.isArray(u[s]))for(let d of u[s])Jh(d,e,t,i+1,r)}else if(o==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){let s=n,u=Object.keys(s).filter(m=>!m.startsWith("_")&&!r.has(m)),d={};for(let m of u)d[m]=s[m];for(let[m,h]of Object.entries(d)){let y=[];for(let _ of t.slice(i))_==="*"?y.push(m):y.push(_);g(s,y,h)}for(let m of u)delete s[m]}}else{let s=n;o in s&&Jh(s[o],e,t,i+1,r)}}function zy(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}function j6(n){let e={},t=p(n,["operationName"]);t!=null&&g(e,["operationName"],t);let i=p(n,["resourceName"]);return i!=null&&g(e,["_url","resourceName"],i),e}function z6(n){let e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);let i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);let r=p(n,["done"]);r!=null&&g(e,["done"],r);let o=p(n,["error"]);o!=null&&g(e,["error"],o);let s=p(n,["response","generateVideoResponse"]);return s!=null&&g(e,["response"],J6(s)),e}function Y6(n){let e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);let i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);let r=p(n,["done"]);r!=null&&g(e,["done"],r);let o=p(n,["error"]);o!=null&&g(e,["error"],o);let s=p(n,["response"]);return s!=null&&g(e,["response"],K6(s)),e}function J6(n){let e={},t=p(n,["generatedSamples"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(s=>Q6(s))),g(e,["generatedVideos"],o)}let i=p(n,["raiMediaFilteredCount"]);i!=null&&g(e,["raiMediaFilteredCount"],i);let r=p(n,["raiMediaFilteredReasons"]);return r!=null&&g(e,["raiMediaFilteredReasons"],r),e}function K6(n){let e={},t=p(n,["videos"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(s=>Z6(s))),g(e,["generatedVideos"],o)}let i=p(n,["raiMediaFilteredCount"]);i!=null&&g(e,["raiMediaFilteredCount"],i);let r=p(n,["raiMediaFilteredReasons"]);return r!=null&&g(e,["raiMediaFilteredReasons"],r),e}function Q6(n){let e={},t=p(n,["video"]);return t!=null&&g(e,["video"],r3(t)),e}function Z6(n){let e={},t=p(n,["_self"]);return t!=null&&g(e,["video"],o3(t)),e}function X6(n){let e={},t=p(n,["operationName"]);return t!=null&&g(e,["_url","operationName"],t),e}function e3(n){let e={},t=p(n,["operationName"]);return t!=null&&g(e,["_url","operationName"],t),e}function t3(n){let e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);let i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);let r=p(n,["done"]);r!=null&&g(e,["done"],r);let o=p(n,["error"]);o!=null&&g(e,["error"],o);let s=p(n,["response"]);return s!=null&&g(e,["response"],n3(s)),e}function n3(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["parent"]);i!=null&&g(e,["parent"],i);let r=p(n,["documentName"]);return r!=null&&g(e,["documentName"],r),e}function rb(n){let e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);let i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);let r=p(n,["done"]);r!=null&&g(e,["done"],r);let o=p(n,["error"]);o!=null&&g(e,["error"],o);let s=p(n,["response"]);return s!=null&&g(e,["response"],i3(s)),e}function i3(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["parent"]);i!=null&&g(e,["parent"],i);let r=p(n,["documentName"]);return r!=null&&g(e,["documentName"],r),e}function r3(n){let e={},t=p(n,["uri"]);t!=null&&g(e,["uri"],t);let i=p(n,["encodedVideo"]);i!=null&&g(e,["videoBytes"],zy(i));let r=p(n,["encoding"]);return r!=null&&g(e,["mimeType"],r),e}function o3(n){let e={},t=p(n,["gcsUri"]);t!=null&&g(e,["uri"],t);let i=p(n,["bytesBase64Encoded"]);i!=null&&g(e,["videoBytes"],zy(i));let r=p(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}var dt=(function(n){return n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL",n})(dt||{});var Kh=(function(n){return n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO",n})(Kh||{});var ob=(function(n){return n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED",n})(ob||{});var sb=(function(n){return n.COLLECTION="COLLECTION",n})(sb||{});var Wl=(function(n){return n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT",n})(Wl||{});var zl=class{constructor(e){let t={};for(let i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}};var fo=class{get text(){var e,t,i,r,o,s,u,d;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let m="",h=!1,y=[];for(let _ of(d=(u=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(let[C,D]of Object.entries(_))C!=="text"&&C!=="thought"&&C!=="thoughtSignature"&&(D!==null||D!==void 0)&&y.push(C);if(typeof _.text=="string"){if(typeof _.thought=="boolean"&&_.thought)continue;h=!0,m+=_.text}}return y.length>0&&console.warn(`there are non-text parts ${y} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),h?m:void 0}get data(){var e,t,i,r,o,s,u,d;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let m="",h=[];for(let y of(d=(u=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(let[_,C]of Object.entries(y))_!=="inlineData"&&(C!==null||C!==void 0)&&h.push(_);y.inlineData&&typeof y.inlineData.data=="string"&&(m+=atob(y.inlineData.data))}return h.length>0&&console.warn(`there are non-data parts ${h} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),m.length>0?btoa(m):void 0}get functionCalls(){var e,t,i,r,o,s,u,d;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");let m=(d=(u=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(h=>h.functionCall).map(h=>h.functionCall).filter(h=>h!==void 0);if(m?.length!==0)return m}get executableCode(){var e,t,i,r,o,s,u,d,m;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");let h=(d=(u=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(y=>y.executableCode).map(y=>y.executableCode).filter(y=>y!==void 0);if(h?.length!==0)return(m=h?.[0])===null||m===void 0?void 0:m.code}get codeExecutionResult(){var e,t,i,r,o,s,u,d,m;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");let h=(d=(u=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(y=>y.codeExecutionResult).map(y=>y.codeExecutionResult).filter(y=>y!==void 0);if(h?.length!==0)return(m=h?.[0])===null||m===void 0?void 0:m.output}},vm=class{},Cm=class{},Qh=class{},Zh=class{},Xh=class{},ey=class{},xm=class{},Em=class{},bm=class{},ty=class{};var Sm=class n{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){let i=new n,r,o=e;return t?r=Y6(o):r=z6(o),Object.assign(i,r),i}},Dm=class{},wm=class{},Tm=class{},Im=class{},ny=class{},iy=class{},ry=class{};var oy=class n{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){let i=new n,o=t3(e);return Object.assign(i,o),i}},sy=class{},ay=class{},ly=class{};var Mm=class{};var uy=class{get text(){var e,t,i;let r="",o=!1,s=[];for(let u of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(let[d,m]of Object.entries(u))d!=="text"&&d!=="thought"&&m!==null&&s.push(d);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;o=!0,r+=u.text}}return s.length>0&&console.warn(`there are non-text parts ${s} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?r:void 0}get data(){var e,t,i;let r="",o=[];for(let s of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(let[u,d]of Object.entries(s))u!=="inlineData"&&d!==null&&o.push(u);s.inlineData&&typeof s.inlineData.data=="string"&&(r+=atob(s.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),r.length>0?btoa(r):void 0}};var dy=class{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}};var cy=class n{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){let i=new n,o=rb(e);return Object.assign(i,o),i}};function Ge(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){let t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function ab(n,e){let t=Ge(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function lb(n){return Array.isArray(n)?n.map(e=>Am(e)):[Am(n)]}function Am(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function ub(n){let e=Am(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function db(n){let e=Am(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function F2(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function cb(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>F2(e)):[F2(n)]}function my(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function P2(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function k2(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function Zt(n){if(n==null)throw new Error("ContentUnion is required");return my(n)?n:{role:"user",parts:cb(n)}}function Yy(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{let i=Zt(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){let t=Zt(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Zt(t)):[Zt(e)]}function Gn(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(P2(n)||k2(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Zt(n)]}let e=[],t=[],i=my(n[0]);for(let r of n){let o=my(r);if(o!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)e.push(r);else{if(P2(r)||k2(r))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(r)}}return i||e.push({role:"user",parts:cb(t)}),e}function s3(n,e){n.includes("null")&&(e.nullable=!0);let t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(dt).includes(t[0].toUpperCase())?t[0].toUpperCase():dt.TYPE_UNSPECIFIED;else{e.anyOf=[];for(let i of t)e.anyOf.push({type:Object.values(dt).includes(i.toUpperCase())?i.toUpperCase():dt.TYPE_UNSPECIFIED})}}function Ms(n){let e={},t=["items"],i=["anyOf"],r=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");let o=n.anyOf;o!=null&&o.length==2&&(o[0].type==="null"?(e.nullable=!0,n=o[1]):o[1].type==="null"&&(e.nullable=!0,n=o[0])),n.type instanceof Array&&s3(n.type,e);for(let[s,u]of Object.entries(n))if(u!=null)if(s=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;e.type=Object.values(dt).includes(u.toUpperCase())?u.toUpperCase():dt.TYPE_UNSPECIFIED}else if(t.includes(s))e[s]=Ms(u);else if(i.includes(s)){let d=[];for(let m of u){if(m.type=="null"){e.nullable=!0;continue}d.push(Ms(m))}e[s]=d}else if(r.includes(s)){let d={};for(let[m,h]of Object.entries(u))d[m]=Ms(h);e[s]=d}else{if(s==="additionalProperties")continue;e[s]=u}return e}function Jy(n){return Ms(n)}function Ky(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Qy(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function Fs(n){if(n.functionDeclarations)for(let e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Ms(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Ms(e.response));return n}function Ps(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");let e=[];for(let t of n)e.push(t);return e}function a3(n,e,t,i=1){let r=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:r?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:r?`${t}/${e}`:e}function Qi(n,e){if(typeof e!="string")throw new Error("name must be a string");return a3(n,e,"cachedContents")}function mb(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function Er(n){return zy(n)}function l3(n){return n!=null&&typeof n=="object"&&"name"in n}function u3(n){return n!=null&&typeof n=="object"&&"video"in n}function d3(n){return n!=null&&typeof n=="object"&&"uri"in n}function pb(n){var e;let t;if(l3(n)&&(t=n.name),!(d3(n)&&(t=n.uri,t===void 0))&&!(u3(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){let r=t.split("files/")[1].match(/[a-z0-9]+/);if(r===null)throw new Error(`Could not extract file name from URI ${t}`);t=r[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function fb(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function gb(n){for(let e of["models","tunedModels","publisherModels"])if(c3(n,e))return n[e];return[]}function c3(n,e){return n!==null&&typeof n=="object"&&e in n}function m3(n,e={}){let t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(i.responseJsonSchema=t.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function p3(n,e={}){let t=[],i=new Set;for(let r of n){let o=r.name;if(i.has(o))throw new Error(`Duplicate function name ${o} found in MCP tools. Please ensure function names are unique.`);i.add(o);let s=m3(r,e);s.functionDeclarations&&t.push(...s.functionDeclarations)}return{functionDeclarations:t}}function hb(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;let i=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,r=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(r>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||r!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function f3(n){if(typeof n!="string")return n;let e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function yb(n){if(typeof n!="object"||n===null)return{};let e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;let r=t.inlinedResponses;if(!Array.isArray(r)||r.length===0)return n;let o=!1;for(let s of r){if(typeof s!="object"||s===null)continue;let d=s.response;if(typeof d!="object"||d===null)continue;if(d.embedding!==void 0){o=!0;break}}return o&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function ks(n,e){let t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function _b(n){let e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}function g3(n){let e={},t=p(n,["responsesFile"]);t!=null&&g(e,["fileName"],t);let i=p(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>J3(s))),g(e,["inlinedResponses"],o)}let r=p(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>s)),g(e,["inlinedEmbedContentResponses"],o)}return e}function h3(n){let e={},t=p(n,["predictionsFormat"]);t!=null&&g(e,["format"],t);let i=p(n,["gcsDestination","outputUriPrefix"]);i!=null&&g(e,["gcsUri"],i);let r=p(n,["bigqueryDestination","outputUri"]);return r!=null&&g(e,["bigqueryUri"],r),e}function y3(n){let e={},t=p(n,["format"]);t!=null&&g(e,["predictionsFormat"],t);let i=p(n,["gcsUri"]);i!=null&&g(e,["gcsDestination","outputUriPrefix"],i);let r=p(n,["bigqueryUri"]);if(r!=null&&g(e,["bigqueryDestination","outputUri"],r),p(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(p(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(p(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function ym(n){let e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);let i=p(n,["metadata","displayName"]);i!=null&&g(e,["displayName"],i);let r=p(n,["metadata","state"]);r!=null&&g(e,["state"],_b(r));let o=p(n,["metadata","createTime"]);o!=null&&g(e,["createTime"],o);let s=p(n,["metadata","endTime"]);s!=null&&g(e,["endTime"],s);let u=p(n,["metadata","updateTime"]);u!=null&&g(e,["updateTime"],u);let d=p(n,["metadata","model"]);d!=null&&g(e,["model"],d);let m=p(n,["metadata","output"]);return m!=null&&g(e,["dest"],g3(yb(m))),e}function py(n){let e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);let i=p(n,["displayName"]);i!=null&&g(e,["displayName"],i);let r=p(n,["state"]);r!=null&&g(e,["state"],_b(r));let o=p(n,["error"]);o!=null&&g(e,["error"],o);let s=p(n,["createTime"]);s!=null&&g(e,["createTime"],s);let u=p(n,["startTime"]);u!=null&&g(e,["startTime"],u);let d=p(n,["endTime"]);d!=null&&g(e,["endTime"],d);let m=p(n,["updateTime"]);m!=null&&g(e,["updateTime"],m);let h=p(n,["model"]);h!=null&&g(e,["model"],h);let y=p(n,["inputConfig"]);y!=null&&g(e,["src"],_3(y));let _=p(n,["outputConfig"]);_!=null&&g(e,["dest"],h3(yb(_)));let C=p(n,["completionStats"]);return C!=null&&g(e,["completionStats"],C),e}function _3(n){let e={},t=p(n,["instancesFormat"]);t!=null&&g(e,["format"],t);let i=p(n,["gcsSource","uris"]);i!=null&&g(e,["gcsUri"],i);let r=p(n,["bigquerySource","inputUri"]);return r!=null&&g(e,["bigqueryUri"],r),e}function v3(n,e){let t={};if(p(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(p(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(p(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");let i=p(e,["fileName"]);i!=null&&g(t,["fileName"],i);let r=p(e,["inlinedRequests"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>Y3(n,s))),g(t,["requests","requests"],o)}return t}function C3(n){let e={},t=p(n,["format"]);t!=null&&g(e,["instancesFormat"],t);let i=p(n,["gcsUri"]);i!=null&&g(e,["gcsSource","uris"],i);let r=p(n,["bigqueryUri"]);if(r!=null&&g(e,["bigquerySource","inputUri"],r),p(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(p(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function x3(n){let e={},t=p(n,["data"]);if(t!=null&&g(e,["data"],t),p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function E3(n,e){let t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],ks(n,i)),t}function b3(n,e){let t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],ks(n,i)),t}function S3(n){let e={},t=p(n,["content"]);t!=null&&g(e,["content"],t);let i=p(n,["citationMetadata"]);i!=null&&g(e,["citationMetadata"],D3(i));let r=p(n,["tokenCount"]);r!=null&&g(e,["tokenCount"],r);let o=p(n,["finishReason"]);o!=null&&g(e,["finishReason"],o);let s=p(n,["avgLogprobs"]);s!=null&&g(e,["avgLogprobs"],s);let u=p(n,["groundingMetadata"]);u!=null&&g(e,["groundingMetadata"],u);let d=p(n,["index"]);d!=null&&g(e,["index"],d);let m=p(n,["logprobsResult"]);m!=null&&g(e,["logprobsResult"],m);let h=p(n,["safetyRatings"]);if(h!=null){let _=h;Array.isArray(_)&&(_=_.map(C=>C)),g(e,["safetyRatings"],_)}let y=p(n,["urlContextMetadata"]);return y!=null&&g(e,["urlContextMetadata"],y),e}function D3(n){let e={},t=p(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),g(e,["citations"],i)}return e}function vb(n){let e={},t=p(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>n4(o))),g(e,["parts"],r)}let i=p(n,["role"]);return i!=null&&g(e,["role"],i),e}function w3(n,e){let t={},i=p(n,["displayName"]);if(e!==void 0&&i!=null&&g(e,["batch","displayName"],i),p(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function T3(n,e){let t={},i=p(n,["displayName"]);e!==void 0&&i!=null&&g(e,["displayName"],i);let r=p(n,["dest"]);return e!==void 0&&r!=null&&g(e,["outputConfig"],y3(f3(r))),t}function V2(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],Ge(n,i));let r=p(e,["src"]);r!=null&&g(t,["batch","inputConfig"],v3(n,hb(n,r)));let o=p(e,["config"]);return o!=null&&w3(o,t),t}function I3(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["model"],Ge(n,i));let r=p(e,["src"]);r!=null&&g(t,["inputConfig"],C3(hb(n,r)));let o=p(e,["config"]);return o!=null&&T3(o,t),t}function M3(n,e){let t={},i=p(n,["displayName"]);return e!==void 0&&i!=null&&g(e,["batch","displayName"],i),t}function A3(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],Ge(n,i));let r=p(e,["src"]);r!=null&&g(t,["batch","inputConfig"],O3(n,r));let o=p(e,["config"]);return o!=null&&M3(o,t),t}function N3(n,e){let t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],ks(n,i)),t}function R3(n,e){let t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],ks(n,i)),t}function F3(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["name"]);i!=null&&g(e,["name"],i);let r=p(n,["done"]);r!=null&&g(e,["done"],r);let o=p(n,["error"]);return o!=null&&g(e,["error"],o),e}function P3(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["name"]);i!=null&&g(e,["name"],i);let r=p(n,["done"]);r!=null&&g(e,["done"],r);let o=p(n,["error"]);return o!=null&&g(e,["error"],o),e}function k3(n,e){let t={},i=p(e,["contents"]);if(i!=null){let o=Yy(n,i);Array.isArray(o)&&(o=o.map(s=>s)),g(t,["requests[]","request","content"],o)}let r=p(e,["config"]);return r!=null&&(g(t,["_self"],V3(r,t)),W6(t,{"requests[].*":"requests[].request.*"})),t}function V3(n,e){let t={},i=p(n,["taskType"]);e!==void 0&&i!=null&&g(e,["requests[]","taskType"],i);let r=p(n,["title"]);e!==void 0&&r!=null&&g(e,["requests[]","title"],r);let o=p(n,["outputDimensionality"]);if(e!==void 0&&o!=null&&g(e,["requests[]","outputDimensionality"],o),p(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(p(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function O3(n,e){let t={},i=p(e,["fileName"]);i!=null&&g(t,["file_name"],i);let r=p(e,["inlinedRequests"]);return r!=null&&g(t,["requests"],k3(n,r)),t}function L3(n){let e={};if(p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let t=p(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);let i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function B3(n){let e={},t=p(n,["id"]);t!=null&&g(e,["id"],t);let i=p(n,["args"]);i!=null&&g(e,["args"],i);let r=p(n,["name"]);if(r!=null&&g(e,["name"],r),p(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function U3(n){let e={},t=p(n,["allowedFunctionNames"]);t!=null&&g(e,["allowedFunctionNames"],t);let i=p(n,["mode"]);if(i!=null&&g(e,["mode"],i),p(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function $3(n,e,t){let i={},r=p(e,["systemInstruction"]);t!==void 0&&r!=null&&g(t,["systemInstruction"],vb(Zt(r)));let o=p(e,["temperature"]);o!=null&&g(i,["temperature"],o);let s=p(e,["topP"]);s!=null&&g(i,["topP"],s);let u=p(e,["topK"]);u!=null&&g(i,["topK"],u);let d=p(e,["candidateCount"]);d!=null&&g(i,["candidateCount"],d);let m=p(e,["maxOutputTokens"]);m!=null&&g(i,["maxOutputTokens"],m);let h=p(e,["stopSequences"]);h!=null&&g(i,["stopSequences"],h);let y=p(e,["responseLogprobs"]);y!=null&&g(i,["responseLogprobs"],y);let _=p(e,["logprobs"]);_!=null&&g(i,["logprobs"],_);let C=p(e,["presencePenalty"]);C!=null&&g(i,["presencePenalty"],C);let D=p(e,["frequencyPenalty"]);D!=null&&g(i,["frequencyPenalty"],D);let I=p(e,["seed"]);I!=null&&g(i,["seed"],I);let R=p(e,["responseMimeType"]);R!=null&&g(i,["responseMimeType"],R);let F=p(e,["responseSchema"]);F!=null&&g(i,["responseSchema"],Jy(F));let $=p(e,["responseJsonSchema"]);if($!=null&&g(i,["responseJsonSchema"],$),p(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(p(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");let G=p(e,["safetySettings"]);if(t!==void 0&&G!=null){let ct=G;Array.isArray(ct)&&(ct=ct.map(di=>i4(di))),g(t,["safetySettings"],ct)}let Y=p(e,["tools"]);if(t!==void 0&&Y!=null){let ct=Ps(Y);Array.isArray(ct)&&(ct=ct.map(di=>o4(Fs(di)))),g(t,["tools"],ct)}let ne=p(e,["toolConfig"]);if(t!==void 0&&ne!=null&&g(t,["toolConfig"],r4(ne)),p(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");let de=p(e,["cachedContent"]);t!==void 0&&de!=null&&g(t,["cachedContent"],Qi(n,de));let le=p(e,["responseModalities"]);le!=null&&g(i,["responseModalities"],le);let Ue=p(e,["mediaResolution"]);Ue!=null&&g(i,["mediaResolution"],Ue);let pe=p(e,["speechConfig"]);if(pe!=null&&g(i,["speechConfig"],Ky(pe)),p(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");let we=p(e,["thinkingConfig"]);we!=null&&g(i,["thinkingConfig"],we);let _t=p(e,["imageConfig"]);_t!=null&&g(i,["imageConfig"],z3(_t));let ui=p(e,["enableEnhancedCivicAnswers"]);if(ui!=null&&g(i,["enableEnhancedCivicAnswers"],ui),p(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return i}function H3(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["candidates"]);if(i!=null){let d=i;Array.isArray(d)&&(d=d.map(m=>S3(m))),g(e,["candidates"],d)}let r=p(n,["modelVersion"]);r!=null&&g(e,["modelVersion"],r);let o=p(n,["promptFeedback"]);o!=null&&g(e,["promptFeedback"],o);let s=p(n,["responseId"]);s!=null&&g(e,["responseId"],s);let u=p(n,["usageMetadata"]);return u!=null&&g(e,["usageMetadata"],u),e}function G3(n,e){let t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],ks(n,i)),t}function q3(n,e){let t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],ks(n,i)),t}function W3(n){let e={};if(p(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");let t=p(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function j3(n){let e={};if(p(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");let t=p(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function z3(n){let e={},t=p(n,["aspectRatio"]);t!=null&&g(e,["aspectRatio"],t);let i=p(n,["imageSize"]);if(i!=null&&g(e,["imageSize"],i),p(n,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(p(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(p(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function Y3(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["request","model"],Ge(n,i));let r=p(e,["contents"]);if(r!=null){let u=Gn(r);Array.isArray(u)&&(u=u.map(d=>vb(d))),g(t,["request","contents"],u)}let o=p(e,["metadata"]);o!=null&&g(t,["metadata"],o);let s=p(e,["config"]);return s!=null&&g(t,["request","generationConfig"],$3(n,s,p(t,["request"],{}))),t}function J3(n){let e={},t=p(n,["response"]);t!=null&&g(e,["response"],H3(t));let i=p(n,["error"]);return i!=null&&g(e,["error"],i),e}function K3(n,e){let t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);let r=p(n,["pageToken"]);if(e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),p(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function Q3(n,e){let t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);let r=p(n,["pageToken"]);e!==void 0&&r!=null&&g(e,["_query","pageToken"],r);let o=p(n,["filter"]);return e!==void 0&&o!=null&&g(e,["_query","filter"],o),t}function Z3(n){let e={},t=p(n,["config"]);return t!=null&&K3(t,e),e}function X3(n){let e={},t=p(n,["config"]);return t!=null&&Q3(t,e),e}function e4(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);let r=p(n,["operations"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>ym(s))),g(e,["batchJobs"],o)}return e}function t4(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);let r=p(n,["batchPredictionJobs"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>py(s))),g(e,["batchJobs"],o)}return e}function n4(n){let e={},t=p(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);let i=p(n,["codeExecutionResult"]);i!=null&&g(e,["codeExecutionResult"],i);let r=p(n,["executableCode"]);r!=null&&g(e,["executableCode"],r);let o=p(n,["fileData"]);o!=null&&g(e,["fileData"],L3(o));let s=p(n,["functionCall"]);s!=null&&g(e,["functionCall"],B3(s));let u=p(n,["functionResponse"]);u!=null&&g(e,["functionResponse"],u);let d=p(n,["inlineData"]);d!=null&&g(e,["inlineData"],x3(d));let m=p(n,["text"]);m!=null&&g(e,["text"],m);let h=p(n,["thought"]);h!=null&&g(e,["thought"],h);let y=p(n,["thoughtSignature"]);y!=null&&g(e,["thoughtSignature"],y);let _=p(n,["videoMetadata"]);return _!=null&&g(e,["videoMetadata"],_),e}function i4(n){let e={},t=p(n,["category"]);if(t!=null&&g(e,["category"],t),p(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");let i=p(n,["threshold"]);return i!=null&&g(e,["threshold"],i),e}function r4(n){let e={},t=p(n,["retrievalConfig"]);t!=null&&g(e,["retrievalConfig"],t);let i=p(n,["functionCallingConfig"]);return i!=null&&g(e,["functionCallingConfig"],U3(i)),e}function o4(n){let e={};if(p(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");let t=p(n,["computerUse"]);t!=null&&g(e,["computerUse"],t);let i=p(n,["fileSearch"]);i!=null&&g(e,["fileSearch"],i);let r=p(n,["codeExecution"]);if(r!=null&&g(e,["codeExecution"],r),p(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");let o=p(n,["functionDeclarations"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(y=>y)),g(e,["functionDeclarations"],h)}let s=p(n,["googleMaps"]);s!=null&&g(e,["googleMaps"],W3(s));let u=p(n,["googleSearch"]);u!=null&&g(e,["googleSearch"],j3(u));let d=p(n,["googleSearchRetrieval"]);d!=null&&g(e,["googleSearchRetrieval"],d);let m=p(n,["urlContext"]);return m!=null&&g(e,["urlContext"],m),e}var br=(function(n){return n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents",n})(br||{}),Ki=class{constructor(e,t,i,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,r)}init(e,t,i){var r,o;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t?.sdkHttpResponse,this.idxInternal=0;let s={config:{}};!i||Object.keys(i).length===0?s={config:{}}:typeof i=="object"?s=Object.assign({},i):s=i,s.config&&(s.config.pageToken=t.nextPageToken),this.paramsInternal=s,this.pageInternalSize=(o=(r=s.config)===null||r===void 0?void 0:r.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};let e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");let e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}};var fy=class extends ai{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Ki(br.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)}}createInlinedGenerateContentRequest(e){let t=V2(this.apiClient,e),i=t._url,r=X("{model}:batchGenerateContent",i),u=t.batch.inputConfig.requests,d=u.requests,m=[];for(let h of d){let y=Object.assign({},h);if(y.systemInstruction){let _=y.systemInstruction;delete y.systemInstruction;let C=y.request;C.systemInstruction=_,y.request=C}m.push(y)}return u.requests=m,delete t.config,delete t._url,delete t._query,{path:r,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){let i=t?Object.assign({},t):{},r=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${r}`),i.dest===void 0){let o=this.getGcsUri(e),s=this.getBigqueryUri(e);if(o)o.endsWith(".jsonl")?i.dest=`${o.slice(0,-6)}/dest`:i.dest=`${o}_dest_${r}`;else if(s)i.dest=`${s}_dest_${r}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var t,i,r,o;let s,u="",d={};if(this.apiClient.isVertexAI()){let m=I3(this.apiClient,e);return u=X("batchPredictionJobs",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>py(h))}else{let m=V2(this.apiClient,e);return u=X("{model}:batchGenerateContent",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>ym(h))}}async createEmbeddingsInternal(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=A3(this.apiClient,e);return o=X("{model}:asyncBatchEmbedContent",u._url),s=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>ym(d))}}async get(e){var t,i,r,o;let s,u="",d={};if(this.apiClient.isVertexAI()){let m=q3(this.apiClient,e);return u=X("batchPredictionJobs/{name}",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>py(h))}else{let m=G3(this.apiClient,e);return u=X("batches/{name}",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>ym(h))}}async cancel(e){var t,i,r,o;let s="",u={};if(this.apiClient.isVertexAI()){let d=b3(this.apiClient,e);s=X("batchPredictionJobs/{name}:cancel",d._url),u=d._query,delete d._url,delete d._query,await this.apiClient.request({path:s,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{let d=E3(this.apiClient,e);s=X("batches/{name}:cancel",d._url),u=d._query,delete d._url,delete d._query,await this.apiClient.request({path:s,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var t,i,r,o;let s,u="",d={};if(this.apiClient.isVertexAI()){let m=X3(e);return u=X("batchPredictionJobs",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{let y=t4(h),_=new Mm;return Object.assign(_,y),_})}else{let m=Z3(e);return u=X("batches",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{let y=e4(h),_=new Mm;return Object.assign(_,y),_})}}async delete(e){var t,i,r,o;let s,u="",d={};if(this.apiClient.isVertexAI()){let m=R3(this.apiClient,e);return u=X("batchPredictionJobs/{name}",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>P3(h))}else{let m=N3(this.apiClient,e);return u=X("batches/{name}",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>F3(h))}}};function s4(n){let e={},t=p(n,["data"]);if(t!=null&&g(e,["data"],t),p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function O2(n){let e={},t=p(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>M4(o))),g(e,["parts"],r)}let i=p(n,["role"]);return i!=null&&g(e,["role"],i),e}function a4(n,e){let t={},i=p(n,["ttl"]);e!==void 0&&i!=null&&g(e,["ttl"],i);let r=p(n,["expireTime"]);e!==void 0&&r!=null&&g(e,["expireTime"],r);let o=p(n,["displayName"]);e!==void 0&&o!=null&&g(e,["displayName"],o);let s=p(n,["contents"]);if(e!==void 0&&s!=null){let h=Gn(s);Array.isArray(h)&&(h=h.map(y=>O2(y))),g(e,["contents"],h)}let u=p(n,["systemInstruction"]);e!==void 0&&u!=null&&g(e,["systemInstruction"],O2(Zt(u)));let d=p(n,["tools"]);if(e!==void 0&&d!=null){let h=d;Array.isArray(h)&&(h=h.map(y=>N4(y))),g(e,["tools"],h)}let m=p(n,["toolConfig"]);if(e!==void 0&&m!=null&&g(e,["toolConfig"],A4(m)),p(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function l4(n,e){let t={},i=p(n,["ttl"]);e!==void 0&&i!=null&&g(e,["ttl"],i);let r=p(n,["expireTime"]);e!==void 0&&r!=null&&g(e,["expireTime"],r);let o=p(n,["displayName"]);e!==void 0&&o!=null&&g(e,["displayName"],o);let s=p(n,["contents"]);if(e!==void 0&&s!=null){let y=Gn(s);Array.isArray(y)&&(y=y.map(_=>_)),g(e,["contents"],y)}let u=p(n,["systemInstruction"]);e!==void 0&&u!=null&&g(e,["systemInstruction"],Zt(u));let d=p(n,["tools"]);if(e!==void 0&&d!=null){let y=d;Array.isArray(y)&&(y=y.map(_=>R4(_))),g(e,["tools"],y)}let m=p(n,["toolConfig"]);e!==void 0&&m!=null&&g(e,["toolConfig"],m);let h=p(n,["kmsKeyName"]);return e!==void 0&&h!=null&&g(e,["encryption_spec","kmsKeyName"],h),t}function u4(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["model"],ab(n,i));let r=p(e,["config"]);return r!=null&&a4(r,t),t}function d4(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["model"],ab(n,i));let r=p(e,["config"]);return r!=null&&l4(r,t),t}function c4(n,e){let t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],Qi(n,i)),t}function m4(n,e){let t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],Qi(n,i)),t}function p4(n){let e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function f4(n){let e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function g4(n){let e={};if(p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let t=p(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);let i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function h4(n){let e={},t=p(n,["id"]);t!=null&&g(e,["id"],t);let i=p(n,["args"]);i!=null&&g(e,["args"],i);let r=p(n,["name"]);if(r!=null&&g(e,["name"],r),p(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function y4(n){let e={},t=p(n,["allowedFunctionNames"]);t!=null&&g(e,["allowedFunctionNames"],t);let i=p(n,["mode"]);if(i!=null&&g(e,["mode"],i),p(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function _4(n){let e={},t=p(n,["description"]);t!=null&&g(e,["description"],t);let i=p(n,["name"]);i!=null&&g(e,["name"],i);let r=p(n,["parameters"]);r!=null&&g(e,["parameters"],r);let o=p(n,["parametersJsonSchema"]);o!=null&&g(e,["parametersJsonSchema"],o);let s=p(n,["response"]);s!=null&&g(e,["response"],s);let u=p(n,["responseJsonSchema"]);if(u!=null&&g(e,["responseJsonSchema"],u),p(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function v4(n,e){let t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],Qi(n,i)),t}function C4(n,e){let t={},i=p(e,["name"]);return i!=null&&g(t,["_url","name"],Qi(n,i)),t}function x4(n){let e={};if(p(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");let t=p(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function E4(n){let e={};if(p(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");let t=p(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function b4(n,e){let t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);let r=p(n,["pageToken"]);return e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),t}function S4(n,e){let t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);let r=p(n,["pageToken"]);return e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),t}function D4(n){let e={},t=p(n,["config"]);return t!=null&&b4(t,e),e}function w4(n){let e={},t=p(n,["config"]);return t!=null&&S4(t,e),e}function T4(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);let r=p(n,["cachedContents"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>s)),g(e,["cachedContents"],o)}return e}function I4(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);let r=p(n,["cachedContents"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>s)),g(e,["cachedContents"],o)}return e}function M4(n){let e={},t=p(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);let i=p(n,["codeExecutionResult"]);i!=null&&g(e,["codeExecutionResult"],i);let r=p(n,["executableCode"]);r!=null&&g(e,["executableCode"],r);let o=p(n,["fileData"]);o!=null&&g(e,["fileData"],g4(o));let s=p(n,["functionCall"]);s!=null&&g(e,["functionCall"],h4(s));let u=p(n,["functionResponse"]);u!=null&&g(e,["functionResponse"],u);let d=p(n,["inlineData"]);d!=null&&g(e,["inlineData"],s4(d));let m=p(n,["text"]);m!=null&&g(e,["text"],m);let h=p(n,["thought"]);h!=null&&g(e,["thought"],h);let y=p(n,["thoughtSignature"]);y!=null&&g(e,["thoughtSignature"],y);let _=p(n,["videoMetadata"]);return _!=null&&g(e,["videoMetadata"],_),e}function A4(n){let e={},t=p(n,["retrievalConfig"]);t!=null&&g(e,["retrievalConfig"],t);let i=p(n,["functionCallingConfig"]);return i!=null&&g(e,["functionCallingConfig"],y4(i)),e}function N4(n){let e={};if(p(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");let t=p(n,["computerUse"]);t!=null&&g(e,["computerUse"],t);let i=p(n,["fileSearch"]);i!=null&&g(e,["fileSearch"],i);let r=p(n,["codeExecution"]);if(r!=null&&g(e,["codeExecution"],r),p(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");let o=p(n,["functionDeclarations"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(y=>y)),g(e,["functionDeclarations"],h)}let s=p(n,["googleMaps"]);s!=null&&g(e,["googleMaps"],x4(s));let u=p(n,["googleSearch"]);u!=null&&g(e,["googleSearch"],E4(u));let d=p(n,["googleSearchRetrieval"]);d!=null&&g(e,["googleSearchRetrieval"],d);let m=p(n,["urlContext"]);return m!=null&&g(e,["urlContext"],m),e}function R4(n){let e={},t=p(n,["retrieval"]);t!=null&&g(e,["retrieval"],t);let i=p(n,["computerUse"]);if(i!=null&&g(e,["computerUse"],i),p(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");let r=p(n,["codeExecution"]);r!=null&&g(e,["codeExecution"],r);let o=p(n,["enterpriseWebSearch"]);o!=null&&g(e,["enterpriseWebSearch"],o);let s=p(n,["functionDeclarations"]);if(s!=null){let y=s;Array.isArray(y)&&(y=y.map(_=>_4(_))),g(e,["functionDeclarations"],y)}let u=p(n,["googleMaps"]);u!=null&&g(e,["googleMaps"],u);let d=p(n,["googleSearch"]);d!=null&&g(e,["googleSearch"],d);let m=p(n,["googleSearchRetrieval"]);m!=null&&g(e,["googleSearchRetrieval"],m);let h=p(n,["urlContext"]);return h!=null&&g(e,["urlContext"],h),e}function F4(n,e){let t={},i=p(n,["ttl"]);e!==void 0&&i!=null&&g(e,["ttl"],i);let r=p(n,["expireTime"]);return e!==void 0&&r!=null&&g(e,["expireTime"],r),t}function P4(n,e){let t={},i=p(n,["ttl"]);e!==void 0&&i!=null&&g(e,["ttl"],i);let r=p(n,["expireTime"]);return e!==void 0&&r!=null&&g(e,["expireTime"],r),t}function k4(n,e){let t={},i=p(e,["name"]);i!=null&&g(t,["_url","name"],Qi(n,i));let r=p(e,["config"]);return r!=null&&F4(r,t),t}function V4(n,e){let t={},i=p(e,["name"]);i!=null&&g(t,["_url","name"],Qi(n,i));let r=p(e,["config"]);return r!=null&&P4(r,t),t}var gy=class extends ai{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Ki(br.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,r,o;let s,u="",d={};if(this.apiClient.isVertexAI()){let m=d4(this.apiClient,e);return u=X("cachedContents",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>h)}else{let m=u4(this.apiClient,e);return u=X("cachedContents",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async get(e){var t,i,r,o;let s,u="",d={};if(this.apiClient.isVertexAI()){let m=C4(this.apiClient,e);return u=X("{name}",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>h)}else{let m=v4(this.apiClient,e);return u=X("{name}",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async delete(e){var t,i,r,o;let s,u="",d={};if(this.apiClient.isVertexAI()){let m=m4(this.apiClient,e);return u=X("{name}",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{let y=f4(h),_=new Tm;return Object.assign(_,y),_})}else{let m=c4(this.apiClient,e);return u=X("{name}",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{let y=p4(h),_=new Tm;return Object.assign(_,y),_})}}async update(e){var t,i,r,o;let s,u="",d={};if(this.apiClient.isVertexAI()){let m=V4(this.apiClient,e);return u=X("{name}",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>h)}else{let m=k4(this.apiClient,e);return u=X("{name}",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async listInternal(e){var t,i,r,o;let s,u="",d={};if(this.apiClient.isVertexAI()){let m=w4(e);return u=X("cachedContents",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{let y=I4(h),_=new Im;return Object.assign(_,y),_})}else{let m=D4(e);return u=X("cachedContents",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{let y=T4(h),_=new Im;return Object.assign(_,y),_})}}};function Nm(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t}function L2(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function _e(n){return this instanceof _e?(this.v=n,this):new _e(n)}function oi(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,o=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",s),r[Symbol.asyncIterator]=function(){return this},r;function s(C){return function(D){return Promise.resolve(D).then(C,y)}}function u(C,D){i[C]&&(r[C]=function(I){return new Promise(function(R,F){o.push([C,I,R,F])>1||d(C,I)})},D&&(r[C]=D(r[C])))}function d(C,D){try{m(i[C](D))}catch(I){_(o[0][3],I)}}function m(C){C.value instanceof _e?Promise.resolve(C.value.v).then(h,y):_(o[0][2],C)}function h(C){d("next",C)}function y(C){d("throw",C)}function _(C,D){C(D),o.shift(),o.length&&d(o[0][0],o[0][1])}}function si(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof L2=="function"?L2(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=n[o]&&function(s){return new Promise(function(u,d){s=n[o](s),r(u,d,s.done,s.value)})}}function r(o,s,u,d){Promise.resolve(d).then(function(m){o({value:m,done:u})},s)}}function O4(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;let t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:Cb(t)}function Cb(n){if(n.parts===void 0||n.parts.length===0)return!1;for(let e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function L4(n){if(n.length!==0){for(let e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function B2(n){if(n===void 0||n.length===0)return[];let e=[],t=n.length,i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{let r=[],o=!0;for(;i<t&&n[i].role==="model";)r.push(n[i]),o&&!Cb(n[i])&&(o=!1),i++;o?e.push(...r):e.pop()}return e}var hy=class{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new yy(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}},yy=class{constructor(e,t,i,r={},o=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=r,this.history=o,this.sendPromise=Promise.resolve(),L4(o)}async sendMessage(e){var t;await this.sendPromise;let i=Zt(e.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var o,s,u;let d=await r,m=(s=(o=d.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content,h=d.automaticFunctionCallingHistory,y=this.getHistory(!0).length,_=[];h!=null&&(_=(u=h.slice(y))!==null&&u!==void 0?u:[]);let C=m?[m]:[];this.recordHistory(i,C,_)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),r}async sendMessageStream(e){var t;await this.sendPromise;let i=Zt(e.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=r.then(()=>{}).catch(()=>{});let o=await r;return this.processStreamResponse(o,i)}getHistory(e=!1){let t=e?B2(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return oi(this,arguments,function*(){var r,o,s,u,d,m;let h=[];try{for(var y=!0,_=si(e),C;C=yield _e(_.next()),r=C.done,!r;y=!0){u=C.value,y=!1;let D=u;if(O4(D)){let I=(m=(d=D.candidates)===null||d===void 0?void 0:d[0])===null||m===void 0?void 0:m.content;I!==void 0&&h.push(I)}yield yield _e(D)}}catch(D){o={error:D}}finally{try{!y&&!r&&(s=_.return)&&(yield _e(s.call(_)))}finally{if(o)throw o.error}}this.recordHistory(t,h)})}recordHistory(e,t,i){let r=[];t.length>0&&t.every(o=>o.role!==void 0)?r=t:r.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...B2(i)):this.history.push(e),this.history.push(...r)}};var Yl=class n extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,n.prototype)}};function B4(n){let e={},t=p(n,["file"]);return t!=null&&g(e,["file"],t),e}function U4(n){let e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function $4(n){let e={},t=p(n,["name"]);return t!=null&&g(e,["_url","file"],pb(t)),e}function H4(n){let e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function G4(n){let e={},t=p(n,["name"]);return t!=null&&g(e,["_url","file"],pb(t)),e}function q4(n,e){let t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);let r=p(n,["pageToken"]);return e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),t}function W4(n){let e={},t=p(n,["config"]);return t!=null&&q4(t,e),e}function j4(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);let r=p(n,["files"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>s)),g(e,["files"],o)}return e}var _y=class extends ai{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Ki(br.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=W4(e);return o=X("files",u._url),s=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(m=>{let h=m;return h.sdkHttpResponse={headers:d.headers},h})),r.then(d=>{let m=j4(d),h=new sy;return Object.assign(h,m),h})}}async createInternal(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=B4(e);return o=X("upload/v1beta/files",u._url),s=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>{let m=U4(d),h=new ay;return Object.assign(h,m),h})}}async get(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=G4(e);return o=X("files/{file}",u._url),s=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>d)}}async delete(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=$4(e);return o=X("files/{file}",u._url),s=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(m=>{let h=m;return h.sdkHttpResponse={headers:d.headers},h})),r.then(d=>{let m=H4(d),h=new ly;return Object.assign(h,m),h})}}};function _m(n){let e={},t=p(n,["data"]);if(t!=null&&g(e,["data"],t),p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function z4(n){let e={},t=p(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>uF(o))),g(e,["parts"],r)}let i=p(n,["role"]);return i!=null&&g(e,["role"],i),e}function Y4(n){let e={};if(p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let t=p(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);let i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function J4(n){let e={},t=p(n,["id"]);t!=null&&g(e,["id"],t);let i=p(n,["args"]);i!=null&&g(e,["args"],i);let r=p(n,["name"]);if(r!=null&&g(e,["name"],r),p(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function K4(n){let e={},t=p(n,["description"]);t!=null&&g(e,["description"],t);let i=p(n,["name"]);i!=null&&g(e,["name"],i);let r=p(n,["parameters"]);r!=null&&g(e,["parameters"],r);let o=p(n,["parametersJsonSchema"]);o!=null&&g(e,["parametersJsonSchema"],o);let s=p(n,["response"]);s!=null&&g(e,["response"],s);let u=p(n,["responseJsonSchema"]);if(u!=null&&g(e,["responseJsonSchema"],u),p(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function Q4(n){let e={},t=p(n,["modelSelectionConfig"]);t!=null&&g(e,["modelConfig"],t);let i=p(n,["responseJsonSchema"]);i!=null&&g(e,["responseJsonSchema"],i);let r=p(n,["audioTimestamp"]);r!=null&&g(e,["audioTimestamp"],r);let o=p(n,["candidateCount"]);o!=null&&g(e,["candidateCount"],o);let s=p(n,["enableAffectiveDialog"]);s!=null&&g(e,["enableAffectiveDialog"],s);let u=p(n,["frequencyPenalty"]);u!=null&&g(e,["frequencyPenalty"],u);let d=p(n,["logprobs"]);d!=null&&g(e,["logprobs"],d);let m=p(n,["maxOutputTokens"]);m!=null&&g(e,["maxOutputTokens"],m);let h=p(n,["mediaResolution"]);h!=null&&g(e,["mediaResolution"],h);let y=p(n,["presencePenalty"]);y!=null&&g(e,["presencePenalty"],y);let _=p(n,["responseLogprobs"]);_!=null&&g(e,["responseLogprobs"],_);let C=p(n,["responseMimeType"]);C!=null&&g(e,["responseMimeType"],C);let D=p(n,["responseModalities"]);D!=null&&g(e,["responseModalities"],D);let I=p(n,["responseSchema"]);I!=null&&g(e,["responseSchema"],I);let R=p(n,["routingConfig"]);R!=null&&g(e,["routingConfig"],R);let F=p(n,["seed"]);F!=null&&g(e,["seed"],F);let $=p(n,["speechConfig"]);$!=null&&g(e,["speechConfig"],$);let G=p(n,["stopSequences"]);G!=null&&g(e,["stopSequences"],G);let Y=p(n,["temperature"]);Y!=null&&g(e,["temperature"],Y);let ne=p(n,["thinkingConfig"]);ne!=null&&g(e,["thinkingConfig"],ne);let de=p(n,["topK"]);de!=null&&g(e,["topK"],de);let le=p(n,["topP"]);if(le!=null&&g(e,["topP"],le),p(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function Z4(n){let e={};if(p(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");let t=p(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function X4(n){let e={};if(p(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");let t=p(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function eF(n,e){let t={},i=p(n,["generationConfig"]);e!==void 0&&i!=null&&g(e,["setup","generationConfig"],i);let r=p(n,["responseModalities"]);e!==void 0&&r!=null&&g(e,["setup","generationConfig","responseModalities"],r);let o=p(n,["temperature"]);e!==void 0&&o!=null&&g(e,["setup","generationConfig","temperature"],o);let s=p(n,["topP"]);e!==void 0&&s!=null&&g(e,["setup","generationConfig","topP"],s);let u=p(n,["topK"]);e!==void 0&&u!=null&&g(e,["setup","generationConfig","topK"],u);let d=p(n,["maxOutputTokens"]);e!==void 0&&d!=null&&g(e,["setup","generationConfig","maxOutputTokens"],d);let m=p(n,["mediaResolution"]);e!==void 0&&m!=null&&g(e,["setup","generationConfig","mediaResolution"],m);let h=p(n,["seed"]);e!==void 0&&h!=null&&g(e,["setup","generationConfig","seed"],h);let y=p(n,["speechConfig"]);e!==void 0&&y!=null&&g(e,["setup","generationConfig","speechConfig"],Qy(y));let _=p(n,["thinkingConfig"]);e!==void 0&&_!=null&&g(e,["setup","generationConfig","thinkingConfig"],_);let C=p(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],C);let D=p(n,["systemInstruction"]);e!==void 0&&D!=null&&g(e,["setup","systemInstruction"],z4(Zt(D)));let I=p(n,["tools"]);if(e!==void 0&&I!=null){let de=Ps(I);Array.isArray(de)&&(de=de.map(le=>cF(Fs(le)))),g(e,["setup","tools"],de)}let R=p(n,["sessionResumption"]);e!==void 0&&R!=null&&g(e,["setup","sessionResumption"],dF(R));let F=p(n,["inputAudioTranscription"]);e!==void 0&&F!=null&&g(e,["setup","inputAudioTranscription"],F);let $=p(n,["outputAudioTranscription"]);e!==void 0&&$!=null&&g(e,["setup","outputAudioTranscription"],$);let G=p(n,["realtimeInputConfig"]);e!==void 0&&G!=null&&g(e,["setup","realtimeInputConfig"],G);let Y=p(n,["contextWindowCompression"]);e!==void 0&&Y!=null&&g(e,["setup","contextWindowCompression"],Y);let ne=p(n,["proactivity"]);if(e!==void 0&&ne!=null&&g(e,["setup","proactivity"],ne),p(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function tF(n,e){let t={},i=p(n,["generationConfig"]);e!==void 0&&i!=null&&g(e,["setup","generationConfig"],Q4(i));let r=p(n,["responseModalities"]);e!==void 0&&r!=null&&g(e,["setup","generationConfig","responseModalities"],r);let o=p(n,["temperature"]);e!==void 0&&o!=null&&g(e,["setup","generationConfig","temperature"],o);let s=p(n,["topP"]);e!==void 0&&s!=null&&g(e,["setup","generationConfig","topP"],s);let u=p(n,["topK"]);e!==void 0&&u!=null&&g(e,["setup","generationConfig","topK"],u);let d=p(n,["maxOutputTokens"]);e!==void 0&&d!=null&&g(e,["setup","generationConfig","maxOutputTokens"],d);let m=p(n,["mediaResolution"]);e!==void 0&&m!=null&&g(e,["setup","generationConfig","mediaResolution"],m);let h=p(n,["seed"]);e!==void 0&&h!=null&&g(e,["setup","generationConfig","seed"],h);let y=p(n,["speechConfig"]);e!==void 0&&y!=null&&g(e,["setup","generationConfig","speechConfig"],Qy(y));let _=p(n,["thinkingConfig"]);e!==void 0&&_!=null&&g(e,["setup","generationConfig","thinkingConfig"],_);let C=p(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],C);let D=p(n,["systemInstruction"]);e!==void 0&&D!=null&&g(e,["setup","systemInstruction"],Zt(D));let I=p(n,["tools"]);if(e!==void 0&&I!=null){let le=Ps(I);Array.isArray(le)&&(le=le.map(Ue=>mF(Fs(Ue)))),g(e,["setup","tools"],le)}let R=p(n,["sessionResumption"]);e!==void 0&&R!=null&&g(e,["setup","sessionResumption"],R);let F=p(n,["inputAudioTranscription"]);e!==void 0&&F!=null&&g(e,["setup","inputAudioTranscription"],F);let $=p(n,["outputAudioTranscription"]);e!==void 0&&$!=null&&g(e,["setup","outputAudioTranscription"],$);let G=p(n,["realtimeInputConfig"]);e!==void 0&&G!=null&&g(e,["setup","realtimeInputConfig"],G);let Y=p(n,["contextWindowCompression"]);e!==void 0&&Y!=null&&g(e,["setup","contextWindowCompression"],Y);let ne=p(n,["proactivity"]);e!==void 0&&ne!=null&&g(e,["setup","proactivity"],ne);let de=p(n,["explicitVadSignal"]);return e!==void 0&&de!=null&&g(e,["setup","explicitVadSignal"],de),t}function nF(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["setup","model"],Ge(n,i));let r=p(e,["config"]);return r!=null&&g(t,["config"],eF(r,t)),t}function iF(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["setup","model"],Ge(n,i));let r=p(e,["config"]);return r!=null&&g(t,["config"],tF(r,t)),t}function rF(n){let e={},t=p(n,["musicGenerationConfig"]);return t!=null&&g(e,["musicGenerationConfig"],t),e}function oF(n){let e={},t=p(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),g(e,["weightedPrompts"],i)}return e}function sF(n){let e={},t=p(n,["media"]);if(t!=null){let m=lb(t);Array.isArray(m)&&(m=m.map(h=>_m(h))),g(e,["mediaChunks"],m)}let i=p(n,["audio"]);i!=null&&g(e,["audio"],_m(db(i)));let r=p(n,["audioStreamEnd"]);r!=null&&g(e,["audioStreamEnd"],r);let o=p(n,["video"]);o!=null&&g(e,["video"],_m(ub(o)));let s=p(n,["text"]);s!=null&&g(e,["text"],s);let u=p(n,["activityStart"]);u!=null&&g(e,["activityStart"],u);let d=p(n,["activityEnd"]);return d!=null&&g(e,["activityEnd"],d),e}function aF(n){let e={},t=p(n,["media"]);if(t!=null){let m=lb(t);Array.isArray(m)&&(m=m.map(h=>h)),g(e,["mediaChunks"],m)}let i=p(n,["audio"]);i!=null&&g(e,["audio"],db(i));let r=p(n,["audioStreamEnd"]);r!=null&&g(e,["audioStreamEnd"],r);let o=p(n,["video"]);o!=null&&g(e,["video"],ub(o));let s=p(n,["text"]);s!=null&&g(e,["text"],s);let u=p(n,["activityStart"]);u!=null&&g(e,["activityStart"],u);let d=p(n,["activityEnd"]);return d!=null&&g(e,["activityEnd"],d),e}function lF(n){let e={},t=p(n,["setupComplete"]);t!=null&&g(e,["setupComplete"],t);let i=p(n,["serverContent"]);i!=null&&g(e,["serverContent"],i);let r=p(n,["toolCall"]);r!=null&&g(e,["toolCall"],r);let o=p(n,["toolCallCancellation"]);o!=null&&g(e,["toolCallCancellation"],o);let s=p(n,["usageMetadata"]);s!=null&&g(e,["usageMetadata"],pF(s));let u=p(n,["goAway"]);u!=null&&g(e,["goAway"],u);let d=p(n,["sessionResumptionUpdate"]);d!=null&&g(e,["sessionResumptionUpdate"],d);let m=p(n,["voiceActivityDetectionSignal"]);m!=null&&g(e,["voiceActivityDetectionSignal"],m);let h=p(n,["voiceActivity"]);return h!=null&&g(e,["voiceActivity"],fF(h)),e}function uF(n){let e={},t=p(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);let i=p(n,["codeExecutionResult"]);i!=null&&g(e,["codeExecutionResult"],i);let r=p(n,["executableCode"]);r!=null&&g(e,["executableCode"],r);let o=p(n,["fileData"]);o!=null&&g(e,["fileData"],Y4(o));let s=p(n,["functionCall"]);s!=null&&g(e,["functionCall"],J4(s));let u=p(n,["functionResponse"]);u!=null&&g(e,["functionResponse"],u);let d=p(n,["inlineData"]);d!=null&&g(e,["inlineData"],_m(d));let m=p(n,["text"]);m!=null&&g(e,["text"],m);let h=p(n,["thought"]);h!=null&&g(e,["thought"],h);let y=p(n,["thoughtSignature"]);y!=null&&g(e,["thoughtSignature"],y);let _=p(n,["videoMetadata"]);return _!=null&&g(e,["videoMetadata"],_),e}function dF(n){let e={},t=p(n,["handle"]);if(t!=null&&g(e,["handle"],t),p(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function cF(n){let e={};if(p(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");let t=p(n,["computerUse"]);t!=null&&g(e,["computerUse"],t);let i=p(n,["fileSearch"]);i!=null&&g(e,["fileSearch"],i);let r=p(n,["codeExecution"]);if(r!=null&&g(e,["codeExecution"],r),p(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");let o=p(n,["functionDeclarations"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(y=>y)),g(e,["functionDeclarations"],h)}let s=p(n,["googleMaps"]);s!=null&&g(e,["googleMaps"],Z4(s));let u=p(n,["googleSearch"]);u!=null&&g(e,["googleSearch"],X4(u));let d=p(n,["googleSearchRetrieval"]);d!=null&&g(e,["googleSearchRetrieval"],d);let m=p(n,["urlContext"]);return m!=null&&g(e,["urlContext"],m),e}function mF(n){let e={},t=p(n,["retrieval"]);t!=null&&g(e,["retrieval"],t);let i=p(n,["computerUse"]);if(i!=null&&g(e,["computerUse"],i),p(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");let r=p(n,["codeExecution"]);r!=null&&g(e,["codeExecution"],r);let o=p(n,["enterpriseWebSearch"]);o!=null&&g(e,["enterpriseWebSearch"],o);let s=p(n,["functionDeclarations"]);if(s!=null){let y=s;Array.isArray(y)&&(y=y.map(_=>K4(_))),g(e,["functionDeclarations"],y)}let u=p(n,["googleMaps"]);u!=null&&g(e,["googleMaps"],u);let d=p(n,["googleSearch"]);d!=null&&g(e,["googleSearch"],d);let m=p(n,["googleSearchRetrieval"]);m!=null&&g(e,["googleSearchRetrieval"],m);let h=p(n,["urlContext"]);return h!=null&&g(e,["urlContext"],h),e}function pF(n){let e={},t=p(n,["promptTokenCount"]);t!=null&&g(e,["promptTokenCount"],t);let i=p(n,["cachedContentTokenCount"]);i!=null&&g(e,["cachedContentTokenCount"],i);let r=p(n,["candidatesTokenCount"]);r!=null&&g(e,["responseTokenCount"],r);let o=p(n,["toolUsePromptTokenCount"]);o!=null&&g(e,["toolUsePromptTokenCount"],o);let s=p(n,["thoughtsTokenCount"]);s!=null&&g(e,["thoughtsTokenCount"],s);let u=p(n,["totalTokenCount"]);u!=null&&g(e,["totalTokenCount"],u);let d=p(n,["promptTokensDetails"]);if(d!=null){let C=d;Array.isArray(C)&&(C=C.map(D=>D)),g(e,["promptTokensDetails"],C)}let m=p(n,["cacheTokensDetails"]);if(m!=null){let C=m;Array.isArray(C)&&(C=C.map(D=>D)),g(e,["cacheTokensDetails"],C)}let h=p(n,["candidatesTokensDetails"]);if(h!=null){let C=h;Array.isArray(C)&&(C=C.map(D=>D)),g(e,["responseTokensDetails"],C)}let y=p(n,["toolUsePromptTokensDetails"]);if(y!=null){let C=y;Array.isArray(C)&&(C=C.map(D=>D)),g(e,["toolUsePromptTokensDetails"],C)}let _=p(n,["trafficType"]);return _!=null&&g(e,["trafficType"],_),e}function fF(n){let e={},t=p(n,["type"]);return t!=null&&g(e,["voiceActivityType"],t),e}function gF(n){let e={},t=p(n,["data"]);if(t!=null&&g(e,["data"],t),p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function hF(n){let e={},t=p(n,["content"]);t!=null&&g(e,["content"],t);let i=p(n,["citationMetadata"]);i!=null&&g(e,["citationMetadata"],yF(i));let r=p(n,["tokenCount"]);r!=null&&g(e,["tokenCount"],r);let o=p(n,["finishReason"]);o!=null&&g(e,["finishReason"],o);let s=p(n,["avgLogprobs"]);s!=null&&g(e,["avgLogprobs"],s);let u=p(n,["groundingMetadata"]);u!=null&&g(e,["groundingMetadata"],u);let d=p(n,["index"]);d!=null&&g(e,["index"],d);let m=p(n,["logprobsResult"]);m!=null&&g(e,["logprobsResult"],m);let h=p(n,["safetyRatings"]);if(h!=null){let _=h;Array.isArray(_)&&(_=_.map(C=>C)),g(e,["safetyRatings"],_)}let y=p(n,["urlContextMetadata"]);return y!=null&&g(e,["urlContextMetadata"],y),e}function yF(n){let e={},t=p(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),g(e,["citations"],i)}return e}function _F(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],Ge(n,i));let r=p(e,["contents"]);if(r!=null){let o=Gn(r);Array.isArray(o)&&(o=o.map(s=>s)),g(t,["contents"],o)}return t}function vF(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["tokensInfo"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>o)),g(e,["tokensInfo"],r)}return e}function CF(n){let e={},t=p(n,["values"]);t!=null&&g(e,["values"],t);let i=p(n,["statistics"]);return i!=null&&g(e,["statistics"],xF(i)),e}function xF(n){let e={},t=p(n,["truncated"]);t!=null&&g(e,["truncated"],t);let i=p(n,["token_count"]);return i!=null&&g(e,["tokenCount"],i),e}function jm(n){let e={},t=p(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>AP(o))),g(e,["parts"],r)}let i=p(n,["role"]);return i!=null&&g(e,["role"],i),e}function EF(n){let e={},t=p(n,["controlType"]);t!=null&&g(e,["controlType"],t);let i=p(n,["enableControlImageComputation"]);return i!=null&&g(e,["computeControl"],i),e}function bF(n){let e={};if(p(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(p(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(p(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function SF(n,e){let t={},i=p(n,["systemInstruction"]);e!==void 0&&i!=null&&g(e,["systemInstruction"],Zt(i));let r=p(n,["tools"]);if(e!==void 0&&r!=null){let s=r;Array.isArray(s)&&(s=s.map(u=>Sb(u))),g(e,["tools"],s)}let o=p(n,["generationConfig"]);return e!==void 0&&o!=null&&g(e,["generationConfig"],gP(o)),t}function DF(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],Ge(n,i));let r=p(e,["contents"]);if(r!=null){let s=Gn(r);Array.isArray(s)&&(s=s.map(u=>jm(u))),g(t,["contents"],s)}let o=p(e,["config"]);return o!=null&&bF(o),t}function wF(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],Ge(n,i));let r=p(e,["contents"]);if(r!=null){let s=Gn(r);Array.isArray(s)&&(s=s.map(u=>u)),g(t,["contents"],s)}let o=p(e,["config"]);return o!=null&&SF(o,t),t}function TF(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["totalTokens"]);i!=null&&g(e,["totalTokens"],i);let r=p(n,["cachedContentTokenCount"]);return r!=null&&g(e,["cachedContentTokenCount"],r),e}function IF(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["totalTokens"]);return i!=null&&g(e,["totalTokens"],i),e}function MF(n,e){let t={},i=p(e,["model"]);return i!=null&&g(t,["_url","name"],Ge(n,i)),t}function AF(n,e){let t={},i=p(e,["model"]);return i!=null&&g(t,["_url","name"],Ge(n,i)),t}function NF(n){let e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function RF(n){let e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function FF(n,e){let t={},i=p(n,["outputGcsUri"]);e!==void 0&&i!=null&&g(e,["parameters","storageUri"],i);let r=p(n,["negativePrompt"]);e!==void 0&&r!=null&&g(e,["parameters","negativePrompt"],r);let o=p(n,["numberOfImages"]);e!==void 0&&o!=null&&g(e,["parameters","sampleCount"],o);let s=p(n,["aspectRatio"]);e!==void 0&&s!=null&&g(e,["parameters","aspectRatio"],s);let u=p(n,["guidanceScale"]);e!==void 0&&u!=null&&g(e,["parameters","guidanceScale"],u);let d=p(n,["seed"]);e!==void 0&&d!=null&&g(e,["parameters","seed"],d);let m=p(n,["safetyFilterLevel"]);e!==void 0&&m!=null&&g(e,["parameters","safetySetting"],m);let h=p(n,["personGeneration"]);e!==void 0&&h!=null&&g(e,["parameters","personGeneration"],h);let y=p(n,["includeSafetyAttributes"]);e!==void 0&&y!=null&&g(e,["parameters","includeSafetyAttributes"],y);let _=p(n,["includeRaiReason"]);e!==void 0&&_!=null&&g(e,["parameters","includeRaiReason"],_);let C=p(n,["language"]);e!==void 0&&C!=null&&g(e,["parameters","language"],C);let D=p(n,["outputMimeType"]);e!==void 0&&D!=null&&g(e,["parameters","outputOptions","mimeType"],D);let I=p(n,["outputCompressionQuality"]);e!==void 0&&I!=null&&g(e,["parameters","outputOptions","compressionQuality"],I);let R=p(n,["addWatermark"]);e!==void 0&&R!=null&&g(e,["parameters","addWatermark"],R);let F=p(n,["labels"]);e!==void 0&&F!=null&&g(e,["labels"],F);let $=p(n,["editMode"]);e!==void 0&&$!=null&&g(e,["parameters","editMode"],$);let G=p(n,["baseSteps"]);return e!==void 0&&G!=null&&g(e,["parameters","editConfig","baseSteps"],G),t}function PF(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],Ge(n,i));let r=p(e,["prompt"]);r!=null&&g(t,["instances[0]","prompt"],r);let o=p(e,["referenceImages"]);if(o!=null){let u=o;Array.isArray(u)&&(u=u.map(d=>VP(d))),g(t,["instances[0]","referenceImages"],u)}let s=p(e,["config"]);return s!=null&&FF(s,t),t}function kF(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>zm(o))),g(e,["generatedImages"],r)}return e}function VF(n,e){let t={},i=p(n,["taskType"]);e!==void 0&&i!=null&&g(e,["requests[]","taskType"],i);let r=p(n,["title"]);e!==void 0&&r!=null&&g(e,["requests[]","title"],r);let o=p(n,["outputDimensionality"]);if(e!==void 0&&o!=null&&g(e,["requests[]","outputDimensionality"],o),p(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(p(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function OF(n,e){let t={},i=p(n,["taskType"]);e!==void 0&&i!=null&&g(e,["instances[]","task_type"],i);let r=p(n,["title"]);e!==void 0&&r!=null&&g(e,["instances[]","title"],r);let o=p(n,["outputDimensionality"]);e!==void 0&&o!=null&&g(e,["parameters","outputDimensionality"],o);let s=p(n,["mimeType"]);e!==void 0&&s!=null&&g(e,["instances[]","mimeType"],s);let u=p(n,["autoTruncate"]);return e!==void 0&&u!=null&&g(e,["parameters","autoTruncate"],u),t}function LF(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],Ge(n,i));let r=p(e,["contents"]);if(r!=null){let u=Yy(n,r);Array.isArray(u)&&(u=u.map(d=>d)),g(t,["requests[]","content"],u)}let o=p(e,["config"]);o!=null&&VF(o,t);let s=p(e,["model"]);return s!==void 0&&g(t,["requests[]","model"],Ge(n,s)),t}function BF(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],Ge(n,i));let r=p(e,["contents"]);if(r!=null){let s=Yy(n,r);Array.isArray(s)&&(s=s.map(u=>u)),g(t,["instances[]","content"],s)}let o=p(e,["config"]);return o!=null&&OF(o,t),t}function UF(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["embeddings"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>s)),g(e,["embeddings"],o)}let r=p(n,["metadata"]);return r!=null&&g(e,["metadata"],r),e}function $F(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["predictions[]","embeddings"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>CF(s))),g(e,["embeddings"],o)}let r=p(n,["metadata"]);return r!=null&&g(e,["metadata"],r),e}function HF(n){let e={},t=p(n,["endpoint"]);t!=null&&g(e,["name"],t);let i=p(n,["deployedModelId"]);return i!=null&&g(e,["deployedModelId"],i),e}function GF(n){let e={};if(p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let t=p(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);let i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function qF(n){let e={},t=p(n,["id"]);t!=null&&g(e,["id"],t);let i=p(n,["args"]);i!=null&&g(e,["args"],i);let r=p(n,["name"]);if(r!=null&&g(e,["name"],r),p(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function WF(n){let e={},t=p(n,["allowedFunctionNames"]);t!=null&&g(e,["allowedFunctionNames"],t);let i=p(n,["mode"]);if(i!=null&&g(e,["mode"],i),p(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function jF(n){let e={},t=p(n,["description"]);t!=null&&g(e,["description"],t);let i=p(n,["name"]);i!=null&&g(e,["name"],i);let r=p(n,["parameters"]);r!=null&&g(e,["parameters"],r);let o=p(n,["parametersJsonSchema"]);o!=null&&g(e,["parametersJsonSchema"],o);let s=p(n,["response"]);s!=null&&g(e,["response"],s);let u=p(n,["responseJsonSchema"]);if(u!=null&&g(e,["responseJsonSchema"],u),p(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function zF(n,e,t){let i={},r=p(e,["systemInstruction"]);t!==void 0&&r!=null&&g(t,["systemInstruction"],jm(Zt(r)));let o=p(e,["temperature"]);o!=null&&g(i,["temperature"],o);let s=p(e,["topP"]);s!=null&&g(i,["topP"],s);let u=p(e,["topK"]);u!=null&&g(i,["topK"],u);let d=p(e,["candidateCount"]);d!=null&&g(i,["candidateCount"],d);let m=p(e,["maxOutputTokens"]);m!=null&&g(i,["maxOutputTokens"],m);let h=p(e,["stopSequences"]);h!=null&&g(i,["stopSequences"],h);let y=p(e,["responseLogprobs"]);y!=null&&g(i,["responseLogprobs"],y);let _=p(e,["logprobs"]);_!=null&&g(i,["logprobs"],_);let C=p(e,["presencePenalty"]);C!=null&&g(i,["presencePenalty"],C);let D=p(e,["frequencyPenalty"]);D!=null&&g(i,["frequencyPenalty"],D);let I=p(e,["seed"]);I!=null&&g(i,["seed"],I);let R=p(e,["responseMimeType"]);R!=null&&g(i,["responseMimeType"],R);let F=p(e,["responseSchema"]);F!=null&&g(i,["responseSchema"],Jy(F));let $=p(e,["responseJsonSchema"]);if($!=null&&g(i,["responseJsonSchema"],$),p(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(p(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");let G=p(e,["safetySettings"]);if(t!==void 0&&G!=null){let ct=G;Array.isArray(ct)&&(ct=ct.map(di=>OP(di))),g(t,["safetySettings"],ct)}let Y=p(e,["tools"]);if(t!==void 0&&Y!=null){let ct=Ps(Y);Array.isArray(ct)&&(ct=ct.map(di=>qP(Fs(di)))),g(t,["tools"],ct)}let ne=p(e,["toolConfig"]);if(t!==void 0&&ne!=null&&g(t,["toolConfig"],GP(ne)),p(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");let de=p(e,["cachedContent"]);t!==void 0&&de!=null&&g(t,["cachedContent"],Qi(n,de));let le=p(e,["responseModalities"]);le!=null&&g(i,["responseModalities"],le);let Ue=p(e,["mediaResolution"]);Ue!=null&&g(i,["mediaResolution"],Ue);let pe=p(e,["speechConfig"]);if(pe!=null&&g(i,["speechConfig"],Ky(pe)),p(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");let we=p(e,["thinkingConfig"]);we!=null&&g(i,["thinkingConfig"],we);let _t=p(e,["imageConfig"]);_t!=null&&g(i,["imageConfig"],CP(_t));let ui=p(e,["enableEnhancedCivicAnswers"]);if(ui!=null&&g(i,["enableEnhancedCivicAnswers"],ui),p(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return i}function YF(n,e,t){let i={},r=p(e,["systemInstruction"]);t!==void 0&&r!=null&&g(t,["systemInstruction"],Zt(r));let o=p(e,["temperature"]);o!=null&&g(i,["temperature"],o);let s=p(e,["topP"]);s!=null&&g(i,["topP"],s);let u=p(e,["topK"]);u!=null&&g(i,["topK"],u);let d=p(e,["candidateCount"]);d!=null&&g(i,["candidateCount"],d);let m=p(e,["maxOutputTokens"]);m!=null&&g(i,["maxOutputTokens"],m);let h=p(e,["stopSequences"]);h!=null&&g(i,["stopSequences"],h);let y=p(e,["responseLogprobs"]);y!=null&&g(i,["responseLogprobs"],y);let _=p(e,["logprobs"]);_!=null&&g(i,["logprobs"],_);let C=p(e,["presencePenalty"]);C!=null&&g(i,["presencePenalty"],C);let D=p(e,["frequencyPenalty"]);D!=null&&g(i,["frequencyPenalty"],D);let I=p(e,["seed"]);I!=null&&g(i,["seed"],I);let R=p(e,["responseMimeType"]);R!=null&&g(i,["responseMimeType"],R);let F=p(e,["responseSchema"]);F!=null&&g(i,["responseSchema"],Jy(F));let $=p(e,["responseJsonSchema"]);$!=null&&g(i,["responseJsonSchema"],$);let G=p(e,["routingConfig"]);G!=null&&g(i,["routingConfig"],G);let Y=p(e,["modelSelectionConfig"]);Y!=null&&g(i,["modelConfig"],Y);let ne=p(e,["safetySettings"]);if(t!==void 0&&ne!=null){let Ii=ne;Array.isArray(Ii)&&(Ii=Ii.map(Sp=>Sp)),g(t,["safetySettings"],Ii)}let de=p(e,["tools"]);if(t!==void 0&&de!=null){let Ii=Ps(de);Array.isArray(Ii)&&(Ii=Ii.map(Sp=>Sb(Fs(Sp)))),g(t,["tools"],Ii)}let le=p(e,["toolConfig"]);t!==void 0&&le!=null&&g(t,["toolConfig"],le);let Ue=p(e,["labels"]);t!==void 0&&Ue!=null&&g(t,["labels"],Ue);let pe=p(e,["cachedContent"]);t!==void 0&&pe!=null&&g(t,["cachedContent"],Qi(n,pe));let we=p(e,["responseModalities"]);we!=null&&g(i,["responseModalities"],we);let _t=p(e,["mediaResolution"]);_t!=null&&g(i,["mediaResolution"],_t);let ui=p(e,["speechConfig"]);ui!=null&&g(i,["speechConfig"],Ky(ui));let ct=p(e,["audioTimestamp"]);ct!=null&&g(i,["audioTimestamp"],ct);let di=p(e,["thinkingConfig"]);di!=null&&g(i,["thinkingConfig"],di);let n_=p(e,["imageConfig"]);if(n_!=null&&g(i,["imageConfig"],xP(n_)),p(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");let i_=p(e,["modelArmorConfig"]);return t!==void 0&&i_!=null&&g(t,["modelArmorConfig"],i_),i}function U2(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],Ge(n,i));let r=p(e,["contents"]);if(r!=null){let s=Gn(r);Array.isArray(s)&&(s=s.map(u=>jm(u))),g(t,["contents"],s)}let o=p(e,["config"]);return o!=null&&g(t,["generationConfig"],zF(n,o,t)),t}function $2(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],Ge(n,i));let r=p(e,["contents"]);if(r!=null){let s=Gn(r);Array.isArray(s)&&(s=s.map(u=>u)),g(t,["contents"],s)}let o=p(e,["config"]);return o!=null&&g(t,["generationConfig"],YF(n,o,t)),t}function H2(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["candidates"]);if(i!=null){let d=i;Array.isArray(d)&&(d=d.map(m=>hF(m))),g(e,["candidates"],d)}let r=p(n,["modelVersion"]);r!=null&&g(e,["modelVersion"],r);let o=p(n,["promptFeedback"]);o!=null&&g(e,["promptFeedback"],o);let s=p(n,["responseId"]);s!=null&&g(e,["responseId"],s);let u=p(n,["usageMetadata"]);return u!=null&&g(e,["usageMetadata"],u),e}function G2(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["candidates"]);if(i!=null){let m=i;Array.isArray(m)&&(m=m.map(h=>h)),g(e,["candidates"],m)}let r=p(n,["createTime"]);r!=null&&g(e,["createTime"],r);let o=p(n,["modelVersion"]);o!=null&&g(e,["modelVersion"],o);let s=p(n,["promptFeedback"]);s!=null&&g(e,["promptFeedback"],s);let u=p(n,["responseId"]);u!=null&&g(e,["responseId"],u);let d=p(n,["usageMetadata"]);return d!=null&&g(e,["usageMetadata"],d),e}function JF(n,e){let t={};if(p(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(p(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");let i=p(n,["numberOfImages"]);e!==void 0&&i!=null&&g(e,["parameters","sampleCount"],i);let r=p(n,["aspectRatio"]);e!==void 0&&r!=null&&g(e,["parameters","aspectRatio"],r);let o=p(n,["guidanceScale"]);if(e!==void 0&&o!=null&&g(e,["parameters","guidanceScale"],o),p(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");let s=p(n,["safetyFilterLevel"]);e!==void 0&&s!=null&&g(e,["parameters","safetySetting"],s);let u=p(n,["personGeneration"]);e!==void 0&&u!=null&&g(e,["parameters","personGeneration"],u);let d=p(n,["includeSafetyAttributes"]);e!==void 0&&d!=null&&g(e,["parameters","includeSafetyAttributes"],d);let m=p(n,["includeRaiReason"]);e!==void 0&&m!=null&&g(e,["parameters","includeRaiReason"],m);let h=p(n,["language"]);e!==void 0&&h!=null&&g(e,["parameters","language"],h);let y=p(n,["outputMimeType"]);e!==void 0&&y!=null&&g(e,["parameters","outputOptions","mimeType"],y);let _=p(n,["outputCompressionQuality"]);if(e!==void 0&&_!=null&&g(e,["parameters","outputOptions","compressionQuality"],_),p(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(p(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");let C=p(n,["imageSize"]);if(e!==void 0&&C!=null&&g(e,["parameters","sampleImageSize"],C),p(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function KF(n,e){let t={},i=p(n,["outputGcsUri"]);e!==void 0&&i!=null&&g(e,["parameters","storageUri"],i);let r=p(n,["negativePrompt"]);e!==void 0&&r!=null&&g(e,["parameters","negativePrompt"],r);let o=p(n,["numberOfImages"]);e!==void 0&&o!=null&&g(e,["parameters","sampleCount"],o);let s=p(n,["aspectRatio"]);e!==void 0&&s!=null&&g(e,["parameters","aspectRatio"],s);let u=p(n,["guidanceScale"]);e!==void 0&&u!=null&&g(e,["parameters","guidanceScale"],u);let d=p(n,["seed"]);e!==void 0&&d!=null&&g(e,["parameters","seed"],d);let m=p(n,["safetyFilterLevel"]);e!==void 0&&m!=null&&g(e,["parameters","safetySetting"],m);let h=p(n,["personGeneration"]);e!==void 0&&h!=null&&g(e,["parameters","personGeneration"],h);let y=p(n,["includeSafetyAttributes"]);e!==void 0&&y!=null&&g(e,["parameters","includeSafetyAttributes"],y);let _=p(n,["includeRaiReason"]);e!==void 0&&_!=null&&g(e,["parameters","includeRaiReason"],_);let C=p(n,["language"]);e!==void 0&&C!=null&&g(e,["parameters","language"],C);let D=p(n,["outputMimeType"]);e!==void 0&&D!=null&&g(e,["parameters","outputOptions","mimeType"],D);let I=p(n,["outputCompressionQuality"]);e!==void 0&&I!=null&&g(e,["parameters","outputOptions","compressionQuality"],I);let R=p(n,["addWatermark"]);e!==void 0&&R!=null&&g(e,["parameters","addWatermark"],R);let F=p(n,["labels"]);e!==void 0&&F!=null&&g(e,["labels"],F);let $=p(n,["imageSize"]);e!==void 0&&$!=null&&g(e,["parameters","sampleImageSize"],$);let G=p(n,["enhancePrompt"]);return e!==void 0&&G!=null&&g(e,["parameters","enhancePrompt"],G),t}function QF(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],Ge(n,i));let r=p(e,["prompt"]);r!=null&&g(t,["instances[0]","prompt"],r);let o=p(e,["config"]);return o!=null&&JF(o,t),t}function ZF(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],Ge(n,i));let r=p(e,["prompt"]);r!=null&&g(t,["instances[0]","prompt"],r);let o=p(e,["config"]);return o!=null&&KF(o,t),t}function XF(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>cP(s))),g(e,["generatedImages"],o)}let r=p(n,["positivePromptSafetyAttributes"]);return r!=null&&g(e,["positivePromptSafetyAttributes"],Eb(r)),e}function eP(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>zm(s))),g(e,["generatedImages"],o)}let r=p(n,["positivePromptSafetyAttributes"]);return r!=null&&g(e,["positivePromptSafetyAttributes"],bb(r)),e}function tP(n,e){let t={},i=p(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&g(e,["parameters","sampleCount"],i),p(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(p(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");let r=p(n,["durationSeconds"]);if(e!==void 0&&r!=null&&g(e,["parameters","durationSeconds"],r),p(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");let o=p(n,["aspectRatio"]);e!==void 0&&o!=null&&g(e,["parameters","aspectRatio"],o);let s=p(n,["resolution"]);e!==void 0&&s!=null&&g(e,["parameters","resolution"],s);let u=p(n,["personGeneration"]);if(e!==void 0&&u!=null&&g(e,["parameters","personGeneration"],u),p(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");let d=p(n,["negativePrompt"]);e!==void 0&&d!=null&&g(e,["parameters","negativePrompt"],d);let m=p(n,["enhancePrompt"]);if(e!==void 0&&m!=null&&g(e,["parameters","enhancePrompt"],m),p(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");let h=p(n,["lastFrame"]);e!==void 0&&h!=null&&g(e,["instances[0]","lastFrame"],Ym(h));let y=p(n,["referenceImages"]);if(e!==void 0&&y!=null){let _=y;Array.isArray(_)&&(_=_.map(C=>ik(C))),g(e,["instances[0]","referenceImages"],_)}if(p(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(p(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function nP(n,e){let t={},i=p(n,["numberOfVideos"]);e!==void 0&&i!=null&&g(e,["parameters","sampleCount"],i);let r=p(n,["outputGcsUri"]);e!==void 0&&r!=null&&g(e,["parameters","storageUri"],r);let o=p(n,["fps"]);e!==void 0&&o!=null&&g(e,["parameters","fps"],o);let s=p(n,["durationSeconds"]);e!==void 0&&s!=null&&g(e,["parameters","durationSeconds"],s);let u=p(n,["seed"]);e!==void 0&&u!=null&&g(e,["parameters","seed"],u);let d=p(n,["aspectRatio"]);e!==void 0&&d!=null&&g(e,["parameters","aspectRatio"],d);let m=p(n,["resolution"]);e!==void 0&&m!=null&&g(e,["parameters","resolution"],m);let h=p(n,["personGeneration"]);e!==void 0&&h!=null&&g(e,["parameters","personGeneration"],h);let y=p(n,["pubsubTopic"]);e!==void 0&&y!=null&&g(e,["parameters","pubsubTopic"],y);let _=p(n,["negativePrompt"]);e!==void 0&&_!=null&&g(e,["parameters","negativePrompt"],_);let C=p(n,["enhancePrompt"]);e!==void 0&&C!=null&&g(e,["parameters","enhancePrompt"],C);let D=p(n,["generateAudio"]);e!==void 0&&D!=null&&g(e,["parameters","generateAudio"],D);let I=p(n,["lastFrame"]);e!==void 0&&I!=null&&g(e,["instances[0]","lastFrame"],li(I));let R=p(n,["referenceImages"]);if(e!==void 0&&R!=null){let G=R;Array.isArray(G)&&(G=G.map(Y=>rk(Y))),g(e,["instances[0]","referenceImages"],G)}let F=p(n,["mask"]);e!==void 0&&F!=null&&g(e,["instances[0]","mask"],nk(F));let $=p(n,["compressionQuality"]);return e!==void 0&&$!=null&&g(e,["parameters","compressionQuality"],$),t}function iP(n){let e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);let i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);let r=p(n,["done"]);r!=null&&g(e,["done"],r);let o=p(n,["error"]);o!=null&&g(e,["error"],o);let s=p(n,["response","generateVideoResponse"]);return s!=null&&g(e,["response"],aP(s)),e}function rP(n){let e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);let i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);let r=p(n,["done"]);r!=null&&g(e,["done"],r);let o=p(n,["error"]);o!=null&&g(e,["error"],o);let s=p(n,["response"]);return s!=null&&g(e,["response"],lP(s)),e}function oP(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],Ge(n,i));let r=p(e,["prompt"]);r!=null&&g(t,["instances[0]","prompt"],r);let o=p(e,["image"]);o!=null&&g(t,["instances[0]","image"],Ym(o));let s=p(e,["video"]);s!=null&&g(t,["instances[0]","video"],Db(s));let u=p(e,["source"]);u!=null&&uP(u,t);let d=p(e,["config"]);return d!=null&&tP(d,t),t}function sP(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],Ge(n,i));let r=p(e,["prompt"]);r!=null&&g(t,["instances[0]","prompt"],r);let o=p(e,["image"]);o!=null&&g(t,["instances[0]","image"],li(o));let s=p(e,["video"]);s!=null&&g(t,["instances[0]","video"],wb(s));let u=p(e,["source"]);u!=null&&dP(u,t);let d=p(e,["config"]);return d!=null&&nP(d,t),t}function aP(n){let e={},t=p(n,["generatedSamples"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(s=>pP(s))),g(e,["generatedVideos"],o)}let i=p(n,["raiMediaFilteredCount"]);i!=null&&g(e,["raiMediaFilteredCount"],i);let r=p(n,["raiMediaFilteredReasons"]);return r!=null&&g(e,["raiMediaFilteredReasons"],r),e}function lP(n){let e={},t=p(n,["videos"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(s=>fP(s))),g(e,["generatedVideos"],o)}let i=p(n,["raiMediaFilteredCount"]);i!=null&&g(e,["raiMediaFilteredCount"],i);let r=p(n,["raiMediaFilteredReasons"]);return r!=null&&g(e,["raiMediaFilteredReasons"],r),e}function uP(n,e){let t={},i=p(n,["prompt"]);e!==void 0&&i!=null&&g(e,["instances[0]","prompt"],i);let r=p(n,["image"]);e!==void 0&&r!=null&&g(e,["instances[0]","image"],Ym(r));let o=p(n,["video"]);return e!==void 0&&o!=null&&g(e,["instances[0]","video"],Db(o)),t}function dP(n,e){let t={},i=p(n,["prompt"]);e!==void 0&&i!=null&&g(e,["instances[0]","prompt"],i);let r=p(n,["image"]);e!==void 0&&r!=null&&g(e,["instances[0]","image"],li(r));let o=p(n,["video"]);return e!==void 0&&o!=null&&g(e,["instances[0]","video"],wb(o)),t}function cP(n){let e={},t=p(n,["_self"]);t!=null&&g(e,["image"],EP(t));let i=p(n,["raiFilteredReason"]);i!=null&&g(e,["raiFilteredReason"],i);let r=p(n,["_self"]);return r!=null&&g(e,["safetyAttributes"],Eb(r)),e}function zm(n){let e={},t=p(n,["_self"]);t!=null&&g(e,["image"],xb(t));let i=p(n,["raiFilteredReason"]);i!=null&&g(e,["raiFilteredReason"],i);let r=p(n,["_self"]);r!=null&&g(e,["safetyAttributes"],bb(r));let o=p(n,["prompt"]);return o!=null&&g(e,["enhancedPrompt"],o),e}function mP(n){let e={},t=p(n,["_self"]);t!=null&&g(e,["mask"],xb(t));let i=p(n,["labels"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>o)),g(e,["labels"],r)}return e}function pP(n){let e={},t=p(n,["video"]);return t!=null&&g(e,["video"],ek(t)),e}function fP(n){let e={},t=p(n,["_self"]);return t!=null&&g(e,["video"],tk(t)),e}function gP(n){let e={},t=p(n,["modelSelectionConfig"]);t!=null&&g(e,["modelConfig"],t);let i=p(n,["responseJsonSchema"]);i!=null&&g(e,["responseJsonSchema"],i);let r=p(n,["audioTimestamp"]);r!=null&&g(e,["audioTimestamp"],r);let o=p(n,["candidateCount"]);o!=null&&g(e,["candidateCount"],o);let s=p(n,["enableAffectiveDialog"]);s!=null&&g(e,["enableAffectiveDialog"],s);let u=p(n,["frequencyPenalty"]);u!=null&&g(e,["frequencyPenalty"],u);let d=p(n,["logprobs"]);d!=null&&g(e,["logprobs"],d);let m=p(n,["maxOutputTokens"]);m!=null&&g(e,["maxOutputTokens"],m);let h=p(n,["mediaResolution"]);h!=null&&g(e,["mediaResolution"],h);let y=p(n,["presencePenalty"]);y!=null&&g(e,["presencePenalty"],y);let _=p(n,["responseLogprobs"]);_!=null&&g(e,["responseLogprobs"],_);let C=p(n,["responseMimeType"]);C!=null&&g(e,["responseMimeType"],C);let D=p(n,["responseModalities"]);D!=null&&g(e,["responseModalities"],D);let I=p(n,["responseSchema"]);I!=null&&g(e,["responseSchema"],I);let R=p(n,["routingConfig"]);R!=null&&g(e,["routingConfig"],R);let F=p(n,["seed"]);F!=null&&g(e,["seed"],F);let $=p(n,["speechConfig"]);$!=null&&g(e,["speechConfig"],$);let G=p(n,["stopSequences"]);G!=null&&g(e,["stopSequences"],G);let Y=p(n,["temperature"]);Y!=null&&g(e,["temperature"],Y);let ne=p(n,["thinkingConfig"]);ne!=null&&g(e,["thinkingConfig"],ne);let de=p(n,["topK"]);de!=null&&g(e,["topK"],de);let le=p(n,["topP"]);if(le!=null&&g(e,["topP"],le),p(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function hP(n,e){let t={},i=p(e,["model"]);return i!=null&&g(t,["_url","name"],Ge(n,i)),t}function yP(n,e){let t={},i=p(e,["model"]);return i!=null&&g(t,["_url","name"],Ge(n,i)),t}function _P(n){let e={};if(p(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");let t=p(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function vP(n){let e={};if(p(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");let t=p(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function CP(n){let e={},t=p(n,["aspectRatio"]);t!=null&&g(e,["aspectRatio"],t);let i=p(n,["imageSize"]);if(i!=null&&g(e,["imageSize"],i),p(n,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(p(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(p(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function xP(n){let e={},t=p(n,["aspectRatio"]);t!=null&&g(e,["aspectRatio"],t);let i=p(n,["imageSize"]);i!=null&&g(e,["imageSize"],i);let r=p(n,["personGeneration"]);r!=null&&g(e,["personGeneration"],r);let o=p(n,["outputMimeType"]);o!=null&&g(e,["imageOutputOptions","mimeType"],o);let s=p(n,["outputCompressionQuality"]);return s!=null&&g(e,["imageOutputOptions","compressionQuality"],s),e}function EP(n){let e={},t=p(n,["bytesBase64Encoded"]);t!=null&&g(e,["imageBytes"],Er(t));let i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function xb(n){let e={},t=p(n,["gcsUri"]);t!=null&&g(e,["gcsUri"],t);let i=p(n,["bytesBase64Encoded"]);i!=null&&g(e,["imageBytes"],Er(i));let r=p(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function Ym(n){let e={};if(p(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");let t=p(n,["imageBytes"]);t!=null&&g(e,["bytesBase64Encoded"],Er(t));let i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function li(n){let e={},t=p(n,["gcsUri"]);t!=null&&g(e,["gcsUri"],t);let i=p(n,["imageBytes"]);i!=null&&g(e,["bytesBase64Encoded"],Er(i));let r=p(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function bP(n,e,t){let i={},r=p(e,["pageSize"]);t!==void 0&&r!=null&&g(t,["_query","pageSize"],r);let o=p(e,["pageToken"]);t!==void 0&&o!=null&&g(t,["_query","pageToken"],o);let s=p(e,["filter"]);t!==void 0&&s!=null&&g(t,["_query","filter"],s);let u=p(e,["queryBase"]);return t!==void 0&&u!=null&&g(t,["_url","models_url"],fb(n,u)),i}function SP(n,e,t){let i={},r=p(e,["pageSize"]);t!==void 0&&r!=null&&g(t,["_query","pageSize"],r);let o=p(e,["pageToken"]);t!==void 0&&o!=null&&g(t,["_query","pageToken"],o);let s=p(e,["filter"]);t!==void 0&&s!=null&&g(t,["_query","filter"],s);let u=p(e,["queryBase"]);return t!==void 0&&u!=null&&g(t,["_url","models_url"],fb(n,u)),i}function DP(n,e){let t={},i=p(e,["config"]);return i!=null&&bP(n,i,t),t}function wP(n,e){let t={},i=p(e,["config"]);return i!=null&&SP(n,i,t),t}function TP(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);let r=p(n,["_self"]);if(r!=null){let o=gb(r);Array.isArray(o)&&(o=o.map(s=>vy(s))),g(e,["models"],o)}return e}function IP(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);let r=p(n,["_self"]);if(r!=null){let o=gb(r);Array.isArray(o)&&(o=o.map(s=>Cy(s))),g(e,["models"],o)}return e}function MP(n){let e={},t=p(n,["maskMode"]);t!=null&&g(e,["maskMode"],t);let i=p(n,["segmentationClasses"]);i!=null&&g(e,["maskClasses"],i);let r=p(n,["maskDilation"]);return r!=null&&g(e,["dilation"],r),e}function vy(n){let e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);let i=p(n,["displayName"]);i!=null&&g(e,["displayName"],i);let r=p(n,["description"]);r!=null&&g(e,["description"],r);let o=p(n,["version"]);o!=null&&g(e,["version"],o);let s=p(n,["_self"]);s!=null&&g(e,["tunedModelInfo"],WP(s));let u=p(n,["inputTokenLimit"]);u!=null&&g(e,["inputTokenLimit"],u);let d=p(n,["outputTokenLimit"]);d!=null&&g(e,["outputTokenLimit"],d);let m=p(n,["supportedGenerationMethods"]);m!=null&&g(e,["supportedActions"],m);let h=p(n,["temperature"]);h!=null&&g(e,["temperature"],h);let y=p(n,["maxTemperature"]);y!=null&&g(e,["maxTemperature"],y);let _=p(n,["topP"]);_!=null&&g(e,["topP"],_);let C=p(n,["topK"]);C!=null&&g(e,["topK"],C);let D=p(n,["thinking"]);return D!=null&&g(e,["thinking"],D),e}function Cy(n){let e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);let i=p(n,["displayName"]);i!=null&&g(e,["displayName"],i);let r=p(n,["description"]);r!=null&&g(e,["description"],r);let o=p(n,["versionId"]);o!=null&&g(e,["version"],o);let s=p(n,["deployedModels"]);if(s!=null){let y=s;Array.isArray(y)&&(y=y.map(_=>HF(_))),g(e,["endpoints"],y)}let u=p(n,["labels"]);u!=null&&g(e,["labels"],u);let d=p(n,["_self"]);d!=null&&g(e,["tunedModelInfo"],jP(d));let m=p(n,["defaultCheckpointId"]);m!=null&&g(e,["defaultCheckpointId"],m);let h=p(n,["checkpoints"]);if(h!=null){let y=h;Array.isArray(y)&&(y=y.map(_=>_)),g(e,["checkpoints"],y)}return e}function AP(n){let e={},t=p(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);let i=p(n,["codeExecutionResult"]);i!=null&&g(e,["codeExecutionResult"],i);let r=p(n,["executableCode"]);r!=null&&g(e,["executableCode"],r);let o=p(n,["fileData"]);o!=null&&g(e,["fileData"],GF(o));let s=p(n,["functionCall"]);s!=null&&g(e,["functionCall"],qF(s));let u=p(n,["functionResponse"]);u!=null&&g(e,["functionResponse"],u);let d=p(n,["inlineData"]);d!=null&&g(e,["inlineData"],gF(d));let m=p(n,["text"]);m!=null&&g(e,["text"],m);let h=p(n,["thought"]);h!=null&&g(e,["thought"],h);let y=p(n,["thoughtSignature"]);y!=null&&g(e,["thoughtSignature"],y);let _=p(n,["videoMetadata"]);return _!=null&&g(e,["videoMetadata"],_),e}function NP(n){let e={},t=p(n,["productImage"]);return t!=null&&g(e,["image"],li(t)),e}function RP(n,e){let t={},i=p(n,["numberOfImages"]);e!==void 0&&i!=null&&g(e,["parameters","sampleCount"],i);let r=p(n,["baseSteps"]);e!==void 0&&r!=null&&g(e,["parameters","baseSteps"],r);let o=p(n,["outputGcsUri"]);e!==void 0&&o!=null&&g(e,["parameters","storageUri"],o);let s=p(n,["seed"]);e!==void 0&&s!=null&&g(e,["parameters","seed"],s);let u=p(n,["safetyFilterLevel"]);e!==void 0&&u!=null&&g(e,["parameters","safetySetting"],u);let d=p(n,["personGeneration"]);e!==void 0&&d!=null&&g(e,["parameters","personGeneration"],d);let m=p(n,["addWatermark"]);e!==void 0&&m!=null&&g(e,["parameters","addWatermark"],m);let h=p(n,["outputMimeType"]);e!==void 0&&h!=null&&g(e,["parameters","outputOptions","mimeType"],h);let y=p(n,["outputCompressionQuality"]);e!==void 0&&y!=null&&g(e,["parameters","outputOptions","compressionQuality"],y);let _=p(n,["enhancePrompt"]);e!==void 0&&_!=null&&g(e,["parameters","enhancePrompt"],_);let C=p(n,["labels"]);return e!==void 0&&C!=null&&g(e,["labels"],C),t}function FP(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],Ge(n,i));let r=p(e,["source"]);r!=null&&kP(r,t);let o=p(e,["config"]);return o!=null&&RP(o,t),t}function PP(n){let e={},t=p(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>zm(r))),g(e,["generatedImages"],i)}return e}function kP(n,e){let t={},i=p(n,["prompt"]);e!==void 0&&i!=null&&g(e,["instances[0]","prompt"],i);let r=p(n,["personImage"]);e!==void 0&&r!=null&&g(e,["instances[0]","personImage","image"],li(r));let o=p(n,["productImages"]);if(e!==void 0&&o!=null){let s=o;Array.isArray(s)&&(s=s.map(u=>NP(u))),g(e,["instances[0]","productImages"],s)}return t}function VP(n){let e={},t=p(n,["referenceImage"]);t!=null&&g(e,["referenceImage"],li(t));let i=p(n,["referenceId"]);i!=null&&g(e,["referenceId"],i);let r=p(n,["referenceType"]);r!=null&&g(e,["referenceType"],r);let o=p(n,["maskImageConfig"]);o!=null&&g(e,["maskImageConfig"],MP(o));let s=p(n,["controlImageConfig"]);s!=null&&g(e,["controlImageConfig"],EF(s));let u=p(n,["styleImageConfig"]);u!=null&&g(e,["styleImageConfig"],u);let d=p(n,["subjectImageConfig"]);return d!=null&&g(e,["subjectImageConfig"],d),e}function Eb(n){let e={},t=p(n,["safetyAttributes","categories"]);t!=null&&g(e,["categories"],t);let i=p(n,["safetyAttributes","scores"]);i!=null&&g(e,["scores"],i);let r=p(n,["contentType"]);return r!=null&&g(e,["contentType"],r),e}function bb(n){let e={},t=p(n,["safetyAttributes","categories"]);t!=null&&g(e,["categories"],t);let i=p(n,["safetyAttributes","scores"]);i!=null&&g(e,["scores"],i);let r=p(n,["contentType"]);return r!=null&&g(e,["contentType"],r),e}function OP(n){let e={},t=p(n,["category"]);if(t!=null&&g(e,["category"],t),p(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");let i=p(n,["threshold"]);return i!=null&&g(e,["threshold"],i),e}function LP(n){let e={},t=p(n,["image"]);return t!=null&&g(e,["image"],li(t)),e}function BP(n,e){let t={},i=p(n,["mode"]);e!==void 0&&i!=null&&g(e,["parameters","mode"],i);let r=p(n,["maxPredictions"]);e!==void 0&&r!=null&&g(e,["parameters","maxPredictions"],r);let o=p(n,["confidenceThreshold"]);e!==void 0&&o!=null&&g(e,["parameters","confidenceThreshold"],o);let s=p(n,["maskDilation"]);e!==void 0&&s!=null&&g(e,["parameters","maskDilation"],s);let u=p(n,["binaryColorThreshold"]);e!==void 0&&u!=null&&g(e,["parameters","binaryColorThreshold"],u);let d=p(n,["labels"]);return e!==void 0&&d!=null&&g(e,["labels"],d),t}function UP(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],Ge(n,i));let r=p(e,["source"]);r!=null&&HP(r,t);let o=p(e,["config"]);return o!=null&&BP(o,t),t}function $P(n){let e={},t=p(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>mP(r))),g(e,["generatedMasks"],i)}return e}function HP(n,e){let t={},i=p(n,["prompt"]);e!==void 0&&i!=null&&g(e,["instances[0]","prompt"],i);let r=p(n,["image"]);e!==void 0&&r!=null&&g(e,["instances[0]","image"],li(r));let o=p(n,["scribbleImage"]);return e!==void 0&&o!=null&&g(e,["instances[0]","scribble"],LP(o)),t}function GP(n){let e={},t=p(n,["retrievalConfig"]);t!=null&&g(e,["retrievalConfig"],t);let i=p(n,["functionCallingConfig"]);return i!=null&&g(e,["functionCallingConfig"],WF(i)),e}function qP(n){let e={};if(p(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");let t=p(n,["computerUse"]);t!=null&&g(e,["computerUse"],t);let i=p(n,["fileSearch"]);i!=null&&g(e,["fileSearch"],i);let r=p(n,["codeExecution"]);if(r!=null&&g(e,["codeExecution"],r),p(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");let o=p(n,["functionDeclarations"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(y=>y)),g(e,["functionDeclarations"],h)}let s=p(n,["googleMaps"]);s!=null&&g(e,["googleMaps"],_P(s));let u=p(n,["googleSearch"]);u!=null&&g(e,["googleSearch"],vP(u));let d=p(n,["googleSearchRetrieval"]);d!=null&&g(e,["googleSearchRetrieval"],d);let m=p(n,["urlContext"]);return m!=null&&g(e,["urlContext"],m),e}function Sb(n){let e={},t=p(n,["retrieval"]);t!=null&&g(e,["retrieval"],t);let i=p(n,["computerUse"]);if(i!=null&&g(e,["computerUse"],i),p(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");let r=p(n,["codeExecution"]);r!=null&&g(e,["codeExecution"],r);let o=p(n,["enterpriseWebSearch"]);o!=null&&g(e,["enterpriseWebSearch"],o);let s=p(n,["functionDeclarations"]);if(s!=null){let y=s;Array.isArray(y)&&(y=y.map(_=>jF(_))),g(e,["functionDeclarations"],y)}let u=p(n,["googleMaps"]);u!=null&&g(e,["googleMaps"],u);let d=p(n,["googleSearch"]);d!=null&&g(e,["googleSearch"],d);let m=p(n,["googleSearchRetrieval"]);m!=null&&g(e,["googleSearchRetrieval"],m);let h=p(n,["urlContext"]);return h!=null&&g(e,["urlContext"],h),e}function WP(n){let e={},t=p(n,["baseModel"]);t!=null&&g(e,["baseModel"],t);let i=p(n,["createTime"]);i!=null&&g(e,["createTime"],i);let r=p(n,["updateTime"]);return r!=null&&g(e,["updateTime"],r),e}function jP(n){let e={},t=p(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&g(e,["baseModel"],t);let i=p(n,["createTime"]);i!=null&&g(e,["createTime"],i);let r=p(n,["updateTime"]);return r!=null&&g(e,["updateTime"],r),e}function zP(n,e){let t={},i=p(n,["displayName"]);e!==void 0&&i!=null&&g(e,["displayName"],i);let r=p(n,["description"]);e!==void 0&&r!=null&&g(e,["description"],r);let o=p(n,["defaultCheckpointId"]);return e!==void 0&&o!=null&&g(e,["defaultCheckpointId"],o),t}function YP(n,e){let t={},i=p(n,["displayName"]);e!==void 0&&i!=null&&g(e,["displayName"],i);let r=p(n,["description"]);e!==void 0&&r!=null&&g(e,["description"],r);let o=p(n,["defaultCheckpointId"]);return e!==void 0&&o!=null&&g(e,["defaultCheckpointId"],o),t}function JP(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","name"],Ge(n,i));let r=p(e,["config"]);return r!=null&&zP(r,t),t}function KP(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],Ge(n,i));let r=p(e,["config"]);return r!=null&&YP(r,t),t}function QP(n,e){let t={},i=p(n,["outputGcsUri"]);e!==void 0&&i!=null&&g(e,["parameters","storageUri"],i);let r=p(n,["safetyFilterLevel"]);e!==void 0&&r!=null&&g(e,["parameters","safetySetting"],r);let o=p(n,["personGeneration"]);e!==void 0&&o!=null&&g(e,["parameters","personGeneration"],o);let s=p(n,["includeRaiReason"]);e!==void 0&&s!=null&&g(e,["parameters","includeRaiReason"],s);let u=p(n,["outputMimeType"]);e!==void 0&&u!=null&&g(e,["parameters","outputOptions","mimeType"],u);let d=p(n,["outputCompressionQuality"]);e!==void 0&&d!=null&&g(e,["parameters","outputOptions","compressionQuality"],d);let m=p(n,["enhanceInputImage"]);e!==void 0&&m!=null&&g(e,["parameters","upscaleConfig","enhanceInputImage"],m);let h=p(n,["imagePreservationFactor"]);e!==void 0&&h!=null&&g(e,["parameters","upscaleConfig","imagePreservationFactor"],h);let y=p(n,["labels"]);e!==void 0&&y!=null&&g(e,["labels"],y);let _=p(n,["numberOfImages"]);e!==void 0&&_!=null&&g(e,["parameters","sampleCount"],_);let C=p(n,["mode"]);return e!==void 0&&C!=null&&g(e,["parameters","mode"],C),t}function ZP(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["_url","model"],Ge(n,i));let r=p(e,["image"]);r!=null&&g(t,["instances[0]","image"],li(r));let o=p(e,["upscaleFactor"]);o!=null&&g(t,["parameters","upscaleConfig","upscaleFactor"],o);let s=p(e,["config"]);return s!=null&&QP(s,t),t}function XP(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>zm(o))),g(e,["generatedImages"],r)}return e}function ek(n){let e={},t=p(n,["uri"]);t!=null&&g(e,["uri"],t);let i=p(n,["encodedVideo"]);i!=null&&g(e,["videoBytes"],Er(i));let r=p(n,["encoding"]);return r!=null&&g(e,["mimeType"],r),e}function tk(n){let e={},t=p(n,["gcsUri"]);t!=null&&g(e,["uri"],t);let i=p(n,["bytesBase64Encoded"]);i!=null&&g(e,["videoBytes"],Er(i));let r=p(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function nk(n){let e={},t=p(n,["image"]);t!=null&&g(e,["_self"],li(t));let i=p(n,["maskMode"]);return i!=null&&g(e,["maskMode"],i),e}function ik(n){let e={},t=p(n,["image"]);t!=null&&g(e,["image"],Ym(t));let i=p(n,["referenceType"]);return i!=null&&g(e,["referenceType"],i),e}function rk(n){let e={},t=p(n,["image"]);t!=null&&g(e,["image"],li(t));let i=p(n,["referenceType"]);return i!=null&&g(e,["referenceType"],i),e}function Db(n){let e={},t=p(n,["uri"]);t!=null&&g(e,["uri"],t);let i=p(n,["videoBytes"]);i!=null&&g(e,["encodedVideo"],Er(i));let r=p(n,["mimeType"]);return r!=null&&g(e,["encoding"],r),e}function wb(n){let e={},t=p(n,["uri"]);t!=null&&g(e,["gcsUri"],t);let i=p(n,["videoBytes"]);i!=null&&g(e,["bytesBase64Encoded"],Er(i));let r=p(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function ok(n,e){let t={},i=p(n,["displayName"]);return e!==void 0&&i!=null&&g(e,["displayName"],i),t}function sk(n){let e={},t=p(n,["config"]);return t!=null&&ok(t,e),e}function ak(n,e){let t={},i=p(n,["force"]);return e!==void 0&&i!=null&&g(e,["_query","force"],i),t}function lk(n){let e={},t=p(n,["name"]);t!=null&&g(e,["_url","name"],t);let i=p(n,["config"]);return i!=null&&ak(i,e),e}function uk(n){let e={},t=p(n,["name"]);return t!=null&&g(e,["_url","name"],t),e}function dk(n,e){let t={},i=p(n,["customMetadata"]);if(e!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>s)),g(e,["customMetadata"],o)}let r=p(n,["chunkingConfig"]);return e!==void 0&&r!=null&&g(e,["chunkingConfig"],r),t}function ck(n){let e={},t=p(n,["name"]);t!=null&&g(e,["name"],t);let i=p(n,["metadata"]);i!=null&&g(e,["metadata"],i);let r=p(n,["done"]);r!=null&&g(e,["done"],r);let o=p(n,["error"]);o!=null&&g(e,["error"],o);let s=p(n,["response"]);return s!=null&&g(e,["response"],pk(s)),e}function mk(n){let e={},t=p(n,["fileSearchStoreName"]);t!=null&&g(e,["_url","file_search_store_name"],t);let i=p(n,["fileName"]);i!=null&&g(e,["fileName"],i);let r=p(n,["config"]);return r!=null&&dk(r,e),e}function pk(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["parent"]);i!=null&&g(e,["parent"],i);let r=p(n,["documentName"]);return r!=null&&g(e,["documentName"],r),e}function fk(n,e){let t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);let r=p(n,["pageToken"]);return e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),t}function gk(n){let e={},t=p(n,["config"]);return t!=null&&fk(t,e),e}function hk(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);let r=p(n,["fileSearchStores"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>s)),g(e,["fileSearchStores"],o)}return e}function Tb(n,e){let t={},i=p(n,["mimeType"]);e!==void 0&&i!=null&&g(e,["mimeType"],i);let r=p(n,["displayName"]);e!==void 0&&r!=null&&g(e,["displayName"],r);let o=p(n,["customMetadata"]);if(e!==void 0&&o!=null){let u=o;Array.isArray(u)&&(u=u.map(d=>d)),g(e,["customMetadata"],u)}let s=p(n,["chunkingConfig"]);return e!==void 0&&s!=null&&g(e,["chunkingConfig"],s),t}function yk(n){let e={},t=p(n,["fileSearchStoreName"]);t!=null&&g(e,["_url","file_search_store_name"],t);let i=p(n,["config"]);return i!=null&&Tb(i,e),e}function _k(n){let e={},t=p(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}var vk="Content-Type",Ck="X-Server-Timeout",xk="User-Agent",xy="x-goog-api-client",Ek="1.38.0",bk=`google-genai-sdk/${Ek}`,Sk="v1beta1",Dk="v1beta",Ey=class{constructor(e){var t,i,r;this.clientOptions=Object.assign({},e),this.customBaseUrl=(t=e.httpOptions)===null||t===void 0?void 0:t.baseUrl,this.clientOptions.vertexai&&(this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:this.clientOptions.apiKey&&(this.clientOptions.project=void 0,this.clientOptions.location=void 0));let o={};if(this.clientOptions.vertexai){if(!this.clientOptions.location&&!this.clientOptions.apiKey&&!this.customBaseUrl&&(this.clientOptions.location="global"),!(this.clientOptions.project&&this.clientOptions.location||this.clientOptions.apiKey)&&!this.customBaseUrl)throw new Error("Authentication is not set up. Please provide either a project and location, or an API key, or a custom base URL.");let u=e.project&&e.location||!!e.apiKey;this.customBaseUrl&&!u?(o.baseUrl=this.customBaseUrl,this.clientOptions.project=void 0,this.clientOptions.location=void 0):this.clientOptions.apiKey||this.clientOptions.location==="global"?o.baseUrl="https://aiplatform.googleapis.com/":this.clientOptions.project&&this.clientOptions.location&&(o.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`),o.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:Sk}else{if(!this.clientOptions.apiKey)throw new Yl({message:"API key must be set when using the Gemini API.",status:403});o.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:Dk,o.baseUrl="https://generativelanguage.googleapis.com/"}o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,e.httpOptions))}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getCustomBaseUrl(){return this.customBaseUrl}async getAuthHeaders(){let e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");let i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){let e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){let r=[this.getRequestUrlInternal(t)];return i&&r.push(this.getBaseResourcePath()),e!==""&&r.push(e),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(e,t){return!(t.baseUrl&&t.baseUrlResourceScope===sb.COLLECTION||this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let i=this.shouldPrependVertexProjectPath(e,t),r=this.constructUrl(e.path,t,i);if(e.queryParams)for(let[s,u]of Object.entries(e.queryParams))r.searchParams.append(s,String(u));let o={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=e.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,t,r.toString(),e.abortSignal),this.unaryApiCall(r,o,e.httpMethod)}patchHttpOptions(e,t){let i=JSON.parse(JSON.stringify(e));for(let[r,o]of Object.entries(t))typeof o=="object"?i[r]=Object.assign(Object.assign({},i[r]),o):o!==void 0&&(i[r]=o);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let i=this.shouldPrependVertexProjectPath(e,t),r=this.constructUrl(e.path,t,i);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let o={};return o.body=e.body,o=await this.includeExtraHttpOptionsToRequestInit(o,t,r.toString(),e.abortSignal),this.streamApiCall(r,o,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i,r){if(t&&t.timeout||r){let o=new AbortController,s=o.signal;if(t.timeout&&t?.timeout>0){let u=setTimeout(()=>o.abort(),t.timeout);u&&typeof u.unref=="function"&&u.unref()}r&&r.addEventListener("abort",()=>{o.abort()}),e.signal=s}return t&&t.extraBody!==null&&wk(e,t.extraBody),e.headers=await this.getHeadersInternal(t,i),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await q2(r),new zl(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await q2(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(e){return oi(this,arguments,function*(){var i;let r=(i=e?.body)===null||i===void 0?void 0:i.getReader(),o=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let s="",u="data:",d=[`

`,"\r\r",`\r
\r
`];for(;;){let{done:m,value:h}=yield _e(r.read());if(m){if(s.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}let y=o.decode(h,{stream:!0});try{let D=JSON.parse(y);if("error"in D){let I=JSON.parse(JSON.stringify(D.error)),R=I.status,F=I.code,$=`got status: ${R}. ${JSON.stringify(D)}`;if(F>=400&&F<600)throw new Yl({message:$,status:F})}}catch(D){if(D.name==="ApiError")throw D}s+=y;let _=-1,C=0;for(;;){_=-1,C=0;for(let R of d){let F=s.indexOf(R);F!==-1&&(_===-1||F<_)&&(_=F,C=R.length)}if(_===-1)break;let D=s.substring(0,_);s=s.substring(_+C);let I=D.trim();if(I.startsWith(u)){let R=I.substring(u.length).trim();try{let F=new Response(R,{headers:e?.headers,status:e?.status,statusText:e?.statusText});yield yield _e(new zl(F))}catch(F){throw new Error(`exception parsing stream chunk ${R}. ${F}`)}}}}}finally{r.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){let e={},t=bk+" "+this.clientOptions.userAgentExtra;return e[xk]=t,e[xy]=t,e[vk]="application/json",e}async getHeadersInternal(e,t){let i=new Headers;if(e&&e.headers){for(let[r,o]of Object.entries(e.headers))i.append(r,o);e.timeout&&e.timeout>0&&i.append(Ck,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(i,t),i}getFileName(e){var t;let i="";return typeof e=="string"&&(i=e.replace(/[/\\]+$/,""),i=(t=i.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),i}async uploadFile(e,t){var i;let r={};t!=null&&(r.mimeType=t.mimeType,r.name=t.name,r.displayName=t.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);let o=this.clientOptions.uploader,s=await o.stat(e);r.sizeBytes=String(s.size);let u=(i=t?.mimeType)!==null&&i!==void 0?i:s.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=u;let d={file:r},m=this.getFileName(e),h=X("upload/v1beta/files",d._url),y=await this.fetchUploadUrl(h,r.sizeBytes,r.mimeType,m,d,t?.httpOptions);return o.upload(e,y,this)}async uploadFileToFileSearchStore(e,t,i){var r;let o=this.clientOptions.uploader,s=await o.stat(t),u=String(s.size),d=(r=i?.mimeType)!==null&&r!==void 0?r:s.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");let m=`upload/v1beta/${e}:uploadToFileSearchStore`,h=this.getFileName(t),y={};i!=null&&Tb(i,y);let _=await this.fetchUploadUrl(m,u,d,h,y,i?.httpOptions);return o.uploadToFileSearchStore(t,_,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,i,r,o,s){var u;let d={};s?d=s:d={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${i}`},r?{"X-Goog-Upload-File-Name":r}:{})};let m=await this.request({path:e,body:JSON.stringify(o),httpMethod:"POST",httpOptions:d});if(!m||!m?.headers)throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");let h=(u=m?.headers)===null||u===void 0?void 0:u["x-goog-upload-url"];if(h===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return h}};async function q2(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){let t=n.status,i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};let r=JSON.stringify(i);throw t>=400&&t<600?new Yl({message:r,status:t}):new Error(r)}}function wk(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{let o=JSON.parse(n.body);if(typeof o=="object"&&o!==null&&!Array.isArray(o))t=o;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(o,s){let u=Object.assign({},o);for(let d in s)if(Object.prototype.hasOwnProperty.call(s,d)){let m=s[d],h=u[d];m&&typeof m=="object"&&!Array.isArray(m)&&h&&typeof h=="object"&&!Array.isArray(h)?u[d]=i(h,m):(h&&m&&typeof h!=typeof m&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${d}". Original type: ${typeof h}, New type: ${typeof m}. Overwriting.`),u[d]=m)}return u}let r=i(t,e);n.body=JSON.stringify(r)}var Tk="mcp_used/unknown",Ik=!1;function Ib(n){for(let e of n)if(Mk(e)||typeof e=="object"&&"inputSchema"in e)return!0;return Ik}function Mb(n){var e;let t=(e=n[xy])!==null&&e!==void 0?e:"";n[xy]=(t+` ${Tk}`).trimStart()}function Mk(n){return n!==null&&typeof n=="object"&&n instanceof by}function Ak(n){return oi(this,arguments,function*(t,i=100){let r,o=0;for(;o<i;){let s=yield _e(t.listTools({cursor:r}));for(let u of s.tools)yield yield _e(u),o++;if(!s.nextCursor)break;r=s.nextCursor}})}var by=class n{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new n(e,t)}async initialize(){var e,t,i,r;if(this.mcpTools.length>0)return;let o={},s=[];for(let h of this.mcpClients)try{for(var u=!0,d=(t=void 0,si(Ak(h))),m;m=await d.next(),e=m.done,!e;u=!0){r=m.value,u=!1;let y=r;s.push(y);let _=y.name;if(o[_])throw new Error(`Duplicate function name ${_} found in MCP tools. Please ensure function names are unique.`);o[_]=h}}catch(y){t={error:y}}finally{try{!u&&!e&&(i=d.return)&&await i.call(d)}finally{if(t)throw t.error}}this.mcpTools=s,this.functionNameToMcpClient=o}async tool(){return await this.initialize(),p3(this.mcpTools,this.config)}async callTool(e){await this.initialize();let t=[];for(let i of e)if(i.name in this.functionNameToMcpClient){let r=this.functionNameToMcpClient[i.name],o;this.config.timeout&&(o={timeout:this.config.timeout});let s=await r.callTool({name:i.name,arguments:i.args},void 0,o);t.push({functionResponse:{name:i.name,response:s.isError?{error:s}:s}})}return t}};async function Nk(n,e,t){let i=new dy,r;t.data instanceof Blob?r=JSON.parse(await t.data.text()):r=JSON.parse(t.data),Object.assign(i,r),e(i)}var Sy=class{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");let r=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),s=Fk(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),d=`${r}/ws/google.ai.generativelanguage.${o}.GenerativeService.BidiGenerateMusic?key=${u}`,m=()=>{},h=new Promise(G=>{m=G}),y=e.callbacks,_=function(){m({})},C=this.apiClient,D={onopen:_,onmessage:G=>{Nk(C,y.onmessage,G)},onerror:(t=y?.onerror)!==null&&t!==void 0?t:function(G){},onclose:(i=y?.onclose)!==null&&i!==void 0?i:function(G){}},I=this.webSocketFactory.create(d,Rk(s),D);I.connect(),await h;let $={setup:{model:Ge(this.apiClient,e.model)}};return I.send(JSON.stringify($)),new Dy(I,this.apiClient)}},Dy=class{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");let t=oF(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});let t=rF(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){let t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Wl.PLAY)}pause(){this.sendPlaybackControl(Wl.PAUSE)}stop(){this.sendPlaybackControl(Wl.STOP)}resetContext(){this.sendPlaybackControl(Wl.RESET_CONTEXT)}close(){this.conn.close()}};function Rk(n){let e={};return n.forEach((t,i)=>{e[i]=t}),e}function Fk(n){let e=new Headers;for(let[t,i]of Object.entries(n))e.append(t,i);return e}var Pk="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function kk(n,e,t){let i=new uy,r;t.data instanceof Blob?r=await t.data.text():t.data instanceof ArrayBuffer?r=new TextDecoder().decode(t.data):r=t.data;let o=JSON.parse(r);if(n.isVertexAI()){let s=lF(o);Object.assign(i,s)}else Object.assign(i,o);e(i)}var wy=class{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new Sy(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,r,o,s,u;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");let d=this.apiClient.getWebsocketBaseUrl(),m=this.apiClient.getApiVersion(),h,y=this.apiClient.getHeaders();e.config&&e.config.tools&&Ib(e.config.tools)&&Mb(y);let _=Lk(y);if(this.apiClient.isVertexAI()){let pe=this.apiClient.getProject(),we=this.apiClient.getLocation(),_t=this.apiClient.getApiKey(),ui=!!pe&&!!we||!!_t;this.apiClient.getCustomBaseUrl()&&!ui?h=d:(h=`${d}/ws/google.cloud.aiplatform.${m}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(_,h))}else{let pe=this.apiClient.getApiKey(),we="BidiGenerateContent",_t="key";pe?.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),m!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),we="BidiGenerateContentConstrained",_t="access_token"),h=`${d}/ws/google.ai.generativelanguage.${m}.GenerativeService.${we}?${_t}=${pe}`}let C=()=>{},D=new Promise(pe=>{C=pe}),I=e.callbacks,R=function(){var pe;(pe=I?.onopen)===null||pe===void 0||pe.call(I),C({})},F=this.apiClient,$={onopen:R,onmessage:pe=>{kk(F,I.onmessage,pe)},onerror:(t=I?.onerror)!==null&&t!==void 0?t:function(pe){},onclose:(i=I?.onclose)!==null&&i!==void 0?i:function(pe){}},G=this.webSocketFactory.create(h,Ok(_),$);G.connect(),await D;let Y=Ge(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&Y.startsWith("publishers/")){let pe=this.apiClient.getProject(),we=this.apiClient.getLocation();pe&&we&&(Y=`projects/${pe}/locations/${we}/`+Y)}let ne={};this.apiClient.isVertexAI()&&((r=e.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Kh.AUDIO]}:e.config.responseModalities=[Kh.AUDIO]),!((o=e.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");let de=(u=(s=e.config)===null||s===void 0?void 0:s.tools)!==null&&u!==void 0?u:[],le=[];for(let pe of de)if(this.isCallableTool(pe)){let we=pe;le.push(await we.tool())}else le.push(pe);le.length>0&&(e.config.tools=le);let Ue={model:Y,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?ne=iF(this.apiClient,Ue):ne=nF(this.apiClient,Ue),delete ne.config,G.send(JSON.stringify(ne)),new Ty(G,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}},Vk={turnComplete:!0},Ty=class{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=Gn(t.turns),e.isVertexAI()||(i=i.map(r=>jm(r)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(let o of i){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!e.isVertexAI()&&!("id"in o))throw new Error(Pk)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},Vk),e);let t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:aF(e)}:t={realtimeInput:sF(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");let t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}};function Ok(n){let e={};return n.forEach((t,i)=>{e[i]=t}),e}function Lk(n){let e=new Headers;for(let[t,i]of Object.entries(n))e.append(t,i);return e}var W2=10;function j2(n){var e,t,i;if(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let r=!1;for(let s of(t=n?.tools)!==null&&t!==void 0?t:[])if(As(s)){r=!0;break}if(!r)return!0;let o=(i=n?.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return o&&(o<0||!Number.isInteger(o))||o==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",o),!0):!1}function As(n){return"callTool"in n&&typeof n.callTool=="function"}function Bk(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(r=>As(r)))!==null&&i!==void 0?i:!1}function z2(n){var e;let t=[];return!((e=n?.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((i,r)=>{if(As(i))return;let o=i;o.functionDeclarations&&o.functionDeclarations.length>0&&t.push(r)}),t}function Y2(n){var e;return!(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}var Iy=class extends ai{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,r,o,s,u;let d=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!Bk(t)||j2(t.config))return await this.generateContentInternal(d);let m=z2(t);if(m.length>0){let I=m.map(R=>`tools[${R}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${I}.`)}let h,y,_=Gn(d.contents),C=(o=(r=(i=d.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&o!==void 0?o:W2,D=0;for(;D<C&&(h=await this.generateContentInternal(d),!(!h.functionCalls||h.functionCalls.length===0));){let I=h.candidates[0].content,R=[];for(let F of(u=(s=t.config)===null||s===void 0?void 0:s.tools)!==null&&u!==void 0?u:[])if(As(F)){let G=await F.callTool(h.functionCalls);R.push(...G)}D++,y={role:"user",parts:R},d.contents=Gn(d.contents),d.contents.push(I),d.contents.push(y),Y2(d.config)&&(_.push(I),_.push(y))}return Y2(d.config)&&(h.automaticFunctionCallingHistory=_),h},this.generateContentStream=async t=>{var i,r,o,s,u;if(this.maybeMoveToResponseJsonSchem(t),j2(t.config)){let y=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(y)}let d=z2(t);if(d.length>0){let y=d.map(_=>`tools[${_}]`).join(", ");throw new Error(`Incompatible tools found at ${y}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}let m=(o=(r=(i=t?.config)===null||i===void 0?void 0:i.toolConfig)===null||r===void 0?void 0:r.functionCallingConfig)===null||o===void 0?void 0:o.streamFunctionCallArguments,h=(u=(s=t?.config)===null||s===void 0?void 0:s.automaticFunctionCalling)===null||u===void 0?void 0:u.disable;if(m&&!h)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var r;let o,s=[];if(i?.generatedImages)for(let d of i.generatedImages)d&&d?.safetyAttributes&&((r=d?.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?o=d?.safetyAttributes:s.push(d);let u;return o?u={generatedImages:s,positivePromptSafetyAttributes:o,sdkHttpResponse:i.sdkHttpResponse}:u={generatedImages:s,sdkHttpResponse:i.sdkHttpResponse},u}),this.list=async t=>{var i;let s={config:Object.assign(Object.assign({},{queryBase:!0}),t?.config)};if(this.apiClient.isVertexAI()&&!s.config.queryBase){if(!((i=s.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");s.config.filter="labels.tune-type:*"}return new Ki(br.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(s),s)},this.editImage=async t=>{let i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(r=>r.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));let r={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(r)},this.generateVideos=async t=>{var i,r,o,s,u,d;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((i=t.video)===null||i===void 0)&&i.uri&&(!((r=t.video)===null||r===void 0)&&r.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((s=(o=t.source)===null||o===void 0?void 0:o.video)===null||s===void 0)&&s.uri&&(!((d=(u=t.source)===null||u===void 0?void 0:u.video)===null||d===void 0)&&d.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,r;let o=(t=e.config)===null||t===void 0?void 0:t.tools;if(!o)return e;let s=await Promise.all(o.map(async d=>As(d)?await d.tool():d)),u={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:s})};if(u.config.tools=s,e.config&&e.config.tools&&Ib(e.config.tools)){let d=(r=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&r!==void 0?r:{},m=Object.assign({},d);Object.keys(m).length===0&&(m=this.apiClient.getDefaultHeaders()),Mb(m),u.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:m})}return u}async initAfcToolsMap(e){var t,i,r;let o=new Map;for(let s of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(As(s)){let u=s,d=await u.tool();for(let m of(r=d.functionDeclarations)!==null&&r!==void 0?r:[]){if(!m.name)throw new Error("Function declaration name is required.");if(o.has(m.name))throw new Error(`Duplicate tool declaration name: ${m.name}`);o.set(m.name,u)}}return o}async processAfcStream(e){var t,i,r;let o=(r=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&r!==void 0?r:W2,s=!1,u=0,d=await this.initAfcToolsMap(e);return(function(m,h,y){return oi(this,arguments,function*(){for(var _,C,D,I,R,F;u<o;){s&&(u++,s=!1);let ne=yield _e(m.processParamsMaybeAddMcpUsage(y)),de=yield _e(m.generateContentStreamInternal(ne)),le=[],Ue=[];try{for(var $=!0,G=(C=void 0,si(de)),Y;Y=yield _e(G.next()),_=Y.done,!_;$=!0){I=Y.value,$=!1;let pe=I;if(yield yield _e(pe),pe.candidates&&(!((R=pe.candidates[0])===null||R===void 0)&&R.content)){Ue.push(pe.candidates[0].content);for(let we of(F=pe.candidates[0].content.parts)!==null&&F!==void 0?F:[])if(u<o&&we.functionCall){if(!we.functionCall.name)throw new Error("Function call name was not returned by the model.");if(h.has(we.functionCall.name)){let _t=yield _e(h.get(we.functionCall.name).callTool([we.functionCall]));le.push(..._t)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${h.keys()}, mising tool: ${we.functionCall.name}`)}}}}catch(pe){C={error:pe}}finally{try{!$&&!_&&(D=G.return)&&(yield _e(D.call(G)))}finally{if(C)throw C.error}}if(le.length>0){s=!0;let pe=new fo;pe.candidates=[{content:{role:"user",parts:le}}],yield yield _e(pe);let we=[];we.push(...Ue),we.push({role:"user",parts:le});let _t=Gn(y.contents).concat(we);y.contents=_t}else break}})})(this,d,e)}async generateContentInternal(e){var t,i,r,o;let s,u="",d={};if(this.apiClient.isVertexAI()){let m=$2(this.apiClient,e);return u=X("{model}:generateContent",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{let y=G2(h),_=new fo;return Object.assign(_,y),_})}else{let m=U2(this.apiClient,e);return u=X("{model}:generateContent",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{let y=H2(h),_=new fo;return Object.assign(_,y),_})}}async generateContentStreamInternal(e){var t,i,r,o;let s,u="",d={};if(this.apiClient.isVertexAI()){let m=$2(this.apiClient,e);return u=X("{model}:streamGenerateContent?alt=sse",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.requestStream({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),s.then(function(y){return oi(this,arguments,function*(){var _,C,D,I;try{for(var R=!0,F=si(y),$;$=yield _e(F.next()),_=$.done,!_;R=!0){I=$.value,R=!1;let G=I,Y=G2(yield _e(G.json()));Y.sdkHttpResponse={headers:G.headers};let ne=new fo;Object.assign(ne,Y),yield yield _e(ne)}}catch(G){C={error:G}}finally{try{!R&&!_&&(D=F.return)&&(yield _e(D.call(F)))}finally{if(C)throw C.error}}})})}else{let m=U2(this.apiClient,e);return u=X("{model}:streamGenerateContent?alt=sse",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.requestStream({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),s.then(function(y){return oi(this,arguments,function*(){var _,C,D,I;try{for(var R=!0,F=si(y),$;$=yield _e(F.next()),_=$.done,!_;R=!0){I=$.value,R=!1;let G=I,Y=H2(yield _e(G.json()));Y.sdkHttpResponse={headers:G.headers};let ne=new fo;Object.assign(ne,Y),yield yield _e(ne)}}catch(G){C={error:G}}finally{try{!R&&!_&&(D=F.return)&&(yield _e(D.call(F)))}finally{if(C)throw C.error}}})})}}async embedContent(e){var t,i,r,o;let s,u="",d={};if(this.apiClient.isVertexAI()){let m=BF(this.apiClient,e);return u=X("{model}:predict",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{let y=$F(h),_=new vm;return Object.assign(_,y),_})}else{let m=LF(this.apiClient,e);return u=X("{model}:batchEmbedContents",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{let y=UF(h),_=new vm;return Object.assign(_,y),_})}}async generateImagesInternal(e){var t,i,r,o;let s,u="",d={};if(this.apiClient.isVertexAI()){let m=ZF(this.apiClient,e);return u=X("{model}:predict",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{let y=eP(h),_=new Cm;return Object.assign(_,y),_})}else{let m=QF(this.apiClient,e);return u=X("{model}:predict",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{let y=XF(h),_=new Cm;return Object.assign(_,y),_})}}async editImageInternal(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI()){let u=PF(this.apiClient,e);return o=X("{model}:predict",u._url),s=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(m=>{let h=m;return h.sdkHttpResponse={headers:d.headers},h})),r.then(d=>{let m=kF(d),h=new Qh;return Object.assign(h,m),h})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI()){let u=ZP(this.apiClient,e);return o=X("{model}:predict",u._url),s=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(m=>{let h=m;return h.sdkHttpResponse={headers:d.headers},h})),r.then(d=>{let m=XP(d),h=new Zh;return Object.assign(h,m),h})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI()){let u=FP(this.apiClient,e);return o=X("{model}:predict",u._url),s=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>{let m=PP(d),h=new Xh;return Object.assign(h,m),h})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI()){let u=UP(this.apiClient,e);return o=X("{model}:predict",u._url),s=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>{let m=$P(d),h=new ey;return Object.assign(h,m),h})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,r,o;let s,u="",d={};if(this.apiClient.isVertexAI()){let m=yP(this.apiClient,e);return u=X("{name}",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>Cy(h))}else{let m=hP(this.apiClient,e);return u=X("{name}",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>vy(h))}}async listInternal(e){var t,i,r,o;let s,u="",d={};if(this.apiClient.isVertexAI()){let m=wP(this.apiClient,e);return u=X("{models_url}",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{let y=IP(h),_=new xm;return Object.assign(_,y),_})}else{let m=DP(this.apiClient,e);return u=X("{models_url}",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{let y=TP(h),_=new xm;return Object.assign(_,y),_})}}async update(e){var t,i,r,o;let s,u="",d={};if(this.apiClient.isVertexAI()){let m=KP(this.apiClient,e);return u=X("{model}",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>Cy(h))}else{let m=JP(this.apiClient,e);return u=X("{name}",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>vy(h))}}async delete(e){var t,i,r,o;let s,u="",d={};if(this.apiClient.isVertexAI()){let m=AF(this.apiClient,e);return u=X("{name}",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{let y=RF(h),_=new Em;return Object.assign(_,y),_})}else{let m=MF(this.apiClient,e);return u=X("{name}",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{let y=NF(h),_=new Em;return Object.assign(_,y),_})}}async countTokens(e){var t,i,r,o;let s,u="",d={};if(this.apiClient.isVertexAI()){let m=wF(this.apiClient,e);return u=X("{model}:countTokens",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{let y=IF(h),_=new bm;return Object.assign(_,y),_})}else{let m=DF(this.apiClient,e);return u=X("{model}:countTokens",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{let y=TF(h),_=new bm;return Object.assign(_,y),_})}}async computeTokens(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI()){let u=_F(this.apiClient,e);return o=X("{model}:computeTokens",u._url),s=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(m=>{let h=m;return h.sdkHttpResponse={headers:d.headers},h})),r.then(d=>{let m=vF(d),h=new ty;return Object.assign(h,m),h})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,r,o;let s,u="",d={};if(this.apiClient.isVertexAI()){let m=sP(this.apiClient,e);return u=X("{model}:predictLongRunning",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>{let y=rP(h),_=new Sm;return Object.assign(_,y),_})}else{let m=oP(this.apiClient,e);return u=X("{model}:predictLongRunning",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>{let y=iP(h),_=new Sm;return Object.assign(_,y),_})}}};var My=class extends ai{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){let t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){let r=t.name.split("/operations/")[0],o;i&&"httpOptions"in i&&(o=i.httpOptions);let s=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!0})}else{let r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async get(e){let t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){let r=t.name.split("/operations/")[0],o;i&&"httpOptions"in i&&(o=i.httpOptions);let s=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!0})}else{let r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,r,o;let s,u="",d={};if(this.apiClient.isVertexAI()){let m=e3(e);return u=X("{operationName}",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s}else{let m=X6(e);return u=X("{operationName}",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s}}async fetchPredictVideosOperationInternal(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI()){let u=j6(e);return o=X("{resourceName}:fetchPredictOperation",u._url),s=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r}else throw new Error("This method is only supported by the Vertex AI.")}};function Uk(n){let e={},t=p(n,["data"]);if(t!=null&&g(e,["data"],t),p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function $k(n){let e={},t=p(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>Kk(o))),g(e,["parts"],r)}let i=p(n,["role"]);return i!=null&&g(e,["role"],i),e}function Hk(n,e,t){let i={},r=p(e,["expireTime"]);t!==void 0&&r!=null&&g(t,["expireTime"],r);let o=p(e,["newSessionExpireTime"]);t!==void 0&&o!=null&&g(t,["newSessionExpireTime"],o);let s=p(e,["uses"]);t!==void 0&&s!=null&&g(t,["uses"],s);let u=p(e,["liveConnectConstraints"]);t!==void 0&&u!=null&&g(t,["bidiGenerateContentSetup"],Jk(n,u));let d=p(e,["lockAdditionalFields"]);return t!==void 0&&d!=null&&g(t,["fieldMask"],d),i}function Gk(n,e){let t={},i=p(e,["config"]);return i!=null&&g(t,["config"],Hk(n,i,t)),t}function qk(n){let e={};if(p(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");let t=p(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);let i=p(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function Wk(n){let e={},t=p(n,["id"]);t!=null&&g(e,["id"],t);let i=p(n,["args"]);i!=null&&g(e,["args"],i);let r=p(n,["name"]);if(r!=null&&g(e,["name"],r),p(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function jk(n){let e={};if(p(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");let t=p(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function zk(n){let e={};if(p(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");let t=p(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function Yk(n,e){let t={},i=p(n,["generationConfig"]);e!==void 0&&i!=null&&g(e,["setup","generationConfig"],i);let r=p(n,["responseModalities"]);e!==void 0&&r!=null&&g(e,["setup","generationConfig","responseModalities"],r);let o=p(n,["temperature"]);e!==void 0&&o!=null&&g(e,["setup","generationConfig","temperature"],o);let s=p(n,["topP"]);e!==void 0&&s!=null&&g(e,["setup","generationConfig","topP"],s);let u=p(n,["topK"]);e!==void 0&&u!=null&&g(e,["setup","generationConfig","topK"],u);let d=p(n,["maxOutputTokens"]);e!==void 0&&d!=null&&g(e,["setup","generationConfig","maxOutputTokens"],d);let m=p(n,["mediaResolution"]);e!==void 0&&m!=null&&g(e,["setup","generationConfig","mediaResolution"],m);let h=p(n,["seed"]);e!==void 0&&h!=null&&g(e,["setup","generationConfig","seed"],h);let y=p(n,["speechConfig"]);e!==void 0&&y!=null&&g(e,["setup","generationConfig","speechConfig"],Qy(y));let _=p(n,["thinkingConfig"]);e!==void 0&&_!=null&&g(e,["setup","generationConfig","thinkingConfig"],_);let C=p(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],C);let D=p(n,["systemInstruction"]);e!==void 0&&D!=null&&g(e,["setup","systemInstruction"],$k(Zt(D)));let I=p(n,["tools"]);if(e!==void 0&&I!=null){let de=Ps(I);Array.isArray(de)&&(de=de.map(le=>Zk(Fs(le)))),g(e,["setup","tools"],de)}let R=p(n,["sessionResumption"]);e!==void 0&&R!=null&&g(e,["setup","sessionResumption"],Qk(R));let F=p(n,["inputAudioTranscription"]);e!==void 0&&F!=null&&g(e,["setup","inputAudioTranscription"],F);let $=p(n,["outputAudioTranscription"]);e!==void 0&&$!=null&&g(e,["setup","outputAudioTranscription"],$);let G=p(n,["realtimeInputConfig"]);e!==void 0&&G!=null&&g(e,["setup","realtimeInputConfig"],G);let Y=p(n,["contextWindowCompression"]);e!==void 0&&Y!=null&&g(e,["setup","contextWindowCompression"],Y);let ne=p(n,["proactivity"]);if(e!==void 0&&ne!=null&&g(e,["setup","proactivity"],ne),p(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function Jk(n,e){let t={},i=p(e,["model"]);i!=null&&g(t,["setup","model"],Ge(n,i));let r=p(e,["config"]);return r!=null&&g(t,["config"],Yk(r,t)),t}function Kk(n){let e={},t=p(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);let i=p(n,["codeExecutionResult"]);i!=null&&g(e,["codeExecutionResult"],i);let r=p(n,["executableCode"]);r!=null&&g(e,["executableCode"],r);let o=p(n,["fileData"]);o!=null&&g(e,["fileData"],qk(o));let s=p(n,["functionCall"]);s!=null&&g(e,["functionCall"],Wk(s));let u=p(n,["functionResponse"]);u!=null&&g(e,["functionResponse"],u);let d=p(n,["inlineData"]);d!=null&&g(e,["inlineData"],Uk(d));let m=p(n,["text"]);m!=null&&g(e,["text"],m);let h=p(n,["thought"]);h!=null&&g(e,["thought"],h);let y=p(n,["thoughtSignature"]);y!=null&&g(e,["thoughtSignature"],y);let _=p(n,["videoMetadata"]);return _!=null&&g(e,["videoMetadata"],_),e}function Qk(n){let e={},t=p(n,["handle"]);if(t!=null&&g(e,["handle"],t),p(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Zk(n){let e={};if(p(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");let t=p(n,["computerUse"]);t!=null&&g(e,["computerUse"],t);let i=p(n,["fileSearch"]);i!=null&&g(e,["fileSearch"],i);let r=p(n,["codeExecution"]);if(r!=null&&g(e,["codeExecution"],r),p(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");let o=p(n,["functionDeclarations"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(y=>y)),g(e,["functionDeclarations"],h)}let s=p(n,["googleMaps"]);s!=null&&g(e,["googleMaps"],jk(s));let u=p(n,["googleSearch"]);u!=null&&g(e,["googleSearch"],zk(u));let d=p(n,["googleSearchRetrieval"]);d!=null&&g(e,["googleSearchRetrieval"],d);let m=p(n,["urlContext"]);return m!=null&&g(e,["urlContext"],m),e}function Xk(n){let e=[];for(let t in n)if(Object.prototype.hasOwnProperty.call(n,t)){let i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){let r=Object.keys(i).map(o=>`${t}.${o}`);e.push(...r)}else e.push(t)}return e.join(",")}function e8(n,e){let t=null,i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){let o=i.setup;typeof o=="object"&&o!==null?(n.bidiGenerateContentSetup=o,t=o):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;let r=n.fieldMask;if(t){let o=Xk(t);if(Array.isArray(e?.lockAdditionalFields)&&e?.lockAdditionalFields.length===0)o?n.fieldMask=o:delete n.fieldMask;else if(e?.lockAdditionalFields&&e.lockAdditionalFields.length>0&&r!==null&&Array.isArray(r)&&r.length>0){let s=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"],u=[];r.length>0&&(u=r.map(m=>s.includes(m)?`generationConfig.${m}`:m));let d=[];o&&d.push(o),u.length>0&&d.push(...u),d.length>0?n.fieldMask=d.join(","):delete n.fieldMask}else delete n.fieldMask}else r!==null&&Array.isArray(r)&&r.length>0?n.fieldMask=r.join(","):delete n.fieldMask;return n}var Ay=class extends ai{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{let u=Gk(this.apiClient,e);o=X("auth_tokens",u._url),s=u._query,delete u.config,delete u._url,delete u._query;let d=e8(u,e.config);return r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),r.then(m=>m)}}};function t8(n,e){let t={},i=p(n,["force"]);return e!==void 0&&i!=null&&g(e,["_query","force"],i),t}function n8(n){let e={},t=p(n,["name"]);t!=null&&g(e,["_url","name"],t);let i=p(n,["config"]);return i!=null&&t8(i,e),e}function i8(n){let e={},t=p(n,["name"]);return t!=null&&g(e,["_url","name"],t),e}function r8(n,e){let t={},i=p(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);let r=p(n,["pageToken"]);return e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),t}function o8(n){let e={},t=p(n,["parent"]);t!=null&&g(e,["_url","parent"],t);let i=p(n,["config"]);return i!=null&&r8(i,e),e}function s8(n){let e={},t=p(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);let i=p(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);let r=p(n,["documents"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>s)),g(e,["documents"],o)}return e}var Ny=class extends ai{constructor(e){super(),this.apiClient=e,this.list=async t=>new Ki(br.PAGED_ITEM_DOCUMENTS,i=>this.listInternal({parent:t.parent,config:i.config}),await this.listInternal(t),t)}async get(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=i8(e);return o=X("{name}",u._url),s=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>d)}}async delete(e){var t,i;let r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let s=n8(e);r=X("{name}",s._url),o=s._query,delete s._url,delete s._query,await this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=o8(e);return o=X("{parent}/documents",u._url),s=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>{let m=s8(d),h=new ny;return Object.assign(h,m),h})}}};var Ry=class extends ai{constructor(e,t=new Ny(e)){super(),this.apiClient=e,this.documents=t,this.list=async(i={})=>new Ki(br.PAGED_ITEM_FILE_SEARCH_STORES,r=>this.listInternal(r),await this.listInternal(i),i)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=sk(e);return o=X("fileSearchStores",u._url),s=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>d)}}async get(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=uk(e);return o=X("{name}",u._url),s=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>d)}}async delete(e){var t,i;let r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let s=lk(e);r=X("{name}",s._url),o=s._query,delete s._url,delete s._query,await this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=gk(e);return o=X("fileSearchStores",u._url),s=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>{let m=hk(d),h=new iy;return Object.assign(h,m),h})}}async uploadToFileSearchStoreInternal(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=yk(e);return o=X("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",u._url),s=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>{let m=_k(d),h=new ry;return Object.assign(h,m),h})}}async importFile(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=mk(e);return o=X("{file_search_store_name}:importFile",u._url),s=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),r.then(d=>{let m=ck(d),h=new oy;return Object.assign(h,m),h})}}};var Ab=function(){let{crypto:n}=globalThis;if(n?.randomUUID)return Ab=n.randomUUID.bind(n),n.randomUUID();let e=new Uint8Array(1),t=n?()=>n.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,i=>(+i^t()&15>>+i/4).toString(16))},a8=()=>Ab();function Fy(n){return typeof n=="object"&&n!==null&&("name"in n&&n.name==="AbortError"||"message"in n&&String(n.message).includes("FetchRequestCanceledException"))}var Py=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null){try{if(Object.prototype.toString.call(n)==="[object Error]"){let e=new Error(n.message,n.cause?{cause:n.cause}:{});return n.stack&&(e.stack=n.stack),n.cause&&!e.cause&&(e.cause=n.cause),n.name&&(e.name=n.name),e}}catch{}try{return new Error(JSON.stringify(n))}catch{}}return new Error(n)};var _n=class extends Error{},vn=class n extends _n{constructor(e,t,i,r){super(`${n.makeMessage(e,t,i)}`),this.status=e,this.headers=r,this.error=t}static makeMessage(e,t,i){let r=t?.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):i;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,i,r){if(!e||!r)return new Ns({message:i,cause:Py(t)});let o=t;return e===400?new Fm(e,o,i,r):e===401?new Pm(e,o,i,r):e===403?new km(e,o,i,r):e===404?new Vm(e,o,i,r):e===409?new Om(e,o,i,r):e===422?new Lm(e,o,i,r):e===429?new Bm(e,o,i,r):e>=500?new Um(e,o,i,r):new n(e,o,i,r)}},Jl=class extends vn{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}},Ns=class extends vn{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}},Rm=class extends Ns{constructor({message:e}={}){super({message:e??"Request timed out."})}},Fm=class extends vn{},Pm=class extends vn{},km=class extends vn{},Vm=class extends vn{},Om=class extends vn{},Lm=class extends vn{},Bm=class extends vn{},Um=class extends vn{};var l8=/^[a-z][a-z0-9+.-]*:/i,u8=n=>l8.test(n),ky=n=>(ky=Array.isArray,ky(n)),d8=ky,c8=d8,J2=c8;function m8(n){if(!n)return!0;for(let e in n)return!1;return!0}function p8(n,e){return Object.prototype.hasOwnProperty.call(n,e)}var f8=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new _n(`${n} must be an integer`);if(e<0)throw new _n(`${n} must be a positive integer`);return e},g8=n=>{try{return JSON.parse(n)}catch{return}};var h8=n=>new Promise(e=>setTimeout(e,n));var Is="0.0.1";function y8(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}var _8=()=>{var n,e,t,i,r;let o=y8();if(o==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Is,"X-Stainless-OS":Q2(Deno.build.os),"X-Stainless-Arch":K2(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(n=Deno.version)===null||n===void 0?void 0:n.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Is,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(o==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Is,"X-Stainless-OS":Q2((t=globalThis.process.platform)!==null&&t!==void 0?t:"unknown"),"X-Stainless-Arch":K2((i=globalThis.process.arch)!==null&&i!==void 0?i:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(r=globalThis.process.version)!==null&&r!==void 0?r:"unknown"};let s=v8();return s?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Is,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${s.browser}`,"X-Stainless-Runtime-Version":s.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Is,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function v8(){if(typeof navigator>"u"||!navigator)return null;let n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(let{key:e,pattern:t}of n){let i=t.exec(navigator.userAgent);if(i){let r=i[1]||0,o=i[2]||0,s=i[3]||0;return{browser:e,version:`${r}.${o}.${s}`}}}return null}var K2=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",Q2=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown"),mm,C8=()=>mm??(mm=_8());function x8(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Nb(...n){let e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...n)}function E8(n){let e=Symbol.asyncIterator in n?n[Symbol.asyncIterator]():n[Symbol.iterator]();return Nb({start(){},async pull(t){let{done:i,value:r}=await e.next();i?t.close():t.enqueue(r)},async cancel(){var t;await((t=e.return)===null||t===void 0?void 0:t.call(e))}})}function Rb(n){if(n[Symbol.asyncIterator])return n;let e=n.getReader();return{async next(){try{let t=await e.read();return t?.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){let t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function b8(n){var e,t;if(n===null||typeof n!="object")return;if(n[Symbol.asyncIterator]){await((t=(e=n[Symbol.asyncIterator]()).return)===null||t===void 0?void 0:t.call(e));return}let i=n.getReader(),r=i.cancel();i.releaseLock(),await r}var S8=({headers:n,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});var Fb=()=>{var n;if(typeof File>"u"){let{process:e}=globalThis,t=typeof((n=e?.versions)===null||n===void 0?void 0:n.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function zh(n,e,t){return Fb(),new File(n,e??"unknown_file",t)}function D8(n){return(typeof n=="object"&&n!==null&&("name"in n&&n.name&&String(n.name)||"url"in n&&n.url&&String(n.url)||"filename"in n&&n.filename&&String(n.filename)||"path"in n&&n.path&&String(n.path))||"").split(/[\\/]/).pop()||void 0}var w8=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function";var Pb=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",T8=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&Pb(n),I8=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function";async function M8(n,e,t){if(Fb(),n=await n,T8(n))return n instanceof File?n:zh([await n.arrayBuffer()],n.name);if(I8(n)){let r=await n.blob();return e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()),zh(await Vy(r),e,t)}let i=await Vy(n);if(e||(e=D8(n)),!t?.type){let r=i.find(o=>typeof o=="object"&&"type"in o&&o.type);typeof r=="string"&&(t=Object.assign(Object.assign({},t),{type:r}))}return zh(i,e,t)}async function Vy(n){var e,t,i,r,o;let s=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)s.push(n);else if(Pb(n))s.push(n instanceof Blob?n:await n.arrayBuffer());else if(w8(n))try{for(var u=!0,d=si(n),m;m=await d.next(),e=m.done,!e;u=!0){r=m.value,u=!1;let h=r;s.push(...await Vy(h))}}catch(h){t={error:h}}finally{try{!u&&!e&&(i=d.return)&&await i.call(d)}finally{if(t)throw t.error}}else{let h=(o=n?.constructor)===null||o===void 0?void 0:o.name;throw new Error(`Unexpected data type: ${typeof n}${h?`; constructor: ${h}`:""}${A8(n)}`)}return s}function A8(n){return typeof n!="object"||n===null?"":`; props: [${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}var N8=(()=>{class n{constructor(t){this._client=t}}n._key=[];return n})();function kb(n){return n.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}var Z2=Object.freeze(Object.create(null)),R8=(n=kb)=>function(t,...i){if(t.length===1)return t[0];let r=!1,o=[],s=t.reduce((h,y,_)=>{var C,D,I;/[?#]/.test(y)&&(r=!0);let R=i[_],F=(r?encodeURIComponent:n)(""+R);return _!==i.length&&(R==null||typeof R=="object"&&R.toString===((I=Object.getPrototypeOf((D=Object.getPrototypeOf((C=R.hasOwnProperty)!==null&&C!==void 0?C:Z2))!==null&&D!==void 0?D:Z2))===null||I===void 0?void 0:I.toString))&&(F=R+"",o.push({start:h.length+y.length,length:F.length,error:`Value of type ${Object.prototype.toString.call(R).slice(8,-1)} is not a valid path parameter`})),h+y+(_===i.length?"":F)},""),u=s.split(/[?#]/,1)[0],d=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi"),m;for(;(m=d.exec(u))!==null;)o.push({start:m.index,length:m[0].length,error:`Value "${m[0]}" can't be safely passed as a path parameter`});if(o.sort((h,y)=>h.start-y.start),o.length>0){let h=0,y=o.reduce((_,C)=>{let D=" ".repeat(C.start-h),I="^".repeat(C.length);return h=C.start+C.length,_+D+I},"");throw new _n(`Path parameters result in path with invalid segments:
${o.map(_=>_.error).join(`
`)}
${s}
${y}`)}return s},pm=R8(kb);var $m=class extends N8{create(e,t){var i;let{api_version:r=this._client.apiVersion}=e,o=Nm(e,["api_version"]);if("model"in o&&"agent_config"in o)throw new _n("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in o&&"generation_config"in o)throw new _n("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(pm`/${r}/interactions`,Object.assign(Object.assign({body:o},t),{stream:(i=e.stream)!==null&&i!==void 0?i:!1}))}delete(e,t={},i){let{api_version:r=this._client.apiVersion}=t??{};return this._client.delete(pm`/${r}/interactions/${e}`,i)}cancel(e,t={},i){let{api_version:r=this._client.apiVersion}=t??{};return this._client.post(pm`/${r}/interactions/${e}/cancel`,i)}get(e,t={},i){var r;let o=t??{},{api_version:s=this._client.apiVersion}=o,u=Nm(o,["api_version"]);return this._client.get(pm`/${s}/interactions/${e}`,Object.assign(Object.assign({query:u},i),{stream:(r=t?.stream)!==null&&r!==void 0?r:!1}))}};$m._key=Object.freeze(["interactions"]);var Hm=class extends $m{};function F8(n){let e=0;for(let r of n)e+=r.length;let t=new Uint8Array(e),i=0;for(let r of n)t.set(r,i),i+=r.length;return t}var fm;function Zy(n){let e;return(fm??(e=new globalThis.TextEncoder,fm=e.encode.bind(e)))(n)}var gm;function X2(n){let e;return(gm??(e=new globalThis.TextDecoder,gm=e.decode.bind(e)))(n)}var Rs=class{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];let t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?Zy(e):e;this.buffer=F8([this.buffer,t]);let i=[],r;for(;(r=P8(this.buffer,this.carriageReturnIndex))!=null;){if(r.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=r.index;continue}if(this.carriageReturnIndex!=null&&(r.index!==this.carriageReturnIndex+1||r.carriage)){i.push(X2(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}let o=this.carriageReturnIndex!==null?r.preceding-1:r.preceding,s=X2(this.buffer.subarray(0,o));i.push(s),this.buffer=this.buffer.subarray(r.index),this.carriageReturnIndex=null}return i}flush(){return this.buffer.length?this.decode(`
`):[]}};Rs.NEWLINE_CHARS=new Set([`
`,"\r"]);Rs.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function P8(n,e){for(let r=e??0;r<n.length;r++){if(n[r]===10)return{preceding:r,index:r+1,carriage:!1};if(n[r]===13)return{preceding:r,index:r+1,carriage:!0}}return null}function k8(n){for(let i=0;i<n.length-1;i++){if(n[i]===10&&n[i+1]===10||n[i]===13&&n[i+1]===13)return i+2;if(n[i]===13&&n[i+1]===10&&i+3<n.length&&n[i+2]===13&&n[i+3]===10)return i+4}return-1}var Gm={off:0,error:200,warn:300,info:400,debug:500},eb=(n,e,t)=>{if(n){if(p8(Gm,n))return n;cn(t).warn(`${e} was set to ${JSON.stringify(n)}, expected one of ${JSON.stringify(Object.keys(Gm))}`)}};function jl(){}function hm(n,e,t){return!e||Gm[n]>Gm[t]?jl:e[n].bind(e)}var V8={error:jl,warn:jl,info:jl,debug:jl},tb=new WeakMap;function cn(n){var e;let t=n.logger,i=(e=n.logLevel)!==null&&e!==void 0?e:"off";if(!t)return V8;let r=tb.get(t);if(r&&r[0]===i)return r[1];let o={error:hm("error",t,i),warn:hm("warn",t,i),info:hm("info",t,i),debug:hm("debug",t,i)};return tb.set(t,[i,o]),o}var po=n=>(n.options&&(n.options=Object.assign({},n.options),delete n.options.headers),n.headers&&(n.headers=Object.fromEntries((n.headers instanceof Headers?[...n.headers]:Object.entries(n.headers)).map(([e,t])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in n&&(n.retryOfRequestLogID&&(n.retryOf=n.retryOfRequestLogID),delete n.retryOfRequestLogID),n);var Oy=class n{constructor(e,t,i){this.iterator=e,this.controller=t,this.client=i}static fromSSEResponse(e,t,i){let r=!1,o=i?cn(i):console;function s(){return oi(this,arguments,function*(){var d,m,h,y;if(r)throw new _n("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let _=!1;try{try{for(var C=!0,D=si(O8(e,t)),I;I=yield _e(D.next()),d=I.done,!d;C=!0){y=I.value,C=!1;let R=y;if(!_)if(R.data.startsWith("[DONE]")){_=!0;continue}else try{yield yield _e(JSON.parse(R.data))}catch(F){throw o.error("Could not parse message into JSON:",R.data),o.error("From chunk:",R.raw),F}}}catch(R){m={error:R}}finally{try{!C&&!d&&(h=D.return)&&(yield _e(h.call(D)))}finally{if(m)throw m.error}}_=!0}catch(R){if(Fy(R))return yield _e(void 0);throw R}finally{_||t.abort()}})}return new n(s,t,i)}static fromReadableStream(e,t,i){let r=!1;function o(){return oi(this,arguments,function*(){var d,m,h,y;let _=new Rs,C=Rb(e);try{for(var D=!0,I=si(C),R;R=yield _e(I.next()),d=R.done,!d;D=!0){y=R.value,D=!1;let F=y;for(let $ of _.decode(F))yield yield _e($)}}catch(F){m={error:F}}finally{try{!D&&!d&&(h=I.return)&&(yield _e(h.call(I)))}finally{if(m)throw m.error}}for(let F of _.flush())yield yield _e(F)})}function s(){return oi(this,arguments,function*(){var d,m,h,y;if(r)throw new _n("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let _=!1;try{try{for(var C=!0,D=si(o()),I;I=yield _e(D.next()),d=I.done,!d;C=!0){y=I.value,C=!1;let R=y;_||R&&(yield yield _e(JSON.parse(R)))}}catch(R){m={error:R}}finally{try{!C&&!d&&(h=D.return)&&(yield _e(h.call(D)))}finally{if(m)throw m.error}}_=!0}catch(R){if(Fy(R))return yield _e(void 0);throw R}finally{_||t.abort()}})}return new n(s,t,i)}[Symbol.asyncIterator](){return this.iterator()}tee(){let e=[],t=[],i=this.iterator(),r=o=>({next:()=>{if(o.length===0){let s=i.next();e.push(s),t.push(s)}return o.shift()}});return[new n(()=>r(e),this.controller,this.client),new n(()=>r(t),this.controller,this.client)]}toReadableStream(){let e=this,t;return Nb({async start(){t=e[Symbol.asyncIterator]()},async pull(i){try{let{value:r,done:o}=await t.next();if(o)return i.close();let s=Zy(JSON.stringify(r)+`
`);i.enqueue(s)}catch(r){i.error(r)}},async cancel(){var i;await((i=t.return)===null||i===void 0?void 0:i.call(t))}})}};function O8(n,e){return oi(this,arguments,function*(){var i,r,o,s;if(!n.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new _n("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new _n("Attempted to iterate over a response with no body");let u=new Ly,d=new Rs,m=Rb(n.body);try{for(var h=!0,y=si(L8(m)),_;_=yield _e(y.next()),i=_.done,!i;h=!0){s=_.value,h=!1;let C=s;for(let D of d.decode(C)){let I=u.decode(D);I&&(yield yield _e(I))}}}catch(C){r={error:C}}finally{try{!h&&!i&&(o=y.return)&&(yield _e(o.call(y)))}finally{if(r)throw r.error}}for(let C of d.flush()){let D=u.decode(C);D&&(yield yield _e(D))}})}function L8(n){return oi(this,arguments,function*(){var t,i,r,o;let s=new Uint8Array;try{for(var u=!0,d=si(n),m;m=yield _e(d.next()),t=m.done,!t;u=!0){o=m.value,u=!1;let h=o;if(h==null)continue;let y=h instanceof ArrayBuffer?new Uint8Array(h):typeof h=="string"?Zy(h):h,_=new Uint8Array(s.length+y.length);_.set(s),_.set(y,s.length),s=_;let C;for(;(C=k8(s))!==-1;)yield yield _e(s.slice(0,C)),s=s.slice(C)}}catch(h){i={error:h}}finally{try{!u&&!t&&(r=d.return)&&(yield _e(r.call(d)))}finally{if(i)throw i.error}}s.length>0&&(yield yield _e(s))})}var Ly=class{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,i,r]=B8(e,":");return r.startsWith(" ")&&(r=r.substring(1)),t==="event"?this.event=r:t==="data"&&this.data.push(r),null}};function B8(n,e){let t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}async function U8(n,e){let{response:t,requestLogID:i,retryOfRequestLogID:r,startTime:o}=e,s=await(async()=>{var u;if(e.options.stream)return cn(n).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,n):Oy.fromSSEResponse(t,e.controller,n);if(t.status===204)return null;if(e.options.__binaryResponse)return t;let d=t.headers.get("content-type"),m=(u=d?.split(";")[0])===null||u===void 0?void 0:u.trim();return m?.includes("application/json")||m?.endsWith("+json")?await t.json():await t.text()})();return cn(n).debug(`[${i}] response parsed`,po({retryOfRequestLogID:r,url:t.url,status:t.status,body:s,durationMs:Date.now()-o})),s}var By=class n extends Promise{constructor(e,t,i=U8){super(r=>{r(null)}),this.responsePromise=t,this.parseResponse=i,this.client=e}_thenUnwrap(e){return new n(this.client,this.responsePromise,async(t,i)=>e(await this.parseResponse(t,i),i))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){let[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}};var Vb=Symbol("brand.privateNullableHeaders");function*$8(n){if(!n)return;if(Vb in n){let{values:i,nulls:r}=n;yield*i.entries();for(let o of r)yield[o,null];return}let e=!1,t;n instanceof Headers?t=n.entries():J2(n)?t=n:(e=!0,t=Object.entries(n??{}));for(let i of t){let r=i[0];if(typeof r!="string")throw new TypeError("expected header name to be a string");let o=J2(i[1])?i[1]:[i[1]],s=!1;for(let u of o)u!==void 0&&(e&&!s&&(s=!0,yield[r,null]),yield[r,u])}}var ql=n=>{let e=new Headers,t=new Set;for(let i of n){let r=new Set;for(let[o,s]of $8(i)){let u=o.toLowerCase();r.has(u)||(e.delete(o),r.add(u)),s===null?(e.delete(o),t.add(u)):(e.append(o,s),t.delete(u))}}return{[Vb]:!0,values:e,nulls:t}};var Yh=n=>{var e,t,i,r,o,s;if(typeof globalThis.process<"u")return(i=(t=(e=globalThis.process.env)===null||e===void 0?void 0:e[n])===null||t===void 0?void 0:t.trim())!==null&&i!==void 0?i:void 0;if(typeof globalThis.Deno<"u")return(s=(o=(r=globalThis.Deno.env)===null||r===void 0?void 0:r.get)===null||o===void 0?void 0:o.call(r,n))===null||s===void 0?void 0:s.trim()};var Ob,H8=(()=>{class n{constructor(t){var i,r,o,s,u,d,m,{baseURL:h=Yh("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:y=(i=Yh("GEMINI_API_KEY"))!==null&&i!==void 0?i:null,apiVersion:_="v1beta"}=t,C=Nm(t,["baseURL","apiKey","apiVersion"]);let D=Object.assign(Object.assign({apiKey:y,apiVersion:_},C),{baseURL:h||"https://generativelanguage.googleapis.com"});this.baseURL=D.baseURL,this.timeout=(r=D.timeout)!==null&&r!==void 0?r:n.DEFAULT_TIMEOUT,this.logger=(o=D.logger)!==null&&o!==void 0?o:console;let I="warn";this.logLevel=I,this.logLevel=(u=(s=eb(D.logLevel,"ClientOptions.logLevel",this))!==null&&s!==void 0?s:eb(Yh("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&u!==void 0?u:I,this.fetchOptions=D.fetchOptions,this.maxRetries=(d=D.maxRetries)!==null&&d!==void 0?d:2,this.fetch=(m=D.fetch)!==null&&m!==void 0?m:x8(),this.encoder=S8,this._options=D,this.apiKey=y,this.apiVersion=_,this.clientAdapter=D.clientAdapter}withOptions(t){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),t))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:t,nulls:i}){if(!(t.has("authorization")||t.has("x-goog-api-key"))&&!(this.apiKey&&t.get("x-goog-api-key"))&&!i.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(t){let i=ql([t.headers]);if(!(i.values.has("authorization")||i.values.has("x-goog-api-key"))){if(this.apiKey)return ql([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return ql([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(t){return Object.entries(t).filter(([i,r])=>typeof r<"u").map(([i,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(i)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(i)}=`;throw new _n(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Is}`}defaultIdempotencyKey(){return`stainless-node-retry-${a8()}`}makeStatusError(t,i,r,o){return vn.generate(t,i,r,o)}buildURL(t,i,r){let o=!this.baseURLOverridden()&&r||this.baseURL,s=u8(t)?new URL(t):new URL(o+(o.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),u=this.defaultQuery();return m8(u)||(i=Object.assign(Object.assign({},u),i)),typeof i=="object"&&i&&!Array.isArray(i)&&(s.search=this.stringifyQuery(i)),s.toString()}async prepareOptions(t){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!t.path.startsWith(`/${this.apiVersion}/projects/`)){let i=t.path.slice(this.apiVersion.length+1);t.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${i}`}}async prepareRequest(t,{url:i,options:r}){}get(t,i){return this.methodRequest("get",t,i)}post(t,i){return this.methodRequest("post",t,i)}patch(t,i){return this.methodRequest("patch",t,i)}put(t,i){return this.methodRequest("put",t,i)}delete(t,i){return this.methodRequest("delete",t,i)}methodRequest(t,i,r){return this.request(Promise.resolve(r).then(o=>Object.assign({method:t,path:i},o)))}request(t,i=null){return new By(this,this.makeRequest(t,i,void 0))}async makeRequest(t,i,r){var o,s,u;let d=await t,m=(o=d.maxRetries)!==null&&o!==void 0?o:this.maxRetries;i==null&&(i=m),await this.prepareOptions(d);let{req:h,url:y,timeout:_}=await this.buildRequest(d,{retryCount:m-i});await this.prepareRequest(h,{url:y,options:d});let C="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),D=r===void 0?"":`, retryOf: ${r}`,I=Date.now();if(cn(this).debug(`[${C}] sending request`,po({retryOfRequestLogID:r,method:d.method,url:y,options:d,headers:h.headers})),!((s=d.signal)===null||s===void 0)&&s.aborted)throw new Jl;let R=new AbortController,F=await this.fetchWithTimeout(y,h,_,R).catch(Py),$=Date.now();if(F instanceof globalThis.Error){let Y=`retrying, ${i} attempts remaining`;if(!((u=d.signal)===null||u===void 0)&&u.aborted)throw new Jl;let ne=Fy(F)||/timed? ?out/i.test(String(F)+("cause"in F?String(F.cause):""));if(i)return cn(this).info(`[${C}] connection ${ne?"timed out":"failed"} - ${Y}`),cn(this).debug(`[${C}] connection ${ne?"timed out":"failed"} (${Y})`,po({retryOfRequestLogID:r,url:y,durationMs:$-I,message:F.message})),this.retryRequest(d,i,r??C);throw cn(this).info(`[${C}] connection ${ne?"timed out":"failed"} - error; no more retries left`),cn(this).debug(`[${C}] connection ${ne?"timed out":"failed"} (error; no more retries left)`,po({retryOfRequestLogID:r,url:y,durationMs:$-I,message:F.message})),ne?new Rm:new Ns({cause:F})}let G=`[${C}${D}] ${h.method} ${y} ${F.ok?"succeeded":"failed"} with status ${F.status} in ${$-I}ms`;if(!F.ok){let Y=await this.shouldRetry(F);if(i&&Y){let we=`retrying, ${i} attempts remaining`;return await b8(F.body),cn(this).info(`${G} - ${we}`),cn(this).debug(`[${C}] response error (${we})`,po({retryOfRequestLogID:r,url:F.url,status:F.status,headers:F.headers,durationMs:$-I})),this.retryRequest(d,i,r??C,F.headers)}let ne=Y?"error; no more retries left":"error; not retryable";cn(this).info(`${G} - ${ne}`);let de=await F.text().catch(we=>Py(we).message),le=g8(de),Ue=le?void 0:de;throw cn(this).debug(`[${C}] response error (${ne})`,po({retryOfRequestLogID:r,url:F.url,status:F.status,headers:F.headers,message:Ue,durationMs:Date.now()-I})),this.makeStatusError(F.status,le,Ue,F.headers)}return cn(this).info(G),cn(this).debug(`[${C}] response start`,po({retryOfRequestLogID:r,url:F.url,status:F.status,headers:F.headers,durationMs:$-I})),{response:F,options:d,controller:R,requestLogID:C,retryOfRequestLogID:r,startTime:I}}async fetchWithTimeout(t,i,r,o){let s=i||{},{signal:u,method:d}=s,m=Nm(s,["signal","method"]);u&&u.addEventListener("abort",()=>o.abort());let h=setTimeout(()=>o.abort(),r),y=globalThis.ReadableStream&&m.body instanceof globalThis.ReadableStream||typeof m.body=="object"&&m.body!==null&&Symbol.asyncIterator in m.body,_=Object.assign(Object.assign(Object.assign({signal:o.signal},y?{duplex:"half"}:{}),{method:"GET"}),m);d&&(_.method=d.toUpperCase());try{return await this.fetch.call(void 0,t,_)}finally{clearTimeout(h)}}async shouldRetry(t){let i=t.headers.get("x-should-retry");return i==="true"?!0:i==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,i,r,o){var s;let u,d=o?.get("retry-after-ms");if(d){let h=parseFloat(d);Number.isNaN(h)||(u=h)}let m=o?.get("retry-after");if(m&&!u){let h=parseFloat(m);Number.isNaN(h)?u=Date.parse(m)-Date.now():u=h*1e3}if(!(u&&0<=u&&u<60*1e3)){let h=(s=t.maxRetries)!==null&&s!==void 0?s:this.maxRetries;u=this.calculateDefaultRetryTimeoutMillis(i,h)}return await h8(u),this.makeRequest(t,i-1,r)}calculateDefaultRetryTimeoutMillis(t,i){let s=i-t,u=Math.min(.5*Math.pow(2,s),8),d=1-Math.random()*.25;return u*d*1e3}async buildRequest(t,{retryCount:i=0}={}){var r,o,s;let u=Object.assign({},t),{method:d,path:m,query:h,defaultBaseURL:y}=u,_=this.buildURL(m,h,y);"timeout"in u&&f8("timeout",u.timeout),u.timeout=(r=u.timeout)!==null&&r!==void 0?r:this.timeout;let{bodyHeaders:C,body:D}=this.buildBody({options:u}),I=await this.buildHeaders({options:t,method:d,bodyHeaders:C,retryCount:i});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:d,headers:I},u.signal&&{signal:u.signal}),globalThis.ReadableStream&&D instanceof globalThis.ReadableStream&&{duplex:"half"}),D&&{body:D}),(o=this.fetchOptions)!==null&&o!==void 0?o:{}),(s=u.fetchOptions)!==null&&s!==void 0?s:{}),url:_,timeout:u.timeout}}async buildHeaders({options:t,method:i,bodyHeaders:r,retryCount:o}){let s={};this.idempotencyHeader&&i!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=t.idempotencyKey);let u=await this.authHeaders(t),d=ql([s,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(o)},t.timeout?{"X-Stainless-Timeout":String(Math.trunc(t.timeout/1e3))}:{}),C8()),this._options.defaultHeaders,r,t.headers,u]);return this.validateHeaders(d),d.values}buildBody({options:{body:t,headers:i}}){if(!t)return{bodyHeaders:void 0,body:void 0};let r=ql([i]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||typeof t=="string"&&r.values.has("content-type")||globalThis.Blob&&t instanceof globalThis.Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:typeof t=="object"&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&typeof t.next=="function")?{bodyHeaders:void 0,body:E8(t)}:this.encoder({body:t,headers:r})}}return n.DEFAULT_TIMEOUT=6e4,n})(),wt=class extends H8{constructor(){super(...arguments),this.interactions=new Hm(this)}};Ob=wt;wt.GeminiNextGenAPIClient=Ob;wt.GeminiNextGenAPIClientError=_n;wt.APIError=vn;wt.APIConnectionError=Ns;wt.APIConnectionTimeoutError=Rm;wt.APIUserAbortError=Jl;wt.NotFoundError=Vm;wt.ConflictError=Om;wt.RateLimitError=Bm;wt.BadRequestError=Fm;wt.AuthenticationError=Pm;wt.InternalServerError=Um;wt.PermissionDeniedError=km;wt.UnprocessableEntityError=Lm;wt.toFile=M8;wt.Interactions=Hm;function G8(n,e){let t={},i=p(n,["name"]);return i!=null&&g(t,["_url","name"],i),t}function q8(n,e){let t={},i=p(n,["name"]);return i!=null&&g(t,["_url","name"],i),t}function W8(n,e){let t={},i=p(n,["sdkHttpResponse"]);return i!=null&&g(t,["sdkHttpResponse"],i),t}function j8(n,e){let t={},i=p(n,["sdkHttpResponse"]);return i!=null&&g(t,["sdkHttpResponse"],i),t}function z8(n,e,t){let i={};if(p(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");let r=p(n,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&g(e,["displayName"],r),p(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");let o=p(n,["epochCount"]);e!==void 0&&o!=null&&g(e,["tuningTask","hyperparameters","epochCount"],o);let s=p(n,["learningRateMultiplier"]);if(s!=null&&g(i,["tuningTask","hyperparameters","learningRateMultiplier"],s),p(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(p(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(p(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");let u=p(n,["batchSize"]);e!==void 0&&u!=null&&g(e,["tuningTask","hyperparameters","batchSize"],u);let d=p(n,["learningRate"]);if(e!==void 0&&d!=null&&g(e,["tuningTask","hyperparameters","learningRate"],d),p(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(p(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return i}function Y8(n,e,t){let i={},r=p(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){let C=p(n,["validationDataset"]);e!==void 0&&C!=null&&g(e,["supervisedTuningSpec"],nb(C))}else if(r==="PREFERENCE_TUNING"){let C=p(n,["validationDataset"]);e!==void 0&&C!=null&&g(e,["preferenceOptimizationSpec"],nb(C))}let o=p(n,["tunedModelDisplayName"]);e!==void 0&&o!=null&&g(e,["tunedModelDisplayName"],o);let s=p(n,["description"]);e!==void 0&&s!=null&&g(e,["description"],s);let u=p(t,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){let C=p(n,["epochCount"]);e!==void 0&&C!=null&&g(e,["supervisedTuningSpec","hyperParameters","epochCount"],C)}else if(u==="PREFERENCE_TUNING"){let C=p(n,["epochCount"]);e!==void 0&&C!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],C)}let d=p(t,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){let C=p(n,["learningRateMultiplier"]);e!==void 0&&C!=null&&g(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],C)}else if(d==="PREFERENCE_TUNING"){let C=p(n,["learningRateMultiplier"]);e!==void 0&&C!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],C)}let m=p(t,["config","method"]);if(m===void 0&&(m="SUPERVISED_FINE_TUNING"),m==="SUPERVISED_FINE_TUNING"){let C=p(n,["exportLastCheckpointOnly"]);e!==void 0&&C!=null&&g(e,["supervisedTuningSpec","exportLastCheckpointOnly"],C)}else if(m==="PREFERENCE_TUNING"){let C=p(n,["exportLastCheckpointOnly"]);e!==void 0&&C!=null&&g(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],C)}let h=p(t,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){let C=p(n,["adapterSize"]);e!==void 0&&C!=null&&g(e,["supervisedTuningSpec","hyperParameters","adapterSize"],C)}else if(h==="PREFERENCE_TUNING"){let C=p(n,["adapterSize"]);e!==void 0&&C!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],C)}if(p(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(p(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");let y=p(n,["labels"]);e!==void 0&&y!=null&&g(e,["labels"],y);let _=p(n,["beta"]);return e!==void 0&&_!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","beta"],_),i}function J8(n,e){let t={},i=p(n,["baseModel"]);i!=null&&g(t,["baseModel"],i);let r=p(n,["preTunedModel"]);r!=null&&g(t,["preTunedModel"],r);let o=p(n,["trainingDataset"]);o!=null&&s7(o);let s=p(n,["config"]);return s!=null&&z8(s,t),t}function K8(n,e){let t={},i=p(n,["baseModel"]);i!=null&&g(t,["baseModel"],i);let r=p(n,["preTunedModel"]);r!=null&&g(t,["preTunedModel"],r);let o=p(n,["trainingDataset"]);o!=null&&a7(o,t,e);let s=p(n,["config"]);return s!=null&&Y8(s,t,e),t}function Q8(n,e){let t={},i=p(n,["name"]);return i!=null&&g(t,["_url","name"],i),t}function Z8(n,e){let t={},i=p(n,["name"]);return i!=null&&g(t,["_url","name"],i),t}function X8(n,e,t){let i={},r=p(n,["pageSize"]);e!==void 0&&r!=null&&g(e,["_query","pageSize"],r);let o=p(n,["pageToken"]);e!==void 0&&o!=null&&g(e,["_query","pageToken"],o);let s=p(n,["filter"]);return e!==void 0&&s!=null&&g(e,["_query","filter"],s),i}function e7(n,e,t){let i={},r=p(n,["pageSize"]);e!==void 0&&r!=null&&g(e,["_query","pageSize"],r);let o=p(n,["pageToken"]);e!==void 0&&o!=null&&g(e,["_query","pageToken"],o);let s=p(n,["filter"]);return e!==void 0&&s!=null&&g(e,["_query","filter"],s),i}function t7(n,e){let t={},i=p(n,["config"]);return i!=null&&X8(i,t),t}function n7(n,e){let t={},i=p(n,["config"]);return i!=null&&e7(i,t),t}function i7(n,e){let t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);let r=p(n,["nextPageToken"]);r!=null&&g(t,["nextPageToken"],r);let o=p(n,["tunedModels"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(u=>Lb(u))),g(t,["tuningJobs"],s)}return t}function r7(n,e){let t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);let r=p(n,["nextPageToken"]);r!=null&&g(t,["nextPageToken"],r);let o=p(n,["tuningJobs"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(u=>Uy(u))),g(t,["tuningJobs"],s)}return t}function o7(n,e){let t={},i=p(n,["name"]);i!=null&&g(t,["model"],i);let r=p(n,["name"]);return r!=null&&g(t,["endpoint"],r),t}function s7(n,e){let t={};if(p(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(p(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");let i=p(n,["examples"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>o)),g(t,["examples","examples"],r)}return t}function a7(n,e,t){let i={},r=p(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){let s=p(n,["gcsUri"]);e!==void 0&&s!=null&&g(e,["supervisedTuningSpec","trainingDatasetUri"],s)}else if(r==="PREFERENCE_TUNING"){let s=p(n,["gcsUri"]);e!==void 0&&s!=null&&g(e,["preferenceOptimizationSpec","trainingDatasetUri"],s)}let o=p(t,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){let s=p(n,["vertexDatasetResource"]);e!==void 0&&s!=null&&g(e,["supervisedTuningSpec","trainingDatasetUri"],s)}else if(o==="PREFERENCE_TUNING"){let s=p(n,["vertexDatasetResource"]);e!==void 0&&s!=null&&g(e,["preferenceOptimizationSpec","trainingDatasetUri"],s)}if(p(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function Lb(n,e){let t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);let r=p(n,["name"]);r!=null&&g(t,["name"],r);let o=p(n,["state"]);o!=null&&g(t,["state"],mb(o));let s=p(n,["createTime"]);s!=null&&g(t,["createTime"],s);let u=p(n,["tuningTask","startTime"]);u!=null&&g(t,["startTime"],u);let d=p(n,["tuningTask","completeTime"]);d!=null&&g(t,["endTime"],d);let m=p(n,["updateTime"]);m!=null&&g(t,["updateTime"],m);let h=p(n,["description"]);h!=null&&g(t,["description"],h);let y=p(n,["baseModel"]);y!=null&&g(t,["baseModel"],y);let _=p(n,["_self"]);return _!=null&&g(t,["tunedModel"],o7(_)),t}function Uy(n,e){let t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);let r=p(n,["name"]);r!=null&&g(t,["name"],r);let o=p(n,["state"]);o!=null&&g(t,["state"],mb(o));let s=p(n,["createTime"]);s!=null&&g(t,["createTime"],s);let u=p(n,["startTime"]);u!=null&&g(t,["startTime"],u);let d=p(n,["endTime"]);d!=null&&g(t,["endTime"],d);let m=p(n,["updateTime"]);m!=null&&g(t,["updateTime"],m);let h=p(n,["error"]);h!=null&&g(t,["error"],h);let y=p(n,["description"]);y!=null&&g(t,["description"],y);let _=p(n,["baseModel"]);_!=null&&g(t,["baseModel"],_);let C=p(n,["tunedModel"]);C!=null&&g(t,["tunedModel"],C);let D=p(n,["preTunedModel"]);D!=null&&g(t,["preTunedModel"],D);let I=p(n,["supervisedTuningSpec"]);I!=null&&g(t,["supervisedTuningSpec"],I);let R=p(n,["preferenceOptimizationSpec"]);R!=null&&g(t,["preferenceOptimizationSpec"],R);let F=p(n,["tuningDataStats"]);F!=null&&g(t,["tuningDataStats"],F);let $=p(n,["encryptionSpec"]);$!=null&&g(t,["encryptionSpec"],$);let G=p(n,["partnerModelTuningSpec"]);G!=null&&g(t,["partnerModelTuningSpec"],G);let Y=p(n,["customBaseModel"]);Y!=null&&g(t,["customBaseModel"],Y);let ne=p(n,["experiment"]);ne!=null&&g(t,["experiment"],ne);let de=p(n,["labels"]);de!=null&&g(t,["labels"],de);let le=p(n,["outputUri"]);le!=null&&g(t,["outputUri"],le);let Ue=p(n,["pipelineJob"]);Ue!=null&&g(t,["pipelineJob"],Ue);let pe=p(n,["serviceAccount"]);pe!=null&&g(t,["serviceAccount"],pe);let we=p(n,["tunedModelDisplayName"]);we!=null&&g(t,["tunedModelDisplayName"],we);let _t=p(n,["veoTuningSpec"]);return _t!=null&&g(t,["veoTuningSpec"],_t),t}function l7(n,e){let t={},i=p(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);let r=p(n,["name"]);r!=null&&g(t,["name"],r);let o=p(n,["metadata"]);o!=null&&g(t,["metadata"],o);let s=p(n,["done"]);s!=null&&g(t,["done"],s);let u=p(n,["error"]);return u!=null&&g(t,["error"],u),t}function nb(n,e){let t={},i=p(n,["gcsUri"]);i!=null&&g(t,["validationDatasetUri"],i);let r=p(n,["vertexDatasetResource"]);return r!=null&&g(t,["validationDatasetUri"],r),t}var $y=class extends ai{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Ki(br.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.get=async t=>await this.getInternal(t),this.tune=async t=>{var i;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){let r={tunedModelName:t.baseModel};!((i=t.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(r.checkpointId=t.config.preTunedModelCheckpointId);let o=Object.assign(Object.assign({},t),{preTunedModel:r});return o.baseModel=void 0,await this.tuneInternal(o)}else{let r=Object.assign({},t);return await this.tuneInternal(r)}else{let r=Object.assign({},t),o=await this.tuneMldevInternal(r),s="";return o.metadata!==void 0&&o.metadata.tunedModel!==void 0?s=o.metadata.tunedModel:o.name!==void 0&&o.name.includes("/operations/")&&(s=o.name.split("/operations/")[0]),{name:s,state:ob.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,r,o;let s,u="",d={};if(this.apiClient.isVertexAI()){let m=Z8(e);return u=X("{name}",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>Uy(h))}else{let m=Q8(e);return u=X("{name}",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>Lb(h))}}async listInternal(e){var t,i,r,o;let s,u="",d={};if(this.apiClient.isVertexAI()){let m=n7(e);return u=X("tuningJobs",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{let y=r7(h),_=new Dm;return Object.assign(_,y),_})}else{let m=t7(e);return u=X("tunedModels",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{let y=i7(h),_=new Dm;return Object.assign(_,y),_})}}async cancel(e){var t,i,r,o;let s,u="",d={};if(this.apiClient.isVertexAI()){let m=q8(e);return u=X("{name}:cancel",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{let y=j8(h),_=new wm;return Object.assign(_,y),_})}else{let m=G8(e);return u=X("{name}:cancel",m._url),d=m._query,delete m._url,delete m._query,s=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(y=>{let _=y;return _.sdkHttpResponse={headers:h.headers},_})),s.then(h=>{let y=W8(h),_=new wm;return Object.assign(_,y),_})}}async tuneInternal(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI()){let u=K8(e,e);return o=X("tuningJobs",u._url),s=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(m=>{let h=m;return h.sdkHttpResponse={headers:d.headers},h})),r.then(d=>Uy(d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let r,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{let u=J8(e);return o=X("tunedModels",u._url),s=u._query,delete u._url,delete u._query,r=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json().then(m=>{let h=m;return h.sdkHttpResponse={headers:d.headers},h})),r.then(d=>l7(d))}}};var Hy=class{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}},u7=1024*1024*8,d7=3,c7=1e3,m7=2,qm="x-goog-upload-status";async function p7(n,e,t){var i;let r=await Bb(n,e,t),o=await r?.json();if(((i=r?.headers)===null||i===void 0?void 0:i[qm])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return o.file}async function f7(n,e,t){var i;let r=await Bb(n,e,t),o=await r?.json();if(((i=r?.headers)===null||i===void 0?void 0:i[qm])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");let s=rb(o),u=new cy;return Object.assign(u,s),u}async function Bb(n,e,t){var i,r;let o=0,s=0,u=new zl(new Response),d="upload";for(o=n.size;s<o;){let m=Math.min(u7,o-s),h=n.slice(s,s+m);s+m>=o&&(d+=", finalize");let y=0,_=c7;for(;y<d7&&(u=await t.request({path:"",body:h,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(s),"Content-Length":String(m)}}}),!(!((i=u?.headers)===null||i===void 0)&&i[qm]));)y++,await h7(_),_=_*m7;if(s+=m,((r=u?.headers)===null||r===void 0?void 0:r[qm])!=="active")break;if(o<=s)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return u}async function g7(n){return{size:n.size,type:n.type}}function h7(n){return new Promise(e=>setTimeout(e,n))}var Gy=class{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await p7(e,t,i)}async uploadToFileSearchStore(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await f7(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await g7(e)}};var qy=class{create(e,t,i){return new Wy(e,t,i)}},Wy=class{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}};var ib="x-goog-api-key",jy=class{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(ib)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(ib,this.apiKey)}}};var y7="gl-node/",Wm=class{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");let e=this.httpOptions;e?.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");let t=new wt({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e?.timeout});return this._interactions=t.interactions,this._interactions}constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;let i=q6(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;let r=new jy(this.apiKey);this.apiClient=new Ey({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:y7+"web",uploader:new Gy,downloader:new Hy}),this.models=new Iy(this.apiClient),this.live=new wy(this.apiClient,r,new qy),this.batches=new fy(this.apiClient),this.chats=new hy(this.models,this.apiClient),this.caches=new gy(this.apiClient),this.files=new _y(this.apiClient),this.operations=new My(this.apiClient),this.authTokens=new Ay(this.apiClient),this.tunings=new $y(this.apiClient),this.fileSearchStores=new Ry(this.apiClient)}};var go=class go{constructor(){this.ai=null;this.financialInsightState=S("idle");this.financialInsight=S(null);this.financialInsightError=S(null);this.basketAnalysisState=S("idle");this.basketAnalysis=S(null);this.basketAnalysisError=S(null);let e=typeof process<"u"&&process.env?process.env.API_KEY:void 0;e?this.ai=new Wm({apiKey:e}):console.error("API_KEY environment variable not set. AI features will not be available.")}async generateFinancialInsights(e,t){if(!this.ai){this.financialInsightError.set("Gemini AI \u5BA2\u6236\u7AEF\u672A\u521D\u59CB\u5316\u3002\u8ACB\u6AA2\u67E5 API \u91D1\u9470\u3002"),this.financialInsightState.set("error");return}this.financialInsightState.set("loading"),this.financialInsightError.set(null),this.financialInsight.set(null);let i=`
      Analyze the following financial data for a small business.
      IMPORTANT: All textual analysis and recommendations in the response must be in Traditional Chinese. The JSON keys must remain in English as specified in the schema.

      Financial Summary:
      - Total Revenue: ${e.totalRevenue.toFixed(2)}
      - Total Expenses: ${e.totalExpenses.toFixed(2)}
      - Net Income: ${e.netIncome.toFixed(2)}

      Monthly Performance (Revenue vs Expenses):
      ${t.map(r=>`- ${r.month}: Revenue ${r.revenue.toFixed(2)}, Expenses ${r.expenses.toFixed(2)}`).join(`
`)}

      Based on this data, provide:
      1. Two key positive trends.
      2. Two potential areas for improvement or concern.
      3. Two actionable strategic recommendations.
    `;try{let r=await this.ai.models.generateContent({model:"gemini-2.5-flash",contents:i,config:{responseMimeType:"application/json",responseSchema:{type:dt.OBJECT,properties:{positive_trends:{type:dt.ARRAY,items:{type:dt.STRING}},areas_for_improvement:{type:dt.ARRAY,items:{type:dt.STRING}},strategic_recommendations:{type:dt.ARRAY,items:{type:dt.STRING}}}}}}),o=JSON.parse(r.text);this.financialInsight.set(o),this.financialInsightState.set("success")}catch(r){console.error(r),this.financialInsightError.set("\u5F9E AI \u6A21\u578B\u751F\u6210\u8CA1\u52D9\u6D1E\u5BDF\u5931\u6557\u3002"),this.financialInsightState.set("error")}}async analyzeShoppingBaskets(e){if(!this.ai){this.basketAnalysisError.set("Gemini AI \u5BA2\u6236\u7AEF\u672A\u521D\u59CB\u5316\u3002\u8ACB\u6AA2\u67E5 API \u91D1\u9470\u3002"),this.basketAnalysisState.set("error");return}this.basketAnalysisState.set("loading"),this.basketAnalysisError.set(null),this.basketAnalysis.set(null);let t=e.map(r=>r.items.map(o=>o.name)),i=`
      Perform a market basket analysis on the following list of customer transactions. Each inner list represents one transaction.
      Transactions: ${JSON.stringify(t)}

      IMPORTANT: All textual analysis, suggestions, and insights in the response must be in Traditional Chinese. The JSON keys must remain in English as specified in the schema.

      Identify up to 3 sets of items that are frequently bought together. For each set, provide a marketing or upselling suggestion.
      Also, provide 2 general insights into customer purchasing behavior based on this data.
    `;try{let r=await this.ai.models.generateContent({model:"gemini-2.5-flash",contents:i,config:{responseMimeType:"application/json",responseSchema:{type:dt.OBJECT,properties:{frequently_bought_together:{type:dt.ARRAY,items:{type:dt.OBJECT,properties:{items:{type:dt.ARRAY,items:{type:dt.STRING}},suggestion:{type:dt.STRING}}}},customer_behavior_insights:{type:dt.ARRAY,items:{type:dt.STRING}}}}}}),o=JSON.parse(r.text);this.basketAnalysis.set(o),this.basketAnalysisState.set("success")}catch(r){console.error(r),this.basketAnalysisError.set("\u5F9E AI \u6A21\u578B\u751F\u6210\u8CFC\u7269\u7C43\u5206\u6790\u5931\u6557\u3002"),this.basketAnalysisState.set("error")}}};go.\u0275fac=function(t){return new(t||go)},go.\u0275prov=J({token:go,factory:go.\u0275fac,providedIn:"root"});var Jm=go;var _7=(n,e)=>e.id,v7=(n,e)=>e.transactionId;function C7(n,e){n&1&&(l(0,"div",17)(1,"div",31),x(2,"div",32),l(3,"p",6),c(4,"\u52A0\u8F09\u9867\u5BA2\u5217\u8868\u4E2D..."),a()()())}function x7(n,e){if(n&1&&(l(0,"div",18)(1,"p",33),c(2,"\u52A0\u8F09\u5931\u6557"),a(),l(3,"p"),c(4),a()()),n&2){let t=v();f(4),E(t.errorMessage())}}function E7(n,e){if(n&1){let t=B();l(0,"div",47),b("click",function(){let r=w(t).$implicit,o=v(2);return T(o.selectCustomer(r))}),l(1,"div",48)(2,"p",49),c(3),a(),l(4,"span",50),c(5),a()(),l(6,"p",6),c(7),a()()}if(n&2){let t,i,r=e.$implicit,o=v(2);z("bg-indigo-100",((t=o.selectedCustomer())==null?null:t.id)===r.id)("hover:bg-gray-100",((i=o.selectedCustomer())==null?null:i.id)!==r.id),f(3),E(o.getCleanCustomerName(r)),f(),De(o.getCustomerTypeClass(r)),f(),E(o.getCustomerType(r)),f(2),E(r.phone)}}function b7(n,e){n&1&&(l(0,"p",46),c(1,"\u627E\u4E0D\u5230\u9867\u5BA2\u3002"),a())}function S7(n,e){if(n&1){let t=B();l(0,"div",34)(1,"select",35),Z("ngModelChange",function(r){w(t);let o=v();return ee(o.categoryFilter,r)||(o.categoryFilter=r),T(r)}),l(2,"option",36),c(3,"\u5168\u90E8\u9867\u5BA2"),a(),l(4,"option",37),c(5,"\u4E00\u822C\u9867\u5BA2"),a(),l(6,"option",38),c(7,"\u96EA\u8304\u6703\u54E1"),a(),l(8,"option",39),c(9,"\u80A1\u6771"),a()()(),l(10,"div",40)(11,"input",41),Z("ngModelChange",function(r){w(t);let o=v();return ee(o.searchTerm,r)||(o.searchTerm=r),T(r)}),a(),x(12,"ion-icon",42),a(),l(13,"div",43)(14,"div",44),O(15,E7,8,9,"div",45,_7,!1,b7,2,0,"p",46),a()()}if(n&2){let t=v();f(),Q("ngModel",t.categoryFilter),f(10),Q("ngModel",t.searchTerm),f(4),L(t.filteredCustomers())}}function D7(n,e){if(n&1&&(l(0,"div",60)(1,"strong",64),c(2,"\u6700\u5F8C\u7D50\u5E33\u6642\u9593"),a(),l(3,"span",58),c(4),qt(5,"date"),a()()),n&2){let t=v();f(4),E(an(5,1,t.lastCheckoutAt,"yyyy-MM-dd HH:mm"))}}function w7(n,e){if(n&1&&(l(0,"div",60)(1,"strong",64),c(2,"\u5099\u8A3B"),a(),l(3,"span",58),c(4),a()()),n&2){let t=v();f(4),E(t.note)}}function T7(n,e){if(n&1&&(l(0,"tr",68)(1,"td",66),c(2),a(),l(3,"td",66),c(4),a(),l(5,"td",69),c(6),a()()),n&2){let t=e.$implicit,i=v(3);f(2),E(t.date),f(2),E(i.formatSaleItems(t.items)),f(2),E(i.formatCurrency(t.total))}}function I7(n,e){if(n&1&&(l(0,"table",63)(1,"thead",65)(2,"tr")(3,"th",66),c(4,"\u65E5\u671F"),a(),l(5,"th",66),c(6,"\u54C1\u9805"),a(),l(7,"th",67),c(8,"\u7E3D\u91D1\u984D"),a()()(),l(9,"tbody"),O(10,T7,7,3,"tr",68,v7),a()()),n&2){let t=v(2);f(10),L(t.customerSales())}}function M7(n,e){n&1&&(l(0,"p",46),c(1,"\u7121\u4EA4\u6613\u7D00\u9304\u3002"),a())}function A7(n,e){if(n&1){let t=B();l(0,"div")(1,"div",21)(2,"div",51)(3,"div")(4,"h2",52),c(5),a(),l(6,"span",53),c(7),a()(),l(8,"button",54),b("click",function(){w(t);let r=v();return T(r.clearSelection())}),x(9,"ion-icon",55),a()(),l(10,"div",56)(11,"div")(12,"strong",57),c(13,"\u96FB\u8A71"),a(),l(14,"span",58),c(15),a()(),l(16,"div")(17,"strong",57),c(18,"\u6027\u5225"),a(),l(19,"span",58),c(20),a()(),l(21,"div")(22,"strong",57),c(23,"\u751F\u65E5"),a(),l(24,"span",58),c(25),a()(),l(26,"div")(27,"strong",57),c(28,"\u51FA\u751F\u5E74\u4EFD"),a(),l(29,"span",58),c(30),a()(),l(31,"div")(32,"strong",57),c(33,"\u7A4D\u5206\u9EDE\u6578"),a(),l(34,"span",59),c(35),a()(),l(36,"div")(37,"strong",57),c(38,"\u539F\u59CB\u9580\u5E97"),a(),l(39,"span",58),c(40),a()()(),A(41,D7,6,4,"div",60),A(42,w7,5,1,"div",60),a(),l(43,"div",61)(44,"h3",16),c(45,"\u4EA4\u6613\u6B77\u53F2"),a(),l(46,"div",62),A(47,I7,12,0,"table",63)(48,M7,2,0,"p",46),a()()()}if(n&2){let t=e,i=v();f(5),E(i.getCleanCustomerName(t)),f(),De(i.getCustomerTypeClass(t)),f(),E(i.getCustomerType(t)),f(8),E(t.phone||"-"),f(5),E(t.gender||"-"),f(5),E(t.birthday||"-"),f(5),E(t.birthYear||"-"),f(5),V("",t.loyaltyPoints||0," \u9EDE"),f(5),E(t.originStore||"-"),f(),N(t.lastCheckoutAt?41:-1),f(),N(t.note?42:-1),f(5),N(i.customerSales().length>0?47:48)}}function N7(n,e){n&1&&(l(0,"div",20)(1,"div",70),x(2,"ion-icon",71),l(3,"p",72),c(4,"\u8ACB\u5F9E\u5DE6\u5074\u9078\u64C7\u4E00\u4F4D\u9867\u5BA2\u4EE5\u67E5\u770B\u8A73\u7D30\u8CC7\u8A0A\u3002"),a()()())}function R7(n,e){n&1&&x(0,"div",27)}function F7(n,e){n&1&&(l(0,"p",28),c(1,"\u9EDE\u64CA\u6309\u9215\u4EE5\u5C0D\u5168\u9AD4\u9867\u5BA2\u7684 POS \u6578\u64DA\u904B\u884C AI \u8CFC\u7269\u7C43\u5206\u6790\u3002"),a())}function P7(n,e){n&1&&(l(0,"p",29),c(1,"AI \u6B63\u5728\u5206\u6790\u4EA4\u6613\u7D00\u9304..."),a())}function k7(n,e){if(n&1&&(l(0,"div",30)(1,"p",33),c(2,"\u767C\u751F\u932F\u8AA4"),a(),l(3,"p"),c(4),a()()),n&2){let t=v();f(4),E(t.geminiService.basketAnalysisError())}}function V7(n,e){if(n&1&&(l(0,"div",75)(1,"p",77),c(2),a(),l(3,"p",78)(4,"span",79),c(5,"\u5EFA\u8B70\uFF1A"),a(),c(6),a()()),n&2){let t=e.$implicit;f(2),E(t.items.join(" + ")),f(4),V(" ",t.suggestion)}}function O7(n,e){n&1&&(l(0,"p",28),c(1,"\u672A\u627E\u5230\u986F\u8457\u7684\u5546\u54C1\u7D44\u5408\u3002"),a())}function L7(n,e){if(n&1&&(l(0,"li"),c(1),a()),n&2){let t=e.$implicit;f(),E(t)}}function B7(n,e){if(n&1&&(l(0,"div",73)(1,"div")(2,"h4",74),c(3,"\u7D93\u5E38\u4E00\u8D77\u8CFC\u8CB7\u7684\u5546\u54C1"),a(),O(4,V7,7,2,"div",75,bn,!1,O7,2,0,"p",28),a(),l(7,"div")(8,"h4",74),c(9,"\u9867\u5BA2\u884C\u70BA\u6D1E\u5BDF"),a(),l(10,"ul",76),O(11,L7,2,1,"li",null,bn),a()()()),n&2){let t=e;f(4),L(t.frequently_bought_together),f(7),L(t.customer_behavior_insights)}}function U7(n,e){if(n&1&&A(0,B7,13,1,"div",73),n&2){let t,i=v();N((t=i.geminiService.basketAnalysis())?0:-1,t)}}var Vs=class Vs{constructor(){this.apiService=P(rt);this.geminiService=P(Jm);this.customers=S([]);this.searchTerm=S("");this.categoryFilter=S("all");this.selectedCustomer=S(null);this.customerSales=S([]);this.customerFeedback=S([]);this.isLoading=S(!1);this.errorMessage=S(null);this.filteredCustomers=H(()=>{let e=this.customers(),t=this.categoryFilter();t!=="all"&&(e=e.filter(r=>this.getCustomerCategory(r)===t));let i=this.searchTerm().toLowerCase();return i&&(e=e.filter(r=>r.name?.toLowerCase().includes(i)||r.phone?.includes(i))),e});this.customerStats=H(()=>{let e=this.customers(),t=e.length,i=e.filter(s=>this.getCustomerCategory(s)==="cigar").length,r=e.filter(s=>this.getCustomerCategory(s)==="shareholder").length,o=e.filter(s=>this.getCustomerCategory(s)==="regular").length;return{total:t,cigarCount:i,regularCount:o,shareholderCount:r}});this.loadCustomers()}async loadCustomers(){this.isLoading.set(!0),this.errorMessage.set(null);try{let e=await this.apiService.getCustomers();e.success&&e.data&&Array.isArray(e.data)?this.customers.set(e.data):this.errorMessage.set(e.error||"\u7121\u6CD5\u53D6\u5F97\u9867\u5BA2\u8CC7\u6599")}catch(e){console.error("Error loading customers:",e),this.errorMessage.set("\u8F09\u5165\u9867\u5BA2\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoading.set(!1)}}selectCustomer(e){this.selectedCustomer.set(e)}clearSelection(){this.selectedCustomer.set(null),this.customerSales.set([]),this.customerFeedback.set([])}runBasketAnalysis(){}getCustomerCategory(e){let t=e.name||"";return t.includes("\u96EA\u8304")?"cigar":t.includes("\u80A1\u6771")?"shareholder":"regular"}getCleanCustomerName(e){let t=e.name||"";return t=t.replace(/\s*/g,"").replace(/\s*/g,""),t.trim()}getCustomerTypeClass(e){switch(this.getCustomerCategory(e)){case"cigar":return"bg-purple-100 text-purple-800";case"shareholder":return"bg-yellow-100 text-yellow-800";default:return"bg-blue-100 text-blue-800"}}getCustomerType(e){switch(this.getCustomerCategory(e)){case"cigar":return"\u96EA\u8304\u6703\u54E1";case"shareholder":return"\u80A1\u6771";default:return"\u4E00\u822C\u9867\u5BA2"}}formatSaleItems(e){return e?e.map(t=>t.name).join(", "):""}formatCurrency(e){return e==null?"":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}getStars(e){return Array(e).fill(0)}getEmptyStars(e){return Array(5-e).fill(0)}};Vs.\u0275fac=function(t){return new(t||Vs)},Vs.\u0275cmp=ie({type:Vs,selectors:[["app-customer-analysis"]],decls:60,vars:11,consts:[[1,"space-y-8"],[1,"text-3xl","font-bold","text-gray-900"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-6"],[1,"bg-white","p-6","rounded-xl","shadow-md","flex","items-center","space-x-4"],[1,"bg-blue-100","p-3","rounded-full"],["name","people-outline",1,"text-2xl","text-blue-600"],[1,"text-sm","text-gray-500"],[1,"text-2xl","font-semibold","text-gray-900"],[1,"bg-green-100","p-3","rounded-full"],["name","person-outline",1,"text-2xl","text-green-600"],[1,"bg-purple-100","p-3","rounded-full"],["name","ribbon-outline",1,"text-2xl","text-purple-600"],[1,"bg-yellow-100","p-3","rounded-full"],["name","briefcase-outline",1,"text-2xl","text-yellow-600"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-8"],[1,"lg:col-span-1","bg-white","p-6","rounded-xl","shadow-md","flex","flex-col"],[1,"text-lg","font-semibold","text-gray-800","mb-4"],[1,"flex","items-center","justify-center","h-32"],[1,"bg-red-50","border","border-red-200","text-red-700","p-3","rounded-lg","mb-4","text-sm"],[1,"lg:col-span-2","space-y-8"],[1,"h-full","flex","items-center","justify-center","bg-white","p-6","rounded-xl","shadow-md"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"flex","justify-between","items-center","mb-4"],[1,"flex","items-center","space-x-3"],["name","basket-outline",1,"text-2xl","text-indigo-600"],[1,"text-lg","font-semibold","text-gray-800"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","disabled:bg-indigo-300","disabled:cursor-not-allowed","flex","items-center","space-x-2",3,"click","disabled"],[1,"w-5","h-5","border-2","border-white","border-t-transparent","rounded-full","animate-spin"],[1,"text-gray-500"],[1,"text-gray-500","animate-pulse"],[1,"bg-red-50","text-red-700","p-4","rounded-lg"],[1,"flex","flex-col","items-center","space-y-2"],[1,"w-8","h-8","border-3","border-indigo-200","border-t-indigo-600","rounded-full","animate-spin"],[1,"font-semibold"],[1,"mb-3"],[1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-50",3,"ngModelChange","ngModel"],["value","all"],["value","regular"],["value","cigar"],["value","shareholder"],[1,"relative","mb-4"],["type","text","placeholder","\u4F9D\u59D3\u540D\u6216\u96FB\u8A71\u641C\u5C0B...",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","pl-10","bg-gray-50",3,"ngModelChange","ngModel"],["name","search-outline",1,"absolute","left-3","top-1/2","-translate-y-1/2","text-gray-400"],[1,"flex-1","overflow-y-auto","-mx-2","px-2"],[1,"space-y-2"],[1,"p-3","rounded-lg","cursor-pointer","transition-colors",3,"bg-indigo-100","hover:bg-gray-100"],[1,"text-center","text-gray-500","py-4"],[1,"p-3","rounded-lg","cursor-pointer","transition-colors",3,"click"],[1,"flex","justify-between","items-center"],[1,"font-medium","text-gray-800"],[1,"text-xs","font-semibold","px-2","py-1","rounded-full"],[1,"flex","justify-between","items-start"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-sm","font-semibold","px-2","py-1","rounded-full","mt-1","inline-block"],[1,"text-gray-500","hover:text-gray-700",3,"click"],["name","close-circle-outline",1,"text-2xl"],[1,"mt-4","grid","grid-cols-2","md:grid-cols-3","gap-4","text-sm","border-t","pt-4"],[1,"block","text-gray-500"],[1,"text-gray-800"],[1,"text-gray-800","font-bold"],[1,"mt-4","pt-4","border-t","text-sm"],[1,"bg-white","p-6","rounded-xl","shadow-md","mt-8"],[1,"overflow-x-auto","max-h-60"],[1,"w-full","text-sm","text-left","text-gray-500"],[1,"block","text-gray-500","mb-1"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50","sticky","top-0"],[1,"px-4","py-2"],[1,"px-4","py-2","text-right"],[1,"bg-white","border-b","hover:bg-gray-50"],[1,"px-4","py-2","text-right","font-medium"],[1,"text-center"],["name","person-add-outline",1,"text-5xl","text-gray-400"],[1,"mt-2","text-gray-500"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6","text-sm"],[1,"font-semibold","text-gray-800","mb-2"],[1,"bg-indigo-50","p-4","rounded-lg","mb-4"],[1,"list-disc","list-inside","space-y-2","text-gray-600","bg-gray-50","p-4","rounded-lg"],[1,"font-semibold","text-indigo-800"],[1,"text-indigo-700","mt-1"],[1,"font-medium"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"h1",1),c(2,"\u9867\u5BA2\u7BA1\u7406"),a(),l(3,"div",2)(4,"div",3)(5,"div",4),x(6,"ion-icon",5),a(),l(7,"div")(8,"p",6),c(9,"\u7E3D\u9867\u5BA2\u6578"),a(),l(10,"p",7),c(11),a()()(),l(12,"div",3)(13,"div",8),x(14,"ion-icon",9),a(),l(15,"div")(16,"p",6),c(17,"\u4E00\u822C\u9867\u5BA2"),a(),l(18,"p",7),c(19),a()()(),l(20,"div",3)(21,"div",10),x(22,"ion-icon",11),a(),l(23,"div")(24,"p",6),c(25,"\u96EA\u8304\u6703\u54E1"),a(),l(26,"p",7),c(27),a()()(),l(28,"div",3)(29,"div",12),x(30,"ion-icon",13),a(),l(31,"div")(32,"p",6),c(33,"\u80A1\u6771"),a(),l(34,"p",7),c(35),a()()()(),l(36,"div",14)(37,"div",15)(38,"h3",16),c(39,"\u9867\u5BA2\u5217\u8868"),a(),A(40,C7,5,0,"div",17),A(41,x7,5,1,"div",18),A(42,S7,18,3),a(),l(43,"div",19),A(44,A7,49,13,"div")(45,N7,5,0,"div",20),a()(),l(46,"div",21)(47,"div",22)(48,"div",23),x(49,"ion-icon",24),l(50,"h3",25),c(51,"\u9867\u5BA2\u884C\u70BA\u5206\u6790 (\u6574\u9AD4)"),a()(),l(52,"button",26),b("click",function(){return i.runBasketAnalysis()}),A(53,R7,1,0,"div",27),l(54,"span"),c(55,"\u5206\u6790\u8CFC\u7269\u7C43"),a()()(),A(56,F7,2,0,"p",28)(57,P7,2,0,"p",29)(58,k7,5,1,"div",30)(59,U7,1,1),a()()),t&2){let r,o;f(11),E(i.customerStats().total),f(8),E(i.customerStats().regularCount),f(8),E(i.customerStats().cigarCount),f(8),E(i.customerStats().shareholderCount),f(5),N(i.isLoading()?40:-1),f(),N(i.errorMessage()?41:-1),f(),N(i.isLoading()?-1:42),f(2),N((r=i.selectedCustomer())?44:45,r),f(8),M("disabled",i.geminiService.basketAnalysisState()==="loading"),f(),N(i.geminiService.basketAnalysisState()==="loading"?53:-1),f(3),N((o=i.geminiService.basketAnalysisState())==="idle"?56:o==="loading"?57:o==="error"?58:o==="success"?59:-1)}},dependencies:[re,be,ke,Ve,Ce,Ae,me,Ie,eo],encapsulation:2,changeDetection:0});var Km=Vs;var ho=class ho{constructor(){this.mockTargetGoals=S([{id:"TG001",title:"\u516B\u6708\u7E3D\u71DF\u6536\u76EE\u6A19",type:"\u71DF\u6536",targetValue:35e4,currentValue:289190,startDate:"2024-08-01",endDate:"2024-08-31",status:"\u9032\u884C\u4E2D",unit:"\u5143",assigneeId:"USR002",period:"monthly"},{id:"TG002",title:"\u5341\u6708\u6D3B\u52D5\u5834\u6B21",type:"\u6D3B\u52D5",targetValue:15,currentValue:13,startDate:"2024-10-01",endDate:"2024-10-31",status:"\u9032\u884C\u4E2D",unit:"\u5834",assigneeId:"USR003",period:"monthly"},{id:"TG003",title:"\u7B2C\u4E09\u5B63 VIP \u9867\u5BA2\u589E\u9577",type:"\u9867\u5BA2",targetValue:10,currentValue:12,startDate:"2024-07-01",endDate:"2024-09-30",status:"\u5DF2\u9054\u6210",unit:"\u4EBA",assigneeId:"USR003",period:"monthly"},{id:"TG004",title:"\u7B2C\u56DB\u5B63\u9867\u5BA2\u6EFF\u610F\u5EA6\u63D0\u5347",type:"\u9867\u5BA2",targetValue:5,currentValue:4,startDate:"2024-10-01",endDate:"2024-12-31",status:"\u9032\u884C\u4E2D",unit:"\u5206",period:"monthly"},{id:"TG005",title:"2024\u5E74\u5E74\u5EA6\u7E3D\u71DF\u6536",type:"\u71DF\u6536",targetValue:4e6,currentValue:285e4,startDate:"2024-01-01",endDate:"2024-12-31",status:"\u9032\u884C\u4E2D",unit:"\u5143",period:"yearly"},{id:"TG006",title:"2024\u5E74\u7E3D\u6D3B\u52D5\u5834\u6B21",type:"\u6D3B\u52D5",targetValue:100,currentValue:85,startDate:"2024-01-01",endDate:"2024-12-31",status:"\u9032\u884C\u4E2D",unit:"\u5834",assigneeId:"USR003",period:"yearly"}]);this.mockEvents=S([{id:"EVT001",type:"\u5BB4\u5BA2",status:"active",date:"2024-10-03",name:"\u52DE\u502B\u65AF",attendees:"10~15",estimatedRevenue:19e3,actualRevenue:20980,notes:"\u9152\u5546\u8CBB: 9600/\u9910\u9EDE: \u4EBA600"},{id:"EVT002",type:"\u76AE\u5361",status:"active",date:"2024-10-04",time:"14:30~18:30",name:"\u5361\u724C",attendees:"10~15",estimatedRevenue:8e3,actualRevenue:8540},{id:"EVT003",type:"\u5546\u52D9\u3001\u5E97\u5167",status:"active",date:"2024-10-07",name:"\u6F2B\u9727",attendees:"6",estimatedRevenue:4200,actualRevenue:4900,notes:"\u662F\u5426\u8ABF\u6574"},{id:"EVT004",type:"\u5BB4\u5BA2",status:"active",date:"2024-10-13",name:"Dave",attendees:"8~10",estimatedRevenue:15e3,actualRevenue:24080,notes:"8000/\u4E2D\u5F0F"},{id:"EVT005",type:"\u76AE\u5361",status:"active",date:"2024-10-14",time:"14:30~18:00",name:"TCBA",organizer:"\u76AE\u5361",attendees:"8",estimatedRevenue:4e3,actualRevenue:4e3,notes:"\u4EBA/530"},{id:"EVT006",type:"\u5E97\u5167",status:"cancelled",date:"2024-10-17",name:"\u70C8\u9152\u54C1\u9152\u6703",attendees:"0",estimatedRevenue:0,actualRevenue:0},{id:"EVT007",type:"\u7DAD\u7DB8",status:"active",date:"2024-10-18",time:"\u665A\u4E0A18:00\u5F8C",name:"slp\u5275\u696D\u5B78\u9662",attendees:"70",estimatedRevenue:7e4,deposit:21e3,actualRevenue:77640,notes:"\u8A02\u91D1\u5DF2\u6536"},{id:"EVT008",type:"\u7D05\u767D\u806F\u8ABC",status:"active",date:"2024-10-19",time:"14:00~17:00",name:"\u5C0F\u745C",attendees:"7",estimatedRevenue:36e3,actualRevenue:7e3,notes:"\u9152\u5546\u8CBB: 12000~14000/\u4EBA\u6578: \u7537\u5973\u5C0D\u534A \u5C0F\u745C\u62BD500\u5143/\u4EBA"},{id:"EVT009",type:"\u5E97\u5167",status:"active",date:"2024-10-22",name:"\u7D05\u767D\u9152\u54C1\u6703",attendees:"4",estimatedRevenue:15e3,actualRevenue:6e3,notes:"\u9152\u5546\u8CBB: 12000 \u8CBB\u7528: 1,500\u5143/\u4EBA 4\u96BB\u9152/\u642D\u914D\u98A8\u5473\u98DF\u7269"},{id:"EVT010",type:"\u6D3B\u52D5",status:"cancelled",date:"2024-10-23",time:"19:00~22:00",name:"Scott",organizer:"Scott",attendees:"0",estimatedRevenue:0,actualRevenue:0,notes:"1\u4EBA/400"},{id:"EVT011",type:"\u7DAD\u7DB8",status:"active",date:"2024-10-25",time:"\u665A\u4E0A18:00\u5F8C",name:"slp\u5275\u696D\u5B78\u9662",attendees:"55",estimatedRevenue:7e4,deposit:21e3,actualRevenue:74010,notes:"\u8A02\u91D1\u5DF2\u6536"},{id:"EVT012",type:"Laurence",status:"active",date:"2024-10-26",time:"\u4E0B\u5348\u958B\u5E55",name:"\u516C\u53F8\u958B\u5E55",attendees:"30",estimatedRevenue:1e4,actualRevenue:1e4},{id:"EVT013",type:"\u80A1\u6771\u6703",status:"active",date:"2024-10-28",name:"\u80A1\u6771\u6703",attendees:"5",estimatedRevenue:0,actualRevenue:0},{id:"EVT014",type:"\u5BA2\u6236",status:"active",date:"2024-10-29",name:"Connyn",attendees:"20~25",estimatedRevenue:15e3,actualRevenue:15e3,notes:"\u83DC: 15000"},{id:"EVT015",type:"\u76AE\u5361",status:"active",date:"2024-10-30",time:"\u665A\u4E0A18:00\u5F8C",name:"\u5361\u724C",organizer:"\u76AE\u5361",attendees:"8",estimatedRevenue:4e3,actualRevenue:12890},{id:"EVT016",type:"\u5E97\u5167",status:"active",date:"2024-10-31",name:"\u6F2B\u9727",attendees:"6",estimatedRevenue:8400,actualRevenue:4900},{id:"EVT017",type:"\u5546\u52D9",status:"active",date:"2024-08-01",name:"\u6F2B\u9727",attendees:"20",estimatedRevenue:2e4,actualRevenue:21450},{id:"EVT018",type:"\u79C1\u4EBA",status:"active",date:"2024-08-09",name:"\u555F\u5E06",attendees:"5",estimatedRevenue:2e3,actualRevenue:1900},{id:"EVT019",type:"\u79C1\u4EBA",status:"active",date:"2024-08-13",name:"\u555F\u5E06",attendees:"10",estimatedRevenue:0,actualRevenue:0},{id:"EVT020",type:"\u5BB4\u5BA2",status:"active",date:"2024-08-14",name:"vic / jackle",attendees:"15",estimatedRevenue:18e3,actualRevenue:2e4},{id:"EVT021",type:"\u5546\u52D9",status:"active",date:"2024-08-22",name:"\u6F2B\u9727",attendees:"12",estimatedRevenue:1e4,actualRevenue:10155},{id:"EVT022",type:"\u79C1\u4EBA",status:"active",date:"2024-08-27",name:"\u555F\u5E06",attendees:"8",estimatedRevenue:8e3,actualRevenue:9300},{id:"EVT023",type:"\u54C1\u9152\u6703",status:"active",date:"2024-08-28",name:"\u5167\u90E8\u54C1\u9152",attendees:"10",estimatedRevenue:1e4,actualRevenue:10700}]);this.mockDailyRevenue=S([{date:"2024-08-01",nonEventRevenue:10520,isDayOff:!1},{date:"2024-08-02",nonEventRevenue:3340,isDayOff:!1},{date:"2024-08-03",nonEventRevenue:970,isDayOff:!1},{date:"2024-08-04",nonEventRevenue:0,isDayOff:!0},{date:"2024-08-05",nonEventRevenue:200,isDayOff:!1},{date:"2024-08-06",nonEventRevenue:0,isDayOff:!1},{date:"2024-08-07",nonEventRevenue:0,isDayOff:!1},{date:"2024-08-08",nonEventRevenue:17950,isDayOff:!1},{date:"2024-08-09",nonEventRevenue:6800,isDayOff:!1},{date:"2024-08-10",nonEventRevenue:8410,isDayOff:!1},{date:"2024-08-11",nonEventRevenue:0,isDayOff:!0},{date:"2024-08-12",nonEventRevenue:8970,isDayOff:!1},{date:"2024-08-13",nonEventRevenue:14900,isDayOff:!1},{date:"2024-08-14",nonEventRevenue:14130,isDayOff:!1},{date:"2024-08-15",nonEventRevenue:23630,isDayOff:!1},{date:"2024-08-16",nonEventRevenue:10740,isDayOff:!1},{date:"2024-08-17",nonEventRevenue:6090,isDayOff:!1},{date:"2024-08-18",nonEventRevenue:0,isDayOff:!0},{date:"2024-08-19",nonEventRevenue:7500,isDayOff:!1},{date:"2024-08-20",nonEventRevenue:1860,isDayOff:!1},{date:"2024-08-21",nonEventRevenue:700,isDayOff:!1},{date:"2024-08-22",nonEventRevenue:-845,isDayOff:!1},{date:"2024-08-23",nonEventRevenue:36100,isDayOff:!1},{date:"2024-08-24",nonEventRevenue:3140,isDayOff:!1},{date:"2024-08-25",nonEventRevenue:0,isDayOff:!0},{date:"2024-08-26",nonEventRevenue:2180,isDayOff:!1},{date:"2024-08-27",nonEventRevenue:4720,isDayOff:!1},{date:"2024-08-28",nonEventRevenue:17600,isDayOff:!1},{date:"2024-08-29",nonEventRevenue:18560,isDayOff:!1},{date:"2024-08-30",nonEventRevenue:11500,isDayOff:!1},{date:"2024-08-31",nonEventRevenue:4850,isDayOff:!1}]);this.mockEmployees=S([{id:"EMP001",name:"\u738B\u5C0F\u660E",type:"full-time",monthlySalary:55e3},{id:"EMP002",name:"\u9673\u7F8E\u9E97",type:"full-time",monthlySalary:62e3},{id:"EMP003",name:"\u674E\u5927\u885B",type:"part-time",hourlyRate:200},{id:"EMP004",name:"\u5F35\u4F73\u73B2",type:"part-time",hourlyRate:200},{id:"EMP005",name:"\u9EC3\u5FD7\u5F37",type:"part-time",hourlyRate:200}]);this.mockPunchRecords=S([{employeeId:"EMP003",date:"2024-08-01",clockIn:"10:00",clockOut:"18:30",isDoublePay:!1},{employeeId:"EMP003",date:"2024-08-02",clockIn:"10:05",clockOut:"17:55",isDoublePay:!1},{employeeId:"EMP003",date:"2024-08-05",clockIn:"14:00",clockOut:"22:15",isDoublePay:!1},{employeeId:"EMP003",date:"2024-08-06",clockIn:"13:58",clockOut:"22:05",isDoublePay:!1},{employeeId:"EMP003",date:"2024-08-08",clockIn:"10:00",clockOut:"14:00",isDoublePay:!1},{employeeId:"EMP003",date:"2024-08-09",clockIn:"09:55",clockOut:"18:00",isDoublePay:!0},{employeeId:"EMP003",date:"2024-08-12",clockIn:"10:00",clockOut:"18:00",isDoublePay:!1},{employeeId:"EMP003",date:"2024-08-13",clockIn:"10:00",clockOut:"18:00",isDoublePay:!1},{employeeId:"EMP003",date:"2024-08-15",clockIn:"10:00",clockOut:null,isDoublePay:!1},{employeeId:"EMP003",date:"2024-08-16",clockIn:"14:00",clockOut:"22:00",isDoublePay:!1},{employeeId:"EMP004",date:"2024-08-01",clockIn:"18:00",clockOut:"22:00",isDoublePay:!1},{employeeId:"EMP004",date:"2024-08-03",clockIn:"18:00",clockOut:"22:30",isDoublePay:!1},{employeeId:"EMP004",date:"2024-08-07",clockIn:"17:55",clockOut:"22:01",isDoublePay:!1},{employeeId:"EMP004",date:"2024-08-10",clockIn:"17:30",clockOut:"22:30",isDoublePay:!1},{employeeId:"EMP004",date:"2024-08-14",clockIn:"18:00",clockOut:"22:00",isDoublePay:!1},{employeeId:"EMP004",date:"2024-08-17",clockIn:"18:00",clockOut:"22:00",isDoublePay:!1},{employeeId:"EMP005",date:"2024-08-20",clockIn:"12:00",clockOut:"20:00",isDoublePay:!1},{employeeId:"EMP005",date:"2024-08-21",clockIn:"12:05",clockOut:"20:08",isDoublePay:!1},{employeeId:"EMP005",date:"2024-08-22",clockIn:null,clockOut:"20:00",isDoublePay:!1},{employeeId:"EMP005",date:"2024-08-24",clockIn:"11:58",clockOut:"20:03",isDoublePay:!1}]);this.mockTransactions=S([{id:"TXN001",date:"2025-12-16",item:"\u8CA0\u50B5",category:"\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8",amount:-66350,approved:!0},{id:"TXN002",date:"2025-12-17",item:"\u71DF\u696D\u6536\u5165",category:"-\u92B7\u6216\u6298\u8B93",amount:0,approved:!0},{id:"TXN003",date:"2025-12-17",item:"\u71DF\u696D\u6536\u5165",category:"\u92B7\u8CA8\u6536\u5165",amount:1150,approved:!1},{id:"TXN004",date:"2025-12-17",item:"\u8CC7\u7522",category:"\u71DF\u696D\u8A2D\u5099",amount:-295,vendorName:"\u8766\u76AE",description:"\u53EF\u9E97\u9732\u70E4\u76E4",approved:!0},{id:"TXN005",date:"2025-12-18",item:"\u71DF\u696D\u6536\u5165",category:"-\u92B7\u6216\u6298\u8B93",amount:-2862,approved:!0},{id:"TXN006",date:"2025-12-18",item:"\u71DF\u696D\u6536\u5165",category:"\u92B7\u8CA8\u6536\u5165",amount:17440,approved:!0},{id:"TXN007",date:"2025-12-19",item:"\u71DF\u696D\u6536\u5165",category:"-\u92B7\u6216\u6298\u8B93",amount:-191,approved:!0},{id:"TXN008",date:"2025-12-19",item:"\u71DF\u696D\u8CBB\u7528",category:"\u6587\u5177\u7528\u54C1",amount:-100,vendorTaxId:"14713177",vendorName:"\u91D1\u5409\u523B\u5370\u884C",approved:!0},{id:"TXN009",date:"2025-12-19",item:"\u71DF\u696D\u8CBB\u7528",category:"\u6587\u5177\u7528\u54C1",amount:-7,invoiceNumber:"VF-79457330",vendorTaxId:"90113315",vendorName:"\u5168\u65B9\u4F4D\u6578\u4F4D\u8F38\u51FA\u6709\u9650\u516C\u53F8\u5357\u4EAC\u6771\u8DEF\u5206\u516C\u53F8",approved:!0},{id:"TXN010",date:"2025-12-19",item:"\u71DF\u696D\u8CBB\u7528",category:"\u6587\u5177\u7528\u54C1",amount:-114,invoiceNumber:"UB-05014356",vendorTaxId:"97616452",vendorName:"\u5168\u806F\u798F\u5229\u4E2D\u5FC3",approved:!1},{id:"TXN011",date:"2025-12-19",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9152\u6C34",amount:-5580,vendorName:"\u6DFB\u6F64\u6D0B\u884C",approved:!0},{id:"TXN012",date:"2025-12-19",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-189,invoiceNumber:"12170425",vendorName:"\u89AA\u6C11\u98DF\u54C1\u6709\u9650\u516C\u53F8",approved:!0},{id:"TXN013",date:"2025-12-19",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-427,vendorName:"\u6D0B\u83EF\u9BAE\u98DF\u5BE6\u696D\u6709\u9650\u516C\u53F8",approved:!0},{id:"TXN014",date:"2025-12-19",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-280,invoiceNumber:"UK88724800",vendorName:"\u958B\u5143\u98DF\u54C1\u5DE5\u696D\u80A1\u4EFD\u6709\u9650\u516C\u53F8",approved:!0},{id:"TXN015",date:"2025-12-19",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-45,invoiceNumber:"111412191194",vendorTaxId:"79997612",vendorName:"\u570B\u8C50\u5546\u884C\u6709\u9650\u516C\u53F8",approved:!0},{id:"TXN016",date:"2025-12-19",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-1874,vendorTaxId:"79997612",vendorName:"\u570B\u8C50\u5546\u884C\u6709\u9650\u516C\u53F8",approved:!0},{id:"TXN017",date:"2025-12-19",item:"\u71DF\u696D\u6536\u5165",category:"\u92B7\u8CA8\u6536\u5165",amount:9280,approved:!0},{id:"TXN018",date:"2025-12-20",item:"\u71DF\u696D\u6536\u5165",category:"-\u92B7\u6216\u6298\u8B93",amount:-4349,approved:!1},{id:"TXN019",date:"2025-12-20",item:"\u71DF\u696D\u8CBB\u7528",category:"\u6587\u5177\u7528\u54C1",amount:-240,vendorTaxId:"93138304",vendorName:"\u798F\u5BF6\u523B\u5370\u884C",approved:!0},{id:"TXN020",date:"2025-12-20",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-72,invoiceNumber:"UB-05015759",vendorTaxId:"97616452",vendorName:"\u5168\u806F\u798F\u5229\u4E2D\u5FC3",approved:!0},{id:"TXN021",date:"2025-12-20",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-568,invoiceNumber:"UB-05015750",vendorTaxId:"97616452",vendorName:"\u5168\u806F\u798F\u5229\u4E2D\u5FC3",approved:!0},{id:"TXN022",date:"2025-12-20",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-160,vendorName:"\u5E02\u5834",approved:!0},{id:"TXN023",date:"2025-12-20",item:"\u71DF\u696D\u8CBB\u7528",category:"\u62DC\u62DC\u8CBB\u7528",amount:-198,invoiceNumber:"UN-74686337",vendorTaxId:"28983777",vendorName:"7-ELEVEN",approved:!0},{id:"TXN024",date:"2025-12-20",item:"\u71DF\u696D\u6536\u5165",category:"\u92B7\u8CA8\u6536\u5165",amount:25310,approved:!0},{id:"TXN025",date:"2025-12-21",item:"\u71DF\u696D\u6536\u5165",category:"-\u92B7\u6216\u6298\u8B93",amount:-1612,approved:!0},{id:"TXN026",date:"2025-12-21",item:"\u71DF\u696D\u6536\u5165",category:"\u92B7\u8CA8\u6536\u5165",amount:14660,approved:!0},{id:"TXN027",date:"2025-12-22",item:"\u71DF\u696D\u8CBB\u7528",category:"\u8CB8\u6B3E\u5229\u606F",amount:-3824,approved:!0},{id:"TXN028",date:"2025-12-22",item:"\u71DF\u696D\u6536\u5165",category:"-\u92B7\u6216\u6298\u8B93",amount:0,approved:!0},{id:"TXN029",date:"2025-12-23",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-2020,invoiceNumber:"SO1412221261",vendorTaxId:"22161107",vendorName:"\u9F0E\u8000\u98DF\u54C1\u80A1\u4EFD\u6709\u9650\u516C\u53F8",approved:!0},{id:"TXN030",date:"2025-12-23",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-36,invoiceNumber:"UB-15207729",vendorTaxId:"97616452",vendorName:"\u5168\u806F\u798F\u5229\u4E2D\u5FC3",approved:!1},{id:"TXN031",date:"2025-12-23",item:"\u8CC7\u7522",category:"\u5B58\u8CA8-\u9910\u98F2",amount:-150,invoiceNumber:"UB-15209268",vendorTaxId:"97616452",vendorName:"\u5168\u806F\u798F\u5229\u4E2D\u5FC3",approved:!0},{id:"TXN032",date:"2025-12-23",item:"\u71DF\u696D\u6536\u5165",category:"\u92B7\u8CA8\u6536\u5165",amount:2650,approved:!0}]);this.mockVendors=S([{id:"V001",category:"\u98DF\u6750",name:"\u570B\u8C50",contactInfo:"\u696D\u52D9line @926yleos",restDays:"\u516D\u3001\u65E5",taxId:"79997612"},{id:"V002",category:"\u98DF\u6750",name:"\u570B\u6210",contactInfo:"(02)8671-9056",restDays:"\u516D\u3001\u65E5"},{id:"V003",category:"\u5976\u88FD/\u96DE\u7FC5",name:"\u958B\u5143",contactInfo:"\u696D\u52D9 MR.\u8F9C 0916-250-990",restDays:"\u516D\u3001\u65E5",taxId:"UK88724800"},{id:"V004",category:"\u51B0\u6DC7\u6DCB",name:"\u5408\u7A40",contactInfo:"(03)3578-130",restDays:"\u516D\u3001\u65E5"},{id:"V005",category:"\u53EF\u980C",name:"\u89AA\u6C11",contactInfo:"(02)2999-9381",restDays:"\u516D\u3001\u65E5"},{id:"V006",category:"\u8C9D\u679C",name:"\u5E03\u6717\u4E3B\u5EDA",contactInfo:"\u696D\u52D9line @928ebhwu",restDays:"\u516D\u3001\u65E5"},{id:"V007",category:"\u86CB\u7CD5",name:"\u897F\u9EDE\u5C0F\u8216",contactInfo:"\u7DB2\u9801\u4E0B\u55AE, (02)2995-0596",restDays:"\u4E8C\u3001\u4E09\u3001\u56DB\u3001\u516D\u3001\u65E5"},{id:"V008",category:"\u9152",name:"\u5229\u591A\u5409",contactInfo:"Line",restDays:"\u65E5\u3001\u4E00"},{id:"V009",category:"\u9152",name:"\u4E5D\u6A3D",contactInfo:"(02)7728-6670",restDays:"\u516D\u3001\u65E5"},{id:"V010",category:"\u9152",name:"\u9152\u9F0E",contactInfo:"(02)2578-1515",restDays:"\u516D\u3001\u65E5"},{id:"V011",category:"\u8017\u6750",name:"\u6613\u9054\u8C50",contactInfo:"\u696D\u52D9line 0926077730",restDays:"-"},{id:"V012",category:"\u5236\u670D",name:"\u570B\u8C6A",contactInfo:"\u738B\u5730\u7FA9 0932-036356",restDays:"-"},{id:"V013",category:"\u65B9\u51B0\u584A",name:"\u5FEB\u6A02\u51B0\u584A",contactInfo:"0932-357-696",restDays:"-"},{id:"V014",category:"\u83DC\u5546",name:"\u6D25\u83EF",contactInfo:"(02)2307-5255",restDays:"-"},{id:"V015",category:"\u6536\u5EE2\u6CB9",name:"\u5C24\u52A0\u5229",contactInfo:"0909-511-256 \u6797\u5955\u9716 02-8287 5522",restDays:"\u4E8C\u4E09\u56DB\u516D\u65E5"},{id:"V016",category:"\u6536\u5EE2\u6CB9",name:"\u6C38\u745E",contactInfo:"07-6161-580 \u8521\u4F73\u6210 0965-659-532",restDays:"\u9808\u63D0\u524D\u5B89\u6392"},{id:"V017",category:"\u725B\u8C6C\u8089",name:"\u7F8E\u798F",contactInfo:"(02)8791-9688",restDays:"\u516D\u3001\u65E5, \u5207\u8089\u52A01\u5929"},{id:"V018",category:"\u5496\u5561\u8C46",name:"\u4E0A\u7FA4",contactInfo:"(02)2504-2715",restDays:"\u516D\u3001\u65E5"},{id:"V019",category:"\u6D77\u9BAE",name:"\u81FB\u7FD4",contactInfo:"(02)2223-9647",restDays:"\u65E5\u3001\u4E00"},{id:"V020",category:"\u74E6\u65AF",name:"\u9806\u5B89",contactInfo:"(02)2765-7778",restDays:"-"},{id:"V021",category:"\u5E03",name:"\u69AE\u51A0\u5462\u7D68",contactInfo:"022556-6668 \u5468\u69AE\u4E7E 0931-337-876",restDays:"-"},{id:"V022",category:"\u98DF\u6750",name:"\u9F0E\u8000",contactInfo:"APP\u4E0B\u55AE, (02) 2910-6111",restDays:"\u65E5",taxId:"22161107"},{id:"V023",category:"\u9152",name:"\u5C1A\u5FB7",contactInfo:"Line",restDays:"\u516D\u3001\u65E5"},{id:"V024",category:"\u98DF\u6750",name:"COSTCO",contactInfo:"\u81EA\u884C\u63A1\u8CB7",restDays:"-"}]);this.mockPurchaseOrders=S([{id:"PO001",poNumber:"PO-2024-001",vendorId:"V001",date:"2024-08-05",items:[{productName:"\u7279\u7D1A\u521D\u69A8\u6A44\u6B16\u6CB9",quantity:10,unitPrice:350,total:3500},{productName:"\u7FA9\u5927\u5229\u9EB5",quantity:20,unitPrice:80,total:1600}],totalAmount:5100},{id:"PO002",poNumber:"PO-2024-002",vendorId:"V009",date:"2024-08-10",items:[{productName:"\u6CE2\u723E\u591A\u7D05\u9152",quantity:12,unitPrice:800,total:9600},{productName:"\u590F\u5E03\u5229\u767D\u9152",quantity:6,unitPrice:950,total:5700}],totalAmount:15300},{id:"PO003",poNumber:"PO-2024-003",vendorId:"V017",date:"2024-08-12",items:[{productName:"\u7F8E\u570B Prime \u7D1A\u808B\u773C\u725B\u6392",quantity:5,unitPrice:1200,total:6e3}],totalAmount:6e3}]);this.mockProductCosts=S([{id:"PC001",productId:"LIQ-001",productName:"\u544A\u767D",vendorId:"V023",category:"\u9152\u6C34",itemQuantity:700,itemUnit:"ml",totalUnit:"\u74F6",price:280},{id:"PC002",productId:"LIQ-002",productName:"\u73AB\u7470\u5564\u9152",vendorId:"V023",category:"\u9152\u6C34",itemQuantity:700,itemUnit:"ml",totalUnit:"\u74F6",price:420},{id:"PC003",productId:"LIQ-003",productName:"\u6A59\u9152",vendorId:"V023",category:"\u9152\u6C34",itemQuantity:700,itemUnit:"ml",totalUnit:"\u74F6",price:520},{id:"PC004",productId:"LIQ-004",productName:"\u91D1\u8CD3\u5A01\u58EB\u5FCC",vendorId:"V023",category:"\u9152\u6C34",itemQuantity:700,itemUnit:"ml",totalUnit:"\u74F6",price:330},{id:"PC005",productId:"LIQ-005",productName:"\u7259\u8CB7\u52A0\u9EA5\u65AF\u8FA3\u59C6\u9152",vendorId:"V023",category:"\u9152\u6C34",itemQuantity:1e3,itemUnit:"ml",totalUnit:"\u74F6",price:420},{id:"PC006",productId:"LIQ-006",productName:"\u99AC\u4E01\u5C3C\u767D\u9999\u827E\u9152",vendorId:"V023",category:"\u9152\u6C34",itemQuantity:750,itemUnit:"ml",totalUnit:"\u74F6",price:420},{id:"PC007",productId:"LIQ-007",productName:"Kahkua\u5496\u5561\u5229\u53E3\u9152",vendorId:"V023",category:"\u9152\u6C34",itemQuantity:750,itemUnit:"ml",totalUnit:"\u74F6",price:430},{id:"PC013",productId:"FOD-001",productName:"\u5BAE\u4FDD\u96DE\u4E01",vendorId:"V024",category:"\u98DF\u6750",itemQuantity:1200,itemUnit:"g",totalUnit:"\u5305",price:358},{id:"PC014",productId:"FOD-002",productName:"Swiss Delice 72%\u9ED1\u5DE7\u514B\u529B",vendorId:"V024",category:"\u98DF\u6750",itemQuantity:216,itemUnit:"\u9846",totalUnit:"\u5305",price:879},{id:"PC015",productId:"FOD-003",productName:"\u5805\u679C",vendorId:"V024",category:"\u98DF\u6750",itemQuantity:1070,itemUnit:"g",totalUnit:"\u7F50",price:659},{id:"PC016",productId:"LIQ-013",productName:"\u767E\u52A0\u5F97\u862D\u59C6\u9152",vendorId:"V024",category:"\u9152\u6C34",itemQuantity:1e3,itemUnit:"ml",totalUnit:"\u74F6",price:469},{id:"PC017",productId:"LIQ-014",productName:"\u7F8E\u570B\u4F0F\u7279\u52A0",vendorId:"V024",category:"\u9152\u6C34",itemQuantity:1750,itemUnit:"ml",totalUnit:"\u74F6",price:375},{id:"PC018",productId:"LIQ-015",productName:"\u79D1\u514B\u862D\u9F8D\u820C\u862D\u9152",vendorId:"V024",category:"\u9152\u6C34",itemQuantity:1750,itemUnit:"ml",totalUnit:"\u74F6",price:769},{id:"PC019",productId:"LIQ-016",productName:"\u79D1\u514B\u862D\u7434\u9152",vendorId:"V024",category:"\u9152\u6C34",itemQuantity:1750,itemUnit:"ml",totalUnit:"\u74F6",price:495},{id:"PC020",productId:"LIQ-017",productName:"\u9AD8\u767B\u7C89\u7D05\u7434\u9152",vendorId:"V024",category:"\u9152\u6C34",itemQuantity:1e3,itemUnit:"ml",totalUnit:"\u74F6",price:549}]);this.mockWineCosts=S([{id:"W01",vendor:"\u5C1A\u5FB7",productName:"\u544A\u767D",type:"\u767D\u6C23\u6CE1",cost:280,sellingPrice:1100},{id:"W02",vendor:"\u4E5D\u6A3D",productName:"Primo Amore Moscato Delle Venezie IGT \u521D\u6200",type:"\u751C\u767D",cost:450,sellingPrice:1100},{id:"W03",vendor:"\u4E5D\u6A3D",productName:"Francois Confuron Gindre Bourgogne (2020)",type:"\u767D\u9152",cost:1150,sellingPrice:2300},{id:"W04",vendor:"\u4E5D\u6A3D",productName:"Moet & Chandon",type:"\u9999\u6AB3",cost:1650,sellingPrice:3500},{id:"W05",vendor:"\u4E5D\u6A3D",productName:"McManis Cab. Sau (2022)",type:"\u7D05\u9152",cost:550,sellingPrice:1100},{id:"W06",vendor:"\u4E5D\u6A3D",productName:"Botter Cuvee16 Limited Edition Rosso Vino 16\u6A02\u7AE0",type:"\u7D05\u9152",cost:750,sellingPrice:2200},{id:"W07",vendor:"\u4E5D\u6A3D",productName:"Saint-Estephe Calon Segur \u5361\u9686\u8CFD\u683C\u4E09\u8ECD (2015)",type:"\u7D05\u9152",cost:1350,sellingPrice:3e3},{id:"W08",vendor:"\u9152\u9F0E",productName:"Adobe Reserva Sauvignon White (2018)",type:"\u767D\u9152",cost:550,sellingPrice:1600},{id:"W09",vendor:"\u9152\u9F0E",productName:"De Martino Estate Cabernet Sauvignon (2022)",type:"\u7D05\u9152",cost:480,sellingPrice:1800},{id:"W10",vendor:"\u9152\u9F0E",productName:"Adobe Reserva Sauvignon Red (2021)",type:"\u7D05\u9152",cost:550,sellingPrice:1600},{id:"W11",vendor:"\u5409\u591A\u5229",productName:"Santero Dile Moscato sweet\u5929\u4F7F\u4E4B\u624B",type:"\u767D\u6C23\u6CE1",cost:285,sellingPrice:1100},{id:"W12",vendor:"\u5409\u591A\u5229",productName:"Louis Eschenauer 24K Carat Gold Muscat Sparkling",type:"\u767D\u6C23\u6CE1",cost:520,sellingPrice:1600},{id:"W13",vendor:"\u5409\u591A\u5229",productName:"Joly de Tr\xE9buis R\xE9serve Brut Champagne",type:"\u9999\u6AB3",cost:1100,sellingPrice:2800},{id:"W14",vendor:"\u5409\u591A\u5229",productName:"Dark Horse Cabernet Sauvignon",type:"\u7D05\u9152",cost:480,sellingPrice:1450},{id:"W15",vendor:"\u5409\u591A\u5229",productName:"Domaine Viticole de la Ville de Colmar Signature de Colmar Pinot Noir",type:"\u7D05\u9152",cost:630,sellingPrice:1600},{id:"W16",vendor:"\u6DFB\u6F64",productName:"Glendronach \u683C\u862D\u591A\u7D0D12\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1150,sellingPrice:3200},{id:"W17",vendor:"\u6DFB\u6F64",productName:"Aberlour \u4E9E\u4F2F\u6A0212\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1100,sellingPrice:3200},{id:"W18",vendor:"\u6DFB\u6F64",productName:"Laphroaig \u62C9\u4F5B\u683C10\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1050,sellingPrice:3300},{id:"W19",vendor:"\u6DFB\u6F64",productName:"Fettercairn \u8CBB\u7279\u80AF12\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1050,sellingPrice:3300},{id:"W20",vendor:"\u6DFB\u6F64",productName:"Glenfiddich \u683C\u862D\u83F2\u8FEA12\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:950,sellingPrice:3500},{id:"W21",vendor:"\u6DFB\u6F64",productName:"Balvenie \u767E\u5BCC12\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1350,sellingPrice:3800},{id:"W22",vendor:"\u6DFB\u6F64",productName:"Mortlach \u6155\u8D6B12\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1350,sellingPrice:3800},{id:"W23",vendor:"\u6DFB\u6F64",productName:"Dalmore \u5927\u646912\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1396,sellingPrice:3900},{id:"W24",vendor:"\u6DFB\u6F64",productName:"Ardbeg \u96C5\u67CF10\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1350,sellingPrice:3900},{id:"W25",vendor:"\u6DFB\u6F64",productName:"Macallan \u9EA5\u5361\u502B12\u5E74",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1650,sellingPrice:4200},{id:"W26",vendor:"\u6DFB\u6F64",productName:"Hibiki \u97FF",type:"\u8ABF\u548C\u5A01\u58EB\u5FCC",cost:2300,sellingPrice:4900},{id:"W27",vendor:"\u6DFB\u6F64",productName:"Johnnie Walker \u7D04\u7FF0\u8D70\u8DEF \u9ED1\u724C 12\u5E74",type:"\u8ABF\u548C\u5A01\u58EB\u5FCC",cost:750,sellingPrice:2100},{id:"W28",vendor:"\u6DFB\u6F64",productName:"Johnnie Walker \u7D04\u7FF0\u8D70\u8DEFXR 21\u5E74",type:"\u8ABF\u548C\u5A01\u58EB\u5FCC",cost:2390,sellingPrice:4900},{id:"W29",vendor:"\u6DFB\u6F64",productName:"Royal Salute \u7687\u5BB6\u79AE\u70AE",type:"\u8ABF\u548C\u5A01\u58EB\u5FCC",cost:2500,sellingPrice:4900},{id:"W30",vendor:"\u5927\u6469",productName:"\u5927\u646915",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:2300,sellingPrice:5200},{id:"W31",vendor:"\u767E\u5BCC",productName:"\u767E\u5BCC14",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:1850,sellingPrice:4200},{id:"W32",vendor:"\u6155\u8D6B",productName:"\u6155\u8D6B16",type:"\u55AE\u4E00\u9EA5\u82BD\u5A01\u58EB\u5FCC",cost:2300,sellingPrice:4900},{id:"W33",vendor:"\u767E\u5BCC",productName:"\u767E\u9F61\u7F4830",type:"\u8ABF\u548C\u5A01\u58EB\u5FCC",cost:7800,sellingPrice:14e3}]);this.mockCigarCosts=S([{id:"C01",brand:"Allados",productName:"Robusto",size:"5*50",quantityPerBox:20,lishengCost:340,baijiaCost:370,sellingPrice:560},{id:"C02",brand:"Allados",productName:"Toro",size:"6*52",quantityPerBox:20,lishengCost:370,baijiaCost:390,sellingPrice:780},{id:"C03",brand:"Oliva",productName:"Flor De Oliva Robusto",size:"5*50",quantityPerBox:25,lishengCost:255,baijiaCost:285,sellingPrice:520},{id:"C04",brand:"Oliva",productName:"Flor De Oliva Toro",size:"6*50",quantityPerBox:25,lishengCost:270,baijiaCost:300,sellingPrice:580},{id:"C05",brand:"Oliva",productName:"Serie O Robusto",size:"5*50",quantityPerBox:20,lishengCost:375,baijiaCost:405,sellingPrice:750},{id:"C06",brand:"Oliva",productName:"Serie O Corona",size:"6*46",quantityPerBox:20,lishengCost:335,baijiaCost:365,sellingPrice:700},{id:"C07",brand:"Oliva",productName:"Serie V Lancero",size:"7*38",quantityPerBox:24,lishengCost:415,baijiaCost:430,sellingPrice:790},{id:"C08",brand:"Oliva",productName:"Serie V Belicoso",size:"5*54",quantityPerBox:24,lishengCost:415,baijiaCost:445,sellingPrice:800},{id:"C09",brand:"Oliva",productName:"Serie V DBL.Robusto",size:"5*54",quantityPerBox:24,lishengCost:450,baijiaCost:480,sellingPrice:820},{id:"C10",brand:"Oliva",productName:"Serie V DBL. Toro",size:"6*60",quantityPerBox:24,lishengCost:520,baijiaCost:550,sellingPrice:1100},{id:"C11",brand:"Oliva",productName:"Serie V Melanio Figurado",size:"6.5*52",quantityPerBox:10,lishengCost:570,baijiaCost:670,sellingPrice:1480},{id:"C12",brand:"Oliva",productName:"Serie V Melanio Toro",size:"6.5*52",quantityPerBox:10,lishengCost:690,baijiaCost:790,sellingPrice:1600},{id:"C13",brand:"Oliva",productName:"Connecticut Res.PETIT Corona",size:"4*38",quantityPerBox:30,lishengCost:270,baijiaCost:300,sellingPrice:540},{id:"C14",brand:"Oliva",productName:"Master Blender 3 Robusto",size:"5*50",quantityPerBox:20,lishengCost:440,baijiaCost:470,sellingPrice:950},{id:"C15",brand:"Oliva",productName:"Master Blender 3 Torpedo",size:"6.5*52",quantityPerBox:10,lishengCost:490,baijiaCost:520,sellingPrice:1e3},{id:"C16",brand:"Oliva",productName:"Oliva 135\u9031\u5E74\u7D00\u5FF5",size:"5.5*54",quantityPerBox:12,lishengCost:900,baijiaCost:1e3,sellingPrice:2e3},{id:"C17",brand:"Oliva",productName:"Oliva 2024\u9F8D\u5E74\u7CFB\u5217",size:"5.5*60",quantityPerBox:10,lishengCost:900,baijiaCost:1e3,sellingPrice:2e3},{id:"C18",brand:"Oliva",productName:"Serie V Melanio Torpedo",size:"6.5*52",quantityPerBox:10,lishengCost:690,baijiaCost:790,sellingPrice:1600}]);this.itemCategoryMap={\u8CC7\u7522:["\u73FE\u91D1","\u61C9\u6536\u5E33\u6B3E","\u5B58\u8CA8-\u9910\u98F2","\u5B58\u8CA8-\u9152\u6C34","\u5B58\u8CA8-\u96EA\u8304","\u88DD\u6F62","\u62BC\u91D1","\u71DF\u696D\u8A2D\u5099"],\u8CA0\u50B5:["\u61C9\u4ED8\u5E33\u6B3E","\u61C9\u4ED8\u88DD\u6F62\u6B3E","\u61C9\u4ED8\u85AA\u8CC7","\u61C9\u4ED8\u80A1\u6771\u56DE\u994B\u91D1","\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8","\u9280\u884C\u501F\u6B3E"],\u696D\u4E3B\u6B0A\u76CA:["\u8CC7\u672C","\u696D\u4E3B\u5B58\u5165","\u696D\u4E3B\u63D0\u51FA","\u672C\u671F\u640D\u76CA"],\u71DF\u696D\u6536\u5165:["\u92B7\u8CA8\u6536\u5165","\u5176\u4ED6\u6536\u5165","-\u92B7\u6216\u6298\u8B93"],\u71DF\u696D\u8CBB\u7528:["\u85AA\u8CC7\u652F\u51FA","\u5065\u4FDD\u8CBB","\u52DE\u4FDD\u8CBB","\u56DE\u994B\u91D1\u652F\u51FA","\u79DF\u91D1\u652F\u51FA","\u4FDD\u96AA\u8CBB","\u8CB8\u6B3E\u5229\u606F","\u5EDA\u623F\u6D88\u8017\u54C1","\u6587\u5177\u7528\u54C1","\u7DB2\u8DEF\u8CBB","\u96FB\u8A71\u8CBB","\u5927\u6A13\u7BA1\u7406\u8CBB","\u6703\u8A08\u8CBB\u7528","\u734E\u91D1\u652F\u51FA","\u6C34\u8CBB","\u74E6\u65AF\u8CBB","\u96FB\u8CBB","\u50AD\u91D1\u8CBB\u7528","\u8A66\u83DC\u8CBB\u7528","\u62DC\u62DC\u8CBB\u7528","pos\u6A5F\u8CBB\u7528","\u5176\u4ED6\u8CBB\u7528","\u71DF\u696D\u7A05"]};this.mockCustomers=S([{id:"C101",name:"\u6797\u5C0F\u59D0",phone:"0912-345-678",note:"VIP\u5BA2\u6236\uFF0C\u5E38\u5BA2",gender:"\u5973\u6027",birthday:"05/20",birthYear:"1990",loyaltyPoints:1250,originStore:"\u4FE1\u7FA9\u9580\u5E02",lastCheckoutAt:"2026-01-25T15:30:00Z",isDeleted:!1},{id:"C102",name:"\u9673\u5148\u751F",phone:"0987-654-321",note:"VIP\u5BA2\u6236\uFF0C\u559C\u611B\u5A01\u58EB\u5FCC",gender:"\u7537\u6027",birthday:"11/12",birthYear:"1985",loyaltyPoints:3400,originStore:"\u4FE1\u7FA9\u9580\u5E02",lastCheckoutAt:"2026-01-23T18:45:00Z",isDeleted:!1},{id:"C103",name:"\u9EC3\u5148\u751F",phone:"0928-111-222",note:"\u559C\u611B\u7D05\u9152",gender:"\u7537\u6027",birthday:"02/28",birthYear:"1992",loyaltyPoints:320,originStore:"\u5357\u4EAC\u9580\u5E02",lastCheckoutAt:"2026-01-20T12:15:00Z",isDeleted:!1},{id:"C104",name:"\u5F35\u5C0F\u59D0",phone:"0933-444-555",note:null,gender:"\u5973\u6027",birthday:"08/08",birthYear:"1998",loyaltyPoints:880,originStore:"\u4FE1\u7FA9\u9580\u5E02",lastCheckoutAt:"2026-01-19T20:30:00Z",isDeleted:!1},{id:"C201",name:"\u5433\u5148\u751F",phone:"0955-666-777",note:"\u5B9A\u671F\u4F86\u8A2A",gender:"\u7537\u6027",birthday:"07/15",birthYear:"1988",loyaltyPoints:150,originStore:"\u6771\u9580\u9580\u5E02",lastCheckoutAt:"2026-01-18T16:00:00Z",isDeleted:!1},{id:"C202",name:"\u5289\u5C0F\u59D0",phone:"0911-222-333",note:"\u5DF2\u505C\u6B62\u670D\u52D9",gender:"\u5973\u6027",birthday:"03/30",birthYear:"1995",loyaltyPoints:0,originStore:"\u4FE1\u7FA9\u9580\u5E02",lastCheckoutAt:"2025-06-30T14:20:00Z",isDeleted:!1}]);this.mockCustomerFeedback=S([{id:"F001",customerId:"C101",date:"2026-01-21",rating:5,comment:"\u5496\u5561\u5F88\u597D\u559D\uFF0C\u751C\u9EDE\u4E5F\u5F88\u68D2\uFF0C\u74B0\u5883\u8212\u9069\u3002"},{id:"F002",customerId:"C102",date:"2026-01-10",rating:4,comment:"\u5A01\u58EB\u5FCC\u9078\u64C7\u5F88\u591A\uFF0C\u96EA\u8304\u54C1\u8CEA\u4E0D\u932F\uFF0C\u4F46\u50F9\u683C\u504F\u9AD8\u3002"},{id:"F003",customerId:"C103",date:"2026-01-15",rating:5,comment:"\u7D05\u9152\u5F88\u9806\u53E3\uFF0C\u70B8\u7269\u62FC\u76E4\u8D85\u597D\u5403\uFF01"},{id:"F004",customerId:"C101",date:"2026-01-05",rating:4,comment:"\u9910\u9EDE\u597D\u5403\uFF0C\u4F46\u6C23\u6CE1\u98F2\u7684\u6C23\u6709\u9EDE\u4E0D\u8DB3\u3002"}]);this.mockLedger2024=[{date:"2024-01-15",description:"\u7DB2\u7AD9\u958B\u767C\u5C08\u6848 - A\u516C\u53F8",category:"\u92B7\u8CA8\u6536\u5165",income:15e4,expense:0},{date:"2024-01-20",description:"\u8FA6\u516C\u5BA4\u7528\u54C1\u63A1\u8CFC",category:"\u6587\u5177\u7528\u54C1",income:0,expense:4500},{date:"2024-02-10",description:"\u8A2D\u8A08\u670D\u52D9\u8CBB - B\u5BA2\u6236",category:"\u92B7\u8CA8\u6536\u5165",income:225e3,expense:0},{date:"2024-02-22",description:"SaaS \u8EDF\u9AD4\u8A02\u95B1\u8CBB",category:"\u5176\u4ED6\u8CBB\u7528",income:0,expense:6e3},{date:"2024-03-05",description:"\u96F2\u7AEF\u4F3A\u670D\u5668\u8CBB\u7528",category:"\u7DB2\u8DEF\u8CBB",income:0,expense:9e3},{date:"2024-03-18",description:"\u7DAD\u8B77\u5408\u7D04 - C\u516C\u53F8",category:"\u92B7\u8CA8\u6536\u5165",income:186e3,expense:0},{date:"2024-04-12",description:"\u6578\u4F4D\u5EE3\u544A\u6295\u653E",category:"\u884C\u92B7\u8CBB\u7528",income:0,expense:36e3},{date:"2024-04-25",description:"App\u958B\u767C\u5C08\u6848 - D\u5BA2\u6236",category:"\u92B7\u8CA8\u6536\u5165",income:243e3,expense:0},{date:"2024-05-15",description:"\u5916\u5305\u5C08\u6848\u8CBB\u7528",category:"\u50AD\u91D1\u8CBB\u7528",income:0,expense:45e3},{date:"2024-06-20",description:"\u9867\u554F\u670D\u52D9\u8CBB",category:"\u92B7\u8CA8\u6536\u5165",income:279e3,expense:0},{date:"2024-07-01",description:"\u8FA6\u516C\u5BA4\u79DF\u91D1 - Q3",category:"\u79DF\u91D1\u652F\u51FA",income:0,expense:6e4},{date:"2024-08-10",description:"\u7CFB\u7D71\u958B\u767C - E\u516C\u53F8",category:"\u92B7\u8CA8\u6536\u5165",income:165e3,expense:0}];this.mockLedger2025=[{date:"2025-01-15",description:"\u5E74\u5EA6\u7DAD\u8B77\u5408\u7D04 - A\u516C\u53F8",category:"\u92B7\u8CA8\u6536\u5165",income:18e4,expense:0},{date:"2025-01-20",description:"\u63A1\u8CFC\u65B0\u7B46\u96FB",category:"\u71DF\u696D\u8A2D\u5099",income:0,expense:75e3},{date:"2025-02-10",description:"\u54C1\u724C\u8A2D\u8A08\u5C08\u6848 - F\u5BA2\u6236",category:"\u92B7\u8CA8\u6536\u5165",income:255e3,expense:0},{date:"2025-02-22",description:"SaaS \u8EDF\u9AD4\u8A02\u95B1\u8CBB",category:"pos\u6A5F\u8CBB\u7528",income:0,expense:7500},{date:"2025-03-05",description:"\u96F2\u7AEF\u4F3A\u670D\u5668\u8CBB\u7528",category:"\u7DB2\u8DEF\u8CBB",income:0,expense:10500},{date:"2025-04-10",description:"\u6578\u4F4D\u5EE3\u544A\u6295\u653E - Q2",category:"\u884C\u92B7\u8CBB\u7528",income:0,expense:42e3},{date:"2025-05-20",description:"ERP \u7CFB\u7D71\u5C0E\u5165 - G \u516C\u53F8",category:"\u92B7\u8CA8\u6536\u5165",income:35e4,expense:0},{date:"2025-06-15",description:"\u8FA6\u516C\u5BA4\u64F4\u5EFA\u5DE5\u7A0B",category:"\u88DD\u6F62",income:0,expense:15e4},{date:"2025-07-01",description:"\u8FA6\u516C\u5BA4\u79DF\u91D1 - Q3",category:"\u79DF\u91D1\u652F\u51FA",income:0,expense:78e3},{date:"2025-08-18",description:"\u6CD5\u5F8B\u9867\u554F\u8CBB",category:"\u6703\u8A08\u8CBB\u7528",income:0,expense:25e3},{date:"2025-09-25",description:"\u96F2\u7AEF\u5E73\u53F0\u958B\u767C - H \u5BA2\u6236",category:"\u92B7\u8CA8\u6536\u5165",income:42e4,expense:0},{date:"2025-10-05",description:"\u4F3A\u670D\u5668\u786C\u9AD4\u5347\u7D1A",category:"\u71DF\u696D\u8A2D\u5099",income:0,expense:95e3},{date:"2025-11-12",description:"\u884C\u92B7\u6D3B\u52D5\u8CBB\u7528",category:"\u884C\u92B7\u8CBB\u7528",income:0,expense:65e3},{date:"2025-12-20",description:"\u5E74\u5EA6\u734E\u91D1\u767C\u653E",category:"\u734E\u91D1\u652F\u51FA",income:0,expense:25e4}];this.mockLedger2026=[{date:"2026-06-01",description:"VIP\u5305\u5EC2\u670D\u52D9\u8CBB",category:"\u92B7\u8CA8\u6536\u5165",income:88e3,expense:0},{date:"2026-06-05",description:"\u4F01\u696D\u5305\u5834\u6D3B\u52D5",category:"\u92B7\u8CA8\u6536\u5165",income:15e4,expense:0},{date:"2026-06-10",description:"\u7CFB\u7D71\u6574\u5408\u670D\u52D9 - M \u516C\u53F8",category:"\u92B7\u8CA8\u6536\u5165",income:22e4,expense:0},{date:"2026-06-12",description:"\u5834\u5730\u79DF\u8CC3\u6536\u5165",category:"\u5176\u4ED6\u6536\u5165",income:25e3,expense:0},{date:"2026-06-15",description:"\u9867\u5BA2\u8A02\u91D1\u6C92\u6536",category:"\u5176\u4ED6\u6536\u5165",income:5e3,expense:0},{date:"2026-06-20",description:"\u719F\u5BA2\u512A\u60E0\u6298\u8B93",category:"\u92B7\u8CA8\u6298\u8B93",income:12e3,expense:0},{date:"2026-06-02",description:"\u516D\u6708\u4EFD\u8FA6\u516C\u5BA4\u79DF\u91D1",category:"\u79DF\u91D1\u652F\u51FA",income:0,expense:8e4},{date:"2026-06-02",description:"\u516D\u6708\u4EFD\u5927\u6A13\u7BA1\u7406\u8CBB",category:"\u5927\u6A13\u7BA1\u7406\u8CBB",income:0,expense:5e3},{date:"2026-06-05",description:"\u54E1\u5DE5\u85AA\u8CC7",category:"\u85AA\u8CC7\u652F\u51FA",income:0,expense:18e4},{date:"2026-06-05",description:"\u52DE\u5065\u4FDD\u8CBB\u7528",category:"\u52DE\u4FDD\u8CBB",income:0,expense:15e3},{date:"2026-06-05",description:"\u52DE\u5065\u4FDD\u8CBB\u7528",category:"\u5065\u4FDD\u8CBB",income:0,expense:18e3},{date:"2026-06-08",description:"\u6C34\u96FB\u74E6\u65AF\u8CBB",category:"\u6C34\u8CBB",income:0,expense:2500},{date:"2026-06-08",description:"\u6C34\u96FB\u74E6\u65AF\u8CBB",category:"\u96FB\u8CBB",income:0,expense:12e3},{date:"2026-06-08",description:"\u6C34\u96FB\u74E6\u65AF\u8CBB",category:"\u74E6\u65AF\u8CBB",income:0,expense:3500},{date:"2026-06-10",description:"\u96FB\u4FE1\u7DB2\u8DEF\u8CBB",category:"\u7DB2\u8DEF\u8CBB",income:0,expense:2e3},{date:"2026-06-10",description:"\u96FB\u4FE1\u7DB2\u8DEF\u8CBB",category:"\u96FB\u8A71\u8CBB",income:0,expense:1500},{date:"2026-06-12",description:"\u5EDA\u623F\u98DF\u6750\u3001\u7D19\u5DFE\u7B49\u6D88\u8017\u54C1",category:"\u5EDA\u623F\u6D88\u8017\u54C1",income:0,expense:18e3},{date:"2026-06-15",description:"\u5F71\u5370\u7D19\u3001\u7B46\u7B49\u8FA6\u516C\u7528\u54C1",category:"\u6587\u5177\u7528\u54C1",income:0,expense:3e3},{date:"2026-06-18",description:"\u884C\u92B7\u6D3B\u52D5\u50AD\u91D1",category:"\u50AD\u91D1\u8CBB\u7528",income:0,expense:22e3},{date:"2026-06-20",description:"POS\u7CFB\u7D71\u6708\u8CBB",category:"pos\u6A5F\u8CBB\u7528",income:0,expense:5e3},{date:"2026-06-21",description:"\u7AEF\u5348\u7BC0\u62DC\u62DC\u7528\u54C1",category:"\u62DC\u62DC\u8CBB\u7528",income:0,expense:2e3},{date:"2026-06-22",description:"\u65B0\u83DC\u8272\u7814\u767C\u98DF\u6750",category:"\u8A66\u83DC\u8CBB\u7528",income:0,expense:8e3},{date:"2026-06-24",description:"\u71DF\u696D\u7528\u8CA1\u7522\u4FDD\u96AA",category:"\u4FDD\u96AA\u8CBB",income:0,expense:6e3},{date:"2026-06-25",description:"\u6703\u8A08\u5E2B\u8A18\u5E33\u8CBB",category:"\u6703\u8A08\u8CBB\u7528",income:0,expense:8e3},{date:"2026-06-25",description:"\u9280\u884C\u8CB8\u6B3E\u5229\u606F",category:"\u8CB8\u6B3E\u5229\u606F",income:0,expense:12e3}];this.mockPurchases=[{date:"2024-01-18",category:"\u9152\u6C34",amount:12e3},{date:"2024-02-05",category:"\u9910\u98F2",amount:8500},{date:"2024-02-25",category:"\u96EA\u8304",amount:25e3},{date:"2024-03-12",category:"\u9152\u6C34",amount:15e3},{date:"2024-04-20",category:"\u9910\u98F2",amount:9800},{date:"2024-05-10",category:"\u96EA\u8304",amount:32e3},{date:"2024-06-22",category:"\u9152\u6C34",amount:18e3},{date:"2024-07-15",category:"\u9910\u98F2",amount:11e3},{date:"2025-01-22",category:"\u9152\u6C34",amount:16e3},{date:"2025-02-15",category:"\u96EA\u8304",amount:45e3},{date:"2025-03-01",category:"\u9910\u98F2",amount:13500},{date:"2025-04-10",category:"\u9152\u6C34",amount:22e3},{date:"2025-05-15",category:"\u9910\u98F2",amount:15e3},{date:"2025-06-20",category:"\u96EA\u8304",amount:52e3},{date:"2025-08-05",category:"\u9152\u6C34",amount:25e3},{date:"2025-10-18",category:"\u9910\u98F2",amount:18e3},{date:"2025-12-01",category:"\u96EA\u8304",amount:65e3},{date:"2026-01-20",category:"\u9152\u6C34",amount:28e3},{date:"2026-02-18",category:"\u9910\u98F2",amount:25e3},{date:"2026-03-10",category:"\u9910\u98F2",amount:21e3},{date:"2026-03-25",category:"\u96EA\u8304",amount:82e3},{date:"2026-04-25",category:"\u96EA\u8304",amount:75e3},{date:"2026-05-15",category:"\u9152\u6C34",amount:35e3},{date:"2026-06-05",category:"\u9152\u6C34",amount:32e3},{date:"2026-06-12",category:"\u9910\u98F2",amount:28e3},{date:"2026-06-20",category:"\u96EA\u8304",amount:95e3}];this.mockPOSSales=[{transactionId:"T201",customerId:"C101",date:"2026-01-05",items:[{name:"\u4E3B\u98DF",price:350,quantity:2},{name:"\u6C23\u6CE1\u98F2",price:120,quantity:2}],total:940},{transactionId:"T202",customerId:"C102",date:"2026-01-10",items:[{name:"\u5A01\u58EB\u5FCC",price:2800,quantity:1},{name:"\u96EA\u8304",price:900,quantity:2}],total:4600},{transactionId:"T203",customerId:"C103",date:"2026-01-15",items:[{name:"\u7D05\u9152/\u767D\u9152",price:1800,quantity:1},{name:"\u70B8\u7269",price:250,quantity:1}],total:2050},{transactionId:"T204",customerId:"C101",date:"2026-01-20",items:[{name:"\u5496\u5561",price:150,quantity:2},{name:"\u751C\u9EDE",price:180,quantity:2}],total:660},{transactionId:"T205",customerId:"C104",date:"2026-01-25",items:[{name:"\u6D3B\u52D5",price:13e3,quantity:1}],total:13e3},{transactionId:"T301",customerId:"C201",date:"2026-02-03",items:[{name:"\u5564\u9152",price:200,quantity:4},{name:"\u70B8\u7269",price:250,quantity:2}],total:1300},{transactionId:"T302",customerId:"C202",date:"2026-02-12",items:[{name:"\u5A01\u58EB\u5FCC",price:3200,quantity:1}],total:3200},{transactionId:"T303",customerId:"C103",date:"2026-02-18",items:[{name:"\u4E3B\u98DF",price:400,quantity:1},{name:"\u8336\u98F2",price:130,quantity:1}],total:530},{transactionId:"T304",customerId:"C201",date:"2026-02-25",items:[{name:"\u96EA\u8304",price:1200,quantity:1}],total:1200},{transactionId:"T401",customerId:"C104",date:"2026-03-05",items:[{name:"\u5834\u5730\u4F7F\u7528\u8CBB",price:4e3,quantity:1}],total:4e3},{transactionId:"T402",customerId:"C101",date:"2026-03-10",items:[{name:"\u8ABF\u9152",price:450,quantity:2},{name:"\u55AE\u9EDE",price:300,quantity:1}],total:1200},{transactionId:"T403",customerId:"C102",date:"2026-03-20",items:[{name:"\u5A01\u58EB\u5FCC",price:2500,quantity:1},{name:"\u96EA\u8304",price:850,quantity:3}],total:5050},{transactionId:"T404",customerId:"C101",date:"2026-03-28",items:[{name:"\u4E0B\u5348\u8336\u5957\u9910",price:600,quantity:2}],total:1200},{transactionId:"T501",customerId:"C104",date:"2026-04-02",items:[{name:"\u5834\u5730\u4F7F\u7528\u8CBB",price:15e3,quantity:1}],total:15e3},{transactionId:"T502",customerId:"C101",date:"2026-04-10",items:[{name:"\u4E3B\u98DF",price:380,quantity:2},{name:"\u7D05\u9152/\u767D\u9152",price:2200,quantity:1}],total:2960},{transactionId:"T503",customerId:"C103",date:"2026-04-22",items:[{name:"\u96EA\u8304",price:1100,quantity:2}],total:2200}];this.productCategoryMap=new Map([["\u5834\u5730\u4F7F\u7528\u8CBB","\u6D3B\u52D5\u5834\u5730"],["\u6D3B\u52D5","\u6D3B\u52D5\u5834\u5730"],["\u8ABF\u9152","\u9152\u6C34"],["\u7D05\u9152/\u767D\u9152","\u9152\u6C34"],["\u5564\u9152","\u9152\u6C34"],["\u5A01\u58EB\u5FCC","\u9152\u6C34"],["\u4E3B\u98DF","\u9910\u98F2"],["\u70B8\u7269","\u9910\u98F2"],["\u5976\u6614","\u9910\u98F2"],["\u6C23\u6CE1\u98F2","\u9910\u98F2"],["\u55AE\u9EDE","\u9910\u98F2"],["\u8336\u98F2","\u9910\u98F2"],["\u8C9D\u679C/\u53EF\u980C","\u9910\u98F2"],["\u5496\u5561","\u9910\u98F2"],["\u751C\u9EDE","\u9910\u98F2"],["\u6C99\u62C9","\u9910\u98F2"],["\u4E0B\u5348\u8336\u5957\u9910","\u9910\u98F2"],["\u96EA\u8304","\u96EA\u8304"]]);this.mockCostRateMap=new Map([["\u6D3B\u52D5\u5834\u5730",.1],["\u9152\u6C34",.35],["\u9910\u98F2",.25],["\u96EA\u8304",.55]]);this.mockMonthlyBalanceSheetData2026={assets:{\u73FE\u91D1:{"2026-01":-60372,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u61C9\u6536\u5E33\u6B3E:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},"\u5B58\u8CA8-\u9910\u98F2":{"2026-01":42459,"2026-02":56424,"2026-03":63318,"2026-04":53737,"2026-05":41714,"2026-06":62941,"2026-07":55331,"2026-08":57454,"2026-09":42199,"2026-10":88353,"2026-11":56195,"2026-12":70131},"\u5B58\u8CA8-\u9152\u6C34":{"2026-01":4561,"2026-02":51162,"2026-03":28630,"2026-04":51807,"2026-05":26140,"2026-06":7117,"2026-07":5707,"2026-08":23549,"2026-09":40217,"2026-10":80083,"2026-11":38428,"2026-12":13344},"\u5B58\u8CA8-\u96EA\u8304":{"2026-01":106380,"2026-02":114733,"2026-03":150810,"2026-04":112936,"2026-05":79912,"2026-06":91653,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u88DD\u6F62:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":1700030,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u62BC\u91D1:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u71DF\u696D\u8A2D\u5099:{"2026-01":20472,"2026-02":9694,"2026-03":4235,"2026-04":25624,"2026-05":25084,"2026-06":1044,"2026-07":770,"2026-08":2876,"2026-09":6678,"2026-10":25840,"2026-11":5444,"2026-12":1589}},liabilities:{\u61C9\u4ED8\u5E33\u6B3E:{"2026-01":-116791,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u61C9\u4ED8\u88DD\u6F62\u6B3E:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":-34e4,"2026-07":-34e4,"2026-08":-34e4,"2026-09":-34e4,"2026-10":-26e4,"2026-11":0,"2026-12":0},\u61C9\u4ED8\u85AA\u8CC7:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":-73145,"2026-08":-53145,"2026-09":-38145,"2026-10":0,"2026-11":-67145,"2026-12":-50145},\u61C9\u4ED8\u80A1\u6771\u56DE\u994B\u91D1:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":-21181,"2026-09":-1830,"2026-10":0,"2026-11":0,"2026-12":0},\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":-99275,"2026-07":-78270,"2026-08":-224230,"2026-09":-113975,"2026-10":-118535,"2026-11":-71145,"2026-12":-66350},\u9280\u884C\u501F\u6B3E:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":2e6,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0}},equity:{\u8CC7\u672C:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u696D\u4E3B\u5B58\u5165:{"2026-01":0,"2026-02":3e5,"2026-03":15e4,"2026-04":5e4,"2026-05":1e5,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u696D\u4E3B\u63D0\u51FA:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0}}};this.mockMonthlyIncomeStatementData2026={revenue:{\u92B7\u8CA8\u6536\u5165:{"2026-01":515140,"2026-02":347057,"2026-03":327890,"2026-04":261350,"2026-05":256858,"2026-06":187580,"2026-07":200710,"2026-08":308020,"2026-09":224550,"2026-10":504140,"2026-11":236815,"2026-12":340853},\u5176\u4ED6\u6536\u5165:{"2026-01":100,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":27677,"2026-07":636,"2026-08":25e3,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u92B7\u8CA8\u6298\u8B93:{"2026-01":-111972,"2026-02":-84928,"2026-03":-59978,"2026-04":-58915,"2026-05":-35331,"2026-06":-29417,"2026-07":-22367,"2026-08":-30058,"2026-09":-36237,"2026-10":-55599,"2026-11":-22119,"2026-12":-35978}},expenses:{\u85AA\u8CC7\u652F\u51FA:{"2026-01":-117806,"2026-02":-97814,"2026-03":-110799,"2026-04":-105507,"2026-05":-110155,"2026-06":-109977,"2026-07":-25718,"2026-08":-52922,"2026-09":-70688,"2026-10":-95017,"2026-11":-35040,"2026-12":-37492},\u5065\u4FDD\u8CBB:{"2026-01":0,"2026-02":-2368,"2026-03":-2368,"2026-04":-2368,"2026-05":-2373,"2026-06":-2368,"2026-07":-2368,"2026-08":-2368,"2026-09":-2368,"2026-10":-2368,"2026-11":-2368,"2026-12":0},\u52DE\u4FDD\u8CBB:{"2026-01":-4447,"2026-02":-8883,"2026-03":-5382,"2026-04":-15787,"2026-05":-5138,"2026-06":-4827,"2026-07":-4827,"2026-08":-4827,"2026-09":-4827,"2026-10":-4827,"2026-11":-4827,"2026-12":-4827},\u56DE\u994B\u91D1\u652F\u51FA:{"2026-01":-1654,"2026-02":-1581,"2026-03":-1623,"2026-04":-3320,"2026-05":-9792,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":-15e3,"2026-12":0},\u79DF\u91D1\u652F\u51FA:{"2026-01":-72425,"2026-02":-72425,"2026-03":-72425,"2026-04":-72425,"2026-05":-72425,"2026-06":-72425,"2026-07":-72425,"2026-08":-72410,"2026-09":-72410,"2026-10":-72410,"2026-11":-72410,"2026-12":-72410},\u4FDD\u96AA\u8CBB:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":-21297,"2026-12":0},\u8CB8\u6B3E\u5229\u606F:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":-3824,"2026-07":-3824,"2026-08":-3824,"2026-09":-3824,"2026-10":-3824,"2026-11":-3824,"2026-12":-3824},\u5EDA\u623F\u6D88\u8017\u54C1:{"2026-01":-596,"2026-02":-834,"2026-03":-79,"2026-04":-3002,"2026-05":0,"2026-06":0,"2026-07":-641,"2026-08":-300,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":-1293},\u6587\u5177\u7528\u54C1:{"2026-01":-266,"2026-02":-590,"2026-03":-1263,"2026-04":-9358,"2026-05":-149,"2026-06":-1255,"2026-07":-207,"2026-08":-953,"2026-09":-152,"2026-10":-163,"2026-11":-1989,"2026-12":-621},\u7DB2\u8DEF\u8CBB:{"2026-01":-4794,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":-4794,"2026-06":0,"2026-07":-2397,"2026-08":0,"2026-09":0,"2026-10":-2553,"2026-11":-2302,"2026-12":-1344},\u96FB\u8A71\u8CBB:{"2026-01":0,"2026-02":-334,"2026-03":-1302,"2026-04":-338,"2026-05":-369,"2026-06":-359,"2026-07":-330,"2026-08":-316,"2026-09":-328,"2026-10":-310,"2026-11":-357,"2026-12":-340},\u5927\u6A13\u7BA1\u7406\u8CBB:{"2026-01":-1400,"2026-02":-1400,"2026-03":-1400,"2026-04":0,"2026-05":0,"2026-06":-1400,"2026-07":-1400,"2026-08":0,"2026-09":0,"2026-10":-1400,"2026-11":-1400,"2026-12":0},\u6703\u8A08\u8CBB\u7528:{"2026-01":0,"2026-02":-14730,"2026-03":-4e3,"2026-04":0,"2026-05":-4162,"2026-06":0,"2026-07":-4e3,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u734E\u91D1\u652F\u51FA:{"2026-01":0,"2026-02":-3e3,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u6C34\u8CBB:{"2026-01":-709,"2026-02":0,"2026-03":-696,"2026-04":0,"2026-05":-599,"2026-06":0,"2026-07":-525,"2026-08":0,"2026-09":-578,"2026-10":0,"2026-11":-1218,"2026-12":0},\u74E6\u65AF\u8CBB:{"2026-01":-300,"2026-02":0,"2026-03":0,"2026-04":-300,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":-2100,"2026-10":-600,"2026-11":-300,"2026-12":-1540},\u96FB\u8CBB:{"2026-01":0,"2026-02":-8811,"2026-03":-807,"2026-04":0,"2026-05":0,"2026-06":-12543,"2026-07":0,"2026-08":-24358,"2026-09":0,"2026-10":-24920,"2026-11":0,"2026-12":-14417},\u50AD\u91D1\u8CBB\u7528:{"2026-01":0,"2026-02":0,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":-3e3},\u8A66\u83DC\u8CBB\u7528:{"2026-01":-10530,"2026-02":-1070,"2026-03":-1403,"2026-04":0,"2026-05":0,"2026-06":-225,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u62DC\u62DC\u8CBB\u7528:{"2026-01":-3744,"2026-02":-6043,"2026-03":-1174,"2026-04":-838,"2026-05":-554,"2026-06":-1228,"2026-07":-608,"2026-08":-1258,"2026-09":-1216,"2026-10":-1216,"2026-11":-585,"2026-12":-806},pos\u6A5F\u8CBB\u7528:{"2026-01":0,"2026-02":-11700,"2026-03":0,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":0,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":0,"2026-12":0},\u5176\u4ED6\u8CBB\u7528:{"2026-01":-2030,"2026-02":-3058,"2026-03":-3570,"2026-04":0,"2026-05":-25418,"2026-06":-13010,"2026-07":-6445,"2026-08":-154,"2026-09":-1302,"2026-10":-6413,"2026-11":-1e3,"2026-12":-13126},\u71DF\u696D\u7A05:{"2026-01":0,"2026-02":0,"2026-03":-8421,"2026-04":0,"2026-05":0,"2026-06":0,"2026-07":-4915,"2026-08":0,"2026-09":0,"2026-10":0,"2026-11":-22930,"2026-12":0}}};this.mockRebateTransactions=S([{id:"RT001",shareholderName:"\u80A1\u6771 A",checkoutTime:"2024/08/01 20:30:15",discountDetails:"\u9910\u98F28\u6298",invoiceAmount:5e3,rebatePercentage:5,rebateAmount:250,discountUsed:"\u7121"},{id:"RT002",shareholderName:"\u80A1\u6771 A",checkoutTime:"2024/08/15 21:00:00",discountDetails:"\u96EA\u83049\u6298",invoiceAmount:8e3,rebatePercentage:5,rebateAmount:400,discountUsed:"\u751F\u65E5\u5238"},{id:"RT003",shareholderName:"\u80A1\u6771 B",checkoutTime:"2024/08/10 19:45:00",discountDetails:"\u5168\u55AE85\u6298",invoiceAmount:12e3,rebatePercentage:8,rebateAmount:960,discountUsed:"\u7121"}])}getFilteredLedger(e,t){let i=[...this.mockLedger2024,...this.mockLedger2025,...this.mockLedger2026];return!e&&!t?i:i.filter(r=>{let o=r.date,s=e?o>=e:!0,u=t?o<=t:!0;return s&&u})}getFilteredPurchases(e,t){return!e&&!t?this.mockPurchases:this.mockPurchases.filter(i=>{let r=i.date,o=e?r>=e:!0,s=t?r<=t:!0;return o&&s})}getFilteredPOSSales(e,t,i){let r=this.mockPOSSales;return i&&(r=r.filter(o=>o.customerId===i)),!e&&!t?r:r.filter(o=>{let s=o.date,u=e?s>=e:!0,d=t?s<=t:!0;return u&&d})}getFinancialSummary(e,t){let i=this.getFilteredLedger(e,t),r=i.filter(D=>D.category!=="\u92B7\u8CA8\u6298\u8B93").reduce((D,I)=>D+I.income,0),o=i.filter(D=>D.category==="\u92B7\u8CA8\u6298\u8B93").reduce((D,I)=>D+I.income,0),s=r-o,u=i.reduce((D,I)=>D+I.expense,0),d=s-u,h=this.getFilteredPurchases(e,t).reduce((D,I)=>D+I.amount,0),y=1e6+d,_=3e5,C=y-_;return{totalRevenue:s,totalExpenses:u,netIncome:d,totalAssets:y,totalLiabilities:_,equity:C,totalPurchases:h,totalAllowance:o}}getPOSSales(e,t,i){return this.getFilteredPOSSales(e,t,i)}getMonthlyPerformance(e,t){let i=new Map;return this.getFilteredLedger(e,t).forEach(o=>{let s=o.date.substring(0,7);i.has(s)||i.set(s,{revenue:0,expenses:0,accountsPayable:0});let u=i.get(s);o.category==="\u92B7\u8CA8\u6298\u8B93"?u.revenue-=o.income:u.revenue+=o.income,u.expenses+=o.expense,u.accountsPayable=u.expenses*.4+u.revenue*.05}),Array.from(i.keys()).sort().map(o=>k({month:o},i.get(o)))}getExpensesByCategory(e,t){let i=new Map;return this.getFilteredLedger(e,t).forEach(o=>{o.expense>0&&o.category!=="\u8CC7\u672C\u652F\u51FA"&&i.set(o.category,(i.get(o.category)||0)+o.expense)}),Array.from(i.entries()).map(([o,s])=>({category:o,amount:s}))}getPurchasesByCategory(e,t){let i=new Map;return this.getFilteredPurchases(e,t).forEach(o=>{i.set(o.category,(i.get(o.category)||0)+o.amount)}),Array.from(i.entries()).map(([o,s])=>({category:o,amount:s}))}getTopSellingProducts(e,t){let i=new Map;return this.getFilteredPOSSales(e,t).forEach(r=>{r.items.forEach(o=>{let s=i.get(o.name)||{quantitySold:0,revenue:0};s.quantitySold+=o.quantity,s.revenue+=o.price*o.quantity,i.set(o.name,s)})}),Array.from(i.entries()).map(([r,o])=>k({name:r},o)).sort((r,o)=>o.revenue-r.revenue).slice(0,5)}getFilteredPOSSalesByMonth(e,t){return!e&&!t?this.mockPOSSales:this.mockPOSSales.filter(i=>{let r=i.date.substring(0,7),o=e?r>=e:!0,s=t?r<=t:!0;return o&&s})}getAllProductsAnalysis(e,t){let i=new Map,r=this.getFilteredPOSSalesByMonth(e,t),o=r.reduce((s,u)=>s+u.total,0);return r.forEach(s=>{s.items.forEach(u=>{let d=i.get(u.name)||{quantitySold:0,revenue:0,prices:[]};d.quantitySold+=u.quantity,d.revenue+=u.price*u.quantity,d.prices.push(u.price),i.set(u.name,d)})}),i.size===0?[]:Array.from(i.entries()).map(([s,u])=>{let d=u.prices.length>0?u.prices.reduce((h,y)=>h+y,0)/u.prices.length:0,m=o>0?u.revenue/o*100:0;return{name:s,category:this.productCategoryMap.get(s)||"\u5176\u4ED6",quantitySold:u.quantitySold,revenue:u.revenue,avgPrice:d,revenueShare:m}}).sort((s,u)=>u.revenue-s.revenue)}getProductAnalysisReport(e,t){let i=this.getFilteredPOSSalesByMonth(e,t);if(i.length===0)return null;let r=[...new Set(i.map(C=>C.date.substring(0,7)))].sort(),o=new Map,s=new Map;r.forEach(C=>s.set(C,{revenue:0}));for(let C of i){let D=C.date.substring(0,7);s.get(D).revenue+=C.total;for(let I of C.items){o.has(I.name)||o.set(I.name,{category:this.productCategoryMap.get(I.name)||"\u5176\u4ED6",totalRevenue:0,totalQuantity:0,monthly:new Map});let R=o.get(I.name),F=I.price*I.quantity;R.totalRevenue+=F,R.totalQuantity+=I.quantity,R.monthly.has(D)||R.monthly.set(D,{revenue:0,quantity:0});let $=R.monthly.get(D);$.revenue+=F,$.quantity+=I.quantity}}let u=Array.from(s.values()).reduce((C,D)=>C+D.revenue,0);if(u===0)return null;let d=Array.from(o.entries()).map(([C,D])=>{let I={};for(let R of r){let F=D.monthly.get(R),$=s.get(R).revenue,G=this.mockCostRateMap.get(D.category)||0;I[R]={quantitySold:F?.quantity||0,revenue:F?.revenue||0,revenueShare:$>0?(F?.revenue||0)/$*100:0,costRate:G>0?G+(Math.random()-.5)*.1:0}}return{name:C,category:D.category,totalRevenue:D.totalRevenue,totalQuantity:D.totalQuantity,totalRevenueShare:D.totalRevenue/u*100,monthlyMetrics:I}}),m=["\u6D3B\u52D5\u5834\u5730","\u9152\u6C34","\u9910\u98F2","\u96EA\u8304"],h=[];for(let C of m){let D=d.filter($=>$.category===C).sort(($,G)=>G.totalRevenue-$.totalRevenue);if(D.length===0)continue;let I={};for(let $ of r){let G=D.reduce((le,Ue)=>le+Ue.monthlyMetrics[$].quantitySold,0),Y=D.reduce((le,Ue)=>le+Ue.monthlyMetrics[$].revenue,0),ne=s.get($).revenue,de=D.reduce((le,Ue)=>le+Ue.monthlyMetrics[$].revenue*Ue.monthlyMetrics[$].costRate,0);I[$]={quantitySold:G,revenue:Y,revenueShare:ne>0?Y/ne*100:0,costRate:Y>0?de/Y:0}}let R=D.reduce(($,G)=>$+G.totalRevenue,0),F={name:"\u5C0F\u8A08",category:C,totalRevenue:R,totalQuantity:D.reduce(($,G)=>$+G.totalQuantity,0),totalRevenueShare:R/u*100,monthlyMetrics:I};h.push({category:C,products:D,subtotal:F})}let y={};for(let C of r){let D=s.get(C).revenue,I=h.reduce((R,F)=>R+F.subtotal.monthlyMetrics[C].revenue*F.subtotal.monthlyMetrics[C].costRate,0);y[C]={quantitySold:h.reduce((R,F)=>R+F.subtotal.monthlyMetrics[C].quantitySold,0),revenue:D,revenueShare:100,costRate:D>0?I/D:0}}let _={name:"\u7E3D\u8A08",category:"",totalRevenue:u,totalQuantity:h.reduce((C,D)=>C+D.subtotal.totalQuantity,0),totalRevenueShare:100,monthlyMetrics:y};return{months:r,categoryGroups:h,grandTotal:_}}getIncomeStatement(e,t){let i=this.getFilteredLedger(e,t),r=new Map,o=new Map;i.forEach(y=>{y.income>0&&r.set(y.category,(r.get(y.category)||0)+y.income),y.expense>0&&o.set(y.category,(o.get(y.category)||0)+y.expense)});let s=r.get("\u92B7\u8CA8\u6536\u5165")||0,u=r.get("\u5176\u4ED6\u6536\u5165")||0,d=r.get("\u92B7\u8CA8\u6298\u8B93")||0,m={items:[{account:"\u92B7\u8CA8\u6536\u5165",amount:s},{account:"\u5176\u4ED6\u6536\u5165",amount:u},{account:"\u92B7\u8CA8\u6298\u8B93",amount:-d}],total:s+u-d},h={items:Array.from(o.entries()).map(([y,_])=>({account:y,amount:_})).sort((y,_)=>_.amount-y.amount),total:Array.from(o.values()).reduce((y,_)=>y+_,0)};return{operatingRevenue:m,operatingExpenses:h,netIncome:m.total-h.total}}getBalanceSheet(e,t){let i=this.getIncomeStatement(e,t),r=i.netIncome,o=this.getFilteredPurchases(e,t),u={items:[{account:"\u73FE\u91D1",amount:5e5+r},{account:"\u61C9\u6536\u5E33\u6B3E",amount:i.operatingRevenue.total*.15},{account:"\u5B58\u8CA8-\u9910\u98F2",amount:o.filter(C=>C.category==="\u9910\u98F2").reduce((C,D)=>C+D.amount,0)*.4},{account:"\u5B58\u8CA8-\u9152\u6C34",amount:o.filter(C=>C.category==="\u9152\u6C34").reduce((C,D)=>C+D.amount,0)*.5},{account:"\u5B58\u8CA8-\u96EA\u8304",amount:o.filter(C=>C.category==="\u96EA\u8304").reduce((C,D)=>C+D.amount,0)*.6},{account:"\u88DD\u6F62",amount:12e5},{account:"\u62BC\u91D1",amount:15e4},{account:"\u71DF\u696D\u8A2D\u5099",amount:45e4}],total:0};u.total=u.items.reduce((C,D)=>C+D.amount,0);let d={items:[{account:"\u61C9\u4ED8\u5E33\u6B3E",amount:i.operatingExpenses.total*.3},{account:"\u61C9\u4ED8\u88DD\u6F62\u6B3E",amount:25e4},{account:"\u61C9\u4ED8\u85AA\u8CC7",amount:45e3},{account:"\u61C9\u4ED8\u80A1\u6771\u56DE\u994B\u91D1",amount:15e3},{account:"\u61C9\u4ED8\u96EA\u8304\u9032\u8CA8",amount:35e3},{account:"\u9280\u884C\u501F\u6B3E",amount:8e5}],total:0};d.total=d.items.reduce((C,D)=>C+D.amount,0);let m={items:[{account:"\u8CC7\u672C",amount:1e6},{account:"\u696D\u4E3B\u5B58\u5165",amount:5e4},{account:"\u696D\u4E3B\u63D0\u51FA",amount:-2e4},{account:"\u672C\u671F\u640D\u76CA",amount:r}],total:0};m.total=m.items.reduce((C,D)=>C+D.amount,0);let h=d.total+m.total,y=u.total-h,_=m.items.find(C=>C.account==="\u8CC7\u672C");return _&&(_.amount+=y,m.total+=y),{assets:u,liabilities:d,equity:m,totalLiabilitiesAndEquity:u.total}}getMonthlyBalanceSheetReport(e,t){if(e!==2026)return null;let i=this.mockMonthlyBalanceSheetData2026,r=`${e}-`,o=Array.from({length:12},(C,D)=>r+String(D+1).padStart(2,"0")),s;if(t==="all")s=o;else{let C=(t-1)*3+1;s=o.slice(C-1,C+2)}let u=C=>{let D=[],I={};for(let F in C){let $=C[F],G=$[s[s.length-1]]||0;D.push({account:F,monthlyAmounts:$,total:G,percentage:0})}for(let F of o)I[F]=D.reduce(($,G)=>$+(G.monthlyAmounts[F]||0),0);let R=I[s[s.length-1]]||0;return{items:D,monthlyTotals:I,grandTotal:R}},d=u(i.assets),m=u(i.liabilities),h=u(i.equity);d.grandTotal!==0&&d.items.forEach(C=>C.percentage=C.total/d.grandTotal*100);let y=m.grandTotal+h.grandTotal;y!==0&&(m.items.forEach(C=>C.percentage=C.total/y*100),h.items.forEach(C=>C.percentage=C.total/y*100));let _={items:[],monthlyTotals:{},grandTotal:y};for(let C of o)_.monthlyTotals[C]=(m.monthlyTotals[C]||0)+(h.monthlyTotals[C]||0);return{months:s,assets:d,liabilities:m,equity:h,totalLiabilitiesAndEquity:_}}getMonthlyIncomeStatementReport(e,t){if(e!==2026)return null;let i=this.mockMonthlyIncomeStatementData2026,r=`${e}-`,o=Array.from({length:12},(y,_)=>r+String(_+1).padStart(2,"0")),s;if(t==="all")s=o;else{let y=(t-1)*3+1;s=o.slice(y-1,y+2)}let u=y=>{let _=[],C={};for(let I in y){let R=y[I],F=s.reduce(($,G)=>$+(R[G]||0),0);_.push({account:I,monthlyAmounts:R,total:F,percentage:0})}for(let I of o)C[I]=_.reduce((R,F)=>R+(F.monthlyAmounts[I]||0),0);let D=s.reduce((I,R)=>I+(C[R]||0),0);return D!==0&&_.forEach(I=>I.percentage=I.total/D*100),{items:_,monthlyTotals:C,grandTotal:D}},d=u(i.revenue),m=u(i.expenses),h={monthlyTotals:{},grandTotal:d.grandTotal+m.grandTotal};for(let y of o)h.monthlyTotals[y]=(d.monthlyTotals[y]||0)+(m.monthlyTotals[y]||0);return{months:s,operatingRevenue:d,operatingExpenses:m,netIncome:h}}getTransactions(e){let t=this.mockTransactions();if(e.startDate&&(t=t.filter(i=>i.date>=e.startDate)),e.endDate&&(t=t.filter(i=>i.date<=e.endDate)),e.item&&(t=t.filter(i=>i.item===e.item)),e.category&&(t=t.filter(i=>i.category===e.category)),e.vendorName&&(t=t.filter(i=>i.vendorName===e.vendorName)),e.description){let i=e.description.toLowerCase();t=t.filter(r=>r.description?.toLowerCase().includes(i))}return t}addTransaction(e){let t=q(k({},e),{id:`TXN${Date.now()}`});this.mockTransactions.update(i=>[...i,t])}updateTransaction(e){this.mockTransactions.update(t=>t.map(i=>i.id===e.id?e:i))}getLedgerFilterOptions(){let e=this.mockTransactions(),t=[...new Set(e.map(o=>o.item))],i=[...new Set(e.map(o=>o.category))],r=[...new Set(e.map(o=>o.vendorName).filter(o=>!!o))];return{items:t.sort(),categories:i.sort(),vendorNames:r.sort()}}getEvents(){return this.mockEvents()}getEventById(e){return this.mockEvents().find(t=>t.id===e)}addEvent(e){let t=q(k({},e),{id:`EVT${Date.now()}`});this.mockEvents.update(i=>[...i,t])}updateEvent(e){this.mockEvents.update(t=>t.map(i=>i.id===e.id?e:i))}deleteEvent(e){this.mockEvents.update(t=>t.filter(i=>i.id!==e))}getDailyRevenueReport(e,t){let i=new Date(e,t-1,1),o=new Date(e,t,0).getDate(),s=`${e}-${String(t).padStart(2,"0")}`,u=[];for(let d=1;d<=o;d++){let m=`${s}-${String(d).padStart(2,"0")}`,h=this.mockDailyRevenue().find(I=>I.date===m)||{date:m,nonEventRevenue:0,isDayOff:!1},y=this.mockEvents().filter(I=>I.date===m&&I.status==="active"),_=y.reduce((I,R)=>I+R.actualRevenue,0),C=h.nonEventRevenue+_,D=y.map(I=>I.name);u.push({day:d,date:m,isDayOff:h.isDayOff,totalDailyRevenue:C,eventRevenue:_,eventNames:D})}return u}getDailyRevenueEntryByDate(e){return this.mockDailyRevenue().find(t=>t.date===e)||{date:e,nonEventRevenue:0,isDayOff:!1}}updateDailyRevenueEntry(e,t){this.mockDailyRevenue.update(i=>{let r=i.findIndex(o=>o.date===e);if(r>-1){let o=[...i];return o[r]=k(k({},o[r]),t),o}else return[...i,{date:e,nonEventRevenue:t.nonEventRevenue??0,isDayOff:t.isDayOff??!1}]})}getEmployees(e){let t=this.mockEmployees();return e?t.filter(i=>i.type===e):t}getEmployeeById(e){return this.mockEmployees().find(t=>t.id===e)}getPayrollSummary(e,t){let i=this.getEmployees("full-time"),r=this.getEmployees("part-time"),o=`${e}-${String(t).padStart(2,"0")}`,s=i.reduce((m,h)=>m+(h.monthlySalary||0),0),u=r.map(m=>{let h=this.mockPunchRecords().filter(D=>D.employeeId===m.id&&D.date.startsWith(o)),y=0,_=0,C=!1;return h.forEach(D=>{if(!D.clockIn||!D.clockOut){C=!0;return}let[I,R]=D.clockIn.split(":").map(Number),[F,$]=D.clockOut.split(":").map(Number),G=new Date(0,0,0,I,R),Y=new Date(0,0,0,F,$);if(Y<G)return;let de=(Y.getTime()-G.getTime())/(1e3*60)/60,le=Math.floor(de*100)/100;y+=le;let Ue=le*(m.hourlyRate||0);D.isDoublePay&&(Ue*=2),_+=Ue}),{employeeId:m.id,name:m.name,totalHours:y,totalPay:_,hasMissingPunch:C}}),d=u.reduce((m,h)=>m+h.totalPay,0);return{fullTimePayroll:s,partTimePayroll:d,partTimeDetails:u}}getPunchRecordsForMonth(e,t,i){let r=`${t}-${String(i).padStart(2,"0")}`;return this.mockPunchRecords().filter(o=>o.employeeId===e&&o.date.startsWith(r))}updatePunchRecords(e,t,i,r){let o=`${t}-${String(i).padStart(2,"0")}`;this.mockPunchRecords.update(s=>{let u=s.filter(m=>!(m.employeeId===e&&m.date.startsWith(o))),d=r.filter(m=>m.clockIn||m.clockOut);return[...u,...d]})}getVendors(){return this.mockVendors()}addVendor(e){let t=q(k({},e),{id:`V${Date.now()}`});this.mockVendors.update(i=>[...i,t])}updateVendor(e){this.mockVendors.update(t=>t.map(i=>i.id===e.id?e:i))}deleteVendor(e){this.mockVendors.update(t=>t.filter(i=>i.id!==e))}getPurchaseOrders(){return this.mockPurchaseOrders()}addPurchaseOrder(e){let t=q(k({},e),{id:`PO${Date.now()}`});this.mockPurchaseOrders.update(i=>[...i,t])}updatePurchaseOrder(e){this.mockPurchaseOrders.update(t=>t.map(i=>i.id===e.id?e:i))}deletePurchaseOrder(e){this.mockPurchaseOrders.update(t=>t.filter(i=>i.id!==e))}getProductCosts(){return this.mockProductCosts()}addProductCost(e){let t=q(k({},e),{id:`PC${Date.now()}`});this.mockProductCosts.update(i=>[...i,t])}updateProductCost(e){this.mockProductCosts.update(t=>t.map(i=>i.id===e.id?e:i))}deleteProductCost(e){this.mockProductCosts.update(t=>t.filter(i=>i.id!==e))}getCigarCosts(){return this.mockCigarCosts()}addCigarCost(e){let t=q(k({},e),{id:`C${Date.now()}`});this.mockCigarCosts.update(i=>[...i,t])}updateCigarCost(e){this.mockCigarCosts.update(t=>t.map(i=>i.id===e.id?e:i))}deleteCigarCost(e){this.mockCigarCosts.update(t=>t.filter(i=>i.id!==e))}getWineCosts(){return this.mockWineCosts()}addWineCost(e){let t=q(k({},e),{id:`W${Date.now()}`});this.mockWineCosts.update(i=>[...i,t])}updateWineCost(e){this.mockWineCosts.update(t=>t.map(i=>i.id===e.id?e:i))}deleteWineCost(e){this.mockWineCosts.update(t=>t.filter(i=>i.id!==e))}getCustomers(){return this.mockCustomers()}getFeedbackForCustomer(e){return this.mockCustomerFeedback().filter(t=>t.customerId===e)}getAnnualSummaryReport(e,t){let i=Array.from({length:t-e+1},(s,u)=>e+u),r={years:i,revenue:{total:0},expense:{total:0},net:{total:0},unpaid:{total:0}},o=[...this.mockLedger2024,...this.mockLedger2025,...this.mockLedger2026];return i.forEach(s=>{let u=o.filter(_=>_.date.startsWith(s.toString())),d=u.filter(_=>_.category!=="\u92B7\u8CA8\u6298\u8B93").reduce((_,C)=>_+C.income,0),m=u.filter(_=>_.category==="\u92B7\u8CA8\u6298\u8B93").reduce((_,C)=>_+C.income,0),h=d-m,y=u.reduce((_,C)=>_+C.expense,0);r.revenue[s]=h,r.expense[s]=y,r.net[s]=h-y,r.unpaid[s]=y*.15}),r.revenue.total=i.reduce((s,u)=>s+r.revenue[u],0),r.expense.total=i.reduce((s,u)=>s+r.expense[u],0),r.net.total=i.reduce((s,u)=>s+r.net[u],0),r.unpaid.total=i.reduce((s,u)=>s+r.unpaid[u],0),r}getMonthlyDetail(e,t){let i=e.toString(),o=[...this.mockLedger2024,...this.mockLedger2025,...this.mockLedger2026].filter(u=>u.date.startsWith(i)),s={year:e,type:t==="unpaid"?"\u672A\u4ED8":t==="revenue"?"\u6536\u5165":"\u652F\u51FA",data:[]};for(let u=1;u<=12;u++){let d=`${i}-${String(u).padStart(2,"0")}`,m=o.filter(_=>_.date?.startsWith(d));if(m.length===0)continue;let h=0,y=new Map;t==="revenue"?m.forEach(_=>{if(_.income>0){let C=_.category==="\u92B7\u8CA8\u6298\u8B93"?-_.income:_.income;y.set(_.category,(y.get(_.category)||0)+C),h+=C}}):t==="expense"?m.forEach(_=>{_.expense>0&&(y.set(_.category,(y.get(_.category)||0)+_.expense),h+=_.expense)}):(h=m.reduce((C,D)=>C+D.expense,0)*.15,y.set("\u61C9\u4ED8\u5E33\u6B3E",h*.7),y.set("\u61C9\u4ED8\u85AA\u8CC7",h*.3)),s.data.push({month:u,total:h,items:Array.from(y.entries()).map(([_,C])=>({name:_,amount:C}))})}return s.data.length>0?s:null}getProductGrossMarginReport(e,t){let i={dining:{totalPurchases:5e4,totalSales:15e4,grossMargin:1e5,grossMarginRate:.66},drinks:{totalPurchases:8e4,totalSales:2e5,grossMargin:12e4,grossMarginRate:.6},cigars:{totalPurchases:12e4,totalSales:22e4,grossMargin:1e5,grossMarginRate:.45},venue:{totalPurchases:1e4,totalSales:8e4,grossMargin:7e4,grossMarginRate:.875},total:{totalPurchases:26e4,totalSales:65e4,grossMargin:39e4,grossMarginRate:.6}},r=[],o=new Date(e.replace("/","-")+"-01"),s=new Date(t.replace("/","-")+"-01");for(;o<=s;){let u=5e4+Math.random()*2e4,d=6e4+Math.random()*3e4,m=7e4+Math.random()*4e4,h=2e4+Math.random()*1e4;r.push({month:`${o.getFullYear()}/${String(o.getMonth()+1).padStart(2,"0")}`,dining:u,drinks:d,cigars:m,venue:h,total:u+d+m+h}),o.setMonth(o.getMonth()+1)}return{summary:i,monthlySales:r}}getShareholderRebates(e,t){return[{name:"\u80A1\u6771 A",currentMonthRebate:650,unpaidRebate:1500,cumulativeRebate:8500},{name:"\u80A1\u6771 B",currentMonthRebate:960,unpaidRebate:500,cumulativeRebate:12e3},{name:"\u80A1\u6771 C",currentMonthRebate:200,unpaidRebate:2200,cumulativeRebate:5500}]}getMonthlyRebateHistory(e){return[{year:2024,month:8,totalRebate:650,unpaidRebate:0},{year:2024,month:7,totalRebate:850,unpaidRebate:850},{year:2024,month:6,totalRebate:500,unpaidRebate:0}].filter(t=>t.totalRebate>0)}getRebateTransactions(e,t,i){let r=`${t}/${String(i).padStart(2,"0")}`;return this.mockRebateTransactions().filter(o=>o.shareholderName===e&&o.checkoutTime.startsWith(r))}updateRebateTransaction(e){this.mockRebateTransactions.update(t=>t.map(i=>i.id===e.id?q(k({},e),{isEdited:!0}):i))}getTargetGoals(){return this.mockTargetGoals()}addTargetGoal(e){let t=q(k({},e),{id:`TG${Date.now()}`});this.mockTargetGoals.update(i=>[...i,t])}updateTargetGoal(e){this.mockTargetGoals.update(t=>t.map(i=>i.id===e.id?e:i))}deleteTargetGoal(e){this.mockTargetGoals.update(t=>t.filter(i=>i.id!==e))}};ho.\u0275fac=function(t){return new(t||ho)},ho.\u0275prov=J({token:ho,factory:ho.\u0275fac,providedIn:"root"});var Tt=ho;var $7=["mainCategoryChart"],H7=["diningChart"],G7=["drinksChart"],q7=["monthlyTrendChart"],W7=(n,e)=>e.month;function j7(n,e){if(n&1&&(l(0,"option",13),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),V("",t,"\u5E74")}}function z7(n,e){if(n&1&&(l(0,"option",13),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),V("",t,"\u6708")}}function Y7(n,e){if(n&1&&(l(0,"option",13),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),V("",t,"\u5E74")}}function J7(n,e){if(n&1&&(l(0,"option",13),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),V("",t,"\u6708")}}function K7(n,e){if(n&1){let t=B();l(0,"div",4)(1,"div",10)(2,"label",11),c(3,"\u5F9E:"),a(),l(4,"select",12),b("ngModelChange",function(r){w(t);let o=v();return T(o.selectedStartYear.set(r))}),O(5,j7,2,2,"option",13,W),a(),l(7,"select",12),b("ngModelChange",function(r){w(t);let o=v();return T(o.selectedStartMonth.set(r))}),O(8,z7,2,2,"option",13,W),a()(),l(10,"div",10)(11,"label",11),c(12,"\u81F3:"),a(),l(13,"select",12),b("ngModelChange",function(r){w(t);let o=v();return T(o.selectedEndYear.set(r))}),O(14,Y7,2,2,"option",13,W),a(),l(16,"select",12),b("ngModelChange",function(r){w(t);let o=v();return T(o.selectedEndMonth.set(r))}),O(17,J7,2,2,"option",13,W),a()(),l(19,"div",14)(20,"button",15),b("click",function(){w(t);let r=v();return T(r.applyAnalysisFilter())}),x(21,"ion-icon",16),l(22,"span"),c(23,"\u5957\u7528"),a()(),l(24,"button",17),b("click",function(){w(t);let r=v();return T(r.resetAnalysisFilter())}),x(25,"ion-icon",18),a()()()}if(n&2){let t=v();f(4),M("ngModel",t.selectedStartYear()),f(),L(t.analysisYears()),f(2),M("ngModel",t.selectedStartMonth()),f(),L(t.analysisMonths()),f(5),M("ngModel",t.selectedEndYear()),f(),L(t.analysisYears()),f(2),M("ngModel",t.selectedEndMonth()),f(),L(t.analysisMonths())}}function Q7(n,e){if(n&1&&(l(0,"option",13),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),V("",t,"\u5E74")}}function Z7(n,e){if(n&1&&(l(0,"option",13),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),V("",t,"\u6708")}}function X7(n,e){if(n&1&&(l(0,"option",13),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),V("",t,"\u5E74")}}function eV(n,e){if(n&1&&(l(0,"option",13),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),V("",t,"\u6708")}}function tV(n,e){if(n&1){let t=B();l(0,"div",4)(1,"div",10)(2,"label",11),c(3,"\u5F9E:"),a(),l(4,"select",12),Z("ngModelChange",function(r){w(t);let o=v();return ee(o.selectedMarginStartYear,r)||(o.selectedMarginStartYear=r),T(r)}),O(5,Q7,2,2,"option",13,W),a(),l(7,"select",12),Z("ngModelChange",function(r){w(t);let o=v();return ee(o.selectedMarginStartMonth,r)||(o.selectedMarginStartMonth=r),T(r)}),O(8,Z7,2,2,"option",13,W),a()(),l(10,"div",10)(11,"label",11),c(12,"\u81F3:"),a(),l(13,"select",12),Z("ngModelChange",function(r){w(t);let o=v();return ee(o.selectedMarginEndYear,r)||(o.selectedMarginEndYear=r),T(r)}),O(14,X7,2,2,"option",13,W),a(),l(16,"select",12),Z("ngModelChange",function(r){w(t);let o=v();return ee(o.selectedMarginEndMonth,r)||(o.selectedMarginEndMonth=r),T(r)}),O(17,eV,2,2,"option",13,W),a()(),l(19,"div",14)(20,"button",15),b("click",function(){w(t);let r=v();return T(r.applyMarginFilter())}),x(21,"ion-icon",16),l(22,"span"),c(23,"\u5957\u7528"),a()(),l(24,"button",17),b("click",function(){w(t);let r=v();return T(r.resetMarginFilter())}),x(25,"ion-icon",18),a()()()}if(n&2){let t=v();f(4),Q("ngModel",t.selectedMarginStartYear),f(),L(t.marginYears()),f(2),Q("ngModel",t.selectedMarginStartMonth),f(),L(t.marginAllMonths()),f(5),Q("ngModel",t.selectedMarginEndYear),f(),L(t.marginYears()),f(2),Q("ngModel",t.selectedMarginEndMonth),f(),L(t.marginAllMonths())}}function nV(n,e){n&1&&(l(0,"div",19)(1,"h3",20),c(2,"\u6708\u92B7\u552E\u8DA8\u52E2"),a(),l(3,"div",26),x(4,"canvas",null,0),a()())}function iV(n,e){n&1&&(l(0,"div",22)(1,"div",27),x(2,"div",28),l(3,"p",29),c(4,"\u8F09\u5165\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u4E2D..."),a()()())}function rV(n,e){if(n&1&&(l(0,"div",23)(1,"div",30),x(2,"ion-icon",31),l(3,"div",32)(4,"p",33),c(5,"\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u8F09\u5165\u5931\u6557"),a(),l(6,"div",34),c(7),a()()(),l(8,"div",35),c(9," \u{1F4A1} \u63D0\u793A\uFF1A\u76EE\u524D\u8CC7\u6599\u5EAB\u4E2D\u53EA\u6709 "),l(10,"strong"),c(11,"2024-2025 \u5E74"),a(),c(12,"\u7684\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u3002 "),a()()),n&2){let t=v(2);f(7),V(" ",t.productSalesError()," ")}}function oV(n,e){if(n&1&&(l(0,"th",40),c(1),a()),n&2){let t=e.$implicit,i=v(3);f(),E(i.formatMonth(t))}}function sV(n,e){n&1&&(l(0,"th",44),c(1,"\u92B7\u552E\u91CF"),a(),l(2,"th",45),c(3,"\u71DF\u696D\u984D"),a(),l(4,"th",45),c(5,"\u71DF\u696D\u984D\u4F54\u6BD4"),a())}function aV(n,e){if(n&1&&(l(0,"td",49),c(1),a()),n&2){let t=v().$implicit;z("bg-yellow-50",t.isSubtotal)("bg-red-100",t.isTotal)("bg-white",!t.isSubtotal&&!t.isTotal),f(),V(" ",t.category," ")}}function lV(n,e){n&1&&x(0,"td",47)}function uV(n,e){if(n&1&&(l(0,"td",50),c(1),a(),l(2,"td",50),c(3),a(),l(4,"td",50),c(5),a()),n&2){let t=e.$implicit,i=v().$implicit,r=v(3);f(),E((i.monthlyData[t]==null?null:i.monthlyData[t].sales)||0),f(2),E(r.formatCurrency((i.monthlyData[t]==null?null:i.monthlyData[t].revenue)||0)),f(2),V("",((i.monthlyData[t]==null?null:i.monthlyData[t].rate)||0).toFixed(2),"%")}}function dV(n,e){if(n&1&&(l(0,"tr"),A(1,aV,2,7,"td",46)(2,lV,1,0,"td",47),l(3,"td",48),c(4),a(),O(5,uV,6,3,null,null,W),a()),n&2){let t=e.$implicit,i=v(3);De(t.isSubtotal?"bg-yellow-50 font-semibold":t.isTotal?"bg-red-100 font-bold":"hover:bg-gray-50"),f(),N(!t.item||t.item==="\u5C0F\u8A08"||t.item==="\u7E3D\u8A08"?1:2),f(2),z("bg-yellow-50",t.isSubtotal)("bg-red-100",t.isTotal)("bg-white",!t.isSubtotal&&!t.isTotal),f(),V(" ",t.item||t.category," "),f(),L(i.monthlySalesData().months)}}function cV(n,e){if(n&1&&(l(0,"div",24)(1,"table",36)(2,"thead",37)(3,"tr")(4,"th",38),c(5,"\u5206\u985E"),a(),l(6,"th",39),c(7,"\u54C1\u9805"),a(),O(8,oV,2,1,"th",40,W),a(),l(10,"tr"),x(11,"th",41)(12,"th",42),O(13,sV,6,0,null,null,W),a()(),l(15,"tbody"),O(16,dV,7,10,"tr",43,bn),a()()()),n&2){let t=v(2);f(8),L(t.monthlySalesData().months),f(5),L(t.monthlySalesData().months),f(3),L(t.monthlySalesData().data)}}function mV(n,e){n&1&&(l(0,"div",25)(1,"p",51),c(2,"\u672A\u627E\u5230\u5546\u54C1\u92B7\u552E\u8CC7\u6599"),a(),l(3,"p",52),c(4,"\u8ACB\u9078\u64C7\u6642\u9593\u7BC4\u570D\u4E26\u5957\u7528\u7BE9\u9078"),a()())}function pV(n,e){if(n&1&&(l(0,"div",1),A(1,nV,6,0,"div",19),l(2,"div")(3,"h3",20),c(4,"\u5546\u54C1\u92B7\u552E\u660E\u7D30\u8868"),a(),l(5,"div",21),A(6,iV,5,0,"div",22),A(7,rV,13,1,"div",23),A(8,cV,18,0,"div",24),A(9,mV,5,0,"div",25),a()()()),n&2){let t=v();f(),N(!t.isLoadingProductSales()&&t.productSalesData().length>0?1:-1),f(5),N(t.isLoadingProductSales()?6:-1),f(),N(t.productSalesError()?7:-1),f(),N(!t.isLoadingProductSales()&&t.monthlySalesData().data.length>0?8:-1),f(),N(!t.isLoadingProductSales()&&t.monthlySalesData().data.length===0&&!t.productSalesError()?9:-1)}}function fV(n,e){n&1&&(l(0,"div",22)(1,"div",27),x(2,"div",28),l(3,"p",29),c(4,"\u8F09\u5165\u5546\u54C1\u6BDB\u5229\u8CC7\u6599\u4E2D..."),a()()())}function gV(n,e){if(n&1&&(l(0,"div",23)(1,"div",30),x(2,"ion-icon",31),l(3,"div",32)(4,"p",33),c(5,"\u5546\u54C1\u6BDB\u5229\u8CC7\u6599\u8F09\u5165\u5931\u6557"),a(),l(6,"div",34),c(7),a()()(),l(8,"div",35),c(9," \u{1F4A1} \u63D0\u793A\uFF1A\u76EE\u524D\u8CC7\u6599\u5EAB\u4E2D\u53EA\u6709 "),l(10,"strong"),c(11,"2024-2025 \u5E74"),a(),c(12,"\u7684\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u3002 "),a()()),n&2){let t=v(2);f(7),V(" ",t.marginDataError()," ")}}function hV(n,e){if(n&1&&(l(0,"tr",64)(1,"td",65),c(2),a(),l(3,"td"),c(4),a(),l(5,"td"),c(6),a(),l(7,"td"),c(8),a(),l(9,"td"),c(10),a(),l(11,"td",66),c(12),a()()),n&2){let t=e.$implicit,i=v(3);f(2),E(t.month),f(2),E(i.formatCurrency(t.dining)),f(2),E(i.formatCurrency(t.drinks)),f(2),E(i.formatCurrency(t.cigars)),f(2),E(i.formatCurrency(t.venue)),f(2),E(i.formatCurrency(t.total))}}function yV(n,e){n&1&&(l(0,"tr")(1,"td",67),c(2,"\u6B64\u6642\u9593\u5340\u9593\u7121\u8CC7\u6599\u3002"),a()())}function _V(n,e){if(n&1&&(l(0,"div",21)(1,"table",53)(2,"thead",54)(3,"tr",55),x(4,"th",56),l(5,"th",57),c(6,"\u9910\u98F2"),a(),l(7,"th",57),c(8,"\u9152\u6C34"),a(),l(9,"th",57),c(10,"\u96EA\u8304(\u542B\u61C9\u4ED8)"),a(),l(11,"th",57),c(12,"\u6D3B\u52D5\u5834\u5730"),a(),l(13,"th",57),c(14,"\u5C0F\u8A08"),a()()(),l(15,"tbody")(16,"tr",58)(17,"td",59),c(18,"\u9032\u8CA8\u7E3D\u8A08"),a(),l(19,"td"),c(20),a(),l(21,"td"),c(22),a(),l(23,"td"),c(24),a(),l(25,"td",60),c(26,"--"),a(),l(27,"td",61),c(28),a()(),l(29,"tr",58)(30,"td",59),c(31,"\u92B7\u8CA8\u7E3D\u8A08(\u6263\u6298\u8B93)"),a(),l(32,"td"),c(33),a(),l(34,"td"),c(35),a(),l(36,"td"),c(37),a(),l(38,"td"),c(39),a(),l(40,"td",61),c(41),a()(),l(42,"tr",62)(43,"td",59),c(44,"\u6BDB\u5229"),a(),l(45,"td"),c(46),a(),l(47,"td"),c(48),a(),l(49,"td"),c(50),a(),l(51,"td",60),c(52,"--"),a(),l(53,"td",61),c(54),a()(),l(55,"tr",63)(56,"td",59),c(57,"\u6BDB\u5229\u7387"),a(),l(58,"td"),c(59),a(),l(60,"td"),c(61),a(),l(62,"td"),c(63),a(),l(64,"td",60),c(65,"--"),a(),l(66,"td",61),c(67),a()(),O(68,hV,13,6,"tr",64,W7,!1,yV,3,0,"tr"),a()()()),n&2){let t=e,i=v(2);f(20),E(i.formatCurrency(t.summary.dining.totalPurchases)),f(2),E(i.formatCurrency(t.summary.drinks.totalPurchases)),f(2),E(i.formatCurrency(t.summary.cigars.totalPurchases)),f(4),E(i.formatCurrency(t.summary.total.totalPurchases)),f(5),E(i.formatCurrency(t.summary.dining.totalSales)),f(2),E(i.formatCurrency(t.summary.drinks.totalSales)),f(2),E(i.formatCurrency(t.summary.cigars.totalSales)),f(2),E(i.formatCurrency(t.summary.venue.totalSales)),f(2),E(i.formatCurrency(t.summary.total.totalSales)),f(4),z("text-red-600",t.summary.dining.grossMargin<0),f(),E(i.formatCurrency(t.summary.dining.grossMargin)),f(),z("text-red-600",t.summary.drinks.grossMargin<0),f(),E(i.formatCurrency(t.summary.drinks.grossMargin)),f(),z("text-red-600",t.summary.cigars.grossMargin<0),f(),E(i.formatCurrency(t.summary.cigars.grossMargin)),f(3),z("text-red-600",t.summary.total.grossMargin<0),f(),E(i.formatCurrency(t.summary.total.grossMargin)),f(4),z("text-red-600",t.summary.dining.grossMarginRate<0),f(),V("",(t.summary.dining.grossMarginRate*100).toFixed(2),"%"),f(),z("text-red-600",t.summary.drinks.grossMarginRate<0),f(),V("",(t.summary.drinks.grossMarginRate*100).toFixed(2),"%"),f(),z("text-red-600",t.summary.cigars.grossMarginRate<0),f(),V("",(t.summary.cigars.grossMarginRate*100).toFixed(2),"%"),f(3),z("text-red-600",t.summary.total.grossMarginRate<0),f(),V("",(t.summary.total.grossMarginRate*100).toFixed(2),"%"),f(),L(t.monthlySales)}}function vV(n,e){n&1&&(l(0,"div",25)(1,"p",51),c(2,"\u672A\u627E\u5230\u5546\u54C1\u6BDB\u5229\u8CC7\u6599"),a(),l(3,"p",52),c(4,"\u8ACB\u9078\u64C7\u6642\u9593\u7BC4\u570D\u4E26\u5957\u7528\u7BE9\u9078"),a()())}function CV(n,e){if(n&1&&(A(0,fV,5,0,"div",22),A(1,gV,13,1,"div",23),A(2,_V,71,34,"div",21),A(3,vV,5,0,"div",25)),n&2){let t,i=v();N(i.isLoadingMarginData()?0:-1),f(),N(i.marginDataError()?1:-1),f(),N((t=!i.isLoadingMarginData()&&i.productGrossMarginReport())?2:-1,t),f(),N(!i.isLoadingMarginData()&&!i.productGrossMarginReport()&&!i.marginDataError()?3:-1)}}var Os=class Os{constructor(){this.apiService=P(rt);this.dataService=P(Tt);this.injector=P(Jt);this.chartInstances=[];this.colors={main:["#3b82f6","#8b5cf6","#ef4444","#f59e0b"],sub:["#1d4ed8","#3b82f6","#60a5fa","#93c5fd","#bfdbfe"]};this.activeView=S("analysis");this.productSalesData=S([]);this.isLoadingProductSales=S(!1);this.productSalesError=S(null);this.report=S(null);this.analysisYears=S([2025,2024,2023]);this.analysisMonths=S(Array.from({length:12},(e,t)=>t+1));this.selectedStartYear=S(new Date().getMonth()>=3?new Date().getFullYear():new Date().getFullYear()-1);this.selectedStartMonth=S(new Date().getMonth()>=3?new Date().getMonth()-2:new Date().getMonth()+10);this.selectedEndYear=S(new Date().getFullYear());this.selectedEndMonth=S(new Date().getMonth()+1);this.productGrossMarginReport=S(null);this.isLoadingMarginData=S(!1);this.marginDataError=S(null);this.marginYears=S([2025,2024]);this.marginAllMonths=S(Array.from({length:12},(e,t)=>t+1));this.selectedMarginStartYear=S(2024);this.selectedMarginStartMonth=S(12);this.selectedMarginEndYear=S(2025);this.selectedMarginEndMonth=S(12);this.monthlySalesData=H(()=>{let e=this.productSalesData();if(!e||e.length===0)return{months:[],data:[]};let t=this.buildMonthRange(this.selectedStartYear(),this.selectedStartMonth(),this.selectedEndYear(),this.selectedEndMonth());if(console.log("========== monthlySalesData \u8A08\u7B97\u958B\u59CB =========="),console.log("\u9078\u64C7\u7684\u6708\u4EFD\u7BC4\u570D:",t),console.log("\u6536\u5230\u7684\u5206\u985E\u6578:",e.length),e[0]&&console.log("\u7B2C\u4E00\u500B\u5206\u985E\u7684\u6708\u4EFD:",e[0].items.map(u=>u.reportMonth)),t.length===0)return console.warn("\u6708\u4EFD\u7BC4\u570D\u70BA\u7A7A\uFF01"),{months:[],data:[]};let i=[{name:"\u5176\u4ED6",items:["\u5834\u5730\u4F7F\u7528\u8CBB","\u6D3B\u52D5"]},{name:"\u9152\u6C34",items:["\u8ABF\u9152","\u7D05\u9152/\u767D\u9152","\u5564\u9152","\u5A01\u58EB\u5FCC"]},{name:"\u9910\u98F2",items:["\u4E3B\u98DF","\u70B8\u7269","\u5976\u6614","\u6C23\u6CE1\u98F2","\u55AE\u9EDE","\u8336\u98F2","\u8C9D\u679C/\u53EF\u980C","\u5496\u5561","\u751C\u9EDE","\u6C99\u62C9","\u4E0B\u5348\u8336\u5957\u9910"]},{name:"\u96EA\u8304",items:["\u96EA\u8304"]}],r={};i.forEach(u=>{r[u.name]={},t.forEach(d=>{let m=0,h=0;u.items.forEach(y=>{let _=e.find(C=>C.categoryName===y);if(_){let C=_.items.filter(D=>D.reportMonth===d);m+=C.reduce((D,I)=>D+(I.salesNumber||0),0),h+=C.reduce((D,I)=>D+(I.salesAmount||0),0)}}),r[u.name][d]={sales:m,revenue:h}})});let o=[];i.forEach(u=>{if(u.items.length===1&&u.items[0]==="\u96EA\u8304"){let d={};t.forEach(m=>{let h=r[u.name][m];d[m]={sales:h.sales,revenue:h.revenue,rate:0}}),o.push({category:u.name,item:null,isCategory:!0,monthlyData:d})}else{u.items.forEach(m=>{let h={};t.forEach(y=>{let _=e.find(C=>C.categoryName===m);if(_){let C=_.items.filter(R=>R.reportMonth===y),D=C.reduce((R,F)=>R+(F.salesNumber||0),0),I=C.reduce((R,F)=>R+(F.salesAmount||0),0);I>0&&console.log(`\u2713 ${m} ${y}: \u71DF\u696D\u984D=${I}, \u92B7\u91CF=${D}`),h[y]={sales:D,revenue:I,rate:0}}else h[y]={sales:0,revenue:0,rate:0}}),o.push({category:u.name,item:m,isCategory:!1,isItem:!0,monthlyData:h})});let d={};t.forEach(m=>{let h=r[u.name][m];d[m]={sales:h.sales,revenue:h.revenue,rate:0}}),o.push({category:u.name,item:"\u5C0F\u8A08",isSubtotal:!0,monthlyData:d})}}),t.forEach(u=>{let d=i.reduce((m,h)=>m+(r[h.name][u]?.revenue||0),0);o.forEach(m=>{if(m.monthlyData[u]){if(m.isSubtotal||m.isCategory)m.monthlyData[u].rate=d>0?m.monthlyData[u].revenue/d*100:0;else if(m.isItem){let h=r[m.category][u];m.monthlyData[u].rate=h.revenue>0?m.monthlyData[u].revenue/h.revenue*100:0}}})});let s={};return t.forEach(u=>{let d=i.reduce((h,y)=>h+(r[y.name][u]?.sales||0),0),m=i.reduce((h,y)=>h+(r[y.name][u]?.revenue||0),0);s[u]={sales:d,revenue:m,rate:100}}),o.push({category:"\u5408\u8A08",item:"\u7E3D\u8A08",isTotal:!0,monthlyData:s}),{months:t,data:o}});this.summaryMetrics=H(()=>{let e=this.productSalesData();if(!e||e.length===0)return{uniqueProducts:0,totalItemsSold:0,bestContributor:"N/A",totalRevenue:0};let t=e.flatMap(s=>s.items),i=t.length>0?t.sort((s,u)=>u.salesAmount-s.salesAmount)[0]:null,r=e.reduce((s,u)=>s+u.salesAmount,0),o=e.reduce((s,u)=>s+u.salesNumber,0);return{uniqueProducts:t.length,totalItemsSold:o,bestContributor:i?.itemName||"N/A",totalRevenue:r}});this.chartData=H(()=>{let e=this.productSalesData();if(!e||e.length===0)return{main:[],dining:[],drinks:[],cigars:[],other:[]};let t=e.map(r=>({name:r.categoryName,value:r.salesAmount})),i=r=>{let o=e.find(s=>s.categoryName===r);return o?o.items.map(s=>({name:s.itemName,value:s.salesAmount})):[]};return{main:t,dining:i("\u9910\u98F2"),drinks:i("\u9152\u6C34"),cigars:i("\u96EA\u8304"),other:i("\u5176\u4ED6")}});this.monthlyTrendChartData=H(()=>{let e=this.productSalesData();if(console.log("\u{1F4C8} monthlyTrendChartData computed \u88AB\u89F8\u767C"),console.log("categories \u9577\u5EA6:",e?.length),!e||e.length===0)return console.warn("\u26A0\uFE0F \u6C92\u6709 productSalesData"),{labels:[],datasets:[]};let t=this.buildMonthRange(this.selectedStartYear(),this.selectedStartMonth(),this.selectedEndYear(),this.selectedEndMonth());if(console.log("sortedMonths:",t),t.length===0)return console.warn("\u26A0\uFE0F sortedMonths \u70BA\u7A7A"),{labels:[],datasets:[]};let i=t.map(s=>this.formatMonth(s));console.log("\u5716\u8868 labels:",i);let o=[{displayName:"\u5176\u4ED6",dbCategories:["\u5834\u5730\u4F7F\u7528\u8CBB","\u6D3B\u52D5"],color:"#10b981"},{displayName:"\u9152\u6C34",dbCategories:["\u8ABF\u9152","\u7D05\u9152/\u767D\u9152","\u5564\u9152","\u5A01\u58EB\u5FCC"],color:"#8b5cf6"},{displayName:"\u9910\u98F2",dbCategories:["\u4E3B\u98DF","\u70B8\u7269","\u5976\u6614","\u6C23\u6CE1\u98F2","\u55AE\u9EDE","\u8336\u98F2","\u8C9D\u679C/\u53EF\u980C","\u5496\u5561","\u751C\u9EDE","\u6C99\u62C9","\u4E0B\u5348\u8336\u5957\u9910"],color:"#3b82f6"},{displayName:"\u96EA\u8304",dbCategories:["\u96EA\u8304"],color:"#ef4444"}].map(s=>{let u=t.map(d=>{let m=0;return s.dbCategories.forEach(h=>{let y=e.find(_=>_.categoryName===h);if(y){let _=y.items.filter(C=>C.reportMonth===d);m+=_.reduce((C,D)=>C+(D.salesAmount||0),0)}}),m});return{label:s.displayName,data:u,borderColor:s.color,backgroundColor:`${s.color}1A`,fill:!0,tension:.4}});return console.log("datasets \u751F\u6210\u5B8C\u6210:",o.map(s=>({label:s.label,dataLength:s.data.length}))),{labels:i,datasets:o}});this.applyAnalysisFilter(),this.applyMarginFilter(),$i(()=>{this.activeView()==="analysis"&&this.createAllCharts(this.chartData())}),Ci(()=>{let e=this.activeView();At(this.injector,()=>{$i(()=>{e==="analysis"?this.updateAllCharts(this.chartData()):this.destroyCharts()})})})}changeView(e){this.activeView.set(e)}async applyAnalysisFilter(){let e=`${this.selectedStartYear()}-${String(this.selectedStartMonth()).padStart(2,"0")}`,t=`${this.selectedEndYear()}-${String(this.selectedEndMonth()).padStart(2,"0")}`;if(e>t){this.productSalesError.set("\u274C \u932F\u8AA4\uFF1A\u8D77\u59CB\u5E74\u6708\u4E0D\u80FD\u665A\u65BC\u7D50\u675F\u5E74\u6708\u3002");return}if(this.selectedStartYear()===2026){this.productSalesError.set(`\u26A0\uFE0F \u63D0\u793A\uFF1A\u8CC7\u6599\u5EAB\u4E2D\u76EE\u524D\u53EA\u6709 2024-2025 \u5E74\u7684\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u3002
\u5DF2\u81EA\u52D5\u8ABF\u6574\u70BA 2025 \u5E74\u3002\u8ACB\u9EDE\u64CA\u300C\u5957\u7528\u300D\u91CD\u65B0\u67E5\u8A62\u3002`),this.selectedStartYear.set(2025),this.selectedEndYear.set(2025);return}this.isLoadingProductSales.set(!0),this.productSalesError.set(null);try{console.log("\u2550".repeat(60)),console.log("\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u67E5\u8A62"),console.log("\u2550".repeat(60)),console.log("\u67E5\u8A62\u53C3\u6578:",{startMonth:e,endMonth:t,selectedYear:this.selectedStartYear()});let r=await this.apiService.getProductSales({startMonth:e,endMonth:t,limit:1e4});if(console.log("API \u539F\u59CB\u56DE\u61C9:",{success:r.success,total:r.total,count:r.count,dataLength:r.data?r.data.length:0,categoriesLength:r.categories?r.categories.length:0}),console.log("API \u5B8C\u6574\u56DE\u61C9 data \u524D10\u7B46:",r.data?.slice(0,10)),!r)throw new Error("API \u8FD4\u56DE\u7A7A\u56DE\u61C9");if(!r.success)throw new Error(`API \u8FD4\u56DE\u5931\u6557: ${r.error||"\u672A\u77E5\u932F\u8AA4"}`);if(r.data&&r.data.length>0){console.log(`\u2713 \u6536\u5230 ${r.data.length} \u7B46\u539F\u59CB\u8CC7\u6599\uFF0C\u6B63\u5728\u6309\u5206\u985E\u5206\u7D44...`),console.log("\u524D5\u7B46\u539F\u59CB\u8CC7\u6599:",r.data.slice(0,5));let o=new Map;r.data.forEach(d=>{let m=d.reportMonth;o.set(m,(o.get(m)||0)+1)}),console.log("\u6708\u4EFD\u5206\u4F48:",Array.from(o.entries()).sort());let s=new Map;r.data.forEach(d=>{let m=d.categoryName||"\u5176\u4ED6";s.has(m)||s.set(m,[]),s.get(m).push(d)});let u=[];s.forEach((d,m)=>{console.log(`\u5206\u985E "${m}" \u6709 ${d.length} \u7B46\u8CC7\u6599`),u.push({categoryName:m,categoryUuid:d[0].categoryUuid||"",items:d})}),console.log(`\u2713 \u5206\u7D44\u5B8C\u6210\uFF1A${u.length} \u500B\u5206\u985E`),console.log("\u7B2C\u4E00\u500B\u5206\u985E:",u[0]),u[0]&&(console.log("\u7B2C\u4E00\u500B\u5206\u985E\u7684 items \u6578\u91CF:",u[0].items.length),console.log("\u7B2C\u4E00\u500B\u5206\u985E\u7684\u524D3\u500B items:",u[0].items.slice(0,3))),this.productSalesData.set(u),setTimeout(()=>{console.log("\u{1F4CA} \u6E96\u5099\u66F4\u65B0\u6708\u92B7\u552E\u8DA8\u52E2\u5716\u8868..."),this.createMonthlyTrendChartOnly()},100)}else if(!r.categories||r.categories.length===0)if(console.warn("\u26A0\uFE0F API \u8FD4\u56DE success=true \u4F46 categories \u9663\u5217\u70BA\u7A7A"),console.warn("API \u56DE\u61C9\u9375\u503C:",Object.keys(r)),console.warn("\u5B8C\u6574\u56DE\u61C9:",JSON.stringify(r,null,2)),r.data&&r.data.length>0){console.log("\u2713 \u6AA2\u6E2C\u5230 data \u6B04\u4F4D\u6709\u8CC7\u6599\uFF0C\u6B63\u5728\u91CD\u65B0\u5206\u7D44...");let o=new Map;r.data.forEach(u=>{let d=u.categoryName||"\u5176\u4ED6";o.has(d)||o.set(d,[]),o.get(d).push(u)});let s=[];o.forEach((u,d)=>{let m=u.reduce((y,_)=>y+Number(_.salesAmount||0),0),h=u.reduce((y,_)=>y+Number(_.salesNumber||0),0);s.push({categoryName:d,categoryUuid:u[0].categoryUuid||"",reportMonth:u[0].reportMonth||"",salesAmount:m,salesNumber:h,averagePrice:h>0?m/h:0,items:u})}),console.log(`\u2713 \u5F9E data \u91CD\u65B0\u5206\u7D44\u6210 ${s.length} \u500B\u5206\u985E`),this.productSalesData.set(s),setTimeout(()=>{console.log("\u{1F4CA} \u6E96\u5099\u66F4\u65B0\u6708\u92B7\u552E\u8DA8\u52E2\u5716\u8868..."),this.createMonthlyTrendChartOnly()},100)}else{let o=`\u2717 \u67E5\u8A62\u6642\u9593\u7BC4\u570D\uFF1A${e} \u5230 ${t}
\u2717 API \u8FD4\u56DE\uFF1Atotal=${r.total}, count=${r.count}
\u2717 \u5EFA\u8B70\uFF1A\u9078\u64C7 2024-2025 \u5E74\u9593\u7684\u6708\u4EFD`;this.productSalesError.set(`\u7121\u6CD5\u7372\u53D6\u5546\u54C1\u92B7\u552E\u8CC7\u6599

\u53EF\u80FD\u539F\u56E0\uFF1A
1. \u9078\u64C7\u7684\u6642\u9593\u7BC4\u570D\u6C92\u6709\u92B7\u552E\u8A18\u9304
2. \u8CC7\u6599\u5EAB\u4E2D\u8A72\u6708\u4EFD\u7121\u5546\u54C1\u92B7\u552E\u8CC7\u6599
3. \u8ACB\u9078\u64C7 2024 \u6216 2025 \u5E74

`+o)}}catch(r){console.error("\u274C \u8F09\u5165\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u6642\u767C\u751F\u932F\u8AA4:",r);let o=r instanceof Error?r.message:"\u8F09\u5165\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66";this.productSalesError.set(`\u274C \u932F\u8AA4\uFF1A${o}

\u8A66\u8A66\u770B\uFF1A
1. \u78BA\u8A8D\u5F8C\u7AEF\u670D\u52D9\u5DF2\u555F\u52D5
2. \u9078\u64C7 2024-2025 \u5E74\u7684\u6708\u4EFD
3. \u6253\u958B\u700F\u89BD\u5668 F12 \u67E5\u770B\u8A73\u7D30\u932F\u8AA4`),this.productSalesData.set([])}finally{this.isLoadingProductSales.set(!1)}}resetAnalysisFilter(){let e=new Date,t=e.getFullYear(),i=e.getMonth()+1;i>=4?(this.selectedStartYear.set(t),this.selectedStartMonth.set(i-3)):(this.selectedStartYear.set(t-1),this.selectedStartMonth.set(i+9)),this.selectedEndYear.set(t),this.selectedEndMonth.set(i),this.productSalesError.set(null),this.applyAnalysisFilter()}async applyMarginFilter(){let e=`${this.selectedMarginStartYear()}-${String(this.selectedMarginStartMonth()).padStart(2,"0")}`,t=`${this.selectedMarginEndYear()}-${String(this.selectedMarginEndMonth()).padStart(2,"0")}`;if(e>t){this.marginDataError.set("\u274C \u932F\u8AA4\uFF1A\u8D77\u59CB\u5E74\u6708\u4E0D\u80FD\u665A\u65BC\u7D50\u675F\u5E74\u6708\u3002");return}this.isLoadingMarginData.set(!0),this.marginDataError.set(null);try{console.log("\u2550".repeat(60)),console.log("\u5546\u54C1\u6BDB\u5229\u8CC7\u6599\u67E5\u8A62"),console.log("\u2550".repeat(60)),console.log("\u67E5\u8A62\u53C3\u6578:",{startMonth:e,endMonth:t});let[i,r]=await Promise.all([this.apiService.getProductSales({startMonth:e,endMonth:t,limit:1e4}),this.apiService.getPurchaseCosts({startMonth:e,endMonth:t})]);if(!i||!i.success)throw new Error(`\u92B7\u552E\u6578\u64DA API \u8FD4\u56DE\u5931\u6557: ${i?.error||"\u672A\u77E5\u932F\u8AA4"}`);if(!r||!r.success)throw new Error(`\u9032\u8CA8\u6578\u64DA API \u8FD4\u56DE\u5931\u6557: ${r?.error||"\u672A\u77E5\u932F\u8AA4"}`);if(!i.data||i.data.length===0){this.marginDataError.set(`\u26A0\uFE0F \u63D0\u793A\uFF1A\u9078\u64C7\u7684\u6642\u9593\u7BC4\u570D\u5167\u6C92\u6709\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u3002

\u76EE\u524D\u8CC7\u6599\u5EAB\u4E2D\u53EA\u6709 2024-2025 \u5E74\u7684\u5546\u54C1\u92B7\u552E\u8CC7\u6599\u3002`),this.productGrossMarginReport.set(null);return}console.log(`\u2713 \u6536\u5230 ${i.data.length} \u7B46\u5546\u54C1\u92B7\u552E\u8CC7\u6599`),console.log("\u2713 \u6536\u5230\u9032\u8CA8\u6210\u672C\u8CC7\u6599:",r.data.summary);let o={\u9910\u98F2:["\u4E3B\u98DF","\u70B8\u7269","\u5976\u6614","\u6C23\u6CE1\u98F2","\u55AE\u9EDE","\u8336\u98F2","\u8C9D\u679C/\u53EF\u980C","\u5496\u5561","\u751C\u9EDE","\u6C99\u62C9","\u4E0B\u5348\u8336\u5957\u9910"],\u9152\u6C34:["\u8ABF\u9152","\u7D05\u9152/\u767D\u9152","\u5564\u9152","\u5A01\u58EB\u5FCC"],\u96EA\u8304:["\u96EA\u8304"],\u6D3B\u52D5\u5834\u5730:["\u5834\u5730\u4F7F\u7528\u8CBB","\u6D3B\u52D5","\u5176\u4ED6"]},s=r.data.summary,u={dining:{totalPurchases:s.dining,totalSales:0,grossMargin:0,grossMarginRate:0},drinks:{totalPurchases:s.drinks,totalSales:0,grossMargin:0,grossMarginRate:0},cigars:{totalPurchases:s.cigars,totalSales:0,grossMargin:0,grossMarginRate:0},venue:{totalPurchases:null,totalSales:0,grossMargin:null,grossMarginRate:null},total:{totalPurchases:s.total,totalSales:0,grossMargin:0,grossMarginRate:0}},d=new Map;i.data.forEach(h=>{let y=h.categoryName||"\u5176\u4ED6",_=h.salesAmount||0,C=h.reportMonth,D=null;if(o.\u9910\u98F2.includes(y)?D="dining":o.\u9152\u6C34.includes(y)?D="drinks":o.\u96EA\u8304.includes(y)?D="cigars":o.\u6D3B\u52D5\u5834\u5730.includes(y)&&(D="venue"),D){u[D].totalSales+=_,u.total.totalSales+=_,d.has(C)||d.set(C,{month:C.replace("-","/"),dining:0,drinks:0,cigars:0,venue:0,total:0});let I=d.get(C);I[D]+=_,I.total+=_}}),["dining","drinks","cigars","total"].forEach(h=>{let y=u[h];y.totalPurchases!==null&&(y.grossMargin=y.totalSales-y.totalPurchases,y.grossMarginRate=y.totalSales>0?y.grossMargin/y.totalSales:0)});let m=Array.from(d.values()).sort((h,y)=>h.month.localeCompare(y.month));console.log("\u2713 \u5546\u54C1\u6BDB\u5229\u8A08\u7B97\u5B8C\u6210:",{summary:u,monthlySalesCount:m.length}),this.productGrossMarginReport.set({summary:u,monthlySales:m})}catch(i){console.error("\u274C \u8F09\u5165\u5546\u54C1\u6BDB\u5229\u8CC7\u6599\u6642\u767C\u751F\u932F\u8AA4:",i);let r=i instanceof Error?i.message:"\u8F09\u5165\u5546\u54C1\u6BDB\u5229\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66";this.marginDataError.set(`\u274C \u932F\u8AA4\uFF1A${r}

\u63D0\u793A\uFF1A
1. \u78BA\u8A8D\u5F8C\u7AEF\u670D\u52D9\u5DF2\u555F\u52D5
2. \u9078\u64C7 2024-2025 \u5E74\u7684\u6708\u4EFD
3. \u6253\u958B\u700F\u89BD\u5668 F12 \u67E5\u770B\u8A73\u7D30\u932F\u8AA4`),this.productGrossMarginReport.set(null)}finally{this.isLoadingMarginData.set(!1)}}resetMarginFilter(){this.selectedMarginStartYear.set(2024),this.selectedMarginStartMonth.set(12),this.selectedMarginEndYear.set(2025),this.selectedMarginEndMonth.set(12),this.applyMarginFilter()}formatMonth(e){return`${parseInt(e.split("-")[1],10)}\u6708`}buildMonthRange(e,t,i,r){let o=Number(e),s=Number(t),u=Number(i),d=Number(r);if(!o||!s||!u||!d)return[];let m=[],h=o,y=s;for(;h<u||h===u&&y<=d;)m.push(`${h}-${String(y).padStart(2,"0")}`),y+=1,y>12&&(y=1,h+=1);return m}formatCurrency(e){return e==null?"NT$0":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}createAllCharts(e){this.destroyCharts(),this.mainCategoryChart=this.createDonutChart(this.mainCategoryChartRef,e.main,"\u4E3B\u8981\u5206\u985E\u71DF\u6536\u4F54\u6BD4",this.colors.main),this.diningChart=this.createDonutChart(this.diningChartRef,e.dining,"\u9910\u98F2\u985E\u54C1\u9805\u4F54\u6BD4",this.colors.sub),this.drinksChart=this.createDonutChart(this.drinksChartRef,e.drinks,"\u9152\u6C34\u985E\u54C1\u9805\u4F54\u6BD4",this.colors.sub),this.chartInstances=[this.mainCategoryChart,this.diningChart,this.drinksChart].filter(t=>t)}createMonthlyTrendChartOnly(){console.log("\u{1F4CA} createMonthlyTrendChartOnly \u88AB\u8ABF\u7528");let e=this.monthlyTrendChartData();if(console.log("\u5716\u8868\u8CC7\u6599:",{labelsLength:e.labels?.length,datasetsLength:e.datasets?.length,labels:e.labels,datasets:e.datasets?.map(t=>({label:t.label,dataLength:t.data?.length,data:t.data}))}),!this.monthlyTrendChartRef){console.error("\u274C monthlyTrendChartRef \u4E0D\u5B58\u5728\uFF01");return}if(!this.monthlyTrendChartRef.nativeElement){console.error("\u274C monthlyTrendChartRef.nativeElement \u4E0D\u5B58\u5728\uFF01");return}if(console.log("\u2713 Canvas \u5143\u7D20\u5B58\u5728"),this.monthlyTrendChart){console.log("\u{1F5D1}\uFE0F \u92B7\u6BC0\u820A\u5716\u8868");try{this.monthlyTrendChart.destroy()}catch(t){console.warn("\u92B7\u6BC0\u5716\u8868\u6642\u51FA\u932F\uFF08\u53EF\u80FD\u5DF2\u88AB\u92B7\u6BC0\uFF09:",t)}this.monthlyTrendChart=null}e.labels.length>0?(console.log("\u{1F3A8} \u5275\u5EFA\u65B0\u5716\u8868\uFF0Clabels:",e.labels.length,"datasets:",e.datasets.length),this.monthlyTrendChart=this.createMonthlyTrendChart(this.monthlyTrendChartRef,e),this.monthlyTrendChart?console.log("\u2705 \u5716\u8868\u5275\u5EFA\u6210\u529F\uFF01",this.monthlyTrendChart):console.error("\u274C \u5716\u8868\u5275\u5EFA\u5931\u6557\uFF01createMonthlyTrendChart \u8FD4\u56DE null")):console.warn("\u26A0\uFE0F \u6C92\u6709\u5716\u8868\u8CC7\u6599\uFF08labels \u70BA\u7A7A\uFF09")}updateAllCharts(e){this.destroyCharts(),this.createAllCharts(e)}destroyCharts(){this.chartInstances.forEach(e=>e?.destroy()),this.chartInstances=[],this.monthlyTrendChart&&(this.monthlyTrendChart.destroy(),this.monthlyTrendChart=null)}createTooltipCallback(e){return t=>{let i=t.label||"",r=t.raw||0,o=e>0?(r/e*100).toFixed(2):0,s=new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0}).format(r);return`${i}: ${s} (${o}%)`}}createDonutChart(e,t,i,r){if(!e||!e.nativeElement||t.length===0)return null;let o=e.nativeElement.getContext("2d");if(!o)return null;let s=t.reduce((u,d)=>u+d.value,0);return new Chart(o,{type:"doughnut",data:{labels:t.map(u=>u.name),datasets:[{data:t.map(u=>u.value),backgroundColor:r,hoverOffset:4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!0,text:i,font:{size:16}},legend:{display:!0,position:"bottom",labels:{boxWidth:12,padding:15}},tooltip:{callbacks:{label:this.createTooltipCallback(s)}}}}})}createMonthlyTrendChart(e,t){if(!e||!e.nativeElement||t.datasets.length===0)return null;let i=e.nativeElement.getContext("2d");return i?new Chart(i,{type:"line",data:t,options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{callback:r=>this.formatCurrency(r)}}},plugins:{title:{display:!0,text:"\u6BCF\u6708\u54C1\u9805\u71DF\u6536\u8DA8\u52E2",font:{size:16}},legend:{display:!0,position:"bottom"},tooltip:{callbacks:{label:r=>`${r.dataset.label}: ${this.formatCurrency(r.raw)}`}}}}}):null}};Os.\u0275fac=function(t){return new(t||Os)},Os.\u0275cmp=ie({type:Os,selectors:[["app-product-analysis"]],viewQuery:function(t,i){if(t&1&&(Sn($7,5),Sn(H7,5),Sn(G7,5),Sn(q7,5)),t&2){let r;on(r=sn())&&(i.mainCategoryChartRef=r.first),on(r=sn())&&(i.diningChartRef=r.first),on(r=sn())&&(i.drinksChartRef=r.first),on(r=sn())&&(i.monthlyTrendChartRef=r.first)}},decls:16,vars:8,consts:[["monthlyTrendChart",""],[1,"space-y-8"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"flex","flex-col","sm:flex-row","items-center","gap-2","bg-white","p-3","rounded-xl","shadow-md","border","border-gray-200"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"border-b","border-gray-200"],["aria-label","Tabs",1,"-mb-px","flex","space-x-6"],[1,"whitespace-nowrap","py-4","px-1","border-b-2","font-medium","text-sm",3,"click"],[1,"pt-6"],[1,"flex","items-center","gap-2"],[1,"text-sm","font-medium","text-gray-600"],[1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100",3,"ngModelChange","ngModel"],[3,"value"],[1,"flex","items-center","gap-2","mt-2","sm:mt-0"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","filter-outline"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"bg-white","p-6","rounded-xl","shadow-inner","border","mb-6"],[1,"text-lg","font-semibold","text-gray-800","mb-4"],[1,"overflow-x-auto"],[1,"flex","items-center","justify-center","h-32","bg-white","rounded-xl"],[1,"bg-red-50","border-l-4","border-red-500","p-4","rounded-lg","mb-4","space-y-3"],[1,"overflow-x-auto","border","rounded-lg",2,"max-width","100%"],[1,"bg-gray-50","border","border-gray-200","rounded-lg","p-8","text-center"],[1,"h-80"],[1,"flex","flex-col","items-center","space-y-2"],[1,"w-8","h-8","border-3","border-indigo-200","border-t-indigo-600","rounded-full","animate-spin"],[1,"text-sm","text-gray-500"],[1,"flex","items-start","gap-3"],["name","alert-circle-outline",1,"text-2xl","text-red-600","flex-shrink-0","mt-1"],[1,"flex-grow"],[1,"font-bold","text-red-900","text-lg"],[1,"mt-2","text-sm","text-red-800","whitespace-pre-wrap","leading-relaxed"],[1,"bg-red-100","p-3","rounded","text-sm","text-red-900","font-medium"],[1,"text-sm","text-left","border-collapse","bg-white",2,"min-width","100%","width","max-content"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100","sticky","top-0","z-40"],["scope","col",1,"px-3","py-2","border","border-gray-300","font-semibold","sticky","left-0","bg-gray-100","z-50",2,"min-width","80px"],["scope","col",1,"px-3","py-2","border","border-gray-300","font-semibold","sticky","bg-gray-100","z-50",2,"left","80px","min-width","120px"],["scope","col","colspan","3",1,"px-2","py-2","border","border-gray-300","text-center","font-semibold","bg-gray-100",2,"min-width","200px"],[1,"px-3","py-2","border","border-gray-300","sticky","left-0","bg-gray-100","z-50"],[1,"px-3","py-2","border","border-gray-300","sticky","bg-gray-100","z-50",2,"left","80px"],[3,"class"],["scope","col",1,"px-2","py-1","border","border-gray-300","text-center","text-xs","bg-gray-100",2,"min-width","60px"],["scope","col",1,"px-2","py-1","border","border-gray-300","text-center","text-xs","bg-gray-100",2,"min-width","70px"],[1,"px-3","py-2","border","border-gray-300","font-semibold","sticky","left-0","z-20",3,"bg-yellow-50","bg-red-100","bg-white"],[1,"px-3","py-2","border","border-gray-300","sticky","left-0","bg-white","z-20"],[1,"px-3","py-2","border","border-gray-300","sticky","z-20",2,"left","80px"],[1,"px-3","py-2","border","border-gray-300","font-semibold","sticky","left-0","z-20"],[1,"px-2","py-2","border","border-gray-300","text-right","text-xs",2,"white-space","nowrap"],[1,"text-gray-500","mb-2"],[1,"text-sm","text-gray-400"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50"],[1,"text-center"],[1,"py-3","px-4","text-left"],[1,"py-3","px-4"],[1,"border-b","text-right"],[1,"py-3","px-4","font-semibold","text-gray-800","text-left"],[1,"text-gray-400"],[1,"font-bold"],[1,"border-b","text-right","font-medium"],[1,"border-b","text-right","font-medium","bg-gray-50"],[1,"border-b","text-right","hover:bg-gray-50"],[1,"py-2","px-4","text-gray-500","text-left"],[1,"font-semibold"],["colspan","6",1,"text-center","py-8","text-gray-500"]],template:function(t,i){t&1&&(l(0,"div",1)(1,"div",2)(2,"h1",3),c(3,"\u5546\u54C1\u5206\u6790"),a(),A(4,K7,26,4,"div",4),A(5,tV,26,4,"div",4),a(),l(6,"div",5)(7,"div",6)(8,"nav",7)(9,"button",8),b("click",function(){return i.changeView("analysis")}),c(10," \u5546\u54C1\u5206\u6790 "),a(),l(11,"button",8),b("click",function(){return i.changeView("margin")}),c(12," \u5546\u54C1\u6BDB\u5229 "),a()()(),l(13,"div",9),A(14,pV,10,5,"div",1),A(15,CV,4,4),a()()()),t&2&&(f(4),N(i.activeView()==="analysis"?4:-1),f(),N(i.activeView()==="margin"?5:-1),f(4),De(i.activeView()==="analysis"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),f(2),De(i.activeView()==="margin"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),f(3),N(i.activeView()==="analysis"?14:-1),f(),N(i.activeView()==="margin"?15:-1))},dependencies:[re,be,ke,Ve,Ae,me,Ie],encapsulation:2,changeDetection:0});var Qm=Os;var xV=(n,e)=>e.entry_id,Ub=(n,e)=>e.shipment_id;function EV(n,e){n&1&&(l(0,"div",2),x(1,"ion-icon",11),l(2,"span",12),c(3,"\u6B63\u5728\u52A0\u8F09\u6578\u64DA..."),a()())}function bV(n,e){if(n&1&&(l(0,"div",3),x(1,"ion-icon",13),l(2,"span",14),c(3),a()()),n&2){let t=v();f(3),E(t.errorMessage())}}function SV(n,e){if(n&1&&(l(0,"option",26),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),E(t)}}function DV(n,e){if(n&1&&(l(0,"option",26),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),E(t)}}function wV(n,e){if(n&1&&(l(0,"option",26),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),E(t)}}function TV(n,e){n&1&&(x(0,"ion-icon",48),l(1,"span"),c(2,"\u5957\u7528\u4E2D..."),a())}function IV(n,e){n&1&&(x(0,"ion-icon",49),l(1,"span"),c(2,"\u5957\u7528"),a())}function MV(n,e){if(n&1){let t=B();l(0,"tr",50),b("click",function(){let r=w(t).$implicit,o=v(2);return T(o.openEditModal(r))}),l(1,"td",51),x(2,"input",52),a(),l(3,"td",53),c(4),a(),l(5,"td",53),c(6),a(),l(7,"td",53),c(8),a(),l(9,"td",54),c(10),a(),l(11,"td",53),c(12),a(),l(13,"td",53),c(14),a(),l(15,"td",53),c(16),a(),l(17,"td",55),c(18),a()()}if(n&2){let t=e.$implicit,i=v(2);z("bg-red-50",!t.is_sigh_off),f(2),M("checked",t.is_sigh_off),f(2),E((t.entry_date==null?null:t.entry_date.substring(0,10))||t.entry_date),f(2),E(t.item_group),f(2),E(t.subject_name),f(2),E(i.formatCurrency(t.amount)),f(2),E(t.invoice_no),f(2),E(t.vendor_tax_id),f(2),E(t.vendor_name),f(2),E(t.description)}}function AV(n,e){n&1&&(l(0,"tr")(1,"td",56),c(2,"\u7121\u7B26\u5408\u689D\u4EF6\u7684\u6D41\u6C34\u5E33\u8CC7\u6599\u3002"),a()())}function NV(n,e){if(n&1){let t=B();l(0,"div",9)(1,"div",15)(2,"div",16)(3,"label",17),c(4,"\u5F9E:"),a(),l(5,"div",18)(6,"input",19),Z("ngModelChange",function(r){w(t);let o=v();return ee(o.startDate,r)||(o.startDate=r),T(r)}),a(),l(7,"div",20),x(8,"ion-icon",21),a()()(),l(9,"div",16)(10,"label",22),c(11,"\u81F3:"),a(),l(12,"div",18)(13,"input",23),Z("ngModelChange",function(r){w(t);let o=v();return ee(o.endDate,r)||(o.endDate=r),T(r)}),a(),l(14,"div",20),x(15,"ion-icon",21),a()()(),l(16,"div")(17,"select",24),Z("ngModelChange",function(r){w(t);let o=v();return ee(o.selectedItem,r)||(o.selectedItem=r),T(r)}),l(18,"option",25),c(19,"\u6240\u6709\u9805\u76EE"),a(),O(20,SV,2,2,"option",26,W),a()(),l(22,"div")(23,"select",27),Z("ngModelChange",function(r){w(t);let o=v();return ee(o.selectedCategory,r)||(o.selectedCategory=r),T(r)}),l(24,"option",25),c(25,"\u6240\u6709\u79D1\u76EE"),a(),O(26,DV,2,2,"option",26,W),a()(),l(28,"div",28)(29,"select",24),Z("ngModelChange",function(r){w(t);let o=v();return ee(o.selectedVendor,r)||(o.selectedVendor=r),T(r)}),l(30,"option",25),c(31,"\u6240\u6709\u8CE3\u65B9"),a(),O(32,wV,2,2,"option",26,W),a()(),l(34,"div")(35,"input",29),Z("ngModelChange",function(r){w(t);let o=v();return ee(o.entryIdFilter,r)||(o.entryIdFilter=r),T(r)}),a()(),l(36,"div")(37,"input",30),Z("ngModelChange",function(r){w(t);let o=v();return ee(o.descriptionFilter,r)||(o.descriptionFilter=r),T(r)}),a()(),l(38,"div",31)(39,"button",32),b("click",function(){w(t);let r=v();return T(r.applyFilters())}),A(40,TV,3,0)(41,IV,3,0),a(),l(42,"button",33),b("click",function(){w(t);let r=v();return T(r.resetFilters())}),x(43,"ion-icon",34),a()()(),l(44,"div",35)(45,"table",36)(46,"thead",37)(47,"tr")(48,"th",38)(49,"div",39)(50,"input",40),b("change",function(r){w(t);let o=v();return T(o.toggleAllApprovals(r))}),a(),l(51,"span"),c(52,"\u7C3D\u6838"),a()()(),l(53,"th",41),b("click",function(){w(t);let r=v();return T(r.sortData("entry_date"))}),c(54,"\u65E5\u671F "),x(55,"ion-icon",42),a(),l(56,"th",41),b("click",function(){w(t);let r=v();return T(r.sortData("item_group"))}),c(57,"\u9805\u76EE "),x(58,"ion-icon",42),a(),l(59,"th",41),b("click",function(){w(t);let r=v();return T(r.sortData("subject_name"))}),c(60,"\u79D1\u76EE "),x(61,"ion-icon",42),a(),l(62,"th",43),b("click",function(){w(t);let r=v();return T(r.sortData("amount"))}),c(63,"\u91D1\u984D "),x(64,"ion-icon",42),a(),l(65,"th",41),b("click",function(){w(t);let r=v();return T(r.sortData("invoice_no"))}),c(66,"\u767C\u7968\u865F\u78BC "),x(67,"ion-icon",42),a(),l(68,"th",41),b("click",function(){w(t);let r=v();return T(r.sortData("vendor_tax_id"))}),c(69,"\u8CE3\u65B9\u7D71\u7DE8 "),x(70,"ion-icon",42),a(),l(71,"th",41),b("click",function(){w(t);let r=v();return T(r.sortData("vendor_name"))}),c(72,"\u8CE3\u65B9\u540D\u7A31 "),x(73,"ion-icon",42),a(),l(74,"th",38),c(75,"\u8AAA\u660E"),a()()(),l(76,"tbody"),O(77,MV,19,11,"tr",44,xV,!1,AV,3,0,"tr"),a()()(),l(80,"div",45)(81,"div",46),c(82),a(),l(83,"div",16)(84,"button",47),b("click",function(){w(t);let r=v();return T(r.goToPrevPage())}),c(85," \u4E0A\u4E00\u9801 "),a(),l(86,"button",47),b("click",function(){w(t);let r=v();return T(r.goToNextPage())}),c(87," \u4E0B\u4E00\u9801 "),a()()()()}if(n&2){let t=v();f(6),Q("ngModel",t.startDate),f(7),Q("ngModel",t.endDate),f(4),Q("ngModel",t.selectedItem),f(3),L(t.modalAvailableItems()),f(3),Q("ngModel",t.selectedCategory),M("disabled",!t.selectedItem()),f(3),L(t.filterAvailableCategories()),f(3),Q("ngModel",t.selectedVendor),f(3),L(t.filterOptions().vendorNames),f(3),Q("ngModel",t.entryIdFilter),f(2),Q("ngModel",t.descriptionFilter),f(2),M("disabled",t.isLoading()),f(),N(t.isLoading()?40:41),f(10),M("checked",t.areAllApproved()),f(27),L(t.pagedTransactions()),f(5),kt(" \u7B2C ",t.currentPage()," / ",t.totalPages()," \u9801\uFF0C\u5171 ",t.totalRecords()," \u7B46 "),f(2),M("disabled",t.currentPage()===1),f(2),M("disabled",t.currentPage()===t.totalPages())}}function RV(n,e){if(n&1&&(l(0,"option",26),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),E(t)}}function FV(n,e){if(n&1&&(l(0,"option",26),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),E(t)}}function PV(n,e){if(n&1){let t=B();l(0,"form",59),b("ngSubmit",function(){w(t);let r=v(2);return T(r.handleFormSubmit())}),l(1,"div",60)(2,"div")(3,"label",61),c(4,"\u65E5\u671F*"),a(),l(5,"div",62),x(6,"input",63),l(7,"div",20),x(8,"ion-icon",21),a()()(),l(9,"div")(10,"label",64),c(11,"\u9805\u76EE*"),a(),l(12,"select",65)(13,"option",66),c(14,"\u8ACB\u9078\u64C7\u9805\u76EE"),a(),O(15,RV,2,2,"option",26,W),a()(),l(17,"div")(18,"label",67),c(19,"\u79D1\u76EE*"),a(),l(20,"select",68)(21,"option",66),c(22,"\u8ACB\u9078\u64C7\u79D1\u76EE"),a(),O(23,FV,2,2,"option",26,W),a()(),l(25,"div")(26,"label",69),c(27,"\u91D1\u984D*"),a(),x(28,"input",70),a(),l(29,"div")(30,"label",71),c(31,"\u767C\u7968\u865F\u78BC"),a(),x(32,"input",72),a(),l(33,"div")(34,"label",73),c(35,"\u8CE3\u65B9\u7D71\u7DE8"),a(),l(36,"input",74),b("input",function(r){w(t);let o=v(2);return T(o.onVendorTaxIdInput(r))}),a()(),l(37,"div",75)(38,"label",76),c(39,"\u8CE3\u65B9\u540D\u7A31"),a(),x(40,"input",77),a(),l(41,"div",75)(42,"label",78),c(43,"\u8AAA\u660E"),a(),x(44,"textarea",79),a()(),l(45,"div",80)(46,"button",81),b("click",function(){w(t);let r=v(2);return T(r.resetForm())}),c(47,"\u53D6\u6D88"),a(),l(48,"button",82),c(49,"\u9001\u51FA"),a()()()}if(n&2){let t=v(2);M("formGroup",t.ledgerForm),f(6),z("border-red-500",t.isInvalid("entry_date")),f(6),z("border-red-500",t.isInvalid("item_group")),f(3),L(t.filterOptions().items),f(5),z("border-red-500",t.isInvalid("subject_name")),f(3),L(t.availableCategories()),f(5),z("border-red-500",t.isInvalid("amount"))}}function kV(n,e){if(n&1&&(l(0,"div",89),x(1,"ion-icon",97),l(2,"span"),c(3),a()()),n&2){let t=v(3);f(3),E(t.saveSuccessMessage())}}function VV(n,e){n&1&&(l(0,"div",90),x(1,"ion-icon",98),l(2,"span"),c(3,"\u8F09\u5165\u4E2D..."),a()())}function OV(n,e){if(n&1&&(l(0,"div",93)(1,"div",16),x(2,"ion-icon",99),l(3,"span"),c(4),a()()()),n&2){let t=v(3);f(4),E(t.shipmentItemsError())}}function LV(n,e){n&1&&(l(0,"div",94),c(1,"\u6B64\u6D41\u6C34\u5E33\u5C1A\u672A\u95DC\u806F\u9032\u8CA8\u8CC7\u6599\u3002"),a())}function BV(n,e){n&1&&c(0," \u5132\u5B58\u4E2D... ")}function UV(n,e){n&1&&c(0," \u5132\u5B58\u9032\u8CA8\u8CC7\u6599 ")}function $V(n,e){if(n&1){let t=B();l(0,"div")(1,"div",101)(2,"div")(3,"label",102),c(4,"\u54C1\u9805\u540D\u7A31"),a(),l(5,"input",103),Z("ngModelChange",function(r){let o=w(t).$implicit;return ee(o.itemName,r)||(o.itemName=r),T(r)}),a()(),l(6,"div")(7,"label",102),c(8,"\u6578\u91CF"),a(),l(9,"input",104),Z("ngModelChange",function(r){let o=w(t).$implicit;return ee(o.qty,r)||(o.qty=r),T(r)}),a()(),l(10,"div")(11,"label",102),c(12,"\u55AE\u4F4D"),a(),l(13,"input",103),Z("ngModelChange",function(r){let o=w(t).$implicit;return ee(o.unit,r)||(o.unit=r),T(r)}),a()(),l(14,"div")(15,"label",102),c(16,"\u55AE\u50F9"),a(),l(17,"input",104),Z("ngModelChange",function(r){let o=w(t).$implicit;return ee(o.unitPrice,r)||(o.unitPrice=r),T(r)}),a()(),l(18,"div")(19,"label",102),c(20,"\u5C0F\u8A08"),a(),x(21,"input",105),a(),l(22,"div",75)(23,"label",102),c(24,"\u5099\u8A3B"),a(),l(25,"textarea",106),Z("ngModelChange",function(r){let o=w(t).$implicit;return ee(o.remark,r)||(o.remark=r),T(r)}),a()()(),l(26,"div",107)(27,"button",108),b("click",function(){let r=w(t).$implicit,o=v(4);return T(o.deleteShipmentItem(r))}),x(28,"ion-icon",109),l(29,"span"),c(30,"\u522A\u9664"),a()(),l(31,"button",110),b("click",function(){let r=w(t).$implicit,o=v(4);return T(o.saveShipmentItem(r))}),A(32,BV,1,0)(33,UV,1,0),a()()()}if(n&2){let t=e.$implicit,i=v(4);De("border rounded-lg p-4 "+(i.newShipmentItemIds().includes(t.shipment_id)?"bg-yellow-50":"bg-gray-50")),f(5),M("name",Un("shipmentItemName",t.shipment_id)),Q("ngModel",t.itemName),f(4),M("name",Un("shipmentQty",t.shipment_id)),Q("ngModel",t.qty),f(4),M("name",Un("shipmentUnit",t.shipment_id)),Q("ngModel",t.unit),f(4),M("name",Un("shipmentUnitPrice",t.shipment_id)),Q("ngModel",t.unitPrice),f(4),M("value",t.lineAmount??"-"),f(4),M("name",Un("shipmentRemark",t.shipment_id)),Q("ngModel",t.remark),f(6),M("disabled",i.isSavingShipmentItem(t.shipment_id)),f(),N(i.isSavingShipmentItem(t.shipment_id)?32:33)}}function HV(n,e){if(n&1&&(l(0,"div",9),O(1,$V,34,20,"div",100,Ub),a()),n&2){let t=v(3);f(),L(t.shipmentItems())}}function GV(n,e){if(n&1){let t=B();l(0,"div",58)(1,"div",83),x(2,"ion-icon",84),l(3,"span",12),c(4,"\u6D41\u6C34\u5E33\u5DF2\u6210\u529F\u65B0\u589E\uFF01\u60A8\u73FE\u5728\u53EF\u4EE5\u95DC\u806F\u9032\u8CA8\u8CC7\u6599\u3002"),a()(),l(5,"div",85)(6,"div",86)(7,"div",87)(8,"h4",88),c(9),a(),A(10,kV,4,1,"div",89),a(),l(11,"div",16),A(12,VV,4,0,"div",90),l(13,"button",91),b("click",function(){w(t);let r=v(2);return T(r.addNewShipmentItem())}),x(14,"ion-icon",92),l(15,"span"),c(16,"\u65B0\u589E\u9032\u8CA8\u55AE"),a()()()(),A(17,OV,5,1,"div",93),A(18,LV,2,0,"div",94),A(19,HV,3,0,"div",9),l(20,"div",95)(21,"button",81),b("click",function(){w(t);let r=v(2);return T(r.resetAddView())}),c(22,"\u8FD4\u56DE\u65B0\u589E\u8868\u55AE"),a(),l(23,"button",96),b("click",function(){w(t);let r=v(2);return T(r.changeView("details"))}),c(24,"\u5B8C\u6210"),a()()()()}if(n&2){let t,i=v(2);f(9),V("\u95DC\u806F\u9032\u8CA8\u8CC7\u6599\uFF1A",i.shipmentItems().length,"\u7B46"),f(),N(i.saveSuccessMessage()?10:-1),f(2),N(i.isLoadingShipmentItems()?12:-1),f(),M("disabled",i.isLoadingShipmentItems()||!((t=i.newlyCreatedEntry())!=null&&t.entry_id)),f(4),N(i.shipmentItemsError()?17:-1),f(),N(!i.isLoadingShipmentItems()&&i.shipmentItems().length===0?18:-1),f(),N(i.shipmentItems().length>0?19:-1)}}function qV(n,e){if(n&1&&A(0,PV,50,9,"form",57)(1,GV,25,7,"div",58),n&2){let t=v();N(t.newlyCreatedEntry()?1:0)}}function WV(n,e){if(n&1&&(l(0,"option",26),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),E(t)}}function jV(n,e){if(n&1&&(l(0,"option",26),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),E(t)}}function zV(n,e){if(n&1&&(l(0,"p",130),c(1),a()),n&2){let t=v(2);f(),E(t.getErrorMessage("vendor_tax_id"))}}function YV(n,e){if(n&1&&(l(0,"div",147)(1,"p",151)(2,"strong"),c(3,"\u6CE8\u610F\uFF1A"),a(),c(4,"\u6B64\u6D41\u6C34\u5E33\u5DF2\u95DC\u806F "),l(5,"strong"),c(6),a(),c(7," \u7B46\u9032\u8CA8\u55AE\u9805\u76EE\uFF0C\u522A\u9664\u6B64\u6D41\u6C34\u5E33\u6642\u5C07\u4E00\u4F75\u522A\u9664\u9019\u4E9B\u9032\u8CA8\u55AE\u9805\u76EE\u3002 "),a()()),n&2){let t=v(3);f(6),E(t.ledgerDeleteConfirmation().relatedShipmentCount)}}function JV(n,e){if(n&1){let t=B();l(0,"div",140)(1,"div",142)(2,"div",143),x(3,"ion-icon",144),l(4,"h3",88),c(5,"\u78BA\u8A8D\u522A\u9664\u6D41\u6C34\u5E33"),a()(),l(6,"div",145)(7,"p",146),c(8,"\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u6B64\u6D41\u6C34\u5E33\u8A18\u9304\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"),a(),A(9,YV,8,1,"div",147),a(),l(10,"div",148)(11,"button",149),b("click",function(){w(t);let r=v(2);return T(r.cancelDeleteLedgerEntry())}),c(12,"\u53D6\u6D88"),a(),l(13,"button",150),b("click",function(){w(t);let r=v(2);return T(r.confirmDeleteLedgerEntry())}),c(14,"\u78BA\u8A8D\u522A\u9664"),a()()()()}if(n&2){let t=v(2);f(9),N(t.ledgerDeleteConfirmation().relatedShipmentCount>0?9:-1)}}function KV(n,e){if(n&1&&(l(0,"div",89),x(1,"ion-icon",97),l(2,"span"),c(3),a()()),n&2){let t=v(2);f(3),E(t.saveSuccessMessage())}}function QV(n,e){n&1&&(l(0,"div",90),x(1,"ion-icon",98),l(2,"span"),c(3,"\u8F09\u5165\u4E2D..."),a()())}function ZV(n,e){if(n&1&&(l(0,"div",93)(1,"div",16),x(2,"ion-icon",99),l(3,"span"),c(4),a()()()),n&2){let t=v(2);f(4),E(t.shipmentItemsError())}}function XV(n,e){n&1&&(l(0,"div",94),c(1,"\u6B64\u6D41\u6C34\u5E33\u5C1A\u672A\u95DC\u806F\u9032\u8CA8\u8CC7\u6599\u3002"),a())}function eO(n,e){n&1&&c(0," \u5132\u5B58\u4E2D... ")}function tO(n,e){n&1&&c(0," \u5132\u5B58\u9032\u8CA8\u8CC7\u6599 ")}function nO(n,e){if(n&1){let t=B();l(0,"div")(1,"div",101)(2,"div")(3,"label",102),c(4,"\u54C1\u9805\u540D\u7A31"),a(),l(5,"input",103),Z("ngModelChange",function(r){let o=w(t).$implicit;return ee(o.itemName,r)||(o.itemName=r),T(r)}),a()(),l(6,"div")(7,"label",102),c(8,"\u6578\u91CF"),a(),l(9,"input",104),Z("ngModelChange",function(r){let o=w(t).$implicit;return ee(o.qty,r)||(o.qty=r),T(r)}),a()(),l(10,"div")(11,"label",102),c(12,"\u55AE\u4F4D"),a(),l(13,"input",103),Z("ngModelChange",function(r){let o=w(t).$implicit;return ee(o.unit,r)||(o.unit=r),T(r)}),a()(),l(14,"div")(15,"label",102),c(16,"\u55AE\u50F9"),a(),l(17,"input",104),Z("ngModelChange",function(r){let o=w(t).$implicit;return ee(o.unitPrice,r)||(o.unitPrice=r),T(r)}),a()(),l(18,"div")(19,"label",102),c(20,"\u5C0F\u8A08"),a(),x(21,"input",105),a(),l(22,"div",75)(23,"label",102),c(24,"\u5099\u8A3B"),a(),l(25,"textarea",106),Z("ngModelChange",function(r){let o=w(t).$implicit;return ee(o.remark,r)||(o.remark=r),T(r)}),a()()(),l(26,"div",107)(27,"button",108),b("click",function(){let r=w(t).$implicit,o=v(3);return T(o.deleteShipmentItem(r))}),x(28,"ion-icon",109),l(29,"span"),c(30,"\u522A\u9664"),a()(),l(31,"button",110),b("click",function(){let r=w(t).$implicit,o=v(3);return T(o.saveShipmentItem(r))}),A(32,eO,1,0)(33,tO,1,0),a()()()}if(n&2){let t=e.$implicit,i=v(3);De("border rounded-lg p-4 "+(i.newShipmentItemIds().includes(t.shipment_id)?"bg-yellow-50":"bg-gray-50")),f(5),M("name",Un("shipmentItemName",t.shipment_id)),Q("ngModel",t.itemName),f(4),M("name",Un("shipmentQty",t.shipment_id)),Q("ngModel",t.qty),f(4),M("name",Un("shipmentUnit",t.shipment_id)),Q("ngModel",t.unit),f(4),M("name",Un("shipmentUnitPrice",t.shipment_id)),Q("ngModel",t.unitPrice),f(4),M("value",t.lineAmount??"-"),f(4),M("name",Un("shipmentRemark",t.shipment_id)),Q("ngModel",t.remark),f(6),M("disabled",i.isSavingShipmentItem(t.shipment_id)),f(),N(i.isSavingShipmentItem(t.shipment_id)?32:33)}}function iO(n,e){if(n&1&&(l(0,"div",9),O(1,nO,34,20,"div",100,Ub),a()),n&2){let t=v(2);f(),L(t.shipmentItems())}}function rO(n,e){if(n&1){let t=B();l(0,"div",10)(1,"div",111)(2,"div",112)(3,"h3",113),c(4),a(),l(5,"button",114),b("click",function(){w(t);let r=v();return T(r.closeModal())}),x(6,"ion-icon",115),a()(),l(7,"div",116)(8,"form",117),b("ngSubmit",function(){w(t);let r=v();return T(r.handleFormSubmit())}),l(9,"div",60)(10,"div")(11,"label",118),c(12,"\u65E5\u671F*"),a(),l(13,"div",62),x(14,"input",119),l(15,"div",20),x(16,"ion-icon",21),a()()(),l(17,"div")(18,"label",120),c(19,"\u9805\u76EE*"),a(),l(20,"select",121),O(21,WV,2,2,"option",26,W),a()(),l(23,"div")(24,"label",122),c(25,"\u79D1\u76EE*"),a(),l(26,"select",123)(27,"option",25),c(28,"\u8ACB\u9078\u64C7\u79D1\u76EE"),a(),O(29,jV,2,2,"option",26,W),a()(),l(31,"div")(32,"label",124),c(33,"\u91D1\u984D*"),a(),x(34,"input",125),a(),l(35,"div")(36,"label",126),c(37,"\u767C\u7968\u865F\u78BC"),a(),x(38,"input",127),a(),l(39,"div")(40,"label",128),c(41,"\u8CE3\u65B9\u7D71\u7DE8"),a(),l(42,"input",129),b("input",function(r){w(t);let o=v();return T(o.onVendorTaxIdInput(r))}),a(),A(43,zV,2,1,"p",130),a(),l(44,"div",75)(45,"label",131),c(46,"\u8CE3\u65B9\u540D\u7A31"),a(),x(47,"input",132),a(),l(48,"div",75)(49,"label",133),c(50,"\u8AAA\u660E"),a(),x(51,"textarea",134),a(),l(52,"div",75)(53,"label",135),x(54,"input",136),l(55,"span",137),c(56,"\u5DF2\u7C3D\u6838"),a()()()(),l(57,"div",138)(58,"button",139),b("click",function(){w(t);let r=v();return T(r.deleteLedgerEntry())}),c(59,"\u522A\u9664"),a(),l(60,"button",81),b("click",function(){w(t);let r=v();return T(r.closeModal())}),c(61,"\u53D6\u6D88"),a(),l(62,"button",82),c(63,"\u4FEE\u6539"),a()()(),A(64,JV,15,1,"div",140),l(65,"div",141)(66,"div",86)(67,"div",87)(68,"h4",88),c(69),a(),A(70,KV,4,1,"div",89),a(),l(71,"div",16),A(72,QV,4,0,"div",90),l(73,"button",91),b("click",function(){w(t);let r=v();return T(r.addNewShipmentItem())}),x(74,"ion-icon",92),l(75,"span"),c(76,"\u65B0\u589E\u9032\u8CA8\u55AE"),a()()()(),A(77,ZV,5,1,"div",93),A(78,XV,2,0,"div",94),A(79,iO,3,0,"div",9),a()()()()}if(n&2){let t,i,r=v();f(4),V("\u4FEE\u6539\u6D41\u6C34\u5E33 ID\uFF1A",(t=r.editingTransaction())==null?null:t.entry_id),f(4),M("formGroup",r.ledgerForm),f(6),z("border-red-500",r.isInvalid("entry_date")),f(6),z("border-red-500",r.isInvalid("item_group")),f(),L(r.modalAvailableItems()),f(5),z("border-red-500",r.isInvalid("subject_name")),f(3),L(r.availableCategories()),f(5),z("border-red-500",r.isInvalid("amount")),f(8),z("border-red-500",r.isInvalid("vendor_tax_id")),f(),N(r.isInvalid("vendor_tax_id")?43:-1),f(21),N(r.ledgerDeleteConfirmation()?64:-1),f(5),V("\u95DC\u806F\u9032\u8CA8\u8CC7\u6599\uFF1A",r.shipmentItems().length,"\u7B46"),f(),N(r.saveSuccessMessage()?70:-1),f(2),N(r.isLoadingShipmentItems()?72:-1),f(),M("disabled",r.isLoadingShipmentItems()||!((i=r.editingTransaction())!=null&&i.entry_id)),f(4),N(r.shipmentItemsError()?77:-1),f(),N(!r.isLoadingShipmentItems()&&r.shipmentItems().length===0?78:-1),f(),N(r.shipmentItems().length>0?79:-1)}}function oO(n,e){if(n&1){let t=B();l(0,"div",10)(1,"div",152)(2,"div",153)(3,"div",154),x(4,"ion-icon",155),a(),l(5,"h3",156),c(6,"\u8ACB\u78BA\u8A8D"),a(),l(7,"p",157),c(8),a()(),l(9,"div",158)(10,"button",159),b("click",function(){w(t);let r=v();return T(r.cancelApproval())}),c(11,"\u53D6\u6D88"),a(),l(12,"button",160),b("click",function(){w(t);let r=v();return T(r.confirmApproval())}),c(13,"\u78BA\u8A8D"),a()()()()}n&2&&(f(8),E(e.message))}function sO(n,e){if(n&1){let t=B();l(0,"div",10)(1,"div",152)(2,"div",153)(3,"div",161),x(4,"ion-icon",162),a(),l(5,"h3",156),c(6,"\u78BA\u8A8D\u522A\u9664"),a(),l(7,"p",157),c(8),a(),l(9,"p",163),c(10,"\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"),a()(),l(11,"div",158)(12,"button",159),b("click",function(){w(t);let r=v();return T(r.cancelDeleteShipmentItem())}),c(13,"\u53D6\u6D88"),a(),l(14,"button",164),b("click",function(){w(t);let r=v();return T(r.confirmDeleteShipmentItem())}),c(15,"\u78BA\u8A8D\u522A\u9664"),a()()()()}n&2&&(f(8),V("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u9032\u8CA8\u55AE\u9805\u76EE\u300C",e.itemName,"\u300D\u55CE\uFF1F"))}var Ls=class Ls{constructor(){this.apiService=P(rt);this.fb=P(He);this.activeView=S("details");this.allTransactions=S([]);this.displayedTransactions=S([]);this.pagination=S({total:0,totalPages:1,page:1,limit:20});this.filterOptions=S({items:[],categories:[],vendorNames:[]});this.editingTransaction=S(null);this.newlyCreatedEntry=S(null);this.isModalOpen=S(!1);this.isLoading=S(!1);this.errorMessage=S(null);this.confirmationState=S(null);this.shipmentItems=S([]);this.isLoadingShipmentItems=S(!1);this.shipmentItemsError=S(null);this.savingShipmentItemIds=S([]);this.deleteConfirmation=S(null);this.newShipmentItemIds=S([]);this.saveSuccessMessage=S(null);this.ledgerDeleteConfirmation=S(null);this.isCheckingShipment=S(!1);this.today=new Date;this.firstDayOfMonth=new Date(this.today.getFullYear(),this.today.getMonth(),1);this.lastDayOfMonth=new Date(this.today.getFullYear(),this.today.getMonth()+1,0);this.startDate=S(this.formatDate(this.firstDayOfMonth));this.endDate=S(this.formatDate(this.lastDayOfMonth));this.selectedItem=S("");this.selectedCategory=S("");this.selectedVendor=S("");this.descriptionFilter=S("");this.entryIdFilter=S("");this.appliedItem=S("");this.appliedCategory=S("");this.appliedVendor=S("");this.appliedDescriptionFilter=S("");this.appliedEntryIdFilter=S("");this.pageSize=20;this.currentPage=S(1);this.sortColumn=S("entry_date");this.sortDirection=S("desc");this.submitted=S(!1);this.formItemGroup=S(null);this.ledgerForm=this.fb.group({entry_id:[""],entry_date:["",U.required],item_group:["",U.required],subject_name:["",U.required],amount:["",U.required],invoice_no:[""],vendor_tax_id:["",[U.pattern(/^\d{0,8}$/)]],vendor_id:[null],vendor_name:[""],description:[""],is_sigh_off:[!1],gl_account_id:[null]});this.glAccounts=S([]);this.isLoadingGLAccounts=S(!1);this.glAccountsError=S(null);this.glAccountsHierarchy=H(()=>{let e=this.glAccounts(),t={};return e.forEach(i=>{let r=i.parent_account_id!==null&&i.parent_account_id!==void 0?i.parent_account_id.toString():"null";t[r]||(t[r]=[]),t[r].push(i)}),t});this.topLevelAccounts=H(()=>(this.glAccountsHierarchy().null||[]).sort((t,i)=>t.gl_account_id-i.gl_account_id));this.selectedItemSubAccounts=H(()=>{let e=this.ledgerForm.get("item_group")?.value,t=this.glAccounts();if(!e||t.length===0)return[];let i=t.find(r=>r.account_name===e&&r.parent_account_id===null);return i?t.filter(r=>r.parent_account_id===i.gl_account_id).sort((r,o)=>r.gl_account_id-o.gl_account_id):[]});this.itemCategoryMap={\u8CC7\u7522:["\u73FE\u91D1","\u9280\u884C\u5B58\u6B3E","\u61C9\u6536\u5E33\u6B3E","\u5B58\u8CA8"],\u8CA0\u50B5:["\u61C9\u4ED8\u5E33\u6B3E","\u61C9\u4ED8\u85AA\u8CC7","\u61C9\u4ED8\u7A05\u6B3E"],\u696D\u4E3B\u6B0A\u76CA:["\u8CC7\u672C","\u4FDD\u7559\u76C8\u9918"],\u71DF\u696D\u6536\u5165:["\u92B7\u8CA8\u6536\u5165","\u5176\u4ED6\u6536\u5165"],\u71DF\u696D\u8CBB\u7528:["\u4EBA\u4E8B\u8CBB\u7528","\u9032\u8CA8\u6210\u672C","\u5176\u4ED6\u8CBB\u7528"]};this.availableCategories=H(()=>{let e=this.formItemGroup();if(!e)return[];let t=this.glAccounts();if(t.length>0){let s=t.find(u=>u.account_name===e&&u.parent_account_id===null);if(s){let u=t.filter(d=>d.parent_account_id===s.gl_account_id).map(d=>d.account_name).filter(Boolean).sort();if(u.length>0)return u}}let r=this.allTransactions().filter(s=>s.item_group===e).map(s=>s.subject_name).filter(Boolean),o=[...new Set(r)].sort();if(o.length===0){let s=this.itemCategoryMap[e];if(s&&s.length>0)return s}return o});this.filterAvailableCategories=H(()=>{let e=this.selectedItem();if(this.glAccounts().length>0){let r=this.glAccounts(),o=r.find(s=>s.account_name===e&&s.parent_account_id===null);if(o){let s=r.filter(u=>u.parent_account_id===o.gl_account_id).map(u=>u.account_name).filter(Boolean).sort();if(s.length>0)return s}}if(!e)return[];let i=this.allTransactions().filter(r=>r.item_group===e).map(r=>r.subject_name).filter(Boolean);return[...new Set(i)].sort()});this.modalAvailableItems=H(()=>this.glAccounts().length>0?this.topLevelAccounts().map(e=>e.account_name).filter(Boolean).sort():Object.keys(this.itemCategoryMap).sort());this.pagedTransactions=H(()=>this.displayedTransactions());this.totalPages=H(()=>this.pagination().totalPages);this.totalRecords=H(()=>this.pagination().total);this.areAllApproved=H(()=>{let e=this.displayedTransactions();return e.length>0&&e.every(t=>t.is_sigh_off)});this.loadInitialData(),this.ledgerForm.get("item_group")?.valueChanges.subscribe(e=>{this.formItemGroup.set(e)}),Ci(()=>{let e=this.formItemGroup(),t=this.availableCategories(),i=this.ledgerForm.get("subject_name")?.value;i&&t.length>0&&!t.includes(i)&&(this.ledgerForm.get("subject_name")?.setValue("",{emitEvent:!1}),this.ledgerForm.get("gl_account_id")?.setValue(null,{emitEvent:!1}))}),this.ledgerForm.get("subject_name")?.valueChanges.subscribe(async()=>{await this.updateGLAccountId()}),Ci(()=>{this.selectedItem()||this.selectedCategory.set("")})}async loadInitialData(){await Promise.all([this.loadGLAccounts(),this.applyFilters()])}async loadGLAccounts(){this.isLoadingGLAccounts.set(!0),this.glAccountsError.set(null);try{let e=await this.apiService.getGLAccounts();e.success&&e.data?this.glAccounts.set(e.data):this.glAccountsError.set(e.error||"\u7121\u6CD5\u52A0\u8F09\u6703\u8A08\u79D1\u76EE")}catch{this.glAccountsError.set("\u52A0\u8F09\u6703\u8A08\u79D1\u76EE\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoadingGLAccounts.set(!1)}}async applyFilters(){this.isLoading.set(!0),this.errorMessage.set(null),this.appliedItem.set(this.selectedItem()),this.appliedCategory.set(this.selectedCategory()),this.appliedVendor.set(this.selectedVendor()),this.appliedDescriptionFilter.set(this.descriptionFilter()),this.appliedEntryIdFilter.set(this.entryIdFilter()),this.currentPage.set(1),await this.loadPageData(1)}async loadPageData(e){this.isLoading.set(!0),this.errorMessage.set(null);try{let t=await this.apiService.getLedgerEntries({startDate:this.startDate(),endDate:this.endDate(),itemGroup:this.appliedItem()||void 0,subjectName:this.appliedCategory()||void 0,vendorName:this.appliedVendor()||void 0,description:this.appliedDescriptionFilter()||void 0,entryId:this.appliedEntryIdFilter()?parseInt(this.appliedEntryIdFilter(),10):void 0,page:e,limit:20});if(t.success&&t.data){if(this.displayedTransactions.set(t.data),t.pagination&&this.pagination.set({total:t.pagination.total,totalPages:t.pagination.totalPages,page:t.pagination.page,limit:t.pagination.limit}),e===1){let i=await this.apiService.getLedgerEntries({startDate:this.startDate(),endDate:this.endDate(),limit:9999});if(i.success&&i.data){this.allTransactions.set(i.data);let r=Object.keys(this.itemCategoryMap),o=i.data.map(m=>m.item_group).filter(Boolean),s=[...new Set([...r,...o])].sort(),u=[...new Set(i.data.map(m=>m.subject_name).filter(Boolean))].sort(),d=[...new Set(i.data.map(m=>m.vendor_name).filter(Boolean))].sort();this.filterOptions.set({items:s,categories:u,vendorNames:d})}}}else this.errorMessage.set(t.error||"\u7121\u6CD5\u53D6\u5F97\u6D41\u6C34\u5E33\u8CC7\u6599")}catch(t){console.error("Error loading ledger entries:",t),this.errorMessage.set("\u53D6\u5F97\u6D41\u6C34\u5E33\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoading.set(!1)}}resetFilters(){this.startDate.set(this.formatDate(this.firstDayOfMonth)),this.endDate.set(this.formatDate(this.lastDayOfMonth)),this.selectedItem.set(""),this.selectedCategory.set(""),this.selectedVendor.set(""),this.descriptionFilter.set(""),this.entryIdFilter.set(""),this.appliedItem.set(""),this.appliedCategory.set(""),this.appliedVendor.set(""),this.appliedDescriptionFilter.set(""),this.appliedEntryIdFilter.set(""),this.currentPage.set(1),this.applyFilters()}changeView(e){this.activeView.set(e),e==="add"&&(this.resetForm(),this.newlyCreatedEntry.set(null),this.shipmentItems.set([]),this.shipmentItemsError.set(null))}async goToPage(e){let t=this.totalPages(),i=Math.min(Math.max(e,1),t);i!==this.currentPage()&&(this.currentPage.set(i),await this.loadPageData(i))}async goToPrevPage(){await this.goToPage(this.currentPage()-1)}async goToNextPage(){await this.goToPage(this.currentPage()+1)}sortData(e){this.sortColumn()===e?this.sortDirection.update(t=>t==="asc"?"desc":"asc"):(this.sortColumn.set(e),this.sortDirection.set("asc")),this.currentPage.set(1)}async openEditModal(e){this.editingTransaction.set(e),this.formItemGroup.set(e.item_group),this.ledgerForm.patchValue({entry_id:e.entry_id?e.entry_id.toString():"",entry_date:this.normalizeDateInput(e.entry_date),item_group:e.item_group,subject_name:e.subject_name,amount:e.amount?e.amount.toString():"",invoice_no:e.invoice_no,vendor_tax_id:this.sanitizeVendorTaxId(e.vendor_tax_id),vendor_name:e.vendor_name,description:e.description,is_sigh_off:e.is_sigh_off}),this.isModalOpen.set(!0),await this.loadShipmentItemsForEntry(e.entry_id)}closeModal(){this.isModalOpen.set(!1),this.editingTransaction.set(null),this.shipmentItems.set([]),this.shipmentItemsError.set(null),this.isLoadingShipmentItems.set(!1),this.resetForm()}async loadShipmentItemsForEntry(e){if(!e){this.shipmentItems.set([]),this.shipmentItemsError.set(null);return}let t=typeof e=="string"?parseInt(e,10):e;this.isLoadingShipmentItems.set(!0),this.shipmentItemsError.set(null);try{let i={entryId:t,limit:1e3,offset:0},r=await this.apiService.getShipmentItems(i);if(r.success&&r.data){let o=r.data.map(s=>k({},s));this.shipmentItems.set(o)}else this.shipmentItems.set([]),this.shipmentItemsError.set(r.error||"\u7121\u6CD5\u53D6\u5F97\u9032\u8CA8\u8CC7\u6599")}catch(i){console.error("Error loading shipment items:",i),this.shipmentItems.set([]),this.shipmentItemsError.set("\u53D6\u5F97\u9032\u8CA8\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoadingShipmentItems.set(!1)}}isSavingShipmentItem(e){return this.savingShipmentItemIds().includes(e)}async saveShipmentItem(e){if(!e?.shipment_id)return;let t=this.savingShipmentItemIds();if(t.includes(e.shipment_id))return;let r=(this.editingTransaction()||this.newlyCreatedEntry())?.entry_id;this.savingShipmentItemIds.set([...t,e.shipment_id]),this.shipmentItemsError.set(null);try{let o=await this.apiService.updateShipmentItem(e.shipment_id,{itemName:e.itemName,qty:e.qty??null,unitPrice:e.unitPrice??null,unit:e.unit??null,remark:e.remark??null,entryId:r??null});o.success?(this.saveSuccessMessage.set("\u9032\u8CA8\u8CC7\u6599\u5DF2\u5132\u5B58\u6210\u529F"),this.newShipmentItemIds.set(this.newShipmentItemIds().filter(s=>s!==e.shipment_id)),setTimeout(()=>{this.saveSuccessMessage.set(null)},3e3)):this.shipmentItemsError.set(o.error||"\u66F4\u65B0\u9032\u8CA8\u8CC7\u6599\u5931\u6557")}catch(o){console.error("Error updating shipment item:",o),this.shipmentItemsError.set("\u66F4\u65B0\u9032\u8CA8\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.savingShipmentItemIds.set(this.savingShipmentItemIds().filter(o=>o!==e.shipment_id))}}async addNewShipmentItem(){let e=this.editingTransaction()||this.newlyCreatedEntry();if(!e||!e.entry_id){this.shipmentItemsError.set("\u7121\u6CD5\u65B0\u589E\u9032\u8CA8\u55AE\uFF1A\u6D41\u6C34\u5E33\u5C1A\u672A\u4FDD\u5B58");return}let i=this.ledgerForm.get("vendor_id")?.value||e.vendor_id||null;this.isLoadingShipmentItems.set(!0),this.shipmentItemsError.set(null);try{let r=await this.apiService.createShipmentItem({entryId:e.entry_id,issueDate:e.entry_date||new Date().toISOString().split("T")[0],vendorId:i,itemName:"\u65B0\u54C1\u9805",qty:0,unitPrice:0,unit:"",remark:""});if(r.success&&r.data){let o=this.shipmentItems();this.shipmentItems.set([r.data,...o]),this.newShipmentItemIds.set([...this.newShipmentItemIds(),r.data.shipment_id])}else this.shipmentItemsError.set(r.error||"\u65B0\u589E\u9032\u8CA8\u8CC7\u6599\u5931\u6557")}catch(r){console.error("Error creating shipment item:",r),this.shipmentItemsError.set("\u65B0\u589E\u9032\u8CA8\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoadingShipmentItems.set(!1)}}deleteShipmentItem(e){this.deleteConfirmation.set({shipmentId:e.shipment_id,itemName:e.itemName})}async confirmDeleteShipmentItem(){let e=this.deleteConfirmation();if(e)try{let t=await this.apiService.deleteShipmentItem(e.shipmentId);if(t.success){let i=this.shipmentItems();this.shipmentItems.set(i.filter(r=>r.shipment_id!==e.shipmentId)),this.shipmentItemsError.set(null)}else this.shipmentItemsError.set(t.error||"\u522A\u9664\u9032\u8CA8\u8CC7\u6599\u5931\u6557")}catch(t){console.error("Error deleting shipment item:",t),this.shipmentItemsError.set("\u522A\u9664\u9032\u8CA8\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.deleteConfirmation.set(null)}}cancelDeleteShipmentItem(){this.deleteConfirmation.set(null)}async deleteLedgerEntry(){let e=this.editingTransaction();if(!e?.entry_id){this.errorMessage.set("\u7121\u6CD5\u53D6\u5F97\u6D41\u6C34\u5E33ID");return}this.isCheckingShipment.set(!0);try{let t=await this.apiService.checkLedgerShipmentItems(e.entry_id);t.success?this.ledgerDeleteConfirmation.set({entryId:e.entry_id,relatedShipmentCount:t.data?.shipmentItemsCount||0}):this.errorMessage.set(t.error||"\u6AA2\u67E5\u9032\u8CA8\u55AE\u5931\u6557")}catch(t){console.error("Error checking shipment items:",t),this.errorMessage.set("\u6AA2\u67E5\u9032\u8CA8\u55AE\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isCheckingShipment.set(!1)}}async confirmDeleteLedgerEntry(){let e=this.ledgerDeleteConfirmation();if(e)try{let t=await this.apiService.deleteLedgerEntry(e.entryId);if(t.success){let i=this.displayedTransactions();this.displayedTransactions.set(i.filter(r=>r.entry_id!==e.entryId)),this.ledgerDeleteConfirmation.set(null),this.closeModal(),this.errorMessage.set(`\u6D41\u6C34\u5E33\u5DF2\u522A\u9664${e.relatedShipmentCount>0?`\uFF0C\u4E26\u540C\u6642\u522A\u9664\u4E86 ${e.relatedShipmentCount} \u7B46\u9032\u8CA8\u55AE\u9805\u76EE`:""}`),setTimeout(()=>{this.errorMessage.set(null)},3e3)}else this.errorMessage.set(t.error||"\u522A\u9664\u6D41\u6C34\u5E33\u5931\u6557")}catch(t){console.error("Error deleting ledger entry:",t),this.errorMessage.set("\u522A\u9664\u6D41\u6C34\u5E33\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}}cancelDeleteLedgerEntry(){this.ledgerDeleteConfirmation.set(null)}toggleAllApprovals(e){let t=e.target,i=t.checked,r=i?"\u60A8\u78BA\u5B9A\u8981\u7C3D\u6838\u6240\u6709\u53EF\u898B\u9805\u76EE\u55CE\uFF1F":"\u60A8\u78BA\u5B9A\u8981\u53D6\u6D88\u7C3D\u6838\u6240\u6709\u53EF\u898B\u9805\u76EE\u55CE\uFF1F";this.confirmationState.set({message:r,isChecked:i,target:t})}async confirmApproval(){let e=this.confirmationState();if(!e)return;let{isChecked:t}=e,i=this.displayedTransactions().filter(o=>o.is_sigh_off!==t),r=i.map(o=>this.apiService.updateLedgerEntry({entry_id:o.entry_id,is_sigh_off:t}));try{await Promise.all(r);let o=this.allTransactions().map(s=>i.some(d=>d.entry_id===s.entry_id)?q(k({},s),{is_sigh_off:t}):s);this.allTransactions.set(o)}catch(o){console.error("\u66F4\u65B0\u7C3D\u6838\u72C0\u614B\u5931\u6557:",o),this.errorMessage.set("\u66F4\u65B0\u7C3D\u6838\u72C0\u614B\u5931\u6557")}this.confirmationState.set(null)}cancelApproval(){let e=this.confirmationState();e&&(e.target.checked=!e.isChecked,this.confirmationState.set(null))}async updateGLAccountId(){let e=this.ledgerForm.get("item_group")?.value,t=this.ledgerForm.get("subject_name")?.value;if(!e||!t){this.ledgerForm.get("gl_account_id")?.setValue(null);return}try{let i=await this.apiService.resolveGLAccount(e,t);i.success&&i.data?.glAccountId?this.ledgerForm.get("gl_account_id")?.setValue(i.data.glAccountId,{emitEvent:!1}):this.ledgerForm.get("gl_account_id")?.setValue(null,{emitEvent:!1})}catch(i){console.error("Error resolving GL account:",i),this.ledgerForm.get("gl_account_id")?.setValue(null,{emitEvent:!1})}}async handleFormSubmit(){if(this.submitted.set(!0),this.ledgerForm.invalid)return;let e=this.ledgerForm.get("vendor_tax_id")?.value;if(e&&e.trim().length>0){if(!/^\d{1,8}$/.test(e)){this.errorMessage.set("\u8CE3\u65B9\u7D71\u7DE8\u53EA\u80FD\u662F 1-8 \u4F4D\u6578\u5B57"),this.isLoading.set(!1);return}try{let t=await this.apiService.getVendorByTaxId(e);t.success&&t.data?this.ledgerForm.patchValue({vendor_id:t.data.vendor_id,vendor_name:t.data.vendor_name},{emitEvent:!1}):console.warn("\u8CE3\u65B9\u7D71\u7DE8\u4E0D\u5B58\u5728\u65BC\u7CFB\u7D71\u4E2D\uFF0C\u4F46\u5141\u8A31\u7E7C\u7E8C\u4FDD\u5B58\uFF08\u53EF\u80FD\u662F\u5E02\u5834\u8CB7\u7684\u8CA8\uFF09")}catch(t){console.warn("\u9A57\u8B49\u8CE3\u65B9\u7D71\u7DE8\u6642\u51FA\u932F\uFF1A",t)}}this.isLoading.set(!0),this.errorMessage.set(null);try{let t=this.ledgerForm.value,i={entry_date:t.entry_date,item_group:t.item_group,subject_name:t.subject_name,amount:Number(t.amount),invoice_no:t.invoice_no,vendor_tax_id:t.vendor_tax_id,vendor_name:t.vendor_name,vendor_id:t.vendor_id,description:t.description,is_sigh_off:t.is_sigh_off||!1,gl_account_id:t.gl_account_id||null};if(this.editingTransaction()){let r=this.editingTransaction();if((await this.apiService.updateLedgerEntry(k({entry_id:r.entry_id},i))).success){let s=this.allTransactions().map(u=>u.entry_id===r.entry_id?k(k({},u),i):u);this.allTransactions.set(s),this.closeModal()}}else{let r=await this.apiService.createLedgerEntry(i);if(r.success&&r.data){let o={entry_id:r.data.entry_id,entry_date:r.data.entry_date,item_group:r.data.item_group,subject_name:r.data.subject_name,amount:r.data.amount,invoice_no:r.data.invoice_no,vendor_tax_id:r.data.vendor_tax_id,vendor_name:r.data.vendor_name,vendor_id:r.data.vendor_id,description:r.data.description,is_sigh_off:r.data.is_sigh_off||!1,gl_account_id:r.data.gl_account_id||null};this.newlyCreatedEntry.set(o),this.resetForm(),await this.loadShipmentItemsForEntry(o.entry_id)}}}catch(t){console.error("\u4FDD\u5B58\u5931\u6557:",t),this.errorMessage.set("\u4FDD\u5B58\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoading.set(!1)}this.editingTransaction()||this.applyFilters()}resetForm(){this.ledgerForm.reset({is_sigh_off:!1}),this.submitted.set(!1)}resetAddView(){this.newlyCreatedEntry.set(null),this.shipmentItems.set([]),this.shipmentItemsError.set(null),this.resetForm()}formatCurrency(e){if(e==null||isNaN(e))return"";let t=e<0,r=Math.abs(e).toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0});return t?`-${r}`:r}getErrorMessage(e){let t=this.ledgerForm.get(e);if(!t||!t.errors)return"";if(e==="vendor_tax_id"){if(t.errors.pattern)return"\u8CE3\u65B9\u7D71\u7DE8\u53EA\u80FD\u662F 1-8 \u4F4D\u6578\u5B57";if(t.errors.required)return"\u8CE3\u65B9\u7D71\u7DE8\u70BA\u5FC5\u586B"}return t.errors.required?`${e} \u70BA\u5FC5\u586B`:t.errors.pattern?`${e} \u683C\u5F0F\u4E0D\u6B63\u78BA`:"\u8F38\u5165\u8CC7\u6599\u6709\u8AA4"}sanitizeVendorTaxId(e){return e?e.replace(/\D/g,"").slice(0,8):""}onVendorTaxIdInput(e){let t=e.target,i=this.sanitizeVendorTaxId(t.value);this.ledgerForm.get("vendor_tax_id")?.setValue(i)}formatDate(e){let t=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return`${t}-${i}-${r}`}normalizeDateInput(e){if(!e)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;let t=new Date(e);return Number.isNaN(t.getTime())?"":this.formatDate(t)}isInvalid(e){let t=this.ledgerForm.get(e);return!!t&&t.invalid&&(t.touched||this.submitted())}};Ls.\u0275fac=function(t){return new(t||Ls)},Ls.\u0275cmp=ie({type:Ls,selectors:[["app-ledger"]],decls:18,vars:11,consts:[[1,"space-y-6"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-4","flex","items-center","gap-3"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4","flex","items-center","gap-3"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"border-b","border-gray-200"],["aria-label","Tabs",1,"-mb-px","flex","space-x-6"],[1,"whitespace-nowrap","py-4","px-1","border-b-2","font-medium","text-sm",3,"click"],[1,"pt-6"],[1,"space-y-4"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],["name","hourglass-outline",1,"text-blue-600","text-xl","animate-spin"],[1,"text-blue-700"],["name","alert-circle-outline",1,"text-red-600","text-xl"],[1,"text-red-700"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4","p-4","bg-gray-50","rounded-lg"],[1,"flex","items-center","gap-2"],["for","startDate",1,"text-sm","font-medium","text-gray-600","shrink-0"],[1,"relative","w-full"],["type","date","id","startDate",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white","pr-10",3,"ngModelChange","ngModel"],[1,"absolute","inset-y-0","right-0","flex","items-center","pr-3","pointer-events-none"],["name","calendar-outline",1,"text-gray-400"],["for","endDate",1,"text-sm","font-medium","text-gray-600","shrink-0"],["type","date","id","endDate",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white","pr-10",3,"ngModelChange","ngModel"],[1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white","disabled:bg-gray-100","disabled:cursor-not-allowed",3,"ngModelChange","ngModel","disabled"],[1,"lg:col-span-2"],["type","text","placeholder","\u641C\u5C0BID...","inputmode","numeric","pattern","[0-9]*",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["type","text","placeholder","\u641C\u5C0B\u8AAA\u660E\u95DC\u9375\u5B57...",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"flex","items-center","gap-2","lg:col-span-4","justify-end"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-4","py-3"],[1,"flex","items-center","justify-center","gap-2"],["type","checkbox","title","\u5168\u90E8\u7C3D\u6838/\u53D6\u6D88\u7C3D\u6838",1,"rounded","h-4","w-4","text-indigo-600","border-gray-300","focus:ring-indigo-500","cursor-pointer",3,"change","checked"],[1,"px-4","py-3","cursor-pointer",3,"click"],["name","swap-vertical-outline"],[1,"px-4","py-3","cursor-pointer","text-right",3,"click"],[1,"border-b","hover:bg-gray-50","cursor-pointer",3,"bg-red-50"],[1,"flex","flex-col","sm:flex-row","items-center","justify-between","gap-3","pt-4"],[1,"text-sm","text-gray-600"],["type","button",1,"px-3","py-1.5","text-sm","border","rounded-md","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["name","hourglass-outline",1,"animate-spin"],["name","filter-outline"],[1,"border-b","hover:bg-gray-50","cursor-pointer",3,"click"],[1,"px-4","py-2","text-center"],["type","checkbox","disabled","",1,"rounded","h-4","w-4","text-indigo-500","border-gray-300","cursor-not-allowed",3,"checked"],[1,"px-4","py-2"],[1,"px-4","py-2","text-right"],[1,"px-4","py-2","truncate","max-w-xs"],["colspan","9",1,"text-center","py-8","text-gray-500"],["novalidate","",1,"space-y-6","max-w-4xl","mx-auto",3,"formGroup"],[1,"max-w-4xl","mx-auto"],["novalidate","",1,"space-y-6","max-w-4xl","mx-auto",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],["for","date",1,"block","text-sm","font-medium","text-gray-700"],[1,"relative","mt-1"],["type","date","id","date","formControlName","entry_date",1,"block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2","pr-10"],["for","item",1,"block","text-sm","font-medium","text-gray-700"],["id","item","formControlName","item_group",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["value","","disabled",""],["for","category",1,"block","text-sm","font-medium","text-gray-700"],["id","category","formControlName","subject_name",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","amount",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","amount","formControlName","amount","placeholder","\u6B63\u6578\u70BA\u6536\u5165\uFF0C\u8CA0\u6578\u70BA\u8A72\u9805\u76EE\u5C0D\u6C96",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2","text-right"],["for","invoiceNumber",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","invoiceNumber","formControlName","invoice_no",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","vendorTaxId",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","vendorTaxId","formControlName","vendor_tax_id","inputmode","numeric","pattern","\\d*","maxlength","8",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2",3,"input"],[1,"md:col-span-2"],["for","vendorName",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","vendorName","formControlName","vendor_name",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","description",1,"block","text-sm","font-medium","text-gray-700"],["id","description","formControlName","description","rows","3",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],[1,"flex","justify-end","gap-4"],["type","button",1,"px-4","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],["type","submit",1,"px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-indigo-600","hover:bg-indigo-700"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-4","mb-6","flex","items-center","gap-3"],["name","checkmark-circle-outline",1,"text-blue-600","text-xl"],[1,"mt-8"],[1,"flex","items-center","justify-between","mb-4"],[1,"flex","items-center","gap-4","flex-grow"],[1,"text-lg","font-semibold","text-gray-900"],[1,"flex","items-center","gap-2","px-3","py-1.5","text-sm","text-green-700","bg-green-50","border","border-green-200","rounded-md"],[1,"flex","items-center","gap-2","text-sm","text-blue-600"],["type","button",1,"px-3","py-1.5","text-sm","bg-green-600","text-white","rounded-md","hover:bg-green-700","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","gap-1",3,"click","disabled"],["name","add-outline"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-3","text-red-700","text-sm","mb-4"],[1,"text-sm","text-gray-500"],[1,"flex","justify-end","gap-4","mt-6","pt-6","border-t"],["type","button",1,"px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-indigo-600","hover:bg-indigo-700",3,"click"],["name","checkmark-circle-outline",1,"text-green-600"],["name","refresh-outline",1,"animate-spin"],["name","alert-circle-outline"],[3,"class"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"block","text-xs","font-medium","text-gray-600"],["type","text",1,"mt-1","block","w-full","border","bg-white","rounded-md","shadow-sm","p-2",3,"ngModelChange","ngModel","name"],["type","number","step","0.01",1,"mt-1","block","w-full","border","bg-white","rounded-md","shadow-sm","p-2","text-right",3,"ngModelChange","ngModel","name"],["type","text","readonly","",1,"mt-1","block","w-full","border","bg-gray-100","rounded-md","shadow-sm","p-2","text-right",3,"value"],["rows","2",1,"mt-1","block","w-full","border","bg-white","rounded-md","shadow-sm","p-2",3,"ngModelChange","ngModel","name"],[1,"flex","justify-end","gap-2","mt-3"],["type","button",1,"px-3","py-1.5","text-sm","bg-red-600","text-white","rounded-md","hover:bg-red-700","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","gap-1",3,"click"],["name","trash-outline"],["type","button",1,"px-3","py-1.5","text-sm","bg-indigo-600","text-white","rounded-md","hover:bg-indigo-700","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-2xl","max-h-[90vh]","flex","flex-col"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],["novalidate","",1,"space-y-6",3,"ngSubmit","formGroup"],["for","modal-date",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","modal-date","formControlName","entry_date",1,"block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2","pr-10"],["for","modal-item",1,"block","text-sm","font-medium","text-gray-700"],["id","modal-item","formControlName","item_group",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","modal-category",1,"block","text-sm","font-medium","text-gray-700"],["id","modal-category","formControlName","subject_name",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","modal-amount",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","modal-amount","formControlName","amount",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2","text-right"],["for","modal-invoiceNumber",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","modal-invoiceNumber","formControlName","invoice_no",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","modal-vendorTaxId",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","modal-vendorTaxId","formControlName","vendor_tax_id","inputmode","numeric","pattern","\\d*","maxlength","8",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2",3,"input"],[1,"mt-1","text-sm","text-red-600"],["for","modal-vendorName",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","modal-vendorName","formControlName","vendor_name","readonly","",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2","cursor-not-allowed","opacity-60"],["for","modal-description",1,"block","text-sm","font-medium","text-gray-700"],["id","modal-description","formControlName","description","rows","3",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],[1,"flex","items-center","space-x-2"],["type","checkbox","formControlName","is_sigh_off",1,"rounded","h-4","w-4","text-indigo-600","focus:ring-indigo-500","border-gray-300"],[1,"text-sm","text-gray-700"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-6"],["type","button",1,"px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-red-600","hover:bg-red-700",3,"click"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-[60]"],[1,"mt-8","pt-6","border-t"],[1,"bg-white","rounded-lg","shadow-lg","p-6","max-w-md","w-full","mx-4"],[1,"flex","items-center","gap-3","mb-4"],["name","warning-outline",1,"text-2xl","text-orange-600"],[1,"space-y-3","mb-6"],[1,"text-gray-700"],[1,"bg-red-50","border","border-red-200","rounded-md","p-3"],[1,"flex","justify-end","gap-3"],[1,"px-4","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],[1,"px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-red-600","hover:bg-red-700",3,"click"],[1,"text-sm","text-red-700"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","m-4"],[1,"p-6","text-center"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-blue-100"],["name","help-outline",1,"h-6","w-6","text-blue-600"],[1,"mt-4","text-lg","font-semibold","text-gray-900"],[1,"mt-2","text-sm","text-gray-500"],[1,"flex","justify-center","gap-4","bg-gray-50","px-6","py-4","rounded-b-xl"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","button",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","hover:bg-indigo-700",3,"click"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100"],["name","trash-outline",1,"h-6","w-6","text-red-600"],[1,"mt-1","text-xs","text-gray-400"],["type","button",1,"px-4","py-2","bg-red-600","text-white","rounded-md","hover:bg-red-700",3,"click"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"h1",1),c(2,"\u6D41\u6C34\u5E33"),a(),A(3,EV,4,0,"div",2),A(4,bV,4,1,"div",3),l(5,"div",4)(6,"div",5)(7,"nav",6)(8,"button",7),b("click",function(){return i.changeView("details")}),c(9," \u6D41\u6C34\u5E33\u7D30\u9805 "),a(),l(10,"button",7),b("click",function(){return i.changeView("add")}),c(11," \u65B0\u589E\u5E33\u52D9 "),a()()(),l(12,"div",8),A(13,NV,88,17,"div",9),A(14,qV,2,1),a()()(),A(15,rO,80,21,"div",10),A(16,oO,14,1,"div",10),A(17,sO,16,1,"div",10)),t&2){let r,o;f(3),N(i.isLoading()?3:-1),f(),N(i.errorMessage()?4:-1),f(4),De(i.activeView()==="details"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),f(2),De(i.activeView()==="add"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),f(3),N(i.activeView()==="details"?13:-1),f(),N(i.activeView()==="add"?14:-1),f(),N(i.isModalOpen()?15:-1),f(),N((r=i.confirmationState())?16:-1,r),f(),N((o=i.deleteConfirmation())?17:-1,o)}},dependencies:[re,be,$e,ke,Ve,Ce,Ft,Ll,Ae,me,Fe,$l,Hl,Ie,Oe,Pe,Be],encapsulation:2,changeDetection:0});var Zm=Ls;var yo=class yo{constructor(){this.holidays2024=[{date:"2024-01-01",name:"\u5143\u65E6"},{date:"2024-02-08",name:"\u8FB2\u66C6\u6625\u7BC0"},{date:"2024-02-09",name:"\u8FB2\u66C6\u6625\u7BC0"},{date:"2024-02-10",name:"\u8FB2\u66C6\u6625\u7BC0"},{date:"2024-02-11",name:"\u8FB2\u66C6\u6625\u7BC0"},{date:"2024-02-12",name:"\u8FB2\u66C6\u6625\u7BC0"},{date:"2024-02-13",name:"\u8FB2\u66C6\u6625\u7BC0"},{date:"2024-02-14",name:"\u8FB2\u66C6\u6625\u7BC0"},{date:"2024-02-28",name:"\u548C\u5E73\u7D00\u5FF5\u65E5"},{date:"2024-04-04",name:"\u5152\u7AE5\u7BC0"},{date:"2024-04-05",name:"\u6E05\u660E\u7BC0"},{date:"2024-06-10",name:"\u7AEF\u5348\u7BC0"},{date:"2024-09-17",name:"\u4E2D\u79CB\u7BC0"},{date:"2024-10-10",name:"\u570B\u6176\u65E5"}]}getHolidays(e){return e===2024?this.holidays2024:[]}};yo.\u0275fac=function(t){return new(t||yo)},yo.\u0275prov=J({token:yo,factory:yo.\u0275fac,providedIn:"root"});var Xm=yo;var aO=()=>({month:"long"}),lO=()=>["\u65E5","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D"],uO=(n,e)=>e.date,dO=(n,e)=>e.id;function cO(n,e){if(n&1&&(Xe(0,"div",7),c(1),et()),n&2){let t=e.$implicit;f(),E(t)}}function mO(n,e){if(n&1&&(Xe(0,"div",12),c(1),et()),n&2){let t=v().$implicit;f(),V(" ",t.holiday.name," ")}}function pO(n,e){if(n&1){let t=B();Xe(0,"div",14),Xo("click",function(){let r=w(t).$implicit,o=v(2);return T(o.editEvent(r))}),c(1),et()}if(n&2){let t=e.$implicit;z("opacity-60",t.status==="cancelled")("line-through",t.status==="cancelled"),f(),V(" ",t.name," ")}}function fO(n,e){if(n&1&&(Xe(0,"div",9)(1,"time",10),c(2),et(),Xe(3,"div",11),A(4,mO,2,1,"div",12),O(5,pO,2,5,"div",13,dO),et()()),n&2){let t=e.$implicit;z("bg-gray-50",!t.isCurrentMonth),f(),z("text-gray-400",!t.isCurrentMonth)("bg-indigo-600",t.isToday)("text-white",t.isToday)("rounded-full",t.isToday)("w-6",t.isToday)("h-6",t.isToday)("flex",t.isToday)("items-center",t.isToday)("justify-center",t.isToday),jd("dateTime",t.date.toISOString()),f(),V(" ",t.date.getDate()," "),f(2),N(t.holiday?4:-1),f(),L(t.events)}}var Bs=class Bs{constructor(){this.holidayService=P(Xm);this.router=P(Le);this.events=Qd.required();this.currentDate=S(new Date("2024-10-01"));this.holidays=S([]);this.calendarGrid=H(()=>{let e=this.events(),t=this.holidays(),i=this.currentDate(),r=i.getFullYear(),o=i.getMonth(),s=new Date(r,o,1),u=new Date(r,o+1,0),d=s.getDay(),m=new Date(s);m.setDate(s.getDate()-d);let h=[],y=new Date;y.setHours(0,0,0,0);for(let _=0;_<42;_++){let C=new Date(m);C.setDate(m.getDate()+_);let D=this.formatDate(C);h.push({date:C,isCurrentMonth:C.getMonth()===o,isToday:C.getTime()===y.getTime(),events:e.filter(I=>I.date===D),holiday:t.find(I=>I.date===D)})}return h});this.loadHolidays()}formatDate(e){let t=e.getFullYear(),i=(e.getMonth()+1).toString().padStart(2,"0"),r=e.getDate().toString().padStart(2,"0");return`${t}-${i}-${r}`}loadHolidays(){let e=this.currentDate().getFullYear();this.holidays.set(this.holidayService.getHolidays(e))}previousMonth(){this.currentDate.update(e=>{let t=new Date(e);return t.setMonth(e.getMonth()-1),t}),this.loadHolidays()}nextMonth(){this.currentDate.update(e=>{let t=new Date(e);return t.setMonth(e.getMonth()+1),t}),this.loadHolidays()}editEvent(e){this.router.navigate(["/events/edit",e.id])}};Bs.\u0275fac=function(t){return new(t||Bs)},Bs.\u0275cmp=ie({type:Bs,selectors:[["app-calendar-view"]],inputs:{events:[1,"events"]},decls:13,vars:4,consts:[[1,"space-y-4"],[1,"flex","items-center","justify-between"],[1,"p-2","rounded-full","hover:bg-gray-100","transition-colors",3,"click"],["name","chevron-back-outline",1,"text-xl","text-gray-600"],[1,"text-xl","font-semibold","text-gray-800"],["name","chevron-forward-outline",1,"text-xl","text-gray-600"],[1,"grid","grid-cols-7","gap-px","bg-gray-200","border","border-gray-200","rounded-lg","overflow-hidden"],[1,"py-2","text-center","text-sm","font-medium","text-gray-600","bg-gray-50"],[1,"relative","min-h-[120px]","bg-white","p-2",3,"bg-gray-50"],[1,"relative","min-h-[120px]","bg-white","p-2"],[1,"text-sm","font-medium",3,"dateTime"],[1,"mt-2","space-y-1","overflow-hidden"],[1,"text-xs","text-red-700","bg-red-100","rounded","px-1","py-0.5","truncate","font-medium"],[1,"text-xs","text-indigo-800","bg-indigo-100","rounded","px-1","py-0.5","cursor-pointer","hover:bg-indigo-200","truncate",3,"opacity-60","line-through"],[1,"text-xs","text-indigo-800","bg-indigo-100","rounded","px-1","py-0.5","cursor-pointer","hover:bg-indigo-200","truncate",3,"click"]],template:function(t,i){t&1&&(Xe(0,"div",0)(1,"div",1)(2,"button",2),Xo("click",function(){return i.previousMonth()}),qi(3,"ion-icon",3),et(),Xe(4,"h2",4),c(5),et(),Xe(6,"button",2),Xo("click",function(){return i.nextMonth()}),qi(7,"ion-icon",5),et()(),Xe(8,"div",6),O(9,cO,2,1,"div",7,W),O(11,fO,7,23,"div",8,uO),et()()),t&2&&(f(5),ut(" ",i.currentDate().getFullYear(),"\u5E74 ",i.currentDate().toLocaleString("zh-TW",Vt(2,aO))," "),f(4),L(Vt(3,lO)),f(2),L(i.calendarGrid()))},dependencies:[re],encapsulation:2,changeDetection:0});var ep=Bs;var gO=(n,e)=>e.value,hO=(n,e)=>e.id;function yO(n,e){if(n&1&&(l(0,"option",15),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),V("",t,"\u5E74")}}function _O(n,e){if(n&1&&(l(0,"option",15),c(1),a()),n&2){let t=e.$implicit;M("value",t.value),f(),E(t.label)}}function vO(n,e){if(n&1){let t=B();l(0,"tr",35),b("click",function(){let r=w(t).$implicit,o=v(2);return T(o.editEvent(r))}),l(1,"td",36),c(2),a(),l(3,"td",36),c(4),a(),l(5,"td",36),c(6),a(),l(7,"td",36),c(8),a(),l(9,"td",37),c(10),a(),l(11,"td",36),c(12),a(),l(13,"td",36),c(14),a(),l(15,"td",38),c(16),a(),l(17,"td",38),c(18),a(),l(19,"td",39),c(20),a(),l(21,"td",40),c(22),a()()}if(n&2){let t=e.$implicit,i=e.$index,r=v(2);z("text-gray-400",t.status==="cancelled")("line-through",t.status==="cancelled"),f(2),E((r.currentPage()-1)*r.pageSize+i+1),f(2),E(t.type),f(2),E(r.formatDateForDisplay(t.date)),f(2),E(t.time),f(2),E(t.name),f(2),E(t.organizer),f(2),E(t.attendees),f(2),E(r.formatCurrency(t.estimatedRevenue)),f(2),E(r.formatCurrency(t.deposit)),f(2),E(r.formatCurrency(t.actualRevenue)),f(2),E(t.notes)}}function CO(n,e){n&1&&(l(0,"tr")(1,"td",41),c(2,"\u627E\u4E0D\u5230\u7B26\u5408\u689D\u4EF6\u7684\u6D3B\u52D5\u3002"),a()())}function xO(n,e){if(n&1){let t=B();l(0,"div",34)(1,"span",42),c(2),a(),l(3,"div",12)(4,"button",43),b("click",function(){w(t);let r=v(2);return T(r.prevPage())}),x(5,"ion-icon",44),a(),l(6,"span",45),c(7),a(),l(8,"button",43),b("click",function(){w(t);let r=v(2);return T(r.nextPage())}),x(9,"ion-icon",46),a()()()}if(n&2){let t=v(2);f(2),kt(" \u986F\u793A\u7B2C ",(t.currentPage()-1)*t.pageSize+1," \u81F3 ",t.Math.min(t.currentPage()*t.pageSize,t.filteredEvents().length)," \u7B46\uFF0C\u5171 ",t.filteredEvents().length," \u7B46 "),f(2),M("disabled",t.currentPage()===1),f(3),ut("\u7B2C ",t.currentPage()," \u9801 / \u5171 ",t.totalPages()," \u9801"),f(),M("disabled",t.currentPage()===t.totalPages())}}function EO(n,e){if(n&1){let t=B();l(0,"div",26)(1,"table",27)(2,"thead",28)(3,"tr")(4,"th",29),c(5,"\u7DE8\u865F"),a(),l(6,"th",30),b("click",function(){w(t);let r=v();return T(r.sortData("type"))}),c(7,"\u985E\u578B "),x(8,"ion-icon",31),a(),l(9,"th",30),b("click",function(){w(t);let r=v();return T(r.sortData("date"))}),c(10,"\u65E5\u671F "),x(11,"ion-icon",31),a(),l(12,"th",30),b("click",function(){w(t);let r=v();return T(r.sortData("time"))}),c(13,"\u6642\u9593 "),x(14,"ion-icon",31),a(),l(15,"th",30),b("click",function(){w(t);let r=v();return T(r.sortData("name"))}),c(16,"\u540D\u7A31 "),x(17,"ion-icon",31),a(),l(18,"th",30),b("click",function(){w(t);let r=v();return T(r.sortData("organizer"))}),c(19,"\u4ECB\u7D39\u4EBA "),x(20,"ion-icon",31),a(),l(21,"th",30),b("click",function(){w(t);let r=v();return T(r.sortData("attendees"))}),c(22,"\u4EBA\u6578 "),x(23,"ion-icon",31),a(),l(24,"th",32),b("click",function(){w(t);let r=v();return T(r.sortData("estimatedRevenue"))}),c(25,"\u9810\u8A08\u6536\u5165 "),x(26,"ion-icon",31),a(),l(27,"th",32),b("click",function(){w(t);let r=v();return T(r.sortData("deposit"))}),c(28,"\u8A02\u91D1 "),x(29,"ion-icon",31),a(),l(30,"th",32),b("click",function(){w(t);let r=v();return T(r.sortData("actualRevenue"))}),c(31,"\u5BE6\u969B\u6536\u5165 "),x(32,"ion-icon",31),a(),l(33,"th",30),b("click",function(){w(t);let r=v();return T(r.sortData("notes"))}),c(34,"\u5099\u8A3B "),x(35,"ion-icon",31),a()()(),l(36,"tbody"),O(37,vO,23,15,"tr",33,hO,!1,CO,3,0,"tr"),a()()(),A(40,xO,10,7,"div",34)}if(n&2){let t=v();f(37),L(t.paginatedEvents()),f(3),N(t.totalPages()>1?40:-1)}}function bO(n,e){if(n&1&&x(0,"app-calendar-view",25),n&2){let t=v();M("events",t.filteredEvents())}}var Us=class Us{constructor(){this.dataService=P(Tt);this.router=P(Le);this.allEvents=S([]);this.searchTerm=S("");this.activeView=S("list");this.availableYears=S([]);this.availableMonths=S([]);this.selectedYear=S(2024);this.selectedMonth=S(10);this.appliedFilters=S({year:2024,month:10});this.currentPage=S(1);this.pageSize=10;this.Math=Math;this.sortColumn=S("date");this.sortDirection=S("asc");this.filteredEvents=H(()=>{let e=this.searchTerm().toLowerCase(),{year:t,month:i}=this.appliedFilters(),r=this.allEvents();if(t){let d=t.toString();if(i!==0){let m=String(i).padStart(2,"0"),h=`${d}-${m}`;r=r.filter(y=>y.date.startsWith(h))}else r=r.filter(m=>m.date.startsWith(d))}e&&(r=r.filter(d=>d.name.toLowerCase().includes(e)||d.date.includes(e)));let o=this.sortColumn(),s=this.sortDirection(),u=[...r];return u.sort((d,m)=>{let h=d[o],y=m[o];return h==null&&y!=null?1:h!=null&&y==null?-1:h==null&&y==null?0:h<y?s==="asc"?-1:1:h>y?s==="asc"?1:-1:0}),u});this.paginatedEvents=H(()=>{let e=this.filteredEvents(),t=(this.currentPage()-1)*this.pageSize;return e.slice(t,t+this.pageSize)});this.totalPages=H(()=>Math.ceil(this.filteredEvents().length/this.pageSize));this.eventsSummary=H(()=>{let t=this.filteredEvents().filter(s=>s.status==="active"),i=t.reduce((s,u)=>s+u.estimatedRevenue,0),r=t.reduce((s,u)=>s+u.actualRevenue,0),o=r/2e5*100;return{estimatedRevenue:i,actualRevenue:r,targetRevenue:2e5,achievementRate:o}});this.loadEvents(),this.setupFilters()}loadEvents(){this.allEvents.set(this.dataService.getEvents())}setupFilters(){let e=[...new Set(this.allEvents().map(i=>new Date(i.date).getFullYear()))].sort((i,r)=>r-i);this.availableYears.set(e),this.availableMonths.set([{value:0,label:"\u5168\u5E74"},...Array.from({length:12},(i,r)=>({value:r+1,label:`${r+1}\u6708`}))]);let t=e.includes(2024)?2024:e[0]||new Date().getFullYear();this.selectedYear.set(t),this.selectedMonth.set(10),this.appliedFilters.set({year:t,month:10})}applyFilter(){this.appliedFilters.set({year:this.selectedYear(),month:this.selectedMonth()}),this.currentPage.set(1)}resetFilter(){let e=this.availableYears().includes(2024)?2024:this.availableYears()[0]||new Date().getFullYear();this.selectedYear.set(e),this.selectedMonth.set(10),this.applyFilter()}onSearchChange(e){this.searchTerm.set(e),this.currentPage.set(1)}sortData(e){this.sortColumn()===e?this.sortDirection.update(t=>t==="asc"?"desc":"asc"):(this.sortColumn.set(e),this.sortDirection.set("asc"))}goToPage(e){e>=1&&e<=this.totalPages()&&this.currentPage.set(e)}nextPage(){this.goToPage(this.currentPage()+1)}prevPage(){this.goToPage(this.currentPage()-1)}editEvent(e){this.router.navigate(["/events/edit",e.id])}formatDateForDisplay(e){let t=new Date(e),i=t.getMonth()+1,r=t.getDate(),o=["\u65E5","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D"][t.getDay()];return`${i}/${r} (${o})`}formatCurrency(e){return e==null?"":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}setView(e){this.activeView.set(e)}};Us.\u0275fac=function(t){return new(t||Us)},Us.\u0275cmp=ie({type:Us,selectors:[["app-events"]],decls:55,vars:32,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],["routerLink","/events/new",1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm"],["name","add-outline"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-4","gap-6"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"text-sm","text-gray-500"],[1,"text-2xl","font-semibold","text-gray-900"],[1,"text-2xl","font-semibold"],[1,"flex","flex-wrap","justify-between","items-center","gap-4","mb-4","border-b","pb-4"],[1,"flex","flex-wrap","items-center","gap-4"],[1,"flex","items-center","gap-2"],[1,"text-sm","font-medium","text-gray-600","shrink-0"],[1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-50","pr-8",3,"ngModelChange","ngModel"],[3,"value"],[1,"bg-indigo-600","text-white","px-3","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-1","text-sm",3,"click"],["name","filter-outline"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],["type","text","placeholder","\u4F9D\u6D3B\u52D5\u540D\u7A31\u6216\u65E5\u671F\u641C\u5C0B...",1,"w-full","sm:w-auto","flex-grow","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"flex","items-center","border","border-gray-200","rounded-lg","p-1","space-x-1","bg-gray-50","shrink-0"],[1,"px-3","py-1","text-sm","font-medium","rounded-md","transition-colors","flex","items-center","gap-2",3,"click"],["name","list-outline"],["name","calendar-outline"],[3,"events"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-4","py-3"],[1,"px-4","py-3","cursor-pointer",3,"click"],["name","swap-vertical-outline"],[1,"px-4","py-3","cursor-pointer","text-right",3,"click"],[1,"border-b","hover:bg-gray-50","cursor-pointer",3,"text-gray-400","line-through"],[1,"flex","justify-between","items-center","pt-4","border-t","mt-4"],[1,"border-b","hover:bg-gray-50","cursor-pointer",3,"click"],[1,"px-4","py-2"],[1,"px-4","py-2","font-medium"],[1,"px-4","py-2","text-right"],[1,"px-4","py-2","text-right","font-semibold"],[1,"px-4","py-2","truncate","max-w-xs"],["colspan","11",1,"text-center","py-8","text-gray-500"],[1,"text-sm","text-gray-600"],[1,"px-3","py-1","border","rounded-md","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["name","chevron-back-outline"],[1,"text-sm"],["name","chevron-forward-outline"]],template:function(t,i){t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),c(3,"\u6D3B\u52D5\u7BA1\u7406"),a(),l(4,"a",3),x(5,"ion-icon",4),l(6,"span"),c(7,"\u65B0\u589E\u6D3B\u52D5"),a()()(),l(8,"div",5)(9,"div",6)(10,"p",7),c(11,"\u9810\u8A08\u7E3D\u6536\u5165"),a(),l(12,"p",8),c(13),a()(),l(14,"div",6)(15,"p",7),c(16,"\u5BE6\u969B\u7E3D\u6536\u5165"),a(),l(17,"p",8),c(18),a()(),l(19,"div",6)(20,"p",7),c(21,"\u76EE\u6A19\u6536\u5165"),a(),l(22,"p",8),c(23),a()(),l(24,"div",6)(25,"p",7),c(26,"\u76EE\u6A19\u9054\u6210\u7387"),a(),l(27,"p",9),c(28),a()()(),l(29,"div",6)(30,"div",10)(31,"div",11)(32,"div",12)(33,"label",13),c(34,"\u6642\u9593:"),a(),l(35,"select",14),Z("ngModelChange",function(o){return ee(i.selectedYear,o)||(i.selectedYear=o),o}),O(36,yO,2,2,"option",15,W),a(),l(38,"select",14),Z("ngModelChange",function(o){return ee(i.selectedMonth,o)||(i.selectedMonth=o),o}),O(39,_O,2,2,"option",15,gO),a(),l(41,"button",16),b("click",function(){return i.applyFilter()}),x(42,"ion-icon",17),a(),l(43,"button",18),b("click",function(){return i.resetFilter()}),x(44,"ion-icon",19),a()(),l(45,"input",20),b("ngModelChange",function(o){return i.onSearchChange(o)}),a()(),l(46,"div",21)(47,"button",22),b("click",function(){return i.setView("list")}),x(48,"ion-icon",23),c(49," \u5217\u8868 "),a(),l(50,"button",22),b("click",function(){return i.setView("calendar")}),x(51,"ion-icon",24),c(52," \u65E5\u66C6 "),a()()(),A(53,EO,41,2)(54,bO,1,1,"app-calendar-view",25),a()()),t&2&&(f(13),E(i.formatCurrency(i.eventsSummary().estimatedRevenue)),f(5),E(i.formatCurrency(i.eventsSummary().actualRevenue)),f(5),E(i.formatCurrency(i.eventsSummary().targetRevenue)),f(4),z("text-green-600",i.eventsSummary().achievementRate>=100)("text-red-600",i.eventsSummary().achievementRate<100),f(),V(" ",i.eventsSummary().achievementRate.toFixed(1),"% "),f(7),Q("ngModel",i.selectedYear),f(),L(i.availableYears()),f(2),Q("ngModel",i.selectedMonth),f(),L(i.availableMonths()),f(6),M("ngModel",i.searchTerm()),f(2),z("bg-white",i.activeView()==="list")("shadow-sm",i.activeView()==="list")("text-indigo-600",i.activeView()==="list")("text-gray-600",i.activeView()!=="list")("hover:bg-gray-200",i.activeView()!=="list"),f(3),z("bg-white",i.activeView()==="calendar")("shadow-sm",i.activeView()==="calendar")("text-indigo-600",i.activeView()==="calendar")("text-gray-600",i.activeView()!=="calendar")("hover:bg-gray-200",i.activeView()!=="calendar"),f(3),N(i.activeView()==="list"?53:54))},dependencies:[re,be,ke,Ve,Ce,Ae,me,Ie,Cr,ep],encapsulation:2,changeDetection:0});var tp=Us;function SO(n,e){if(n&1){let t=B();l(0,"button",35),b("click",function(){w(t);let r=v();return T(r.onDelete())}),c(1," \u522A\u9664\u6D3B\u52D5 "),a()}}var $s=class $s{constructor(){this.fb=P(He);this.dataService=P(Tt);this.router=P(Le);this.route=P(un);this.isEditMode=S(!1);this.eventId=S(null);this.submitted=S(!1);this.eventForm=this.fb.group({type:["",U.required],status:["active",U.required],date:["",U.required],time:[""],name:["",U.required],organizer:[""],attendees:["",U.required],estimatedRevenue:[0,[U.required,U.min(0)]],deposit:[null],actualRevenue:[0,[U.required,U.min(0)]],notes:[""]});this.route.paramMap.pipe(he(e=>e.get("id")),Ze(e=>{this.isEditMode.set(!!e),this.eventId.set(e)}),It(e=>!!e),he(e=>this.dataService.getEventById(e)),Ze(e=>{e?this.eventForm.patchValue(e):(alert("\u627E\u4E0D\u5230\u6D3B\u52D5\uFF01"),this.router.navigate(["/events"]))})).subscribe()}isInvalid(e){let t=this.eventForm.get(e);return!!t&&t.invalid&&(t.touched||this.submitted())}onSubmit(){if(this.submitted.set(!0),this.eventForm.invalid){alert("\u8ACB\u6AA2\u67E5\u8868\u55AE\u4E26\u586B\u5BEB\u6240\u6709\u5FC5\u586B\u6B04\u4F4D\u3002");return}let e=this.eventForm.getRawValue(),t=q(k({},e),{deposit:e.deposit??void 0});this.isEditMode()&&this.eventId()?(this.dataService.updateEvent(q(k({},t),{id:this.eventId()})),alert("\u6D3B\u52D5\u5DF2\u6210\u529F\u66F4\u65B0\uFF01")):(this.dataService.addEvent(t),alert("\u6D3B\u52D5\u5DF2\u6210\u529F\u65B0\u589E\uFF01")),this.router.navigate(["/events"])}onDelete(){this.isEditMode()&&this.eventId()&&confirm("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u6B64\u6D3B\u52D5\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002")&&(this.dataService.deleteEvent(this.eventId()),alert("\u6D3B\u52D5\u5DF2\u522A\u9664\u3002"),this.router.navigate(["/events"]))}onCancel(){this.router.navigate(["/events"])}};$s.\u0275fac=function(t){return new(t||$s)},$s.\u0275cmp=ie({type:$s,selectors:[["app-event-form"]],decls:61,vars:18,consts:[[1,"space-y-6","max-w-4xl","mx-auto"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-white","p-6","md:p-8","rounded-xl","shadow-md"],["novalidate","",1,"space-y-6",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-x-6","gap-y-4"],[1,"md:col-span-2"],["for","name",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","name","formControlName","name",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","date",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","date","formControlName","date",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","time",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","time","formControlName","time","placeholder","\u4F8B\u5982: 14:30~18:30",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","type",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","type","formControlName","type",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","attendees",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","attendees","formControlName","attendees","placeholder","\u4F8B\u5982: 10~15",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","organizer",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","organizer","formControlName","organizer",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","estimatedRevenue",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","estimatedRevenue","formControlName","estimatedRevenue",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","deposit",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","deposit","formControlName","deposit",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","actualRevenue",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","actualRevenue","formControlName","actualRevenue",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["for","status",1,"block","text-sm","font-medium","text-gray-700"],["id","status","formControlName","status",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],["value","active"],["value","cancelled"],["for","notes",1,"block","text-sm","font-medium","text-gray-700"],["id","notes","formControlName","notes","rows","4",1,"mt-1","block","w-full","border","bg-gray-50","rounded-md","shadow-sm","p-2"],[1,"flex","items-center","justify-end","gap-4","pt-4","border-t","mt-6"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-red-600","bg-transparent","hover:bg-red-50","rounded-md"],[1,"flex-grow"],["type","button",1,"px-4","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],["type","submit",1,"px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-indigo-600","hover:bg-indigo-700"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-red-600","bg-transparent","hover:bg-red-50","rounded-md",3,"click"]],template:function(t,i){t&1&&(l(0,"div",0)(1,"h1",1),c(2),a(),l(3,"div",2)(4,"form",3),b("ngSubmit",function(){return i.onSubmit()}),l(5,"div",4)(6,"div",5)(7,"label",6),c(8,"\u6D3B\u52D5\u540D\u7A31*"),a(),x(9,"input",7),a(),l(10,"div")(11,"label",8),c(12,"\u65E5\u671F*"),a(),x(13,"input",9),a(),l(14,"div")(15,"label",10),c(16,"\u6642\u9593"),a(),x(17,"input",11),a(),l(18,"div")(19,"label",12),c(20,"\u985E\u578B*"),a(),x(21,"input",13),a(),l(22,"div")(23,"label",14),c(24,"\u4EBA\u6578*"),a(),x(25,"input",15),a(),l(26,"div",5)(27,"label",16),c(28,"\u4ECB\u7D39\u4EBA"),a(),x(29,"input",17),a(),l(30,"div")(31,"label",18),c(32,"\u9810\u8A08\u5831\u540D\u6536\u5165*"),a(),x(33,"input",19),a(),l(34,"div")(35,"label",20),c(36,"\u8A02\u91D1"),a(),x(37,"input",21),a(),l(38,"div")(39,"label",22),c(40,"\u5BE6\u969B\u7E3D\u6536\u5165*"),a(),x(41,"input",23),a(),l(42,"div")(43,"label",24),c(44,"\u72C0\u614B*"),a(),l(45,"select",25)(46,"option",26),c(47,"\u9032\u884C\u4E2D"),a(),l(48,"option",27),c(49,"\u5DF2\u53D6\u6D88"),a()()(),l(50,"div",5)(51,"label",28),c(52,"\u5099\u8A3B"),a(),x(53,"textarea",29),a()(),l(54,"div",30),A(55,SO,2,0,"button",31),x(56,"div",32),l(57,"button",33),b("click",function(){return i.onCancel()}),c(58," \u53D6\u6D88 "),a(),l(59,"button",34),c(60),a()()()()()),t&2&&(f(2),V(" ",i.isEditMode()?"\u7DE8\u8F2F\u6D3B\u52D5":"\u65B0\u589E\u6D3B\u52D5"," "),f(2),M("formGroup",i.eventForm),f(5),z("border-red-500",i.isInvalid("name")),f(4),z("border-red-500",i.isInvalid("date")),f(8),z("border-red-500",i.isInvalid("type")),f(4),z("border-red-500",i.isInvalid("attendees")),f(8),z("border-red-500",i.isInvalid("estimatedRevenue")),f(8),z("border-red-500",i.isInvalid("actualRevenue")),f(4),z("border-red-500",i.isInvalid("status")),f(10),N(i.isEditMode()?55:-1),f(5),V(" ",i.isEditMode()?"\u5132\u5B58\u8B8A\u66F4":"\u5132\u5B58\u6D3B\u52D5"," "))},dependencies:[re,Oe,$e,ke,Ve,Ce,Ft,Ae,me,Fe,Pe,Be],encapsulation:2,changeDetection:0});var Kl=$s;var DO=["dailyRevenueChart"],wO=(n,e)=>e.transactionDate;function TO(n,e){if(n&1&&(l(0,"option",8),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),V("",t,"\u5E74")}}function IO(n,e){if(n&1&&(l(0,"option",8),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),V("",t,"\u6708")}}function MO(n,e){if(n&1&&(l(0,"div",14),x(1,"ion-icon",16),l(2,"span"),c(3),a()()),n&2){let t=v();f(3),E(t.errorMessage())}}function AO(n,e){n&1&&(l(0,"div",15),x(1,"div",17),a())}function NO(n,e){if(n&1&&c(0),n&2){let t=v().$implicit,i=v(2);V(" ",i.formatCurrency(t.debitAmount)," ")}}function RO(n,e){if(n&1&&c(0),n&2){let t=v().$implicit,i=v(2);V(" ",i.formatCurrency(t.creditAmount)," ")}}function FO(n,e){n&1&&c(0," \u516C\u4F11\u65E5 ")}function PO(n,e){n&1&&c(0," 0 ")}function kO(n,e){if(n&1&&A(0,FO,1,0)(1,PO,1,0),n&2){let t=v().$implicit,i=v(2);N(i.isClosedDay(t.transactionDate,!1)?0:1)}}function VO(n,e){if(n&1&&(l(0,"tr",33)(1,"td",34),c(2),a(),l(3,"td",35),A(4,NO,1,1)(5,RO,1,1)(6,kO,2,1),a()()),n&2){let t=e.$implicit,i=v(2);f(2),E(i.formatDate(t.transactionDate)),f(2),N(t.debitAmount>0?4:t.creditAmount>0?5:6)}}function OO(n,e){n&1&&(l(0,"tr")(1,"td",36),c(2,"\u627E\u4E0D\u5230\u8A72\u6708\u4EFD\u7684\u92B7\u8CA8\u6536\u5165\u8CC7\u6599\u3002"),a()())}function LO(n,e){if(n&1&&(l(0,"div",18)(1,"div",19)(2,"p",20),c(3,"\u6708\u71DF\u6536\u76EE\u6A19"),a(),l(4,"p",21),c(5),a()(),l(6,"div",19)(7,"p",20),c(8,"\u6BCF\u65E5\u5E73\u5747\u76EE\u6A19"),a(),l(9,"p",21),c(10),a()(),l(11,"div",19)(12,"p",20),c(13,"\u76EE\u6A19\u5DEE\u984D"),a(),l(14,"p",22),c(15),a()(),l(16,"div",19)(17,"p",20),c(18,"\u672C\u6708\u7D2F\u8A08\u71DF\u6536"),a(),l(19,"p",21),c(20),a()(),l(21,"div",19)(22,"p",20),c(23,"\u6708\u71DF\u6536\u76EE\u6A19\u9054\u6210\u7387"),a(),l(24,"p",22),c(25),a()()(),l(26,"div",23)(27,"h3",24),c(28,"\u6BCF\u65E5\u71DF\u6536\u8DA8\u52E2"),a(),l(29,"div",25),x(30,"canvas",null,0),a()(),l(32,"div",23)(33,"h3",24),c(34,"\u7576\u65E5\u71DF\u6536\u660E\u7D30"),a(),l(35,"div",26),x(36,"ion-icon",27),c(37," \u9019\u500B\u8868\u683C\u986F\u793A\u6240\u9078\u64C7\u7684\u6708\u4EFD\u4E2D\uFF0C\u5F9E\u6D41\u6C34\u5E33\u6578\u64DA\u8868\u62C9\u53D6\u7684\u6240\u6709\u7B97\u7B26\u540D\u7A31\u70BA\u300C\u92B7\u8CA8\u6536\u5165\u300D\u7684\u4EA4\u6613\u7D00\u9304\uFF0C\u4E26\u4F9D\u7167\u4EA4\u6613\u6642\u9593\u5347\u5E8F\u6392\u5217\u3002 "),a(),l(38,"div",28)(39,"table",29)(40,"thead",30)(41,"tr")(42,"th",31),c(43,"\u4EA4\u6613\u65E5\u671F"),a(),l(44,"th",32),c(45,"\u91D1\u984D"),a()()(),l(46,"tbody"),O(47,VO,7,2,"tr",33,wO,!1,OO,3,0,"tr"),a()()()()),n&2){let t=v();f(5),E(t.formatCurrency(t.summary().monthlyRevenueTarget)),f(5),E(t.formatCurrency(t.summary().dailyAverageTarget)),f(4),z("text-red-600",t.summary().targetDeficit<0)("text-green-600",t.summary().targetDeficit>=0),f(),V(" ",t.formatCurrency(t.summary().targetDeficit)," "),f(5),E(t.formatCurrency(t.summary().cumulativeMonthlyRevenue)),f(4),z("text-green-600",t.summary().monthlyTargetAchievementRate>=100)("text-red-600",t.summary().monthlyTargetAchievementRate<100),f(),V(" ",t.summary().monthlyTargetAchievementRate.toFixed(2),"% "),f(22),L(t.ledgerDetails())}}var Hs=class Hs{constructor(){this.apiService=P(rt);this.router=P(Le);this.monthlyTargetData=S(null);this.monthlyRevenueTarget=28e4;this.availableYears=S([2024,2025,2026]);this.availableMonths=S(Array.from({length:12},(e,t)=>t+1));this.selectedYear=S(new Date().getFullYear());this.selectedMonth=S(new Date().getMonth()+1);this.monthlyData=S(null);this.ledgerDetails=S([]);this.isLoading=S(!1);this.errorMessage=S(null);this.reportData=H(()=>{let e=this.monthlyData();if(!e)return[];let i=this.monthlyTargetData()?.monthlyRevenueTarget||this.monthlyRevenueTarget,r=e.dailyReports.filter(s=>s.totalRevenue>0).length,o=r>0?i/r:0;return e.dailyReports.map(s=>({day:s.day,date:s.date,isDayOff:s.totalRevenue===0&&s.recordCount===0,totalDailyRevenue:s.totalRevenue,dailyAchievementRate:o>0?s.totalRevenue/o*100:0,cancelledInvoiceCount:s.cancelledInvoiceCount,shortAmount:s.shortAmount,recordCount:s.recordCount}))});this.dailyRevenueFromLedger=H(()=>{let e=this.ledgerDetails(),t=new Map;return console.log("\u6B63\u5728\u8A08\u7B97\u6BCF\u65E5\u71DF\u6536\uFF0C\u6D41\u6C34\u5E33\u7B46\u6578:",e.length),e.forEach((i,r)=>{let o=i.transactionDate;if(!o)return;if(!/^\d{4}-\d{2}-\d{2}$/.test(o)){let d=new Date(o);if(isNaN(d.getTime())){console.warn("\u7121\u6CD5\u89E3\u6790\u65E5\u671F:",i.transactionDate);return}else{let m=d.getFullYear(),h=String(d.getMonth()+1).padStart(2,"0"),y=String(d.getDate()).padStart(2,"0");o=`${m}-${h}-${y}`}}let s=Number(i.debitAmount)>0?Number(i.debitAmount):Number(i.creditAmount);r<5&&console.log(`\u6D41\u6C34\u5E33[${r}]`,{originalDate:i.transactionDate,normalizedDate:o,debitAmount:i.debitAmount,creditAmount:i.creditAmount,calculatedAmount:s});let u=t.get(o)||0;t.set(o,u+s)}),console.log("\u6BCF\u65E5\u71DF\u6536Map:",{size:t.size,sample:Array.from(t.entries()).slice(0,10),total:Array.from(t.values()).reduce((i,r)=>i+r,0)}),t});this.chartData=H(()=>{let e=this.dailyRevenueFromLedger(),t=this.selectedYear(),i=this.selectedMonth(),o=this.monthlyTargetData()?.monthlyRevenueTarget||this.monthlyRevenueTarget,s=new Date(t,i,0).getDate(),u=Array.from(e.values()).filter(h=>h>0).length,d=u>0?o/u:0;console.log("\u69CB\u5EFA\u5716\u8868\u6578\u64DA:",{year:t,month:i,lastDay:s,revenueMapSize:e.size,revenueMapEntries:Array.from(e.entries()).slice(0,10),workingDays:u,dailyAverageTarget:d});let m=[];for(let h=1;h<=s;h++){let y=`${t}-${String(i).padStart(2,"0")}-${String(h).padStart(2,"0")}`,_=e.get(y)||0;m.push({day:h,date:y,isDayOff:_===0,totalDailyRevenue:_,dailyAchievementRate:d>0?_/d*100:0,cancelledInvoiceCount:0,shortAmount:0,recordCount:_>0?1:0})}return console.log("\u5716\u8868\u6578\u64DA\u69CB\u5EFA\u5B8C\u6210:",{totalDays:m.length,daysWithRevenue:m.filter(h=>h.totalDailyRevenue>0).length,sampleData:m.slice(0,5)}),m});this.summary=H(()=>{let e=this.chartData(),t=this.monthlyTargetData(),i=this.ledgerDetails(),r=t?.monthlyRevenueTarget||this.monthlyRevenueTarget,o=t?.dailyAvgTarget||0,s=i.reduce((m,h)=>{let y=Number(h.debitAmount)>0?Number(h.debitAmount):Number(h.creditAmount);return m+y},0),u=s-r,d=r>0?s/r*100:0;return{monthlyRevenueTarget:r,dailyAverageTarget:o,targetDeficit:u,cumulativeMonthlyRevenue:s,monthlyTargetAchievementRate:d,totalCancelledInvoices:e.reduce((m,h)=>m+h.cancelledInvoiceCount,0),totalShortAmount:e.reduce((m,h)=>m+h.shortAmount,0)}});this.loadData()}set dailyRevenueChartRef(e){this.destroyChart(),e&&this.chartData().length>0&&this.createChart(e)}async loadData(){this.isLoading.set(!0),this.errorMessage.set(null);try{let e=this.selectedYear(),t=this.selectedMonth(),i=String(e),r=String(t).padStart(2,"0"),o=`${i}-${r}-01`,s=new Date(e,t,0).getDate(),u=`${i}-${r}-${String(s).padStart(2,"0")}`,[d,m,h]=await Promise.all([this.apiService.getMonthlyRevenue(e,t),this.apiService.getMonthlyTargets({startMonth:`${i}-${r}`,endMonth:`${i}-${r}`}),this.apiService.getLedgerEntries({startDate:o,endDate:u,subjectName:"\u92B7\u8CA8\u6536\u5165",sortBy:"entry_date",sortOrder:"asc"})]);if(this.monthlyData.set(d),m.success&&m.data&&m.data.length>0){let y=m.data[0];this.monthlyTargetData.set({targetId:y.targetId,targetMonth:y.targetMonth,monthlyRevenueTarget:y.monthlyRevenueTarget,eventRevenueTarget:y.eventRevenueTarget,totalTarget:y.totalTarget,dailyAvgTarget:y.dailyAvgTarget,remark:y.remark}),console.log("\u2713 \u6708\u5EA6\u71DF\u6536\u76EE\u6A19\u5DF2\u8F09\u5165:",y)}else console.warn("\u26A0 \u8A72\u6708\u4EFD\u672A\u8A2D\u5B9A\u71DF\u6536\u76EE\u6A19\uFF0C\u5C07\u4F7F\u7528\u7CFB\u7D71\u9810\u8A2D\u503C"),this.monthlyTargetData.set(null);console.log("\u6B63\u5728\u8F09\u5165\u6D41\u6C34\u5E33\u8CC7\u6599:",{startDate:o,endDate:u}),h.success&&h.data?this.ledgerDetails.set(h.data.map(y=>({transactionDate:y.entry_date||"",description:y.description||"",subjectName:y.subject_name||"",debitAmount:y.amount&&y.amount>0?y.amount:0,creditAmount:y.amount&&y.amount<0?Math.abs(y.amount):0,glAccountName:y.account_name||""}))):this.ledgerDetails.set([])}catch(e){console.error("\u8F09\u5165\u7576\u65E5\u71DF\u6536\u8CC7\u6599\u6642\u767C\u751F\u932F\u8AA4:",e);let t=e instanceof Error?e.message:"\u7121\u6CD5\u8F09\u5165\u71DF\u6536\u8CC7\u6599\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66";this.errorMessage.set(t)}finally{this.isLoading.set(!1)}}applyFilter(){this.loadData()}resetFilter(){this.selectedYear.set(new Date().getFullYear()),this.selectedMonth.set(new Date().getMonth()+1),this.loadData()}navigateToDetail(e){this.router.navigate(["/daily-revenue",e])}formatCurrency(e){return e==null?"":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}getWeekdayChar(e){return["\u65E5","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D"][e%7]}formatDate(e){if(!e)return"";let t;if(/^\d{4}-\d{2}-\d{2}$/.test(e)){let[u,d,m]=e.split("-").map(Number);t=new Date(u,d-1,m)}else t=new Date(e);if(isNaN(t.getTime()))return e;let i=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0"),s=this.getWeekdayChar(t.getDay());return`${i}-${r}-${o}(${s})`}isClosedDay(e,t){if(t||!e)return!1;let i;if(/^\d{4}-\d{2}-\d{2}$/.test(e)){let[r,o,s]=e.split("-").map(Number);i=new Date(r,o-1,s)}else i=new Date(e);return isNaN(i.getTime())?!1:i.getDay()===1}createChart(e){let t=this.chartData(),i=this.summary(),r=t.map(m=>m.day),o=t.map(m=>m.totalDailyRevenue),s=o.some(m=>m>0);console.log("\u6B63\u5728\u5EFA\u7ACB\u5716\u8868:",{dataCount:t.length,hasRevenueData:s,revenueDataSample:o.slice(0,10),daysWithRevenue:o.filter(m=>m>0).length});let u=[{label:"\u6BCF\u65E5\u71DF\u6536",data:o,borderColor:"#4f46e5",backgroundColor:"rgba(79, 70, 229, 0.1)",fill:!0,tension:.4,pointRadius:4,pointBackgroundColor:"#4f46e5"},{label:"\u6BCF\u65E5\u5E73\u5747\u76EE\u6A19",data:t.map(()=>i.dailyAverageTarget),borderColor:"#f97316",borderDash:[5,5],fill:!1,pointRadius:0,pointHitRadius:0}],d=e.nativeElement.getContext("2d");this.dailyChart=new Chart(d,{type:"line",data:{labels:r,datasets:u},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{callback:m=>this.formatCurrency(m)}},x:{title:{display:!0,text:"\u65E5\u671F"}}},plugins:{tooltip:{callbacks:{label:m=>`${m.dataset.label}: ${this.formatCurrency(m.raw)}`}}}}})}destroyChart(){this.dailyChart&&(this.dailyChart.destroy(),this.dailyChart=null)}};Hs.\u0275fac=function(t){return new(t||Hs)},Hs.\u0275cmp=ie({type:Hs,selectors:[["app-daily-revenue"]],viewQuery:function(t,i){if(t&1&&Sn(DO,5),t&2){let r;on(r=sn())&&(i.dailyRevenueChartRef=r.first)}},decls:24,vars:9,consts:[["dailyRevenueChart",""],[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"flex","flex-col","sm:flex-row","items-center","gap-2","bg-white","p-3","rounded-xl","shadow-md","border","border-gray-200"],[1,"flex","items-center","gap-2"],[1,"text-sm","font-medium","text-gray-600"],[1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100","pr-8",3,"ngModelChange","ngModel"],[3,"value"],[1,"flex","items-center","gap-2","mt-2","sm:mt-0"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm","disabled:opacity-50",3,"click","disabled"],[3,"name"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200","disabled:opacity-50",3,"click","disabled"],["name","refresh-outline",1,"text-xl"],[1,"bg-red-50","border","border-red-200","text-red-700","px-4","py-3","rounded-lg","flex","items-center","gap-2"],[1,"flex","justify-center","items-center","py-12"],["name","alert-circle-outline",1,"text-xl"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-indigo-600"],[1,"grid","grid-cols-2","md:grid-cols-3","lg:grid-cols-5","gap-6"],[1,"bg-white","p-4","rounded-xl","shadow-md","text-center"],[1,"text-sm","text-gray-500"],[1,"text-xl","font-semibold","text-gray-900","mt-1"],[1,"text-xl","font-semibold","mt-1"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"text-lg","font-semibold","text-gray-800","mb-4"],[1,"h-80"],[1,"text-sm","text-gray-600","mb-4"],["name","information-circle-outline",1,"align-middle"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-4","py-3"],[1,"px-4","py-3","text-right"],[1,"border-b","hover:bg-gray-50"],[1,"px-4","py-2","font-medium"],[1,"px-4","py-2","text-right"],["colspan","2",1,"text-center","py-8","text-gray-500"]],template:function(t,i){t&1&&(l(0,"div",1)(1,"div",2)(2,"h1",3),c(3,"\u7576\u65E5\u71DF\u6536"),a(),l(4,"div",4)(5,"div",5)(6,"label",6),c(7,"\u6642\u9593:"),a(),l(8,"select",7),Z("ngModelChange",function(o){return ee(i.selectedYear,o)||(i.selectedYear=o),o}),O(9,TO,2,2,"option",8,W),a(),l(11,"select",7),Z("ngModelChange",function(o){return ee(i.selectedMonth,o)||(i.selectedMonth=o),o}),O(12,IO,2,2,"option",8,W),a()(),l(14,"div",9)(15,"button",10),b("click",function(){return i.applyFilter()}),x(16,"ion-icon",11),l(17,"span"),c(18),a()(),l(19,"button",12),b("click",function(){return i.resetFilter()}),x(20,"ion-icon",13),a()()()(),A(21,MO,4,1,"div",14),A(22,AO,2,0,"div",15),A(23,LO,50,14),a()),t&2&&(f(8),Q("ngModel",i.selectedYear),f(),L(i.availableYears()),f(2),Q("ngModel",i.selectedMonth),f(),L(i.availableMonths()),f(3),M("disabled",i.isLoading()),f(),M("name",i.isLoading()?"hourglass-outline":"filter-outline"),f(2),E(i.isLoading()?"\u8F09\u5165\u4E2D...":"\u5957\u7528"),f(),M("disabled",i.isLoading()),f(2),N(i.errorMessage()?21:-1),f(),N(i.isLoading()?22:-1),f(),N(!i.isLoading()&&!i.errorMessage()?23:-1))},dependencies:[re,be,ke,Ve,Ae,me,Ie],encapsulation:2,changeDetection:0});var np=Hs;var BO=(n,e)=>e.id;function UO(n,e){if(n&1&&(l(0,"tr",24)(1,"td",28),c(2),a(),l(3,"td",29),c(4),a(),l(5,"td",30),c(6),a()()),n&2){let t=e.$implicit,i=v();f(2),E(t.name),f(2),E(t.organizer),f(2),E(i.formatCurrency(t.actualRevenue))}}function $O(n,e){n&1&&(l(0,"tr")(1,"td",31),c(2,"\u672C\u65E5\u7121\u6D3B\u52D5\u3002"),a()())}var Gs=class Gs{constructor(){this.fb=P(He);this.dataService=P(Tt);this.router=P(Le);this.route=P(un);this.date=S("");this.dailyEntry=S(null);this.eventsOnDay=S([]);this.submitted=S(!1);this.revenueForm=this.fb.group({nonEventRevenue:[0,[U.required,U.min(0)]]});this.totalEventRevenue=H(()=>this.eventsOnDay().reduce((e,t)=>e+t.actualRevenue,0));this.totalDailyRevenue=H(()=>(this.revenueForm.controls.nonEventRevenue.value??0)+this.totalEventRevenue());this.route.paramMap.pipe(he(e=>e.get("date")),Ze(e=>{if(!e||!/^\d{4}-\d{2}-\d{2}$/.test(e)){alert("\u7121\u6548\u7684\u65E5\u671F\u683C\u5F0F"),this.router.navigate(["/daily-revenue"]);return}this.date.set(e);let t=this.dataService.getDailyRevenueEntryByDate(e);this.dailyEntry.set(t),this.revenueForm.patchValue({nonEventRevenue:t.nonEventRevenue});let i=this.dataService.getEvents();this.eventsOnDay.set(i.filter(r=>r.date===e&&r.status==="active"))})).subscribe()}onSubmit(){if(this.submitted.set(!0),this.revenueForm.invalid){alert("\u8ACB\u8F38\u5165\u6709\u6548\u7684\u975E\u6D3B\u52D5\u71DF\u6536\u91D1\u984D\u3002");return}let e=this.revenueForm.controls.nonEventRevenue.value??0;this.dataService.updateDailyRevenueEntry(this.date(),{nonEventRevenue:e}),alert("\u7576\u65E5\u71DF\u6536\u5DF2\u66F4\u65B0\uFF01"),this.router.navigate(["/daily-revenue"])}onCancel(){this.router.navigate(["/daily-revenue"])}formatCurrency(e){return e==null?"":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}};Gs.\u0275fac=function(t){return new(t||Gs)},Gs.\u0275cmp=ie({type:Gs,selectors:[["app-daily-revenue-detail"]],decls:53,vars:7,consts:[[1,"space-y-6","max-w-4xl","mx-auto"],[1,"flex","items-center","gap-4"],[1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","arrow-back-outline",1,"text-2xl"],[1,"text-3xl","font-bold","text-gray-900"],[1,"text-indigo-600"],["novalidate","",3,"ngSubmit","formGroup"],[1,"bg-white","p-6","md:p-8","rounded-xl","shadow-md","space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],[1,"bg-gray-50","p-4","rounded-lg"],["for","nonEventRevenue",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","nonEventRevenue","formControlName","nonEventRevenue",1,"mt-2","block","w-full","border","bg-white","rounded-md","shadow-sm","p-2","text-lg","text-right","font-semibold"],[1,"text-xs","text-gray-500","mt-1"],[1,"bg-blue-50","p-4","rounded-lg"],[1,"text-sm","font-medium","text-gray-700"],[1,"mt-2","text-lg","text-right","font-semibold","text-blue-800"],[1,"bg-green-50","p-4","rounded-lg"],[1,"mt-2","text-lg","text-right","font-semibold","text-green-800"],[1,"text-lg","font-semibold","text-gray-800","mb-2"],[1,"border","rounded-lg","overflow-hidden"],[1,"w-full","text-sm","text-left"],[1,"bg-gray-100","text-xs","uppercase"],[1,"px-4","py-2"],[1,"px-4","py-2","text-right"],[1,"border-t"],[1,"flex","items-center","justify-end","gap-4","pt-4","border-t","mt-6"],["type","button",1,"px-4","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],["type","submit",1,"px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-indigo-600","hover:bg-indigo-700"],[1,"px-4","py-2","font-medium"],[1,"px-4","py-2","text-gray-600"],[1,"px-4","py-2","text-right","font-semibold"],["colspan","3",1,"px-4","py-4","text-center","text-gray-500"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"button",2),b("click",function(){return i.onCancel()}),x(3,"ion-icon",3),a(),l(4,"h1",4),c(5," \u7DE8\u8F2F\u7576\u65E5\u71DF\u6536 - "),l(6,"span",5),c(7),a()()(),l(8,"form",6),b("ngSubmit",function(){return i.onSubmit()}),l(9,"div",7)(10,"div",8)(11,"div",9)(12,"label",10),c(13,"\u975E\u6D3B\u52D5\u71DF\u6536*"),a(),x(14,"input",11),l(15,"p",12),c(16,"\u624B\u52D5\u8F38\u5165\u7576\u5929\u975E\u6D3B\u52D5\u76F8\u95DC\u7684\u71DF\u6536\u3002"),a()(),l(17,"div",13)(18,"p",14),c(19,"\u6D3B\u52D5\u7E3D\u71DF\u6536"),a(),l(20,"p",15),c(21),a(),l(22,"p",12),c(23,"\u4F86\u81EA\u4E0B\u65B9\u6D3B\u52D5\u5217\u8868\u7684\u52A0\u7E3D\u3002"),a()(),l(24,"div",16)(25,"p",14),c(26,"\u7576\u65E5\u7E3D\u71DF\u6536"),a(),l(27,"p",17),c(28),a(),l(29,"p",12),c(30,"\u975E\u6D3B\u52D5\u71DF\u6536 + \u6D3B\u52D5\u7E3D\u71DF\u6536\u3002"),a()()(),l(31,"div")(32,"h3",18),c(33,"\u672C\u65E5\u6D3B\u52D5"),a(),l(34,"div",19)(35,"table",20)(36,"thead",21)(37,"tr")(38,"th",22),c(39,"\u6D3B\u52D5\u540D\u7A31"),a(),l(40,"th",22),c(41,"\u4ECB\u7D39\u4EBA"),a(),l(42,"th",23),c(43,"\u5BE6\u969B\u6536\u5165"),a()()(),l(44,"tbody"),O(45,UO,7,3,"tr",24,BO,!1,$O,3,0,"tr"),a()()()(),l(48,"div",25)(49,"button",26),b("click",function(){return i.onCancel()}),c(50," \u53D6\u6D88 "),a(),l(51,"button",27),c(52," \u5132\u5B58\u8B8A\u66F4 "),a()()()()()),t&2){let r;f(7),E(i.date()),f(),M("formGroup",i.revenueForm),f(6),z("border-red-500",i.submitted()&&((r=i.revenueForm.get("nonEventRevenue"))==null?null:r.invalid)),f(7),E(i.formatCurrency(i.totalEventRevenue())),f(7),E(i.formatCurrency(i.totalDailyRevenue())),f(17),L(i.eventsOnDay())}},dependencies:[re,Oe,$e,Ce,Ft,me,Fe,Pe,Be],encapsulation:2,changeDetection:0});var ip=Gs;var $b=()=>[2024,2025,2026,2027],HO=()=>[1,2,3,4,5,6,7,8,9,10,11,12],GO=(n,e)=>e.user_id+"-"+e.year_month,Xy=(n,e)=>e.id;function qO(n,e){if(n&1&&(l(0,"option",20),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),V("",t,"\u5E74")}}function WO(n,e){if(n&1){let t=B();l(0,"div",10)(1,"label",18),c(2,"\u5E74\u4EFD:"),a(),l(3,"select",19),Z("ngModelChange",function(r){w(t);let o=v();return ee(o.selectedYear,r)||(o.selectedYear=r),T(r)}),b("change",function(){w(t);let r=v();return T(r.onMonthChange())}),O(4,qO,2,2,"option",20,W),a()()}if(n&2){let t=v();f(3),Q("ngModel",t.selectedYear),f(),L(Vt(1,$b))}}function jO(n,e){if(n&1&&(l(0,"option",20),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),V("",t,"\u5E74")}}function zO(n,e){if(n&1&&(l(0,"option",20),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),V("",t,"\u6708")}}function YO(n,e){if(n&1){let t=B();l(0,"div",10)(1,"label",18),c(2,"\u6708\u4EFD:"),a(),l(3,"select",19),Z("ngModelChange",function(r){w(t);let o=v();return ee(o.selectedYear,r)||(o.selectedYear=r),T(r)}),b("change",function(){w(t);let r=v();return T(r.onMonthChange())}),O(4,jO,2,2,"option",20,W),a(),l(6,"select",19),Z("ngModelChange",function(r){w(t);let o=v();return ee(o.selectedMonth,r)||(o.selectedMonth=r),T(r)}),b("change",function(){w(t);let r=v();return T(r.onMonthChange())}),O(7,zO,2,2,"option",20,W),a()()}if(n&2){let t=v();f(3),Q("ngModel",t.selectedYear),f(),L(Vt(2,$b)),f(2),Q("ngModel",t.selectedMonth),f(),L(Vt(3,HO))}}function JO(n,e){if(n&1&&(l(0,"div",21)(1,"div",27)(2,"p",28),c(3,"\u7B46\u6578"),a(),l(4,"p",29),c(5),a()(),l(6,"div",27)(7,"p",28),c(8,"\u7E3D\u85AA\u8CC7"),a(),l(9,"p",30),c(10),a()(),l(11,"div",27)(12,"p",28),c(13,"\u5DF2\u6838\u5C0D"),a(),l(14,"p",31),c(15),a()(),l(16,"div",27)(17,"p",28),c(18,"\u5DF2\u767C\u653E"),a(),l(19,"p",32),c(20),a()()()),n&2){let t=v(2);f(5),E(t.dailyStats().totalRecords),f(5),E(t.formatCurrency(t.dailyStats().totalWages)),f(5),E(t.dailyStats().verifiedCount),f(5),E(t.dailyStats().paidCount)}}function KO(n,e){if(n&1&&(l(0,"div",22)(1,"p",33),c(2),a()()),n&2){let t=v(2);f(2),E(t.dailyError())}}function QO(n,e){n&1&&(l(0,"div",23)(1,"p",34),c(2,"\u8F09\u5165\u4E2D..."),a()())}function ZO(n,e){if(n&1&&(l(0,"span",49),c(1),a()),n&2){let t=v().$implicit;f(),V("\u7F3A\u5361",t.missing_records,"\u7B46")}}function XO(n,e){n&1&&(l(0,"span",50),c(1,"\u5DF2\u6838\u5C0D"),a())}function eL(n,e){n&1&&(l(0,"span",34),c(1,"\u672A\u6838\u5C0D"),a())}function tL(n,e){n&1&&(l(0,"span",50),c(1,"\u5DF2\u767C\u653E"),a())}function nL(n,e){n&1&&(l(0,"span",34),c(1,"\u672A\u767C\u653E"),a())}function iL(n,e){n&1&&(l(0,"span"),c(1,"\u7522\u751F\u4E2D..."),a())}function rL(n,e){n&1&&(l(0,"span"),c(1,"\u4E0B\u8F09"),a())}function oL(n,e){if(n&1){let t=B();l(0,"tr",43),b("click",function(){let r=w(t).$implicit,o=v(3);return T(o.openMonthlyDetails(r))}),l(1,"td",44),c(2),a(),l(3,"td",45),c(4),a(),l(5,"td",46),c(6),a(),l(7,"td",47),c(8),a(),l(9,"td",48),A(10,ZO,2,1,"span",49),a(),l(11,"td",48),A(12,XO,2,0,"span",50)(13,eL,2,0,"span",34),a(),l(14,"td",48),A(15,tL,2,0,"span",50)(16,nL,2,0,"span",34),a(),l(17,"td",48)(18,"button",51),b("click",function(r){let o=w(t).$implicit,s=v(3);return T(s.downloadLaborReport(o,r))}),A(19,iL,2,0,"span")(20,rL,2,0,"span"),a()()()}if(n&2){let t=e.$implicit,i=v(3);f(2),E(t.year_month),f(2),E(t.display_name),f(2),V("",t.total_work_hours.toFixed(2)," h"),f(2),E(i.formatCurrency(t.total_wage)),f(2),N(t.missing_records>0?10:-1),f(2),N(t.is_fully_verified?12:13),f(3),N(t.is_fully_paid?15:16),f(3),M("disabled",i.downloadingReports().has(t.user_id+"-"+t.year_month)),f(),N(i.downloadingReports().has(t.user_id+"-"+t.year_month)?19:20)}}function sL(n,e){if(n&1&&(l(0,"div",24)(1,"div",35)(2,"table",36)(3,"thead",37)(4,"tr")(5,"th",38),c(6,"\u5DE5\u4F5C\u6708\u4EFD"),a(),l(7,"th",38),c(8,"\u54E1\u5DE5"),a(),l(9,"th",39),c(10,"\u7E3D\u5DE5\u6642"),a(),l(11,"th",39),c(12,"\u7E3D\u85AA\u8CC7"),a(),l(13,"th",40),c(14,"\u7F3A\u5361"),a(),l(15,"th",40),c(16,"\u6838\u5C0D"),a(),l(17,"th",40),c(18,"\u767C\u653E"),a(),l(19,"th",40),c(20,"\u52DE\u5831\u55AE"),a()()(),l(21,"tbody",41),O(22,oL,21,9,"tr",42,GO),a()()()()),n&2){let t=v(2);f(22),L(t.monthlySummaries())}}function aL(n,e){if(n&1&&(l(0,"div",25)(1,"p",52),c(2),a()()),n&2){let t=v(2);f(2),V("",t.getMonthLabel()," \u6C92\u6709\u85AA\u8CC7\u8A18\u9304")}}function lL(n,e){if(n&1&&(l(0,"span",71),c(1),a()),n&2){let t=v().$implicit;f(),V(" ",t.multiplier,"x ")}}function uL(n,e){n&1&&(l(0,"span",72),c(1,"-"),a())}function dL(n,e){n&1&&(l(0,"span",73),x(1,"ion-icon",78),c(2," \u5DF2\u6838\u5C0D "),a())}function cL(n,e){n&1&&(l(0,"span",74),c(1," \u672A\u6838\u5C0D "),a())}function mL(n,e){n&1&&(l(0,"span",75),x(1,"ion-icon",79),c(2," \u5DF2\u767C\u653E "),a())}function pL(n,e){n&1&&(l(0,"span",74),c(1," \u672A\u767C\u653E "),a())}function fL(n,e){if(n&1){let t=B();l(0,"tr",68)(1,"td",48)(2,"input",69),b("change",function(r){let o=w(t).$implicit,s=v(3);return T(s.toggleRowSelection(o.id,r))}),a()(),l(3,"td",44),c(4),a(),l(5,"td",44)(6,"input",70),Z("ngModelChange",function(r){let o=w(t).$implicit;return ee(o.clock_in_time_input,r)||(o.clock_in_time_input=r),T(r)}),b("change",function(){let r=w(t).$implicit,o=v(3);return T(o.updateMonthlyDetailDisplay(r))}),a()(),l(7,"td",44)(8,"input",70),Z("ngModelChange",function(r){let o=w(t).$implicit;return ee(o.clock_out_time_input,r)||(o.clock_out_time_input=r),T(r)}),b("change",function(){let r=w(t).$implicit,o=v(3);return T(o.updateMonthlyDetailDisplay(r))}),a()(),l(9,"td",46),c(10),a(),l(11,"td",46),c(12),a(),l(13,"td",48),A(14,lL,2,1,"span",71)(15,uL,2,0,"span",72),a(),l(16,"td",48),A(17,dL,3,0,"span",73)(18,cL,2,0,"span",74),a(),l(19,"td",48),A(20,mL,3,0,"span",75)(21,pL,2,0,"span",74),a(),l(22,"td",48)(23,"button",76),b("click",function(){let r=w(t).$implicit,o=v(3);return T(o.saveMonthlyDetail(r))}),x(24,"ion-icon",77),a()()()}if(n&2){let t=e.$implicit,i=v(3);z("bg-green-50",t.is_paid)("opacity-60",t.is_paid),f(2),M("checked",i.isRowSelected(t.id))("disabled",t.is_paid),f(2),E(i.formatDateYMD(t.work_date)),f(2),Q("ngModel",t.clock_in_time_input),M("disabled",t.is_paid),f(2),Q("ngModel",t.clock_out_time_input),M("disabled",t.is_paid),f(2),E(t.work_hours.toFixed(2)),f(2),E(i.formatCurrency(t.total_wage)),f(2),N(t.multiplier&&t.multiplier!==1?14:15),f(3),N(t.is_verified?17:18),f(3),N(t.is_paid?20:21),f(3),M("disabled",t.is_paid)}}function gL(n,e){if(n&1){let t=B();l(0,"div",26)(1,"div",53)(2,"div",54)(3,"h2",55),c(4),a(),l(5,"button",56),b("click",function(){w(t);let r=v(2);return T(r.closeMonthlyDetails())}),x(6,"ion-icon",57),a()(),l(7,"div",58)(8,"div",59)(9,"div",60),c(10),a(),l(11,"div",61)(12,"button",62),b("click",function(){w(t);let r=v(2);return T(r.batchVerifyRecords())}),x(13,"ion-icon",63),c(14," \u6279\u91CF\u6838\u5C0D "),a(),l(15,"button",64),b("click",function(){w(t);let r=v(2);return T(r.batchReleaseRecords())}),x(16,"ion-icon",65),c(17," \u6279\u91CF\u767C\u653E "),a()()(),l(18,"div",35)(19,"table",36)(20,"thead",37)(21,"tr")(22,"th",48)(23,"input",66),b("change",function(r){w(t);let o=v(2);return T(o.toggleSelectAll(r))}),a()(),l(24,"th",38),c(25,"\u5DE5\u4F5C\u65E5\u671F"),a(),l(26,"th",38),c(27,"\u4E0A\u73ED\u6253\u5361\u6642\u9593"),a(),l(28,"th",38),c(29,"\u4E0B\u73ED\u6253\u5361\u6642\u9593"),a(),l(30,"th",39),c(31,"\u5DE5\u4F5C\u6642\u6578"),a(),l(32,"th",39),c(33,"\u85AA\u8CC7\u91D1\u984D"),a(),l(34,"th",40),c(35,"\u500D\u6578"),a(),l(36,"th",40),c(37,"\u6838\u5C0D"),a(),l(38,"th",40),c(39,"\u767C\u653E"),a(),l(40,"th",40),c(41,"\u64CD\u4F5C"),a()()(),l(42,"tbody",41),O(43,fL,25,17,"tr",67,Xy),a()()()()()()}if(n&2){let t=v(2);f(4),E(t.monthlyDetailsTitle()),f(6),V(" \u5DF2\u9078\u64C7 ",t.selectedRows().length," \u7B46\u8A18\u9304 "),f(2),M("disabled",t.selectedRows().length===0),f(3),M("disabled",t.selectedRows().length===0),f(28),L(t.monthlyDetailsRows())}}function hL(n,e){if(n&1&&(l(0,"div",5),A(1,JO,21,4,"div",21),A(2,KO,3,1,"div",22),A(3,QO,3,0,"div",23),A(4,sL,24,0,"div",24),A(5,aL,3,1,"div",25),A(6,gL,45,4,"div",26),a()),n&2){let t=v();f(),N(!t.dailyLoading()&&t.dailySummaries().length>0?1:-1),f(),N(t.dailyError()?2:-1),f(),N(t.dailyLoading()?3:-1),f(),N(!t.dailyLoading()&&t.monthlySummaries().length>0?4:-1),f(),N(!t.dailyLoading()&&t.monthlySummaries().length===0?5:-1),f(),N(t.monthlyDetailsVisible()?6:-1)}}function yL(n,e){if(n&1&&(l(0,"div",22)(1,"p",33),c(2),a()()),n&2){let t=v(2);f(2),E(t.wagesError())}}function _L(n,e){n&1&&(l(0,"div",23)(1,"p",34),c(2,"\u8F09\u5165\u4E2D..."),a()())}function vL(n,e){n&1&&(l(0,"span",83),c(1," \u555F\u7528 "),a())}function CL(n,e){n&1&&(l(0,"span",84),c(1," \u505C\u7528 "),a())}function xL(n,e){if(n&1){let t=B();l(0,"tr",68)(1,"td",44),c(2),a(),l(3,"td",45),c(4),a(),l(5,"td",46),c(6),a(),l(7,"td",44),c(8),a(),l(9,"td",44),c(10),a(),l(11,"td",44),c(12),a(),l(13,"td",48),A(14,vL,2,0,"span",83)(15,CL,2,0,"span",84),a(),l(16,"td",48)(17,"button",85),b("click",function(){let r=w(t).$implicit,o=v(3);return T(o.openWageForm(r))}),x(18,"ion-icon",86),a(),l(19,"button",87),b("click",function(){let r=w(t).$implicit,o=v(3);return T(o.deleteWageRecord(r))}),x(20,"ion-icon",88),a()()()}if(n&2){let t=e.$implicit,i=v(3);f(2),E(t.user_id),f(2),E(t.display_name),f(2),ut("",i.formatCurrency(t.hourly_rate),"",t.wage_type==="hourly"?"/\u5C0F\u6642":"/\u6708"),f(2),E(t.wage_type==="hourly"?"\u8A08\u6642":"\u6708\u85AA"),f(2),E(i.formatDate(t.effective_from)),f(2),E(t.effective_to?i.formatDate(t.effective_to):"-"),f(2),N(t.is_active?14:15)}}function EL(n,e){if(n&1&&(l(0,"div",24)(1,"div",35)(2,"table",36)(3,"thead",37)(4,"tr")(5,"th",38),c(6,"\u54E1\u5DE5 ID"),a(),l(7,"th",38),c(8,"\u54E1\u5DE5\u540D\u7A31"),a(),l(9,"th",39),c(10,"\u85AA\u8CC7"),a(),l(11,"th",38),c(12,"\u985E\u578B"),a(),l(13,"th",38),c(14,"\u751F\u6548\u65E5\u671F"),a(),l(15,"th",38),c(16,"\u622A\u6B62\u65E5\u671F"),a(),l(17,"th",40),c(18,"\u72C0\u614B"),a(),l(19,"th",40),c(20,"\u64CD\u4F5C"),a()()(),l(21,"tbody",41),O(22,xL,21,8,"tr",68,Xy),a()()()()),n&2){let t=v(2);f(22),L(t.employeeWages())}}function bL(n,e){if(n&1){let t=B();l(0,"div",25)(1,"p",52),c(2,"\u6C92\u6709\u54E1\u5DE5\u85AA\u8CC7\u8A2D\u5B9A"),a(),l(3,"button",89),b("click",function(){w(t);let r=v(2);return T(r.openWageForm())}),c(4," \u65B0\u589E\u85AA\u8CC7\u8A2D\u5B9A "),a()()}}function SL(n,e){if(n&1){let t=B();l(0,"div",26)(1,"div",90)(2,"div",91)(3,"h2",55),c(4),a(),l(5,"button",56),b("click",function(){w(t);let r=v(2);return T(r.closeWageForm())}),x(6,"ion-icon",57),a()(),l(7,"form",92)(8,"div",93)(9,"div")(10,"label",94),c(11,"\u54E1\u5DE5 ID *"),a(),x(12,"input",95),a(),l(13,"div")(14,"label",94),c(15,"\u54E1\u5DE5\u540D\u7A31"),a(),x(16,"input",96),a()(),l(17,"div",93)(18,"div")(19,"label",94),c(20,"\u85AA\u8CC7 *"),a(),x(21,"input",97),a(),l(22,"div")(23,"label",94),c(24,"\u85AA\u8CC7\u985E\u578B"),a(),l(25,"select",98)(26,"option",99),c(27,"\u8A08\u6642"),a(),l(28,"option",100),c(29,"\u6708\u85AA"),a()()()(),l(30,"div",93)(31,"div")(32,"label",94),c(33,"\u751F\u6548\u65E5\u671F *"),a(),x(34,"input",101),a(),l(35,"div")(36,"label",94),c(37,"\u622A\u6B62\u65E5\u671F"),a(),x(38,"input",102),a()(),l(39,"div")(40,"label",94),c(41,"\u5099\u8A3B"),a(),x(42,"textarea",103),a(),l(43,"div",104)(44,"button",105),b("click",function(){w(t);let r=v(2);return T(r.closeWageForm())}),c(45," \u53D6\u6D88 "),a(),l(46,"button",106),b("click",function(){w(t);let r=v(2);return T(r.saveWageRecord())}),c(47," \u4FDD\u5B58 "),a()()()()()}if(n&2){let t=v(2);f(4),E(t.editingWage()?"\u7DE8\u8F2F\u85AA\u8CC7\u8A2D\u5B9A":"\u65B0\u589E\u85AA\u8CC7\u8A2D\u5B9A"),f(3),M("formGroup",t.wageForm),f(5),z("bg-gray-100",!!t.editingWage())("cursor-not-allowed",!!t.editingWage()),M("readonly",!!t.editingWage())}}function DL(n,e){if(n&1){let t=B();l(0,"div",5),A(1,yL,3,1,"div",22),l(2,"div",80)(3,"button",81),b("click",function(){w(t);let r=v();return T(r.openWageForm())}),x(4,"ion-icon",82),c(5," \u65B0\u589E\u85AA\u8CC7\u8A2D\u5B9A "),a()(),A(6,_L,3,0,"div",23),A(7,EL,24,0,"div",24),A(8,bL,5,0,"div",25),A(9,SL,48,7,"div",26),a()}if(n&2){let t=v();f(),N(t.wagesError()?1:-1),f(5),N(t.wagesLoading()?6:-1),f(),N(!t.wagesLoading()&&t.employeeWages().length>0?7:-1),f(),N(!t.wagesLoading()&&t.employeeWages().length===0?8:-1),f(),N(t.wagesFormVisible()?9:-1)}}function wL(n,e){n&1&&(l(0,"div",23)(1,"p",34),c(2,"\u8F09\u5165\u4E2D..."),a()())}function TL(n,e){if(n&1&&(l(0,"div",110),c(1),a()),n&2){let t=v(2);f(),V(" ",t.specialError()," ")}}function IL(n,e){n&1&&(l(0,"tr")(1,"td",118),c(2," \u76EE\u524D\u6C92\u6709\u7279\u6B8A\u5DE5\u4F5C\u65E5\u8A2D\u5B9A "),a()())}function ML(n,e){n&1&&(l(0,"span",83),c(1," \u555F\u7528 "),a())}function AL(n,e){n&1&&(l(0,"span",84),c(1," \u505C\u7528 "),a())}function NL(n,e){if(n&1){let t=B();l(0,"tr",117)(1,"td",119),c(2),a(),l(3,"td",120),c(4),a(),l(5,"td",121)(6,"span",122),c(7),a()(),l(8,"td",121),A(9,ML,2,0,"span",83)(10,AL,2,0,"span",84),a(),l(11,"td",123),c(12),a(),l(13,"td",124)(14,"button",125),b("click",function(){let r=w(t).$implicit,o=v(3);return T(o.openSpecialForm(r))}),x(15,"ion-icon",126),a(),l(16,"button",127),b("click",function(){let r=w(t).$implicit,o=v(3);return T(o.deleteSpecialDate(r.id))}),x(17,"ion-icon",128),a()()()}if(n&2){let t=e.$implicit,i=v(3);f(2),V(" ",i.formatDateYMD(t.date)," "),f(2),V(" ",t.name," "),f(3),V(" ",t.multiplier,"x "),f(2),N(t.is_active?9:10),f(3),V(" ",t.notes||"-"," ")}}function RL(n,e){if(n&1&&(l(0,"div",111)(1,"table",112)(2,"thead",113)(3,"tr")(4,"th",114),c(5,"\u65E5\u671F"),a(),l(6,"th",114),c(7,"\u540D\u7A31"),a(),l(8,"th",115),c(9,"\u85AA\u8CC7\u500D\u6578"),a(),l(10,"th",115),c(11,"\u72C0\u614B"),a(),l(12,"th",114),c(13,"\u5099\u8A3B"),a(),l(14,"th",115),c(15,"\u64CD\u4F5C"),a()()(),l(16,"tbody",116),A(17,IL,3,0,"tr"),O(18,NL,18,5,"tr",117,Xy),a()()()),n&2){let t=v(2);f(17),N(t.specialDates().length===0?17:-1),f(),L(t.specialDates())}}function FL(n,e){if(n&1){let t=B();l(0,"div",26)(1,"div",129)(2,"div",58)(3,"h3",130),c(4),a(),l(5,"div",131)(6,"div")(7,"label",94),c(8,"\u65E5\u671F *"),a(),x(9,"input",132,0),a(),l(11,"div")(12,"label",94),c(13,"\u540D\u7A31 *"),a(),x(14,"input",133,1),a(),l(16,"div")(17,"label",94),c(18,"\u85AA\u8CC7\u500D\u6578 *"),a(),x(19,"input",134,2),a(),l(21,"div")(22,"label",135),x(23,"input",136,3),l(25,"span",137),c(26,"\u555F\u7528"),a()()(),l(27,"div")(28,"label",94),c(29,"\u5099\u8A3B"),a(),x(30,"textarea",138,4),a()(),l(32,"div",139)(33,"button",105),b("click",function(){w(t);let r=v(2);return T(r.closeSpecialForm())}),c(34," \u53D6\u6D88 "),a(),l(35,"button",106),b("click",function(){w(t);let r=Dn(10),o=Dn(15),s=Dn(20),u=Dn(24),d=Dn(31),m=v(2);return T(m.saveSpecialDate({date:r.value,name:o.value,multiplier:+s.value,is_active:u.checked,notes:d.value||null}))}),c(36," \u4FDD\u5B58 "),a()()()()()}if(n&2){let t,i,r,o,s,u=v(2);f(4),V(" ",u.editingSpecial()?"\u7DE8\u8F2F\u7279\u6B8A\u5DE5\u4F5C\u65E5":"\u65B0\u589E\u7279\u6B8A\u5DE5\u4F5C\u65E5"," "),f(5),M("value",((t=u.editingSpecial())==null?null:t.date)||""),f(5),M("value",((i=u.editingSpecial())==null?null:i.name)||""),f(5),M("value",((r=u.editingSpecial())==null?null:r.multiplier)||2),f(4),M("checked",((o=u.editingSpecial())==null?null:o.is_active)??!0),f(7),M("value",((s=u.editingSpecial())==null?null:s.notes)||"")}}function PL(n,e){if(n&1){let t=B();l(0,"div",5)(1,"div",107)(2,"h2",108),c(3,"\u7279\u6B8A\u5DE5\u4F5C\u65E5\u8A2D\u5B9A"),a(),l(4,"button",109),b("click",function(){w(t);let r=v();return T(r.openSpecialForm())}),x(5,"ion-icon",82),c(6," \u65B0\u589E\u7279\u6B8A\u5DE5\u4F5C\u65E5 "),a()(),A(7,wL,3,0,"div",23),A(8,TL,2,1,"div",110),A(9,RL,20,1,"div",111),A(10,FL,37,6,"div",26),a()}if(n&2){let t=v();f(7),N(t.specialLoading()?7:-1),f(),N(t.specialError()?8:-1),f(),N(!t.specialLoading()&&!t.specialError()?9:-1),f(),N(t.specialFormVisible()?10:-1)}}var qs=class qs{constructor(){this.apiService=P(rt);this.router=P(Le);this.fb=P(He);this.activeTab=S("daily");this.currentDate=new Date;this.previousMonth=this.getPreviousMonth();this.selectedYear=S(this.previousMonth.year);this.selectedMonth=S(this.previousMonth.month);this.dailySummaries=S([]);this.dailyLoading=S(!1);this.dailyError=S("");this.monthlySummaries=H(()=>{let e=this.dailySummaries(),t=new Map;return e.forEach(i=>{let r=new Date(i.work_date),o=r.getFullYear(),s=String(r.getMonth()+1).padStart(2,"0"),u=`${o}-${s}`,d=`${i.user_id}-${u}`,m=t.get(d)||{user_id:i.user_id,display_name:i.display_name,year_month:u,total_work_hours:0,total_wage:0,total_days:0,missing_records:0,is_fully_verified:!0,is_fully_paid:!0};m.total_work_hours+=this.toNumber(i.work_hours),m.total_wage+=this.toNumber(i.total_wage),m.total_days+=1,(!i.clock_in_time||!i.clock_out_time)&&(m.missing_records+=1),i.is_verified||(m.is_fully_verified=!1),i.is_paid||(m.is_fully_paid=!1),t.set(d,m)}),Array.from(t.values()).sort((i,r)=>i.year_month===r.year_month?i.user_id-r.user_id:i.year_month.localeCompare(r.year_month))});this.monthlyDetailsVisible=S(!1);this.monthlyDetailsRows=S([]);this.monthlyDetailsTitle=S("");this.selectedRows=S([]);this.dailyFormVisible=S(!1);this.editingDaily=S(null);this.employeeWages=S([]);this.wagesLoading=S(!1);this.wagesError=S("");this.specialDates=S([]);this.specialLoading=S(!1);this.specialError=S("");this.specialFormVisible=S(!1);this.editingSpecial=S(null);this.downloadingReports=S(new Set);this.wagesFormVisible=S(!1);this.editingWage=S(null);this.dailyStats=H(()=>{let e=this.dailySummaries();return{totalRecords:e.length,totalWages:e.reduce((t,i)=>t+(Number(i.total_wage)||0),0),verifiedCount:e.filter(t=>t.is_verified).length,paidCount:e.filter(t=>t.is_paid).length,specialDayCount:e.filter(t=>t.is_special_day).length}});this.dailyForm=this.fb.group({user_id:["",U.required],display_name:["",U.required],work_date:["",U.required],clock_in_time:[""],clock_out_time:[""],work_hours:[""],regular_hours:[""],overtime_hours:[""],base_wage:["",U.required],multiplier:[1],regular_wage:[""],overtime_wage:[""],special_bonus:[0],total_wage:["",U.required],is_special_day:[!1],notes:[""]}),this.wageForm=this.fb.group({user_id:["",U.required],display_name:[""],hourly_rate:["",U.required],wage_type:["hourly"],effective_from:["",U.required],effective_to:[""],notes:[""]}),Ci(()=>{let e=this.activeTab();e==="daily"?this.loadDailySummaries():e==="wages"?this.loadEmployeeWages():e==="special"&&this.loadSpecialDates()})}async loadSpecialDates(){this.specialLoading.set(!0),this.specialError.set("");try{let e=await this.apiService.getSpecialDates({year:this.selectedYear()});if(e.success&&e.data){let t=e.data.sort((i,r)=>new Date(i.date).getTime()-new Date(r.date).getTime());this.specialDates.set(t)}else this.specialError.set(e.error||"\u8F09\u5165\u7279\u6B8A\u5DE5\u4F5C\u65E5\u5931\u6557")}catch(e){this.specialError.set(e?.message||"\u8F09\u5165\u5931\u6557"),console.error("Error loading special dates:",e)}finally{this.specialLoading.set(!1)}}async saveSpecialDate(e){try{let t=this.editingSpecial(),i;t?i=await this.apiService.updateSpecialDate(t.id,e):i=await this.apiService.createSpecialDate(e),i.success?(alert(t?"\u66F4\u65B0\u6210\u529F":"\u65B0\u589E\u6210\u529F"),this.specialFormVisible.set(!1),this.loadSpecialDates()):alert("\u64CD\u4F5C\u5931\u6557: "+(i.error||"\u672A\u77E5\u932F\u8AA4"))}catch(t){alert("\u64CD\u4F5C\u5931\u6557: "+t?.message)}}async deleteSpecialDate(e){if(confirm("\u78BA\u5B9A\u8981\u522A\u9664\u6B64\u7279\u6B8A\u5DE5\u4F5C\u65E5\u8A2D\u5B9A\u55CE\uFF1F"))try{let t=await this.apiService.deleteSpecialDate(e);t.success?(alert("\u522A\u9664\u6210\u529F"),this.loadSpecialDates()):alert("\u522A\u9664\u5931\u6557: "+(t.error||"\u672A\u77E5\u932F\u8AA4"))}catch(t){alert("\u522A\u9664\u5931\u6557: "+t?.message)}}openSpecialForm(e){if(e){let t=q(k({},e),{date:this.formatDateYMD(e.date)});this.editingSpecial.set(t)}else this.editingSpecial.set(null);this.specialFormVisible.set(!0)}closeSpecialForm(){this.specialFormVisible.set(!1),this.editingSpecial.set(null)}async downloadLaborReport(e,t){t.stopPropagation();let i=`${e.user_id}-${e.year_month}`;if(this.downloadingReports().has(i))return;let r=new Set(this.downloadingReports());r.add(i),this.downloadingReports.set(r);try{let o=await this.apiService.downloadLaborReport(e.user_id,e.year_month),[s,u]=e.year_month.split("-"),d=new Date(parseInt(s),parseInt(u),0).getDate(),m=u+String(d).padStart(2,"0"),h=Math.round(e.total_wage),y=`${e.display_name}${m}S${h}.docx`,_=window.URL.createObjectURL(o),C=document.createElement("a");C.href=_,C.download=y,document.body.appendChild(C),C.click(),document.body.removeChild(C),window.URL.revokeObjectURL(_)}catch(o){alert("\u4E0B\u8F09\u52DE\u5831\u55AE\u5931\u6557: "+(o?.message||"\u672A\u77E5\u932F\u8AA4")),console.error("Error downloading labor report:",o)}finally{let o=new Set(this.downloadingReports());o.delete(i),this.downloadingReports.set(o)}}toNumber(e){if(e==null||e==="")return 0;let t=Number(e);return Number.isFinite(t)?t:0}toDateInput(e){if(!e)return"";let t=new Date(e);if(Number.isNaN(t.getTime()))return typeof e=="string"&&e.includes("T")?e.split("T")[0]:typeof e=="string"?e:"";let i=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0");return`${i}-${r}-${o}`}toTimeInput(e){if(!e)return"";let t=new Date(e);if(!Number.isNaN(t.getTime())){let i=String(t.getHours()).padStart(2,"0"),r=String(t.getMinutes()).padStart(2,"0");return`${i}:${r}`}return typeof e=="string"?e.includes("T")?(e.split("T")[1]||"").slice(0,5):e.slice(0,5):""}combineDateTime(e,t){if(!t)return null;let i=this.toDateInput(e),r=new Date(`${i}T${t}:00`);if(isNaN(r.getTime()))return null;let o=r.getFullYear(),s=String(r.getMonth()+1).padStart(2,"0"),u=String(r.getDate()).padStart(2,"0"),d=String(r.getHours()).padStart(2,"0"),m=String(r.getMinutes()).padStart(2,"0"),h=String(r.getSeconds()).padStart(2,"0"),y=-r.getTimezoneOffset(),_=String(Math.floor(Math.abs(y)/60)).padStart(2,"0"),C=String(Math.abs(y)%60).padStart(2,"0"),D=y>=0?"+":"-";return`${o}-${s}-${u}T${d}:${m}:${h}${D}${_}:${C}`}calculateWorkHours(e,t){if(!e||!t)return 0;try{let i=new Date(e),r=new Date(t);if(isNaN(i.getTime())){let u=e.replace(/ /g,"T").split("+")[0];i=new Date(u)}if(isNaN(r.getTime())){let u=t.replace(/ /g,"T").split("+")[0];r=new Date(u)}if(isNaN(i.getTime())||isNaN(r.getTime()))return 0;let o=r.getTime()-i.getTime();return o<0?0:Math.round(o/(1e3*60*60)*100)/100}catch{return 0}}calculateWage(e,t){if(e<=8)return Math.round(e*t*100)/100;{let i=8*t,r=(e-8)*t*1.34;return Math.round((i+r)*100)/100}}normalizeDailySummary(e){return q(k({},e),{work_hours:this.toNumber(e.work_hours),regular_hours:this.toNumber(e.regular_hours),overtime_hours:this.toNumber(e.overtime_hours),base_wage:this.toNumber(e.base_wage),multiplier:this.toNumber(e.multiplier),regular_wage:this.toNumber(e.regular_wage),overtime_wage:this.toNumber(e.overtime_wage),special_bonus:this.toNumber(e.special_bonus),total_wage:this.toNumber(e.total_wage)})}normalizeEmployeeWage(e){return q(k({},e),{hourly_rate:this.toNumber(e.hourly_rate)})}getPreviousMonth(){let e=new Date,t=e.getMonth()+1,i=e.getFullYear();return t===1?(t=12,i--):t--,{year:i,month:t}}onMonthChange(){this.activeTab()==="daily"&&this.loadDailySummaries()}resetFilter(){let e=this.getPreviousMonth();this.selectedYear.set(e.year),this.selectedMonth.set(e.month),this.onMonthChange()}async loadDailySummaries(){this.dailyLoading.set(!0),this.dailyError.set("");try{let e=await this.apiService.getDailySummaries({year:this.selectedYear(),month:this.selectedMonth(),limit:1e3});if(e.success&&e.data){let t=e.data.map(i=>this.normalizeDailySummary(i));this.dailySummaries.set(t)}else this.dailyError.set(e.error||"\u8F09\u5165\u8CC7\u6599\u5931\u6557")}catch(e){this.dailyError.set(e?.message||"\u8F09\u5165\u5931\u6557"),console.error("Error loading daily summaries:",e)}finally{this.dailyLoading.set(!1)}}openDailyForm(e){if(e){let t=this.normalizeDailySummary(e);this.editingDaily.set(t),this.dailyForm.patchValue(q(k({},t),{work_date:this.toDateInput(t.work_date)}))}else this.editingDaily.set(null),this.dailyForm.reset({multiplier:1,special_bonus:0,is_special_day:!1});this.dailyFormVisible.set(!0)}openMonthlyDetails(e){let t=this.dailySummaries().filter(i=>i.user_id===e.user_id).filter(i=>{let r=new Date(i.work_date),o=r.getFullYear(),s=String(r.getMonth()+1).padStart(2,"0");return`${o}-${s}`===e.year_month}).sort((i,r)=>new Date(i.work_date).getTime()-new Date(r.work_date).getTime()).map(i=>{let r=this.normalizeDailySummary(i),o=q(k({},r),{clock_in_time_input:this.toTimeInput(i.clock_in_time),clock_out_time_input:this.toTimeInput(i.clock_out_time)});if(i.clock_in_time&&i.clock_out_time&&(!r.work_hours||r.work_hours===0)){let s=i.clock_in_time,u=i.clock_out_time,d=this.calculateWorkHours(s,u),m=this.calculateWage(d,r.base_wage);o.work_hours=d,o.total_wage=m,console.log("[DEBUG] \u81EA\u52D5\u8A08\u7B97\u5DE5\u6642:",{work_date:i.work_date,clock_in_time:s,clock_out_time:u,calculated_hours:d,calculated_wage:m,base_wage:r.base_wage}),this.apiService.updateDailySummary(i.id,{work_hours:d,total_wage:m}).then(h=>{h.success?console.log("[DEBUG] \u81EA\u52D5\u4FDD\u5B58\u6210\u529F:",{id:i.id}):console.warn("[DEBUG] \u81EA\u52D5\u4FDD\u5B58\u5931\u6557:",h.error)}).catch(h=>{console.error("[DEBUG] \u81EA\u52D5\u4FDD\u5B58\u932F\u8AA4:",h)})}return o});this.monthlyDetailsRows.set(t),this.monthlyDetailsTitle.set(`${e.display_name} - ${e.year_month}`),this.monthlyDetailsVisible.set(!0)}closeMonthlyDetails(){this.monthlyDetailsVisible.set(!1),this.monthlyDetailsRows.set([]),this.monthlyDetailsTitle.set(""),this.selectedRows.set([]),this.loadDailySummaries()}toggleRowSelection(e,t){let i=t.target.checked,r=this.selectedRows();i?this.selectedRows.set([...r,e]):this.selectedRows.set(r.filter(o=>o!==e))}toggleSelectAll(e){if(e.target.checked){let i=this.monthlyDetailsRows().filter(r=>!r.is_paid).map(r=>r.id);this.selectedRows.set(i)}else this.selectedRows.set([])}isRowSelected(e){return this.selectedRows().includes(e)}async batchVerifyRecords(){let e=this.selectedRows();if(e.length===0){alert("\u8ACB\u9078\u64C7\u8981\u6838\u5C0D\u7684\u8A18\u9304");return}if(confirm(`\u78BA\u5B9A\u8981\u6838\u5C0D\u9078\u4E2D\u7684 ${e.length} \u7B46\u8A18\u9304\u55CE\uFF1F`))try{let t=e.map(u=>this.apiService.updateDailySummary(u,{is_verified:!0})),r=(await Promise.all(t)).filter(u=>u.success).length,s=this.monthlyDetailsRows().map(u=>e.includes(u.id)?q(k({},u),{is_verified:!0}):u);this.monthlyDetailsRows.set(s),this.selectedRows.set([]),alert(`\u6210\u529F\u6838\u5C0D ${r} \u7B46\u8A18\u9304`)}catch(t){alert("\u6279\u91CF\u6838\u5C0D\u5931\u6557: "+t?.message)}}async batchReleaseRecords(){let e=this.selectedRows();if(e.length===0){alert("\u8ACB\u9078\u64C7\u8981\u767C\u653E\u7684\u8A18\u9304");return}let t=this.monthlyDetailsRows();if(e.filter(r=>{let o=t.find(s=>s.id===r);return o&&!o.is_verified}).length>0){alert("\u6709\u672A\u6838\u5C0D\u7684\u8A18\u9304\uFF0C\u8ACB\u5148\u6838\u5C0D\u5F8C\u518D\u767C\u653E");return}if(confirm(`\u78BA\u5B9A\u8981\u767C\u653E\u9078\u4E2D\u7684 ${e.length} \u7B46\u8A18\u9304\u55CE\uFF1F\u767C\u653E\u5F8C\u5C07\u7121\u6CD5\u518D\u7DE8\u8F2F\u3002`))try{let r=e.map(m=>this.apiService.updateDailySummary(m,{is_paid:!0})),s=(await Promise.all(r)).filter(m=>m.success).length,d=this.monthlyDetailsRows().map(m=>e.includes(m.id)?q(k({},m),{is_paid:!0}):m);this.monthlyDetailsRows.set(d),this.selectedRows.set([]),alert(`\u6210\u529F\u767C\u653E ${s} \u7B46\u8A18\u9304`)}catch(r){alert("\u6279\u91CF\u767C\u653E\u5931\u6557: "+r?.message)}}updateMonthlyDetailDisplay(e){let t=this.combineDateTime(e.work_date,e.clock_in_time_input),i=this.combineDateTime(e.work_date,e.clock_out_time_input);if(console.log("[DEBUG] updateMonthlyDetailDisplay:",{work_date:e.work_date,clock_in_time_input:e.clock_in_time_input,clock_out_time_input:e.clock_out_time_input,clockInTime:t,clockOutTime:i,base_wage:e.base_wage}),t&&i){let r=this.calculateWorkHours(t,i),o=this.calculateWage(r,e.base_wage);console.log("[DEBUG] \u8A08\u7B97\u7D50\u679C:",{newWorkHours:r,newTotalWage:o}),e.work_hours=r,e.total_wage=o,this.monthlyDetailsRows.set([...this.monthlyDetailsRows()])}else console.warn("[DEBUG] clockInTime \u6216 clockOutTime \u7121\u6548",{clockInTime:t,clockOutTime:i})}async saveMonthlyDetail(e){let t=this.combineDateTime(e.work_date,e.clock_in_time_input),i=this.combineDateTime(e.work_date,e.clock_out_time_input),r=this.calculateWorkHours(t,i),o=this.calculateWage(r,e.base_wage),s={clock_in_time:t,clock_out_time:i,work_hours:r,total_wage:o};try{let u=await this.apiService.updateDailySummary(e.id,s);u.success?(alert("\u66F4\u65B0\u6210\u529F"),this.loadDailySummaries()):alert("\u66F4\u65B0\u5931\u6557: "+(u.error||"\u672A\u77E5\u932F\u8AA4"))}catch(u){alert("\u66F4\u65B0\u5931\u6557: "+u?.message)}}async verifyMonthlyDetail(e){try{let t=await this.apiService.updateDailySummary(e.id,{is_verified:!e.is_verified});t.success?(alert(e.is_verified?"\u5DF2\u53D6\u6D88\u6838\u5C0D":"\u5DF2\u6838\u5C0D"),this.loadDailySummaries()):alert("\u64CD\u4F5C\u5931\u6557: "+(t.error||"\u672A\u77E5\u932F\u8AA4"))}catch(t){alert("\u64CD\u4F5C\u5931\u6557: "+t?.message)}}async releaseMonthlyDetail(e){try{let t=await this.apiService.updateDailySummary(e.id,{is_paid:!e.is_paid});t.success?(alert(e.is_paid?"\u5DF2\u53D6\u6D88\u767C\u653E":"\u5DF2\u767C\u653E"),this.loadDailySummaries()):alert("\u64CD\u4F5C\u5931\u6557: "+(t.error||"\u672A\u77E5\u932F\u8AA4"))}catch(t){alert("\u64CD\u4F5C\u5931\u6557: "+t?.message)}}closeDailyForm(){this.dailyFormVisible.set(!1),this.editingDaily.set(null),this.dailyForm.reset()}async saveDailyRecord(){if(!this.dailyForm.valid){alert("\u8ACB\u586B\u5BEB\u5FC5\u8981\u6B04\u4F4D");return}try{let e=this.dailyForm.value,t=this.editingDaily();if(t){let i=await this.apiService.updateDailySummary(t.id,e);i.success?(alert("\u66F4\u65B0\u6210\u529F"),this.closeDailyForm(),this.loadDailySummaries()):alert("\u66F4\u65B0\u5931\u6557: "+(i.error||"\u672A\u77E5\u932F\u8AA4"))}else{let i=await this.apiService.createDailySummary(e);i.success?(alert("\u65B0\u589E\u6210\u529F"),this.closeDailyForm(),this.loadDailySummaries()):alert("\u65B0\u589E\u5931\u6557: "+(i.error||"\u672A\u77E5\u932F\u8AA4"))}}catch(e){alert("\u64CD\u4F5C\u5931\u6557: "+e?.message),console.error("Error saving daily record:",e)}}async deleteDailyRecord(e){if(confirm(`\u78BA\u5B9A\u8981\u522A\u9664 ${e.display_name} \u7684\u85AA\u8CC7\u7D00\u9304\u55CE?`))try{let t=await this.apiService.deleteDailySummary(e.id);t.success?(alert("\u522A\u9664\u6210\u529F"),this.loadDailySummaries()):alert("\u522A\u9664\u5931\u6557: "+(t.error||"\u672A\u77E5\u932F\u8AA4"))}catch(t){alert("\u522A\u9664\u5931\u6557: "+t?.message),console.error("Error deleting daily record:",t)}}async verifyDailyRecord(e){try{let t=await this.apiService.updateDailySummary(e.id,{is_verified:!e.is_verified,verified_by:"user",verified_at:e.is_verified?null:new Date().toISOString()});t.success?(alert(e.is_verified?"\u5DF2\u53D6\u6D88\u6838\u5C0D":"\u5DF2\u6838\u5C0D"),this.loadDailySummaries()):alert("\u64CD\u4F5C\u5931\u6557: "+(t.error||"\u672A\u77E5\u932F\u8AA4"))}catch(t){alert("\u64CD\u4F5C\u5931\u6557: "+t?.message)}}async releaseDailyRecord(e){try{let t=await this.apiService.updateDailySummary(e.id,{is_paid:!e.is_paid,paid_by:"user",paid_at:e.is_paid?null:new Date().toISOString()});t.success?(alert(e.is_paid?"\u5DF2\u53D6\u6D88\u767C\u653E":"\u5DF2\u767C\u653E"),this.loadDailySummaries()):alert("\u64CD\u4F5C\u5931\u6557: "+(t.error||"\u672A\u77E5\u932F\u8AA4"))}catch(t){alert("\u64CD\u4F5C\u5931\u6557: "+t?.message)}}async loadEmployeeWages(){this.wagesLoading.set(!0),this.wagesError.set("");try{let e=await this.apiService.getEmployeeWages({limit:1e3});if(e.success&&e.data){let t=e.data.map(i=>this.normalizeEmployeeWage(i));this.employeeWages.set(t)}else this.wagesError.set(e.error||"\u8F09\u5165\u8CC7\u6599\u5931\u6557")}catch(e){this.wagesError.set(e?.message||"\u8F09\u5165\u5931\u6557"),console.error("Error loading employee wages:",e)}finally{this.wagesLoading.set(!1)}}openWageForm(e){if(e){let t=this.normalizeEmployeeWage(e);this.editingWage.set(t),this.wageForm.patchValue(q(k({},t),{effective_from:this.toDateInput(t.effective_from),effective_to:this.toDateInput(t.effective_to)}))}else this.editingWage.set(null),this.wageForm.reset({wage_type:"hourly",effective_from:this.toDateInput(new Date)});this.wagesFormVisible.set(!0)}closeWageForm(){this.wagesFormVisible.set(!1),this.editingWage.set(null),this.wageForm.reset()}async saveWageRecord(){if(!this.wageForm.valid){alert("\u8ACB\u586B\u5BEB\u5FC5\u8981\u6B04\u4F4D");return}try{let e=this.wageForm.value,t=this.editingWage();if(t){let i=await this.apiService.updateEmployeeWage(t.id,e);i.success?(alert("\u66F4\u65B0\u6210\u529F"),this.closeWageForm(),this.loadEmployeeWages()):alert("\u66F4\u65B0\u5931\u6557: "+(i.error||"\u672A\u77E5\u932F\u8AA4"))}else{let i=await this.apiService.createEmployeeWage(e);i.success?(alert("\u65B0\u589E\u6210\u529F"),this.closeWageForm(),this.loadEmployeeWages()):alert("\u65B0\u589E\u5931\u6557: "+(i.error||"\u672A\u77E5\u932F\u8AA4"))}}catch(e){alert("\u64CD\u4F5C\u5931\u6557: "+e?.message),console.error("Error saving wage record:",e)}}async deleteWageRecord(e){if(confirm(`\u78BA\u5B9A\u8981\u522A\u9664 ${e.display_name||`ID: ${e.user_id}`} \u7684\u85AA\u8CC7\u8A2D\u5B9A\u55CE?`))try{let t=await this.apiService.deleteEmployeeWage(e.id);t.success?(alert("\u522A\u9664\u6210\u529F"),this.loadEmployeeWages()):alert("\u522A\u9664\u5931\u6557: "+(t.error||"\u672A\u77E5\u932F\u8AA4"))}catch(t){alert("\u522A\u9664\u5931\u6557: "+t?.message),console.error("Error deleting wage record:",t)}}formatCurrency(e){return e==null?"":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}formatDate(e){if(!e)return"";try{return new Date(e).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"})}catch{return e}}formatDateYMD(e){if(!e)return"";try{let t=new Date(e),i=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0");return`${i}-${r}-${o}`}catch{return e||""}}formatMonth(e){if(!e)return"";try{let t=new Date(e),i=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0");return`${i}-${r}`}catch{return e}}formatTime(e){if(!e)return"";try{return new Date(e).toLocaleTimeString("zh-TW",{hour:"2-digit",minute:"2-digit"})}catch{return e}}getMonthLabel(){return`${this.selectedYear()}\u5E74${this.selectedMonth()}\u6708`}};qs.\u0275fac=function(t){return new(t||qs)},qs.\u0275cmp=ie({type:qs,selectors:[["app-payroll"]],decls:23,vars:22,consts:[["specialDate",""],["specialName",""],["specialMultiplier",""],["specialActive",""],["specialNotes",""],[1,"space-y-6"],[1,"flex","flex-col","sm:flex-row","items-start","sm:items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-white","p-4","rounded-xl","shadow-md","border","border-gray-200","w-full","sm:w-auto"],[1,"flex","flex-col","sm:flex-row","items-center","gap-3"],[1,"flex","items-center","gap-2"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"flex","gap-4","border-b","border-gray-200"],[1,"px-4","py-3","text-sm","font-medium","text-gray-600","hover:text-gray-900","transition-colors",3,"click"],["name","calendar-outline",1,"text-base","align-middle","mr-2"],["name","people-outline",1,"text-base","align-middle","mr-2"],["name","star-outline",1,"text-base","align-middle","mr-2"],[1,"text-sm","font-medium","text-gray-600","whitespace-nowrap"],[1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100",3,"ngModelChange","change","ngModel"],[3,"value"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-4"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4"],[1,"text-center","py-8"],[1,"bg-white","rounded-lg","shadow-md","overflow-hidden"],[1,"bg-gray-50","rounded-lg","p-8","text-center"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50","p-4"],[1,"bg-white","p-4","rounded-lg","shadow-md","border","border-gray-200"],[1,"text-xs","text-gray-500","mb-1"],[1,"text-2xl","font-semibold","text-gray-900"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-2xl","font-semibold","text-green-600"],[1,"text-2xl","font-semibold","text-blue-600"],[1,"text-sm","text-red-700"],[1,"text-gray-500"],[1,"overflow-x-auto"],[1,"w-full","text-sm"],[1,"bg-gray-100","border-b","border-gray-200"],[1,"px-4","py-3","text-left","font-semibold","text-gray-700"],[1,"px-4","py-3","text-right","font-semibold","text-gray-700"],[1,"px-4","py-3","text-center","font-semibold","text-gray-700"],[1,"divide-y","divide-gray-200"],["title","\u9EDE\u64CA\u67E5\u770B\u660E\u7D30",1,"hover:bg-indigo-50","transition-colors","cursor-pointer"],["title","\u9EDE\u64CA\u67E5\u770B\u660E\u7D30",1,"hover:bg-indigo-50","transition-colors","cursor-pointer",3,"click"],[1,"px-4","py-3"],[1,"px-4","py-3","font-medium"],[1,"px-4","py-3","text-right"],[1,"px-4","py-3","text-right","font-semibold"],[1,"px-4","py-3","text-center"],[1,"text-red-600","font-medium"],[1,"text-green-600"],["title","\u4E0B\u8F09\u52DE\u5831\u55AE",1,"px-3","py-1","bg-blue-500","text-white","text-xs","rounded","hover:bg-blue-600","disabled:bg-gray-300","disabled:cursor-not-allowed","transition-colors",3,"click","disabled"],[1,"text-gray-500","mb-4"],[1,"bg-white","rounded-lg","shadow-lg","max-w-6xl","w-full","max-h-[90vh]","overflow-y-auto"],[1,"sticky","top-0","bg-white","border-b","p-4","flex","justify-between","items-center"],[1,"text-lg","font-semibold"],[1,"text-gray-500","hover:text-gray-700",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6"],[1,"mb-4","flex","gap-4","items-center","bg-gray-50","p-4","rounded-lg"],[1,"flex-1","text-sm","text-gray-600"],[1,"flex","gap-2"],[1,"px-4","py-2","bg-green-600","text-white","rounded-lg","hover:bg-green-700","disabled:bg-gray-300","disabled:cursor-not-allowed","transition-colors","flex","items-center","gap-2",3,"click","disabled"],["name","checkmark-done-outline"],[1,"px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","disabled:bg-gray-300","disabled:cursor-not-allowed","transition-colors","flex","items-center","gap-2",3,"click","disabled"],["name","cash-outline"],["type","checkbox",1,"rounded","border-gray-300","text-indigo-600","focus:ring-indigo-500",3,"change"],[1,"hover:bg-gray-50","transition-colors",3,"bg-green-50","opacity-60"],[1,"hover:bg-gray-50","transition-colors"],["type","checkbox",1,"rounded","border-gray-300","text-indigo-600","focus:ring-indigo-500","disabled:opacity-50",3,"change","checked","disabled"],["type","time",1,"w-36","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-indigo-500","text-base","disabled:bg-gray-100","disabled:cursor-not-allowed",3,"ngModelChange","change","ngModel","disabled"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-yellow-100","text-yellow-800"],[1,"text-gray-400"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-green-100","text-green-800"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-gray-100","text-gray-600"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium","bg-blue-100","text-blue-800"],["title","\u4FDD\u5B58\u6253\u5361\u6642\u9593",1,"text-indigo-600","hover:text-indigo-800","transition-colors","disabled:text-gray-300","disabled:cursor-not-allowed",3,"click","disabled"],["name","save-outline",1,"text-xl"],["name","checkmark-done-outline",1,"mr-1"],["name","cash-outline",1,"mr-1"],[1,"flex","justify-end"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2",3,"click"],["name","add-outline"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-green-100","text-green-800"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-gray-100","text-gray-800"],["title","\u7DE8\u8F2F",1,"text-indigo-600","hover:text-indigo-800","transition-colors","mr-2",3,"click"],["name","pencil-outline"],["title","\u522A\u9664",1,"text-red-600","hover:text-red-800","transition-colors",3,"click"],["name","trash-outline"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors",3,"click"],[1,"bg-white","rounded-lg","shadow-lg","max-w-2xl","w-full"],[1,"bg-white","border-b","p-4","flex","justify-between","items-center"],[1,"p-6","space-y-4",3,"formGroup"],[1,"grid","grid-cols-2","gap-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["formControlName","user_id","type","number",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500",3,"readonly"],["formControlName","display_name","type","text",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500"],["formControlName","hourly_rate","type","number","step","0.01",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500"],["formControlName","wage_type",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500"],["value","hourly"],["value","monthly"],["formControlName","effective_from","type","date",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500"],["formControlName","effective_to","type","date",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500"],["formControlName","notes","rows","2",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500"],[1,"flex","justify-end","gap-3","pt-6","border-t"],["type","button",1,"px-4","py-2","border","border-gray-300","rounded-lg","text-gray-700","hover:bg-gray-50","transition-colors",3,"click"],["type","button",1,"px-4","py-2","bg-indigo-600","text-white","rounded-lg","hover:bg-indigo-700","transition-colors",3,"click"],[1,"flex","justify-between","items-center"],[1,"text-xl","font-semibold","text-gray-900"],[1,"px-4","py-2","bg-indigo-600","text-white","rounded-lg","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2",3,"click"],[1,"bg-red-50","text-red-600","p-4","rounded-lg"],[1,"bg-white","rounded-xl","shadow-md","overflow-hidden"],[1,"w-full"],[1,"bg-gray-50","border-b","border-gray-200"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"px-6","py-3","text-center","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],[1,"hover:bg-gray-50"],["colspan","6",1,"px-6","py-8","text-center","text-gray-500"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-900"],[1,"px-6","py-4","text-sm","text-gray-900"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-center"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-yellow-100","text-yellow-800"],[1,"px-6","py-4","text-sm","text-gray-500"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-center","space-x-2"],["title","\u7DE8\u8F2F",1,"text-indigo-600","hover:text-indigo-900",3,"click"],["name","create-outline",1,"text-lg","align-middle"],["title","\u522A\u9664",1,"text-red-600","hover:text-red-900",3,"click"],["name","trash-outline",1,"text-lg","align-middle"],[1,"bg-white","rounded-lg","shadow-xl","max-w-md","w-full"],[1,"text-lg","font-semibold","text-gray-900","mb-4"],[1,"space-y-4"],["type","date","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500",3,"value"],["type","text","placeholder","\u4F8B\u5982\uFF1A\u6625\u7BC0\u3001\u570B\u6176\u65E5","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500",3,"value"],["type","number","step","0.1","min","1","max","10","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500",3,"value"],[1,"flex","items-center"],["type","checkbox",1,"rounded","border-gray-300","text-indigo-600","focus:ring-indigo-500",3,"checked"],[1,"ml-2","text-sm","text-gray-700"],["rows","3","placeholder","\u9078\u586B",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-indigo-500",3,"value"],[1,"flex","justify-end","gap-3","mt-6","pt-6","border-t"]],template:function(t,i){t&1&&(l(0,"div",5)(1,"div",6)(2,"h1",7),c(3,"\u85AA\u8CC7\u7BA1\u7406"),a(),l(4,"div",8)(5,"div",9),A(6,WO,6,2,"div",10)(7,YO,9,4,"div",10),l(8,"button",11),b("click",function(){return i.resetFilter()}),x(9,"ion-icon",12),a()()()(),l(10,"div",13)(11,"button",14),b("click",function(){return i.activeTab.set("daily")}),x(12,"ion-icon",15),c(13," \u6BCF\u6708\u85AA\u8CC7 "),a(),l(14,"button",14),b("click",function(){return i.activeTab.set("wages")}),x(15,"ion-icon",16),c(16," \u54E1\u5DE5\u85AA\u8CC7\u8A2D\u5B9A "),a(),l(17,"button",14),b("click",function(){return i.activeTab.set("special")}),x(18,"ion-icon",17),c(19," \u7279\u6B8A\u5DE5\u4F5C\u65E5 "),a()(),A(20,hL,7,6,"div",5),A(21,DL,10,5,"div",5),A(22,PL,11,4,"div",5),a()),t&2&&(f(6),N(i.activeTab()==="special"?6:7),f(5),z("border-b-2",i.activeTab()==="daily")("border-indigo-600",i.activeTab()==="daily")("text-indigo-600",i.activeTab()==="daily"),f(3),z("border-b-2",i.activeTab()==="wages")("border-indigo-600",i.activeTab()==="wages")("text-indigo-600",i.activeTab()==="wages"),f(3),z("border-b-2",i.activeTab()==="special")("border-indigo-600",i.activeTab()==="special")("text-indigo-600",i.activeTab()==="special"),f(3),N(i.activeTab()==="daily"?20:-1),f(),N(i.activeTab()==="wages"?21:-1),f(),N(i.activeTab()==="special"?22:-1))},dependencies:[re,be,$e,ke,Ve,Ce,Ft,Ae,me,Fe,Ie,Oe,Pe,Be],encapsulation:2,changeDetection:0});var rp=qs;function kL(n,e){if(n&1){let t=B();l(0,"tr",16)(1,"td",23)(2,"button",24),b("click",function(){let r=w(t).$index,o=v();return T(o.clearRecord(r))}),x(3,"ion-icon",25),a()(),l(4,"td",26),c(5),a(),l(6,"td",27),x(7,"input",28),a(),l(8,"td",27),x(9,"input",29),a(),l(10,"td",30),c(11),qt(12,"number"),a(),l(13,"td",31),x(14,"input",32),a(),l(15,"td",33),c(16),qt(17,"currency"),a()()}if(n&2){let t,i=e.$implicit,r=e.$index,o=v();M("formGroupName",r),f(5),ut(" ",(t=i.get("date"))==null?null:t.value," (",o.getWeekday((t=i.get("date"))==null?null:t.value),") "),f(6),V(" ",an(12,5,o.calculateWorkHours(i),"1.2-2")," "),f(5),V(" ",zd(17,8,o.calculateSalary(i),"TWD","symbol","1.0-0")," ")}}var Ws=class Ws{constructor(){this.fb=P(He);this.dataService=P(Tt);this.router=P(Le);this.route=P(un);this.employee=S(null);this.year=S(0);this.month=S(0);this.payrollForm=this.fb.group({records:this.fb.array([])});this.initialFormValue="";this.totalHours=H(()=>this.records.controls.reduce((e,t)=>e+this.calculateWorkHours(t),0));this.totalSalary=H(()=>this.records.controls.reduce((e,t)=>e+this.calculateSalary(t),0));this.route.paramMap.pipe(Ze(e=>{let t=e.get("employeeId"),i=Number(e.get("year")),r=Number(e.get("month"));if(!t||!i||!r){alert("\u7121\u6548\u7684\u7DB2\u5740\u53C3\u6578"),this.router.navigate(["/payroll"]);return}let o=this.dataService.getEmployeeById(t);if(!o){alert("\u627E\u4E0D\u5230\u54E1\u5DE5"),this.router.navigate(["/payroll"]);return}this.employee.set(o),this.year.set(i),this.month.set(r),this.buildForm(t,i,r)})).subscribe()}get records(){return this.payrollForm.get("records")}buildForm(e,t,i){let r=this.records;r.clear();let o=this.dataService.getPunchRecordsForMonth(e,t,i),s=new Date(t,i,0).getDate();for(let u=1;u<=s;u++){let d=`${t}-${String(i).padStart(2,"0")}-${String(u).padStart(2,"0")}`,m=o.find(y=>y.date===d),h=this.fb.group({date:[d],clockIn:[m?.clockIn||null],clockOut:[m?.clockOut||null],isDoublePay:[m?.isDoublePay||!1]});r.push(h)}this.initialFormValue=JSON.stringify(this.payrollForm.value)}getWeekday(e){return e?new Date(e+"T00:00:00").toLocaleDateString("zh-TW",{weekday:"short"}).replace("\u9031",""):""}calculateWorkHours(e){let{clockIn:t,clockOut:i}=e.value;if(!t||!i)return 0;let[r,o,s]=t.split(":").map(Number),[u,d,m]=i.split(":").map(Number),h=new Date(0,0,0,r,o,s||0),y=new Date(0,0,0,u,d,m||0);if(isNaN(h.getTime())||isNaN(y.getTime())||y<h)return 0;let C=(y.getTime()-h.getTime())/(1e3*60*60);return Math.floor(C*100)/100}calculateSalary(e){let t=this.calculateWorkHours(e),i=this.employee()?.hourlyRate||0,r=e.get("isDoublePay")?.value,o=t*i;return r&&(o*=2),o}onSave(){let e=this.employee()?.id;if(!e)return;let i=(this.payrollForm.value.records||[]).map(r=>({employeeId:e,date:r.date,clockIn:r.clockIn||null,clockOut:r.clockOut||null,isDoublePay:r.isDoublePay||!1}));this.dataService.updatePunchRecords(e,this.year(),this.month(),i),this.initialFormValue=JSON.stringify(this.payrollForm.value),alert("\u6253\u5361\u7D00\u9304\u5DF2\u5132\u5B58\uFF01"),this.router.navigate(["/payroll"])}goBack(){this.router.navigate(["/payroll"])}onCancel(){let e=JSON.stringify(this.payrollForm.value);this.initialFormValue===e?this.router.navigate(["/payroll"]):confirm("\u60A8\u6709\u672A\u5132\u5B58\u7684\u8B8A\u66F4\uFF0C\u78BA\u5B9A\u8981\u96E2\u958B\u55CE\uFF1F")&&this.router.navigate(["/payroll"])}clearRecord(e){confirm("\u662F\u5426\u6E05\u9664\u7576\u5929\u6253\u5361\u8CC7\u6599\uFF1F")&&this.records.at(e).patchValue({clockIn:null,clockOut:null,isDoublePay:!1})}};Ws.\u0275fac=function(t){return new(t||Ws)},Ws.\u0275cmp=ie({type:Ws,selectors:[["app-payroll-detail"]],decls:47,vars:14,consts:[[1,"space-y-6","max-w-5xl","mx-auto"],[1,"flex","items-center","gap-4"],[1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","arrow-back-outline",1,"text-2xl"],[1,"text-3xl","font-bold","text-gray-900"],[1,"text-lg","text-indigo-600","font-semibold"],[1,"bg-white","p-6","rounded-xl","shadow-md"],["novalidate","",3,"ngSubmit","formGroup"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-2","py-3","w-12"],[1,"px-3","py-3"],[1,"px-3","py-3","text-center"],[1,"px-3","py-3","text-right"],["formArrayName","records"],[1,"border-b","hover:bg-gray-50",3,"formGroupName"],[1,"font-bold","bg-gray-100","text-base"],[1,"border-t-2"],["colspan","4",1,"px-3","py-3"],[1,"flex","items-center","justify-end","gap-4","pt-6","mt-6","border-t"],["type","button",1,"px-4","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],["type","submit",1,"px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-indigo-600","hover:bg-indigo-700"],[1,"px-2","py-2","text-center"],["type","button","title","\u6E05\u9664\u6B64\u884C",1,"text-red-500","hover:text-red-700","p-1","rounded-full","hover:bg-red-100","transition-colors",3,"click"],["name","close-circle-outline",1,"text-lg","align-middle"],[1,"px-3","py-2","font-medium"],[1,"px-3","py-2"],["type","time","step","1","formControlName","clockIn",1,"w-full","border-gray-200","rounded-md","shadow-sm","p-1","bg-gray-50","text-sm"],["type","time","step","1","formControlName","clockOut",1,"w-full","border-gray-200","rounded-md","shadow-sm","p-1","bg-gray-50","text-sm"],[1,"px-3","py-2","text-center","font-medium"],[1,"px-3","py-2","text-center"],["type","checkbox","formControlName","isDoublePay",1,"rounded","h-4","w-4","text-indigo-600","focus:ring-indigo-500","border-gray-300"],[1,"px-3","py-2","text-right","font-semibold"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"button",2),b("click",function(){return i.goBack()}),x(3,"ion-icon",3),a(),l(4,"div")(5,"h1",4),c(6),a(),l(7,"p",5),c(8),a()()(),l(9,"div",6)(10,"form",7),b("ngSubmit",function(){return i.onSave()}),l(11,"div",8)(12,"table",9)(13,"thead",10)(14,"tr"),x(15,"th",11),l(16,"th",12),c(17,"\u65E5\u671F"),a(),l(18,"th",12),c(19,"\u4E0A\u73ED"),a(),l(20,"th",12),c(21,"\u4E0B\u73ED"),a(),l(22,"th",13),c(23,"\u5DE5\u6642"),a(),l(24,"th",13),c(25,"\u96D9\u500D\u85AA\u8CC7"),a(),l(26,"th",14),c(27,"\u85AA\u8CC7"),a()()(),l(28,"tbody",15),O(29,kL,18,13,"tr",16,W),a(),l(31,"tfoot",17)(32,"tr",18)(33,"td",19),c(34,"\u7E3D\u8A08"),a(),l(35,"td",13),c(36),qt(37,"number"),a(),x(38,"td",12),l(39,"td",14),c(40),qt(41,"currency"),a()()()()(),l(42,"div",20)(43,"button",21),b("click",function(){return i.onCancel()}),c(44," \u53D6\u6D88 "),a(),l(45,"button",22),c(46," \u5132\u5B58\u8B8A\u66F4 "),a()()()()()),t&2){let r;f(6),V(" ",(r=i.employee())==null?null:r.name," - \u6253\u5361\u8A73\u7D30\u8CC7\u8A0A "),f(2),ut("",i.year(),"\u5E74 ",i.month(),"\u6708"),f(2),M("formGroup",i.payrollForm),f(19),L(i.records.controls),f(7),E(an(37,6,i.totalHours(),"1.2-2")),f(4),E(zd(41,9,i.totalSalary(),"TWD","symbol","1.0-0"))}},dependencies:[re,Oe,$e,Ce,Ll,me,Fe,Pe,Be,wi,Ti,nl,Hg],encapsulation:2,changeDetection:0});var op=Ws;function VL(n,e){n&1&&(l(0,"div",11)(1,"div",12),c(2,"\u8F09\u5165\u4E2D..."),a()())}function OL(n,e){if(n&1&&(l(0,"div",13),c(1),a()),n&2){let t=v();f(),V(" ",t.error()," ")}}function LL(n,e){if(n&1){let t=B();l(0,"tr",22),b("click",function(){let r=w(t).$implicit,o=v(2);return T(o.openEditModal(r))}),l(1,"td",23),c(2),a(),l(3,"td",24)(4,"div",25)(5,"div",26),c(6),a()()(),l(7,"td",27),c(8),a(),l(9,"td",28)(10,"button",29),b("click",function(r){let o=w(t).$implicit;return v(2).openEditModal(o),T(r.stopPropagation())}),c(11," \u7DE8\u8F2F "),a()()()}if(n&2){let t=e.$implicit;f(2),E(t.employee_number),f(4),E(t.employee_name),f(2),E(t.position||"-")}}function BL(n,e){n&1&&(l(0,"tr")(1,"td",30),c(2," \u76EE\u524D\u6C92\u6709\u54E1\u5DE5\u8CC7\u6599 "),a()())}function UL(n,e){if(n&1&&(l(0,"div",14)(1,"table",15)(2,"thead",16)(3,"tr")(4,"th",17),c(5,"\u54E1\u5DE5\u7DE8\u865F"),a(),l(6,"th",17),c(7,"\u54E1\u5DE5\u59D3\u540D"),a(),l(8,"th",17),c(9,"\u8077\u7A31"),a(),l(10,"th",18),c(11,"\u64CD\u4F5C"),a()()(),l(12,"tbody",19),Pt(13,LL,12,3,"tr",20)(14,BL,3,0,"tr",21),a()()()),n&2){let t=v();f(13),M("ngForOf",t.employees()),f(),M("ngIf",t.employees().length===0)}}function $L(n,e){if(n&1){let t=B();l(0,"div",79)(1,"img",80),b("error",function(){w(t);let r=v(2);return T(r.onImageLoadError("front"))}),a(),l(2,"a",81),c(3," \u9810\u89BD\u5927\u5716 "),a()()}if(n&2){let t,i,r=v(2);f(),M("src",r.getImageUrl((t=r.selectedEmployee())==null?null:t.id_card_front),$t),f(),M("href",r.getImageUrl((i=r.selectedEmployee())==null?null:i.id_card_front),$t)}}function HL(n,e){if(n&1&&(l(0,"p",82),c(1),a()),n&2){let t,i=v(2);f(),V(" \u5DF2\u9078\u64C7: ",(t=i.selectedFrontFile())==null?null:t.name," ")}}function GL(n,e){if(n&1){let t=B();l(0,"button",83),b("click",function(){w(t);let r=v(2);return T(r.uploadFront())}),c(1),a()}if(n&2){let t=v(2);M("disabled",t.uploadingFront()),f(),V(" ",t.uploadingFront()?"\u4E0A\u50B3\u4E2D...":"\u78BA\u8A8D\u4E0A\u50B3\u6B63\u9762"," ")}}function qL(n,e){if(n&1&&(l(0,"p",84),c(1),a()),n&2){let t=v(2);f(),V("\u2713 ",t.uploadSuccessFront())}}function WL(n,e){if(n&1&&(l(0,"p",85),c(1),a()),n&2){let t=v(2);f(),E(t.uploadErrorFront())}}function jL(n,e){if(n&1){let t=B();l(0,"div",79)(1,"img",86),b("error",function(){w(t);let r=v(2);return T(r.onImageLoadError("back"))}),a(),l(2,"a",81),c(3," \u9810\u89BD\u5927\u5716 "),a()()}if(n&2){let t,i,r=v(2);f(),M("src",r.getImageUrl((t=r.selectedEmployee())==null?null:t.id_card_back),$t),f(),M("href",r.getImageUrl((i=r.selectedEmployee())==null?null:i.id_card_back),$t)}}function zL(n,e){if(n&1&&(l(0,"p",82),c(1),a()),n&2){let t,i=v(2);f(),V(" \u5DF2\u9078\u64C7: ",(t=i.selectedBackFile())==null?null:t.name," ")}}function YL(n,e){if(n&1){let t=B();l(0,"button",83),b("click",function(){w(t);let r=v(2);return T(r.uploadBack())}),c(1),a()}if(n&2){let t=v(2);M("disabled",t.uploadingBack()),f(),V(" ",t.uploadingBack()?"\u4E0A\u50B3\u4E2D...":"\u78BA\u8A8D\u4E0A\u50B3\u53CD\u9762"," ")}}function JL(n,e){if(n&1&&(l(0,"p",84),c(1),a()),n&2){let t=v(2);f(),V("\u2713 ",t.uploadSuccessBack())}}function KL(n,e){if(n&1&&(l(0,"p",85),c(1),a()),n&2){let t=v(2);f(),E(t.uploadErrorBack())}}function QL(n,e){if(n&1){let t=B();l(0,"div",31),b("click",function(){w(t);let r=v();return T(r.closeEditModal())}),l(1,"div",32),b("click",function(r){return w(t),T(r.stopPropagation())}),l(2,"div",33)(3,"h3",34),c(4),a(),l(5,"button",35),b("click",function(){w(t);let r=v();return T(r.closeEditModal())}),c(6," \xD7 "),a()(),l(7,"div",36)(8,"form",37)(9,"div",38)(10,"h4",39)(11,"span",40),c(12,"1"),a(),c(13," \u57FA\u672C\u8CC7\u8A0A "),a(),l(14,"div",41)(15,"div")(16,"label",42),c(17,"\u54E1\u5DE5\u7DE8\u865F"),a(),x(18,"input",43),a(),l(19,"div")(20,"label",42),c(21,"\u54E1\u5DE5\u59D3\u540D "),l(22,"span",44),c(23,"*"),a()(),x(24,"input",45),a(),l(25,"div")(26,"label",42),c(27,"\u8077\u7A31"),a(),x(28,"input",46),a(),l(29,"div")(30,"label",42),c(31,"\u8EAB\u4EFD\u8B49\u5B57\u865F"),a(),x(32,"input",47),a()()(),l(33,"div",38)(34,"h4",39)(35,"span",40),c(36,"2"),a(),c(37," \u806F\u7D61\u65B9\u5F0F "),a(),l(38,"div",41)(39,"div")(40,"label",42),c(41,"\u806F\u7D61\u96FB\u8A71"),a(),x(42,"input",48),a(),l(43,"div")(44,"label",42),c(45,"Email"),a(),x(46,"input",49),a(),l(47,"div",50)(48,"label",42),c(49,"\u6236\u7C4D\u5730\u5740"),a(),x(50,"input",51),a(),l(51,"div",50)(52,"label",42),c(53,"\u901A\u8A0A\u5730\u5740"),a(),x(54,"input",52),a()()(),l(55,"div",38)(56,"h4",39)(57,"span",40),c(58,"3"),a(),c(59," \u9280\u884C\u8CC7\u8A0A "),a(),l(60,"div",41)(61,"div")(62,"label",42),c(63,"\u4ED8\u6B3E\u65B9\u5F0F"),a(),l(64,"select",53)(65,"option",54),c(66,"\u8ACB\u9078\u64C7"),a(),l(67,"option",55),c(68,"\u73FE\u91D1"),a(),l(69,"option",56),c(70,"\u8F49\u5E33"),a(),l(71,"option",57),c(72,"\u652F\u7968"),a()()(),l(73,"div")(74,"label",42),c(75,"\u9280\u884C"),a(),x(76,"input",58),a(),l(77,"div")(78,"label",42),c(79,"\u5206\u884C"),a(),x(80,"input",59),a(),l(81,"div")(82,"label",42),c(83,"\u9280\u884C\u5E33\u865F"),a(),x(84,"input",60),a(),l(85,"div")(86,"label",42),c(87,"\u6236\u540D"),a(),x(88,"input",61),a()()(),l(89,"div",38)(90,"h4",39)(91,"span",40),c(92,"4"),a(),c(93," \u8EAB\u4EFD\u8B49\u5716\u7247 "),a(),l(94,"div",62)(95,"div",63)(96,"label",64),c(97,"\u8EAB\u4EFD\u8B49\u6B63\u9762"),a(),Pt(98,$L,4,2,"div",65),l(99,"input",66,0),b("change",function(r){w(t);let o=v();return T(o.onFrontFileSelected(r))}),a(),l(101,"button",67),b("click",function(){w(t);let r=Dn(100);return T(r.click())}),c(102),a(),Pt(103,HL,2,1,"p",68)(104,GL,2,2,"button",69)(105,qL,2,1,"p",70)(106,WL,2,1,"p",71),a(),l(107,"div",63)(108,"label",64),c(109,"\u8EAB\u4EFD\u8B49\u53CD\u9762"),a(),Pt(110,jL,4,2,"div",65),l(111,"input",66,1),b("change",function(r){w(t);let o=v();return T(o.onBackFileSelected(r))}),a(),l(113,"button",67),b("click",function(){w(t);let r=Dn(112);return T(r.click())}),c(114),a(),Pt(115,zL,2,1,"p",68)(116,YL,2,2,"button",69)(117,JL,2,1,"p",70)(118,KL,2,1,"p",71),a()()(),l(119,"div",38)(120,"h4",39)(121,"span",40),c(122,"5"),a(),c(123," \u5176\u4ED6\u8CC7\u8A0A "),a(),l(124,"div",72)(125,"div")(126,"label",42),c(127,"\u8077\u52D9\u5167\u5BB9"),a(),x(128,"textarea",73),a(),l(129,"div")(130,"label",42),c(131,"\u5099\u8A3B"),a(),x(132,"textarea",74),a()()()()(),l(133,"div",75)(134,"div",5),c(135),qt(136,"date"),a(),l(137,"div",76)(138,"button",77),b("click",function(){w(t);let r=v();return T(r.closeEditModal())}),c(139," \u53D6\u6D88 "),a(),l(140,"button",78),b("click",function(){w(t);let r=v();return T(r.saveEmployee())}),c(141),a()()()()()}if(n&2){let t,i,r,o,s,u,d=v();f(4),V("\u7DE8\u8F2F\u54E1\u5DE5\u8CC7\u6599 - ",(t=d.selectedEmployee())==null?null:t.employee_name),f(4),M("formGroup",d.employeeForm),f(90),M("ngIf",(i=d.selectedEmployee())==null?null:i.id_card_front),f(4),V(" ",(r=d.selectedEmployee())!=null&&r.id_card_front?"\u91CD\u65B0\u4E0A\u50B3\u6B63\u9762":"\u4E0A\u50B3\u6B63\u9762"," "),f(),M("ngIf",d.selectedFrontFile()),f(),M("ngIf",d.selectedFrontFile()),f(),M("ngIf",d.uploadSuccessFront()),f(),M("ngIf",d.uploadErrorFront()),f(4),M("ngIf",(o=d.selectedEmployee())==null?null:o.id_card_back),f(4),V(" ",(s=d.selectedEmployee())!=null&&s.id_card_back?"\u91CD\u65B0\u4E0A\u50B3\u53CD\u9762":"\u4E0A\u50B3\u53CD\u9762"," "),f(),M("ngIf",d.selectedBackFile()),f(),M("ngIf",d.selectedBackFile()),f(),M("ngIf",d.uploadSuccessBack()),f(),M("ngIf",d.uploadErrorBack()),f(17),V(" \u6700\u5F8C\u66F4\u65B0: ",an(136,17,(u=d.selectedEmployee())==null?null:u.updated_at,"yyyy-MM-dd HH:mm")," "),f(5),M("disabled",d.saving()||!d.employeeForm.valid),f(),V(" ",d.saving()?"\u5132\u5B58\u4E2D...":"\u5132\u5B58"," ")}}function ZL(n,e){n&1&&(l(0,"div",87),c(1," \u2713 \u5132\u5B58\u6210\u529F\uFF01 "),a())}var js=class js{constructor(){this.apiService=P(rt);this.fb=P(He);this.employees=S([]);this.loading=S(!1);this.error=S("");this.editModalOpen=S(!1);this.selectedEmployee=S(null);this.saving=S(!1);this.saveSuccess=S(!1);this.selectedFrontFile=S(null);this.selectedBackFile=S(null);this.uploadingFront=S(!1);this.uploadingBack=S(!1);this.uploadErrorFront=S("");this.uploadErrorBack=S("");this.uploadSuccessFront=S("");this.uploadSuccessBack=S("");this.employeeForm=this.fb.group({employee_number:[""],employee_name:["",U.required],position:[""],id_number:[""],phone:[""],email:["",U.email],registered_address:[""],mailing_address:[""],job_description:[""],payment_method:[""],bank:[""],branch:[""],account_number:[""],account_holder:[""],notes:[""]})}ngOnInit(){this.loadEmployees()}async loadEmployees(){this.loading.set(!0),this.error.set("");try{let e=await this.apiService.getEmployeeInfo();e.success&&e.data?this.employees.set(e.data):this.error.set("\u8F09\u5165\u54E1\u5DE5\u8CC7\u6599\u5931\u6557")}catch(e){console.error("Error loading employees:",e),this.error.set("\u7121\u6CD5\u8F09\u5165\u54E1\u5DE5\u8CC7\u6599\uFF0C\u8ACB\u6AA2\u67E5\u7DB2\u8DEF\u9023\u7DDA")}finally{this.loading.set(!1)}}openEditModal(e){this.selectedEmployee.set(e),this.employeeForm.patchValue(e),this.editModalOpen.set(!0),this.selectedFrontFile.set(null),this.selectedBackFile.set(null),this.uploadErrorFront.set(""),this.uploadErrorBack.set(""),this.uploadSuccessFront.set(""),this.uploadSuccessBack.set("")}closeEditModal(){this.editModalOpen.set(!1),this.selectedEmployee.set(null),this.employeeForm.reset()}async saveEmployee(){if(!(!this.employeeForm.valid||!this.selectedEmployee())){this.saving.set(!0);try{let e=this.employeeForm.value,t=this.selectedEmployee();if((await this.apiService.updateEmployeeInfo(t.employee_number,e)).success){let r=this.employees().map(o=>o.id===t.id?q(k(k({},o),e),{updated_at:new Date().toISOString()}):o);this.employees.set(r),this.saveSuccess.set(!0),setTimeout(()=>this.saveSuccess.set(!1),3e3),this.closeEditModal(),await this.loadEmployees()}}catch(e){console.error("Error saving employee:",e),this.error.set("\u5132\u5B58\u5931\u6557\uFF0C\u8ACB\u91CD\u8A66")}finally{this.saving.set(!1)}}}onFrontFileSelected(e){let t=e.target;t.files?.length&&(this.selectedFrontFile.set(t.files[0]),this.uploadErrorFront.set(""),this.uploadSuccessFront.set(""))}onBackFileSelected(e){let t=e.target;t.files?.length&&(this.selectedBackFile.set(t.files[0]),this.uploadErrorBack.set(""),this.uploadSuccessBack.set(""))}onImageLoadError(e){console.error(`Failed to load ID card ${e} image`)}async uploadFront(){let e=this.selectedFrontFile(),t=this.selectedEmployee();if(!(!e||!t)){this.uploadingFront.set(!0),this.uploadErrorFront.set("");try{let i=await this.apiService.uploadIdCardImage(e,t.employee_number,"front");if(i.success){await this.apiService.updateEmployeeIdCardPath(Number(t.employee_number),"front",i.filepath);let r=await this.apiService.getEmployeeInfo();if(r.success&&r.data){this.employees.set(r.data);let o=r.data.find(s=>s.id===t.id);o&&this.selectedEmployee.set(o)}this.uploadSuccessFront.set("\u6B63\u9762\u5716\u7247\u4E0A\u50B3\u6210\u529F\uFF01"),this.selectedFrontFile.set(null),setTimeout(()=>this.uploadSuccessFront.set(""),3e3)}}catch(i){this.uploadErrorFront.set(i?.error?.error||"\u4E0A\u50B3\u5931\u6557\uFF0C\u8ACB\u91CD\u8A66"),console.error("Upload error:",i)}finally{this.uploadingFront.set(!1)}}}async uploadBack(){let e=this.selectedBackFile(),t=this.selectedEmployee();if(!(!e||!t)){this.uploadingBack.set(!0),this.uploadErrorBack.set("");try{let i=await this.apiService.uploadIdCardImage(e,t.employee_number,"back");if(i.success){await this.apiService.updateEmployeeIdCardPath(Number(t.employee_number),"back",i.filepath);let r=await this.apiService.getEmployeeInfo();if(r.success&&r.data){this.employees.set(r.data);let o=r.data.find(s=>s.id===t.id);o&&this.selectedEmployee.set(o)}this.uploadSuccessBack.set("\u53CD\u9762\u5716\u7247\u4E0A\u50B3\u6210\u529F\uFF01"),this.selectedBackFile.set(null),setTimeout(()=>this.uploadSuccessBack.set(""),3e3)}}catch(i){this.uploadErrorBack.set(i?.error?.error||"\u4E0A\u50B3\u5931\u6557\uFF0C\u8ACB\u91CD\u8A66"),console.error("Upload error:",i)}finally{this.uploadingBack.set(!1)}}}getImageUrl(e){return e?e.startsWith("http://")||e.startsWith("https://")?e:e.startsWith("/")?"http://localhost:3000"+e:e:null}};js.\u0275fac=function(t){return new(t||js)},js.\u0275cmp=ie({type:js,selectors:[["app-company-profile"]],decls:11,vars:6,consts:[["frontFileInput",""],["backFileInput",""],[1,"p-6","space-y-6"],[1,"flex","justify-between","items-center"],[1,"text-2xl","font-bold","text-gray-800"],[1,"text-sm","text-gray-500"],["class","flex justify-center items-center py-12",4,"ngIf"],["class","bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",4,"ngIf"],["class","bg-white rounded-lg shadow overflow-hidden",4,"ngIf"],["class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",3,"click",4,"ngIf"],["class","fixed bottom-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-fade-in",4,"ngIf"],[1,"flex","justify-center","items-center","py-12"],[1,"text-gray-500"],[1,"bg-red-50","border","border-red-200","text-red-700","px-4","py-3","rounded"],[1,"bg-white","rounded-lg","shadow","overflow-hidden"],[1,"w-full"],[1,"bg-gray-50","border-b-2","border-gray-200"],[1,"px-6","py-4","text-left","text-sm","font-semibold","text-gray-700"],[1,"px-6","py-4","text-center","text-sm","font-semibold","text-gray-700"],[1,"divide-y","divide-gray-200"],["class","hover:bg-gray-50 transition-colors cursor-pointer",3,"click",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"hover:bg-gray-50","transition-colors","cursor-pointer",3,"click"],[1,"px-6","py-4","text-sm","text-gray-900"],[1,"px-6","py-4"],[1,"flex","items-center"],[1,"text-sm","font-medium","text-gray-900"],[1,"px-6","py-4","text-sm","text-gray-600"],[1,"px-6","py-4","text-center"],[1,"px-3","py-1","bg-blue-500","text-white","text-sm","rounded","hover:bg-blue-600","transition-colors",3,"click"],["colspan","4",1,"px-6","py-12","text-center","text-gray-500"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50","p-4",3,"click"],[1,"bg-white","rounded-lg","shadow-2xl","max-w-4xl","w-full","max-h-[90vh]","overflow-hidden","flex","flex-col",3,"click"],[1,"bg-gradient-to-r","from-blue-500","to-blue-600","px-6","py-4","flex","justify-between","items-center","text-white"],[1,"text-xl","font-bold"],[1,"text-white","hover:text-gray-200","text-3xl","leading-none",3,"click"],[1,"flex-1","overflow-y-auto","p-6"],[1,"space-y-6",3,"formGroup"],[1,"bg-gray-50","p-4","rounded-lg"],[1,"text-lg","font-semibold","text-gray-800","mb-4","flex","items-center"],[1,"bg-blue-500","text-white","rounded-full","w-8","h-8","flex","items-center","justify-center","mr-2","text-sm"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","formControlName","employee_number","disabled","",1,"w-full","px-3","py-2","border","border-gray-300","rounded","bg-gray-100","text-gray-600"],[1,"text-red-500"],["type","text","formControlName","employee_name","disabled","",1,"w-full","px-3","py-2","border","border-gray-300","rounded","bg-gray-100","text-gray-600"],["type","text","formControlName","position","placeholder","\u8ACB\u8F38\u5165\u8077\u7A31",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["type","text","formControlName","id_number","placeholder","\u8ACB\u8F38\u5165\u8EAB\u4EFD\u8B49\u5B57\u865F",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["type","tel","formControlName","phone","placeholder","\u8ACB\u8F38\u5165\u806F\u7D61\u96FB\u8A71",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["type","email","formControlName","email","placeholder","\u8ACB\u8F38\u5165 Email",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],[1,"md:col-span-2"],["type","text","formControlName","registered_address","placeholder","\u8ACB\u8F38\u5165\u6236\u7C4D\u5730\u5740",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["type","text","formControlName","mailing_address","placeholder","\u8ACB\u8F38\u5165\u901A\u8A0A\u5730\u5740\uFF08\u540C\u6236\u7C4D\u5730\u5740\u53EF\u7559\u7A7A\uFF09",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["formControlName","payment_method",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["value",""],["value","\u73FE\u91D1"],["value","\u8F49\u5E33"],["value","\u652F\u7968"],["type","text","formControlName","bank","placeholder","\u8ACB\u8F38\u5165\u9280\u884C\u540D\u7A31",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["type","text","formControlName","branch","placeholder","\u8ACB\u8F38\u5165\u5206\u884C\u540D\u7A31",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["type","text","formControlName","account_number","placeholder","\u8ACB\u8F38\u5165\u9280\u884C\u5E33\u865F",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["type","text","formControlName","account_holder","placeholder","\u8ACB\u8F38\u5165\u6236\u540D",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"space-y-3"],[1,"block","text-sm","font-medium","text-gray-700"],["class","mb-3",4,"ngIf"],["type","file","accept","image/jpeg,image/png",1,"hidden",3,"change"],["type","button",1,"w-full","px-4","py-2","border-2","border-dashed","border-blue-300","text-blue-600","rounded","hover:bg-blue-50","transition-colors",3,"click"],["class","text-sm text-gray-600",4,"ngIf"],["type","button","class","w-full px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 disabled:opacity-50",3,"disabled","click",4,"ngIf"],["class","text-sm text-green-600",4,"ngIf"],["class","text-sm text-red-600",4,"ngIf"],[1,"space-y-4"],["formControlName","job_description","rows","3","placeholder","\u8ACB\u8F38\u5165\u8077\u52D9\u5167\u5BB9\u63CF\u8FF0",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["formControlName","notes","rows","3","placeholder","\u8ACB\u8F38\u5165\u5099\u8A3B",1,"w-full","px-3","py-2","border","border-gray-300","rounded","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],[1,"bg-gray-50","border-t","border-gray-200","px-6","py-4","flex","justify-between","items-center"],[1,"flex","gap-3"],["type","button",1,"px-6","py-2","border","border-gray-300","rounded-lg","hover:bg-gray-50","transition-colors",3,"click"],["type","button",1,"px-6","py-2","bg-blue-500","text-white","rounded-lg","hover:bg-blue-600","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors",3,"click","disabled"],[1,"mb-3"],["alt","\u8EAB\u4EFD\u8B49\u6B63\u9762",1,"w-full","h-48","object-contain","border-2","border-gray-200","rounded","bg-gray-100",3,"error","src"],["target","_blank",1,"text-xs","text-blue-500","hover:underline","mt-1","inline-block",3,"href"],[1,"text-sm","text-gray-600"],["type","button",1,"w-full","px-4","py-2","bg-green-500","text-white","rounded","hover:bg-green-600","disabled:opacity-50",3,"click","disabled"],[1,"text-sm","text-green-600"],[1,"text-sm","text-red-600"],["alt","\u8EAB\u4EFD\u8B49\u53CD\u9762",1,"w-full","h-48","object-contain","border-2","border-gray-200","rounded","bg-gray-100",3,"error","src"],[1,"fixed","bottom-4","right-4","bg-green-500","text-white","px-6","py-3","rounded-lg","shadow-lg","z-50","animate-fade-in"]],template:function(t,i){t&1&&(l(0,"div",2)(1,"div",3)(2,"h2",4),c(3,"\u516C\u53F8\u500B\u4EBA\u8CC7\u6599"),a(),l(4,"div",5),c(5),a()(),Pt(6,VL,3,0,"div",6)(7,OL,2,1,"div",7)(8,UL,15,2,"div",8)(9,QL,142,20,"div",9)(10,ZL,2,0,"div",10),a()),t&2&&(f(5),V(" \u5171 ",i.employees().length," \u4F4D\u54E1\u5DE5 "),f(),M("ngIf",i.loading()),f(),M("ngIf",i.error()),f(),M("ngIf",!i.loading()),f(),M("ngIf",i.editModalOpen()),f(),M("ngIf",i.saveSuccess()))},dependencies:[re,es,ji,be,$e,ke,Ve,Ce,Ae,me,Fe,Oe,Pe,Be,eo],styles:["@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.animate-fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}"],changeDetection:0});var sp=js;var Ql=(n,e)=>e.id;function XL(n,e){if(n&1&&(l(0,"option",16),c(1),a()),n&2){let t=e.$implicit;M("value",t.id),f(),E(t.name)}}function e9(n,e){if(n&1&&(l(0,"option",16),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),E(t)}}function t9(n,e){if(n&1){let t=B();l(0,"tr",27)(1,"td",29),c(2),a(),l(3,"td",30),c(4),a(),l(5,"td",29),c(6),a(),l(7,"td",29),c(8),a(),l(9,"td",31),c(10),a(),l(11,"td",29),c(12),a(),l(13,"td",29),c(14),a(),l(15,"td",31),c(16),a(),l(17,"td",32),c(18),a(),l(19,"td",33),c(20),a(),l(21,"td",29)(22,"div",34)(23,"button",35),b("click",function(){let r=w(t).$implicit,o=v(2);return T(o.openModal(r))}),x(24,"ion-icon",36),a(),l(25,"button",37),b("click",function(){let r=w(t).$implicit,o=v(2);return T(o.deleteItem(r.id))}),x(26,"ion-icon",38),a()()()()}if(n&2){let t=e.$implicit,i=v(2);f(2),E(t.productId),f(2),E(t.productName),f(2),E(i.getVendorName(t.vendorId)),f(2),E(t.category),f(2),E(t.itemQuantity),f(2),E(t.itemUnit),f(2),E(t.totalUnit),f(2),E(i.formatCurrency(t.price)),f(2),E(i.formatCurrency(i.calculateItemCost(t.price,t.itemQuantity))),f(2),E(t.notes)}}function n9(n,e){n&1&&(l(0,"tr")(1,"td",39),c(2,"\u7121\u7B26\u5408\u689D\u4EF6\u7684\u5546\u54C1\u6210\u672C\u8CC7\u6599\u3002"),a()())}function i9(n,e){if(n&1){let t=B();l(0,"div",28)(1,"span",40),c(2),a(),l(3,"div",34)(4,"button",41),b("click",function(){w(t);let r=v(2);return T(r.goToPage(r.groceriesCurrentPage()-1,"groceries"))}),x(5,"ion-icon",42),a(),l(6,"span",43),c(7),a(),l(8,"button",41),b("click",function(){w(t);let r=v(2);return T(r.goToPage(r.groceriesCurrentPage()+1,"groceries"))}),x(9,"ion-icon",44),a()()()}if(n&2){let t=v(2);f(2),kt("\u986F\u793A\u7B2C ",(t.groceriesCurrentPage()-1)*t.groceriesPageSize+1," \u81F3 ",t.Math.min(t.groceriesCurrentPage()*t.groceriesPageSize,t.filteredGroceries().length)," \u7B46\uFF0C\u5171 ",t.filteredGroceries().length," \u7B46"),f(2),M("disabled",t.groceriesCurrentPage()===1),f(3),ut("\u7B2C ",t.groceriesCurrentPage()," \u9801 / \u5171 ",t.groceriesTotalPages()," \u9801"),f(),M("disabled",t.groceriesCurrentPage()===t.groceriesTotalPages())}}function r9(n,e){if(n&1){let t=B();l(0,"div",11)(1,"div",12)(2,"input",13),b("ngModelChange",function(r){w(t);let o=v();return o.groceriesSearchTerm.set(r),T(o.applyFilters("groceries"))}),a()(),l(3,"div")(4,"select",14),b("ngModelChange",function(r){w(t);let o=v();return o.groceriesSelectedVendor.set(r),T(o.applyFilters("groceries"))}),l(5,"option",15),c(6,"\u6240\u6709\u4F9B\u61C9\u5546"),a(),O(7,XL,2,2,"option",16,Ql),a()(),l(9,"div")(10,"select",14),b("ngModelChange",function(r){w(t);let o=v();return o.groceriesSelectedCategory.set(r),T(o.applyFilters("groceries"))}),l(11,"option",15),c(12,"\u6240\u6709\u54C1\u9805"),a(),O(13,e9,2,2,"option",16,W),a()(),l(15,"div",17)(16,"button",18),b("click",function(){w(t);let r=v();return T(r.resetFilters("groceries"))}),x(17,"ion-icon",19),a()()(),l(18,"div",20)(19,"table",21)(20,"thead",22)(21,"tr")(22,"th",23),b("click",function(){w(t);let r=v();return T(r.sortData("productId"))}),c(23,"\u5546\u54C1\u7DE8\u865F"),a(),l(24,"th",23),b("click",function(){w(t);let r=v();return T(r.sortData("productName"))}),c(25,"\u5546\u54C1\u540D\u7A31"),a(),l(26,"th",23),b("click",function(){w(t);let r=v();return T(r.sortData("vendorId"))}),c(27,"\u4F9B\u61C9\u5546"),a(),l(28,"th",23),b("click",function(){w(t);let r=v();return T(r.sortData("category"))}),c(29,"\u54C1\u9805"),a(),l(30,"th",24),b("click",function(){w(t);let r=v();return T(r.sortData("itemQuantity"))}),c(31,"\u7D30\u9805\u6578\u91CF"),a(),l(32,"th",23),b("click",function(){w(t);let r=v();return T(r.sortData("itemUnit"))}),c(33,"\u7D30\u9805\u55AE\u4F4D"),a(),l(34,"th",23),b("click",function(){w(t);let r=v();return T(r.sortData("totalUnit"))}),c(35,"\u7E3D\u55AE\u4F4D"),a(),l(36,"th",24),b("click",function(){w(t);let r=v();return T(r.sortData("price"))}),c(37,"\u50F9\u683C(\u5143)"),a(),l(38,"th",25),c(39,"\u7D30\u9805\u55AE\u4F4D\u6210\u672C"),a(),l(40,"th",26),c(41,"\u5099\u8A3B"),a(),l(42,"th",26),c(43,"\u64CD\u4F5C"),a()()(),l(44,"tbody"),O(45,t9,27,10,"tr",27,Ql,!1,n9,3,0,"tr"),a()()(),A(48,i9,10,7,"div",28)}if(n&2){let t=v();f(2),M("ngModel",t.groceriesSearchTerm()),f(2),M("ngModel",t.groceriesSelectedVendor()),f(3),L(t.allVendors()),f(3),M("ngModel",t.groceriesSelectedCategory()),f(3),L(t.groceriesProductCategories()),f(32),L(t.paginatedGroceries()),f(3),N(t.groceriesTotalPages()>1?48:-1)}}function o9(n,e){if(n&1&&(l(0,"option",16),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),E(t)}}function s9(n,e){if(n&1&&(l(0,"option",16),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),E(t)}}function a9(n,e){if(n&1){let t=B();l(0,"tr",27)(1,"td",29),c(2),a(),l(3,"td",30),c(4),a(),l(5,"td",29),c(6),a(),l(7,"td",31),c(8),a(),l(9,"td",31),c(10),a(),l(11,"td",32),c(12),a(),l(13,"td",29)(14,"div",34)(15,"button",35),b("click",function(){let r=w(t).$implicit,o=v(2);return T(o.openModal(r))}),x(16,"ion-icon",36),a(),l(17,"button",37),b("click",function(){let r=w(t).$implicit,o=v(2);return T(o.deleteItem(r.id))}),x(18,"ion-icon",38),a()()()()}if(n&2){let t=e.$implicit,i=v(2);f(2),E(t.vendor),f(2),E(t.productName),f(2),E(t.type),f(2),E(i.formatCurrency(t.cost)),f(2),E(i.formatCurrency(t.sellingPrice)),f(2),V("",i.calculateMargin(t.cost,t.sellingPrice).toFixed(2),"%")}}function l9(n,e){n&1&&(l(0,"tr")(1,"td",46),c(2,"\u7121\u8CC7\u6599\u3002"),a()())}function u9(n,e){if(n&1){let t=B();l(0,"div",28)(1,"span",40),c(2),a(),l(3,"div",34)(4,"button",41),b("click",function(){w(t);let r=v(2);return T(r.goToPage(r.wineCurrentPage()-1,"wines"))}),x(5,"ion-icon",42),a(),l(6,"span",43),c(7),a(),l(8,"button",41),b("click",function(){w(t);let r=v(2);return T(r.goToPage(r.wineCurrentPage()+1,"wines"))}),x(9,"ion-icon",44),a()()()}if(n&2){let t=v(2);f(2),kt("\u986F\u793A\u7B2C ",(t.wineCurrentPage()-1)*t.winePageSize+1," \u81F3 ",t.Math.min(t.wineCurrentPage()*t.winePageSize,t.filteredWines().length)," \u7B46\uFF0C\u5171 ",t.filteredWines().length," \u7B46"),f(2),M("disabled",t.wineCurrentPage()===1),f(3),ut("\u7B2C ",t.wineCurrentPage()," \u9801 / \u5171 ",t.wineTotalPages()," \u9801"),f(),M("disabled",t.wineCurrentPage()===t.wineTotalPages())}}function d9(n,e){if(n&1){let t=B();l(0,"div",11)(1,"div",12)(2,"input",45),b("ngModelChange",function(r){w(t);let o=v();return o.wineSearchTerm.set(r),T(o.applyFilters("wines"))}),a()(),l(3,"div")(4,"select",14),b("ngModelChange",function(r){w(t);let o=v();return o.wineSelectedVendor.set(r),T(o.applyFilters("wines"))}),l(5,"option",15),c(6,"\u6240\u6709\u5EE0\u5546"),a(),O(7,o9,2,2,"option",16,W),a()(),l(9,"div")(10,"select",14),b("ngModelChange",function(r){w(t);let o=v();return o.wineSelectedType.set(r),T(o.applyFilters("wines"))}),l(11,"option",15),c(12,"\u6240\u6709\u985E\u578B"),a(),O(13,s9,2,2,"option",16,W),a()(),l(15,"div",17)(16,"button",18),b("click",function(){w(t);let r=v();return T(r.resetFilters("wines"))}),x(17,"ion-icon",19),a()()(),l(18,"div",20)(19,"table",21)(20,"thead",22)(21,"tr")(22,"th",23),b("click",function(){w(t);let r=v();return T(r.sortData("vendor"))}),c(23,"\u5EE0\u5546"),a(),l(24,"th",23),b("click",function(){w(t);let r=v();return T(r.sortData("productName"))}),c(25,"\u5546\u54C1"),a(),l(26,"th",23),b("click",function(){w(t);let r=v();return T(r.sortData("type"))}),c(27,"\u985E\u578B"),a(),l(28,"th",24),b("click",function(){w(t);let r=v();return T(r.sortData("cost"))}),c(29,"\u9032\u8CA8\u6210\u672C"),a(),l(30,"th",24),b("click",function(){w(t);let r=v();return T(r.sortData("sellingPrice"))}),c(31,"\u552E\u50F9"),a(),l(32,"th",25),c(33,"\u6BDB\u5229\u7387"),a(),l(34,"th",26),c(35,"\u64CD\u4F5C"),a()()(),l(36,"tbody"),O(37,a9,19,6,"tr",27,Ql,!1,l9,3,0,"tr"),a()()(),A(40,u9,10,7,"div",28)}if(n&2){let t=v();f(2),M("ngModel",t.wineSearchTerm()),f(2),M("ngModel",t.wineSelectedVendor()),f(3),L(t.wineVendors()),f(3),M("ngModel",t.wineSelectedType()),f(3),L(t.wineTypes()),f(24),L(t.paginatedWines()),f(3),N(t.wineTotalPages()>1?40:-1)}}function c9(n,e){if(n&1&&(l(0,"option",16),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),E(t)}}function m9(n,e){if(n&1){let t=B();l(0,"tr",27)(1,"td",30),c(2),a(),l(3,"td",29),c(4),a(),l(5,"td",29),c(6),a(),l(7,"td",31),c(8),a(),l(9,"td",31),c(10),a(),l(11,"td",31),c(12),a(),l(13,"td",31),c(14),a(),l(15,"td",32),c(16),a(),l(17,"td",29)(18,"div",34)(19,"button",35),b("click",function(){let r=w(t).$implicit,o=v(2);return T(o.openModal(r))}),x(20,"ion-icon",36),a(),l(21,"button",37),b("click",function(){let r=w(t).$implicit,o=v(2);return T(o.deleteItem(r.id))}),x(22,"ion-icon",38),a()()()()}if(n&2){let t=e.$implicit,i=v(2);f(2),E(t.brand),f(2),E(t.productName),f(2),E(t.size),f(2),E(t.quantityPerBox),f(2),E(i.formatCurrency(t.lishengCost)),f(2),E(i.formatCurrency(t.baijiaCost)),f(2),E(i.formatCurrency(t.sellingPrice)),f(2),V("",i.calculateMargin(t.baijiaCost,t.sellingPrice).toFixed(2),"%")}}function p9(n,e){n&1&&(l(0,"tr")(1,"td",50),c(2,"\u7121\u8CC7\u6599\u3002"),a()())}function f9(n,e){if(n&1){let t=B();l(0,"div",28)(1,"span",40),c(2),a(),l(3,"div",34)(4,"button",41),b("click",function(){w(t);let r=v(2);return T(r.goToPage(r.cigarCurrentPage()-1,"cigars"))}),x(5,"ion-icon",42),a(),l(6,"span",43),c(7),a(),l(8,"button",41),b("click",function(){w(t);let r=v(2);return T(r.goToPage(r.cigarCurrentPage()+1,"cigars"))}),x(9,"ion-icon",44),a()()()}if(n&2){let t=v(2);f(2),kt("\u986F\u793A\u7B2C ",(t.cigarCurrentPage()-1)*t.cigarPageSize+1," \u81F3 ",t.Math.min(t.cigarCurrentPage()*t.cigarPageSize,t.filteredCigars().length)," \u7B46\uFF0C\u5171 ",t.filteredCigars().length," \u7B46"),f(2),M("disabled",t.cigarCurrentPage()===1),f(3),ut("\u7B2C ",t.cigarCurrentPage()," \u9801 / \u5171 ",t.cigarTotalPages()," \u9801"),f(),M("disabled",t.cigarCurrentPage()===t.cigarTotalPages())}}function g9(n,e){if(n&1){let t=B();l(0,"div",47)(1,"div",12)(2,"input",48),b("ngModelChange",function(r){w(t);let o=v();return o.cigarSearchTerm.set(r),T(o.applyFilters("cigars"))}),a()(),l(3,"div")(4,"select",14),b("ngModelChange",function(r){w(t);let o=v();return o.cigarSelectedBrand.set(r),T(o.applyFilters("cigars"))}),l(5,"option",15),c(6,"\u6240\u6709\u54C1\u724C"),a(),O(7,c9,2,2,"option",16,W),a()(),l(9,"div",49)(10,"button",18),b("click",function(){w(t);let r=v();return T(r.resetFilters("cigars"))}),x(11,"ion-icon",19),a()()(),l(12,"div",20)(13,"table",21)(14,"thead",22)(15,"tr")(16,"th",23),b("click",function(){w(t);let r=v();return T(r.sortData("brand"))}),c(17,"\u54C1\u724C"),a(),l(18,"th",23),b("click",function(){w(t);let r=v();return T(r.sortData("productName"))}),c(19,"\u5546\u54C1\u540D\u7A31"),a(),l(20,"th",23),b("click",function(){w(t);let r=v();return T(r.sortData("size"))}),c(21,"\u5C3A\u5BF8"),a(),l(22,"th",24),b("click",function(){w(t);let r=v();return T(r.sortData("quantityPerBox"))}),c(23,"\u6BCF\u76D2\u6578\u91CF"),a(),l(24,"th",24),b("click",function(){w(t);let r=v();return T(r.sortData("lishengCost"))}),c(25,"\u7406\u665F\u6210\u672C(\u652F)"),a(),l(26,"th",24),b("click",function(){w(t);let r=v();return T(r.sortData("baijiaCost"))}),c(27,"\u767E\u6CC7\u6210\u672C(\u652F)"),a(),l(28,"th",24),b("click",function(){w(t);let r=v();return T(r.sortData("sellingPrice"))}),c(29,"\u8CE3\u50F9"),a(),l(30,"th",25),c(31,"\u6BDB\u5229\u7387"),a(),l(32,"th",26),c(33,"\u64CD\u4F5C"),a()()(),l(34,"tbody"),O(35,m9,23,8,"tr",27,Ql,!1,p9,3,0,"tr"),a()()(),A(38,f9,10,7,"div",28)}if(n&2){let t=v();f(2),M("ngModel",t.cigarSearchTerm()),f(2),M("ngModel",t.cigarSelectedBrand()),f(3),L(t.cigarBrands()),f(28),L(t.paginatedCigars()),f(3),N(t.cigarTotalPages()>1?38:-1)}}function h9(n,e){if(n&1&&c(0),n&2){let t=v(2);V(" ",t.editingProductCost()?"\u7DE8\u8F2F\u5546\u54C1\u6210\u672C":"\u65B0\u589E\u5546\u54C1\u6210\u672C"," ")}}function y9(n,e){if(n&1&&c(0),n&2){let t=v(2);V(" ",t.editingWineCost()?"\u7DE8\u8F2F\u9152\u985E\u6210\u672C":"\u65B0\u589E\u9152\u985E\u6210\u672C"," ")}}function _9(n,e){if(n&1&&c(0),n&2){let t=v(2);V(" ",t.editingCigarCost()?"\u7DE8\u8F2F\u96EA\u8304\u6210\u672C":"\u65B0\u589E\u96EA\u8304\u6210\u672C"," ")}}function v9(n,e){if(n&1&&x(0,"option",16),n&2){let t=e.$implicit;M("value",t)}}function C9(n,e){if(n&1&&(l(0,"option",16),c(1),a()),n&2){let t=e.$implicit;M("value",t.id),f(),E(t.name)}}function x9(n,e){if(n&1&&(l(0,"div",58)(1,"div",62)(2,"label",63)(3,"span",64),c(4,"\u5546\u54C1\u7DE8\u865F*"),a(),x(5,"input",65),a(),l(6,"label",63)(7,"span",64),c(8,"\u5546\u54C1\u540D\u7A31*"),a(),x(9,"input",66),a(),l(10,"label",63)(11,"span",64),c(12,"\u54C1\u9805*"),a(),x(13,"input",67),l(14,"datalist",68),O(15,v9,1,1,"option",16,W),a()(),l(17,"label",63)(18,"span",64),c(19,"\u4F9B\u61C9\u5546*"),a(),l(20,"select",69)(21,"option",70),c(22,"\u9078\u64C7\u4F9B\u61C9\u5546"),a(),O(23,C9,2,2,"option",16,Ql),a()(),l(25,"label",63)(26,"span",64),c(27,"\u7D30\u9805\u6578\u91CF*"),a(),x(28,"input",71),a(),l(29,"label",63)(30,"span",64),c(31,"\u7D30\u9805\u55AE\u4F4D*"),a(),x(32,"input",72),a(),l(33,"label",63)(34,"span",64),c(35,"\u7E3D\u55AE\u4F4D*"),a(),x(36,"input",73),a(),l(37,"label",63)(38,"span",64),c(39,"\u50F9\u683C(\u5143)*"),a(),x(40,"input",74),a()(),l(41,"label",63)(42,"span",64),c(43,"\u5099\u8A3B"),a(),x(44,"textarea",75),a()()),n&2){let t=v(2);M("formGroup",t.productCostForm),f(15),L(t.groceriesProductCategories()),f(8),L(t.allVendors())}}function E9(n,e){if(n&1&&(l(0,"div",58)(1,"div",62)(2,"label",63)(3,"span",64),c(4,"\u5EE0\u5546*"),a(),x(5,"input",76),a(),l(6,"label",63)(7,"span",64),c(8,"\u5546\u54C1\u540D\u7A31*"),a(),x(9,"input",66),a(),l(10,"label",63)(11,"span",64),c(12,"\u985E\u578B*"),a(),x(13,"input",77),a(),l(14,"label",63)(15,"span",64),c(16,"\u9032\u8CA8\u6210\u672C*"),a(),x(17,"input",78),a(),l(18,"label",79)(19,"span",64),c(20,"\u552E\u50F9*"),a(),x(21,"input",80),a()()()),n&2){let t=v(2);M("formGroup",t.wineCostForm)}}function b9(n,e){if(n&1&&(l(0,"div",58)(1,"div",62)(2,"label",63)(3,"span",64),c(4,"\u54C1\u724C*"),a(),x(5,"input",81),a(),l(6,"label",63)(7,"span",64),c(8,"\u5546\u54C1\u540D\u7A31*"),a(),x(9,"input",66),a(),l(10,"label",63)(11,"span",64),c(12,"\u5C3A\u5BF8*"),a(),x(13,"input",82),a(),l(14,"label",63)(15,"span",64),c(16,"\u6BCF\u76D2\u6578\u91CF*"),a(),x(17,"input",83),a(),l(18,"label",63)(19,"span",64),c(20,"\u7406\u665F\u6210\u672C(\u652F)*"),a(),x(21,"input",84),a(),l(22,"label",63)(23,"span",64),c(24,"\u767E\u6CC7\u6210\u672C(\u652F)*"),a(),x(25,"input",85),a(),l(26,"label",79)(27,"span",64),c(28,"\u8CE3\u50F9*"),a(),x(29,"input",80),a()()()),n&2){let t=v(2);M("formGroup",t.cigarCostForm)}}function S9(n,e){if(n&1){let t=B();l(0,"div",10)(1,"div",51)(2,"div",52)(3,"h3",53),A(4,h9,1,1)(5,y9,1,1)(6,_9,1,1),a(),l(7,"button",54),b("click",function(){w(t);let r=v();return T(r.closeModal())}),x(8,"ion-icon",55),a()(),l(9,"div",56)(10,"form",57),b("ngSubmit",function(){w(t);let r=v();return T(r.handleFormSubmit())}),A(11,x9,45,1,"div",58)(12,E9,22,1,"div",58)(13,b9,30,1,"div",58),l(14,"div",59)(15,"button",60),b("click",function(){w(t);let r=v();return T(r.closeModal())}),c(16,"\u53D6\u6D88"),a(),l(17,"button",61),c(18,"\u5132\u5B58"),a()()()()()()}if(n&2){let t,i,r=v();f(4),N((t=r.activeView())==="groceries"?4:t==="wines"?5:t==="cigars"?6:-1),f(7),N((i=r.activeView())==="groceries"?11:i==="wines"?12:i==="cigars"?13:-1)}}var zs=class zs{constructor(){this.dataService=P(Tt);this.fb=P(He);this.activeView=S("groceries");this.isModalOpen=S(!1);this.Math=Math;this.allVendors=S([]);this.allProductCosts=S([]);this.editingProductCost=S(null);this.allCigarCosts=S([]);this.editingCigarCost=S(null);this.allWineCosts=S([]);this.editingWineCost=S(null);this.productCostForm=this.fb.group({id:[""],productId:["",U.required],productName:["",U.required],vendorId:["",U.required],category:["",U.required],itemQuantity:[null,[U.required,U.min(.01)]],itemUnit:["",U.required],totalUnit:["",U.required],price:[null,[U.required,U.min(0)]],notes:[""]});this.cigarCostForm=this.fb.group({id:[""],brand:["",U.required],productName:["",U.required],size:["",U.required],quantityPerBox:[null,[U.required,U.min(1)]],lishengCost:[null,[U.required,U.min(0)]],baijiaCost:[null,[U.required,U.min(0)]],sellingPrice:[null,[U.required,U.min(0)]]});this.wineCostForm=this.fb.group({id:[""],vendor:["",U.required],productName:["",U.required],type:["",U.required],cost:[null,[U.required,U.min(0)]],sellingPrice:[null,[U.required,U.min(0)]]});this.groceriesSearchTerm=S("");this.groceriesSelectedVendor=S("");this.groceriesSelectedCategory=S("");this.groceriesSortColumn=S("productName");this.groceriesSortDirection=S("asc");this.groceriesCurrentPage=S(1);this.groceriesPageSize=10;this.cigarSearchTerm=S("");this.cigarSelectedBrand=S("");this.cigarSortColumn=S("brand");this.cigarSortDirection=S("asc");this.cigarCurrentPage=S(1);this.cigarPageSize=10;this.wineSearchTerm=S("");this.wineSelectedVendor=S("");this.wineSelectedType=S("");this.wineSortColumn=S("vendor");this.wineSortDirection=S("asc");this.wineCurrentPage=S(1);this.winePageSize=10;this.groceriesProductCategories=H(()=>[...new Set(this.allProductCosts().map(e=>e.category))].sort());this.filteredGroceries=H(()=>this.filterAndSort(this.allProductCosts(),this.groceriesSearchTerm(),{vendorId:this.groceriesSelectedVendor(),category:this.groceriesSelectedCategory()},["productName","productId"],this.groceriesSortColumn(),this.groceriesSortDirection()));this.paginatedGroceries=H(()=>this.paginate(this.filteredGroceries(),this.groceriesCurrentPage(),this.groceriesPageSize));this.groceriesTotalPages=H(()=>Math.ceil(this.filteredGroceries().length/this.groceriesPageSize));this.cigarBrands=H(()=>[...new Set(this.allCigarCosts().map(e=>e.brand))].sort());this.filteredCigars=H(()=>this.filterAndSort(this.allCigarCosts(),this.cigarSearchTerm(),{brand:this.cigarSelectedBrand()},["productName","brand"],this.cigarSortColumn(),this.cigarSortDirection()));this.paginatedCigars=H(()=>this.paginate(this.filteredCigars(),this.cigarCurrentPage(),this.cigarPageSize));this.cigarTotalPages=H(()=>Math.ceil(this.filteredCigars().length/this.cigarPageSize));this.wineVendors=H(()=>[...new Set(this.allWineCosts().map(e=>e.vendor))].sort());this.wineTypes=H(()=>[...new Set(this.allWineCosts().map(e=>e.type))].sort());this.filteredWines=H(()=>this.filterAndSort(this.allWineCosts(),this.wineSearchTerm(),{vendor:this.wineSelectedVendor(),type:this.wineSelectedType()},["productName","vendor","type"],this.wineSortColumn(),this.wineSortDirection()));this.paginatedWines=H(()=>this.paginate(this.filteredWines(),this.wineCurrentPage(),this.winePageSize));this.wineTotalPages=H(()=>Math.ceil(this.filteredWines().length/this.winePageSize));this.loadData()}loadData(){this.allProductCosts.set(this.dataService.getProductCosts()),this.allCigarCosts.set(this.dataService.getCigarCosts()),this.allWineCosts.set(this.dataService.getWineCosts()),this.allVendors.set(this.dataService.getVendors())}changeView(e){this.activeView.set(e)}filterAndSort(e,t,i,r,o,s){let u=t.toLowerCase(),d=e.filter(m=>Object.entries(i).every(([y,_])=>!_||m[y]===_)?u?r.some(y=>String(m[y]).toLowerCase().includes(u)):!0:!1);return o&&(d=[...d].sort((m,h)=>{let y=m[o],_=h[o];return y<_?s==="asc"?-1:1:y>_?s==="asc"?1:-1:0})),d}paginate(e,t,i){let r=(t-1)*i;return e.slice(r,r+i)}openModal(e=null){let t=this.activeView();t==="groceries"?(this.editingProductCost.set(e),this.productCostForm.reset(),e&&this.productCostForm.patchValue(e)):t==="cigars"?(this.editingCigarCost.set(e),this.cigarCostForm.reset(),e&&this.cigarCostForm.patchValue(e)):t==="wines"&&(this.editingWineCost.set(e),this.wineCostForm.reset(),e&&this.wineCostForm.patchValue(e)),this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1)}handleFormSubmit(){let e=this.activeView();e==="groceries"?this.handleGroceriesSubmit():e==="cigars"?this.handleCigarSubmit():e==="wines"&&this.handleWineSubmit(),this.loadData(),this.closeModal()}handleGroceriesSubmit(){if(this.productCostForm.invalid)return;let e=this.productCostForm.value;this.editingProductCost()?this.dataService.updateProductCost(q(k({},e),{id:this.editingProductCost().id})):this.dataService.addProductCost(e)}handleCigarSubmit(){if(this.cigarCostForm.invalid)return;let e=this.cigarCostForm.value;this.editingCigarCost()?this.dataService.updateCigarCost(q(k({},e),{id:this.editingCigarCost().id})):this.dataService.addCigarCost(e)}handleWineSubmit(){if(this.wineCostForm.invalid)return;let e=this.wineCostForm.value;this.editingWineCost()?this.dataService.updateWineCost(q(k({},e),{id:this.editingWineCost().id})):this.dataService.addWineCost(e)}deleteItem(e){if(!confirm("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u6B64\u9805\u5546\u54C1\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"))return;let t=this.activeView();t==="groceries"?this.dataService.deleteProductCost(e):t==="cigars"?this.dataService.deleteCigarCost(e):t==="wines"&&this.dataService.deleteWineCost(e),this.loadData()}sortData(e){let t=this.activeView(),i=t==="groceries"?this.groceriesSortColumn:t==="cigars"?this.cigarSortColumn:this.wineSortColumn,r=t==="groceries"?this.groceriesSortDirection:t==="cigars"?this.cigarSortDirection:this.wineSortDirection;i()===e?r.update(o=>o==="asc"?"desc":"asc"):(i.set(e),r.set("asc"))}resetFilters(e){e==="groceries"?(this.groceriesSearchTerm.set(""),this.groceriesSelectedVendor.set(""),this.groceriesSelectedCategory.set("")):e==="cigars"?(this.cigarSearchTerm.set(""),this.cigarSelectedBrand.set("")):e==="wines"&&(this.wineSearchTerm.set(""),this.wineSelectedVendor.set(""),this.wineSelectedType.set("")),this.goToPage(1,e)}applyFilters(e){this.goToPage(1,e)}goToPage(e,t){let i=t==="groceries"?this.groceriesCurrentPage:t==="cigars"?this.cigarCurrentPage:this.wineCurrentPage,r=t==="groceries"?this.groceriesTotalPages():t==="cigars"?this.cigarTotalPages():this.wineTotalPages();e>=1&&e<=r&&i.set(e)}getVendorName(e){return this.allVendors().find(t=>t.id===e)?.name||"N/A"}calculateItemCost(e,t){return!e||!t?0:e/t}calculateMargin(e,t){return!e||!t?0:(t-e)/t*100}formatCurrency(e){return e?.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})||""}};zs.\u0275fac=function(t){return new(t||zs)},zs.\u0275cmp=ie({type:zs,selectors:[["app-product-cost"]],decls:22,vars:8,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","add-outline"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"border-b","border-gray-200"],["aria-label","Tabs",1,"-mb-px","flex","space-x-6"],[1,"whitespace-nowrap","py-4","px-1","border-b-2","font-medium","text-sm",3,"click"],[1,"pt-6"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","p-4","bg-gray-50","rounded-lg","mb-6"],[1,"md:col-span-2"],["type","text","placeholder","\u641C\u5C0B\u5546\u54C1\u540D\u7A31\u6216\u7DE8\u865F...",1,"w-full","border-gray-300","rounded-lg","shadow-sm","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"w-full","border-gray-300","rounded-lg","shadow-sm","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"flex","items-center","gap-2","md:col-span-4","justify-end"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-4","py-3","cursor-pointer",3,"click"],[1,"px-4","py-3","cursor-pointer","text-right",3,"click"],[1,"px-4","py-3","text-right"],[1,"px-4","py-3"],[1,"border-b","hover:bg-gray-50"],[1,"flex","justify-between","items-center","pt-4","border-t","mt-4"],[1,"px-4","py-2"],[1,"px-4","py-2","font-medium"],[1,"px-4","py-2","text-right"],[1,"px-4","py-2","text-right","font-semibold","bg-green-50"],[1,"px-4","py-2","truncate","max-w-xs"],[1,"flex","items-center","gap-2"],["title","\u7DE8\u8F2F",1,"text-indigo-600","hover:text-indigo-800","p-1",3,"click"],["name","create-outline",1,"text-lg"],["title","\u522A\u9664",1,"text-red-500","hover:text-red-700","p-1",3,"click"],["name","trash-outline",1,"text-lg"],["colspan","11",1,"text-center","py-8","text-gray-500"],[1,"text-sm","text-gray-600"],[1,"px-3","py-1","border","rounded-md","disabled:opacity-50",3,"click","disabled"],["name","chevron-back-outline"],[1,"text-sm"],["name","chevron-forward-outline"],["type","text","placeholder","\u641C\u5C0B\u5546\u54C1\u3001\u5EE0\u5546\u3001\u985E\u578B...",1,"w-full","border-gray-300","rounded-lg","shadow-sm","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["colspan","7",1,"text-center","py-8","text-gray-500"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","p-4","bg-gray-50","rounded-lg","mb-6"],["type","text","placeholder","\u641C\u5C0B\u54C1\u724C\u6216\u5546\u54C1\u540D\u7A31...",1,"w-full","border-gray-300","rounded-lg","shadow-sm","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"flex","items-center","gap-2","md:col-span-3","justify-end"],["colspan","9",1,"text-center","py-8","text-gray-500"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-2xl","max-h-[90vh]","flex","flex-col"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],["novalidate","",1,"space-y-4",3,"ngSubmit"],[1,"space-y-4",3,"formGroup"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"block"],[1,"text-gray-700"],["formControlName","productId",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","productName",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","category","list","productCategoriesList","placeholder","\u9078\u64C7\u6216\u8F38\u5165\u65B0\u54C1\u9805",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["id","productCategoriesList"],["formControlName","vendorId",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["value","","disabled",""],["type","number","formControlName","itemQuantity",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","itemUnit","placeholder","\u4F8B\u5982: ml, g, \u9846",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","totalUnit","placeholder","\u4F8B\u5982: \u74F6, \u5305, \u7F50",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["type","number","formControlName","price",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","notes","rows","3",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","vendor",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","type",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["type","number","formControlName","cost",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"block","md:col-span-2"],["type","number","formControlName","sellingPrice",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","brand",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","size",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["type","number","formControlName","quantityPerBox",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["type","number","formControlName","lishengCost",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["type","number","formControlName","baijiaCost",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),c(3,"\u5546\u54C1\u6210\u672C\u7BA1\u7406"),a(),l(4,"button",3),b("click",function(){return i.openModal()}),x(5,"ion-icon",4),l(6,"span"),c(7,"\u65B0\u589E\u9805\u76EE"),a()()(),l(8,"div",5)(9,"div",6)(10,"nav",7)(11,"button",8),b("click",function(){return i.changeView("groceries")}),c(12,"\u9910\u98F2&\u96DC\u8CA8"),a(),l(13,"button",8),b("click",function(){return i.changeView("wines")}),c(14,"\u5A01&\u7D05\u767D\u9152"),a(),l(15,"button",8),b("click",function(){return i.changeView("cigars")}),c(16,"\u96EA\u8304"),a()()(),l(17,"div",9),A(18,r9,49,5)(19,d9,41,5)(20,g9,39,4),a()()(),A(21,S9,19,2,"div",10)),t&2){let r;f(11),De(i.activeView()==="groceries"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),f(2),De(i.activeView()==="wines"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),f(2),De(i.activeView()==="cigars"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),f(3),N((r=i.activeView())==="groceries"?18:r==="wines"?19:r==="cigars"?20:-1),f(3),N(i.isModalOpen()?21:-1)}},dependencies:[re,Oe,$e,ke,Ve,Ce,Ft,Ae,me,Fe,Pe,Be,be,Ie,Ul],encapsulation:2,changeDetection:0});var ap=zs;var D9=(n,e)=>e.vendor_id||e.id;function w9(n,e){n&1&&(l(0,"div",1),x(1,"ion-icon",29),l(2,"span",30),c(3,"\u6B63\u5728\u52A0\u8F09\u6578\u64DA..."),a()())}function T9(n,e){if(n&1&&(l(0,"div",2),x(1,"ion-icon",31),l(2,"span",32),c(3),a()()),n&2){let t=v();f(3),E(t.errorMessage())}}function I9(n,e){if(n&1&&(l(0,"option",14),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),E(t)}}function M9(n,e){if(n&1&&c(0),n&2){let t=v().$implicit;V(" ",t.rest_days.join(", ")," ")}}function A9(n,e){if(n&1&&c(0),n&2){let t=v().$implicit;V(" ",t.restDays||"-"," ")}}function N9(n,e){if(n&1){let t=B();l(0,"tr",33),b("click",function(){let r=w(t).$implicit,o=v();return T(o.openModal(r))}),l(1,"td",34),c(2),a(),l(3,"td",35),c(4),a(),l(5,"td",34),c(6),a(),l(7,"td",34),A(8,M9,1,1)(9,A9,1,1),a()()}if(n&2){let t=e.$implicit;f(2),E(t.category),f(2),E(t.vendor_name||t.name),f(2),E(t.contact_info||t.contactInfo),f(2),N(t.rest_days&&t.rest_days.length>0?8:9)}}function R9(n,e){n&1&&(l(0,"tr")(1,"td",36),c(2,"\u7121\u7B26\u5408\u689D\u4EF6\u7684\u5EE0\u5546\u8CC7\u6599\u3002"),a()())}function F9(n,e){if(n&1&&(l(0,"div",52),x(1,"ion-icon",56),l(2,"span",57),c(3),a()()),n&2){let t=v(2);f(3),E(t.errorMessage())}}function P9(n,e){n&1&&(x(0,"ion-icon",58),l(1,"span"),c(2,"\u5132\u5B58\u4E2D..."),a())}function k9(n,e){n&1&&(l(0,"span"),c(1,"\u5132\u5B58"),a())}function V9(n,e){if(n&1){let t=B();l(0,"div",28)(1,"div",37)(2,"div",38)(3,"h3",39),c(4),a(),l(5,"button",40),b("click",function(){w(t);let r=v();return T(r.closeModal())}),x(6,"ion-icon",41),a()(),l(7,"div",42)(8,"form",43),b("ngSubmit",function(){w(t);let r=v();return T(r.handleVendorSubmit())}),x(9,"input",44),l(10,"label",45)(11,"span",46),c(12,"\u985E\u5225*"),a(),x(13,"input",47),a(),l(14,"label",45)(15,"span",46),c(16,"\u5EE0\u5546\u540D\u7A31*"),a(),x(17,"input",48),a(),l(18,"label",45)(19,"span",46),c(20,"\u7D71\u4E00\u7DE8\u865F"),a(),x(21,"input",49),a(),l(22,"label",45)(23,"span",46),c(24,"\u806F\u7D61\u65B9\u5F0F"),a(),x(25,"input",50),a(),l(26,"label",45)(27,"span",46),c(28,"\u4F11\u606F\u6642\u9593"),a(),x(29,"input",51),a(),A(30,F9,4,1,"div",52),l(31,"div",53)(32,"button",54),b("click",function(){w(t);let r=v();return T(r.closeModal())}),c(33,"\u53D6\u6D88"),a(),l(34,"button",55),A(35,P9,3,0)(36,k9,2,0,"span"),a()()()()()()}if(n&2){let t=v();f(4),E(t.editingVendor()?"\u7DE8\u8F2F\u5EE0\u5546":"\u65B0\u589E\u5EE0\u5546"),f(4),M("formGroup",t.vendorForm),f(22),N(t.errorMessage()?30:-1),f(2),M("disabled",t.isLoading()),f(2),M("disabled",t.isLoading()),f(),N(t.isLoading()?35:36)}}var Ys=class Ys{constructor(){this.apiService=P(rt);this.fb=P(He);this.isModalOpen=S(!1);this.isLoading=S(!1);this.errorMessage=S(null);this.allVendors=S([]);this.editingVendor=S(null);this.vendorForm=this.fb.group({vendor_id:[""],category:["",U.required],vendor_name:["",U.required],tax_id:[""],contact_info:[""],rest_days:[""]});this.vendorSearchTerm=S("");this.selectedVendorCategory=S("");this.vendorTaxIdFilter=S("");this.pageSize=20;this.currentPage=S(1);this.vendorCategories=H(()=>{let e=this.allVendors();return[...new Set(e.map(i=>i.category))].sort()});this.filteredVendors=H(()=>{let e=this.vendorSearchTerm().toLowerCase(),t=this.selectedVendorCategory(),i=this.vendorTaxIdFilter(),r=this.allVendors();return t&&(r=r.filter(o=>o.category===t)),i&&(r=r.filter(o=>(o.tax_id||o.taxId||"").includes(i))),e&&(r=r.filter(o=>(o.vendor_name||o.name||"").toLowerCase().includes(e)||(o.category||"").toLowerCase().includes(e)||(o.contact_info||o.contactInfo||"").toLowerCase().includes(e))),r});this.pagedVendors=H(()=>{let e=this.filteredVendors(),t=(this.currentPage()-1)*this.pageSize;return e.slice(t,t+this.pageSize)});this.totalPages=H(()=>{let e=this.filteredVendors().length;return Math.max(1,Math.ceil(e/this.pageSize))});this.totalRecords=H(()=>this.filteredVendors().length);this.loadData()}async loadData(){this.isLoading.set(!0),this.errorMessage.set(null);try{let e=await this.apiService.getVendors();e.success&&e.data?this.allVendors.set(e.data):this.errorMessage.set(e.error||"\u7121\u6CD5\u53D6\u5F97\u5EE0\u5546\u8CC7\u6599")}catch(e){console.error("Error loading vendors:",e),this.errorMessage.set("\u53D6\u5F97\u5EE0\u5546\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoading.set(!1)}}resetVendorFilters(){this.vendorSearchTerm.set(""),this.selectedVendorCategory.set(""),this.vendorTaxIdFilter.set(""),this.currentPage.set(1)}goToPage(e){let t=this.totalPages(),i=Math.min(Math.max(e,1),t);i!==this.currentPage()&&this.currentPage.set(i)}goToPrevPage(){this.goToPage(this.currentPage()-1)}goToNextPage(){this.goToPage(this.currentPage()+1)}onTaxIdInput(e){let t=e.target,i=t.value.replace(/\D/g,"").slice(0,8);this.vendorTaxIdFilter.set(i),t.value=i,this.currentPage.set(1)}openModal(e=null){this.editingVendor.set(e),this.vendorForm.reset(),e&&this.vendorForm.patchValue(e),this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1),this.editingVendor.set(null)}async handleVendorSubmit(){if(this.vendorForm.invalid){this.errorMessage.set("\u8ACB\u586B\u5BEB\u6240\u6709\u5FC5\u586B\u6B04\u4F4D");return}this.isLoading.set(!0),this.errorMessage.set(null);try{let e=this.vendorForm.value,t={vendor_id:e.vendor_id?Number(e.vendor_id):void 0,category:e.category||"",vendor_name:e.vendor_name||"",tax_id:e.tax_id||void 0,contact_info:e.contact_info||"",rest_days:e.rest_days?e.rest_days.split(",").map(i=>i.trim()).filter(i=>i):[]};if(this.editingVendor()&&t.vendor_id){let i=await this.apiService.updateVendor(t);if(!i.success){this.errorMessage.set(i.error||"\u66F4\u65B0\u5EE0\u5546\u5931\u6557");return}let o=this.allVendors().map(s=>(s.vendor_id||s.id)==t.vendor_id?k(q(k({},s),{vendor_id:t.vendor_id,category:t.category,vendor_name:t.vendor_name,tax_id:t.tax_id,contact_info:t.contact_info,rest_days:t.rest_days}),i.data||{}):s);this.allVendors.set(o),alert("\u5EE0\u5546\u8CC7\u6599\u5DF2\u6210\u529F\u66F4\u65B0"),this.closeModal()}else this.errorMessage.set("\u65B0\u589E\u5EE0\u5546\u529F\u80FD\u5C1A\u672A\u5BE6\u4F5C"),console.warn("\u65B0\u589E\u5EE0\u5546\u529F\u80FD\u9700\u8981\u5F8C\u7AEF\u652F\u6301")}catch(e){console.error("Error submitting vendor:",e),this.errorMessage.set("\u63D0\u4EA4\u5EE0\u5546\u8CC7\u6599\u5931\u6557\uFF1A"+(e instanceof Error?e.message:"\u672A\u77E5\u932F\u8AA4"))}finally{this.isLoading.set(!1)}}async deleteVendor(e){let t=e.vendor_name||e.name||"\u672A\u77E5\u5EE0\u5546";if(!confirm(`\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u5EE0\u5546 "${t}" \u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002`))return;let i=e.vendor_id||e.id;if(!i){this.errorMessage.set("\u5EE0\u5546 ID \u4E0D\u5B58\u5728\uFF0C\u7121\u6CD5\u522A\u9664");return}this.isLoading.set(!0),this.errorMessage.set(null);try{let r=await this.apiService.deleteVendor(i);r.success?await this.loadData():this.errorMessage.set(r.error||"\u522A\u9664\u5EE0\u5546\u5931\u6557")}catch(r){console.error("Error deleting vendor:",r),this.errorMessage.set("\u522A\u9664\u5EE0\u5546\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoading.set(!1)}}formatCurrency(e){return e==null?"":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}};Ys.\u0275fac=function(t){return new(t||Ys)},Ys.\u0275cmp=ie({type:Ys,selectors:[["app-vendors"]],decls:51,vars:13,consts:[[1,"space-y-6"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-4","flex","items-center","gap-3"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4","flex","items-center","gap-3"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["name","add-outline"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"space-y-4"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4","p-4","bg-gray-50","rounded-lg"],[1,"lg:col-span-2"],["type","text","placeholder","\u641C\u5C0B\u5EE0\u5546\u540D\u7A31\u3001\u985E\u5225\u6216\u806F\u7D61\u65B9\u5F0F...",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["value",""],[3,"value"],["type","text","placeholder","\u7D71\u4E00\u7DE8\u865F (8\u78BC)","maxlength","8","pattern","\\d*",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"input","value"],[1,"flex","items-center","gap-2","lg:col-span-4","justify-end"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-4","py-3"],[1,"border-b","hover:bg-gray-50","cursor-pointer","transition-colors"],[1,"flex","flex-col","sm:flex-row","items-center","justify-between","gap-3","pt-4"],[1,"text-sm","text-gray-600"],[1,"flex","items-center","gap-2"],["type","button",1,"px-3","py-1.5","text-sm","border","rounded-md","disabled:opacity-50","disabled:cursor-not-allowed","hover:bg-gray-50",3,"click","disabled"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],["name","hourglass-outline",1,"text-blue-600","text-xl","animate-spin"],[1,"text-blue-700"],["name","alert-circle-outline",1,"text-red-600","text-xl"],[1,"text-red-700"],[1,"border-b","hover:bg-gray-50","cursor-pointer","transition-colors",3,"click"],[1,"px-4","py-2"],[1,"px-4","py-2","font-medium"],["colspan","4",1,"text-center","py-8","text-gray-500"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-lg","max-h-[90vh]","flex","flex-col"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],[1,"space-y-4",3,"ngSubmit","formGroup"],["type","hidden","formControlName","vendor_id"],[1,"block"],[1,"text-gray-700"],["formControlName","category",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","vendor_name",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","tax_id","type","text","maxlength","8","pattern","\\d*","placeholder","8\u4F4D\u6578\u5B57",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","contact_info",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","rest_days","placeholder","\u4F8B\uFF1A\u5468\u4E00,\u5468\u4E8C",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-3","flex","items-center","gap-2"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md","disabled:opacity-50","disabled:cursor-not-allowed","hover:bg-gray-50",3,"click","disabled"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","hover:bg-indigo-700","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","gap-2",3,"disabled"],["name","alert-circle-outline",1,"text-red-600","text-lg"],[1,"text-red-700","text-sm"],["name","hourglass-outline",1,"animate-spin"]],template:function(t,i){t&1&&(l(0,"div",0),A(1,w9,4,0,"div",1),A(2,T9,4,1,"div",2),l(3,"div",3)(4,"h1",4),c(5,"\u5EE0\u5546\u7BA1\u7406"),a(),l(6,"button",5),b("click",function(){return i.openModal()}),x(7,"ion-icon",6),l(8,"span"),c(9,"\u65B0\u589E\u5EE0\u5546"),a()()(),l(10,"div",7)(11,"div",8)(12,"div",9)(13,"div",10)(14,"input",11),b("ngModelChange",function(o){return i.vendorSearchTerm.set(o),i.currentPage.set(1)}),a()(),l(15,"div")(16,"select",12),b("ngModelChange",function(o){return i.selectedVendorCategory.set(o),i.currentPage.set(1)}),l(17,"option",13),c(18,"\u6240\u6709\u985E\u5225"),a(),O(19,I9,2,2,"option",14,W),a()(),l(21,"div")(22,"input",15),b("input",function(o){return i.onTaxIdInput(o)}),a()(),l(23,"div",16)(24,"button",17),b("click",function(){return i.resetVendorFilters()}),x(25,"ion-icon",18),a()()(),l(26,"div",19)(27,"table",20)(28,"thead",21)(29,"tr")(30,"th",22),c(31,"\u985E\u5225"),a(),l(32,"th",22),c(33,"\u5EE0\u5546"),a(),l(34,"th",22),c(35,"\u806F\u7D61\u65B9\u5F0F"),a(),l(36,"th",22),c(37,"\u4F11\u606F\u6642\u9593"),a()()(),l(38,"tbody"),O(39,N9,10,4,"tr",23,D9,!1,R9,3,0,"tr"),a()()(),l(42,"div",24)(43,"div",25),c(44),a(),l(45,"div",26)(46,"button",27),b("click",function(){return i.goToPrevPage()}),c(47," \u4E0A\u4E00\u9801 "),a(),l(48,"button",27),b("click",function(){return i.goToNextPage()}),c(49," \u4E0B\u4E00\u9801 "),a()()()()()(),A(50,V9,37,6,"div",28)),t&2&&(f(),N(i.isLoading()?1:-1),f(),N(i.errorMessage()?2:-1),f(4),M("disabled",i.isLoading()),f(8),M("ngModel",i.vendorSearchTerm()),f(2),M("ngModel",i.selectedVendorCategory()),f(3),L(i.vendorCategories()),f(3),M("value",i.vendorTaxIdFilter()),f(17),L(i.pagedVendors()),f(5),kt(" \u7B2C ",i.currentPage()," / ",i.totalPages()," \u9801\uFF0C\u5171 ",i.totalRecords()," \u7B46 "),f(2),M("disabled",i.currentPage()===1),f(2),M("disabled",i.currentPage()===i.totalPages()),f(2),N(i.isModalOpen()?50:-1))},dependencies:[re,Oe,$e,ke,Ve,Ce,Ae,me,Fe,$l,Hl,Pe,Be,be,Ie],encapsulation:2,changeDetection:0});var lp=Ys;var Hb=(n,e)=>e.id,e_=(n,e)=>e.name;function O9(n,e){if(n&1&&(l(0,"option",18),c(1),a()),n&2){let t=e.$implicit;M("value",t.id),f(),E(t.name)}}function L9(n,e){n&1&&(l(0,"div",26),x(1,"ion-icon",34),l(2,"span"),c(3,"\u8F09\u5165\u9032\u8CA8\u55AE\u8CC7\u6599\u4E2D..."),a()())}function B9(n,e){if(n&1&&(l(0,"div",27)(1,"div",10),x(2,"ion-icon",35),l(3,"span"),c(4),a()()()),n&2){let t=v(2);f(4),E(t.shipmentError())}}function U9(n,e){if(n&1&&(c(0),qt(1,"number")),n&2){let t=v().$implicit;V(" ",an(1,1,t.qty,"1.2-2")," ")}}function $9(n,e){n&1&&c(0," - ")}function H9(n,e){if(n&1&&c(0),n&2){let t=v().$implicit,i=v(2);V(" ",i.formatCurrency(t.unitPrice)," ")}}function G9(n,e){n&1&&c(0," - ")}function q9(n,e){if(n&1&&c(0),n&2){let t=v().$implicit,i=v(2);V(" ",i.formatCurrency(t.lineAmount)," ")}}function W9(n,e){n&1&&c(0," - ")}function j9(n,e){if(n&1){let t=B();l(0,"tr",36),b("click",function(){let r=w(t).$implicit,o=v(2);return T(o.openShipmentEditModal(r))}),l(1,"td",37),c(2),a(),l(3,"td",38),c(4),a(),l(5,"td",37),c(6),a(),l(7,"td",39),A(8,U9,2,4)(9,$9,1,0),a(),l(10,"td",39),c(11),a(),l(12,"td",39),A(13,H9,1,1)(14,G9,1,0),a(),l(15,"td",40),A(16,q9,1,1)(17,W9,1,0),a(),l(18,"td",41),c(19),a()()}if(n&2){let t=e.$implicit,i=v(2);f(2),E(i.formatDate(t.issueDate)),f(2),E(t.vendorName),f(2),E(t.itemName),f(2),N(t.qty!==null?8:9),f(3),E(t.unit||"-"),f(2),N(t.unitPrice!==null?13:14),f(3),N(t.lineAmount!==null?16:17),f(3),E(t.remark||"-")}}function z9(n,e){n&1&&(l(0,"tr")(1,"td",42),c(2,"\u672A\u627E\u5230\u9032\u8CA8\u55AE\u8CC7\u6599\u3002"),a()())}function Y9(n,e){if(n&1&&(l(0,"div",4),A(1,L9,4,0,"div",26),A(2,B9,5,1,"div",27),l(3,"div",28)(4,"table",29)(5,"thead",30)(6,"tr")(7,"th",31),c(8,"\u958B\u7ACB\u65E5\u671F"),a(),l(9,"th",31),c(10,"\u5EE0\u5546"),a(),l(11,"th",31),c(12,"\u54C1\u9805\u540D\u7A31"),a(),l(13,"th",32),c(14,"\u6578\u91CF"),a(),l(15,"th",32),c(16,"\u55AE\u4F4D"),a(),l(17,"th",32),c(18,"\u55AE\u50F9"),a(),l(19,"th",32),c(20,"\u5C0F\u8A08"),a(),l(21,"th",31),c(22,"\u5099\u8A3B"),a()()(),l(23,"tbody"),O(24,j9,20,8,"tr",33,bn,!1,z9,3,0,"tr"),a()()()()),n&2){let t=v();f(),N(t.isLoadingShipments()?1:-1),f(),N(!t.isLoadingShipments()&&t.shipmentError()?2:-1),f(22),L(t.pagedShipments())}}function J9(n,e){if(n&1){let t=B();Li(),l(0,"g",59),b("mouseenter",function(){w(t);let r=v().$implicit,o=v(4);return T(o.hoveredVendor.set(r.name))})("mouseleave",function(){w(t);let r=v(5);return T(r.hoveredVendor.set(null))}),x(1,"path",60),a()}if(n&2){let t=v(),i=t.$implicit,r=t.$index,o=v(4);f(),ft("d",o.getPieSlicePath(r,o.pieChartData()))("fill",o.getPieColor(r,o.pieChartData().length))("opacity",o.hoveredVendor()===i.name?"1":"0.8")("stroke",o.hoveredVendor()===i.name?"#000":"none")}}function K9(n,e){if(n&1&&A(0,J9,2,4,":svg:g"),n&2){let t=e.$implicit;N(t.percentage>0?0:-1)}}function Q9(n,e){if(n&1&&(l(0,"div",61)(1,"div",62),c(2),a(),l(3,"div",63),c(4),a(),l(5,"div",64),c(6),qt(7,"number"),a()()),n&2){let t=v().$implicit,i=v(5);f(2),E(t.name),f(2),E(i.formatCurrency(t.amount)),f(2),V("",an(7,3,t.percentage,"1.1-1"),"%")}}function Z9(n,e){if(n&1&&A(0,Q9,8,6,"div",61),n&2){let t=e.$implicit,i=v(5);N(t.name===i.hoveredVendor()?0:-1)}}function X9(n,e){if(n&1&&O(0,Z9,1,1,null,null,e_),n&2){let t=v(4);L(t.pieChartData())}}function eB(n,e){n&1&&(l(0,"div",57),c(1,"\u6ED1\u9F20\u79FB\u5230\u5713\u9905\u5716\u5207\u7247\u4EE5\u67E5\u770B\u660E\u7D30"),a())}function tB(n,e){if(n&1&&(l(0,"div",10),x(1,"div",65),l(2,"div",66)(3,"div",67),c(4),a(),l(5,"div",68),c(6),a()()()),n&2){let t=e.$implicit,i=v(4);f(),gn("background-color",i.getVendorColor(t.name)),f(3),E(t.name),f(2),E(i.formatCurrency(t.amount))}}function nB(n,e){if(n&1&&(l(0,"div",51)(1,"div",52),c(2,"\u5EE0\u5546\u9032\u8CA8\u91D1\u984D\u5206\u4F48"),a(),l(3,"div",53)(4,"div",54),Li(),l(5,"svg",55),O(6,K9,1,1,null,null,e_),a()(),Hr(),l(8,"div",56),A(9,X9,2,0)(10,eB,2,0,"div",57),a()(),l(11,"div",58),O(12,tB,7,4,"div",10,e_),a()()),n&2){let t=v(3);f(6),L(t.pieChartData()),f(3),N(t.hoveredVendor()?9:10),f(3),L(t.vendorAmountEntries())}}function iB(n,e){if(n&1&&(l(0,"div",44)(1,"div",45)(2,"div",46),c(3,"\u9032\u8CA8\u9805\u76EE\u6578"),a(),l(4,"div",47),c(5),a()(),l(6,"div",48)(7,"div",49),c(8,"\u9032\u8CA8\u7E3D\u91D1\u984D"),a(),l(9,"div",50),c(10),a()()(),A(11,nB,14,1,"div",51)),n&2){let t=v(2);f(5),E(t.shipmentStats().totalItems),f(5),E(t.formatCurrency(t.shipmentStats().totalAmount)),f(),N(t.vendorAmountEntries().length>0&&t.shipmentStats().totalAmount>0?11:-1)}}function rB(n,e){n&1&&(l(0,"div",43),c(1,"\u5C1A\u7121\u53EF\u5206\u6790\u7684\u9032\u8CA8\u55AE\u8CC7\u6599\u3002"),a())}function oB(n,e){if(n&1&&(l(0,"div",4),A(1,iB,12,3)(2,rB,2,0,"div",43),a()),n&2){let t=v();f(),N(!t.isLoadingShipments()&&!t.shipmentError()&&t.filteredShipments().length>0?1:2)}}function sB(n,e){if(n&1){let t=B();l(0,"div",24)(1,"div",64),c(2),a(),l(3,"div",10)(4,"button",70),b("click",function(){w(t);let r=v(2);return T(r.setShipmentPage(r.shipmentPage()-1))}),c(5,"\u4E0A\u4E00\u9801"),a(),l(6,"button",70),b("click",function(){w(t);let r=v(2);return T(r.setShipmentPage(r.shipmentPage()+1))}),c(7,"\u4E0B\u4E00\u9801"),a()()()}if(n&2){let t=v(2);f(2),kt(" \u7B2C ",t.shipmentPage()," / ",t.shipmentTotalPages()," \u9801\uFF0C\u5171 ",t.filteredShipments().length," \u7B46 "),f(2),z("text-gray-400",t.shipmentPage()===1),M("disabled",t.shipmentPage()===1),f(2),z("text-gray-400",t.shipmentPage()===t.shipmentTotalPages()),M("disabled",t.shipmentPage()===t.shipmentTotalPages())}}function aB(n,e){if(n&1&&Pt(0,sB,8,9,"div",69),n&2){let t=v();M("ngIf",t.shipmentTotalPages()>1)}}function lB(n,e){if(n&1&&(l(0,"option",18),c(1),a()),n&2){let t=e.$implicit;M("value",t.id),f(),E(t.name)}}function uB(n,e){if(n&1){let t=B();l(0,"div",91),x(1,"input",97)(2,"input",98)(3,"input",99),l(4,"span",88),c(5),a(),l(6,"button",100),b("click",function(){let r=w(t).$index,o=v(2);return T(o.removeItem(r))}),x(7,"ion-icon",101),a()()}if(n&2){let t,i=e.$implicit,r=e.$index,o=v(2);M("formGroupName",r),f(5),E(o.formatCurrency((t=i.get("total"))==null?null:t.value))}}function dB(n,e){if(n&1){let t=B();l(0,"div",25)(1,"div",71)(2,"div",72)(3,"h3",73),c(4),a(),l(5,"button",74),b("click",function(){w(t);let r=v();return T(r.closeModal())}),x(6,"ion-icon",75),a()(),l(7,"div",76)(8,"form",77),b("ngSubmit",function(){w(t);let r=v();return T(r.handlePOSubmit())}),l(9,"div",78)(10,"label",79)(11,"span",80),c(12,"\u9032\u8CA8\u55AE\u865F*"),a(),x(13,"input",81),a(),l(14,"label",79)(15,"span",80),c(16,"\u65E5\u671F*"),a(),x(17,"input",82),a()(),l(18,"label",79)(19,"span",80),c(20,"\u5EE0\u5546*"),a(),l(21,"select",83)(22,"option",84),c(23,"\u9078\u64C7\u5EE0\u5546"),a(),O(24,lB,2,2,"option",18,Hb),a()(),l(26,"h4",85),c(27,"\u54C1\u9805"),a(),l(28,"div",86)(29,"div",87),c(30,"\u54C1\u9805\u540D\u7A31"),a(),l(31,"div",88),c(32,"\u6578\u91CF"),a(),l(33,"div",88),c(34,"\u55AE\u50F9"),a(),l(35,"div",88),c(36,"\u5C0F\u8A08"),a(),x(37,"div",89),a(),l(38,"div",90),O(39,uB,8,2,"div",91,bn),a(),l(41,"button",92),b("click",function(){w(t);let r=v();return T(r.addItem())}),c(42,"+ \u65B0\u589E\u54C1\u9805"),a(),l(43,"div",93),c(44),a(),l(45,"div",94)(46,"button",95),b("click",function(){w(t);let r=v();return T(r.closeModal())}),c(47,"\u53D6\u6D88"),a(),l(48,"button",96),c(49,"\u5132\u5B58"),a()()()()()()}if(n&2){let t,i=v();f(4),E(i.editingPO()?"\u7DE8\u8F2F\u9032\u8CA8\u55AE":"\u65B0\u589E\u9032\u8CA8\u55AE"),f(4),M("formGroup",i.poForm),f(16),L(i.allVendors()),f(15),L(i.poItems.controls),f(5),V("\u7E3D\u8A08: ",i.formatCurrency((t=i.poForm.get("totalAmount"))==null?null:t.value))}}function cB(n,e){if(n&1){let t=B();l(0,"div",4)(1,"div",78)(2,"label",79)(3,"span",102),c(4,"\u958B\u7ACB\u65E5\u671F*"),a(),l(5,"input",103),Z("ngModelChange",function(r){w(t);let o=v(2);return ee(o.editingShipmentItem().issueDate,r)||(o.editingShipmentItem().issueDate=r),T(r)}),a()(),l(6,"label",79)(7,"span",102),c(8,"\u5EE0\u5546*"),a(),l(9,"input",104),Z("ngModelChange",function(r){w(t);let o=v(2);return ee(o.editingShipmentItem().vendorName,r)||(o.editingShipmentItem().vendorName=r),T(r)}),a()()(),l(10,"label",79)(11,"span",102),c(12,"\u54C1\u9805\u540D\u7A31*"),a(),l(13,"input",105),Z("ngModelChange",function(r){w(t);let o=v(2);return ee(o.editingShipmentItem().itemName,r)||(o.editingShipmentItem().itemName=r),T(r)}),a()(),l(14,"div",106)(15,"label",79)(16,"span",102),c(17,"\u6578\u91CF"),a(),l(18,"input",107),Z("ngModelChange",function(r){w(t);let o=v(2);return ee(o.editingShipmentItem().qty,r)||(o.editingShipmentItem().qty=r),T(r)}),a()(),l(19,"label",79)(20,"span",102),c(21,"\u55AE\u4F4D"),a(),l(22,"input",105),Z("ngModelChange",function(r){w(t);let o=v(2);return ee(o.editingShipmentItem().unit,r)||(o.editingShipmentItem().unit=r),T(r)}),a()(),l(23,"label",79)(24,"span",102),c(25,"\u55AE\u50F9"),a(),l(26,"input",107),Z("ngModelChange",function(r){w(t);let o=v(2);return ee(o.editingShipmentItem().unitPrice,r)||(o.editingShipmentItem().unitPrice=r),T(r)}),a()()(),l(27,"label",79)(28,"span",102),c(29,"\u5C0F\u8A08"),a(),l(30,"input",108),Z("ngModelChange",function(r){w(t);let o=v(2);return ee(o.editingShipmentItem().lineAmount,r)||(o.editingShipmentItem().lineAmount=r),T(r)}),a()(),l(31,"label",79)(32,"span",102),c(33,"\u5099\u8A3B"),a(),l(34,"textarea",109),Z("ngModelChange",function(r){w(t);let o=v(2);return ee(o.editingShipmentItem().remark,r)||(o.editingShipmentItem().remark=r),T(r)}),a()()(),l(35,"div",94)(36,"button",110),b("click",function(){w(t);let r=v(2);return T(r.closeShipmentEditModal())}),c(37," \u53D6\u6D88 "),a(),l(38,"button",111),b("click",function(){w(t);let r=v(2);return T(r.saveShipmentEdit())}),c(39),a()()}if(n&2){let t=v(2);f(5),Q("ngModel",t.editingShipmentItem().issueDate),f(4),Q("ngModel",t.editingShipmentItem().vendorName),f(4),Q("ngModel",t.editingShipmentItem().itemName),f(5),Q("ngModel",t.editingShipmentItem().qty),f(4),Q("ngModel",t.editingShipmentItem().unit),f(4),Q("ngModel",t.editingShipmentItem().unitPrice),f(4),Q("ngModel",t.editingShipmentItem().lineAmount),f(4),Q("ngModel",t.editingShipmentItem().remark),f(4),M("disabled",t.isLoadingShipments()),f(),V(" ",t.isLoadingShipments()?"\u4FDD\u5B58\u4E2D...":"\u4FDD\u5B58"," ")}}function mB(n,e){if(n&1){let t=B();l(0,"div",25)(1,"div",71)(2,"div",72)(3,"h3",73),c(4,"\u7DE8\u8F2F\u9032\u8CA8\u55AE\u9805\u76EE"),a(),l(5,"button",74),b("click",function(){w(t);let r=v();return T(r.closeShipmentEditModal())}),x(6,"ion-icon",75),a()(),l(7,"div",76),A(8,cB,40,10),a()()()}if(n&2){let t=v();f(8),N(t.editingShipmentItem()?8:-1)}}var Js=class Js{constructor(){this.dataService=P(Tt);this.apiService=P(rt);this.fb=P(He);this.isModalOpen=S(!1);this.isEditModalOpen=S(!1);this.editingShipmentItem=S(null);this.allVendors=S([]);this.allPOs=S([]);this.editingPO=S(null);this.shipmentItems=S([]);this.isLoadingShipments=S(!1);this.shipmentError=S(null);this.poForm=this.fb.group({id:[""],poNumber:["",U.required],vendorId:["",U.required],date:["",U.required],items:this.fb.array([]),totalAmount:[0]});this.poSearchTerm=S("");this.selectedPOVendor=S("");this.today=new Date;this.firstDayOfMonth=new Date(this.today.getFullYear(),this.today.getMonth(),1);this.poStartDate=S(this.formatDateToISO(this.firstDayOfMonth));this.poEndDate=S(this.formatDateToISO(this.today));this.currentTab=S("api");this.shipmentPage=S(1);this.pageSize=20;this.pagedShipments=H(()=>{let e=this.filteredShipments(),t=(this.shipmentPage()-1)*this.pageSize;return e.slice(t,t+this.pageSize)});this.shipmentTotalPages=H(()=>{let e=this.filteredShipments().length;return Math.max(1,Math.ceil(e/this.pageSize))});this.filteredPOs=H(()=>{let e=this.poSearchTerm().toLowerCase(),t=this.selectedPOVendor(),i=this.poStartDate(),r=this.poEndDate(),o=this.allPOs();return t&&(o=o.filter(s=>s.vendorId===t)),i&&(o=o.filter(s=>s.date>=i)),r&&(o=o.filter(s=>s.date<=r)),e&&(o=o.filter(s=>s.poNumber.toLowerCase().includes(e)||this.getVendorName(s.vendorId).toLowerCase().includes(e))),o});this.filteredShipments=H(()=>{let e=this.poSearchTerm().toLowerCase(),t=this.selectedPOVendor(),i=this.poStartDate(),r=this.poEndDate(),o=this.shipmentItems();return t&&(o=o.filter(s=>s.vendorId.toString()===t)),i&&(o=o.filter(s=>s.issueDate>=i)),r&&(o=o.filter(s=>s.issueDate<=r)),e&&(o=o.filter(s=>(s.documentNo?.toLowerCase().includes(e)??!1)||s.itemName.toLowerCase().includes(e)||s.vendorName.toLowerCase().includes(e))),o});this.shipmentStats=H(()=>{let e=this.filteredShipments(),t=e.reduce((r,o)=>r+Number(o.lineAmount||0),0),i={};return e.forEach(r=>{let o=r.vendorName;i[o]=(i[o]||0)+Number(r.lineAmount||0)}),{totalAmount:t,totalItems:e.length,vendorAmounts:i}});this.pieChartData=H(()=>{let e=this.shipmentStats(),t=Object.keys(e.vendorAmounts).sort(),i=e.totalAmount;return t.map(r=>({name:r,amount:e.vendorAmounts[r],percentage:i>0?e.vendorAmounts[r]/i*100:0}))});this.hoveredVendor=S(null);this.vendorAmountEntries=H(()=>{let e=this.shipmentStats();return Object.entries(e.vendorAmounts).map(([t,i])=>({name:t,amount:i})).sort((t,i)=>i.amount-t.amount)});this.loadData(),this.loadShipments(),this.poItems.valueChanges.subscribe(e=>{let t=e.reduce((i,r)=>i+(r.quantity||0)*(r.unitPrice||0),0);this.poForm.get("totalAmount")?.setValue(t,{emitEvent:!1})})}setShipmentPage(e){e<1||e>this.shipmentTotalPages()||this.shipmentPage.set(e)}setTab(e){this.currentTab.set(e)}loadData(){this.allVendors.set(this.dataService.getVendors()),this.allPOs.set(this.dataService.getPurchaseOrders())}async loadShipments(){this.isLoadingShipments.set(!0),this.shipmentError.set(null);try{let e={limit:1e3,offset:0};this.poStartDate()&&(e.startDate=this.poStartDate()),this.poEndDate()&&(e.endDate=this.poEndDate());let t=await this.apiService.getShipmentItems(e);t.success&&t.data?this.shipmentItems.set(t.data):this.shipmentError.set(t.error||"\u7121\u6CD5\u7372\u53D6\u9032\u8CA8\u55AE\u8CC7\u6599")}catch(e){console.error("Error loading shipments:",e),this.shipmentError.set("\u8F09\u5165\u9032\u8CA8\u55AE\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}finally{this.isLoadingShipments.set(!1)}}async applyShipmentFilter(){await this.loadShipments(),this.shipmentPage.set(1)}resetPOFilters(){this.poSearchTerm.set(""),this.selectedPOVendor.set(""),this.poStartDate.set(""),this.poEndDate.set("")}openModal(e=null){this.editingPO.set(e),this.poForm.reset({totalAmount:0}),this.poItems.clear(),e&&(this.poForm.patchValue(e),e.items.forEach(t=>this.addItem(t.productName,t.quantity,t.unitPrice))),this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1),this.editingPO.set(null)}openShipmentEditModal(e){this.editingShipmentItem.set(e),this.isEditModalOpen.set(!0)}closeShipmentEditModal(){this.isEditModalOpen.set(!1),this.editingShipmentItem.set(null)}async saveShipmentEdit(){let e=this.editingShipmentItem();if(e)try{this.isLoadingShipments.set(!0);let t=await this.apiService.updateShipmentItem(e.shipment_id,{itemName:e.itemName,qty:e.qty||void 0,unitPrice:e.unitPrice||void 0,unit:e.unit||void 0,remark:e.remark||void 0});if(t.success&&t.data){let i=this.shipmentItems().map(r=>r.shipment_id===e.shipment_id?t.data:r);this.shipmentItems.set(i),this.shipmentPage.set(1),this.closeShipmentEditModal(),alert("\u9032\u8CA8\u55AE\u9805\u76EE\u5DF2\u6210\u529F\u66F4\u65B0")}else throw new Error(t.error||"\u66F4\u65B0\u5931\u6557")}catch(t){console.error("Error saving shipment item:",t),alert("\u4FDD\u5B58\u9032\u8CA8\u55AE\u9805\u76EE\u5931\u6557\uFF1A"+(t instanceof Error?t.message:"\u672A\u77E5\u932F\u8AA4"))}finally{this.isLoadingShipments.set(!1)}}createItem(e="",t=1,i=0){let r=this.fb.group({productName:[e,U.required],quantity:[t,[U.required,U.min(1)]],unitPrice:[i,[U.required,U.min(0)]],total:[t*i]});return r.get("quantity")?.valueChanges.subscribe(()=>this.updateItemTotal(r)),r.get("unitPrice")?.valueChanges.subscribe(()=>this.updateItemTotal(r)),r}updateItemTotal(e){let t=e.get("quantity")?.value||0,i=e.get("unitPrice")?.value||0;e.get("total")?.setValue(t*i,{emitEvent:!1})}addItem(e="",t=1,i=0){this.poItems.push(this.createItem(e,t,i))}removeItem(e){this.poItems.removeAt(e)}handlePOSubmit(){if(this.poForm.invalid)return;let e=this.poForm.getRawValue(),t={poNumber:e.poNumber,vendorId:e.vendorId,date:e.date,items:e.items,totalAmount:e.totalAmount};this.editingPO()?this.dataService.updatePurchaseOrder(q(k({},t),{id:this.editingPO().id})):this.dataService.addPurchaseOrder(t),this.loadData(),this.closeModal()}deletePurchaseOrder(e){confirm("\u78BA\u5B9A\u8981\u522A\u9664\u6B64\u9032\u8CA8\u55AE\u55CE\uFF1F")&&(this.dataService.deletePurchaseOrder(e),this.loadData())}getVendorName(e){let t=e.toString();return this.allVendors().find(i=>i.id===t)?.name||"N/A"}formatCurrency(e){return e==null?"":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}formatDate(e){if(!e)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;let t=new Date(e);return Number.isNaN(t.getTime())?"":this.formatDateToISO(t)}formatDateToISO(e){let t=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return`${t}-${i}-${r}`}get poItems(){return this.poForm.get("items")}getPieColor(e,t){let i=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#EC4899","#14B8A6","#F97316","#6366F1","#06B6D4","#84CC16","#D946EF"];return i[e%i.length]}getVendorColor(e){let t=this.pieChartData(),i=t.findIndex(r=>r.name===e);return i<0?"#9CA3AF":this.getPieColor(i,t.length)}getPieSlicePath(e,t){let s=0;for(let R=0;R<e;R++)s+=t[R].percentage*360/100;let u=t[e].percentage*360/100,d=s+u,m=s*Math.PI/180,h=d*Math.PI/180,y=200+120*Math.cos(m),_=200+120*Math.sin(m),C=200+120*Math.cos(h),D=200+120*Math.sin(h),I=u>180?1:0;return`M 200 200 L ${y} ${_} A 120 120 0 ${I} 1 ${C} ${D} Z`}};Js.\u0275fac=function(t){return new(t||Js)},Js.\u0275cmp=ie({type:Js,selectors:[["app-purchase-orders"]],decls:39,vars:17,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"space-y-4"],[1,"flex","border-b","border-gray-200","gap-2","mb-4"],["type","button",1,"pb-2","px-4","font-medium","border-b-2","border-transparent","hover:text-indigo-600",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4","p-4","bg-gray-50","rounded-lg"],[1,"lg:col-span-4"],["type","text","placeholder","\u641C\u5C0B\u9032\u8CA8\u55AE\u865F\u3001\u54C1\u9805\u6216\u5EE0\u5546...",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"flex","items-center","gap-2"],["for","poStartDate",1,"text-sm","font-medium","text-gray-600","shrink-0"],["type","date","id","poStartDate",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["for","poEndDate",1,"text-sm","font-medium","text-gray-600","shrink-0"],["type","date","id","poEndDate",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"lg:col-span-2"],[1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"flex","items-center","gap-2","lg:col-span-4","justify-end","gap-2"],["title","\u5957\u7528\u7BE9\u9078",1,"bg-indigo-600","text-white","px-3","py-1","rounded","text-sm","hover:bg-indigo-700","transition-colors","flex","items-center","gap-1",3,"click"],["name","checkmark-outline"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"flex","flex-col","sm:flex-row","justify-between","items-center","gap-3","mt-4"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"flex","items-center","justify-center","py-12","text-gray-500"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4","text-red-700"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-4","py-3"],[1,"px-4","py-3","text-right"],[1,"border-b","hover:bg-gray-50","cursor-pointer"],["name","refresh-outline",1,"text-3xl","animate-spin","mr-2"],["name","alert-circle-outline",1,"text-xl"],[1,"border-b","hover:bg-gray-50","cursor-pointer",3,"click"],[1,"px-4","py-2"],[1,"px-4","py-2","font-medium"],[1,"px-4","py-2","text-right"],[1,"px-4","py-2","text-right","font-semibold"],[1,"px-4","py-2","text-gray-600","text-xs"],["colspan","8",1,"text-center","py-8","text-gray-500"],[1,"text-center","py-8","text-gray-500"],[1,"grid","grid-cols-2","gap-4","mb-4"],[1,"bg-blue-50","p-3","rounded-lg"],[1,"text-xs","text-blue-600","font-medium"],[1,"text-xl","font-bold","text-blue-900"],[1,"bg-purple-50","p-3","rounded-lg"],[1,"text-xs","text-purple-600","font-medium"],[1,"text-xl","font-bold","text-purple-900"],[1,"bg-gray-50","p-4","rounded-lg"],[1,"text-xs","text-gray-600","font-medium","mb-4"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-4","items-center"],[1,"flex","items-center","justify-center","lg:col-span-2"],["viewBox","0 0 400 400",1,"w-64","h-64"],[1,"lg:col-span-1"],[1,"text-sm","text-gray-500"],[1,"mt-4","grid","grid-cols-2","md:grid-cols-3","gap-2","text-xs"],[3,"mouseenter","mouseleave"],["stroke-width","2",1,"cursor-pointer","transition-opacity"],[1,"bg-white","border","border-gray-200","rounded-lg","p-3","shadow-sm"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-lg","font-bold","text-blue-600"],[1,"text-sm","text-gray-600"],[1,"w-3","h-3","rounded-full"],[1,"truncate"],[1,"font-medium"],[1,"text-gray-600"],["class","flex flex-col sm:flex-row justify-between items-center gap-3 mt-4",4,"ngIf"],[1,"px-2","py-1","rounded","border","text-sm",3,"click","disabled"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-2xl","max-h-[90vh]","flex","flex-col"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"block"],[1,"text-gray-700"],["formControlName","poNumber",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["type","date","formControlName","date",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","vendorId",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["value","","disabled",""],[1,"font-semibold","pt-4","border-t"],[1,"grid","grid-cols-12","gap-2","px-2","pb-1","text-xs","font-medium","text-gray-500"],[1,"col-span-5"],[1,"col-span-2","text-right"],[1,"col-span-1"],["formArrayName","items",1,"space-y-2"],[1,"grid","grid-cols-12","gap-2","items-center","p-2","rounded-md","bg-gray-50",3,"formGroupName"],["type","button",1,"text-indigo-600","text-sm",3,"click"],[1,"text-right","font-bold","text-lg"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md"],["formControlName","productName","placeholder","\u54C1\u9805\u540D\u7A31",1,"col-span-5","p-1","border","border-gray-300","bg-white","rounded-md","shadow-sm"],["type","number","formControlName","quantity","placeholder","\u6578\u91CF",1,"col-span-2","p-1","border","border-gray-300","bg-white","rounded-md","shadow-sm","text-right"],["type","number","formControlName","unitPrice","placeholder","\u55AE\u50F9",1,"col-span-2","p-1","border","border-gray-300","bg-white","rounded-md","shadow-sm","text-right"],["type","button",1,"col-span-1","text-red-500",3,"click"],["name","remove-circle-outline"],[1,"text-gray-700","text-sm"],["type","date","disabled","",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","bg-gray-100","p-2","cursor-not-allowed","text-gray-600",3,"ngModelChange","ngModel"],["type","text","disabled","",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","bg-gray-100","p-2","cursor-not-allowed","text-gray-600",3,"ngModelChange","ngModel"],["type","text",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","bg-white","p-2",3,"ngModelChange","ngModel"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],["type","number",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","bg-white","p-2","text-right",3,"ngModelChange","ngModel"],["type","number","disabled","",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","bg-gray-100","p-2","text-right","cursor-not-allowed","text-gray-600",3,"ngModelChange","ngModel"],["rows","3",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","bg-white","p-2",3,"ngModelChange","ngModel"],["type","button",1,"px-4","py-2","border","border-gray-300","rounded-md","hover:bg-gray-50",3,"click"],["type","button",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","hover:bg-indigo-700","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"]],template:function(t,i){t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),c(3,"\u9032\u8CA8\u55AE\u7BA1\u7406"),a()(),l(4,"div",3)(5,"div",4)(6,"div",5)(7,"button",6),b("click",function(){return i.setTab("api")}),c(8," \u9032\u8CA8\u55AE\u8CC7\u6599 "),a(),l(9,"button",6),b("click",function(){return i.setTab("analysis")}),c(10," \u9032\u8CA8\u5206\u6790 "),a()(),l(11,"div",7)(12,"div",8)(13,"input",9),b("ngModelChange",function(o){return i.poSearchTerm.set(o)}),a()(),l(14,"div",10)(15,"label",11),c(16,"\u5F9E:"),a(),l(17,"input",12),b("ngModelChange",function(o){return i.poStartDate.set(o)}),a()(),l(18,"div",10)(19,"label",13),c(20,"\u81F3:"),a(),l(21,"input",14),b("ngModelChange",function(o){return i.poEndDate.set(o)}),a()(),l(22,"div",15)(23,"select",16),b("ngModelChange",function(o){return i.selectedPOVendor.set(o)}),l(24,"option",17),c(25,"\u6240\u6709\u5EE0\u5546"),a(),O(26,O9,2,2,"option",18,Hb),a()(),l(28,"div",19)(29,"button",20),b("click",function(){return i.applyShipmentFilter()}),x(30,"ion-icon",21),c(31," \u5957\u7528 "),a(),l(32,"button",22),b("click",function(){return i.resetPOFilters()}),x(33,"ion-icon",23),a()()(),A(34,Y9,27,3,"div",4),A(35,oB,3,1,"div",4),A(36,aB,1,1,"div",24),a()()(),A(37,dB,50,3,"div",25),A(38,mB,9,1,"div",25)),t&2&&(f(7),z("border-indigo-600",i.currentTab()==="api")("text-indigo-600",i.currentTab()==="api"),f(2),z("border-indigo-600",i.currentTab()==="analysis")("text-indigo-600",i.currentTab()==="analysis"),f(4),M("ngModel",i.poSearchTerm()),f(4),M("ngModel",i.poStartDate()),f(4),M("ngModel",i.poEndDate()),f(2),M("ngModel",i.selectedPOVendor()),f(3),L(i.allVendors()),f(8),N(i.currentTab()==="api"?34:-1),f(),N(i.currentTab()==="analysis"?35:-1),f(),N(i.currentTab()==="api"?36:-1),f(),N(i.isModalOpen()?37:-1),f(),N(i.isEditModalOpen()?38:-1))},dependencies:[re,ji,Oe,$e,ke,Ve,Ce,Ft,Ae,me,Fe,Pe,Be,wi,Ti,be,Ie,nl],encapsulation:2,changeDetection:0});var up=Js;var pB=(n,e)=>e.name,fB=(n,e)=>e.month,gB=(n,e)=>e.id;function hB(n,e){if(n&1&&(l(0,"option",7),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),V("",t,"\u5E74")}}function yB(n,e){if(n&1&&(l(0,"option",7),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),V("",t,"\u6708")}}function _B(n,e){if(n&1){let t=B();l(0,"tr",36),b("click",function(){let r=w(t).$implicit,o=v();return T(o.openHistoryModal(r))}),l(1,"td",37),c(2),a(),l(3,"td",33),c(4),a(),l(5,"td",33),c(6),a(),l(7,"td",33),c(8),a()()}if(n&2){let t=e.$implicit,i=v();f(2),E(t.name),f(2),E(i.formatCurrency(t.currentMonthRebate)),f(2),E(i.formatCurrency(t.unpaidRebate)),f(2),E(i.formatCurrency(t.cumulativeRebate))}}function vB(n,e){n&1&&(l(0,"tr")(1,"td",38),c(2," \u76EE\u524D\u6C92\u6709\u80A1\u6771\u56DE\u994B\u91D1\u8CC7\u6599\u3002 "),a()())}function CB(n,e){if(n&1){let t=B();l(0,"tr",36),b("click",function(){let r=w(t).$implicit,o=v(2);return T(o.openDetailModal(r))}),l(1,"td",50),c(2),a(),l(3,"td",49),c(4),a(),l(5,"td",49),c(6),a()()}if(n&2){let t=e.$implicit,i=v(2);f(2),ut("",t.year,"/",t.month),f(2),E(i.formatCurrency(t.totalRebate)),f(2),E(i.formatCurrency(t.unpaidRebate))}}function xB(n,e){n&1&&(l(0,"tr")(1,"td",51),c(2,"\u7121\u6B77\u53F2\u7D00\u9304"),a()())}function EB(n,e){if(n&1){let t=B();l(0,"div",39),b("click",function(){w(t);let r=v();return T(r.closeHistoryModal())}),l(1,"div",40),b("click",function(r){return w(t),T(r.stopPropagation())}),l(2,"div",41)(3,"h3",42),c(4),a(),l(5,"button",43),b("click",function(){w(t);let r=v();return T(r.closeHistoryModal())}),x(6,"ion-icon",44),a()(),l(7,"div",45)(8,"table",46)(9,"thead",47)(10,"tr")(11,"th",48),c(12,"\u6708\u4EFD"),a(),l(13,"th",49),c(14,"\u56DE\u994B\u91D1\u7E3D\u984D"),a(),l(15,"th",49),c(16,"\u672A\u4ED8\u91D1\u984D"),a()()(),l(17,"tbody"),O(18,CB,7,4,"tr",29,fB,!1,xB,3,0,"tr"),a()()()()()}if(n&2){let t=v();f(4),V("\u56DE\u994B\u91D1\u7D00\u9304 - ",e.name),f(14),L(t.monthlyHistory())}}function bB(n,e){n&1&&x(0,"ion-icon",66)}function SB(n,e){n&1&&x(0,"input",67)}function DB(n,e){if(n&1&&c(0),n&2){let t=v().$implicit,i=v(2);V(" ",i.formatCurrency(t.invoiceAmount)," ")}}function wB(n,e){n&1&&x(0,"input",68)}function TB(n,e){if(n&1&&c(0),n&2){let t=v().$implicit;V(" ",t.rebatePercentage,"% ")}}function IB(n,e){if(n&1){let t=B();l(0,"div",70)(1,"button",72),b("click",function(){w(t);let r=v(3);return T(r.saveEditing())}),x(2,"ion-icon",73),a(),l(3,"button",74),b("click",function(){w(t);let r=v(3);return T(r.cancelEditing())}),x(4,"ion-icon",75),a()()}}function MB(n,e){if(n&1){let t=B();l(0,"button",76),b("click",function(){w(t);let r=v().$implicit,o=v(2);return T(o.startEditing(r))}),x(1,"ion-icon",77),a()}}function AB(n,e){if(n&1&&(l(0,"tr",65)(1,"td",58),A(2,bB,1,0,"ion-icon",66),a(),l(3,"td",56),c(4),a(),l(5,"td",56),c(6),a(),l(7,"td",57),A(8,SB,1,0,"input",67)(9,DB,1,1),a(),l(10,"td",58),A(11,wB,1,0,"input",68)(12,TB,1,1),a(),l(13,"td",69),c(14),a(),l(15,"td",56),c(16),a(),l(17,"td",58),A(18,IB,5,0,"div",70)(19,MB,2,0,"button",71),a()()),n&2){let t=e.$implicit,i=v(2);z("bg-yellow-50",t.isEdited),f(2),N(t.isEdited?2:-1),f(2),E(t.checkoutTime),f(2),E(t.discountDetails),f(2),N(i.editingTxId()===t.id?8:9),f(3),N(i.editingTxId()===t.id?11:12),f(3),E(i.formatCurrency(t.rebateAmount)),f(2),E(t.discountUsed),f(2),N(i.editingTxId()===t.id?18:19)}}function NB(n,e){n&1&&(l(0,"tr")(1,"td",78),c(2,"\u6B64\u6708\u4EFD\u7121\u56DE\u994B\u91D1\u660E\u7D30"),a()())}function RB(n,e){if(n&1){let t=B();l(0,"div",52),b("click",function(){w(t);let r=v();return T(r.closeDetailModal())}),l(1,"div",53),b("click",function(r){return w(t),T(r.stopPropagation())}),l(2,"div",41)(3,"h3",42),c(4),a(),l(5,"button",43),b("click",function(){w(t);let r=v();return T(r.closeDetailModal())}),x(6,"ion-icon",44),a()(),l(7,"div",54)(8,"table",25)(9,"thead",26)(10,"tr"),x(11,"th",55),l(12,"th",56),c(13,"\u7D50\u5E33\u6642\u9593"),a(),l(14,"th",56),c(15,"\u6298\u6263\u91D1\u984D\u7D30\u9805"),a(),l(16,"th",57),c(17,"\u767C\u7968\u91D1\u984D"),a(),l(18,"th",58),c(19,"\u56DE\u994B%"),a(),l(20,"th",57),c(21,"\u56DE\u994B\u91D1"),a(),l(22,"th",56),c(23,"\u4F7F\u7528\u6298\u6263"),a(),l(24,"th",59),c(25,"\u64CD\u4F5C"),a()()(),l(26,"tbody"),O(27,AB,20,10,"tr",60,gB,!1,NB,3,0,"tr"),a(),l(30,"tfoot",61)(31,"tr")(32,"td",62),c(33,"\u7E3D\u56DE\u994B\u91D1:"),a(),l(34,"td",63),c(35),a(),x(36,"td",64),a()()()()()()}if(n&2){let t,i=e,r=v();f(4),kt("\u56DE\u994B\u91D1\u660E\u7D30 - ",(t=r.selectedShareholder())==null?null:t.name," (",i.year,"/",i.month,")"),f(3),M("formGroup",r.editForm),f(20),L(r.rebateTransactions()),f(8),E(r.formatCurrency(r.detailModalTotal()))}}var Ks=class Ks{constructor(){this.dataService=P(Tt);this.fb=P(He);this.rebates=S([]);this.availableYears=S([2024,2025,2026]);this.availableMonths=S(Array.from({length:12},(e,t)=>t+1));this.selectedYear=S(2024);this.selectedMonth=S(8);this.selectedShareholder=S(null);this.isHistoryModalOpen=S(!1);this.monthlyHistory=S([]);this.selectedHistoryEntry=S(null);this.isDetailModalOpen=S(!1);this.rebateTransactions=S([]);this.editingTxId=S(null);this.editForm=this.fb.group({invoiceAmount:[0,[U.required,U.min(0)]],rebatePercentage:[0,[U.required,U.min(0),U.max(100)]]});this.totals=H(()=>{let e=this.rebates();return{currentMonth:e.reduce((t,i)=>t+i.currentMonthRebate,0),unpaid:e.reduce((t,i)=>t+i.unpaidRebate,0),cumulative:e.reduce((t,i)=>t+i.cumulativeRebate,0)}});this.detailModalTotal=H(()=>this.rebateTransactions().reduce((e,t)=>e+t.rebateAmount,0));this.applyFilter()}applyFilter(){this.rebates.set(this.dataService.getShareholderRebates(this.selectedYear(),this.selectedMonth()))}resetFilter(){this.selectedYear.set(2024),this.selectedMonth.set(8),this.applyFilter()}openHistoryModal(e){this.selectedShareholder.set(e),this.monthlyHistory.set(this.dataService.getMonthlyRebateHistory(e.name)),this.isHistoryModalOpen.set(!0)}closeHistoryModal(){this.isHistoryModalOpen.set(!1),this.selectedShareholder.set(null),this.monthlyHistory.set([])}openDetailModal(e){let t=this.selectedShareholder()?.name;t&&(this.selectedHistoryEntry.set(e),this.rebateTransactions.set(this.dataService.getRebateTransactions(t,e.year,e.month)),this.isDetailModalOpen.set(!0))}closeDetailModal(){this.isDetailModalOpen.set(!1),this.selectedHistoryEntry.set(null),this.rebateTransactions.set([]),this.editingTxId.set(null)}startEditing(e){this.editingTxId.set(e.id),this.editForm.setValue({invoiceAmount:e.invoiceAmount,rebatePercentage:e.rebatePercentage})}cancelEditing(){this.editingTxId.set(null)}saveEditing(){let e=this.editingTxId(),t=this.rebateTransactions().find(s=>s.id===e);if(!e||!t||this.editForm.invalid)return;let i=this.editForm.value,r=Math.round(i.invoiceAmount*i.rebatePercentage/100),o=q(k({},t),{invoiceAmount:i.invoiceAmount,rebatePercentage:i.rebatePercentage,rebateAmount:r});this.dataService.updateRebateTransaction(o),this.refreshModalData(),this.editingTxId.set(null)}refreshModalData(){let e=this.selectedHistoryEntry(),t=this.selectedShareholder();e&&t&&this.rebateTransactions.set(this.dataService.getRebateTransactions(t.name,e.year,e.month)),t&&this.monthlyHistory.set(this.dataService.getMonthlyRebateHistory(t.name))}formatCurrency(e){return e==null?"":e.toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0})}};Ks.\u0275fac=function(t){return new(t||Ks)},Ks.\u0275cmp=ie({type:Ks,selectors:[["app-shareholder-rebates"]],decls:75,vars:11,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"flex","flex-col","sm:flex-row","items-center","gap-2","bg-white","p-3","rounded-xl","shadow-md","border","border-gray-200"],[1,"flex","items-center","gap-2"],[1,"text-sm","font-medium","text-gray-600"],[1,"border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-100","pr-8",3,"ngModelChange","ngModel"],[3,"value"],[1,"flex","items-center","gap-2","mt-2","sm:mt-0"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","filter-outline"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],[1,"bg-white","p-6","rounded-xl","shadow-md","flex","items-center","space-x-4"],[1,"bg-green-100","p-3","rounded-full"],["name","cash-outline",1,"text-2xl","text-green-600"],[1,"text-sm","text-gray-500"],[1,"text-2xl","font-semibold","text-gray-900"],[1,"bg-yellow-100","p-3","rounded-full"],["name","wallet-outline",1,"text-2xl","text-yellow-600"],[1,"bg-indigo-100","p-3","rounded-full"],["name","server-outline",1,"text-2xl","text-indigo-600"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-6","py-3"],[1,"px-6","py-3","text-right"],[1,"border-b","hover:bg-gray-50","cursor-pointer"],[1,"font-bold","bg-gray-100","text-base"],[1,"border-t-2"],[1,"px-6","py-4"],[1,"px-6","py-4","text-right"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-40"],[1,"fixed","inset-0","bg-black","bg-opacity-60","flex","items-center","justify-center","z-50"],[1,"border-b","hover:bg-gray-50","cursor-pointer",3,"click"],[1,"px-6","py-4","font-medium","text-gray-900"],["colspan","4",1,"text-center","py-8","text-gray-500"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-40",3,"click"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-2xl","max-h-[90vh]","flex","flex-col","m-4",3,"click"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],[1,"w-full","text-sm","text-left"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50"],[1,"px-4","py-2"],[1,"px-4","py-2","text-right"],[1,"px-4","py-2","font-medium"],["colspan","3",1,"text-center","py-6","text-gray-500"],[1,"fixed","inset-0","bg-black","bg-opacity-60","flex","items-center","justify-center","z-50",3,"click"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-5xl","max-h-[90vh]","flex","flex-col","m-4",3,"click"],[1,"p-6","overflow-y-auto",3,"formGroup"],[1,"px-2","py-2","w-12"],[1,"px-2","py-2"],[1,"px-2","py-2","text-right"],[1,"px-2","py-2","text-center"],[1,"px-2","py-2","w-24","text-center"],[1,"border-b",3,"bg-yellow-50"],[1,"font-bold","bg-gray-100"],["colspan","5",1,"px-2","py-3","text-right"],[1,"px-2","py-3","text-right"],["colspan","2"],[1,"border-b"],["name","pencil-outline","title","\u5DF2\u7DE8\u8F2F",1,"text-yellow-600"],["type","number","formControlName","invoiceAmount",1,"w-24","p-1","text-right","border","rounded-md","bg-white"],["type","number","formControlName","rebatePercentage",1,"w-16","p-1","text-right","border","rounded-md","bg-white"],[1,"px-2","py-2","text-right","font-semibold"],[1,"flex","items-center","justify-center","gap-1"],["title","\u7DE8\u8F2F",1,"text-indigo-600","p-1","hover:bg-indigo-100","rounded-full"],["title","\u5132\u5B58",1,"text-green-600","p-1","hover:bg-green-100","rounded-full",3,"click"],["name","checkmark-circle-outline",1,"text-xl"],["title","\u53D6\u6D88",1,"text-gray-500","p-1","hover:bg-gray-100","rounded-full",3,"click"],["name","close-circle-outline",1,"text-xl"],["title","\u7DE8\u8F2F",1,"text-indigo-600","p-1","hover:bg-indigo-100","rounded-full",3,"click"],["name","create-outline",1,"text-xl"],["colspan","8",1,"text-center","py-6","text-gray-500"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),c(3,"\u80A1\u6771\u56DE\u994B\u91D1"),a(),l(4,"div",3)(5,"div",4)(6,"label",5),c(7,"\u6642\u9593:"),a(),l(8,"select",6),Z("ngModelChange",function(o){return ee(i.selectedYear,o)||(i.selectedYear=o),o}),O(9,hB,2,2,"option",7,W),a(),l(11,"select",6),Z("ngModelChange",function(o){return ee(i.selectedMonth,o)||(i.selectedMonth=o),o}),O(12,yB,2,2,"option",7,W),a()(),l(14,"div",8)(15,"button",9),b("click",function(){return i.applyFilter()}),x(16,"ion-icon",10),l(17,"span"),c(18,"\u5957\u7528"),a()(),l(19,"button",11),b("click",function(){return i.resetFilter()}),x(20,"ion-icon",12),a()()()(),l(21,"div",13)(22,"div",14)(23,"div",15),x(24,"ion-icon",16),a(),l(25,"div")(26,"p",17),c(27,"\u7576\u6708\u56DE\u994B\u91D1 \u7E3D\u8A08"),a(),l(28,"p",18),c(29),a()()(),l(30,"div",14)(31,"div",19),x(32,"ion-icon",20),a(),l(33,"div")(34,"p",17),c(35,"\u7D2F\u8A08\u672A\u4ED8\u56DE\u994B\u91D1 \u7E3D\u8A08"),a(),l(36,"p",18),c(37),a()()(),l(38,"div",14)(39,"div",21),x(40,"ion-icon",22),a(),l(41,"div")(42,"p",17),c(43,"\u7D2F\u8A08\u7E3D\u56DE\u994B\u91D1 \u7E3D\u8A08"),a(),l(44,"p",18),c(45),a()()()(),l(46,"div",23)(47,"div",24)(48,"table",25)(49,"thead",26)(50,"tr")(51,"th",27),c(52,"\u540D\u7A31"),a(),l(53,"th",28),c(54,"\u7576\u6708\u56DE\u994B\u91D1"),a(),l(55,"th",28),c(56,"\u672A\u4ED8\u56DE\u994B\u91D1"),a(),l(57,"th",28),c(58,"\u7D2F\u8A08\u7E3D\u56DE\u994B\u91D1"),a()()(),l(59,"tbody"),O(60,_B,9,4,"tr",29,pB,!1,vB,3,0,"tr"),a(),l(63,"tfoot",30)(64,"tr",31)(65,"td",32),c(66,"\u7E3D\u8A08"),a(),l(67,"td",33),c(68),a(),l(69,"td",33),c(70),a(),l(71,"td",33),c(72),a()()()()()()(),A(73,EB,21,2,"div",34),A(74,RB,37,6,"div",35)),t&2){let r,o;f(8),Q("ngModel",i.selectedYear),f(),L(i.availableYears()),f(2),Q("ngModel",i.selectedMonth),f(),L(i.availableMonths()),f(17),E(i.formatCurrency(i.totals().currentMonth)),f(8),E(i.formatCurrency(i.totals().unpaid)),f(8),E(i.formatCurrency(i.totals().cumulative)),f(15),L(i.rebates()),f(8),E(i.formatCurrency(i.totals().currentMonth)),f(2),E(i.formatCurrency(i.totals().unpaid)),f(2),E(i.formatCurrency(i.totals().cumulative)),f(),N((r=i.isHistoryModalOpen()&&i.selectedShareholder())?73:-1,r),f(),N((o=i.isDetailModalOpen()&&i.selectedHistoryEntry())?74:-1,o)}},dependencies:[re,be,ke,Ve,Ce,Ft,Ae,me,Fe,Ie,Oe,Pe,Be],encapsulation:2,changeDetection:0});var dp=Ks;var FB=(n,e)=>e.id;function PB(n,e){if(n&1&&(l(0,"li"),c(1),a()),n&2){let t=v().$implicit;f(),E(t)}}function kB(n,e){if(n&1&&A(0,PB,2,1,"li"),n&2){let t=e.$implicit;N(t.trim()?0:-1)}}function VB(n,e){if(n&1&&(l(0,"div",28)(1,"h4",31),x(2,"ion-icon",32),c(3,"\u884C\u52D5\u4E8B\u9805"),a(),l(4,"ul",33),O(5,kB,1,1,null,null,W),a()()),n&2){let t=v(2).$implicit;f(5),L(t.actionItems.split(`
`))}}function OB(n,e){if(n&1&&(l(0,"li"),c(1),a()),n&2){let t=v().$implicit;f(),E(t)}}function LB(n,e){if(n&1&&A(0,OB,2,1,"li"),n&2){let t=e.$implicit;N(t.trim()?0:-1)}}function BB(n,e){if(n&1&&(l(0,"div",22)(1,"div",23)(2,"div",24)(3,"h4",25),x(4,"ion-icon",26),c(5,"\u8207\u6703\u4EBA\u54E1"),a(),l(6,"p",27),c(7),a()(),A(8,VB,7,0,"div",28),l(9,"div",24)(10,"h4",25),x(11,"ion-icon",29),c(12,"\u6703\u8B70\u8A18\u9304"),a(),l(13,"ul",30),O(14,LB,1,1,null,null,W),a()()()()),n&2){let t=v().$implicit;f(7),E(t.attendees),f(),N(t.actionItems?8:-1),f(6),L(t.notes.split(`
`))}}function UB(n,e){if(n&1){let t=B();l(0,"div",6)(1,"div",9),b("click",function(){let r=w(t).$implicit,o=v();return T(o.toggleMeeting(r.id))}),l(2,"div",10)(3,"div",11)(4,"p",12),c(5),qt(6,"date"),a(),l(7,"p",13),c(8),qt(9,"date"),a()(),l(10,"div")(11,"p",14),c(12),qt(13,"date"),a(),l(14,"h3",15),c(15),a()()(),l(16,"div",16)(17,"button",17),b("click",function(r){let o=w(t).$implicit,s=v();return r.stopPropagation(),T(s.openModal(o))}),x(18,"ion-icon",18),a(),l(19,"button",19),b("click",function(r){let o=w(t).$implicit,s=v();return r.stopPropagation(),T(s.requestDelete(o))}),x(20,"ion-icon",20),a(),x(21,"ion-icon",21),a()(),A(22,BB,16,2,"div",22),a()}if(n&2){let t=e.$implicit,i=v();f(5),E(an(6,7,t.date,"MMM")),f(3),E(an(9,10,t.date,"dd")),f(4),E(an(13,13,t.date,"fullDate")),f(3),E(t.title),f(6),z("rotate-180",i.openMeetingId()===t.id),f(),N(i.openMeetingId()===t.id?22:-1)}}function $B(n,e){n&1&&(l(0,"div",7),c(1," \u5C1A\u7121\u6703\u8B70\u7D00\u9304\uFF0C\u9EDE\u64CA\u300C\u65B0\u589E\u6BCF\u5468\u6703\u8B70\u300D\u4F86\u5EFA\u7ACB\u7B2C\u4E00\u7B46\u7D00\u9304\u3002 "),a())}function HB(n,e){if(n&1){let t=B();l(0,"div",8)(1,"div",34)(2,"div",35)(3,"h3",36),c(4),a(),l(5,"button",37),b("click",function(){w(t);let r=v();return T(r.closeModal())}),x(6,"ion-icon",38),a()(),l(7,"div",39)(8,"form",40),b("ngSubmit",function(){w(t);let r=v();return T(r.handleFormSubmit())}),l(9,"div",23)(10,"div")(11,"label",41),c(12,"\u65E5\u671F*"),a(),x(13,"input",42),a(),l(14,"div",43)(15,"label",44),c(16,"\u6A19\u984C*"),a(),x(17,"input",45),a()(),l(18,"div")(19,"label",46),c(20,"\u8207\u6703\u4EBA\u54E1*"),a(),x(21,"input",47),a(),l(22,"div")(23,"label",48),c(24,"\u6703\u8B70\u8A18\u9304*"),a(),x(25,"textarea",49),a(),l(26,"div")(27,"label",50),c(28,"\u884C\u52D5\u4E8B\u9805"),a(),x(29,"textarea",51),a(),l(30,"div",52)(31,"button",53),b("click",function(){w(t);let r=v();return T(r.closeModal())}),c(32,"\u53D6\u6D88"),a(),l(33,"button",54),c(34,"\u5132\u5B58"),a()()()()()()}if(n&2){let t=v();f(4),E(t.editingMeeting()?"\u7DE8\u8F2F\u6BCF\u5468\u6703\u8B70":"\u65B0\u589E\u6BCF\u5468\u6703\u8B70"),f(4),M("formGroup",t.meetingForm),f(25),M("disabled",t.meetingForm.invalid)}}function GB(n,e){if(n&1){let t=B();l(0,"div",8)(1,"div",55)(2,"div",56)(3,"div",57),x(4,"ion-icon",58),a(),l(5,"h3",59),c(6,"\u78BA\u5B9A\u8981\u522A\u9664\u55CE\uFF1F"),a(),l(7,"p",60),c(8),a()(),l(9,"div",61)(10,"button",53),b("click",function(){w(t);let r=v();return T(r.cancelDelete())}),c(11,"\u53D6\u6D88"),a(),l(12,"button",62),b("click",function(){w(t);let r=v();return T(r.confirmDelete())}),c(13,"\u78BA\u8A8D\u522A\u9664"),a()()()()}n&2&&(f(8),V("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u6BCF\u5468\u6703\u8B70\u7D00\u9304\u300C",e.title,"\u300D\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"))}var Qs=class Qs{constructor(){this.fb=P(He);this.isModalOpen=S(!1);this.editingMeeting=S(null);this.openMeetingId=S(null);this.meetingToDelete=S(null);this.meetings=S([{id:"MEET001",date:"2024-07-30",title:"\u7B2C\u4E09\u5B63\u8CA1\u52D9\u6AA2\u8A0E",attendees:"\u80A1\u6771 A, \u80A1\u6771 B, \u8CA1\u52D9\u9577",notes:`1. \u8A0E\u8AD6\u7B2C\u4E09\u5B63\u5EA6\u7684\u71DF\u6536\u72C0\u6CC1\uFF0C\u6574\u9AD4\u8868\u73FE\u512A\u65BC\u9810\u671F\u3002
2. \u5206\u6790\u5404\u7522\u54C1\u7DDA\u7684\u5229\u6F64\u7387\uFF0C\u767C\u73FE\u96EA\u8304\u7522\u54C1\u7684\u6210\u672C\u6709\u4E0A\u5347\u8DA8\u52E2\u3002`,actionItems:`1. \u8CA1\u52D9\u90E8\u9700\u5728\u4E00\u9031\u5167\u63D0\u4EA4\u96EA\u8304\u6210\u672C\u4E0A\u5347\u7684\u8A73\u7D30\u5206\u6790\u5831\u544A\u3002
2. \u80A1\u6771 B \u8CA0\u8CAC\u7814\u7A76\u65B0\u7684\u4F9B\u61C9\u5546\u4EE5\u964D\u4F4E\u6210\u672C\u3002`},{id:"MEET002",date:"2024-07-25",title:"\u884C\u92B7\u6D3B\u52D5 brainstorm",attendees:"\u80A1\u6771 C, \u884C\u92B7\u5718\u968A",notes:"\u8A0E\u8AD6\u4E0B\u534A\u5E74\u5EA6\u7684\u884C\u92B7\u7B56\u7565\uFF0C\u4E3B\u8981\u96C6\u4E2D\u5728 VIP \u5BA2\u6236\u7684\u7DAD\u7E6B\u3002",actionItems:`1. \u884C\u92B7\u5718\u968A\u63D0\u51FA\u5169\u500B VIP \u5C08\u5C6C\u6D3B\u52D5\u65B9\u6848\u3002
2. \u9810\u7B97\u521D\u4F30\u9700\u5728\u4E0B\u9031\u4E09\u524D\u5B8C\u6210\u3002`}]);this.sortedMeetings=H(()=>this.meetings().sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()));this.meetingForm=this.fb.group({date:["",U.required],title:["",U.required],attendees:["",U.required],notes:["",U.required],actionItems:[""]})}toggleMeeting(e){this.openMeetingId.update(t=>t===e?null:e)}openModal(e=null){this.editingMeeting.set(e),e?this.meetingForm.patchValue(e):this.meetingForm.reset({date:new Date().toISOString().split("T")[0]}),this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1),this.editingMeeting.set(null)}handleFormSubmit(){if(this.meetingForm.invalid)return;let e=this.meetingForm.value,t=this.editingMeeting(),i={date:e.date,title:e.title,attendees:e.attendees,notes:e.notes,actionItems:e.actionItems||""};t?this.meetings.update(r=>r.map(o=>o.id===t.id?k(k({},o),i):o)):this.meetings.update(r=>[...r,k({id:`MEET${Date.now()}`},i)]),this.closeModal()}requestDelete(e){this.meetingToDelete.set(e)}confirmDelete(){if(!this.meetingToDelete())return;let e=this.meetingToDelete().id;this.meetings.update(t=>t.filter(i=>i.id!==e)),this.cancelDelete()}cancelDelete(){this.meetingToDelete.set(null)}};Qs.\u0275fac=function(t){return new(t||Qs)},Qs.\u0275cmp=ie({type:Qs,selectors:[["app-meeting"]],decls:14,vars:3,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","add-outline"],[1,"space-y-4"],[1,"bg-white","rounded-xl","shadow-md","overflow-hidden","transition-shadow","hover:shadow-lg"],[1,"bg-white","p-6","rounded-xl","shadow-md","text-center","text-gray-500"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"p-4","flex","justify-between","items-center","cursor-pointer","hover:bg-gray-50",3,"click"],[1,"flex","items-center","gap-4"],[1,"text-center","w-12"],[1,"text-sm","font-semibold","text-red-600"],[1,"text-2xl","font-bold","text-gray-800"],[1,"font-semibold","text-gray-500","text-sm"],[1,"text-lg","font-bold","text-gray-800"],[1,"flex","items-center","gap-2"],["title","\u7DE8\u8F2F",1,"text-gray-500","hover:text-indigo-600","p-2","rounded-full","hover:bg-gray-100",3,"click"],["name","create-outline"],["title","\u522A\u9664",1,"text-gray-500","hover:text-red-600","p-2","rounded-full","hover:bg-gray-100",3,"click"],["name","trash-outline"],["name","chevron-down-outline",1,"text-gray-500","transition-transform"],[1,"p-6","border-t","bg-slate-50","space-y-4","text-sm"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"bg-white","p-4","rounded-lg","border"],[1,"font-semibold","text-gray-600","mb-2","flex","items-center","gap-2"],["name","people-outline"],[1,"text-gray-800","pl-8"],[1,"bg-yellow-50","p-4","rounded-lg","border","border-yellow-200","md:row-span-2"],["name","document-text-outline"],[1,"text-gray-800","whitespace-pre-wrap","pl-8","list-disc","list-outside","space-y-1"],[1,"font-semibold","text-yellow-800","mb-2","flex","items-center","gap-2"],["name","checkbox-outline"],[1,"text-yellow-900","whitespace-pre-wrap","pl-8","list-disc","list-outside","space-y-1"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-2xl","max-h-[90vh]","flex","flex-col","m-4"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],[1,"space-y-4",3,"ngSubmit","formGroup"],["for","date",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","date","formControlName","date",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"md:col-span-2"],["for","title",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","title","formControlName","title",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","attendees",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","attendees","formControlName","attendees","placeholder","\u8ACB\u7528\u9017\u865F\u5206\u9694",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","notes",1,"block","text-sm","font-medium","text-gray-700"],["id","notes","formControlName","notes","rows","5",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","actionItems",1,"block","text-sm","font-medium","text-gray-700"],["id","actionItems","formControlName","actionItems","rows","3",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","disabled:bg-indigo-300",3,"disabled"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","m-4"],[1,"p-6","text-center"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100"],["name","warning-outline",1,"h-6","w-6","text-red-600"],[1,"mt-4","text-lg","font-semibold","text-gray-900"],[1,"mt-2","text-sm","text-gray-500"],[1,"flex","justify-center","gap-4","bg-gray-50","px-6","py-4","rounded-b-xl"],["type","button",1,"px-4","py-2","bg-red-600","text-white","rounded-md","hover:bg-red-700",3,"click"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),c(3,"\u6BCF\u5468\u6703\u8B70\u7D00\u9304"),a(),l(4,"button",3),b("click",function(){return i.openModal(null)}),x(5,"ion-icon",4),l(6,"span"),c(7,"\u65B0\u589E\u6BCF\u5468\u6703\u8B70"),a()()(),l(8,"div",5),O(9,UB,23,16,"div",6,FB,!1,$B,2,0,"div",7),a()(),A(12,HB,35,3,"div",8),A(13,GB,14,1,"div",8)),t&2){let r;f(9),L(i.sortedMeetings()),f(3),N(i.isModalOpen()?12:-1),f(),N((r=i.meetingToDelete())?13:-1,r)}},dependencies:[re,Oe,$e,Ce,me,Fe,Pe,Be,eo],encapsulation:2,changeDetection:0});var cp=Qs;var mp=(n,e)=>e.id;function qB(n,e){if(n&1&&(l(0,"option",13),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),E(t)}}function WB(n,e){if(n&1&&(l(0,"option",13),c(1),a()),n&2){let t=e.$implicit;M("value",t.id),f(),E(t.name)}}function jB(n,e){if(n&1){let t=B();l(0,"div",34)(1,"div",36)(2,"span",37),c(3),a(),l(4,"div",38)(5,"button",39),b("click",function(){let r=w(t).$implicit,o=v(2).$implicit,s=v();return T(s.openRecordModal(o.id,r))}),x(6,"ion-icon",28),a(),l(7,"button",40),b("click",function(){let r=w(t).$implicit,o=v(2).$implicit,s=v();return T(s.requestDeleteRecord(o.id,r))}),x(8,"ion-icon",30),a()()(),l(9,"div",41)(10,"div",42),x(11,"ion-icon",43),l(12,"p",44),c(13),a()(),l(14,"div",45),x(15,"ion-icon",46),l(16,"p",47),c(17),a()()(),l(18,"div",48)(19,"div",3),x(20,"img",49),l(21,"span",50),c(22),a()(),l(23,"span",51),c(24),a()()()}if(n&2){let t=e.$implicit,i=v(3);f(2),De(i.getCategoryClass(t.category)),f(),E(t.category),f(10),E(t.goal),f(4),E(t.progress),f(3),M("src",i.getShareholderAvatarUrl(t.assigneeId),$t),f(2),E(i.getShareholderName(t.assigneeId)),f(2),E(t.lastUpdated.split(" ")[0])}}function zB(n,e){n&1&&(l(0,"div",35),c(1,"\u6B64\u65E5\u671F\u5C1A\u7121\u9032\u5EA6\u5831\u544A\uFF0C\u9EDE\u64CA\u300C\u65B0\u589E\u9032\u5EA6\u300D\u4F86\u5EFA\u7ACB\u7B2C\u4E00\u7B46\u3002"),a())}function YB(n,e){if(n&1&&(l(0,"div",32)(1,"div",33),O(2,jB,25,8,"div",34,mp,!1,zB,2,0,"div",35),a()()),n&2){let t=v().$implicit;f(2),L(t.records)}}function JB(n,e){if(n&1){let t=B();l(0,"div",20)(1,"div",23),b("click",function(){let r=w(t).$implicit,o=v();return T(o.toggleMeeting(r.id))}),l(2,"h3",24),c(3),a(),l(4,"div",3)(5,"button",25),b("click",function(r){let o=w(t).$implicit,s=v();return r.stopPropagation(),T(s.openRecordModal(o.id,null))}),x(6,"ion-icon",26),l(7,"span"),c(8,"\u65B0\u589E\u9032\u5EA6"),a()(),l(9,"button",27),b("click",function(r){let o=w(t).$implicit,s=v();return r.stopPropagation(),T(s.openMeetingModal(o))}),x(10,"ion-icon",28),a(),l(11,"button",29),b("click",function(r){let o=w(t).$implicit,s=v();return r.stopPropagation(),T(s.requestDeleteMeeting(o))}),x(12,"ion-icon",30),a(),x(13,"ion-icon",31),a()(),A(14,YB,5,1,"div",32),a()}if(n&2){let t=e.$implicit,i=v();f(3),E(t.date),f(10),z("rotate-180",i.openMeetingId()===t.id),f(),N(i.openMeetingId()===t.id?14:-1)}}function KB(n,e){n&1&&(l(0,"div",21),c(1,"\u7121\u7B26\u5408\u7BE9\u9078\u689D\u4EF6\u7684\u6703\u8B70\u7D00\u9304\u3002"),a())}function QB(n,e){if(n&1){let t=B();l(0,"div",22)(1,"div",52)(2,"div",53)(3,"h3",54),c(4),a(),l(5,"button",55),b("click",function(){w(t);let r=v();return T(r.closeMeetingModal())}),x(6,"ion-icon",56),a()(),l(7,"div",57)(8,"form",58),b("ngSubmit",function(){w(t);let r=v();return T(r.handleMeetingSubmit())}),l(9,"div")(10,"label",59),c(11,"\u65E5\u671F*"),a(),x(12,"input",60),a(),l(13,"div",61)(14,"button",62),b("click",function(){w(t);let r=v();return T(r.closeMeetingModal())}),c(15,"\u53D6\u6D88"),a(),l(16,"button",63),c(17,"\u5132\u5B58"),a()()()()()()}if(n&2){let t=v();f(4),E(t.editingMeeting()?"\u7DE8\u8F2F\u7D00\u9304\u65E5\u671F":"\u65B0\u589E\u7D00\u9304\u65E5\u671F"),f(4),M("formGroup",t.meetingForm),f(8),M("disabled",t.meetingForm.invalid)}}function ZB(n,e){if(n&1&&x(0,"option",13),n&2){let t=e.$implicit;M("value",t)}}function XB(n,e){if(n&1&&(l(0,"option",13),c(1),a()),n&2){let t=e.$implicit;M("value",t.id),f(),E(t.name)}}function eU(n,e){if(n&1){let t=B();l(0,"div",22)(1,"div",64)(2,"div",53)(3,"h3",54),c(4),a(),l(5,"button",55),b("click",function(){w(t);let r=v();return T(r.closeRecordModal())}),x(6,"ion-icon",56),a()(),l(7,"div",65)(8,"form",58),b("ngSubmit",function(){w(t);let r=v();return T(r.handleRecordFormSubmit())}),l(9,"div")(10,"label",66),c(11,"\u5206\u985E*"),a(),x(12,"input",67),l(13,"datalist",68),O(14,ZB,1,1,"option",13,W),a()(),l(16,"div")(17,"label",69),c(18,"\u76EE\u6A19*"),a(),x(19,"textarea",70),a(),l(20,"div")(21,"label",71),c(22,"\u9032\u5EA6*"),a(),x(23,"textarea",72),a(),l(24,"div")(25,"label",73),c(26,"\u8CA0\u8CAC\u4EBA*"),a(),l(27,"select",74)(28,"option",75),c(29,"\u8ACB\u9078\u64C7"),a(),O(30,XB,2,2,"option",13,mp),a()(),l(32,"div",61)(33,"button",62),b("click",function(){w(t);let r=v();return T(r.closeRecordModal())}),c(34,"\u53D6\u6D88"),a(),l(35,"button",63),c(36,"\u5132\u5B58"),a()()()()()()}if(n&2){let t,i=v();f(4),E((t=i.editingRecord())!=null&&t.record?"\u7DE8\u8F2F\u9032\u5EA6":"\u65B0\u589E\u9032\u5EA6"),f(4),M("formGroup",i.recordForm),f(6),L(i.categories()),f(16),L(i.shareholders()),f(5),M("disabled",i.recordForm.invalid)}}function tU(n,e){if(n&1){let t=B();l(0,"div",79),x(1,"input",82),l(2,"button",83),b("click",function(){let r=w(t).$index,o=v(2);return T(o.removeShareholder(r))}),x(3,"ion-icon",84),a()()}if(n&2){let t=e.$index;M("formGroupName",t)}}function nU(n,e){if(n&1){let t=B();l(0,"div",22)(1,"div",76)(2,"div",53)(3,"h3",54),c(4,"\u7BA1\u7406\u4EBA\u54E1"),a(),l(5,"button",55),b("click",function(){w(t);let r=v();return T(r.closeShareholderModal())}),x(6,"ion-icon",56),a()(),l(7,"div",65)(8,"form",77),b("ngSubmit",function(){w(t);let r=v();return T(r.saveShareholders())}),l(9,"div",78),O(10,tU,4,1,"div",79,bn),a(),l(12,"button",80),b("click",function(){w(t);let r=v();return T(r.addShareholder())}),c(13,"+ \u65B0\u589E\u4EBA\u54E1"),a(),l(14,"div",81)(15,"button",62),b("click",function(){w(t);let r=v();return T(r.closeShareholderModal())}),c(16,"\u53D6\u6D88"),a(),l(17,"button",63),c(18,"\u5132\u5B58\u8B8A\u66F4"),a()()()()()()}if(n&2){let t=v();f(8),M("formGroup",t.shareholderForm),f(2),L(t.shareholderControls),f(7),M("disabled",t.shareholderForm.invalid)}}function iU(n,e){if(n&1){let t=B();l(0,"div",22)(1,"div",85)(2,"div",86)(3,"div",87),x(4,"ion-icon",88),a(),l(5,"h3",89),c(6,"\u78BA\u5B9A\u8981\u522A\u9664\u55CE\uFF1F"),a(),l(7,"p",90),c(8),a()(),l(9,"div",91)(10,"button",62),b("click",function(){w(t);let r=v();return T(r.cancelDeleteMeeting())}),c(11,"\u53D6\u6D88"),a(),l(12,"button",92),b("click",function(){w(t);let r=v();return T(r.confirmDeleteMeeting())}),c(13,"\u78BA\u8A8D\u522A\u9664"),a()()()()}n&2&&(f(8),V("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u65E5\u671F\u70BA\u300C",e.date,"\u300D\u7684\u7D00\u9304\u53CA\u5176\u6240\u6709\u9032\u5EA6\u5831\u544A\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"))}function rU(n,e){if(n&1){let t=B();l(0,"div",22)(1,"div",85)(2,"div",86)(3,"div",87),x(4,"ion-icon",88),a(),l(5,"h3",89),c(6,"\u78BA\u5B9A\u8981\u522A\u9664\u55CE\uFF1F"),a(),l(7,"p",90),c(8),a()(),l(9,"div",91)(10,"button",62),b("click",function(){w(t);let r=v();return T(r.cancelDeleteRecord())}),c(11,"\u53D6\u6D88"),a(),l(12,"button",92),b("click",function(){w(t);let r=v();return T(r.confirmDeleteRecord())}),c(13,"\u78BA\u8A8D\u522A\u9664"),a()()()()}n&2&&(f(8),V("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u76EE\u6A19\u70BA\u300C",e.record.goal,"\u300D\u7684\u9019\u7B46\u9032\u5EA6\u5831\u544A\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"))}var Zs=class Zs{constructor(){this.fb=P(He);this.isRecordModalOpen=S(!1);this.isShareholderModalOpen=S(!1);this.isMeetingModalOpen=S(!1);this.editingRecord=S(null);this.editingMeeting=S(null);this.openMeetingId=S(null);this.categoryFilter=S("");this.assigneeFilter=S("");this.shareholders=S([{id:"sh1",name:"\u80A1\u6771 A"},{id:"sh2",name:"\u80A1\u6771 B"},{id:"sh3",name:"\u80A1\u6771 C"}]);this.meetingProgresses=S([{id:"MP001",date:"2024-07-29",records:[{id:"REC001",category:"\u8CA1\u52D9",goal:"\u5F59\u6574\u5167\u5916\u8CA1\u5831",progress:"\u6574\u7406\u51FA\u5167\u5916\u5E33\u7684\u5831\u8868",assigneeId:"sh1",lastUpdated:"2024-07-29 11:00:00"},{id:"REC003",category:"\u516C\u95DC",goal:"2026/1/10 \u78BA\u8A8D\u4E00\u6708\u6D3B\u52D5\u5834\u6B21",progress:"\u798F\u59D4\u6703\u806F\u7D6145\u500B (1/5)",assigneeId:"sh2",lastUpdated:"2024-07-29 09:45:00"},{id:"REC005",category:"\u71DF\u904B",goal:"\u627E\u5230\u6709\u6548\u80A1\u6771",progress:"\u5206\u6F64\u6A5F\u5236\u8A0E\u8AD6\u4E2D",assigneeId:"sh2",lastUpdated:"2024-07-29 14:00:00"}]},{id:"MP002",date:"2024-07-22",records:[{id:"REC002",category:"\u8CA1\u52D9",goal:"\u62C9\u878D\u8CC7",progress:"\u88D5\u878D\u878D\u8CC7",assigneeId:"sh1",lastUpdated:"2024-07-28 15:30:00"},{id:"REC004",category:"\u6D3B\u52D5",goal:"\u5361\u724C\u805A\u9910 1/15",progress:"1/15\u5361\u724C\u805A\u6703*10\u4EBA (\u91CD\u9EDE\u4EBA\u7269) 5000\u9910\u8CBB \u4E2D\u9910",assigneeId:"sh3",lastUpdated:"2024-07-27 18:20:00"}]}]);this.categories=H(()=>{let e=this.meetingProgresses().flatMap(t=>t.records);return[...new Set(e.map(t=>t.category))].sort()});this.sortedMeetings=H(()=>this.meetingProgresses().slice().sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()));this.filteredMeetings=H(()=>{let e=this.categoryFilter(),t=this.assigneeFilter(),i=this.sortedMeetings();return!e&&!t?i:i.map(r=>q(k({},r),{records:r.records.filter(o=>!e||o.category===e).filter(o=>!t||o.assigneeId===t)})).filter(r=>r.records.length>0)});this.meetingForm=this.fb.group({date:["",U.required]});this.recordForm=this.fb.group({category:["",U.required],goal:["",U.required],progress:["",U.required],assigneeId:["",U.required]});this.meetingToDelete=S(null);this.recordToDelete=S(null);this.shareholderForm=this.fb.group({shareholders:this.fb.array([])})}getShareholderName(e){return this.shareholders().find(t=>t.id===e)?.name||"\u672A\u77E5"}getShareholderAvatarUrl(e){let t=this.getShareholderName(e);return`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=random&color=fff&font-size=0.5`}getCategoryClass(e){return{\u8CA1\u52D9:"bg-blue-100 text-blue-800",\u516C\u95DC:"bg-purple-100 text-purple-800",\u71DF\u904B:"bg-green-100 text-green-800",\u6D3B\u52D5:"bg-yellow-100 text-yellow-800"}[e]||"bg-gray-100 text-gray-800"}toggleMeeting(e){this.openMeetingId.update(t=>t===e?null:e)}openMeetingModal(e=null){this.editingMeeting.set(e),e?this.meetingForm.setValue({date:e.date}):this.meetingForm.reset({date:new Date().toISOString().split("T")[0]}),this.isMeetingModalOpen.set(!0)}closeMeetingModal(){this.isMeetingModalOpen.set(!1)}handleMeetingSubmit(){if(this.meetingForm.invalid)return;let e=this.meetingForm.value,t=this.editingMeeting();if(t)this.meetingProgresses.update(i=>i.map(r=>r.id===t.id?q(k({},r),{date:e.date}):r));else{let i={id:`MP${Date.now()}`,date:e.date,records:[]};this.meetingProgresses.update(r=>[...r,i])}this.closeMeetingModal()}openRecordModal(e,t=null){t?(this.editingRecord.set({record:t,meetingId:e}),this.recordForm.patchValue(t)):(this.editingRecord.set({record:null,meetingId:e}),this.recordForm.reset({assigneeId:""})),this.isRecordModalOpen.set(!0)}closeRecordModal(){this.isRecordModalOpen.set(!1),this.editingRecord.set(null)}handleRecordFormSubmit(){if(this.recordForm.invalid)return;let e=this.editingRecord();if(!e)return;let{record:t,meetingId:i}=e,r=this.recordForm.value,o={category:r.category,goal:r.goal,progress:r.progress,assigneeId:r.assigneeId,lastUpdated:new Date().toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replace(/\//g,"-")};this.meetingProgresses.update(s=>s.map(u=>{if(u.id===i){let d;return t?d=u.records.map(m=>m.id===t.id?k(k({},m),o):m):d=[...u.records,k({id:`REC${Date.now()}`},o)],q(k({},u),{records:d})}return u})),this.closeRecordModal()}resetFilters(){this.categoryFilter.set(""),this.assigneeFilter.set("")}requestDeleteMeeting(e){this.meetingToDelete.set(e)}confirmDeleteMeeting(){if(!this.meetingToDelete())return;let e=this.meetingToDelete().id;this.meetingProgresses.update(t=>t.filter(i=>i.id!==e)),this.cancelDeleteMeeting()}cancelDeleteMeeting(){this.meetingToDelete.set(null)}requestDeleteRecord(e,t){this.recordToDelete.set({meetingId:e,record:t})}confirmDeleteRecord(){if(!this.recordToDelete())return;let{meetingId:e,record:t}=this.recordToDelete();this.meetingProgresses.update(i=>i.map(r=>r.id===e?q(k({},r),{records:r.records.filter(o=>o.id!==t.id)}):r)),this.cancelDeleteRecord()}cancelDeleteRecord(){this.recordToDelete.set(null)}get shareholderControls(){return this.shareholderForm.get("shareholders").controls}openShareholderModal(){let e=this.shareholderForm.get("shareholders");e.clear(),this.shareholders().map(i=>this.fb.group({id:[i.id],name:[i.name,U.required]})).forEach(i=>e.push(i)),this.isShareholderModalOpen.set(!0)}closeShareholderModal(){this.isShareholderModalOpen.set(!1)}addShareholder(){this.shareholderForm.get("shareholders").push(this.fb.group({id:[`sh${Date.now()}`],name:["",U.required]}))}removeShareholder(e){this.shareholderForm.get("shareholders").removeAt(e)}saveShareholders(){this.shareholderForm.invalid||(this.shareholders.set(this.shareholderForm.value.shareholders),this.closeShareholderModal())}};Zs.\u0275fac=function(t){return new(t||Zs)},Zs.\u0275cmp=ie({type:Zs,selectors:[["app-shareholder-records"]],decls:43,vars:8,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"flex","items-center","gap-2"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","calendar-outline"],[1,"bg-gray-700","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-gray-800","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","people-outline"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","p-4","bg-gray-50","rounded-lg","mb-6"],["for","categoryFilter",1,"text-sm","font-medium","text-gray-600"],["id","categoryFilter",1,"w-full","mt-1","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["value",""],[3,"value"],["for","assigneeFilter",1,"text-sm","font-medium","text-gray-600"],["id","assigneeFilter",1,"w-full","mt-1","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"flex","items-end","justify-end"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"space-y-4"],[1,"bg-white","rounded-xl","border","border-gray-200","overflow-hidden","transition-shadow","hover:shadow-md"],[1,"text-center","py-8","text-gray-500"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"p-4","flex","justify-between","items-center","cursor-pointer","hover:bg-gray-50",3,"click"],[1,"text-lg","font-bold","text-gray-800"],[1,"bg-indigo-500","text-white","px-3","py-1","rounded-md","font-medium","hover:bg-indigo-600","flex","items-center","gap-1","text-xs",3,"click"],["name","add-outline"],["title","\u7DE8\u8F2F\u65E5\u671F",1,"text-gray-500","hover:text-indigo-600","p-2","rounded-full","hover:bg-gray-200",3,"click"],["name","create-outline"],["title","\u522A\u9664\u6B64\u65E5\u671F\u6240\u6709\u7D00\u9304",1,"text-gray-500","hover:text-red-600","p-2","rounded-full","hover:bg-gray-200",3,"click"],["name","trash-outline"],["name","chevron-down-outline",1,"text-gray-500","transition-transform"],[1,"p-4","bg-slate-50","border-t"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-4"],[1,"bg-white","rounded-lg","border","p-4","flex","flex-col","group","relative","hover:border-indigo-300","transition-colors","duration-200"],[1,"md:col-span-2","lg:col-span-3","text-center","py-6","text-gray-500"],[1,"flex","justify-between","items-start"],[1,"px-2","py-1","text-xs","font-semibold","rounded-full"],[1,"flex","items-center","gap-1","opacity-0","group-hover:opacity-100","transition-opacity"],["title","\u7DE8\u8F2F",1,"text-gray-400","hover:text-indigo-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],["title","\u522A\u9664",1,"text-gray-400","hover:text-red-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],[1,"mt-3","flex-grow"],[1,"flex","items-start","gap-2"],["name","golf-outline",1,"text-indigo-500","mt-1"],[1,"font-semibold","text-gray-800"],[1,"flex","items-start","gap-2","mt-2"],["name","analytics-outline",1,"text-gray-500","mt-1"],[1,"text-gray-600","text-sm","flex-grow"],[1,"flex","justify-between","items-center","mt-4","pt-3","border-t"],["alt","avatar",1,"w-6","h-6","rounded-full",3,"src"],[1,"text-xs","font-medium","text-gray-700"],[1,"text-xs","text-gray-400"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-sm","m-4"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6"],[1,"space-y-4",3,"ngSubmit","formGroup"],["for","date",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","date","formControlName","date",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","disabled:bg-indigo-300",3,"disabled"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-lg","max-h-[90vh]","flex","flex-col","m-4"],[1,"p-6","overflow-y-auto"],["for","category",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","category","formControlName","category","list","category-options","placeholder","\u9078\u64C7\u6216\u8F38\u5165\u65B0\u5206\u985E",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["id","category-options"],["for","goal",1,"block","text-sm","font-medium","text-gray-700"],["id","goal","formControlName","goal","rows","2",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","progress",1,"block","text-sm","font-medium","text-gray-700"],["id","progress","formControlName","progress","rows","3",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","assigneeId",1,"block","text-sm","font-medium","text-gray-700"],["id","assigneeId","formControlName","assigneeId",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["value","","disabled",""],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","max-h-[90vh]","flex","flex-col","m-4"],[3,"ngSubmit","formGroup"],["formArrayName","shareholders",1,"space-y-3"],[1,"flex","items-center","gap-2",3,"formGroupName"],["type","button",1,"mt-4","text-sm","text-indigo-600","font-medium",3,"click"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-6"],["formControlName","name",1,"flex-grow","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["type","button","title","\u522A\u9664",1,"text-red-500","p-1","hover:bg-red-100","rounded-full",3,"click"],["name","trash-outline",1,"text-lg"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","m-4"],[1,"p-6","text-center"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100"],["name","warning-outline",1,"h-6","w-6","text-red-600"],[1,"mt-4","text-lg","font-semibold","text-gray-900"],[1,"mt-2","text-sm","text-gray-500"],[1,"flex","justify-center","gap-4","bg-gray-50","px-6","py-4","rounded-b-xl"],["type","button",1,"px-4","py-2","bg-red-600","text-white","rounded-md","hover:bg-red-700",3,"click"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),c(3,"\u500B\u4EBA\u6BCF\u5468\u9032\u5EA6\u7D00\u9304"),a(),l(4,"div",3)(5,"button",4),b("click",function(){return i.openMeetingModal(null)}),x(6,"ion-icon",5),l(7,"span"),c(8,"\u65B0\u589E\u7D00\u9304\u65E5\u671F"),a()(),l(9,"button",6),b("click",function(){return i.openShareholderModal()}),x(10,"ion-icon",7),l(11,"span"),c(12,"\u7BA1\u7406\u4EBA\u54E1"),a()()()(),l(13,"div",8)(14,"div",9)(15,"div")(16,"label",10),c(17,"\u9032\u5EA6\u5206\u985E"),a(),l(18,"select",11),Z("ngModelChange",function(o){return ee(i.categoryFilter,o)||(i.categoryFilter=o),o}),l(19,"option",12),c(20,"\u6240\u6709\u5206\u985E"),a(),O(21,qB,2,2,"option",13,W),a()(),l(23,"div")(24,"label",14),c(25,"\u8CA0\u8CAC\u4EBA"),a(),l(26,"select",15),Z("ngModelChange",function(o){return ee(i.assigneeFilter,o)||(i.assigneeFilter=o),o}),l(27,"option",12),c(28,"\u6240\u6709\u8CA0\u8CAC\u4EBA"),a(),O(29,WB,2,2,"option",13,mp),a()(),l(31,"div",16)(32,"button",17),b("click",function(){return i.resetFilters()}),x(33,"ion-icon",18),a()()(),l(34,"div",19),O(35,JB,15,4,"div",20,mp,!1,KB,2,0,"div",21),a()()(),A(38,QB,18,3,"div",22),A(39,eU,37,3,"div",22),A(40,nU,19,2,"div",22),A(41,iU,14,1,"div",22),A(42,rU,14,1,"div",22)),t&2){let r,o;f(18),Q("ngModel",i.categoryFilter),f(3),L(i.categories()),f(5),Q("ngModel",i.assigneeFilter),f(3),L(i.shareholders()),f(6),L(i.filteredMeetings()),f(3),N(i.isMeetingModalOpen()?38:-1),f(),N(i.isRecordModalOpen()?39:-1),f(),N(i.isShareholderModalOpen()?40:-1),f(),N((r=i.meetingToDelete())?41:-1,r),f(),N((o=i.recordToDelete())?42:-1,o)}},dependencies:[re,Oe,$e,ke,Ve,Ce,Ae,me,Fe,Pe,Be,wi,Ti,be,Ie],encapsulation:2,changeDetection:0});var pp=Zs;var oU=(n,e)=>e.id;function sU(n,e){if(n&1){let t=B();l(0,"div",10)(1,"div",11),x(2,"ion-icon",12),a(),l(3,"div",13)(4,"div",14)(5,"div",15)(6,"div")(7,"p",16),c(8),a(),l(9,"h3",17),c(10),a()(),l(11,"div",18)(12,"button",19),b("click",function(){let r=w(t).$implicit,o=v(2);return T(o.openModal(r))}),x(13,"ion-icon",20),a(),l(14,"button",21),b("click",function(){let r=w(t).$implicit,o=v(2);return T(o.requestDelete(r))}),x(15,"ion-icon",22),a()()(),l(16,"div",23)(17,"div",24)(18,"div",25)(19,"h4",26),x(20,"ion-icon",27),c(21,"\u76F8\u95DC\u4EBA\u54E1"),a(),l(22,"p",28),c(23),a()(),l(24,"div",29)(25,"h4",26),x(26,"ion-icon",30),c(27,"\u80CC\u666F"),a(),l(28,"p",31),c(29),a()(),l(30,"div",25)(31,"h4",26),x(32,"ion-icon",32),c(33,"\u7406\u7531"),a(),l(34,"p",31),c(35),a()()(),l(36,"div",33)(37,"h4",34),x(38,"ion-icon",35),c(39,"\u6700\u7D42\u6C7A\u5B9A"),a(),l(40,"p",36),c(41),a()()()()()()}if(n&2){let t=e.$implicit;f(8),E(t.date),f(2),E(t.title),f(13),E(t.stakeholders),f(6),E(t.background),f(6),E(t.rationale),f(6),E(t.decision)}}function aU(n,e){if(n&1&&(l(0,"div",6),x(1,"div",9),O(2,sU,42,6,"div",10,oU),a()),n&2){let t=v();f(2),L(t.sortedDecisions())}}function lU(n,e){n&1&&(l(0,"div",7),c(1," \u5C1A\u7121\u4F48\u9054\u4E8B\u9805\uFF0C\u9EDE\u64CA\u6309\u9215\u4F86\u5EFA\u7ACB\u7B2C\u4E00\u7B46\u7D00\u9304\u3002 "),a())}function uU(n,e){if(n&1){let t=B();l(0,"div",8)(1,"div",37)(2,"div",38)(3,"h3",39),c(4),a(),l(5,"button",40),b("click",function(){w(t);let r=v();return T(r.closeModal())}),x(6,"ion-icon",41),a()(),l(7,"div",42)(8,"form",43),b("ngSubmit",function(){w(t);let r=v();return T(r.handleFormSubmit())}),l(9,"div",44)(10,"div")(11,"label",45),c(12,"\u65E5\u671F*"),a(),x(13,"input",46),a(),l(14,"div")(15,"label",47),c(16,"\u6A19\u984C*"),a(),x(17,"input",48),a()(),l(18,"div")(19,"label",49),c(20,"\u76F8\u95DC\u4EBA\u54E1*"),a(),x(21,"input",50),a(),l(22,"div")(23,"label",51),c(24,"\u80CC\u666F*"),a(),x(25,"textarea",52),a(),l(26,"div")(27,"label",53),c(28,"\u5167\u5BB9*"),a(),x(29,"textarea",54),a(),l(30,"div")(31,"label",55),c(32,"\u7406\u7531*"),a(),x(33,"textarea",56),a(),l(34,"div",57)(35,"button",58),b("click",function(){w(t);let r=v();return T(r.closeModal())}),c(36,"\u53D6\u6D88"),a(),l(37,"button",59),c(38,"\u5132\u5B58"),a()()()()()()}if(n&2){let t=v();f(4),E(t.editingDecision()?"\u7DE8\u8F2F\u4F48\u9054":"\u65B0\u589E\u4F48\u9054"),f(4),M("formGroup",t.decisionForm),f(29),M("disabled",t.decisionForm.invalid)}}function dU(n,e){if(n&1){let t=B();l(0,"div",8)(1,"div",60)(2,"div",61)(3,"div",62),x(4,"ion-icon",63),a(),l(5,"h3",64),c(6,"\u78BA\u5B9A\u8981\u522A\u9664\u55CE\uFF1F"),a(),l(7,"p",65),c(8),a()(),l(9,"div",66)(10,"button",58),b("click",function(){w(t);let r=v();return T(r.cancelDelete())}),c(11,"\u53D6\u6D88"),a(),l(12,"button",67),b("click",function(){w(t);let r=v();return T(r.confirmDelete())}),c(13,"\u78BA\u8A8D\u522A\u9664"),a()()()()}n&2&&(f(8),V("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u4F48\u9054\u4E8B\u9805\u300C",e.title,"\u300D\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"))}var Xs=class Xs{constructor(){this.fb=P(He);this.isModalOpen=S(!1);this.editingDecision=S(null);this.decisionToDelete=S(null);this.decisions=S([{id:"DEC001",date:"2024-07-28",title:"\u63A1\u8CFC\u65B0\u7684 POS \u7CFB\u7D71",background:"\u76EE\u524D\u7684 POS \u7CFB\u7D71\u8001\u820A\uFF0C\u7D93\u5E38\u51FA\u932F\uFF0C\u4E14\u7121\u6CD5\u8207\u65B0\u7684\u5EAB\u5B58\u7BA1\u7406\u8EDF\u9AD4\u6574\u5408\u3002",decision:"\u6C7A\u5B9A\u63A1\u8CFC\u300CFuture POS\u300D\u7CFB\u7D71\uFF0C\u4E26\u9810\u8A08\u5728\u7B2C\u56DB\u5B63\u5B8C\u6210\u5C0E\u5165\u3002",rationale:"\u8A72\u7CFB\u7D71\u8A55\u50F9\u826F\u597D\uFF0C\u5177\u5099\u6211\u5011\u9700\u8981\u7684\u6240\u6709\u529F\u80FD\uFF0C\u4E14\u50F9\u683C\u5728\u9810\u7B97\u5167\u3002\u9577\u9060\u4F86\u770B\u80FD\u63D0\u5347\u71DF\u904B\u6548\u7387\u3002",stakeholders:"\u5168\u9AD4\u80A1\u6771, \u71DF\u904B\u7D93\u7406"},{id:"DEC002",date:"2024-07-15",title:"\u8ABF\u6574 VIP \u6703\u54E1\u798F\u5229",background:"VIP \u6703\u54E1\u7684\u6D88\u8CBB\u8A98\u56E0\u4E0D\u8DB3\uFF0C\u7E8C\u6703\u7387\u6709\u4E0B\u964D\u8DA8\u52E2\u3002",decision:"\u65B0\u589E VIP \u6703\u54E1\u751F\u65E5\u7576\u6708\u4EAB\u6709\u7528\u9910 8 \u6298\u512A\u60E0\uFF0C\u4E26\u63D0\u9AD8\u6D88\u8CBB\u7D2F\u7A4D\u9EDE\u6578\u7684\u56DE\u994B\u7387\u3002",rationale:"\u589E\u52A0\u5C0A\u69AE\u611F\u8207\u5BE6\u8CEA\u512A\u60E0\uFF0C\u5E0C\u671B\u80FD\u6709\u6548\u63D0\u5347\u9867\u5BA2\u5FE0\u8AA0\u5EA6\u8207\u6D88\u8CBB\u983B\u7387\u3002",stakeholders:"\u884C\u92B7\u5718\u968A, \u80A1\u6771 C"}]);this.sortedDecisions=H(()=>this.decisions().sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()));this.decisionForm=this.fb.group({date:["",U.required],title:["",U.required],stakeholders:["",U.required],background:["",U.required],decision:["",U.required],rationale:["",U.required]})}openModal(e=null){this.editingDecision.set(e),e?this.decisionForm.patchValue(e):this.decisionForm.reset({date:new Date().toISOString().split("T")[0]}),this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1),this.editingDecision.set(null)}handleFormSubmit(){if(this.decisionForm.invalid)return;let e=this.decisionForm.value,t=this.editingDecision(),i={date:e.date,title:e.title,stakeholders:e.stakeholders,background:e.background,decision:e.decision,rationale:e.rationale};t?this.decisions.update(r=>r.map(o=>o.id===t.id?k(k({},o),i):o)):this.decisions.update(r=>[...r,k({id:`DEC${Date.now()}`},i)]),this.closeModal()}requestDelete(e){this.decisionToDelete.set(e)}confirmDelete(){if(!this.decisionToDelete())return;let e=this.decisionToDelete().id;this.decisions.update(t=>t.filter(i=>i.id!==e)),this.cancelDelete()}cancelDelete(){this.decisionToDelete.set(null)}};Xs.\u0275fac=function(t){return new(t||Xs)},Xs.\u0275cmp=ie({type:Xs,selectors:[["app-decision-log"]],decls:13,vars:3,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","add-outline"],[1,"max-w-4xl","mx-auto"],[1,"relative","pl-8"],[1,"bg-white","p-6","rounded-xl","shadow-md","text-center","text-gray-500"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"absolute","left-3","top-2","h-full","w-0.5","bg-gray-200"],[1,"relative","mb-8","group"],[1,"absolute","-left-0.5","top-2.5","w-7","h-7","bg-white","border-4","border-indigo-600","rounded-full","flex","items-center","justify-center","transition-transform","group-hover:scale-110"],["name","flag-outline",1,"text-indigo-600"],[1,"ml-12","bg-white","rounded-xl","shadow-md","overflow-hidden","transition-shadow","hover:shadow-lg"],[1,"p-5"],[1,"flex","justify-between","items-start"],[1,"font-semibold","text-indigo-700"],[1,"text-lg","font-bold","text-gray-800"],[1,"flex","items-center","gap-1","opacity-0","group-hover:opacity-100","transition-opacity"],["title","\u7DE8\u8F2F",1,"text-gray-400","hover:text-indigo-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],["name","create-outline"],["title","\u522A\u9664",1,"text-gray-400","hover:text-red-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],["name","trash-outline"],[1,"mt-4","space-y-4","text-sm"],[1,"grid","grid-cols-1","xl:grid-cols-2","gap-4"],[1,"bg-slate-50","p-3","rounded-lg","border"],[1,"font-semibold","text-slate-600","mb-1","flex","items-center","gap-2"],["name","people-outline"],[1,"text-slate-800","pl-8"],[1,"bg-slate-50","p-3","rounded-lg","border","xl:row-span-2"],["name","information-circle-outline"],[1,"text-slate-800","whitespace-pre-wrap","pl-8"],["name","bulb-outline"],[1,"bg-indigo-50","p-4","rounded-lg","border","border-indigo-200"],[1,"font-semibold","text-indigo-800","mb-1","flex","items-center","gap-2"],["name","checkmark-done-circle-outline"],[1,"text-indigo-900","whitespace-pre-wrap","pl-8","font-medium","text-base"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-2xl","max-h-[90vh]","flex","flex-col","m-4"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["for","date",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","date","formControlName","date",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","title",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","title","formControlName","title",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","stakeholders",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","stakeholders","formControlName","stakeholders","placeholder","\u8ACB\u7528\u9017\u865F\u5206\u9694",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","background",1,"block","text-sm","font-medium","text-gray-700"],["id","background","formControlName","background","rows","3",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","decision",1,"block","text-sm","font-medium","text-gray-700"],["id","decision","formControlName","decision","rows","4",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","rationale",1,"block","text-sm","font-medium","text-gray-700"],["id","rationale","formControlName","rationale","rows","3",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","disabled:bg-indigo-300",3,"disabled"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","m-4"],[1,"p-6","text-center"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100"],["name","warning-outline",1,"h-6","w-6","text-red-600"],[1,"mt-4","text-lg","font-semibold","text-gray-900"],[1,"mt-2","text-sm","text-gray-500"],[1,"flex","justify-center","gap-4","bg-gray-50","px-6","py-4","rounded-b-xl"],["type","button",1,"px-4","py-2","bg-red-600","text-white","rounded-md","hover:bg-red-700",3,"click"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),c(3,"\u91CD\u5927\u4E8B\u9805\u4F48\u9054"),a(),l(4,"button",3),b("click",function(){return i.openModal(null)}),x(5,"ion-icon",4),l(6,"span"),c(7,"\u65B0\u589E\u4F48\u9054"),a()()(),l(8,"div",5),A(9,aU,4,0,"div",6)(10,lU,2,0,"div",7),a()(),A(11,uU,39,3,"div",8),A(12,dU,14,1,"div",8)),t&2){let r;f(9),N(i.sortedDecisions().length>0?9:10),f(2),N(i.isModalOpen()?11:-1),f(),N((r=i.decisionToDelete())?12:-1,r)}},dependencies:[re,Oe,$e,Ce,me,Fe,Pe,Be],encapsulation:2,changeDetection:0});var fp=Xs;var ta=(n,e)=>e.id;function cU(n,e){if(n&1&&(l(0,"option",15),c(1),a()),n&2){let t=e.$implicit;M("value",t.id),f(),E(t.name)}}function mU(n,e){if(n&1&&x(0,"div",51),n&2){let t=v().$implicit;gn("width",t.progress,"%")}}function pU(n,e){if(n&1&&x(0,"div",52),n&2){let t=v().$implicit;gn("width",t.progress,"%")}}function fU(n,e){if(n&1){let t=B();l(0,"label",49)(1,"input",53),b("change",function(r){let o=w(t).$index,s=v().$implicit,u=v();return T(u.updateProgress(s,o,r))}),a(),l(2,"span",54),c(3),a()()}if(n&2){let t=e.$implicit;f(),M("checked",t.isCompleted),f(),z("line-through",t.isCompleted)("text-gray-400",t.isCompleted),f(),E(t.description)}}function gU(n,e){n&1&&(l(0,"p",50),c(1,"\u5C1A\u7121\u95DC\u9375\u6210\u679C"),a())}function hU(n,e){if(n&1){let t=B();l(0,"div",23)(1,"div",28)(2,"div",29)(3,"div",30),x(4,"img",31),l(5,"div")(6,"p",32),c(7),a(),l(8,"p",33),c(9),a()()(),l(10,"div",34)(11,"button",35),b("click",function(){let r=w(t).$implicit,o=v();return T(o.openModal(r))}),x(12,"ion-icon",36),a(),l(13,"button",37),b("click",function(){let r=w(t).$implicit,o=v();return T(o.requestDelete(r))}),x(14,"ion-icon",38),a()()(),l(15,"h3",39),c(16),a()(),l(17,"div",40)(18,"div",41)(19,"span",42),c(20),a(),l(21,"span",43),c(22),a()(),l(23,"div",44),A(24,mU,1,2,"div",45)(25,pU,1,2,"div",46),a(),l(26,"div",47)(27,"h4",48),c(28,"\u95DC\u9375\u6210\u679C"),a(),O(29,fU,4,6,"label",49,ta,!1,gU,2,0,"p",50),a()()()}if(n&2){let t=e.$implicit,i=v();f(4),M("src",i.getOwnerAvatarUrl(t.ownerId),$t),f(3),E(i.getOwnerName(t.ownerId)),f(2),V("\u622A\u6B62\u65BC ",t.dueDate),f(7),E(t.title),f(3),M("ngClass",i.getStatusClass(t.status)),f(),E(t.status),f(2),V("",t.progress,"%"),f(2),N(t.progress<100?24:25),f(5),L(t.keyResults)}}function yU(n,e){n&1&&(l(0,"div",24),x(1,"ion-icon",55),l(2,"p",56),c(3,"\u7121\u7B26\u5408\u689D\u4EF6\u7684\u6BCF\u9031\u76EE\u6A19\u3002"),a()())}function _U(n,e){if(n&1&&x(0,"div",58),n&2){let t=v().$implicit;gn("width",t.progress,"%")}}function vU(n,e){if(n&1&&x(0,"div",52),n&2){let t=v().$implicit;gn("width",t.progress,"%")}}function CU(n,e){if(n&1){let t=B();l(0,"label",49)(1,"input",59),b("change",function(r){let o=w(t).$index,s=v().$implicit,u=v();return T(u.updateProgress(s,o,r))}),a(),l(2,"span",54),c(3),a()()}if(n&2){let t=e.$implicit;f(),M("checked",t.isCompleted),f(),z("line-through",t.isCompleted)("text-gray-400",t.isCompleted),f(),E(t.description)}}function xU(n,e){n&1&&(l(0,"p",50),c(1,"\u5C1A\u7121\u95DC\u9375\u6210\u679C"),a())}function EU(n,e){if(n&1){let t=B();l(0,"div",23)(1,"div",28)(2,"div",29)(3,"div",30),x(4,"img",31),l(5,"div")(6,"p",32),c(7),a(),l(8,"p",33),c(9),a()()(),l(10,"div",34)(11,"button",35),b("click",function(){let r=w(t).$implicit,o=v();return T(o.openModal(r))}),x(12,"ion-icon",36),a(),l(13,"button",37),b("click",function(){let r=w(t).$implicit,o=v();return T(o.requestDelete(r))}),x(14,"ion-icon",38),a()()(),l(15,"h3",39),c(16),a()(),l(17,"div",40)(18,"div",41)(19,"span",42),c(20),a(),l(21,"span",43),c(22),a()(),l(23,"div",44),A(24,_U,1,2,"div",57)(25,vU,1,2,"div",46),a(),l(26,"div",47)(27,"h4",48),c(28,"\u95DC\u9375\u6210\u679C"),a(),O(29,CU,4,6,"label",49,ta,!1,xU,2,0,"p",50),a()()()}if(n&2){let t=e.$implicit,i=v();f(4),M("src",i.getOwnerAvatarUrl(t.ownerId),$t),f(3),E(i.getOwnerName(t.ownerId)),f(2),V("\u622A\u6B62\u65BC ",t.dueDate),f(7),E(t.title),f(3),M("ngClass",i.getStatusClass(t.status)),f(),E(t.status),f(2),V("",t.progress,"%"),f(2),N(t.progress<100?24:25),f(5),L(t.keyResults)}}function bU(n,e){n&1&&(l(0,"div",24),x(1,"ion-icon",55),l(2,"p",56),c(3,"\u7121\u7B26\u5408\u689D\u4EF6\u7684\u6708\u5EA6\u76EE\u6A19\u3002"),a()())}function SU(n,e){if(n&1&&(l(0,"option",15),c(1),a()),n&2){let t=e.$implicit;M("value",t.id),f(),E(t.name)}}function DU(n,e){if(n&1){let t=B();l(0,"div",84),x(1,"input",89),l(2,"button",90),b("click",function(){let r=w(t).$index,o=v(2);return T(o.removeKeyResult(r))}),x(3,"ion-icon",38),a()()}if(n&2){let t=e.$index;M("formGroupName",t)}}function wU(n,e){if(n&1){let t=B();l(0,"div",27)(1,"div",60)(2,"div",61)(3,"h3",62),c(4),a(),l(5,"button",63),b("click",function(){w(t);let r=v();return T(r.closeModal())}),x(6,"ion-icon",64),a()(),l(7,"div",65)(8,"form",66),b("ngSubmit",function(){w(t);let r=v();return T(r.handleFormSubmit())}),l(9,"div")(10,"label",67),c(11,"\u76EE\u6A19*"),a(),x(12,"input",68),a(),l(13,"div",69)(14,"div")(15,"label",70),c(16,"\u8CA0\u8CAC\u4EBA*"),a(),l(17,"select",71)(18,"option",72),c(19,"\u8ACB\u9078\u64C7"),a(),O(20,SU,2,2,"option",15,ta),a()(),l(22,"div")(23,"label",73),c(24,"\u622A\u6B62\u65E5\u671F*"),a(),x(25,"input",74),a()(),l(26,"div",69)(27,"div")(28,"label",75),c(29,"\u9031\u671F*"),a(),l(30,"select",76)(31,"option",77),c(32,"\u6708\u5EA6"),a(),l(33,"option",78),c(34,"\u6BCF\u9031"),a()()(),l(35,"div")(36,"label",79),c(37,"\u72C0\u614B*"),a(),l(38,"select",80)(39,"option",9),c(40,"\u9032\u884C\u4E2D"),a(),l(41,"option",10),c(42,"\u5DF2\u5B8C\u6210"),a(),l(43,"option",11),c(44,"\u843D\u5F8C"),a(),l(45,"option",12),c(46,"\u5DF2\u64F1\u7F6E"),a()()()(),l(47,"div",81)(48,"h4",82),c(49,"\u95DC\u9375\u6210\u679C"),a(),l(50,"div",83),O(51,DU,4,1,"div",84,bn),a(),l(53,"button",85),b("click",function(){w(t);let r=v();return T(r.addKeyResult())}),c(54,"+ \u65B0\u589E\u95DC\u9375\u6210\u679C"),a()(),l(55,"div",86)(56,"button",87),b("click",function(){w(t);let r=v();return T(r.closeModal())}),c(57,"\u53D6\u6D88"),a(),l(58,"button",88),c(59,"\u5132\u5B58"),a()()()()()()}if(n&2){let t=v();f(4),E(t.editingGoal()?"\u7DE8\u8F2F\u500B\u4EBA\u76EE\u6A19":"\u65B0\u589E\u500B\u4EBA\u76EE\u6A19"),f(4),M("formGroup",t.goalForm),f(12),L(t.shareholders()),f(31),L(t.keyResults.controls),f(7),M("disabled",t.goalForm.invalid)}}function TU(n,e){if(n&1){let t=B();l(0,"div",27)(1,"div",91)(2,"div",92)(3,"div",93),x(4,"ion-icon",94),a(),l(5,"h3",95),c(6,"\u78BA\u5B9A\u8981\u522A\u9664\u76EE\u6A19\u55CE\uFF1F"),a(),l(7,"p",96),c(8),a()(),l(9,"div",97)(10,"button",87),b("click",function(){w(t);let r=v();return T(r.cancelDelete())}),c(11,"\u53D6\u6D88"),a(),l(12,"button",98),b("click",function(){w(t);let r=v();return T(r.confirmDelete())}),c(13,"\u78BA\u8A8D\u522A\u9664"),a()()()()}n&2&&(f(8),V("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u76EE\u6A19\u300C",e.title,"\u300D\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"))}var ea=class ea{constructor(){this.fb=P(He);this.isModalOpen=S(!1);this.editingGoal=S(null);this.goalToDelete=S(null);this.statusFilter=S("");this.ownerFilter=S("");this.shareholders=S([{id:"sh1",name:"\u80A1\u6771 A"},{id:"sh2",name:"\u80A1\u6771 B"},{id:"sh3",name:"\u80A1\u6771 C"},{id:"sh4",name:"\u71DF\u904B\u7D93\u7406"}]);this.goals=S([{id:"GOAL001",title:"\u63D0\u5347 2026 \u5E74 Q3 \u71DF\u6536 20%",ownerId:"sh1",dueDate:"2026-09-30",status:"\u9032\u884C\u4E2D",progress:33,period:"monthly",keyResults:[{id:"KR1-1",description:"\u63A8\u51FA\u4E09\u6B3E\u590F\u5B63\u7279\u8ABF\u98F2\u54C1",isCompleted:!0},{id:"KR1-2",description:"\u8209\u8FA6\u5169\u5834 VIP \u54C1\u9152\u6703",isCompleted:!1},{id:"KR1-3",description:"\u8207\u9644\u8FD1\u5546\u8FA6\u7C3D\u8A02\u4E0B\u5348\u8336\u5408\u4F5C",isCompleted:!1}]},{id:"GOAL002",title:"\u512A\u5316\u96EA\u8304\u5EAB\u5B58\u6210\u672C 15%",ownerId:"sh2",dueDate:"2026-08-31",status:"\u843D\u5F8C",progress:0,period:"monthly",keyResults:[{id:"KR2-1",description:"\u5C0E\u5165\u65B0\u7684\u5EAB\u5B58\u7BA1\u7406\u7CFB\u7D71",isCompleted:!1},{id:"KR2-2",description:"\u958B\u767C\u81F3\u5C11\u5169\u5BB6\u65B0\u7684\u96EA\u8304\u4F9B\u61C9\u5546",isCompleted:!1}]},{id:"GOAL003",title:"\u5B8C\u6210\u7DB2\u7AD9\u6539\u7248\u4E26\u4E0A\u7DDA",ownerId:"sh4",dueDate:"2026-07-31",status:"\u5DF2\u5B8C\u6210",progress:100,period:"monthly",keyResults:[{id:"KR3-1",description:"\u78BA\u8A8D\u65B0\u7DB2\u7AD9 UI/UX \u8A2D\u8A08",isCompleted:!0},{id:"KR3-2",description:"\u5B8C\u6210\u524D\u7AEF\u8207\u5F8C\u7AEF\u958B\u767C",isCompleted:!0},{id:"KR3-3",description:"\u5B8C\u6210\u4F7F\u7528\u8005\u6E2C\u8A66\u4E26\u4FEE\u5FA9 Bug",isCompleted:!0}]},{id:"GOAL004",title:"\u672C\u5468\u5B8C\u6210\u4F9B\u61C9\u5546\u806F\u7E6B",ownerId:"sh2",dueDate:"2024-08-04",status:"\u9032\u884C\u4E2D",progress:50,period:"weekly",keyResults:[{id:"KR4-1",description:"\u806F\u7E6B A \u4F9B\u61C9\u5546",isCompleted:!0},{id:"KR4-2",description:"\u806F\u7E6B B \u4F9B\u61C9\u5546",isCompleted:!1}]},{id:"GOAL005",title:"\u672C\u5468\u5B8C\u6210\u5468\u5831",ownerId:"sh1",dueDate:"2024-08-02",status:"\u5DF2\u5B8C\u6210",progress:100,period:"weekly",keyResults:[{id:"KR5-1",description:"\u6574\u7406\u672C\u5468\u6578\u64DA",isCompleted:!0},{id:"KR5-2",description:"\u64B0\u5BEB\u5831\u544A",isCompleted:!0}]}]);this.baseFilteredGoals=H(()=>{let e=this.statusFilter(),t=this.ownerFilter();return this.goals().filter(i=>!e||i.status===e).filter(i=>!t||i.ownerId===t).sort((i,r)=>new Date(r.dueDate).getTime()-new Date(i.dueDate).getTime())});this.monthlyGoals=H(()=>this.baseFilteredGoals().filter(e=>e.period==="monthly"));this.weeklyGoals=H(()=>this.baseFilteredGoals().filter(e=>e.period==="weekly"));this.goalForm=this.fb.group({title:["",U.required],ownerId:["",U.required],dueDate:["",U.required],period:["monthly",U.required],status:["\u9032\u884C\u4E2D",U.required],keyResults:this.fb.array([])})}get keyResults(){return this.goalForm.get("keyResults")}getOwnerName(e){return this.shareholders().find(t=>t.id===e)?.name||"\u672A\u77E5"}getOwnerAvatarUrl(e){let t=this.getOwnerName(e);return`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=random&color=fff&font-size=0.5`}getStatusClass(e){return{"bg-blue-100 text-blue-800":e==="\u9032\u884C\u4E2D","bg-green-100 text-green-800":e==="\u5DF2\u5B8C\u6210","bg-yellow-100 text-yellow-800":e==="\u843D\u5F8C","bg-gray-100 text-gray-800":e==="\u5DF2\u64F1\u7F6E"}}resetFilters(){this.statusFilter.set(""),this.ownerFilter.set("")}openModal(e=null){this.editingGoal.set(e),this.goalForm.reset({status:"\u9032\u884C\u4E2D",period:"monthly"}),this.keyResults.clear(),e?(this.goalForm.patchValue(e),e.keyResults.forEach(t=>this.addKeyResult(t.description,t.isCompleted))):this.goalForm.patchValue({dueDate:new Date().toISOString().split("T")[0]}),this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1)}addKeyResult(e="",t=!1){let i=this.fb.group({description:[e,U.required],isCompleted:[t]});this.keyResults.push(i)}removeKeyResult(e){this.keyResults.removeAt(e)}handleFormSubmit(){if(this.goalForm.invalid)return;let e=this.goalForm.value,t=this.editingGoal(),i=e.keyResults.map(s=>({id:`KR${Date.now()}-${Math.random()}`,description:s.description,isCompleted:s.isCompleted})),r=i.length>0?i.filter(s=>s.isCompleted).length/i.length*100:0,o={title:e.title,ownerId:e.ownerId,dueDate:e.dueDate,status:e.status,period:e.period,keyResults:i,progress:Math.round(r)};t?this.goals.update(s=>s.map(u=>u.id===t.id?k(k({},u),o):u)):this.goals.update(s=>[...s,k({id:`GOAL${Date.now()}`},o)]),this.closeModal()}updateProgress(e,t,i){let r=i.target.checked;this.goals.update(o=>o.map(s=>{if(s.id===e.id){let u=[...s.keyResults];u[t]=q(k({},u[t]),{isCompleted:r});let d=u.length>0?u.filter(m=>m.isCompleted).length/u.length*100:0;return q(k({},s),{keyResults:u,progress:Math.round(d)})}return s}))}requestDelete(e){this.goalToDelete.set(e)}confirmDelete(){this.goalToDelete()&&(this.goals.update(e=>e.filter(t=>t.id!==this.goalToDelete().id)),this.cancelDelete())}cancelDelete(){this.goalToDelete.set(null)}};ea.\u0275fac=function(t){return new(t||ea)},ea.\u0275cmp=ie({type:ea,selectors:[["app-goal-progress"]],decls:53,vars:6,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","add-outline"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","p-4","bg-white","rounded-xl","shadow-md"],["for","statusFilter",1,"text-sm","font-medium","text-gray-600"],["id","statusFilter",1,"w-full","mt-1","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-50",3,"ngModelChange","ngModel"],["value",""],["value","\u9032\u884C\u4E2D"],["value","\u5DF2\u5B8C\u6210"],["value","\u843D\u5F8C"],["value","\u5DF2\u64F1\u7F6E"],["for","ownerFilter",1,"text-sm","font-medium","text-gray-600"],["id","ownerFilter",1,"w-full","mt-1","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-50",3,"ngModelChange","ngModel"],[3,"value"],[1,"flex","items-end","justify-end"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-8","pt-4"],[1,"text-2xl","font-bold","text-gray-800","mb-4","pb-2","border-b-2","border-teal-500","flex","items-center","gap-2"],["name","today-outline"],[1,"space-y-4"],[1,"bg-white","rounded-xl","shadow-md","border","flex","flex-col","group","transition-all","duration-300","hover:shadow-lg","hover:-translate-y-1"],[1,"bg-white","p-6","rounded-xl","border","text-center","text-gray-500"],[1,"text-2xl","font-bold","text-gray-800","mb-4","pb-2","border-b-2","border-indigo-500","flex","items-center","gap-2"],["name","calendar-outline"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"p-4"],[1,"flex","justify-between","items-start"],[1,"flex","items-center","gap-3"],["alt","avatar",1,"w-10","h-10","rounded-full",3,"src"],[1,"font-semibold","text-gray-800"],[1,"text-xs","text-gray-500"],[1,"flex","items-center","gap-1","shrink-0","opacity-0","group-hover:opacity-100","transition-opacity"],["title","\u7DE8\u8F2F",1,"text-gray-400","hover:text-indigo-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],["name","create-outline"],["title","\u522A\u9664",1,"text-gray-400","hover:text-red-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],["name","trash-outline"],[1,"text-base","font-bold","text-gray-800","mt-3"],[1,"p-4","flex-grow","flex","flex-col","justify-end"],[1,"flex","items-center","justify-between","mb-1"],[1,"text-xs","font-semibold","px-2","py-1","rounded-full",3,"ngClass"],[1,"text-sm","font-semibold"],[1,"w-full","bg-slate-100","rounded-full","h-3.5"],[1,"bg-teal-600","h-3.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #5eead4, #0d9488)",3,"width"],[1,"bg-green-500","h-3.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #4ade80, #16a34a)",3,"width"],[1,"mt-4","space-y-1","border-t","pt-4"],[1,"text-xs","font-semibold","text-gray-500","uppercase","px-2"],[1,"flex","items-start","gap-3","text-sm","text-gray-700","cursor-pointer","p-2","rounded-lg","hover:bg-slate-50"],[1,"text-xs","text-gray-400","px-2"],[1,"bg-teal-600","h-3.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #5eead4, #0d9488)"],[1,"bg-green-500","h-3.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #4ade80, #16a34a)"],["type","checkbox",1,"mt-1","h-4","w-4","rounded","border-gray-300","text-teal-600","focus:ring-teal-500","shrink-0",3,"change","checked"],[1,"transition-colors","flex-1"],["name","flag-outline",1,"text-4xl","text-gray-400"],[1,"mt-2"],[1,"bg-indigo-600","h-3.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #818cf8, #4f46e5)",3,"width"],[1,"bg-indigo-600","h-3.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #818cf8, #4f46e5)"],["type","checkbox",1,"mt-1","h-4","w-4","rounded","border-gray-300","text-indigo-600","focus:ring-indigo-500","shrink-0",3,"change","checked"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-2xl","max-h-[90vh]","flex","flex-col","m-4"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],[1,"space-y-4",3,"ngSubmit","formGroup"],["for","title",1,"block","text-sm","font-medium","text-gray-700"],["id","title","formControlName","title",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["for","ownerId",1,"block","text-sm","font-medium","text-gray-700"],["id","ownerId","formControlName","ownerId",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["value","","disabled",""],["for","dueDate",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","dueDate","formControlName","dueDate",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","period",1,"block","text-sm","font-medium","text-gray-700"],["id","period","formControlName","period",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["value","monthly"],["value","weekly"],["for","status",1,"block","text-sm","font-medium","text-gray-700"],["id","status","formControlName","status",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"space-y-2","pt-2"],[1,"text-sm","font-medium","text-gray-700"],["formArrayName","keyResults",1,"space-y-2"],[1,"flex","items-center","gap-2",3,"formGroupName"],["type","button",1,"text-sm","font-medium","text-indigo-600","hover:text-indigo-800",3,"click"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","disabled:bg-indigo-300",3,"disabled"],["formControlName","description","placeholder","\u8F38\u5165\u95DC\u9375\u6210\u679C\u63CF\u8FF0...",1,"flex-grow","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2","text-sm"],["type","button","title","\u522A\u9664",1,"text-red-500","hover:text-red-700","p-1.5","rounded-full","hover:bg-red-100",3,"click"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","m-4"],[1,"p-6","text-center"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100"],["name","warning-outline",1,"h-6","w-6","text-red-600"],[1,"mt-4","text-lg","font-semibold","text-gray-900"],[1,"mt-2","text-sm","text-gray-500"],[1,"flex","justify-center","gap-4","bg-gray-50","px-6","py-4","rounded-b-xl"],["type","button",1,"px-4","py-2","bg-red-600","text-white","rounded-md","hover:bg-red-700",3,"click"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),c(3,"\u500B\u4EBA\u76EE\u6A19\u9032\u5EA6"),a(),l(4,"button",3),b("click",function(){return i.openModal(null)}),x(5,"ion-icon",4),l(6,"span"),c(7,"\u65B0\u589E\u500B\u4EBA\u76EE\u6A19"),a()()(),l(8,"div",5)(9,"div")(10,"label",6),c(11,"\u72C0\u614B"),a(),l(12,"select",7),Z("ngModelChange",function(o){return ee(i.statusFilter,o)||(i.statusFilter=o),o}),l(13,"option",8),c(14,"\u6240\u6709\u72C0\u614B"),a(),l(15,"option",9),c(16,"\u9032\u884C\u4E2D"),a(),l(17,"option",10),c(18,"\u5DF2\u5B8C\u6210"),a(),l(19,"option",11),c(20,"\u843D\u5F8C"),a(),l(21,"option",12),c(22,"\u5DF2\u64F1\u7F6E"),a()()(),l(23,"div")(24,"label",13),c(25,"\u8CA0\u8CAC\u4EBA"),a(),l(26,"select",14),Z("ngModelChange",function(o){return ee(i.ownerFilter,o)||(i.ownerFilter=o),o}),l(27,"option",8),c(28,"\u6240\u6709\u8CA0\u8CAC\u4EBA"),a(),O(29,cU,2,2,"option",15,ta),a()(),l(31,"div",16)(32,"button",17),b("click",function(){return i.resetFilters()}),x(33,"ion-icon",18),a()()(),l(34,"div",19)(35,"div")(36,"h2",20),x(37,"ion-icon",21),c(38," \u6BCF\u9031\u76EE\u6A19 "),a(),l(39,"div",22),O(40,hU,32,9,"div",23,ta,!1,yU,4,0,"div",24),a()(),l(43,"div")(44,"h2",25),x(45,"ion-icon",26),c(46," \u6708\u5EA6\u76EE\u6A19 "),a(),l(47,"div",22),O(48,EU,32,9,"div",23,ta,!1,bU,4,0,"div",24),a()()()(),A(51,wU,60,3,"div",27),A(52,TU,14,1,"div",27)),t&2){let r;f(12),Q("ngModel",i.statusFilter),f(14),Q("ngModel",i.ownerFilter),f(3),L(i.shareholders()),f(11),L(i.weeklyGoals()),f(8),L(i.monthlyGoals()),f(3),N(i.isModalOpen()?51:-1),f(),N((r=i.goalToDelete())?52:-1,r)}},dependencies:[re,Ug,Oe,$e,ke,Ve,Ce,Ae,me,Fe,Pe,Be,wi,Ti,be,Ie],encapsulation:2,changeDetection:0});var gp=ea;var IU=(n,e)=>e.id;function MU(n,e){if(n&1&&(l(0,"option",11),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),E(t)}}function AU(n,e){if(n&1&&(l(0,"option",11),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),E(t)}}function NU(n,e){if(n&1){let t=B();l(0,"tr",19)(1,"td",21),c(2),a(),l(3,"td",22),c(4),a(),l(5,"td",22)(6,"span",23),c(7),a()(),l(8,"td",22)(9,"span",23),c(10),a()(),l(11,"td",24),c(12),a(),l(13,"td",22)(14,"div",25)(15,"button",26),b("click",function(){let r=w(t).$implicit,o=v();return T(o.openModal(r))}),x(16,"ion-icon",27),a(),l(17,"button",28),b("click",function(){let r=w(t).$implicit,o=v();return T(o.requestDelete(r))}),x(18,"ion-icon",29),a()()()()}if(n&2){let t=e.$implicit,i=v();f(2),E(t.name),f(2),E(t.email),f(2),De(i.getRoleClass(t.role)),f(),E(t.role),f(2),De(i.getStatusClass(t.status)),f(),E(t.status),f(2),E(t.lastLogin)}}function RU(n,e){n&1&&(l(0,"tr")(1,"td",30),c(2,"\u7121\u7B26\u5408\u689D\u4EF6\u7684\u4F7F\u7528\u8005\u3002"),a()())}function FU(n,e){if(n&1&&(l(0,"option",11),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),E(t)}}function PU(n,e){if(n&1&&(l(0,"option",11),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),E(t)}}function kU(n,e){if(n&1){let t=B();l(0,"div",20)(1,"div",31)(2,"div",32)(3,"h3",33),c(4),a(),l(5,"button",34),b("click",function(){w(t);let r=v();return T(r.closeModal())}),x(6,"ion-icon",35),a()(),l(7,"div",36)(8,"form",37),b("ngSubmit",function(){w(t);let r=v();return T(r.handleFormSubmit())}),l(9,"label",38)(10,"span",39),c(11,"\u540D\u7A31*"),a(),x(12,"input",40),a(),l(13,"label",38)(14,"span",39),c(15,"Email*"),a(),x(16,"input",41),a(),l(17,"div",42)(18,"label",38)(19,"span",39),c(20,"\u89D2\u8272*"),a(),l(21,"select",43),O(22,FU,2,2,"option",11,W),a()(),l(24,"label",38)(25,"span",39),c(26,"\u72C0\u614B*"),a(),l(27,"select",44),O(28,PU,2,2,"option",11,W),a()()(),l(30,"div",45)(31,"button",46),b("click",function(){w(t);let r=v();return T(r.closeModal())}),c(32,"\u53D6\u6D88"),a(),l(33,"button",47),c(34,"\u5132\u5B58"),a()()()()()()}if(n&2){let t=v();f(4),E(t.editingUser()?"\u7DE8\u8F2F\u4F7F\u7528\u8005":"\u65B0\u589E\u4F7F\u7528\u8005"),f(4),M("formGroup",t.userForm),f(14),L(t.roles()),f(6),L(t.statuses()),f(5),M("disabled",t.userForm.invalid)}}function VU(n,e){if(n&1){let t=B();l(0,"div",20)(1,"div",48)(2,"div",49)(3,"div",50),x(4,"ion-icon",51),a(),l(5,"h3",52),c(6,"\u78BA\u5B9A\u8981\u522A\u9664\u4F7F\u7528\u8005\u55CE\uFF1F"),a(),l(7,"p",53),c(8),a()(),l(9,"div",54)(10,"button",46),b("click",function(){w(t);let r=v();return T(r.cancelDelete())}),c(11,"\u53D6\u6D88"),a(),l(12,"button",55),b("click",function(){w(t);let r=v();return T(r.confirmDelete())}),c(13,"\u78BA\u8A8D\u522A\u9664"),a()()()()}n&2&&(f(8),V("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u300C",e.name,"\u300D\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"))}var na=class na{constructor(){this.baseUrl=`${yn.apiUrl}/admin`;this.authService=P(nt);this.fb=P(He);this.http=P(Qt);this.isModalOpen=S(!1);this.editingUser=S(null);this.userToDelete=S(null);this.searchTerm=S("");this.roleFilter=S("");this.statusFilter=S("");this.users=S([]);this.roleOptions=S([]);this.roles=S(["\u8D85\u7D1A\u7BA1\u7406\u54E1","\u7BA1\u7406\u54E1","\u8CA1\u52D9","\u71DF\u904B"]);this.statuses=S(["\u555F\u7528","\u505C\u7528"]);this.isLoading=S(!1);this.error=S(null);this.userForm=this.fb.group({name:["",U.required],email:["",[U.required,U.email]],role:["\u71DF\u904B",U.required],status:["\u555F\u7528",U.required]});this.filteredUsers=H(()=>{let e=this.searchTerm().toLowerCase(),t=this.roleFilter(),i=this.statusFilter();return this.users().filter(r=>!t||r.role===t).filter(r=>!i||r.status===i).filter(r=>!e||r.name.toLowerCase().includes(e)||r.email.toLowerCase().includes(e))})}resetFilters(){this.searchTerm.set(""),this.roleFilter.set(""),this.statusFilter.set("")}ngOnInit(){this.loadRoles(),this.loadUsers()}loadRoles(){let e=this.getAuthHeaders();e&&this.http.get(`${this.baseUrl}/roles?limit=100`,{headers:e}).subscribe({next:t=>{let i=t?.data||[];this.roleOptions.set(i),i.length>0&&this.roles.set(i.map(r=>r.display_name))},error:()=>{}})}loadUsers(){let e=this.getAuthHeaders();if(!e){this.error.set("\u5C1A\u672A\u767B\u5165");return}this.isLoading.set(!0),this.error.set(null);let t=[];this.searchTerm()&&t.push(`search=${encodeURIComponent(this.searchTerm())}`);let i=this.mapRoleToCode(this.roleFilter()||void 0);i&&t.push(`role=${encodeURIComponent(i)}`);let r=t.length?`?${t.join("&")}`:"";this.http.get(`${this.baseUrl}/users${r}`,{headers:e}).subscribe({next:o=>{let u=(o?.data||[]).map(d=>this.mapUser(d));this.users.set(u),this.isLoading.set(!1)},error:o=>{this.error.set(o.error?.error||"\u8F09\u5165\u4F7F\u7528\u8005\u5931\u6557"),this.isLoading.set(!1)}})}openModal(e=null){this.editingUser.set(e),this.userForm.reset({role:"\u71DF\u904B",status:"\u555F\u7528"}),e&&this.userForm.patchValue(e),this.userForm.updateValueAndValidity(),this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1)}handleFormSubmit(){if(this.userForm.invalid)return;let e=this.getAuthHeaders();if(!e){this.error.set("\u5C1A\u672A\u767B\u5165");return}let t=this.userForm.value,i=this.mapRoleToId(t.role),r={name:t.name,email:t.email,status:this.mapStatusToApi(t.status),roleIds:i?[i]:[]};if(this.editingUser()){let o=this.editingUser().id;this.http.put(`${this.baseUrl}/users/${o}`,r,{headers:e}).subscribe({next:()=>{this.closeModal(),this.loadUsers()},error:s=>{this.error.set(s.error?.error||"\u66F4\u65B0\u4F7F\u7528\u8005\u5931\u6557")}});return}this.http.post(`${this.baseUrl}/users`,r,{headers:e}).subscribe({next:()=>{this.closeModal(),this.loadUsers()},error:o=>{this.error.set(o.error?.error||"\u65B0\u589E\u4F7F\u7528\u8005\u5931\u6557")}})}requestDelete(e){this.userToDelete.set(e)}confirmDelete(){if(!this.userToDelete())return;let e=this.getAuthHeaders();if(!e){this.error.set("\u5C1A\u672A\u767B\u5165");return}let t=this.userToDelete().id;this.http.delete(`${this.baseUrl}/users/${t}`,{headers:e}).subscribe({next:()=>{this.cancelDelete(),this.loadUsers()},error:i=>{this.error.set(i.error?.error||"\u522A\u9664\u4F7F\u7528\u8005\u5931\u6557")}})}cancelDelete(){this.userToDelete.set(null)}getRoleClass(e){switch(e){case"\u7BA1\u7406\u54E1":return"bg-red-100 text-red-800";case"\u8CA1\u52D9":return"bg-blue-100 text-blue-800";case"\u71DF\u904B":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}}getStatusClass(e){return e==="\u555F\u7528"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}getAuthHeaders(){let e=this.authService.getToken();return e?new Ot({Authorization:`Bearer ${e}`,"Content-Type":"application/json"}):null}mapUser(e){let t=e.role_names&&e.role_names[0]||e.role_codes&&e.role_codes[0]||"\u71DF\u904B",i=this.normalizeRole(t),r=this.mapStatusFromApi(e.status);return{id:String(e.admin_id),name:e.name,email:e.email,role:i,status:r,lastLogin:this.formatDate(e.last_login_at)}}normalizeRole(e){return e==="super_admin"||e==="\u8D85\u7D1A\u7BA1\u7406\u54E1"?"\u8D85\u7D1A\u7BA1\u7406\u54E1":e==="admin"||e==="\u7BA1\u7406\u54E1"?"\u7BA1\u7406\u54E1":e==="finance"||e==="\u8CA1\u52D9"?"\u8CA1\u52D9":"\u71DF\u904B"}mapRoleToId(e){return e?this.roleOptions().find(i=>i.display_name===e||i.role_name===e)?.role_id??null:null}mapRoleToCode(e){return e?this.roleOptions().find(i=>i.display_name===e||i.role_name===e)?.role_name??null:null}mapStatusToApi(e){if(e)return e==="\u555F\u7528"?"active":"inactive"}mapStatusFromApi(e){return e==="active"?"\u555F\u7528":"\u505C\u7528"}formatDate(e){return e?new Date(e).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-"}};na.\u0275fac=function(t){return new(t||na)},na.\u0275cmp=ie({type:na,selectors:[["app-user-management"]],decls:49,vars:6,consts:[[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","add-outline"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","p-4","bg-gray-50","rounded-lg","mb-6"],[1,"md:col-span-2"],["type","text","placeholder","\u641C\u5C0B\u540D\u7A31\u6216 Email...",1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],[1,"w-full","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-white",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"flex","items-center","gap-2","md:col-span-4","justify-end"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","whitespace-nowrap"],[1,"text-xs","text-gray-700","uppercase","bg-gray-100"],[1,"px-4","py-3"],[1,"border-b","hover:bg-gray-50"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"px-4","py-2","font-medium"],[1,"px-4","py-2"],[1,"px-2","py-1","text-xs","font-semibold","rounded-full"],[1,"px-4","py-2","text-gray-500"],[1,"flex","items-center","gap-2"],["title","\u7DE8\u8F2F",1,"text-indigo-600","hover:text-indigo-800","p-1",3,"click"],["name","create-outline",1,"text-lg"],["title","\u522A\u9664",1,"text-red-500","hover:text-red-700","p-1",3,"click"],["name","trash-outline",1,"text-lg"],["colspan","6",1,"text-center","py-8","text-gray-500"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-lg","m-4"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"block"],[1,"text-gray-700"],["formControlName","name",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["type","email","formControlName","email",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"grid","grid-cols-2","gap-4"],["formControlName","role",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["formControlName","status",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","disabled:bg-indigo-300",3,"disabled"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","m-4"],[1,"p-6","text-center"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100"],["name","warning-outline",1,"h-6","w-6","text-red-600"],[1,"mt-4","text-lg","font-semibold","text-gray-900"],[1,"mt-2","text-sm","text-gray-500"],[1,"flex","justify-center","gap-4","bg-gray-50","px-6","py-4","rounded-b-xl"],["type","button",1,"px-4","py-2","bg-red-600","text-white","rounded-md","hover:bg-red-700",3,"click"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),c(3,"\u4F7F\u7528\u8005\u7BA1\u7406"),a(),l(4,"button",3),b("click",function(){return i.openModal(null)}),x(5,"ion-icon",4),l(6,"span"),c(7,"\u65B0\u589E\u4F7F\u7528\u8005"),a()()(),l(8,"div",5)(9,"div",6)(10,"div",7)(11,"input",8),b("ngModelChange",function(o){return i.searchTerm.set(o)}),a()(),l(12,"div")(13,"select",9),b("ngModelChange",function(o){return i.roleFilter.set(o)}),l(14,"option",10),c(15,"\u6240\u6709\u89D2\u8272"),a(),O(16,MU,2,2,"option",11,W),a()(),l(18,"div")(19,"select",9),b("ngModelChange",function(o){return i.statusFilter.set(o)}),l(20,"option",10),c(21,"\u6240\u6709\u72C0\u614B"),a(),O(22,AU,2,2,"option",11,W),a()(),l(24,"div",12)(25,"button",13),b("click",function(){return i.resetFilters()}),x(26,"ion-icon",14),a()()(),l(27,"div",15)(28,"table",16)(29,"thead",17)(30,"tr")(31,"th",18),c(32,"\u540D\u7A31"),a(),l(33,"th",18),c(34,"Email"),a(),l(35,"th",18),c(36,"\u89D2\u8272"),a(),l(37,"th",18),c(38,"\u72C0\u614B"),a(),l(39,"th",18),c(40,"\u6700\u5F8C\u767B\u5165"),a(),l(41,"th",18),c(42,"\u64CD\u4F5C"),a()()(),l(43,"tbody"),O(44,NU,19,9,"tr",19,IU,!1,RU,3,0,"tr"),a()()()()(),A(47,kU,35,3,"div",20),A(48,VU,14,1,"div",20)),t&2){let r;f(11),M("ngModel",i.searchTerm()),f(2),M("ngModel",i.roleFilter()),f(3),L(i.roles()),f(3),M("ngModel",i.statusFilter()),f(3),L(i.statuses()),f(22),L(i.filteredUsers()),f(3),N(i.isModalOpen()?47:-1),f(),N((r=i.userToDelete())?48:-1,r)}},dependencies:[re,Oe,$e,ke,Ve,Ce,Ae,me,Fe,Pe,Be,be,Ie],encapsulation:2,changeDetection:0});var hp=na;var yp=(n,e)=>e.id;function OU(n,e){if(n&1&&(l(0,"option",10),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),E(t)}}function LU(n,e){if(n&1&&(l(0,"option",10),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),E(t)}}function BU(n,e){if(n&1&&(l(0,"option",10),c(1),a()),n&2){let t=e.$implicit;M("value",t.id),f(),E(t.name)}}function UU(n,e){if(n&1&&(l(0,"div",45),x(1,"ion-icon",46),l(2,"span"),c(3),a()()),n&2){let t=e,i=v(2);De(i.getDaysLeftClass(t.days,t.label)),f(3),E(t.label==="\u5DF2\u903E\u671F"?t.label+" "+t.days+" \u5929":t.days+" "+t.label)}}function $U(n,e){if(n&1&&x(0,"img",34),n&2){let t=v().$implicit,i=v();M("src",i.getAssigneeAvatarUrl(t.assigneeId),$t)}}function HU(n,e){n&1&&(l(0,"div",35),x(1,"ion-icon",47),a())}function GU(n,e){if(n&1){let t=B();l(0,"input",55),b("blur",function(r){w(t);let o=v(2).$implicit,s=v();return T(s.finishEditingProgress(o,r))})("keydown.enter",function(r){w(t);let o=v(2).$implicit,s=v();return T(s.finishEditingProgress(o,r))}),a()}if(n&2){let t=v(2).$implicit;M("value",t.currentValue)}}function qU(n,e){if(n&1&&(l(0,"span",51),c(1),a()),n&2){let t=v(2).$implicit,i=v();f(),E(i.formatNumber(t.currentValue))}}function WU(n,e){if(n&1&&x(0,"div",56),n&2){let t=v();gn("width",t,"%")}}function jU(n,e){if(n&1&&x(0,"div",57),n&2){let t=v();gn("width",t,"%")}}function zU(n,e){if(n&1){let t=B();l(0,"div",48)(1,"div",49,0),b("click",function(){w(t);let r=Dn(2),o=v().$implicit,s=v();return T(s.startEditingProgress(o.id,r))}),A(3,GU,1,1,"input",50)(4,qU,2,1,"span",51),c(5),a(),l(6,"span"),c(7),a()(),l(8,"div",52),A(9,WU,1,2,"div",53)(10,jU,1,2,"div",54),a()}if(n&2){let t=e,i=v().$implicit,r=v();f(3),N(r.editingProgressId()===i.id?3:4),f(2),ut(" / ",r.formatNumber(i.targetValue)," ",i.unit," "),f(),De(t<100?"text-indigo-600":"text-green-600"),f(),V("",t.toFixed(0),"%"),f(2),N(t<100?9:10)}}function YU(n,e){if(n&1){let t=B();l(0,"div",23)(1,"div",29)(2,"h3",30),c(3),a(),A(4,UU,4,3,"div",31),a(),l(5,"div",32)(6,"div",33),A(7,$U,1,1,"img",34)(8,HU,2,0,"div",35),l(9,"span",36),c(10),a()(),l(11,"span",37),c(12),a(),l(13,"span",38),c(14),a()(),l(15,"div",39),A(16,zU,11,7),a(),l(17,"div",40)(18,"button",41),b("click",function(){let r=w(t).$implicit,o=v();return T(o.openModal(r))}),x(19,"ion-icon",42),a(),l(20,"button",43),b("click",function(){let r=w(t).$implicit,o=v();return T(o.requestDelete(r))}),x(21,"ion-icon",44),a()()()}if(n&2){let t,i,r=e.$implicit,o=v();f(3),E(r.title),f(),N((t=o.getDaysLeft(r.endDate))?4:-1,t),f(3),N(r.assigneeId?7:8),f(3),E(o.getAssigneeName(r.assigneeId)),f(),De(o.getTypeClass(r.type)),f(),E(r.type),f(),De(o.getStatusClass(r.status)),f(),E(r.status),f(2),N((i=o.getProgressBarWidth(r))?16:-1,i)}}function JU(n,e){n&1&&(l(0,"div",24),x(1,"ion-icon",58),l(2,"p",59),c(3,"\u7121\u7B26\u5408\u689D\u4EF6\u7684\u6708\u5EA6\u76EE\u6A19\u3002"),a()())}function KU(n,e){if(n&1&&(l(0,"div",45),x(1,"ion-icon",46),l(2,"span"),c(3),a()()),n&2){let t=e,i=v(2);De(i.getDaysLeftClass(t.days,t.label)),f(3),E(t.label==="\u5DF2\u903E\u671F"?t.label+" "+t.days+" \u5929":t.days+" "+t.label)}}function QU(n,e){if(n&1&&x(0,"img",34),n&2){let t=v().$implicit,i=v();M("src",i.getAssigneeAvatarUrl(t.assigneeId),$t)}}function ZU(n,e){n&1&&(l(0,"div",35),x(1,"ion-icon",47),a())}function XU(n,e){if(n&1){let t=B();l(0,"input",65),b("blur",function(r){w(t);let o=v(2).$implicit,s=v();return T(s.finishEditingProgress(o,r))})("keydown.enter",function(r){w(t);let o=v(2).$implicit,s=v();return T(s.finishEditingProgress(o,r))}),a()}if(n&2){let t=v(2).$implicit;M("value",t.currentValue)}}function e$(n,e){if(n&1&&(l(0,"span",63),c(1),a()),n&2){let t=v(2).$implicit,i=v();f(),E(i.formatNumber(t.currentValue))}}function t$(n,e){if(n&1&&x(0,"div",66),n&2){let t=v();gn("width",t,"%")}}function n$(n,e){if(n&1&&x(0,"div",57),n&2){let t=v();gn("width",t,"%")}}function i$(n,e){if(n&1){let t=B();l(0,"div",48)(1,"div",49,0),b("click",function(){w(t);let r=Dn(2),o=v().$implicit,s=v();return T(s.startEditingProgress(o.id,r))}),A(3,XU,1,1,"input",62)(4,e$,2,1,"span",63),c(5),a(),l(6,"span"),c(7),a()(),l(8,"div",52),A(9,t$,1,2,"div",64)(10,n$,1,2,"div",54),a()}if(n&2){let t=e,i=v().$implicit,r=v();f(3),N(r.editingProgressId()===i.id?3:4),f(2),ut(" / ",r.formatNumber(i.targetValue)," ",i.unit," "),f(),De(t<100?"text-teal-600":"text-green-600"),f(),V("",t.toFixed(0),"%"),f(2),N(t<100?9:10)}}function r$(n,e){if(n&1){let t=B();l(0,"div",27)(1,"div",29)(2,"h3",60),c(3),a(),A(4,KU,4,3,"div",31),a(),l(5,"div",32)(6,"div",33),A(7,QU,1,1,"img",34)(8,ZU,2,0,"div",35),l(9,"span",36),c(10),a()(),l(11,"span",37),c(12),a(),l(13,"span",38),c(14),a()(),l(15,"div",39),A(16,i$,11,7),a(),l(17,"div",40)(18,"button",61),b("click",function(){let r=w(t).$implicit,o=v();return T(o.openModal(r))}),x(19,"ion-icon",42),a(),l(20,"button",43),b("click",function(){let r=w(t).$implicit,o=v();return T(o.requestDelete(r))}),x(21,"ion-icon",44),a()()()}if(n&2){let t,i,r=e.$implicit,o=v();f(3),E(r.title),f(),N((t=o.getDaysLeft(r.endDate))?4:-1,t),f(3),N(r.assigneeId?7:8),f(3),E(o.getAssigneeName(r.assigneeId)),f(),De(o.getTypeClass(r.type)),f(),E(r.type),f(),De(o.getStatusClass(r.status)),f(),E(r.status),f(2),N((i=o.getProgressBarWidth(r))?16:-1,i)}}function o$(n,e){n&1&&(l(0,"div",24),x(1,"ion-icon",58),l(2,"p",59),c(3,"\u7121\u7B26\u5408\u689D\u4EF6\u7684\u5E74\u5EA6\u76EE\u6A19\u3002"),a()())}function s$(n,e){if(n&1&&(l(0,"option",10),c(1),a()),n&2){let t=e.$implicit;M("value",t),f(),E(t)}}function a$(n,e){if(n&1&&(l(0,"option",10),c(1),a()),n&2){let t=e.$implicit;M("value",t.id),f(),E(t.name)}}function l$(n,e){if(n&1){let t=B();l(0,"div",28)(1,"div",67)(2,"div",68)(3,"h3",69),c(4),a(),l(5,"button",70),b("click",function(){w(t);let r=v();return T(r.closeModal())}),x(6,"ion-icon",71),a()(),l(7,"div",72)(8,"form",73),b("ngSubmit",function(){w(t);let r=v();return T(r.handleFormSubmit())}),l(9,"div")(10,"label",74),c(11,"\u76EE\u6A19\u540D\u7A31*"),a(),x(12,"input",75),a(),l(13,"div",76)(14,"div")(15,"label",77),c(16,"\u985E\u578B*"),a(),l(17,"select",78),O(18,s$,2,2,"option",10,W),a()(),l(20,"div")(21,"label",79),c(22,"\u9031\u671F*"),a(),l(23,"select",80)(24,"option",81),c(25,"\u6708\u5EA6"),a(),l(26,"option",82),c(27,"\u5E74\u5EA6"),a()()(),l(28,"div")(29,"label",83),c(30,"\u55AE\u4F4D*"),a(),x(31,"input",84),a()(),l(32,"div",85)(33,"div")(34,"label",86),c(35,"\u76EE\u524D\u9032\u5EA6*"),a(),x(36,"input",87),a(),l(37,"div")(38,"label",88),c(39,"\u76EE\u6A19\u503C*"),a(),x(40,"input",89),a()(),l(41,"div",85)(42,"div")(43,"label",90),c(44,"\u958B\u59CB\u65E5\u671F*"),a(),x(45,"input",91),a(),l(46,"div")(47,"label",92),c(48,"\u7D50\u675F\u65E5\u671F*"),a(),x(49,"input",93),a()(),l(50,"div")(51,"label",94),c(52,"\u8CA0\u8CAC\u4EBA"),a(),l(53,"select",95)(54,"option",9),c(55,"\u5718\u968A\u76EE\u6A19 (\u7121\u6307\u5B9A\u8CA0\u8CAC\u4EBA)"),a(),O(56,a$,2,2,"option",10,yp),a()(),l(58,"div",96)(59,"button",97),b("click",function(){w(t);let r=v();return T(r.closeModal())}),c(60,"\u53D6\u6D88"),a(),l(61,"button",98),c(62,"\u5132\u5B58"),a()()()()()()}if(n&2){let t=v();f(4),E(t.editingGoal()?"\u7DE8\u8F2F\u5718\u968A\u76EE\u6A19":"\u65B0\u589E\u5718\u968A\u76EE\u6A19"),f(4),M("formGroup",t.goalForm),f(10),L(t.goalTypes),f(38),L(t.users()),f(5),M("disabled",t.goalForm.invalid)}}function u$(n,e){if(n&1){let t=B();l(0,"div",28)(1,"div",99)(2,"div",100)(3,"div",101),x(4,"ion-icon",102),a(),l(5,"h3",103),c(6,"\u78BA\u5B9A\u8981\u522A\u9664\u5718\u968A\u76EE\u6A19\u55CE\uFF1F"),a(),l(7,"p",104),c(8),a()(),l(9,"div",105)(10,"button",97),b("click",function(){w(t);let r=v();return T(r.cancelDelete())}),c(11,"\u53D6\u6D88"),a(),l(12,"button",106),b("click",function(){w(t);let r=v();return T(r.confirmDelete())}),c(13,"\u78BA\u8A8D\u522A\u9664"),a()()()()}n&2&&(f(8),V("\u60A8\u78BA\u5B9A\u8981\u522A\u9664\u5718\u968A\u76EE\u6A19\u300C",e.title,"\u300D\u55CE\uFF1F\u6B64\u64CD\u4F5C\u7121\u6CD5\u5FA9\u539F\u3002"))}var ia=class ia{constructor(){this.dataService=P(Tt);this.authService=P(nt);this.fb=P(He);this.isModalOpen=S(!1);this.editingGoal=S(null);this.goalToDelete=S(null);this.editingProgressId=S(null);this.statusFilter=S("");this.typeFilter=S("");this.assigneeFilter=S("");this.allGoals=S([]);this.users=S([]);this.goalTypes=["\u71DF\u6536","\u6D3B\u52D5","\u9867\u5BA2","\u5176\u4ED6"];this.goalStatuses=["\u9032\u884C\u4E2D","\u5DF2\u9054\u6210","\u672A\u9054\u6210"];this.goalForm=this.fb.group({title:["",U.required],type:["\u71DF\u6536",U.required],period:["monthly",U.required],targetValue:[null,[U.required,U.min(1)]],currentValue:[0,[U.required,U.min(0)]],unit:["\u5143",U.required],startDate:["",U.required],endDate:["",U.required],assigneeId:[""]});this.baseFilteredGoals=H(()=>{let e=this.statusFilter(),t=this.typeFilter(),i=this.assigneeFilter();return this.allGoals().filter(r=>!e||r.status===e).filter(r=>!t||r.type===t).filter(r=>!i||i==="all"?!0:i==="team"?!r.assigneeId:r.assigneeId===i).sort((r,o)=>new Date(o.startDate).getTime()-new Date(r.startDate).getTime())});this.monthlyGoals=H(()=>this.baseFilteredGoals().filter(e=>e.period==="monthly"));this.yearlyGoals=H(()=>this.baseFilteredGoals().filter(e=>e.period==="yearly"));this.loadData()}loadData(){this.allGoals.set(this.dataService.getTargetGoals()),this.users.set([])}resetFilters(){this.statusFilter.set(""),this.typeFilter.set(""),this.assigneeFilter.set("")}openModal(e=null){if(this.editingGoal.set(e),e)this.goalForm.patchValue(e);else{let t=new Date,i=new Date(t.getFullYear(),t.getMonth(),1).toISOString().split("T")[0],r=new Date(t.getFullYear(),t.getMonth()+1,0).toISOString().split("T")[0];this.goalForm.reset({type:"\u71DF\u6536",period:"monthly",currentValue:0,unit:"\u5143",startDate:i,endDate:r,assigneeId:""})}this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1)}handleFormSubmit(){if(this.goalForm.invalid)return;let e=this.goalForm.value,t=this.editingGoal(),i={title:e.title,type:e.type,targetValue:e.targetValue,currentValue:e.currentValue,unit:e.unit,startDate:e.startDate,endDate:e.endDate,assigneeId:e.assigneeId||void 0,status:e.currentValue>=e.targetValue?"\u5DF2\u9054\u6210":"\u9032\u884C\u4E2D",period:e.period};t?this.dataService.updateTargetGoal(q(k({},i),{id:t.id})):this.dataService.addTargetGoal(i),this.loadData(),this.closeModal()}startEditingProgress(e,t){this.editingProgressId.set(e),setTimeout(()=>{t.querySelector("input")?.select()},0)}finishEditingProgress(e,t){let i=t.target,r=parseFloat(i.value);if(!isNaN(r)&&r!==e.currentValue){let o=q(k({},e),{currentValue:r});if(o.currentValue>=o.targetValue)o.status="\u5DF2\u9054\u6210";else{let s=new Date().toISOString().split("T")[0];o.status=s>o.endDate?"\u672A\u9054\u6210":"\u9032\u884C\u4E2D"}this.dataService.updateTargetGoal(o),this.loadData()}this.editingProgressId.set(null)}requestDelete(e){this.goalToDelete.set(e)}confirmDelete(){this.goalToDelete()&&(this.dataService.deleteTargetGoal(this.goalToDelete().id),this.loadData(),this.cancelDelete())}cancelDelete(){this.goalToDelete.set(null)}getProgressBarWidth(e){return e.targetValue===0?0:Math.min(e.currentValue/e.targetValue*100,100)}getAssigneeName(e){return e?this.users().find(t=>t.id===e)?.name||"\u672A\u77E5\u4F7F\u7528\u8005":"\u5718\u968A\u76EE\u6A19"}getAssigneeAvatarUrl(e){let t=this.getAssigneeName(e);return`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=random&color=fff&font-size=0.5`}getDaysLeft(e){let t=new Date(e),i=new Date;t.setHours(0,0,0,0),i.setHours(0,0,0,0);let r=t.getTime()-i.getTime(),o=Math.ceil(r/(1e3*60*60*24));return o<0?{days:Math.abs(o),label:"\u5DF2\u903E\u671F"}:{days:o,label:"\u5929\u5269\u9918"}}getDaysLeftClass(e,t){return t==="\u5DF2\u903E\u671F"?"text-red-500":e<=7?"text-yellow-600":"text-gray-500"}getGoalTypeIcon(e){switch(e){case"\u71DF\u6536":return"cash-outline";case"\u6D3B\u52D5":return"calendar-outline";case"\u9867\u5BA2":return"people-outline";default:return"trophy-outline"}}getTypeClass(e){switch(e){case"\u71DF\u6536":return"bg-green-100 text-green-800";case"\u6D3B\u52D5":return"bg-purple-100 text-purple-800";case"\u9867\u5BA2":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}}getStatusClass(e){switch(e){case"\u9032\u884C\u4E2D":return"bg-blue-100 text-blue-800";case"\u5DF2\u9054\u6210":return"bg-green-100 text-green-800";case"\u672A\u9054\u6210":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}formatNumber(e){return e.toLocaleString("en-US")}};ia.\u0275fac=function(t){return new(t||ia)},ia.\u0275cmp=ie({type:ia,selectors:[["app-goal-setting"]],decls:57,vars:7,consts:[["progressEditor",""],[1,"space-y-6"],[1,"flex","flex-wrap","items-center","justify-between","gap-4"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","text-sm",3,"click"],["name","add-outline"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","p-4","bg-white","rounded-xl","shadow-md"],["for","typeFilter",1,"text-sm","font-medium","text-gray-600"],["id","typeFilter",1,"w-full","mt-1","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-50",3,"ngModelChange","ngModel"],["value",""],[3,"value"],["for","statusFilter",1,"text-sm","font-medium","text-gray-600"],["id","statusFilter",1,"w-full","mt-1","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-50",3,"ngModelChange","ngModel"],["for","assigneeFilter",1,"text-sm","font-medium","text-gray-600"],["id","assigneeFilter",1,"w-full","mt-1","border-gray-300","rounded-lg","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500","text-sm","p-2","bg-gray-50",3,"ngModelChange","ngModel"],["value","team"],[1,"flex","items-end","justify-end"],["title","\u91CD\u8A2D\u7BE9\u9078",1,"text-gray-500","hover:text-gray-800","transition-colors","p-2","rounded-full","bg-gray-100","hover:bg-gray-200",3,"click"],["name","refresh-outline",1,"text-xl"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-8","pt-4"],[1,"text-2xl","font-bold","text-gray-800","mb-4","pb-2","border-b-2","border-indigo-500","flex","items-center","gap-2"],["name","calendar-outline"],[1,"space-y-4"],[1,"bg-white","rounded-lg","shadow-sm","border","p-4","flex","flex-col","group","relative","transition-all","duration-300","hover:shadow-md","hover:border-indigo-300"],[1,"bg-white","p-6","rounded-xl","border","text-center","text-gray-500"],[1,"text-2xl","font-bold","text-gray-800","mb-4","pb-2","border-b-2","border-teal-500","flex","items-center","gap-2"],["name","podium-outline"],[1,"bg-white","rounded-lg","shadow-sm","border","p-4","flex","flex-col","group","relative","transition-all","duration-300","hover:shadow-md","hover:border-teal-300"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"flex","justify-between","items-start","gap-2"],[1,"font-bold","text-gray-800","group-hover:text-indigo-600","transition-colors"],[1,"flex","items-center","text-xs","font-medium","shrink-0",3,"class"],[1,"flex","items-center","gap-4","text-sm","text-gray-500","mt-2"],[1,"flex","items-center","gap-2"],["alt","avatar",1,"w-5","h-5","rounded-full",3,"src"],[1,"w-5","h-5","rounded-full","bg-gray-200","flex","items-center","justify-center"],[1,"font-medium","text-xs"],[1,"text-xs","font-semibold","px-2","py-0.5","rounded-full"],[1,"text-xs","font-semibold","px-2","py-1","rounded-full"],[1,"mt-3"],[1,"absolute","top-2","right-2","flex","items-center","gap-1","bg-white/50","backdrop-blur-sm","rounded-full","p-1","opacity-0","group-hover:opacity-100","transition-opacity","duration-300"],["title","\u7DE8\u8F2F",1,"text-gray-500","hover:text-indigo-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],["name","create-outline"],["title","\u522A\u9664",1,"text-gray-500","hover:text-red-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],["name","trash-outline"],[1,"flex","items-center","text-xs","font-medium","shrink-0"],["name","time-outline",1,"mr-1"],["name","people-outline",1,"text-gray-500","text-xs"],[1,"flex","justify-between","items-center","mb-1","text-xs","font-medium"],[1,"text-gray-600",3,"click"],["type","number",1,"w-20","p-0.5","text-center","border","border-indigo-500","rounded-md","bg-white","text-xs",3,"value"],[1,"font-semibold","text-indigo-600","p-1","cursor-pointer","hover:bg-gray-100","rounded-md"],[1,"w-full","bg-slate-100","rounded-full","h-1.5"],[1,"bg-indigo-600","h-1.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #818cf8, #4f46e5)",3,"width"],[1,"bg-green-500","h-1.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #4ade80, #16a34a)",3,"width"],["type","number",1,"w-20","p-0.5","text-center","border","border-indigo-500","rounded-md","bg-white","text-xs",3,"blur","keydown.enter","value"],[1,"bg-indigo-600","h-1.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #818cf8, #4f46e5)"],[1,"bg-green-500","h-1.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #4ade80, #16a34a)"],["name","trophy-outline",1,"text-4xl","text-gray-400"],[1,"mt-2"],[1,"font-bold","text-gray-800","group-hover:text-teal-600","transition-colors"],["title","\u7DE8\u8F2F",1,"text-gray-500","hover:text-teal-600","p-1.5","rounded-full","hover:bg-gray-100",3,"click"],["type","number",1,"w-20","p-0.5","text-center","border","border-teal-500","rounded-md","bg-white","text-xs",3,"value"],[1,"font-semibold","text-teal-600","p-1","cursor-pointer","hover:bg-gray-100","rounded-md"],[1,"bg-teal-600","h-1.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #5eead4, #0d9488)",3,"width"],["type","number",1,"w-20","p-0.5","text-center","border","border-teal-500","rounded-md","bg-white","text-xs",3,"blur","keydown.enter","value"],[1,"bg-teal-600","h-1.5","rounded-full","transition-all","duration-500",2,"background-image","linear-gradient(to right, #5eead4, #0d9488)"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-lg","max-h-[90vh]","flex","flex-col","m-4"],[1,"flex","justify-between","items-center","p-4","border-b"],[1,"text-lg","font-semibold"],[1,"text-gray-400","hover:text-gray-600",3,"click"],["name","close-outline",1,"text-2xl"],[1,"p-6","overflow-y-auto"],[1,"space-y-4",3,"ngSubmit","formGroup"],["for","title",1,"block","text-sm","font-medium","text-gray-700"],["id","title","formControlName","title",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],["for","type",1,"block","text-sm","font-medium","text-gray-700"],["id","type","formControlName","type",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","period",1,"block","text-sm","font-medium","text-gray-700"],["id","period","formControlName","period",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["value","monthly"],["value","yearly"],["for","unit",1,"block","text-sm","font-medium","text-gray-700"],["id","unit","formControlName","unit","placeholder","\u5143, \u5834, \u4EBA",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["for","currentValue",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","currentValue","formControlName","currentValue",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","targetValue",1,"block","text-sm","font-medium","text-gray-700"],["type","number","id","targetValue","formControlName","targetValue",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","startDate",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","startDate","formControlName","startDate",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","endDate",1,"block","text-sm","font-medium","text-gray-700"],["type","date","id","endDate","formControlName","endDate",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],["for","assigneeId",1,"block","text-sm","font-medium","text-gray-700"],["id","assigneeId","formControlName","assigneeId",1,"mt-1","block","w-full","rounded-md","border-gray-300","shadow-sm","bg-gray-50","p-2"],[1,"flex","justify-end","gap-4","pt-4","border-t","mt-4"],["type","button",1,"px-4","py-2","border","rounded-md",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","rounded-md","disabled:bg-indigo-300",3,"disabled"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","m-4"],[1,"p-6","text-center"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100"],["name","warning-outline",1,"h-6","w-6","text-red-600"],[1,"mt-4","text-lg","font-semibold","text-gray-900"],[1,"mt-2","text-sm","text-gray-500"],[1,"flex","justify-center","gap-4","bg-gray-50","px-6","py-4","rounded-b-xl"],["type","button",1,"px-4","py-2","bg-red-600","text-white","rounded-md","hover:bg-red-700",3,"click"]],template:function(t,i){if(t&1&&(l(0,"div",1)(1,"div",2)(2,"h1",3),c(3,"\u5718\u968A\u76EE\u6A19\u8A2D\u5B9A"),a(),l(4,"button",4),b("click",function(){return i.openModal(null)}),x(5,"ion-icon",5),l(6,"span"),c(7,"\u65B0\u589E\u5718\u968A\u76EE\u6A19"),a()()(),l(8,"div",6)(9,"div")(10,"label",7),c(11,"\u985E\u578B"),a(),l(12,"select",8),Z("ngModelChange",function(o){return ee(i.typeFilter,o)||(i.typeFilter=o),o}),l(13,"option",9),c(14,"\u6240\u6709\u985E\u578B"),a(),O(15,OU,2,2,"option",10,W),a()(),l(17,"div")(18,"label",11),c(19,"\u72C0\u614B"),a(),l(20,"select",12),Z("ngModelChange",function(o){return ee(i.statusFilter,o)||(i.statusFilter=o),o}),l(21,"option",9),c(22,"\u6240\u6709\u72C0\u614B"),a(),O(23,LU,2,2,"option",10,W),a()(),l(25,"div")(26,"label",13),c(27,"\u8CA0\u8CAC\u4EBA"),a(),l(28,"select",14),Z("ngModelChange",function(o){return ee(i.assigneeFilter,o)||(i.assigneeFilter=o),o}),l(29,"option",9),c(30,"\u6240\u6709\u4EBA"),a(),l(31,"option",15),c(32,"\u5718\u968A\u76EE\u6A19"),a(),O(33,BU,2,2,"option",10,yp),a()(),l(35,"div",16)(36,"button",17),b("click",function(){return i.resetFilters()}),x(37,"ion-icon",18),a()()(),l(38,"div",19)(39,"div")(40,"h2",20),x(41,"ion-icon",21),c(42," \u6708\u5EA6\u76EE\u6A19 "),a(),l(43,"div",22),O(44,YU,22,11,"div",23,yp,!1,JU,4,0,"div",24),a()(),l(47,"div")(48,"h2",25),x(49,"ion-icon",26),c(50," \u5E74\u5EA6\u76EE\u6A19 "),a(),l(51,"div",22),O(52,r$,22,11,"div",27,yp,!1,o$,4,0,"div",24),a()()()(),A(55,l$,63,3,"div",28),A(56,u$,14,1,"div",28)),t&2){let r;f(12),Q("ngModel",i.typeFilter),f(3),L(i.goalTypes),f(5),Q("ngModel",i.statusFilter),f(3),L(i.goalStatuses),f(5),Q("ngModel",i.assigneeFilter),f(5),L(i.users()),f(11),L(i.monthlyGoals()),f(8),L(i.yearlyGoals()),f(3),N(i.isModalOpen()?55:-1),f(),N((r=i.goalToDelete())?56:-1,r)}},dependencies:[re,Oe,$e,ke,Ve,Ce,Ft,Ae,me,Fe,Pe,Be,be,Ie],encapsulation:2,changeDetection:0});var _p=ia;var d$=(n,e)=>e.targetId;function c$(n,e){if(n&1&&(l(0,"div",5)(1,"div",12),x(2,"ion-icon",13),l(3,"p",14),c(4),a()()()),n&2){let t=v();f(4),E(t.successMessage())}}function m$(n,e){if(n&1&&(l(0,"div",6)(1,"div",12),x(2,"ion-icon",15),l(3,"p",16),c(4),a()()()),n&2){let t=v();f(4),E(t.error())}}function p$(n,e){n&1&&(l(0,"div",8)(1,"div",17),x(2,"div",18),l(3,"p",19),c(4,"\u8F09\u5165\u8CC7\u6599\u4E2D..."),a()()())}function f$(n,e){if(n&1){let t=B();l(0,"tr",25)(1,"td",26),c(2),a(),l(3,"td",23),c(4),a(),l(5,"td",23),c(6),a(),l(7,"td",27),c(8),a(),l(9,"td",28),c(10),a(),l(11,"td",29),c(12),a(),l(13,"td",22)(14,"div",30)(15,"button",31),b("click",function(){let r=w(t).$implicit,o=v(2);return T(o.openEditForm(r))}),x(16,"ion-icon",32),a(),l(17,"button",33),b("click",function(){let r=w(t).$implicit,o=v(2);return T(o.deleteTarget(r))}),x(18,"ion-icon",34),a()()()()}if(n&2){let t=e.$implicit,i=v(2);f(2),V(" ",i.formatMonth(t.targetMonth)," "),f(2),V(" ",i.formatCurrency(t.monthlyRevenueTarget)," "),f(2),V(" ",i.formatCurrency(t.eventRevenueTarget)," "),f(2),V(" ",i.formatCurrency(t.totalTarget)," "),f(2),V(" ",i.formatCurrency(t.dailyAvgTarget)," "),f(2),V(" ",t.remark||"-"," ")}}function g$(n,e){n&1&&(l(0,"tr")(1,"td",35),c(2," \u5C1A\u7121\u8CC7\u6599 "),a()())}function h$(n,e){if(n&1&&(l(0,"div",9)(1,"table",20)(2,"thead",21)(3,"tr")(4,"th",22),c(5,"\u6708\u4EFD"),a(),l(6,"th",23),c(7,"\u6708\u71DF\u696D\u76EE\u6A19"),a(),l(8,"th",23),c(9,"\u6D3B\u52D5\u71DF\u6536\u76EE\u6A19"),a(),l(10,"th",23),c(11,"\u7E3D\u76EE\u6A19"),a(),l(12,"th",23),c(13,"\u65E5\u5747\u76EE\u6A19"),a(),l(14,"th",22),c(15,"\u5099\u8A3B"),a(),l(16,"th",24),c(17,"\u64CD\u4F5C"),a()()(),l(18,"tbody"),O(19,f$,19,6,"tr",25,d$,!1,g$,3,0,"tr"),a()()()),n&2){let t=v();f(19),L(t.targets())}}function y$(n,e){n&1&&(l(0,"div",10),x(1,"ion-icon",36),l(2,"p",37),c(3,"\u5C1A\u7121\u71DF\u6536\u76EE\u6A19\u8CC7\u6599"),a(),l(4,"p",38),c(5,"\u9EDE\u64CA\u4E0A\u65B9\u300C\u65B0\u589E\u76EE\u6A19\u300D\u6309\u9215\u958B\u59CB\u8A2D\u5B9A"),a()())}function _$(n,e){if(n&1&&(l(0,"div",6)(1,"div",12),x(2,"ion-icon",57),l(3,"p",58),c(4),a()()()),n&2){let t=v(2);f(4),E(t.formError())}}function v$(n,e){n&1&&(l(0,"p",48),c(1,"\u6708\u4EFD\u4E0D\u53EF\u4FEE\u6539"),a())}function C$(n,e){n&1&&(x(0,"div",59),l(1,"span"),c(2,"\u8655\u7406\u4E2D..."),a())}function x$(n,e){if(n&1&&(x(0,"ion-icon",60),l(1,"span"),c(2),a()),n&2){let t=v(2);f(2),E(t.isEditing()?"\u66F4\u65B0":"\u65B0\u589E")}}function E$(n,e){if(n&1){let t=B();l(0,"div",11)(1,"div",39)(2,"div",40)(3,"h2",41),c(4),a(),l(5,"button",42),b("click",function(){w(t);let r=v();return T(r.closeForm())}),x(6,"ion-icon",43),a()(),l(7,"div",44),A(8,_$,5,1,"div",6),l(9,"div")(10,"label",45),c(11," \u6708\u4EFD "),l(12,"span",46),c(13,"*"),a()(),l(14,"input",47),b("ngModelChange",function(r){w(t);let o=v();return T(o.updateTargetMonth(r))}),a(),A(15,v$,2,0,"p",48),a(),l(16,"div")(17,"label",45),c(18," \u6708\u71DF\u696D\u76EE\u6A19 "),l(19,"span",46),c(20,"*"),a()(),l(21,"div",49)(22,"span",50),c(23,"NT$"),a(),l(24,"input",51),b("ngModelChange",function(r){w(t);let o=v();return T(o.updateMonthlyRevenueTarget(r))}),a()()(),l(25,"div")(26,"label",45),c(27," \u6D3B\u52D5\u71DF\u6536\u76EE\u6A19 "),a(),l(28,"div",49)(29,"span",50),c(30,"NT$"),a(),l(31,"input",52),b("ngModelChange",function(r){w(t);let o=v();return T(o.updateEventRevenueTarget(r))}),a()(),l(32,"p",48),c(33,"\u7279\u6B8A\u6D3B\u52D5\u6216\u4FC3\u92B7\u7684\u9810\u671F\u71DF\u6536\uFF08\u53EF\u9078\uFF09"),a()(),l(34,"div")(35,"label",45),c(36," \u5099\u8A3B "),a(),l(37,"textarea",53),b("ngModelChange",function(r){w(t);let o=v();return T(o.updateRemark(r))}),a()()(),l(38,"div",54)(39,"button",55),b("click",function(){w(t);let r=v();return T(r.closeForm())}),c(40," \u53D6\u6D88 "),a(),l(41,"button",56),b("click",function(){w(t);let r=v();return T(r.submitForm())}),A(42,C$,3,0)(43,x$,3,1),a()()()()}if(n&2){let t=v();f(4),V(" ",t.isEditing()?"\u7DE8\u8F2F\u71DF\u6536\u76EE\u6A19":"\u65B0\u589E\u71DF\u6536\u76EE\u6A19"," "),f(4),N(t.formError()?8:-1),f(6),M("ngModel",t.formData().targetMonth)("disabled",t.isEditing()),f(),N(t.isEditing()?15:-1),f(9),M("ngModel",t.formData().monthlyRevenueTarget),f(7),M("ngModel",t.formData().eventRevenueTarget),f(6),M("ngModel",t.formData().remark),f(2),M("disabled",t.isSaving()),f(2),M("disabled",t.isSaving()),f(),N(t.isSaving()?42:43)}}var ra=class ra{constructor(){this.apiService=P(rt);this.targets=S([]);this.isLoading=S(!1);this.error=S(null);this.showForm=S(!1);this.isEditing=S(!1);this.formData=S({targetId:null,targetMonth:"",monthlyRevenueTarget:0,eventRevenueTarget:0,remark:""});this.formError=S(null);this.isSaving=S(!1);this.successMessage=S(null)}ngOnInit(){this.loadTargets()}async loadTargets(){this.isLoading.set(!0),this.error.set(null);try{let e=await this.apiService.getMonthlyTargets();if(e.success)this.targets.set(e.data||[]),console.log("\u2713 \u8F09\u5165\u6708\u5EA6\u71DF\u6536\u76EE\u6A19\u6210\u529F:",e.data.length,"\u7B46\u8A18\u9304");else throw new Error(e.error||"\u8F09\u5165\u5931\u6557")}catch(e){console.error("\u274C \u8F09\u5165\u6708\u5EA6\u71DF\u6536\u76EE\u6A19\u5931\u6557:",e);let t=e instanceof Error?e.message:"\u8F09\u5165\u8CC7\u6599\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66";this.error.set(t)}finally{this.isLoading.set(!1)}}openAddForm(){this.isEditing.set(!1),this.formData.set({targetId:null,targetMonth:"",monthlyRevenueTarget:0,eventRevenueTarget:0,remark:""}),this.formError.set(null),this.showForm.set(!0)}openEditForm(e){this.isEditing.set(!0),this.formData.set({targetId:e.targetId,targetMonth:e.targetMonth.substring(0,7),monthlyRevenueTarget:e.monthlyRevenueTarget,eventRevenueTarget:e.eventRevenueTarget,remark:e.remark||""}),this.formError.set(null),this.showForm.set(!0)}closeForm(){this.showForm.set(!1),this.formError.set(null),this.formData.set({targetId:null,targetMonth:"",monthlyRevenueTarget:0,eventRevenueTarget:0,remark:""})}validateForm(){let e=this.formData();return e.targetMonth?e.monthlyRevenueTarget<0?"\u6708\u71DF\u696D\u76EE\u6A19\u4E0D\u53EF\u70BA\u8CA0\u6578":e.eventRevenueTarget<0?"\u6D3B\u52D5\u71DF\u6536\u76EE\u6A19\u4E0D\u53EF\u70BA\u8CA0\u6578":null:"\u8ACB\u9078\u64C7\u6708\u4EFD"}async submitForm(){let e=this.validateForm();if(e){this.formError.set(e);return}this.isSaving.set(!0),this.formError.set(null),this.successMessage.set(null);try{let t=this.formData(),i={targetMonth:`${t.targetMonth}-01`,monthlyRevenueTarget:t.monthlyRevenueTarget,eventRevenueTarget:t.eventRevenueTarget,remark:t.remark||null},r;if(this.isEditing()&&t.targetId?(r=await this.apiService.updateMonthlyTarget(k({targetId:t.targetId},i)),this.successMessage.set("\u66F4\u65B0\u6210\u529F\uFF01")):(r=await this.apiService.createMonthlyTarget(i),this.successMessage.set("\u65B0\u589E\u6210\u529F\uFF01")),r.success)await this.loadTargets(),this.closeForm(),setTimeout(()=>this.successMessage.set(null),3e3);else throw new Error(r.error||"\u64CD\u4F5C\u5931\u6557")}catch(t){console.error("\u274C \u63D0\u4EA4\u8868\u55AE\u5931\u6557:",t);let i=t instanceof Error?t.message:"\u64CD\u4F5C\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66";t.message?.includes("\u5DF2\u5B58\u5728")&&(i="\u8A72\u6708\u4EFD\u7684\u71DF\u6536\u76EE\u6A19\u5DF2\u5B58\u5728\uFF0C\u8ACB\u4F7F\u7528\u7DE8\u8F2F\u529F\u80FD\u9032\u884C\u4FEE\u6539"),this.formError.set(i)}finally{this.isSaving.set(!1)}}async deleteTarget(e){if(confirm(`\u78BA\u5B9A\u8981\u522A\u9664 ${this.formatMonth(e.targetMonth)} \u7684\u71DF\u6536\u76EE\u6A19\u55CE\uFF1F`)){this.isLoading.set(!0),this.error.set(null),this.successMessage.set(null);try{let i=await this.apiService.deleteMonthlyTarget(e.targetId);if(i.success)this.successMessage.set("\u522A\u9664\u6210\u529F\uFF01"),await this.loadTargets(),setTimeout(()=>this.successMessage.set(null),3e3);else throw new Error(i.error||"\u522A\u9664\u5931\u6557")}catch(i){console.error("\u274C \u522A\u9664\u5931\u6557:",i);let r=i instanceof Error?i.message:"\u522A\u9664\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66";this.error.set(r)}finally{this.isLoading.set(!1)}}}formatMonth(e){if(!e)return"";let t=new Date(e),i=t.getFullYear(),r=t.getMonth()+1;return`${i}\u5E74${r}\u6708`}formatCurrency(e){return e==null?"NT$0":`NT$${e.toLocaleString("zh-TW",{minimumFractionDigits:0,maximumFractionDigits:0})}`}updateTargetMonth(e){this.formData.update(t=>q(k({},t),{targetMonth:e}))}updateMonthlyRevenueTarget(e){this.formData.update(t=>q(k({},t),{monthlyRevenueTarget:+e}))}updateEventRevenueTarget(e){this.formData.update(t=>q(k({},t),{eventRevenueTarget:+e}))}updateRemark(e){this.formData.update(t=>q(k({},t),{remark:e}))}};ra.\u0275fac=function(t){return new(t||ra)},ra.\u0275cmp=ie({type:ra,selectors:[["app-monthly-targets"]],decls:15,vars:6,consts:[[1,"space-y-8"],[1,"flex","items-center","justify-between"],[1,"text-3xl","font-bold","text-gray-900"],[1,"bg-indigo-600","text-white","px-4","py-2","rounded-lg","font-medium","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2",3,"click"],["name","add-outline",1,"text-xl"],[1,"bg-green-50","border-l-4","border-green-500","p-4","rounded-lg"],[1,"bg-red-50","border-l-4","border-red-500","p-4","rounded-lg"],[1,"bg-white","p-6","rounded-xl","shadow-md"],[1,"flex","items-center","justify-center","h-64"],[1,"overflow-x-auto"],[1,"flex","flex-col","items-center","justify-center","h-64","text-gray-500"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50","p-4"],[1,"flex","items-center","gap-3"],["name","checkmark-circle",1,"text-2xl","text-green-600"],[1,"text-green-900","font-medium"],["name","alert-circle-outline",1,"text-2xl","text-red-600"],[1,"text-red-900","font-medium"],[1,"flex","flex-col","items-center","space-y-2"],[1,"w-8","h-8","border-3","border-indigo-200","border-t-indigo-600","rounded-full","animate-spin"],[1,"text-sm","text-gray-500"],[1,"w-full","text-sm","text-left"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50"],[1,"py-3","px-4"],[1,"py-3","px-4","text-right"],[1,"py-3","px-4","text-center"],[1,"border-b","hover:bg-gray-50","transition-colors"],[1,"py-3","px-4","font-medium","text-gray-900"],[1,"py-3","px-4","text-right","font-semibold","text-indigo-600"],[1,"py-3","px-4","text-right","text-gray-600"],[1,"py-3","px-4","text-gray-600"],[1,"flex","items-center","justify-center","gap-2"],["title","\u7DE8\u8F2F",1,"text-indigo-600","hover:text-indigo-800","p-1","rounded","transition-colors",3,"click"],["name","create-outline",1,"text-xl"],["title","\u522A\u9664",1,"text-red-600","hover:text-red-800","p-1","rounded","transition-colors",3,"click"],["name","trash-outline",1,"text-xl"],["colspan","7",1,"py-8","text-center","text-gray-500"],["name","document-text-outline",1,"text-6xl","mb-4"],[1,"text-lg","font-medium"],[1,"text-sm","mt-2"],[1,"bg-white","rounded-xl","shadow-xl","max-w-2xl","w-full","max-h-[90vh]","overflow-y-auto"],[1,"flex","items-center","justify-between","p-6","border-b"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-400","hover:text-gray-600","transition-colors",3,"click"],["name","close-outline",1,"text-3xl"],[1,"p-6","space-y-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"text-red-500"],["type","month","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500","disabled:bg-gray-100","disabled:cursor-not-allowed",3,"ngModelChange","ngModel","disabled"],[1,"mt-1","text-xs","text-gray-500"],[1,"relative"],[1,"absolute","left-3","top-1/2","-translate-y-1/2","text-gray-500"],["type","number","min","0","step","1000","placeholder","0","required","",1,"w-full","pl-12","pr-3","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500",3,"ngModelChange","ngModel"],["type","number","min","0","step","1000","placeholder","0",1,"w-full","pl-12","pr-3","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500",3,"ngModelChange","ngModel"],["rows","3","placeholder","\u8F38\u5165\u5099\u8A3B\uFF08\u53EF\u9078\uFF09",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-indigo-500","focus:border-indigo-500","resize-none",3,"ngModelChange","ngModel"],[1,"flex","items-center","justify-end","gap-3","p-6","border-t","bg-gray-50"],[1,"px-4","py-2","text-gray-700","bg-white","border","border-gray-300","rounded-lg","hover:bg-gray-50","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"px-4","py-2","bg-indigo-600","text-white","rounded-lg","hover:bg-indigo-700","transition-colors","flex","items-center","gap-2","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["name","alert-circle-outline",1,"text-2xl","text-red-600","flex-shrink-0"],[1,"text-red-900","text-sm"],[1,"w-4","h-4","border-2","border-white","border-t-transparent","rounded-full","animate-spin"],["name","checkmark-outline",1,"text-xl"]],template:function(t,i){t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),c(3,"\u71DF\u6536\u76EE\u6A19"),a(),l(4,"button",3),b("click",function(){return i.openAddForm()}),x(5,"ion-icon",4),l(6,"span"),c(7,"\u65B0\u589E\u76EE\u6A19"),a()()(),A(8,c$,5,1,"div",5),A(9,m$,5,1,"div",6),l(10,"div",7),A(11,p$,5,0,"div",8),A(12,h$,22,1,"div",9),A(13,y$,6,0,"div",10),a(),A(14,E$,44,11,"div",11),a()),t&2&&(f(8),N(i.successMessage()?8:-1),f(),N(i.error()?9:-1),f(2),N(i.isLoading()?11:-1),f(),N(!i.isLoading()&&i.targets().length>0?12:-1),f(),N(!i.isLoading()&&i.targets().length===0&&!i.error()?13:-1),f(),N(i.showForm()?14:-1))},dependencies:[re,be,Ce,Ft,me,Wh,qh,Ie],encapsulation:2});var vp=ra;function b$(n,e){if(n&1&&(Xe(0,"div",4),c(1),et()),n&2){let t=v();f(),V(" ",t.error()," ")}}var oa=class oa{constructor(e,t){this.authService=e;this.router=t;this.error=S(null)}ngOnInit(){this.authService.isAuthenticated()&&this.router.navigate(["/dashboard"]),this.loadGoogleSignInScript()}loadGoogleSignInScript(){if(window.google){this.initializeGoogleSignIn();return}let e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.onload=()=>this.initializeGoogleSignIn(),document.head.appendChild(e)}initializeGoogleSignIn(){let e="957974561982-c8gfted5logjoglj8hspaiad8q8jpl1g.apps.googleusercontent.com";if(!e||e.includes("YOUR_")){console.warn("Google Client ID not configured. Please set VITE_GOOGLE_CLIENT_ID environment variable."),this.error.set("\u7CFB\u7D71\u672A\u6B63\u78BA\u914D\u7F6E Google OAuth\u3002\u8ACB\u806F\u7D61\u7BA1\u7406\u54E1\u3002");return}try{window.google.accounts.id.initialize({client_id:e,callback:i=>this.handleGoogleLogin(i)});let t=document.getElementById("google-signin-button");t&&window.google.accounts.id.renderButton(t,{theme:"outline",size:"large",width:"100%"})}catch(t){console.error("Failed to initialize Google Sign-In:",t),this.error.set("\u7121\u6CD5\u521D\u59CB\u5316 Google \u767B\u5165")}}async handleGoogleLogin(e){try{e.credential&&(await this.authService.loginWithGoogle(e.credential)?this.router.navigate(["/dashboard"]):this.error.set(this.authService.error()||"Google \u767B\u5165\u5931\u6557"))}catch(t){console.error("Login error:",t),this.error.set("\u767B\u5165\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u91CD\u8A66")}}};oa.\u0275fac=function(t){return new(t||oa)(K(nt),K(Le))},oa.\u0275cmp=ie({type:oa,selectors:[["app-login"]],decls:15,vars:1,consts:[[1,"login-container"],[1,"login-box"],[1,"login-header"],[1,"subtitle"],[1,"error-message"],[1,"login-method"],["id","google-signin-button",1,"google-button-container"],[1,"footer-info"]],template:function(t,i){t&1&&(Xe(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),c(4,"Galaxy House Finance"),et(),Xe(5,"p",3),c(6,"\u7BA1\u7406\u7CFB\u7D71\u767B\u5165"),et()(),A(7,b$,2,1,"div",4),Xe(8,"div",5),qi(9,"div",6),et(),Xe(10,"div",7)(11,"p"),c(12,"\u6B64\u7CFB\u7D71\u9700\u8981\u4F7F\u7528 Google \u5E33\u865F\u767B\u5165"),et(),Xe(13,"p"),c(14,"\u5982\u6709\u554F\u984C\uFF0C\u8ACB\u806F\u7D61\u7BA1\u7406\u54E1"),et()()()()),t&2&&(f(7),N(i.error()?7:-1))},dependencies:[re,be],styles:[".login-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background:linear-gradient(135deg,#8c4f28,#000);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;padding:20px}.login-box[_ngcontent-%COMP%]{background:#efd07f;padding:40px;border-radius:12px;box-shadow:0 10px 40px #0000001a;width:100%;max-width:400px}.login-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:30px}h1[_ngcontent-%COMP%]{color:#333;margin:0 0 8px;font-size:28px;font-weight:700}.subtitle[_ngcontent-%COMP%]{color:#666;margin:0;font-size:14px}.login-method[_ngcontent-%COMP%]{margin-bottom:20px}.google-button-container[_ngcontent-%COMP%]{margin-bottom:15px}.google-login-btn[_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid #ddd;border-radius:6px;background:#fff;color:#333;font-size:14px;font-weight:500;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:10px;transition:all .3s ease}.google-login-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#f8f8f8;border-color:#ccc;box-shadow:0 2px 8px #0000001a}.error-message[_ngcontent-%COMP%]{background-color:#fee;color:#c00;padding:12px;border-radius:6px;font-size:13px;margin-bottom:20px;border:1px solid #fcc}.footer-info[_ngcontent-%COMP%]{text-align:center;margin-top:30px;color:#999;font-size:12px;line-height:1.6}.footer-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0}"]});var Cp=oa;function S$(n,e){if(n&1&&(l(0,"div",29),c(1),a()),n&2){let t=v();f(),V(" ",t.successMessage()," ")}}function D$(n,e){if(n&1&&(l(0,"span",30),c(1),a()),n&2){let t=e.$implicit;f(),V(" ",t.display_name," ")}}function w$(n,e){if(n&1&&(l(0,"div",31)(1,"span",32),c(2),a()()),n&2){let t=e.$implicit;f(2),E(t)}}function T$(n,e){n&1&&(l(0,"div",33),c(1,"\u8F09\u5165\u4E2D..."),a())}function I$(n,e){if(n&1&&(l(0,"div",34),c(1),a()),n&2){let t=v();f(),E(t.error())}}var sa=class sa{constructor(e,t){this.http=e;this.authService=t;this.baseUrl=`${yn.apiUrl}/admin`;this.profileData=S(null);this.isLoading=S(!1);this.isUpdating=S(!1);this.error=S(null);this.successMessage=S(null);this.formData={name:"",avatarUrl:""}}ngOnInit(){this.loadProfile()}loadProfile(){this.isLoading.set(!0),this.error.set(null);let e=this.getAuthHeaders();if(!e){this.error.set("\u5C1A\u672A\u767B\u5165\uFF0C\u8ACB\u91CD\u65B0\u767B\u5165"),this.isLoading.set(!1);return}this.http.get(`${this.baseUrl}/profile`,{headers:e}).subscribe({next:t=>{this.profileData.set(t.data),this.formData={name:t.data.name,avatarUrl:t.data.avatarUrl||""},this.isLoading.set(!1)},error:t=>{console.error("Profile load error:",t);let i="\u8F09\u5165\u500B\u4EBA\u8CC7\u6599\u5931\u6557";t.status===401?i="\u8A8D\u8B49\u5931\u6557\uFF0C\u8ACB\u91CD\u65B0\u767B\u5165":t.status===404?i="\u627E\u4E0D\u5230\u5E33\u865F\u8CC7\u8A0A":t.error?.error&&(i=t.error.error),this.error.set(i),this.isLoading.set(!1)}})}updateProfile(){this.isUpdating.set(!0),this.successMessage.set(null);let e=this.getAuthHeaders();if(!e){this.error.set("\u5C1A\u672A\u767B\u5165"),this.isUpdating.set(!1);return}this.http.put(`${this.baseUrl}/profile`,this.formData,{headers:e}).subscribe({next:()=>{this.successMessage.set("\u500B\u4EBA\u8CC7\u6599\u5DF2\u6210\u529F\u66F4\u65B0"),this.isUpdating.set(!1),this.loadProfile(),setTimeout(()=>{this.successMessage.set(null)},3e3)},error:t=>{this.error.set(t.error?.error||"\u66F4\u65B0\u5931\u6557"),this.isUpdating.set(!1)}})}getStatusLabel(e){return{active:"\u555F\u7528",inactive:"\u505C\u7528",suspended:"\u66AB\u505C"}[e||""]||e||"-"}formatDate(e){return e?new Date(e).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-"}getAuthHeaders(){let e=this.authService.getToken();return e?new Ot({Authorization:`Bearer ${e}`,"Content-Type":"application/json"}):null}};sa.\u0275fac=function(t){return new(t||sa)(K(Qt),K(nt))},sa.\u0275cmp=ie({type:sa,selectors:[["app-account"]],decls:69,vars:20,consts:[[1,"account-container"],[1,"account-layout"],[1,"profile-section"],[1,"profile-header"],[1,"profile-avatar"],["alt","Avatar",3,"src"],[1,"profile-info"],[1,"status"],[1,"profile-details"],[1,"detail-row"],[1,"value"],[1,"edit-section"],[3,"ngSubmit"],[1,"form-group"],["type","text","name","name","placeholder","\u8F38\u5165\u60A8\u7684\u59D3\u540D",3,"ngModelChange","ngModel"],["type","url","name","avatarUrl","placeholder","https://...",3,"ngModelChange","ngModel"],["type","submit",3,"disabled"],["class","success-message",4,"ngIf"],[1,"roles-section"],[1,"roles-container"],[1,"role-list"],["class","role-badge",4,"ngFor","ngForOf"],[1,"permissions-container"],[1,"permissions-grid"],["class","permission-item",4,"ngFor","ngForOf"],[1,"activity-section"],[1,"activity-info"],["class","loading",4,"ngIf"],["class","error-message",4,"ngIf"],[1,"success-message"],[1,"role-badge"],[1,"permission-item"],[1,"permission-code"],[1,"loading"],[1,"error-message"]],template:function(t,i){if(t&1&&(l(0,"div",0)(1,"h2"),c(2,"\u6211\u7684\u5E33\u865F"),a(),l(3,"div",1)(4,"div",2)(5,"div",3)(6,"div",4),x(7,"img",5),a(),l(8,"div",6)(9,"h3"),c(10),a(),l(11,"p"),c(12),a(),l(13,"p",7),c(14),a()()(),l(15,"div",8)(16,"div",9)(17,"label"),c(18,"\u5E33\u865F\u72C0\u614B\uFF1A"),a(),l(19,"span",10),c(20),a()(),l(21,"div",9)(22,"label"),c(23,"\u5EFA\u7ACB\u6642\u9593\uFF1A"),a(),l(24,"span",10),c(25),a()(),l(26,"div",9)(27,"label"),c(28,"\u6700\u5F8C\u767B\u5165\uFF1A"),a(),l(29,"span",10),c(30),a()()()(),l(31,"div",11)(32,"h3"),c(33,"\u7DE8\u8F2F\u500B\u4EBA\u8CC7\u6599"),a(),l(34,"form",12),b("ngSubmit",function(){return i.updateProfile()}),l(35,"div",13)(36,"label"),c(37,"\u59D3\u540D"),a(),l(38,"input",14),Z("ngModelChange",function(o){return ee(i.formData.name,o)||(i.formData.name=o),o}),a()(),l(39,"div",13)(40,"label"),c(41,"\u982D\u50CF URL"),a(),l(42,"input",15),Z("ngModelChange",function(o){return ee(i.formData.avatarUrl,o)||(i.formData.avatarUrl=o),o}),a()(),l(43,"button",16),c(44),a(),Pt(45,S$,2,1,"div",17),a()(),l(46,"div",18)(47,"h3"),c(48,"\u89D2\u8272\u548C\u6B0A\u9650"),a(),l(49,"div",19)(50,"h4"),c(51,"\u6211\u7684\u89D2\u8272"),a(),l(52,"div",20),Pt(53,D$,2,1,"span",21),a()(),l(54,"div",22)(55,"h4"),c(56,"\u6211\u7684\u6B0A\u9650"),a(),l(57,"div",23),Pt(58,w$,3,1,"div",24),a()()(),l(59,"div",25)(60,"h3"),c(61,"\u6700\u8FD1\u6D3B\u52D5"),a(),l(62,"div",26)(63,"p"),c(64),a(),l(65,"p"),c(66),a()()()(),Pt(67,T$,2,0,"div",27)(68,I$,2,1,"div",28),a()),t&2){let r,o,s,u,d,m,h,y,_,C,D,I;f(7),M("src",((r=i.profileData())==null?null:r.avatarUrl)||"https://via.placeholder.com/100",$t),f(3),E((o=i.profileData())==null?null:o.name),f(2),E((s=i.profileData())==null?null:s.email),f(),De("status-"+((u=i.profileData())==null?null:u.status)),f(),V(" ",i.getStatusLabel((d=i.profileData())==null?null:d.status)," "),f(6),E(i.getStatusLabel((m=i.profileData())==null?null:m.status)),f(5),E(i.formatDate((h=i.profileData())==null?null:h.createdAt)),f(5),E(i.formatDate((y=i.profileData())==null?null:y.lastLoginAt)),f(8),Q("ngModel",i.formData.name),f(4),Q("ngModel",i.formData.avatarUrl),f(),M("disabled",i.isUpdating()),f(),V(" ",i.isUpdating()?"\u4FDD\u5B58\u4E2D...":"\u4FDD\u5B58\u4FEE\u6539"," "),f(),M("ngIf",i.successMessage()),f(8),M("ngForOf",(_=i.profileData())==null?null:_.roles),f(5),M("ngForOf",(C=i.profileData())==null?null:C.permissions),f(6),V("\u6700\u5F8C\u767B\u5165\u6642\u9593\uFF1A",i.formatDate((D=i.profileData())==null?null:D.lastLoginAt)),f(2),V("\u5E33\u865F\u5EFA\u7ACB\u6642\u9593\uFF1A",i.formatDate((I=i.profileData())==null?null:I.createdAt)),f(),M("ngIf",i.isLoading()),f(),M("ngIf",i.error())}},dependencies:[re,es,ji,be,$e,Ce,me,Fe,Ie,Ul],styles:[".account-container[_ngcontent-%COMP%]{padding:20px;max-width:1000px;margin:0 auto}h2[_ngcontent-%COMP%]{margin-bottom:30px;color:#333}.account-layout[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:30px}.profile-section[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:8px;box-shadow:0 2px 8px #0000001a}.profile-header[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:20px;padding-bottom:20px;border-bottom:1px solid #eee}.profile-avatar[_ngcontent-%COMP%]{width:100px;height:100px;border-radius:50%;overflow:hidden;flex-shrink:0}.profile-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.profile-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 5px;color:#333}.profile-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#666;font-size:13px}.status[_ngcontent-%COMP%]{padding:4px 8px;border-radius:4px;font-size:12px;display:inline-block;margin-top:8px}.status-active[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724}.status-inactive[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24}.status-suspended[_ngcontent-%COMP%]{background-color:#fff3cd;color:#856404}.profile-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.detail-row[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#333}.detail-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#666}.edit-section[_ngcontent-%COMP%], .roles-section[_ngcontent-%COMP%], .activity-section[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:8px;box-shadow:0 2px 8px #0000001a}h3[_ngcontent-%COMP%]{margin-top:0;margin-bottom:15px;color:#333;font-size:16px}h4[_ngcontent-%COMP%]{margin-bottom:10px;color:#333;font-size:14px}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:5px;font-weight:600;color:#333;font-size:13px}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ddd;border-radius:4px;font-size:13px;box-sizing:border-box}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3f51b5;box-shadow:0 0 0 3px #3f51b51a}button[type=submit][_ngcontent-%COMP%]{background-color:#3f51b5;color:#fff;padding:10px 20px;border:none;border-radius:4px;cursor:pointer;font-size:13px;font-weight:600}button[type=submit][_ngcontent-%COMP%]:hover:not(:disabled){background-color:#303c7e}button[type=submit][_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.role-badge[_ngcontent-%COMP%]{display:inline-block;background-color:#e0e7ff;color:#3f51b5;padding:6px 12px;border-radius:4px;font-size:12px;margin-right:8px;margin-bottom:8px}.role-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.permissions-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:10px}.permission-item[_ngcontent-%COMP%]{background-color:#f5f5f5;padding:8px;border-radius:4px;border-left:3px solid #3f51b5;font-size:12px}.permission-code[_ngcontent-%COMP%]{font-family:Courier New,monospace;color:#333}.success-message[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724;padding:10px;border-radius:4px;font-size:12px;margin-top:10px;border:1px solid #c3e6cb}.error-message[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24;padding:10px;border-radius:4px;font-size:12px;margin-top:10px;border:1px solid #f5c6cb}.activity-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.activity-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#666;font-size:13px}.loading[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#666}@media (max-width: 768px){.account-layout[_ngcontent-%COMP%]{grid-template-columns:1fr}.profile-header[_ngcontent-%COMP%]{flex-direction:column;align-items:center;text-align:center}.permissions-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]});var xp=sa;var M$=(n,e)=>e.role_id,A$=(n,e)=>e.permission_id;function N$(n,e){if(n&1&&(l(0,"div",4)(1,"p",23),c(2),a()()),n&2){let t=v();f(2),E(t.error())}}function R$(n,e){if(n&1&&(l(0,"div",5)(1,"p",24),c(2),a()()),n&2){let t=v();f(2),E(t.successMessage())}}function F$(n,e){n&1&&(l(0,"div",18),c(1,"\u8F09\u5165\u4E2D..."),a())}function P$(n,e){n&1&&(l(0,"div",18),c(1,"\u6C92\u6709\u53EF\u7DE8\u8F2F\u7684\u89D2\u8272"),a())}function k$(n,e){if(n&1){let t=B();l(0,"div",26)(1,"div",27)(2,"button",28),b("click",function(){let r=w(t).$implicit,o=v(2);return T(o.selectRole(r))}),l(3,"div",29),c(4),a(),l(5,"div",30),c(6),a(),l(7,"div",31),c(8),a()(),l(9,"div",32)(10,"button",33),b("click",function(){let r=w(t).$implicit,o=v(2);return T(o.openEditRoleDialog(r))}),Li(),l(11,"svg",34),x(12,"path",35),a()(),Hr(),l(13,"button",36),b("click",function(){let r=w(t).$implicit,o=v(2);return T(o.openDeleteDialog(r))}),Li(),l(14,"svg",34),x(15,"path",37),a()()()()()}if(n&2){let t,i,r,o=e.$implicit,s=v(2);z("bg-blue-50",((t=s.selectedRole())==null?null:t.role_id)===o.role_id)("border-l-4",((i=s.selectedRole())==null?null:i.role_id)===o.role_id)("border-l-blue-500",((r=s.selectedRole())==null?null:r.role_id)===o.role_id),f(4),E(o.display_name),f(2),E(o.role_name),f(2),V(" ",o.permission_count||0," \u500B\u6B0A\u9650\u5DF2\u914D\u7F6E ")}}function V$(n,e){if(n&1&&O(0,k$,16,9,"div",25,M$),n&2){let t=v();L(t.filteredRoles())}}function O$(n,e){n&1&&(l(0,"div",20)(1,"p",38),c(2,"\u8ACB\u9078\u64C7\u4E00\u500B\u89D2\u8272\u958B\u59CB\u914D\u7F6E\u6B0A\u9650"),a()())}function L$(n,e){n&1&&(l(0,"div",48),c(1,"\u8F09\u5165\u6B0A\u9650\u4E2D..."),a())}function B$(n,e){n&1&&(l(0,"div",48),c(1,"\u6C92\u6709\u53EF\u7528\u7684\u6B0A\u9650"),a())}function U$(n,e){if(n&1){let t=B();l(0,"div",60)(1,"input",61),b("change",function(){let r=w(t).$implicit,o=v(5);return T(o.togglePermission(r.permission_id,o.selectedPermissions().has(r.permission_id)))}),a(),l(2,"div",62)(3,"label",63),c(4),a(),l(5,"p",64),c(6),a(),l(7,"code",65),c(8),a()()()}if(n&2){let t=e.$implicit,i=v(5);f(),M("checked",i.selectedPermissions().has(t.permission_id))("disabled",i.isSaving()),f(3),V(" ",t.display_name," "),f(2),V(" ",t.description," "),f(2),V(" ",t.permission_code," ")}}function $$(n,e){if(n&1&&O(0,U$,9,5,"div",60,A$),n&2){let t=v().$implicit,i=v(3);L(i.permissionsByCategory()[t])}}function H$(n,e){n&1&&(l(0,"div",59),c(1,"\u6B64\u5206\u985E\u6C92\u6709\u6B0A\u9650"),a())}function G$(n,e){if(n&1){let t=B();l(0,"div",52)(1,"div",53)(2,"div",54)(3,"input",55),b("change",function(){let r=w(t).$implicit,o=v(3);return T(o.isCategoryFullySelected(r)?o.deselectAllInCategory(r):o.selectAllInCategory(r))}),a(),l(4,"div")(5,"h3",56),c(6),a(),l(7,"p",57),c(8),a()()()(),l(9,"div",58),A(10,$$,2,0)(11,H$,2,0,"div",59),a()()}if(n&2){let t=e.$implicit,i=v(3);f(3),M("checked",i.isCategoryFullySelected(t)),f(3),V(" ",t," "),f(2),ut(" ",i.getCategoryAssignedCount(t)," / ",i.permissionsByCategory()[t].length," "),f(2),N(i.permissionsByCategory()[t]&&i.permissionsByCategory()[t].length>0?10:11)}}function q$(n,e){if(n&1&&O(0,G$,12,5,"div",52,W),n&2){let t=v(2);L(t.categoryCount().categories)}}function W$(n,e){if(n&1){let t=B();l(0,"div",8)(1,"div",39)(2,"div",10)(3,"div")(4,"h2",40),c(5),a(),l(6,"p",12),c(7),a()(),l(8,"div",41)(9,"div",42),c(10),a()()()(),l(11,"div",43)(12,"button",44),b("click",function(){w(t);let r=v();return T(r.selectAllPermissions())}),c(13," \u5168\u9078\u6240\u6709 "),a(),l(14,"button",45),b("click",function(){w(t);let r=v();return T(r.clearAllPermissions())}),c(15," \u5168\u4E0D\u9078 "),a(),l(16,"button",46),b("click",function(){w(t);let r=v();return T(r.resetPermissions())}),c(17," \u91CD\u7F6E "),a()(),l(18,"div",47),A(19,L$,2,0,"div",48)(20,B$,2,0,"div",48)(21,q$,2,0),a(),l(22,"div",49)(23,"button",50),b("click",function(){w(t);let r=v();return T(r.resetPermissions())}),c(24," \u53D6\u6D88 "),a(),l(25,"button",51),b("click",function(){w(t);let r=v();return T(r.savePermissions())}),c(26),a()()()}if(n&2){let t=v();f(5),V(" ",t.selectedRole().display_name," "),f(2),ut(" \u5DF2\u914D\u7F6E ",t.assignedCount()," / ",t.categoryCount().total*5," \u500B\u6B0A\u9650 "),f(3),V(" ",(t.Object.keys(t.permissionsByCategory()).length>0?t.Math.round(t.assignedCount()/(t.Object.keys(t.permissionsByCategory()).length*5)*100):0)||0,"% "),f(6),M("disabled",t.isSaving()),f(3),N(t.isLoading()?19:t.Object.keys(t.permissionsByCategory()).length===0?20:21),f(4),M("disabled",t.isSaving()),f(2),M("disabled",t.isSaving()),f(),V(" ",t.isSaving()?"\u4FDD\u5B58\u4E2D...":"\u4FDD\u5B58\u6B0A\u9650"," ")}}function j$(n,e){if(n&1&&(l(0,"div",68)(1,"p",23),c(2),a()()),n&2){let t=v(2);f(2),E(t.error())}}function z$(n,e){if(n&1){let t=B();l(0,"div",21)(1,"div",66)(2,"div",39)(3,"h3",40),c(4),a()(),l(5,"div",67),A(6,j$,3,1,"div",68),l(7,"div")(8,"label",69),c(9," \u89D2\u8272\u540D\u7A31 "),l(10,"span",70),c(11,"*"),a()(),l(12,"input",71),b("input",function(r){w(t);let o=v();return T(o.updateRoleDisplayName(r.target.value))}),a()(),l(13,"div")(14,"label",69),c(15," \u8AAA\u660E "),a(),l(16,"textarea",72),b("input",function(r){w(t);let o=v();return T(o.updateRoleDescription(r.target.value))}),a()()(),l(17,"div",73)(18,"button",50),b("click",function(){w(t);let r=v();return T(r.closeRoleDialog())}),c(19," \u53D6\u6D88 "),a(),l(20,"button",74),b("click",function(){w(t);let r=v();return T(r.saveRole())}),c(21),a()()()()}if(n&2){let t=v();f(4),V(" ",t.editingRole()?"\u7DE8\u8F2F\u89D2\u8272":"\u65B0\u589E\u89D2\u8272"," "),f(2),N(t.error()?6:-1),f(6),M("value",t.roleFormData().displayName)("disabled",t.isSaving()),f(4),M("value",t.roleFormData().description)("disabled",t.isSaving()),f(2),M("disabled",t.isSaving()),f(2),M("disabled",t.isSaving()),f(),V(" ",t.isSaving()?"\u4FDD\u5B58\u4E2D...":"\u4FDD\u5B58"," ")}}function Y$(n,e){if(n&1&&(l(0,"div",76)(1,"p",23),c(2),a()()),n&2){let t=v(2);f(2),E(t.error())}}function J$(n,e){if(n&1){let t=B();l(0,"div",21)(1,"div",66)(2,"div",39)(3,"h3",40),c(4,"\u522A\u9664\u89D2\u8272\u78BA\u8A8D"),a()(),l(5,"div",75),A(6,Y$,3,1,"div",76),l(7,"p",77),c(8," \u78BA\u5B9A\u8981\u522A\u9664\u89D2\u8272 "),l(9,"strong",78),c(10),a(),c(11," \u55CE\uFF1F "),a(),l(12,"p",79),c(13," \u6CE8\u610F\uFF1A\u5982\u679C\u6B64\u89D2\u8272\u5DF2\u5206\u914D\u7D66\u4F7F\u7528\u8005\uFF0C\u5C07\u7121\u6CD5\u522A\u9664\u3002 "),a()(),l(14,"div",73)(15,"button",50),b("click",function(){w(t);let r=v();return T(r.closeDeleteDialog())}),c(16," \u53D6\u6D88 "),a(),l(17,"button",80),b("click",function(){w(t);let r=v();return T(r.deleteRole())}),c(18),a()()()()}if(n&2){let t,i=v();f(6),N(i.error()?6:-1),f(4),E((t=i.roleToDelete())==null?null:t.display_name),f(5),M("disabled",i.isSaving()),f(2),M("disabled",i.isSaving()),f(),V(" ",i.isSaving()?"\u522A\u9664\u4E2D...":"\u78BA\u5B9A\u522A\u9664"," ")}}function K$(n,e){if(n&1&&(qd(0),c(1),Wd()),n&2){let t=v();f(),V(" ",t.Math,`
`)}}var aa=class aa{constructor(){this.baseUrl=`${yn.apiUrl}/admin`;this.authService=P(nt);this.http=P(Qt);this.roles=S([]);this.selectedRole=S(null);this.permissions=S({});this.selectedPermissions=S(new Set);this.isLoading=S(!1);this.isSaving=S(!1);this.error=S(null);this.successMessage=S(null);this.showRoleDialog=S(!1);this.showDeleteDialog=S(!1);this.editingRole=S(null);this.roleToDelete=S(null);this.roleFormData=S({displayName:"",description:""});this.searchTerm=S("");this.Object=Object;this.Math=Math;this.filteredRoles=H(()=>{let e=this.searchTerm().toLowerCase();return this.roles().filter(t=>t.role_name!=="super_admin").filter(t=>t.display_name.toLowerCase().includes(e))});this.permissionsByCategory=H(()=>this.permissions());this.categoryCount=H(()=>{let e=Object.keys(this.permissionsByCategory());return{total:e.length,categories:e}});this.assignedCount=H(()=>this.selectedPermissions().size)}ngOnInit(){this.loadRoles()}getAuthHeaders(){let e=this.authService.getToken();return e?new Ot({Authorization:`Bearer ${e}`,"Content-Type":"application/json"}):(this.error.set("\u5C1A\u672A\u767B\u5165"),null)}loadRoles(){let e=this.getAuthHeaders();if(!e)return;this.isLoading.set(!0),this.error.set(null);let t=`${this.baseUrl}/roles?limit=100`;console.log("Loading roles from:",t),console.log("Headers:",e),this.http.get(t,{headers:e}).subscribe({next:i=>{console.log("Roles response:",i);let r=i?.data||[];console.log("Filtered roles:",r),console.log("Non-system roles:",r.filter(s=>!s.is_system)),this.roles.set(r),this.isLoading.set(!1);let o=r.find(s=>!s.is_system);o?(console.log("Auto-selecting role:",o),this.selectRole(o)):console.warn("No editable roles found")},error:i=>{console.error("Error loading roles:",i);let r=i.error?.error||i.message||"\u8F09\u5165\u89D2\u8272\u5931\u6557";this.error.set(r),this.isLoading.set(!1)}})}selectRole(e){this.selectedRole.set(e),this.selectedPermissions.set(new Set),this.error.set(null);let t=this.getAuthHeaders();t&&(this.isLoading.set(!0),this.http.get(`${this.baseUrl}/role-permissions?roleId=${e.role_id}`,{headers:t}).subscribe({next:i=>{console.log("Role permissions response:",i);let r=i?.permissions||{};console.log("Permissions data:",r);let o=new Set;Object.values(r).forEach(s=>{console.log("Category perms:",s),s.forEach(u=>{console.log("Permission:",u,"is_assigned:",u.is_assigned,"type:",typeof u.is_assigned),u.is_assigned&&o.add(u.permission_id)})}),console.log("Assigned permissions:",o),this.permissions.set(r),this.selectedPermissions.set(o),this.isLoading.set(!1)},error:i=>{console.error("Error loading permissions:",i),this.error.set(i.error?.error||"\u8F09\u5165\u6B0A\u9650\u5931\u6557"),this.isLoading.set(!1)}}))}togglePermission(e,t){let i=new Set(this.selectedPermissions());t?i.delete(e):i.add(e),this.selectedPermissions.set(i)}selectAllInCategory(e){let t=this.permissions()[e]||[],i=new Set(this.selectedPermissions());t.forEach(r=>{i.add(r.permission_id)}),this.selectedPermissions.set(i)}deselectAllInCategory(e){let t=this.permissions()[e]||[],i=new Set(this.selectedPermissions());t.forEach(r=>{i.delete(r.permission_id)}),this.selectedPermissions.set(i)}getCategoryAssignedCount(e){let t=this.permissions()[e]||[],i=0;return t.forEach(r=>{this.selectedPermissions().has(r.permission_id)&&i++}),i}isCategoryFullySelected(e){let t=this.permissions()[e]||[];return t.length===0?!1:t.every(i=>this.selectedPermissions().has(i.permission_id))}savePermissions(){let e=this.selectedRole();if(!e){this.error.set("\u672A\u9078\u64C7\u89D2\u8272");return}let t=this.getAuthHeaders();if(!t)return;this.isSaving.set(!0),this.error.set(null),this.successMessage.set(null);let i={roleId:e.role_id,permissionIds:Array.from(this.selectedPermissions())};this.http.post(`${this.baseUrl}/role-permissions`,i,{headers:t}).subscribe({next:r=>{this.isSaving.set(!1),this.successMessage.set(`\u6210\u529F\u66F4\u65B0\u89D2\u8272 "${e.display_name}" \u7684\u6B0A\u9650 (${this.assignedCount()} \u500B\u6B0A\u9650)`),setTimeout(()=>{this.loadRoles()},1500)},error:r=>{this.isSaving.set(!1),this.error.set(r.error?.error||"\u4FDD\u5B58\u6B0A\u9650\u5931\u6557")}})}resetPermissions(){let e=this.selectedRole();e&&this.selectRole(e)}selectAllPermissions(){let e=new Set;Object.values(this.permissions()).forEach(t=>{t.forEach(i=>{e.add(i.permission_id)})}),this.selectedPermissions.set(e)}clearAllPermissions(){this.selectedPermissions.set(new Set)}openCreateRoleDialog(){this.editingRole.set(null),this.roleFormData.set({displayName:"",description:""}),this.showRoleDialog.set(!0),this.error.set(null)}openEditRoleDialog(e){this.editingRole.set(e),this.roleFormData.set({displayName:e.display_name,description:e.description||""}),this.showRoleDialog.set(!0),this.error.set(null)}closeRoleDialog(){this.showRoleDialog.set(!1),this.editingRole.set(null),this.roleFormData.set({displayName:"",description:""}),this.error.set(null)}saveRole(){let e=this.roleFormData();if(!e.displayName.trim()){this.error.set("\u89D2\u8272\u540D\u7A31\u4E0D\u80FD\u70BA\u7A7A");return}let t=this.getAuthHeaders();if(!t)return;this.isSaving.set(!0),this.error.set(null);let i=this.editingRole();if(i)this.http.put(`${this.baseUrl}/roles/${i.role_id}`,{displayName:e.displayName.trim(),description:e.description.trim()||null},{headers:t}).subscribe({next:r=>{this.isSaving.set(!1),this.successMessage.set(`\u6210\u529F\u66F4\u65B0\u89D2\u8272 "${e.displayName}"`),this.closeRoleDialog(),this.loadRoles(),setTimeout(()=>{this.successMessage.set(null)},3e3)},error:r=>{this.isSaving.set(!1),this.error.set(r.error?.error||"\u66F4\u65B0\u89D2\u8272\u5931\u6557")}});else{let r=new Date,o=r.getFullYear().toString()+(r.getMonth()+1).toString().padStart(2,"0")+r.getDate().toString().padStart(2,"0")+r.getHours().toString().padStart(2,"0")+r.getMinutes().toString().padStart(2,"0")+r.getSeconds().toString().padStart(2,"0"),s=Math.floor(Math.random()*65536).toString(16).padStart(4,"0"),u=`role_${o}_${s}`;this.http.post(`${this.baseUrl}/roles`,{roleName:u,displayName:e.displayName.trim(),description:e.description.trim()||null},{headers:t}).subscribe({next:d=>{this.isSaving.set(!1),this.successMessage.set(`\u6210\u529F\u5275\u5EFA\u89D2\u8272 "${e.displayName}"`),this.closeRoleDialog(),this.loadRoles(),setTimeout(()=>{this.successMessage.set(null)},3e3)},error:d=>{this.isSaving.set(!1),this.error.set(d.error?.error||"\u5275\u5EFA\u89D2\u8272\u5931\u6557")}})}}openDeleteDialog(e){this.roleToDelete.set(e),this.showDeleteDialog.set(!0),this.error.set(null)}closeDeleteDialog(){this.showDeleteDialog.set(!1),this.roleToDelete.set(null),this.error.set(null)}deleteRole(){let e=this.roleToDelete();if(!e)return;let t=this.getAuthHeaders();t&&(this.isSaving.set(!0),this.error.set(null),this.http.delete(`${this.baseUrl}/roles/${e.role_id}`,{headers:t}).subscribe({next:i=>{this.isSaving.set(!1),this.successMessage.set(`\u6210\u529F\u522A\u9664\u89D2\u8272 "${e.display_name}"`),this.closeDeleteDialog(),this.selectedRole()?.role_id===e.role_id&&(this.selectedRole.set(null),this.permissions.set({}),this.selectedPermissions.set(new Set)),this.loadRoles(),setTimeout(()=>{this.successMessage.set(null)},3e3)},error:i=>{this.isSaving.set(!1),this.error.set(i.error?.error||"\u522A\u9664\u89D2\u8272\u5931\u6557")}}))}updateRoleDisplayName(e){let t=this.roleFormData();this.roleFormData.set({displayName:e,description:t.description})}updateRoleDescription(e){let t=this.roleFormData();this.roleFormData.set({displayName:t.displayName,description:e})}};aa.\u0275fac=function(t){return new(t||aa)},aa.\u0275cmp=ie({type:aa,selectors:[["app-role-permission-management"]],decls:33,vars:8,consts:[[1,"min-h-screen","bg-gray-50","p-6"],[1,"mb-8"],[1,"text-3xl","font-bold","text-gray-900"],[1,"mt-2","text-gray-600"],[1,"mb-6","rounded-md","bg-red-50","p-4","border","border-red-200"],[1,"mb-6","rounded-md","bg-green-50","p-4","border","border-green-200"],[1,"grid","grid-cols-1","gap-6","lg:grid-cols-3"],[1,"lg:col-span-1"],[1,"rounded-lg","bg-white","shadow"],[1,"border-b","border-gray-200","p-4"],[1,"flex","items-center","justify-between"],[1,"text-lg","font-semibold","text-gray-900"],[1,"mt-1","text-sm","text-gray-600"],["title","\u65B0\u589E\u89D2\u8272",1,"px-3","py-2","text-sm","font-medium","rounded-md","bg-blue-600","text-white","hover:bg-blue-700",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],["type","text","placeholder","\u641C\u5C0B\u89D2\u8272...",1,"block","w-full","rounded-md","border","border-gray-300","px-3","py-2","text-gray-900","placeholder-gray-500","focus:border-blue-500","focus:ring-blue-500",3,"input","value"],[1,"divide-y","divide-gray-200","max-h-96","overflow-y-auto"],[1,"p-4","text-center","text-gray-500"],[1,"lg:col-span-2"],[1,"rounded-lg","bg-white","shadow","p-12","text-center"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[4,"ngIf"],[1,"text-sm","font-medium","text-red-800"],[1,"text-sm","font-medium","text-green-800"],[1,"hover:bg-gray-50","transition",3,"bg-blue-50","border-l-4","border-l-blue-500"],[1,"hover:bg-gray-50","transition"],[1,"flex","items-center"],[1,"flex-1","text-left","p-4",3,"click"],[1,"font-semibold","text-gray-900"],[1,"text-sm","text-gray-600"],[1,"mt-1","text-xs","text-gray-500"],[1,"flex","gap-1","pr-2"],["title","\u7DE8\u8F2F\u89D2\u8272",1,"p-2","text-blue-600","hover:bg-blue-100","rounded",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["title","\u522A\u9664\u89D2\u8272",1,"p-2","text-red-600","hover:bg-red-100","rounded",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"text-gray-600"],[1,"border-b","border-gray-200","p-6"],[1,"text-xl","font-semibold","text-gray-900"],[1,"text-right"],[1,"text-3xl","font-bold","text-blue-600"],[1,"border-b","border-gray-200","p-4","bg-gray-50","flex","gap-2"],[1,"px-3","py-2","text-sm","font-medium","rounded-md","bg-blue-600","text-white","hover:bg-blue-700",3,"click"],[1,"px-3","py-2","text-sm","font-medium","rounded-md","bg-gray-400","text-white","hover:bg-gray-500",3,"click"],[1,"px-3","py-2","text-sm","font-medium","rounded-md","bg-gray-200","text-gray-900","hover:bg-gray-300","disabled:opacity-50",3,"click","disabled"],[1,"divide-y","divide-gray-200","max-h-screen","overflow-y-auto"],[1,"p-8","text-center","text-gray-500"],[1,"border-t","border-gray-200","p-6","bg-gray-50","flex","gap-3","justify-end"],[1,"px-4","py-2","text-sm","font-medium","rounded-md","bg-gray-200","text-gray-900","hover:bg-gray-300","disabled:opacity-50",3,"click","disabled"],[1,"px-4","py-2","text-sm","font-medium","rounded-md","bg-green-600","text-white","hover:bg-green-700","disabled:opacity-50",3,"click","disabled"],[1,"border-b","border-gray-200"],[1,"bg-gray-50","p-4","flex","items-center","justify-between"],[1,"flex","items-center","gap-3","flex-1"],["type","checkbox",1,"w-5","h-5","text-blue-600","rounded","cursor-pointer",3,"change","checked"],[1,"font-semibold","text-gray-900","capitalize"],[1,"text-xs","text-gray-600"],[1,"p-4","space-y-3"],[1,"text-sm","text-gray-500","py-2"],[1,"flex","items-start","gap-3"],["type","checkbox",1,"w-5","h-5","text-blue-600","rounded","cursor-pointer","mt-0.5",3,"change","checked","disabled"],[1,"flex-1"],[1,"block","text-sm","font-medium","text-gray-900","cursor-pointer"],[1,"text-xs","text-gray-600","mt-1"],[1,"text-xs","bg-gray-100","px-2","py-1","rounded","text-gray-700","inline-block","mt-1"],[1,"bg-white","rounded-lg","shadow-xl","max-w-md","w-full","m-4"],[1,"p-6","space-y-4"],[1,"rounded-md","bg-red-50","p-4","border","border-red-200"],[1,"block","text-sm","font-medium","text-gray-900","mb-2"],[1,"text-red-500"],["type","text","placeholder","\u8ACB\u8F38\u5165\u89D2\u8272\u540D\u7A31",1,"block","w-full","rounded-md","border","border-gray-300","px-3","py-2","text-gray-900","placeholder-gray-500","focus:border-blue-500","focus:ring-blue-500",3,"input","value","disabled"],["placeholder","\u8ACB\u8F38\u5165\u89D2\u8272\u8AAA\u660E\uFF08\u9078\u586B\uFF09","rows","3",1,"block","w-full","rounded-md","border","border-gray-300","px-3","py-2","text-gray-900","placeholder-gray-500","focus:border-blue-500","focus:ring-blue-500",3,"input","value","disabled"],[1,"border-t","border-gray-200","p-6","flex","gap-3","justify-end"],[1,"px-4","py-2","text-sm","font-medium","rounded-md","bg-blue-600","text-white","hover:bg-blue-700","disabled:opacity-50",3,"click","disabled"],[1,"p-6"],[1,"rounded-md","bg-red-50","p-4","border","border-red-200","mb-4"],[1,"text-gray-700"],[1,"text-gray-900"],[1,"text-sm","text-red-600","mt-2"],[1,"px-4","py-2","text-sm","font-medium","rounded-md","bg-red-600","text-white","hover:bg-red-700","disabled:opacity-50",3,"click","disabled"]],template:function(t,i){t&1&&(l(0,"div",0)(1,"div",1)(2,"h1",2),c(3,"\u89D2\u8272\u6B0A\u9650\u63A7\u7BA1"),a(),l(4,"p",3),c(5,"\u8A2D\u5B9A\u6BCF\u500B\u89D2\u8272\u7684\u6B0A\u9650\uFF0C\u6C7A\u5B9A\u4ED6\u5011\u53EF\u4EE5\u57F7\u884C\u7684\u64CD\u4F5C"),a()(),A(6,N$,3,1,"div",4),A(7,R$,3,1,"div",5),l(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"div",10)(13,"div")(14,"h2",11),c(15,"\u53EF\u7DE8\u8F2F\u7684\u89D2\u8272"),a(),l(16,"p",12),c(17," \u8D85\u7D1A\u7BA1\u7406\u54E1\u89D2\u8272\u7121\u6CD5\u7DE8\u8F2F "),a()(),l(18,"button",13),b("click",function(){return i.openCreateRoleDialog()}),Li(),l(19,"svg",14),x(20,"path",15),a()()()(),Hr(),l(21,"div",9)(22,"input",16),b("input",function(o){return i.searchTerm.set(o.target.value)}),a()(),l(23,"div",17),A(24,F$,2,0,"div",18)(25,P$,2,0,"div",18)(26,V$,2,0),a()()(),l(27,"div",19),A(28,O$,3,0,"div",20)(29,W$,27,9,"div",8),a()()(),A(30,z$,22,9,"div",21),A(31,J$,19,5,"div",21),Pt(32,K$,2,1,"ng-container",22)),t&2&&(f(6),N(i.error()?6:-1),f(),N(i.successMessage()?7:-1),f(15),M("value",i.searchTerm()),f(2),N(i.isLoading()?24:i.filteredRoles().length===0?25:26),f(4),N(i.selectedRole()?29:28),f(2),N(i.showRoleDialog()?30:-1),f(),N(i.showDeleteDialog()?31:-1),f(),M("ngIf",!1))},dependencies:[re,ji,Oe,be],styles:["[_nghost-%COMP%]{--color-primary: #3b82f6;--color-success: #10b981;--color-danger: #ef4444;--color-warning: #f59e0b;--color-gray-50: #f9fafb;--color-gray-100: #f3f4f6;--color-gray-200: #e5e7eb;--color-gray-300: #d1d5db;--color-gray-600: #4b5563;--color-gray-900: #111827}[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:var(--color-gray-100)}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--color-gray-300);border-radius:4px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:var(--color-gray-400)}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}[class*=bg-green-50][_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideIn .3s ease-out}button[_ngcontent-%COMP%], input[type=checkbox][_ngcontent-%COMP%]{transition:all .2s ease-out}.role-item[_ngcontent-%COMP%]:hover{transform:translate(2px)}"],changeDetection:0});var Ep=aa;var Ke=(n,e)=>{let t=P(nt),i=P(Le);if(!t.isAuthenticated())return i.navigate(["/login"],{queryParams:{returnUrl:e.url}}),!1;let r=t.getTokenExpiry(),o=new Date().getTime();return r&&o>=r?(t.logout(),i.navigate(["/login"],{queryParams:{returnUrl:e.url,expired:!0}}),!1):!0};var _o=class _o{constructor(){this.baseUrl=`${yn.apiUrl}/admin`;this.authService=P(nt);this.http=P(Qt);this.router=P(Le)}async checkSuperAdmin(){try{let e=this.authService.getToken();if(!e)return!1;let t=new Ot({Authorization:`Bearer ${e}`,"Content-Type":"application/json"}),i=await se(this.http.get(`${this.baseUrl}/profile`,{headers:t}));return i?.data?.roles&&Array.isArray(i.data.roles)?i.data.roles.some(r=>r.role_name==="super_admin"):!1}catch(e){return console.error("Error checking super admin status:",e),!1}}};_o.\u0275fac=function(t){return new(t||_o)},_o.\u0275prov=J({token:_o,factory:_o.\u0275fac,providedIn:"root"});var t_=_o,Gb=async(n,e)=>{let t=P(t_),i=P(Le);return await t.checkSuperAdmin()?!0:(console.warn("Access denied: User is not a super admin"),i.navigate(["/dashboard"],{queryParams:{error:"insufficient-permissions"}}),!1)};var qb=[{path:"login",component:Cp,title:"\u767B\u5165"},{path:"dashboard",component:um,title:"Dashboard",canActivate:[Ke]},{path:"financial-statements",component:dm,title:"Financial Statements",canActivate:[Ke]},{path:"customer-analysis",component:Km,title:"\u9867\u5BA2\u7BA1\u7406",canActivate:[Ke]},{path:"product-analysis",component:Qm,title:"Product Analysis",canActivate:[Ke]},{path:"product-cost",component:ap,title:"Product Cost",canActivate:[Ke]},{path:"ledger",component:Zm,title:"Ledger",canActivate:[Ke]},{path:"vendors",component:lp,title:"\u5EE0\u5546\u7BA1\u7406",canActivate:[Ke]},{path:"purchase-orders",component:up,title:"\u9032\u8CA8\u55AE\u7BA1\u7406",canActivate:[Ke]},{path:"events",component:tp,title:"\u6D3B\u52D5\u7BA1\u7406",canActivate:[Ke]},{path:"events/new",component:Kl,title:"\u65B0\u589E\u6D3B\u52D5",canActivate:[Ke]},{path:"events/edit/:id",component:Kl,title:"\u7DE8\u8F2F\u6D3B\u52D5",canActivate:[Ke]},{path:"daily-revenue",component:np,title:"Daily Revenue",canActivate:[Ke]},{path:"daily-revenue/:date",component:ip,title:"Edit Daily Revenue",canActivate:[Ke]},{path:"payroll",component:rp,title:"\u85AA\u8CC7\u7BA1\u7406",canActivate:[Ke]},{path:"payroll/:employeeId/:year/:month",component:op,title:"Payroll Details",canActivate:[Ke]},{path:"company-profile",component:sp,title:"\u516C\u53F8\u500B\u4EBA\u8CC7\u6599",canActivate:[Ke]},{path:"shareholder-rebates",component:dp,title:"\u80A1\u6771\u56DE\u994B\u91D1",canActivate:[Ke]},{path:"meeting",component:cp,title:"\u6BCF\u5468\u6703\u8B70\u7D00\u9304",canActivate:[Ke]},{path:"shareholder-records",component:pp,title:"\u500B\u4EBA\u6BCF\u5468\u9032\u5EA6\u7D00\u9304",canActivate:[Ke]},{path:"goal-progress",component:gp,title:"\u500B\u4EBA\u76EE\u6A19\u9032\u5EA6",canActivate:[Ke]},{path:"goal-setting",component:_p,title:"\u5718\u968A\u76EE\u6A19\u8A2D\u5B9A",canActivate:[Ke]},{path:"monthly-targets",component:vp,title:"\u71DF\u6536\u76EE\u6A19",canActivate:[Ke]},{path:"decision-log",component:fp,title:"\u91CD\u5927\u4E8B\u9805\u4F48\u9054",canActivate:[Ke]},{path:"user-management",component:hp,title:"\u4F7F\u7528\u8005\u7BA1\u7406",canActivate:[Ke]},{path:"role-permissions",component:Ep,title:"\u89D2\u8272\u6B0A\u9650\u63A7\u7BA1",canActivate:[Ke,Gb]},{path:"account",component:xp,title:"\u5E33\u865F\u8A2D\u5B9A",canActivate:[Ke]},{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"**",redirectTo:"login"}];var Wb=()=>{};var jb=async(n,e)=>{if(!(typeof window>"u"))return await Wb(),r_([["ion-icon",[[1,"ion-icon",{mode:[1025],color:[1],ios:[1],md:[1],flipRtl:[4,"flip-rtl"],name:[513],src:[1],icon:[8],size:[1],lazy:[4],sanitize:[4],svgContent:[32],isVisible:[32]},null,{name:["loadIcon"],src:["loadIcon"],icon:["loadIcon"],ios:["loadIcon"],md:["loadIcon"]}]]]],e)};var vo=class vo{constructor(e,t){this.authService=e;this.router=t}intercept(e,t){let i=this.authService.getToken();if(i){let r=this.authService.getTokenExpiry(),o=new Date().getTime();if(r&&o>=r)return console.warn("Token \u5DF2\u8FC7\u671F\uFF0C\u5F3A\u5236\u91CD\u65B0\u767B\u5165"),this.authService.logout(),this.router.navigate(["/login"],{queryParams:{expired:!0}}),Mi(()=>new Error("Token expired"));e=this.addToken(e,i)}return t.handle(e).pipe(jn(r=>{if(r.status===401){let o=this.authService.getTokenExpiry(),s=new Date().getTime();o&&s>=o?(console.warn("\u6536\u5230 401 Unauthorized \u4E14 Token \u5DF2\u8FC7\u671F\uFF0C\u5F3A\u5236\u91CD\u65B0\u767B\u5165"),this.authService.logout(),this.router.navigate(["/login"],{queryParams:{expired:!0,returnUrl:this.router.url}})):console.warn("\u6536\u5230 401 Unauthorized\uFF0C\u4F46 Token \u4ECD\u6709\u6548\uFF0C\u4FDD\u7559\u767B\u5165\u72C0\u614B")}return Mi(()=>r)}))}addToken(e,t){return e.clone({setHeaders:{Authorization:`Bearer ${t}`}})}};vo.\u0275fac=function(t){return new(t||vo)(oe(nt),oe(Le))},vo.\u0275prov=J({token:vo,factory:vo.\u0275fac});var bp=vo;Qg(Yc,{providers:[xg(),Ah(qb,Nh()),ih(rh()),{provide:vc,useClass:bp,multi:!0}]}).catch(n=>console.error(n));jb(window);
